---
layout: default
title: Openssl实现生成比特币地址的base58编码
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22markdown_views%22%3E+%0A++%3Cp%3E%E6%AF%94%E7%89%B9%E5%B8%81%E5%8D%8F%E8%AE%AE%E4%B8%AD%E6%AF%94%E7%89%B9%E5%B8%81%E5%9C%B0%E5%9D%80%E7%9A%84%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+vbnet%22%3E%E6%AF%94%E7%89%B9%E5%B8%81%E5%9C%B0%E5%9D%80%28Bitcoin+Address%29%E6%98%AFECDSA%E5%85%AC%E9%92%A5%28%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Ekey%3C%2Fspan%3E%29%E7%9A%84%E6%95%A3%E5%88%97%EF%BC%8C%E5%AE%83%E6%98%AF%E8%BF%99%E6%A0%B7%E8%AE%A1%E7%AE%97%E5%87%BA%E6%9D%A5%E7%9A%84%EF%BC%9A%0A%0AVersion+%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E+%E4%B8%AA%E5%AD%97%E8%8A%82+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E+%3B+%E5%9C%A8%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E4%B8%8A%2C+%E8%BF%99%E4%B8%AA%E5%80%BC%E6%98%AF+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E+%E4%B8%AA%E5%AD%97%E8%8A%82+%3Cspan+class%3D%22hljs-number%22%3E111%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-keyword%22%3EKey%3C%2Fspan%3E+hash+%3D+Version+%E4%B8%8E+RIPEMD-%3Cspan+class%3D%22hljs-number%22%3E160%3C%2Fspan%3E%28SHA-%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Ekey%3C%2Fspan%3E%29%29+%E7%9B%B8%E6%8E%A5%0AChecksum+%3D+SHA-%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%28SHA-%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-keyword%22%3EKey%3C%2Fspan%3E+hash%29%29%E7%9A%84%E5%89%8D%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%E4%B8%AA%E5%AD%97%E8%8A%82%0ABitcoin+Address+%3D+Base58Encode%28%3Cspan+class%3D%22hljs-keyword%22%3EKey%3C%2Fspan%3E+hash+%E4%B8%8E+Checksum+%E7%9B%B8%E6%8E%A5%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E8%AF%A6%E7%BB%86%E5%8F%82%E8%80%83%EF%BC%9A%E3%80%8A%3Ca+href%3D%22https%3A%2F%2Fzh-cn.bitcoin.it%2Fwiki%2F%25E5%258D%258F%25E8%25AE%25AE%25E8%25AF%25B4%25E6%2598%258E%23Addresses_.28.E5.9C.B0.E5.9D.80.29%22+rel%3D%22nofollow%22%3E%E6%AF%94%E7%89%B9%E5%B8%81%E5%8D%8F%E8%AE%AE%E8%AF%B4%E6%98%8E%3C%2Fa%3E%E3%80%8B%3C%2Fp%3E+%0A++%3Cp%3E%E4%B8%8B%E9%9D%A2%E4%BB%8B%E7%BB%8D%E4%BD%BF%E7%94%A8openssl%E5%BA%93%E5%AE%9E%E7%8E%B0base58%E7%BC%96%E7%A0%81%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+cpp%22%3E%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bstdlib.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Biostream%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bstring%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bopenssl%2Fbn.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%22ecdsa_test.h%22%3C%2Fspan%3E%0A%0A%0A%3Cspan+class%3D%22hljs-keyword%22%3Eusing%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Enamespace%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3B%0A%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23define+DOMAIN_CHECK%28c%29+%28%270%27%26lt%3B%3D%28c%29%26amp%3B%26amp%3B%28c%29%26lt%3B%3D%279%27%7C%7C%27a%27%26lt%3B%3D%28c%29%26amp%3B%26amp%3B%28c%29%26lt%3B%3D%27f%27%7C%7C%27A%27%26lt%3B%3D%28c%29%26amp%3B%26amp%3B%28c%29%26lt%3B%3D%27F%27%29%3C%2Fspan%3E%0A%0A%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23define+BASE58TABLE+%22123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz%22%3C%2Fspan%3E%0A%0A%0A%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3A%3A%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E+base58encode%28%3Cspan+class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3A%3A%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E+%26amp%3B+hexstring%29%0A%7B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3A%3A%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E+result+%3D+%3Cspan+class%3D%22hljs-string%22%3E%22%22%3C%2Fspan%3E%3B%0A++++BN_CTX+*+bnctx+%3D+BN_CTX_new%28%29%3B%0A++++BIGNUM+*+bn+%3D+BN_new%28%29%3B%0A++++BIGNUM+*+bn0%3D+BN_new%28%29%3B%0A++++BIGNUM+*+bn58%3DBN_new%28%29%3B%0A++++BIGNUM+*+dv+%3D+BN_new%28%29%3B%0A++++BIGNUM+*+rem%3D+BN_new%28%29%3B%0A%0A++++BN_hex2bn%28%26amp%3Bbn%2C+hexstring.c_str%28%29%29%3B%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2Fprintf%28%22bn%3A%25s%5Cn%22%2C+BN_bn2dec%28bn%29%29%3B%3C%2Fspan%3E%0A++++BN_hex2bn%28%26amp%3Bbn58%2C+%3Cspan+class%3D%22hljs-string%22%3E%223a%22%3C%2Fspan%3E%29%3B%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F58%3C%2Fspan%3E%0A++++BN_hex2bn%28%26amp%3Bbn0%2C%3Cspan+class%3D%22hljs-string%22%3E%220%22%3C%2Fspan%3E%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ewhile%3C%2Fspan%3E%28BN_cmp%28bn%2C+bn0%29%26gt%3B%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29%7B%0A++++++++BN_div%28dv%2C+rem%2C+bn%2C+bn58%2C+bnctx%29%3B%0A++++++++BN_copy%28bn%2C+dv%29%3B%0A++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2Fprintf%28%22dv%3A+%25s%5Cn%22%2C+BN_bn2dec%28dv%29%29%3B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2Fprintf%28%22rem%3A%25s%5Cn%22%2C+BN_bn2dec%28rem%29%29%3B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+base58char+%3D+BASE58TABLE%5BBN_get_word%28rem%29%5D%3B%0A++++++++result+%2B%3D+base58char%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3A%3A%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%3A%3Aiterator+pbegin+%3D+result.begin%28%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3A%3A%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%3A%3Aiterator+pend+++%3D+result.end%28%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ewhile%3C%2Fspan%3E%28pbegin+%26lt%3B+pend%29+%7B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+c+%3D+*pbegin%3B%0A++++++++*%28pbegin%2B%2B%29+%3D+*%28--pend%29%3B%0A++++++++*pend+%3D+c%3B%0A++++%7D%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+result%3B%0A%7D%0A%0A%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+main%28%29+%7B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Estd%3C%2Fspan%3E%3A%3A%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E+hex_string+%3D+%3Cspan+class%3D%22hljs-string%22%3E%2200010966776006953D5567439E5E39F86A0D273BEED61967F6%22%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ecout%3C%2Fspan%3E+%26lt%3B%26lt%3B+base58encode%28hex_string%29.c_str%28%29+%26lt%3B%26lt%3B+endl%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fmarkdown_views-ea0013b516.css%22%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fanda0109%2Farticle%2Fdetails%2F79583847%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fanda0109%2Farticle%2Fdetails%2F79583847%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}