---
layout: default
title: Hadoop入门案例-实现WordCount
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-java%22%3E%0Aimport+org.apache.hadoop.conf.Configuration%3B%0Aimport+org.apache.hadoop.fs.Path%3B%0Aimport+org.apache.hadoop.io.LongWritable%3B%0Aimport+org.apache.hadoop.io.Text%3B%0Aimport+org.apache.hadoop.mapreduce.Job%3B%0Aimport+org.apache.hadoop.mapreduce.Mapper%3B%0Aimport+org.apache.hadoop.mapreduce.Reducer%3B%0Aimport+org.apache.hadoop.mapreduce.lib.input.FileInputFormat%3B%0Aimport+org.apache.hadoop.mapreduce.lib.output.FileOutputFormat%3B%0A%0Aimport+java.io.IOException%3B%0A%0Apublic+class+WordCount+%7B%0A%0A%0A++++%2F**%0A+++++*+%E9%BB%98%E8%AE%A4MapReduce%E6%98%AF%E9%80%9A%E8%BF%87TextInputFormat%E8%BF%9B%E8%A1%8C%E5%88%87%E7%89%87%E5%B9%B6%E4%BA%A4%E7%BB%99Mapper%E7%B1%BB%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86%0A+++++*+TextInputFormat%3A%0A+++++*++++++key-%26gt%3B%E5%BD%93%E5%89%8D%E5%89%8D%E8%A1%8C%E7%9A%84%E9%A6%96%E5%AD%97%E6%AF%8D%E7%9A%84%E7%B4%A2%E5%BC%95%0A+++++*++++++value-%26gt%3B%E5%BD%93%E5%89%8D%E8%A1%8C%E7%9A%84%E6%95%B0%E6%8D%AE%0A+++++*+Mapper%E7%B1%BB%E5%8F%82%E6%95%B0%3A%0A+++++*++%E8%BF%9B%E8%A1%8C%E4%BA%86%E5%8C%85%E8%A3%85%EF%BC%9A%0A+++++*++++++%E8%BE%93%E5%85%A5key%E7%B1%BB%E5%9E%8B%3ALong%E7%B1%BB%E5%9E%8B%0A+++++*++++++%E8%BE%93%E5%85%A5value%E7%B1%BB%E5%9E%8B%3AString%0A+++++*++++++%E8%BE%93%E5%87%BAkey%E7%B1%BB%E5%9E%8B%3AString%EF%BC%88%E5%8D%95%E8%AF%8D%EF%BC%89%0A+++++*++++++%E8%BE%93%E5%87%BAvalue%E7%B1%BB%E5%9E%8B%EF%BC%9ALong%EF%BC%88%E4%B8%AA%E6%95%B0%EF%BC%89%0A+++++*MapReduce%E4%B8%BA%E4%BA%86%E5%9C%A8%E4%BC%A0%E8%BE%93%E6%97%B6%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%8C%E9%80%9A%E8%BF%87%E5%8C%85%E8%A3%85%EF%BC%8C%E5%AF%B9%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E8%BF%9B%E8%A1%8C%E5%8C%85%E8%A3%85%EF%BC%8C%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96%E6%96%B9%E6%B3%95%0A+++++*%2F%0A++++public+static+class+WordCountMapper+extends+Mapper%26lt%3BLongWritable%2CText%2CText%2CLongWritable%26gt%3B%7B%0A%0A++++++++LongWritable+one+%3D+new+LongWritable%281%29%3B%0A%0A++++++++%2F**%0A+++++++++*%E5%B0%86%E6%AF%8F%E8%A1%8C%E6%95%B0%E6%8D%AE%E6%8B%86%E5%88%86%0A+++++++++*%2F%0A++++++++%40Override%0A++++++++protected+void+map%28LongWritable+key%2C+Text+value%2C+Context+context%29+throws+IOException%2C+InterruptedException+%7B%0A%0A++++++++++++String+words+%3D+value.toString%28%29%3B%0A++++++++++++%2F%2F%E5%B0%86%E6%AF%8F%E8%A1%8C%E6%95%B0%E6%8D%AE%E6%8B%86%E5%88%86%E6%88%90%E5%90%84%E4%B8%AA%E5%8D%95%E8%AF%8D%0A++++++++++++String%5B%5D+wordArr+%3D+words.split%28%22%5C%5Cs%2B%22%29%3B%0A++++++++++++for+%28String+word+%3A+wordArr%29+%7B%0A++++++++++++++++%2F%2F%E5%B0%86%E5%8D%95%E8%AF%8D%E8%BE%93%E5%87%BA+%E6%AF%8F%E4%B8%AA%E5%8D%95%E8%AF%8D%E4%BD%9C%E4%B8%BA%E4%B8%80%E4%B8%AA%0A++++++++++++++++context.write%28new+Text%28word%29%2Cone%29%3B%0A%0A++++++++++++%7D%0A%0A%0A++++++++%7D%0A++++%7D%0A%0A%0A++++%2F**%0A+++++*%0A+++++*+%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%B1%80%E8%81%9A%E5%90%88%0A+++++*+Reducer%E5%8F%82%E6%95%B0%EF%BC%9A%0A+++++*+%E5%90%8C%E6%A0%B7%E5%AF%B9%E5%8F%82%E6%95%B0%E8%BF%9B%E8%A1%8C%E4%BA%86%E5%8C%85%E8%A3%85%0A+++++*++++++%E8%BE%93%E5%85%A5%EF%BC%9A%0A+++++*++++++++++key%EF%BC%9AString%EF%BC%88%E5%8D%95%E8%AF%8D%EF%BC%89%EF%BC%8Cvalue%EF%BC%9ALong%EF%BC%88%E4%B8%AA%E6%95%B0%EF%BC%89%0A+++++*++++++%E8%BE%93%E5%87%BA%EF%BC%9A%0A+++++*++++++++++key%EF%BC%9AString%EF%BC%8Cvalue%EF%BC%9ALong%0A+++++*%0A+++++*%2F%0A++++public+static+class+WordCountReducer+extends+Reducer%26lt%3BText%2CLongWritable%2CText%2CLongWritable%26gt%3B%7B%0A%0A%0A++++++++%2F**%0A+++++++++*%E5%B0%86map%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%B1%80%E8%81%9A%E5%90%88%0A+++++++++*+key%EF%BC%9A%E5%8D%95%E8%AF%8D%EF%BC%8Cvalues%EF%BC%9A%E5%8D%95%E8%AF%8D%E4%B8%AA%E6%95%B0%E9%9B%86%E5%90%88%5B1%2C1%2C1%5D%EF%BC%8Ccontext%3A%E4%B8%8A%E4%B8%8B%E6%96%87%0A+++++++++*%2F%0A++++++++%40Override%0A++++++++protected+void+reduce%28Text+key%2C+Iterable%26lt%3BLongWritable%26gt%3B+values%2C+Context+context%29+throws+IOException%2C+InterruptedException+%7B%0A%0A++++++++++++Long+sum+%3D+0L%3B%0A++++++++++++for+%28LongWritable+value%3Avalues%29+%7B%0A++++++++++++++++%2F%2F%E7%B4%AF%E5%8A%A0%E5%8D%95%E8%AF%8D%E7%9A%84%E4%B8%AA%E6%95%B0%0A++++++++++++++++sum+%2B%3D+value.get%28%29%3B%0A++++++++++++%7D%0A++++++++++++%2F%2F%E4%BB%A5+%E5%8D%95%E8%AF%8D%EF%BC%8C%E4%B8%AA%E6%95%B0%E8%BE%93%E5%87%BA%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C%0A++++++++++++context.write%28key%2Cnew+LongWritable%28sum%29%29%3B%0A++++++++%7D%0A++++%7D%0A%0A%0A%0A%0A%0A++++public+static+void+main%28String%5B%5D+args%29+throws+IOException%2C+ClassNotFoundException%2C+InterruptedException+%7B%0A%0A++++++++%2F%2F%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAJob%0A++++++++Configuration+conf+%3D+new+Configuration%28%29%3B%0A++++++++conf.set%28%22fs.defaultFS%22%2C%22hdfs%3A%2F%2F192.168.43.20%3A9000%22%29%3B%0A++++++++Job+job+%3D+Job.getInstance%28conf%2C%22word-count%22%29%3B%0A++++++++%2F%2F%E9%9C%80%E8%A6%81%E6%89%93%E6%88%90jar%E5%8C%85%E6%89%8D%E8%83%BD%E8%BF%90%E8%A1%8C%0A++++++++job.setJarByClass%28WordCount.class%29%3B%0A%0A++++++++%2F%2F1.%E6%8C%87%E5%AE%9A%E8%BE%93%E5%85%A5%E6%96%87%E4%BB%B6%0A++++++++++++%2F%2F%E9%80%9A%E8%BF%87%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E4%B8%80%E4%B8%AApath%E8%BF%9B%E6%9D%A5%0A++++++++FileInputFormat.addInputPath%28job%2Cnew+Path%28args%5B0%5D%29%29%3B%0A%0A++++++++%2F%2F2.%E7%BC%96%E5%86%99mapper%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91%0A++++++++job.setMapperClass%28WordCountMapper.class%29%3B%0A++++++++job.setMapOutputKeyClass%28Text.class%29%3B%0A++++++++job.setMapOutputValueClass%28LongWritable.class%29%3B%0A++++++++%2F%2F3.shuffle%E6%B5%81%E7%A8%8B%0A%0A++++++++%2F%2F++todo%0A%0A++++++++%2F%2F4.reducer%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91%0A++++++++job.setReducerClass%28WordCountReducer.class%29%3B%0A++++++++job.setOutputKeyClass%28Text.class%29%3B%0A++++++++job.setOutputValueClass%28LongWritable.class%29%3B%0A++++++++%2F%2F5.%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6+%E5%B9%B6%E6%8C%87%E5%AE%9A%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95%0A++++++++FileOutputFormat.setOutputPath%28job%2Cnew+Path%28args%5B1%5D%29%29%3B%0A%0A++++++++%2F%2F6.%E8%BF%90%E8%A1%8CJob%0A++++++++boolean+result+%3D+job.waitForCompletion%28true%29%3B%0A++++++++System.out.println%28result+%3F+1+%3A+0%29%3B%0A++++%7D%0A%0A%0A%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Chr%3E%0A++%3Cp%3E%E4%BD%BF%E7%94%A8maven%E6%89%93%E6%88%90jar%E5%8C%85%EF%BC%8C%E4%B8%8A%E4%BC%A0%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%3C%2Fp%3E+%0A++%3Cp%3E%E6%89%A7%E8%A1%8C%EF%BC%9Abin%2Fhadoop+jar+share%2Fhadoop%2Fmapreduce%2Fjar%E5%8C%85%E5%90%8D%E7%A7%B0.jar+%E5%8C%85%E5%90%8Dxxx.xxx.xxx.WordCount%26nbsp%3B+%E8%BE%93%E5%85%A5%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%26nbsp%3B+%26nbsp%3B%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}