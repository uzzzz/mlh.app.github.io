---
layout: default
title: 基于ERC20的代币 源码
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22markdown_views%22%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+php%22%3Epragma+solidity+%5E%3Cspan+class%3D%22hljs-number%22%3E0.4%3C%2Fspan%3E%3Cspan+class%3D%22hljs-number%22%3E.21%3C%2Fspan%3E%3B%0A%0Acontract+IMigrationContract+%7B%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Emigrate%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+addr%2C+uint256+nas%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E%3B%3C%2Fspan%3E%0A%7D%0A%0A%3Cspan+class%3D%22hljs-comment%22%3E%2F*+%E7%81%B5%E6%84%9F%E6%9D%A5%E8%87%AA%E4%BA%8ENAS+coin*%2F%3C%2Fspan%3E%0Acontract+SafeMath+%7B%0A%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EsafeAdd%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256+x%2C+uint256+y%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Einternal%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++uint256+z+%3D+x+%2B+y%3B%0A++++++++assert%28%28z+%26gt%3B%3D+x%29+%26amp%3B%26amp%3B+%28z+%26gt%3B%3D+y%29%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+z%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EsafeSubtract%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256+x%2C+uint256+y%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Einternal%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++assert%28x+%26gt%3B%3D+y%29%3B%0A++++++++uint256+z+%3D+x+-+y%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+z%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EsafeMult%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256+x%2C+uint256+y%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Einternal%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++uint256+z+%3D+x+*+y%3B%0A++++++++assert%28%28x+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29%7C%7C%28z%2Fx+%3D%3D+y%29%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+z%3B%0A++++%7D%0A%0A%7D%0A%0Acontract+Token+%7B%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+totalSupply%3B%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EbalanceOf%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_owner%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Econstant%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+balance%29%3C%2Fspan%3E%3B%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Etransfer%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_to%2C+uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E%3B%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EtransferFrom%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_from%2C+address+_to%2C+uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E%3B%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eapprove%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_spender%2C+uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E%3B%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eallowance%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_owner%2C+address+_spender%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Econstant%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+remaining%29%3C%2Fspan%3E%3B%3C%2Fspan%3E%0A++++event+Transfer%28address+indexed+_from%2C+address+indexed+_to%2C+uint256+_value%29%3B%0A++++event+Approval%28address+indexed+_owner%2C+address+indexed+_spender%2C+uint256+_value%29%3B%0A%7D%0A%0A%0A%3Cspan+class%3D%22hljs-comment%22%3E%2F*+ERC+20+token+*%2F%3C%2Fspan%3E%0Acontract+StandardToken+is+Token+%7B%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Etransfer%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_to%2C+uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28balances%5Bmsg.sender%5D+%26gt%3B%3D+_value+%26amp%3B%26amp%3B+_value+%26gt%3B+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%7B%0A++++++++++++balances%5Bmsg.sender%5D+-%3D+_value%3B%0A++++++++++++balances%5B_to%5D+%2B%3D+_value%3B%0A++++++++++++Transfer%28msg.sender%2C+_to%2C+_value%29%3B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Etrue%3C%2Fspan%3E%3B%0A++++++++%7D+%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E+%7B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Efalse%3C%2Fspan%3E%3B%0A++++++++%7D%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EtransferFrom%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_from%2C+address+_to%2C+uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28balances%5B_from%5D+%26gt%3B%3D+_value+%26amp%3B%26amp%3B+allowed%5B_from%5D%5Bmsg.sender%5D+%26gt%3B%3D+_value+%26amp%3B%26amp%3B+_value+%26gt%3B+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%7B%0A++++++++++++balances%5B_to%5D+%2B%3D+_value%3B%0A++++++++++++balances%5B_from%5D+-%3D+_value%3B%0A++++++++++++allowed%5B_from%5D%5Bmsg.sender%5D+-%3D+_value%3B%0A++++++++++++Transfer%28_from%2C+_to%2C+_value%29%3B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Etrue%3C%2Fspan%3E%3B%0A++++++++%7D+%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E+%7B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Efalse%3C%2Fspan%3E%3B%0A++++++++%7D%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EbalanceOf%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_owner%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Econstant%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+balance%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+balances%5B_owner%5D%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eapprove%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_spender%2C+uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28bool+success%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++allowed%5Bmsg.sender%5D%5B_spender%5D+%3D+_value%3B%0A++++++++Approval%28msg.sender%2C+_spender%2C+_value%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Etrue%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eallowance%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_owner%2C+address+_spender%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Econstant%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+remaining%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+allowed%5B_owner%5D%5B_spender%5D%3B%0A++++%7D%0A%0A++++mapping+%28address+%3D%26gt%3B+uint256%29+balances%3B%0A++++mapping+%28address+%3D%26gt%3B+mapping+%28address+%3D%26gt%3B+uint256%29%29+allowed%3B%0A%7D%0A%0Acontract+ChinaToken+is+StandardToken%2C+SafeMath+%7B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+metadata%3C%2Fspan%3E%0A++++string++%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+constant+name+%3D+%3Cspan+class%3D%22hljs-string%22%3E%22China%22%3C%2Fspan%3E%3B%0A++++string++%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+constant+symbol+%3D+%3Cspan+class%3D%22hljs-string%22%3E%22ChinaCoin%22%3C%2Fspan%3E%3B%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+constant+decimals+%3D+%3Cspan+class%3D%22hljs-number%22%3E18%3C%2Fspan%3E%3B%0A++++string++%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+version+%3D+%3Cspan+class%3D%22hljs-string%22%3E%221.0%22%3C%2Fspan%3E%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+contracts%3C%2Fspan%3E%0A++++address+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+ethFundDeposit%3B++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+ETH%E5%AD%98%E6%94%BE%E5%9C%B0%E5%9D%80%3C%2Fspan%3E%0A++++address+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+newContractAddr%3B+++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+token%E6%9B%B4%E6%96%B0%E5%9C%B0%E5%9D%80%3C%2Fspan%3E%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+crowdsale+parameters%3C%2Fspan%3E%0A++++bool++++%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+isFunding%3B++++++++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E7%8A%B6%E6%80%81%E5%88%87%E6%8D%A2%E5%88%B0true%3C%2Fspan%3E%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+fundingStartBlock%3B%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+fundingStopBlock%3B%0A%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+currentSupply%3B+++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E6%AD%A3%E5%9C%A8%E5%94%AE%E5%8D%96%E4%B8%AD%E7%9A%84tokens%E6%95%B0%E9%87%8F%3C%2Fspan%3E%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+tokenRaised+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B+++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E6%80%BB%E7%9A%84%E5%94%AE%E5%8D%96%E6%95%B0%E9%87%8Ftoken%3C%2Fspan%3E%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+tokenMigrated+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B+++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E6%80%BB%E7%9A%84%E5%B7%B2%E7%BB%8F%E4%BA%A4%E6%98%93%E7%9A%84+token%3C%2Fspan%3E%0A++++uint256+%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E+tokenExchangeRate+%3D+%3Cspan+class%3D%22hljs-number%22%3E1000%3C%2Fspan%3E%3B+++++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+1000+%E5%85%91%E6%8D%A2+1+ETH%3C%2Fspan%3E%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+events%3C%2Fspan%3E%0A++++event+AllocateToken%28address+indexed+_to%2C+uint256+_value%29%3B+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E5%88%86%E9%85%8D%E7%9A%84%E7%A7%81%E6%9C%89%E4%BA%A4%E6%98%93token%3B%3C%2Fspan%3E%0A++++event+IssueToken%28address+indexed+_to%2C+uint256+_value%29%3B++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E5%85%AC%E5%BC%80%E5%8F%91%E8%A1%8C%E5%94%AE%E5%8D%96%E7%9A%84token%3B%3C%2Fspan%3E%0A++++event+IncreaseSupply%28uint256+_value%29%3B%0A++++event+DecreaseSupply%28uint256+_value%29%3B%0A++++event+Migrate%28address+indexed+_to%2C+uint256+_value%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E8%BD%AC%E6%8D%A2%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EformatDecimals%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Einternal%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ereturns%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+_value+*+%3Cspan+class%3D%22hljs-number%22%3E10%3C%2Fspan%3E+**+decimals%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+constructor%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EChinaToken%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28+address+_ethFundDeposit%2C+uint256+_currentSupply%29%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++ethFundDeposit+%3D+_ethFundDeposit%3B%0A%0A++++++++isFunding+%3D+%3Cspan+class%3D%22hljs-keyword%22%3Efalse%3C%2Fspan%3E%3B+++++++++++++++++++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E9%80%9A%E8%BF%87%E6%8E%A7%E5%88%B6%E9%A2%84CrowdS+ale%E7%8A%B6%E6%80%81%3C%2Fspan%3E%0A++++++++fundingStartBlock+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++++++fundingStopBlock+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A%0A++++++++currentSupply+%3D+formatDecimals%28_currentSupply%29%3B%0A++++++++totalSupply+%3D+formatDecimals%28%3Cspan+class%3D%22hljs-number%22%3E100000%3C%2Fspan%3E%29%3B%0A++++++++balances%5Bmsg.sender%5D+%3D+totalSupply%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E%28currentSupply+%26gt%3B+totalSupply%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++modifier+isOwner%28%29++%7B+%3Cspan+class%3D%22hljs-keyword%22%3Erequire%3C%2Fspan%3E%28msg.sender+%3D%3D+ethFundDeposit%29%3B+_%3B+%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E8%AE%BE%E7%BD%AEtoken%E6%B1%87%E7%8E%87%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EsetTokenExchangeRate%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28uint256+_tokenExchangeRate%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_tokenExchangeRate+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_tokenExchangeRate+%3D%3D+tokenExchangeRate%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++tokenExchangeRate+%3D+_tokenExchangeRate%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%40dev+%E8%B6%85%E5%8F%91token%E5%A4%84%E7%90%86%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EincreaseSupply%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++uint256+value+%3D+formatDecimals%28_value%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28value+%2B+currentSupply+%26gt%3B+totalSupply%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++currentSupply+%3D+safeAdd%28currentSupply%2C+value%29%3B%0A++++++++IncreaseSupply%28value%29%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%40dev+%E8%A2%AB%E7%9B%97token%E5%A4%84%E7%90%86%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EdecreaseSupply%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+_value%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++uint256+value+%3D+formatDecimals%28_value%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28value+%2B+tokenRaised+%26gt%3B+currentSupply%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++currentSupply+%3D+safeSubtract%28currentSupply%2C+value%29%3B%0A++++++++DecreaseSupply%28value%29%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E5%90%AF%E5%8A%A8%E5%8C%BA%E5%9D%97%E6%A3%80%E6%B5%8B+%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EstartFunding%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28uint256+_fundingStartBlock%2C+uint256+_fundingStopBlock%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28isFunding%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_fundingStartBlock+%26gt%3B%3D+_fundingStopBlock%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28block.number+%26gt%3B%3D+_fundingStartBlock%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++fundingStartBlock+%3D+_fundingStartBlock%3B%0A++++++++fundingStopBlock+%3D+_fundingStopBlock%3B%0A++++++++isFunding+%3D+%3Cspan+class%3D%22hljs-keyword%22%3Etrue%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E5%85%B3%E9%97%AD%E5%8C%BA%E5%9D%97%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EstopFunding%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21isFunding%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++isFunding+%3D+%3Cspan+class%3D%22hljs-keyword%22%3Efalse%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E5%BC%80%E5%8F%91%E4%BA%86%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%90%88%E5%90%8C%E6%9D%A5%E6%8E%A5%E6%94%B6token%EF%BC%88%E6%88%96%E8%80%85%E6%9B%B4%E6%96%B0token%EF%BC%89%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EsetMigrateContract%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_newContractAddr%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_newContractAddr+%3D%3D+newContractAddr%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++newContractAddr+%3D+_newContractAddr%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E8%AE%BE%E7%BD%AE%E6%96%B0%E7%9A%84%E6%89%80%E6%9C%89%E8%80%85%E5%9C%B0%E5%9D%80%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EchangeOwner%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28address+_newFundDeposit%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_newFundDeposit+%3D%3D+address%28%3Cspan+class%3D%22hljs-number%22%3E0x0%3C%2Fspan%3E%29%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++ethFundDeposit+%3D+_newFundDeposit%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F%E8%BD%AC%E7%A7%BBtoken%E5%88%B0%E6%96%B0%E7%9A%84%E5%90%88%E7%BA%A6%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Emigrate%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E%28isFunding%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E%28newContractAddr+%3D%3D+address%28%3Cspan+class%3D%22hljs-number%22%3E0x0%3C%2Fspan%3E%29%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++uint256+tokens+%3D+balances%5Bmsg.sender%5D%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28tokens+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++balances%5Bmsg.sender%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++++++tokenMigrated+%3D+safeAdd%28tokenMigrated%2C+tokens%29%3B%0A%0A++++++++IMigrationContract+newContract+%3D+IMigrationContract%28newContractAddr%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21newContract.migrate%28msg.sender%2C+tokens%29%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++Migrate%28msg.sender%2C+tokens%29%3B+++++++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+log+it%3C%2Fspan%3E%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E8%BD%AC%E8%B4%A6ETH+%E5%88%B0ChinaI%E5%9B%A2%E9%98%9F%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EtransferETH%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28this.balance+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21ethFundDeposit.send%28this.balance%29%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E5%B0%86BILIBILI+token%E5%88%86%E9%85%8D%E5%88%B0%E9%A2%84%E5%A4%84%E7%90%86%E5%9C%B0%E5%9D%80%E3%80%82%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EallocateToken%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28address+_addr%2C+uint256+_eth%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3EisOwner%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eexternal%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_eth+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28_addr+%3D%3D+address%28%3Cspan+class%3D%22hljs-number%22%3E0x0%3C%2Fspan%3E%29%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++uint256+tokens+%3D+safeMult%28formatDecimals%28_eth%29%2C+tokenExchangeRate%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28tokens+%2B+tokenRaised+%26gt%3B+currentSupply%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++tokenRaised+%3D+safeAdd%28tokenRaised%2C+tokens%29%3B%0A++++++++balances%5B_addr%5D+%2B%3D+tokens%3B%0A%0A++++++++AllocateToken%28_addr%2C+tokens%29%3B++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%E8%AE%B0%E5%BD%95token%E6%97%A5%E5%BF%97%3C%2Fspan%3E%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%2F+%E8%B4%AD%E4%B9%B0token%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Efunction%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-params%22%3E%28%29%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Epayable%3C%2Fspan%3E+%7B%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21isFunding%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28msg.value+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28block.number+%26lt%3B+fundingStartBlock%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28block.number+%26gt%3B+fundingStopBlock%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++uint256+tokens+%3D+safeMult%28msg.value%2C+tokenExchangeRate%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28tokens+%2B+tokenRaised+%26gt%3B+currentSupply%29+%3Cspan+class%3D%22hljs-keyword%22%3Ethrow%3C%2Fspan%3E%3B%0A%0A++++++++tokenRaised+%3D+safeAdd%28tokenRaised%2C+tokens%29%3B%0A++++++++balances%5Bmsg.sender%5D+%2B%3D+tokens%3B%0A%0A++++++++IssueToken%28msg.sender%2C+tokens%29%3B++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E8%AE%B0%E5%BD%95%E6%97%A5%E5%BF%97%3C%2Fspan%3E%0A++++%7D%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fmarkdown_views-ea0013b516.css%22%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fliudashuang2017%2Farticle%2Fdetails%2F79968813%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fliudashuang2017%2Farticle%2Fdetails%2F79968813%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}