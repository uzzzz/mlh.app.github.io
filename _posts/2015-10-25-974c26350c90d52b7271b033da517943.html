---
layout: default
title: 【AHK】给通达信软件增加F1买入，F2卖出 交易热键(基于中银国际客户端测试)
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3E%E4%BA%A4%E6%98%93%E8%BD%AF%E4%BB%B6%E9%83%BD%E5%81%9A%E5%BE%97%E5%B7%AE%E5%BC%BA%E4%BA%BA%E6%84%8F%E3%80%82%E3%80%82%E3%80%82%E5%90%8C%E8%8A%B1%E9%A1%BA%E6%9C%89%E7%83%AD%E9%94%AEF1%E5%91%BC%E5%87%BA%E4%B9%B0%E5%85%A5%E5%92%8CF2%E5%8D%96%E5%87%BA%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%88%E8%A7%81%E4%B8%8B%E5%9B%BE%EF%BC%89%EF%BC%8C%E9%80%9A%E8%BE%BE%E4%BF%A1%E5%88%99%E6%B2%A1%E6%9C%89%28%E6%98%AF%E6%9C%89%E6%95%B0%E5%AD%97%E7%83%AD%E9%94%AE221%2C223+%E6%80%BB%E4%B9%8B%E6%98%AF%E5%88%AB%E6%89%AD%29%3C%2Fp%3E+%0A++%3Cp%3E%3Cimg+alt%3D%22%E5%90%8C%E8%8A%B1%E9%A1%BA%E7%9A%84%E4%BA%A4%E6%98%93%E7%95%8C%E9%9D%A2%22+src%3D%22https%3A%2F%2Fblog.uzzz.org%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdn.net%2F20151025224048898%3Fwatermark%2F2%2Ftext%2FaHR0cDovL2Jsb2cuY3Nkbi5uZXQv%2Ffont%2F5a6L5L2T%2Ffontsize%2F400%2Ffill%2FI0JBQkFCMA%3D%3D%2Fdissolve%2F70%2Fgravity%2FCenter%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%E6%9D%A5%E4%B8%BA%E9%80%9A%E8%BE%BE%E4%BF%A1%E6%99%AE%E9%80%9A%E4%B9%B0%E5%85%A5%E5%8D%96%E5%87%BA%E5%8A%9F%E8%83%BD%E5%A2%9E%E5%8A%A0%E7%83%AD%E9%94%AE%21%EF%BC%88%E7%A8%8B%E5%BA%8F%E5%8C%96%E4%BA%A4%E6%98%93%E7%9A%84%E5%85%88%E5%BE%97%E8%83%BD%E5%91%BC%E5%8F%AB%E5%87%BA%E4%B9%B0%E5%8D%96%E5%8A%9F%E8%83%BD%E7%84%B6%E5%90%8E%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%8D%95%EF%BC%89%3C%2Fp%3E+%0A++%3Cp%3E%EF%BC%88%E6%9C%89%E9%92%B1%E7%9A%84%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%B4%AD%E4%B9%B0fix%E5%8D%8F%E8%AE%AE%E6%88%96%E8%80%85dll%E6%8E%A5%E5%8F%A3%EF%BC%8C%E6%B2%A1%E9%92%B1%E7%9A%84%E7%94%A8ahk%E6%A8%A1%E6%8B%9F%E4%BA%BA%E6%9D%A5%E6%93%8D%E4%BD%9C%E5%90%A7%EF%BC%8C%E7%A9%B7%E5%BE%97%E8%9B%8B%E7%96%BC%E3%80%82%E3%80%82%E3%80%82%EF%BC%89%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%E3%80%90%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E3%80%91%3C%2Fp%3E+%0A++%3Ch2%3E+%3C%2Fh2%3E%0A++%3Cdiv+style%3D%22text-align%3Aleft%3Bbackground-color%3Argb%28255%2C255%2C255%29%3Bfont-style%3Anormal%3Bfont-family%3A%27%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91%27%3Bcolor%3Argb%280%2C0%2C0%29%3Bfont-size%3A14px%3Bfont-weight%3Anormal%3B%22%3E%0A++++MSAA%E7%9A%84%E5%85%A8%E7%A7%B0%E6%98%AFMicrosoft+Active+Accessibility%E3%80%82%E8%BF%99%E6%98%AF%E7%B1%BB%E4%BC%BCDCOM%E6%8A%80%E6%9C%AF%E3%80%82%0A++%3C%2Fdiv%3E+%0A++%3Cdiv+style%3D%22text-align%3Aleft%3Bbackground-color%3Argb%28255%2C255%2C255%29%3Bfont-style%3Anormal%3Bfont-family%3A%27%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91%27%3Bcolor%3Argb%280%2C0%2C0%29%3Bfont-size%3A14px%3Bfont-weight%3Anormal%3B%22%3E%0A++++%E6%8A%80%E6%9C%AF%E6%A8%A1%E5%9E%8B%E6%98%AF%E8%BF%99%E6%A0%B7%E7%9A%84%EF%BC%8CUI%E7%A8%8B%E5%BA%8F%E5%8F%AF%E4%BB%A5%E6%9A%B4%E9%9C%B2%E5%87%BA%E4%B8%80%E4%B8%AAInterface%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F%E5%AF%B9%E5%85%B6%E8%BF%9B%E8%A1%8C%E6%8E%A7%E5%88%B6%E3%80%82%0A++%3C%2Fdiv%3E+%0A++%3Cdiv+style%3D%22text-align%3Aleft%3Bbackground-color%3Argb%28255%2C255%2C255%29%3Bfont-style%3Anormal%3Bfont-family%3A%27%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91%27%3Bcolor%3Argb%280%2C0%2C0%29%3Bfont-size%3A14px%3Bfont-weight%3Anormal%3B%22%3E%0A++++MSAA%E6%8A%80%E6%9C%AF%E7%9A%84%E5%88%9D%E8%A1%B7%E6%98%AF%E4%B8%BA%E4%BA%86%E6%96%B9%E4%BE%BF%E6%AE%8B%E7%96%BE%E4%BA%BA%E4%BD%BF%E7%94%A8Windows+%E7%A8%8B%E5%BA%8F%E3%80%82%0A+++%3Cspan%3E%E8%87%AA%E5%8A%A8%E5%8C%96%E8%87%AA%E7%84%B6%E5%8F%AF%E4%BB%A5%E5%80%9F%E7%94%A8%E8%BF%99%E9%A1%B9%E6%8A%80%E6%9C%AF%E3%80%82%3C%2Fspan%3E%0A++%3C%2Fdiv%3E+%0A++%3Cp%3E%3Cspan+style%3D%22font-family%3A%27Arial+Unicode+MS%27%3Bfont-size%3A14px%3B%22%3E%3Cimg+src%3D%22https%3A%2F%2Fblog.uzzz.org%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdn.net%2F20151025233452286%3Fwatermark%2F2%2Ftext%2FaHR0cDovL2Jsb2cuY3Nkbi5uZXQv%2Ffont%2F5a6L5L2T%2Ffontsize%2F400%2Ffill%2FI0JBQkFCMA%3D%3D%2Fdissolve%2F70%2Fgravity%2FCenter%22+alt%3D%22%22%3E%3Cbr%3E+%26nbsp%3B%5B%E6%BA%90%E4%BB%A3%E7%A0%81%5D%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22font-family%3A%27Arial+Unicode+MS%27%3Bfont-size%3A14px%3B%22%3E%3C%2Fspan%3E%3C%2Fp%3E%0A++%3Cpre%3E%3Ccode+class%3D%22language-vb%22%3E%3B%E5%8A%9F%E8%83%BD%EF%BC%9A%E7%BB%99%E9%80%9A%E8%BE%BE%E4%BF%A1%E8%BD%AF%E4%BB%B6%E5%A2%9E%E5%8A%A0%E7%B1%BB%E4%BC%BC%E5%90%8C%E8%8A%B1%E9%A1%BA%E7%9A%84%E4%BA%A4%E6%98%93%E5%8A%9F%E8%83%BD%E7%83%AD%E9%94%AE%0A%3B2015%E5%B9%B410%E6%9C%8825%E6%97%A511%3A39%3A03%0A%3B%E4%BD%9C%E8%80%85%EF%BC%9Asunwind%0A++%23SingleInstance%2CForce%0A++DetectHiddenWindows%2COn%0A++WINNAME+%3A%3D+%22TdxW_MainFrame_Class%22%0A++CTRLNAME+%3A%3D+%22MHPToolBar1%22%0A++hwnd%3A%3DControlGetHwnd%28CTRLNAME%2C+WINNAME%29%0A+%0A++idObject%3A%3D0%0A++%3B%7E+window+++%3A%3D0++SELF%0A++%3B%7E+client+++%3A%3D++-4++%0A++%3B%7E+child_1+%3A%3D+1%3B%0A++%3B%7E+child_2+%3A%3D+2%3B%0A++%3B%7E+child_3+%3A%3D+3%3B%0A+%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3DMHPToolBar1%3D%3D%3D%3D%3D%3D%3D%3D%0A++%3B%E6%8C%89%E9%92%AE%E6%89%80%E5%9C%A8%E7%9A%84%E2%80%9C%E5%B0%8F%E2%80%9D%E7%AA%97%E5%8F%A3%0A++window+%3A%3D+Acc_ObjectFromWindow%28hwnd%2C+idObject%29++%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3DMainViewBar%3D%3D%3D%3D%3D%3D%3D%3D%0A++%3B%E7%AA%97%E5%8F%A3%E9%87%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7%E6%A0%8F%0A++MainViewBar%3A%3D+Acc_Children%28window%29%5B3%5D%0A++++%0A%0A%3B%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%98%AF%E5%9F%BA%E4%BA%8E%E4%B8%AD%E9%93%B6%E5%9B%BD%E9%99%85%E4%BA%A4%E6%98%93%E8%BD%AF%E4%BB%B6%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%8B%E8%AF%95%E7%9A%84%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3D%E4%B9%B0%E5%85%A5%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A++buy%3A%3D+Acc_Children%28MainViewBar%29%5B1%5D%0A++%3B%7E+MsgBox+%25+Acc_Role%28buy%29++%22+%3A%3A+%22+buy.accName%280%29%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3D%E5%8D%96%E5%87%BA%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A++sell%3A%3D+Acc_Children%28MainViewBar%29%5B2%5D%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3D%E6%92%A4%E5%8D%95%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A++cancel%3A%3D+Acc_Children%28MainViewBar%29%5B3%5D%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3D%E6%88%90%E4%BA%A4%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A++chengjiao%3A%3D+Acc_Children%28MainViewBar%29%5B4%5D%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3D%E6%8C%81%E4%BB%93%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A++chicang%3A%3D+Acc_Children%28MainViewBar%29%5B5%5D%0A++%0A%0A%0A%0A%3B%E6%8B%9B%E5%95%86%E8%AF%81%E5%88%B8%E7%9A%84%0A%0A%3B%3D%3D%3D%3D%3D%3D%3D%3D%E4%B9%B0%E5%85%A5%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A%3Bbuy%3A%3D+Acc_Children%28MainViewBar%29%5B12%5D%0A%3B%3D%3D%3D%3D%3D%3D%3D%3D%E5%8D%96%E5%87%BA%E6%8C%89%E9%92%AE%3D%3D%3D%3D%3D%3D%3D%3D%0A%3Bsell%3A%3D+Acc_Children%28MainViewBar%29%5B13%5D%0A%0A%3B%E8%BF%99%E4%BA%9B%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2%EF%BC%8C%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0AccViewer%E5%B7%A5%E5%85%B7%E3%80%82%0A%0A%0A%3B%3D%3D%3D%3D%3D%3D%3D%3D%E7%83%AD%E9%94%AE%E5%AE%9A%E4%B9%89%3D%3D%3D%3D%3D%3D%3D%3D%0A%0A%3BF1%E4%B9%B0%E5%85%A5%EF%BC%8CF2%E5%8D%96%E5%87%BA%EF%BC%8CF3%E6%92%A4%E5%8D%95%EF%BC%8CF4%E6%8C%81%E4%BB%93%E6%9F%A5%E8%AF%A2%0A++f1%3A%3A+%0A++buy.accDoDefaultAction%280%29%0A++return%0A+%0A++f2%3A%3A%0A++sell.accDoDefaultAction%280%29%0A++return%0A+%0A++f3%3A%3A%0A++cancel.accDoDefaultAction%280%29%0A++return%0A+%0A++f4%3A%3A%0A++chicang.accDoDefaultAction%280%29%0A++return%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3D%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0%3D%3D%3D%3D%3D%3D%3D%3D%0A++ControlGetHwnd%28aCtrl%2C+aWin%29%0A%7B%0A++++++ControlGet%2C+cID%2Chwnd%2C+%2C+%25aCtrl%25%2C+ahk_class+%25aWin%25%0A++++++Return+cID%0A++%7D%0A+%0A+%0A++%3B%3D%3D%3D%3D%3D%3D%3D%3Dacc%E5%BA%93%E5%87%BD%E6%95%B0%3D%3D%3D%3D%3D%3D%3D%3D%0A++%3B+Written+by+jethrow%0AAcc_Init%28%29%0A%7B%0A%09Static%09h%0A%09If+Not%09h%0A%09%09h%3A%3DDllCall%28%22LoadLibrary%22%2C%22Str%22%2C%22oleacc%22%2C%22Ptr%22%29%0A%7D%0AAcc_Query%28Acc%29+%7B+%3B+thanks+Lexikos+-+www.autohotkey.com%2Fforum%2Fviewtopic.php%3Ft%3D81731%26amp%3Bp%3D509530%23509530%0A%09try+return+ComObj%289%2C+ComObjQuery%28Acc%2C%22%7B618736e0-3c3d-11cf-810c-00aa00389b71%7D%22%29%2C+1%29%0A%7D%0AAcc_Error%28p%3D%22%22%29+%7B%0A%09static+setting%3A%3D0%0A%09return+p%3D%22%22%3Fsetting%3Asetting%3A%3Dp%0A%7D%0AAcc_ObjectFromWindow%28hWnd%2C+idObject+%3D+0%29%0A%7B%0A%09Acc_Init%28%29%0A%09If%09DllCall%28%22oleacc%5CAccessibleObjectFromWindow%22%2C+%22Ptr%22%2C+hWnd%2C+%22UInt%22%2C+idObject%26amp%3B%3D0xFFFFFFFF%2C+%22Ptr%22%2C+-VarSetCapacity%28IID%2C16%29%2BNumPut%28idObject%3D%3D0xFFFFFFF0%3F0x46000000000000C0%3A0x719B3800AA000C81%2CNumPut%28idObject%3D%3D0xFFFFFFF0%3F0x0000000000020400%3A0x11CF3C3D618736E0%2CIID%2C%22Int64%22%29%2C%22Int64%22%29%2C+%22Ptr*%22%2C+pacc%29%3D0%0A%09Return%09ComObjEnwrap%289%2Cpacc%2C1%29%0A%7D%0A+%0AAcc_Children%28Acc%29+%7B%0A%09if+ComObjType%28Acc%2C%22Name%22%29+%21%3D+%22IAccessible%22%0A%09%09ErrorLevel+%3A%3D+%22Invalid+IAccessible+Object%22%0A%09else+%7B%0A%09%09Acc_Init%28%29%2C+cChildren%3A%3DAcc.accChildCount%2C+Children%3A%3D%5B%5D%0A%09%09if+DllCall%28%22oleacc%5CAccessibleChildren%22%2C+%22Ptr%22%2CComObjValue%28Acc%29%2C+%22Int%22%2C0%2C+%22Int%22%2CcChildren%2C+%22Ptr%22%2CVarSetCapacity%28varChildren%2CcChildren*%288%2B2*A_PtrSize%29%2C0%29*0%2B%26amp%3BvarChildren%2C+%22Int*%22%2CcChildren%29%3D0+%7B%0A%09%09%09Loop+%25cChildren%25%0A%09%09%09%09i%3A%3D%28A_Index-1%29*%28A_PtrSize*2%2B8%29%2B8%2C+child%3A%3DNumGet%28varChildren%2Ci%29%2C+Children.Insert%28NumGet%28varChildren%2Ci-8%29%3D9%3FAcc_Query%28child%29%3Achild%29%2C+NumGet%28varChildren%2Ci-8%29%3D9%3FObjRelease%28child%29%3A%0A%09%09%09return+Children.MaxIndex%28%29%3FChildren%3A%0A%09%09%7D+else%0A%09%09%09ErrorLevel+%3A%3D+%22AccessibleChildren+DllCall+Failed%22%0A%09%7D%0A%09if+Acc_Error%28%29%0A%09%09throw+Exception%28ErrorLevel%2C-1%29%0A%7D%0A+%0AAcc_Role%28Acc%2C+ChildId%3D0%29+%7B%0A%09try+return+ComObjType%28Acc%2C%22Name%22%29%3D%22IAccessible%22%3FAcc_GetRoleText%28Acc.accRole%28ChildId%29%29%3A%22invalid+object%22%0A%7D%0AAcc_GetRoleText%28nRole%29%0A%7B%0A%09nSize+%3A%3D+DllCall%28%22oleacc%5CGetRoleText%22%2C+%22Uint%22%2C+nRole%2C+%22Ptr%22%2C+0%2C+%22Uint%22%2C+0%29%0A%09VarSetCapacity%28sRole%2C+%28A_IsUnicode%3F2%3A1%29*nSize%29%0A%09DllCall%28%22oleacc%5CGetRoleText%22%2C+%22Uint%22%2C+nRole%2C+%22str%22%2C+sRole%2C+%22Uint%22%2C+nSize%2B1%29%0A%09Return%09sRole%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E%0A++%3Cspan+id%3D%22ln115%22%3E%3Cspan+style%3D%22font-family%3A%27Arial+Unicode+MS%27%3Bfont-size%3A14px%3B%22%3E%3C%2Fspan%3E%3C%2Fspan%3E%0A++%3Cspan+style%3D%22font-family%3A%27Arial+Unicode+MS%27%3Bfont-size%3A14px%3B%22%3E%3C%2Fspan%3E%0A++%3Cbr%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fliuyukuan%2Farticle%2Fdetails%2F49407773%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fliuyukuan%2Farticle%2Fdetails%2F49407773%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}