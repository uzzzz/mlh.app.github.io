---
layout: default
title: 【python】调用sklearn使用k-means模型
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Efrom+sklearn.cluster+import+KMeans%0Afrom+sklearn.decomposition+import+PCA%0Aimport+pandas+as+pd%0Aimport+numpy+as+np%0Aimport+matplotlib+as+mpl%0A%23iOS%E7%B3%BB%E7%BB%9F%0Ampl.use%28%27TkAgg%27%29%0Aimport+matplotlib.pyplot+as+plt%0Afrom+sklearn.preprocessing+import+Imputer++%23+%E5%AF%BC%E5%85%A5sklearn.preprocessing%E4%B8%AD%E7%9A%84Imputer%E5%BA%93%0A+%0A%23%E8%81%9A%E7%B1%BB%E6%95%B0%E6%8D%AE%0Adf%3Dpd.read_csv%28%27overdue+%285%29.csv%27%2C+header%3DNone%2Cencoding%3D%27utf-8%27%2Csep%3D%27%5Ct%27%29%0A%0A%23%E5%8E%BB%E6%8E%89%E7%AC%AC%E4%B8%80%E5%88%97%EF%BC%88index%EF%BC%89%0Adf2+%3D+df.drop%28df.columns%5B0%5D%2C+axis%3D1%29%0A%0A%23%E5%BD%92%E4%B8%80%E5%8C%96%E5%A4%84%E7%90%86%0A%23df3%3D%28df2+-+df2.min%28%29%29+%2F+%28df2.max%28%29+-+df2.min%28%29%29%0Adf1+%3D+df2.fillna%28df2.mean%28%29%29+%23+%E7%94%A8%E5%B9%B3%E5%9D%87%E6%95%B0%E4%BB%A3%E6%9B%BF%2C%E9%80%89%E6%8B%A9%E5%90%84%E8%87%AA%E5%88%97%E7%9A%84%E5%9D%87%E5%80%BC%E6%9B%BF%E6%8D%A2%E7%BC%BA%E5%A4%B1%E5%80%BC%0A%0A%23K-means%E8%81%9A%E7%B1%BB%0Akmeans+%3D+KMeans%28n_clusters%3D5%2C+random_state%3D10%29.fit%28df1%29%0Adf1%5B%27jllable%27%5D%3Dkmeans.labels_%0Adf_count_type%3Ddf1.groupby%28%27jllable%27%29.apply%28np.size%29%0A%0A%23%23%E5%90%84%E4%B8%AA%E7%B1%BB%E5%88%AB%E7%9A%84%E6%95%B0%E7%9B%AE%0Aprint%28df_count_type%29%0A%23%23%E8%81%9A%E7%B1%BB%E4%B8%AD%E5%BF%83%0Aprint%28kmeans.cluster_centers_%29%0A%23%23%E6%96%B0%E7%9A%84dataframe%EF%BC%8C%E5%91%BD%E5%90%8D%E4%B8%BAnew_df+%EF%BC%8C%E5%B9%B6%E8%BE%93%E5%87%BA%E5%88%B0%E6%9C%AC%E5%9C%B0%EF%BC%8C%E5%91%BD%E5%90%8D%E4%B8%BAnew_df.csv%E3%80%82%0Anew_df%3Ddf1%5B%3A%5D%0Anew_df%0Anew_df.to_csv%28%27new_df.csv%27%29%0A+%0A%23%23%E5%B0%86%E7%94%A8%E4%BA%8E%E8%81%9A%E7%B1%BB%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9A%84%E7%89%B9%E5%BE%81%E7%9A%84%E7%BB%B4%E5%BA%A6%E9%99%8D%E8%87%B32%E7%BB%B4%EF%BC%8C%E5%B9%B6%E8%BE%93%E5%87%BA%E9%99%8D%E7%BB%B4%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%BD%A2%E6%88%90%E4%B8%80%E4%B8%AAdataframe%E5%90%8D%E5%AD%97new_pca%0Apca+%3D+PCA%28n_components%3D2%29%0Anew_pca+%3D+pd.DataFrame%28pca.fit_transform%28new_df%29%29%0A+%0A%23%23%E5%8F%AF%E8%A7%86%E5%8C%96%0Ad+%3D+new_pca%5Bnew_df%5B%27jllable%27%5D+%3D%3D+0%5D%0Aplt.plot%28d%5B0%5D%2C+d%5B1%5D%2C+%27r.%27%29%0Ad+%3D+new_pca%5Bnew_df%5B%27jllable%27%5D+%3D%3D+1%5D%0Aplt.plot%28d%5B0%5D%2C+d%5B1%5D%2C+%27go%27%29%0Ad+%3D+new_pca%5Bnew_df%5B%27jllable%27%5D+%3D%3D+2%5D%0Aplt.plot%28d%5B0%5D%2C+d%5B1%5D%2C+%27b*%27%29%0Aplt.gcf%28%29.savefig%28%27kmeans.png%27%29%0Aplt.show%28%29%0A%0A%23%E4%BB%A5%E4%B8%8B%E4%B8%BA%E9%A2%84%E6%B5%8B%0Adf_y%3Dpd.read_csv%28%27overdue+%286%29.csv%27%2C+header%3DNone%2Cencoding%3D%27utf-8%27%2Csep%3D%27%5Ct%27%29%0A%0A%23%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%8E%E4%B8%8A%E9%9D%A2%E7%9B%B8%E5%90%8C%0A%23%E5%8E%BB%E6%8E%89%E7%AC%AC%E4%B8%80%E5%88%97%EF%BC%88index%E5%88%97%EF%BC%89%0Adf2_y+%3D+df_y.drop%28df_y.columns%5B0%5D%2C+axis%3D1%29%0A%23%E5%A4%84%E7%90%86%E7%A9%BA%E5%80%BC%0Adf1_y+%3D+df2_y.fillna%28df2_y.mean%28%29%29%0Adf1_y+%3D+df1_y.fillna%281%29%0A%23%E9%A2%84%E6%B5%8B%0Adf_y%5B%27ls%27%5D+%3D+kmeans.predict%28df1_y%29++%23+%E9%A2%84%E6%B5%8B%E8%81%9A%E7%B1%BB%E6%A8%A1%E5%9E%8B%0Anew_df_y%3Ddf_y%5B%3A%5D%0A%23%E8%BE%93%E5%87%BA%0Anew_df_y.to_csv%28%27new_df_y.csv%27%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}