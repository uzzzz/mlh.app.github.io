---
layout: default
title: Excel添加SHA256计算函数
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cpre%3E%E5%B7%A5%E4%BD%9C%E4%B8%AD%E9%9C%80%E8%A6%81%E5%B0%86%E4%B8%80%E6%89%B9Email%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2%E6%88%90SHA256%E7%9A%84%E5%80%BC%EF%BC%8C%E8%83%BD%E6%83%B3%E5%88%B0%E7%9A%84%E6%9C%80%E6%96%B9%E4%BE%BF%E7%9A%84%E6%96%B9%E6%B3%95%E8%8E%AB%E8%BF%87%E4%BA%8E%E9%80%9A%E8%BF%87Excel%E7%9A%84VBA%E6%9D%A5%E5%AE%9E%E7%8E%B0%E4%BA%86%EF%BC%8C%E4%BD%86%E6%98%AF%E4%BB%8E%E6%9D%A5%E6%B2%A1%E6%9C%89%E5%86%99%E8%BF%87VBA%E7%9A%84%E7%A8%8B%E5%BA%8F%EF%BC%8C%E7%99%BE%E5%BA%A6%E4%B9%9F%E6%B2%A1%E6%90%9C%E5%88%B0%E6%9C%89%E7%94%A8%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%8F%AA%E8%83%BD%E5%8E%BBGoogle%E4%B8%8A%E6%9F%A5%EF%BC%8C%E5%BE%88Easy%E7%9A%84%E5%9C%A8Stackoverflow%E6%89%BE%E5%88%B0%E4%B8%80%E4%B8%AA%E6%9C%89%E7%94%A8%E7%9A%84%E9%97%AE%E7%AD%94%EF%BC%9A%0A%3C%2Fpre%3E%0A++%3Cblockquote%3E%0A+++%E5%8F%82%E8%80%83%E9%97%AE%E7%AD%94%EF%BC%9A%0A+++%3Ca+href%3D%22http%3A%2F%2Fstackoverflow.com%2Fquestions%2F22672564%2Fporting-sha-256-library-to-excel%22+rel%3D%22nofollow%22%3Ehttp%3A%2F%2Fstackoverflow.com%2Fquestions%2F22672564%2Fporting-sha-256-library-to-excel%3C%2Fa%3E%0A++%3C%2Fblockquote%3E+%E6%93%8D%E4%BD%9C%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E5%B0%86%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8B%EF%BC%8C%E5%BD%93%E4%BD%9C%E5%A4%87%E5%BF%98%EF%BC%8C%E4%B9%9F%E6%96%B9%E4%BE%BF%E5%85%B6%E4%BB%96%E4%BA%BA%E5%8F%82%E8%80%83%E3%80%82+%E6%9C%AC%E6%96%87%E4%BB%A5Excel2010%E4%B8%BA%E4%BE%8B%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C%EF%BC%8C%E5%90%8C%E6%97%B6%E5%9C%A8WPS2013%E4%B8%8A%E9%AA%8C%E8%AF%81%E4%B9%9F%E6%B2%A1%E6%9C%89%E9%97%AE%E9%A2%98%E3%80%82+%E4%B8%8B%E9%9D%A2%E6%98%AF%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4%EF%BC%9A+1%E3%80%81%E7%82%B9%E5%87%BB%E2%80%9C%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E2%80%9D%E9%A1%B5%E9%9D%A2%E7%9A%84%E2%80%9CVisual+Basic%E2%80%9D+%0A++%3Ca+href%3D%22http%3A%2F%2Fxuhehuan.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fexcel-visual-basic.jpg%22+rel%3D%22nofollow%22%3E%3Cimg+class%3D%22alignnone+size-full+wp-image-2318%22+src%3D%22http%3A%2F%2Fxuhehuan.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fexcel-visual-basic.jpg%22+alt%3D%22excel-visual-basic%22%3E%3C%2Fa%3E+2%E3%80%81%E5%9C%A8%E6%89%93%E5%BC%80%E7%95%8C%E9%9D%A2%E7%9A%84%E2%80%9C%E5%B7%A5%E7%A8%8B%E2%80%9D%E7%A9%BA%E7%99%BD%E5%A4%84%E7%82%B9%E5%87%BB%E5%8F%B3%E9%94%AE%EF%BC%8C%E9%80%89%E6%8B%A9%E6%8F%92%E5%85%A5%E7%B1%BB%E6%A8%A1%E5%9D%97+%0A++%3Ca+href%3D%22http%3A%2F%2Fxuhehuan.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fexcel-class-module.jpg%22+rel%3D%22nofollow%22%3E%3Cimg+class%3D%22alignnone+size-full+wp-image-2315%22+src%3D%22http%3A%2F%2Fxuhehuan.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fexcel-class-module.jpg%22+alt%3D%22excel-class-module%22%3E%3C%2Fa%3E+3%E3%80%81%E5%9C%A8%E6%89%93%E5%BC%80%E7%9A%84%E7%B1%BB1%E6%96%87%E4%BB%B6%E4%B8%AD%E8%BE%93%E5%85%A5%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81+%0A++%3Cpre%3E%3Ccode+class%3D%22language-vb%22%3E%27*******************************************************************************%0A%27+MODULE%3A+++++++CSHA256%0A%27+FILENAME%3A+++++CSHA256.cls%0A%27+AUTHOR%3A+++++++Phil+Fresle%0A%27+CREATED%3A++++++10-Apr-2001%0A%27+COPYRIGHT%3A++++Copyright+2001+Phil+Fresle.+All+Rights+Reserved.%0A%27%0A%27+DESCRIPTION%3A%0A%27+This+class+is+used+to+generate+a+SHA-256+%27digest%27+or+%27signature%27+of+a+string.%0A%27+The+SHA-256+algorithm+is+one+of+the+industry+standard+methods+for+generating%0A%27+digital+signatures.+It+is+generically+known+as+a+digest%2C+digital+signature%2C%0A%27+one-way+encryption%2C+hash+or+checksum+algorithm.+A+common+use+for+SHA-256+is%0A%27+for+password+encryption+as+it+is+one-way+in+nature%2C+that+does+not+mean+that%0A%27+your+passwords+are+not+free+from+a+dictionary+attack.+If+you+are+using+the%0A%27+routine+for+passwords%2C+you+can+make+it+a+little+more+secure+by+concatenating%0A%27+some+known+random+characters+to+the+password+before+you+generate+the+signature%0A%27+and+on+subsequent+tests%2C+so+even+if+a+hacker+knows+you+are+using+SHA-256+for%0A%27+your+passwords%2C+the+random+characters+will+make+it+harder+to+dictionary+attack.%0A%27%0A%27+***+CAUTION+***%0A%27+See+the+comment+attached+to+the+SHA256+method+below+regarding+use+on+systems%0A%27+with+different+character+sets.%0A%27%0A%27+This+is+%27free%27+software+with+the+following+restrictions%3A%0A%27%0A%27+You+may+not+redistribute+this+code+as+a+%27sample%27+or+%27demo%27.+However%2C+you+are+free%0A%27+to+use+the+source+code+in+your+own+code%2C+but+you+may+not+claim+that+you+created%0A%27+the+sample+code.+It+is+expressly+forbidden+to+sell+or+profit+from+this+source+code%0A%27+other+than+by+the+knowledge+gained+or+the+enhanced+value+added+by+your+own+code.%0A%27%0A%27+Use+of+this+software+is+also+done+so+at+your+own+risk.+The+code+is+supplied+as%0A%27+is+without+warranty+or+guarantee+of+any+kind.%0A%27%0A%27+Should+you+wish+to+commission+some+derivative+work+based+on+this+code+provided%0A%27+here%2C+or+any+consultancy+work%2C+please+do+not+hesitate+to+contact+us.%0A%27%0A%27+Web+Site%3A++http%3A%2F%2Fwww.frez.co.uk%0A%27+E-mail%3A++++sales%40frez.co.uk%0A%27%0A%27+MODIFICATION+HISTORY%3A%0A%27+10-Apr-2001+++Phil+Fresle+++++Initial+Version%0A%27*******************************************************************************%0AOption+Explicit%0A%0APrivate+m_lOnBits%2830%29+++As+Long%0APrivate+m_l2Power%2830%29+++As+Long%0APrivate+K%2863%29+++++++++++As+Long%0A%0APrivate+Const+BITS_TO_A_BYTE++As+Long+%3D+8%0APrivate+Const+BYTES_TO_A_WORD+As+Long+%3D+4%0APrivate+Const+BITS_TO_A_WORD++As+Long+%3D+BYTES_TO_A_WORD+*+BITS_TO_A_BYTE%0A%0A%27*******************************************************************************%0A%27+Class_Initialize+%28SUB%29%0A%27*******************************************************************************%0APrivate+Sub+Class_Initialize%28%29%0A++++%27+Could+have+done+this+with+a+loop+calculating+each+value%2C+but+simply%0A++++%27+assigning+the+values+is+quicker+-+BITS+SET+FROM+RIGHT%0A++++m_lOnBits%280%29+%3D+1++++++++++++%27+00000000000000000000000000000001%0A++++m_lOnBits%281%29+%3D+3++++++++++++%27+00000000000000000000000000000011%0A++++m_lOnBits%282%29+%3D+7++++++++++++%27+00000000000000000000000000000111%0A++++m_lOnBits%283%29+%3D+15+++++++++++%27+00000000000000000000000000001111%0A++++m_lOnBits%284%29+%3D+31+++++++++++%27+00000000000000000000000000011111%0A++++m_lOnBits%285%29+%3D+63+++++++++++%27+00000000000000000000000000111111%0A++++m_lOnBits%286%29+%3D+127++++++++++%27+00000000000000000000000001111111%0A++++m_lOnBits%287%29+%3D+255++++++++++%27+00000000000000000000000011111111%0A++++m_lOnBits%288%29+%3D+511++++++++++%27+00000000000000000000000111111111%0A++++m_lOnBits%289%29+%3D+1023+++++++++%27+00000000000000000000001111111111%0A++++m_lOnBits%2810%29+%3D+2047++++++++%27+00000000000000000000011111111111%0A++++m_lOnBits%2811%29+%3D+4095++++++++%27+00000000000000000000111111111111%0A++++m_lOnBits%2812%29+%3D+8191++++++++%27+00000000000000000001111111111111%0A++++m_lOnBits%2813%29+%3D+16383+++++++%27+00000000000000000011111111111111%0A++++m_lOnBits%2814%29+%3D+32767+++++++%27+00000000000000000111111111111111%0A++++m_lOnBits%2815%29+%3D+65535+++++++%27+00000000000000001111111111111111%0A++++m_lOnBits%2816%29+%3D+131071++++++%27+00000000000000011111111111111111%0A++++m_lOnBits%2817%29+%3D+262143++++++%27+00000000000000111111111111111111%0A++++m_lOnBits%2818%29+%3D+524287++++++%27+00000000000001111111111111111111%0A++++m_lOnBits%2819%29+%3D+1048575+++++%27+00000000000011111111111111111111%0A++++m_lOnBits%2820%29+%3D+2097151+++++%27+00000000000111111111111111111111%0A++++m_lOnBits%2821%29+%3D+4194303+++++%27+00000000001111111111111111111111%0A++++m_lOnBits%2822%29+%3D+8388607+++++%27+00000000011111111111111111111111%0A++++m_lOnBits%2823%29+%3D+16777215++++%27+00000000111111111111111111111111%0A++++m_lOnBits%2824%29+%3D+33554431++++%27+00000001111111111111111111111111%0A++++m_lOnBits%2825%29+%3D+67108863++++%27+00000011111111111111111111111111%0A++++m_lOnBits%2826%29+%3D+134217727+++%27+00000111111111111111111111111111%0A++++m_lOnBits%2827%29+%3D+268435455+++%27+00001111111111111111111111111111%0A++++m_lOnBits%2828%29+%3D+536870911+++%27+00011111111111111111111111111111%0A++++m_lOnBits%2829%29+%3D+1073741823++%27+00111111111111111111111111111111%0A++++m_lOnBits%2830%29+%3D+2147483647++%27+01111111111111111111111111111111%0A++++%0A++++%27+Could+have+done+this+with+a+loop+calculating+each+value%2C+but+simply%0A++++%27+assigning+the+values+is+quicker+-+POWERS+OF+2%0A++++m_l2Power%280%29+%3D+1++++++++++++%27+00000000000000000000000000000001%0A++++m_l2Power%281%29+%3D+2++++++++++++%27+00000000000000000000000000000010%0A++++m_l2Power%282%29+%3D+4++++++++++++%27+00000000000000000000000000000100%0A++++m_l2Power%283%29+%3D+8++++++++++++%27+00000000000000000000000000001000%0A++++m_l2Power%284%29+%3D+16+++++++++++%27+00000000000000000000000000010000%0A++++m_l2Power%285%29+%3D+32+++++++++++%27+00000000000000000000000000100000%0A++++m_l2Power%286%29+%3D+64+++++++++++%27+00000000000000000000000001000000%0A++++m_l2Power%287%29+%3D+128++++++++++%27+00000000000000000000000010000000%0A++++m_l2Power%288%29+%3D+256++++++++++%27+00000000000000000000000100000000%0A++++m_l2Power%289%29+%3D+512++++++++++%27+00000000000000000000001000000000%0A++++m_l2Power%2810%29+%3D+1024++++++++%27+00000000000000000000010000000000%0A++++m_l2Power%2811%29+%3D+2048++++++++%27+00000000000000000000100000000000%0A++++m_l2Power%2812%29+%3D+4096++++++++%27+00000000000000000001000000000000%0A++++m_l2Power%2813%29+%3D+8192++++++++%27+00000000000000000010000000000000%0A++++m_l2Power%2814%29+%3D+16384+++++++%27+00000000000000000100000000000000%0A++++m_l2Power%2815%29+%3D+32768+++++++%27+00000000000000001000000000000000%0A++++m_l2Power%2816%29+%3D+65536+++++++%27+00000000000000010000000000000000%0A++++m_l2Power%2817%29+%3D+131072++++++%27+00000000000000100000000000000000%0A++++m_l2Power%2818%29+%3D+262144++++++%27+00000000000001000000000000000000%0A++++m_l2Power%2819%29+%3D+524288++++++%27+00000000000010000000000000000000%0A++++m_l2Power%2820%29+%3D+1048576+++++%27+00000000000100000000000000000000%0A++++m_l2Power%2821%29+%3D+2097152+++++%27+00000000001000000000000000000000%0A++++m_l2Power%2822%29+%3D+4194304+++++%27+00000000010000000000000000000000%0A++++m_l2Power%2823%29+%3D+8388608+++++%27+00000000100000000000000000000000%0A++++m_l2Power%2824%29+%3D+16777216++++%27+00000001000000000000000000000000%0A++++m_l2Power%2825%29+%3D+33554432++++%27+00000010000000000000000000000000%0A++++m_l2Power%2826%29+%3D+67108864++++%27+00000100000000000000000000000000%0A++++m_l2Power%2827%29+%3D+134217728+++%27+00001000000000000000000000000000%0A++++m_l2Power%2828%29+%3D+268435456+++%27+00010000000000000000000000000000%0A++++m_l2Power%2829%29+%3D+536870912+++%27+00100000000000000000000000000000%0A++++m_l2Power%2830%29+%3D+1073741824++%27+01000000000000000000000000000000%0A++++%0A++++%27+Just+put+together+the+K+array+once%0A++++K%280%29+%3D+%26amp%3BH428A2F98%0A++++K%281%29+%3D+%26amp%3BH71374491%0A++++K%282%29+%3D+%26amp%3BHB5C0FBCF%0A++++K%283%29+%3D+%26amp%3BHE9B5DBA5%0A++++K%284%29+%3D+%26amp%3BH3956C25B%0A++++K%285%29+%3D+%26amp%3BH59F111F1%0A++++K%286%29+%3D+%26amp%3BH923F82A4%0A++++K%287%29+%3D+%26amp%3BHAB1C5ED5%0A++++K%288%29+%3D+%26amp%3BHD807AA98%0A++++K%289%29+%3D+%26amp%3BH12835B01%0A++++K%2810%29+%3D+%26amp%3BH243185BE%0A++++K%2811%29+%3D+%26amp%3BH550C7DC3%0A++++K%2812%29+%3D+%26amp%3BH72BE5D74%0A++++K%2813%29+%3D+%26amp%3BH80DEB1FE%0A++++K%2814%29+%3D+%26amp%3BH9BDC06A7%0A++++K%2815%29+%3D+%26amp%3BHC19BF174%0A++++K%2816%29+%3D+%26amp%3BHE49B69C1%0A++++K%2817%29+%3D+%26amp%3BHEFBE4786%0A++++K%2818%29+%3D+%26amp%3BHFC19DC6%0A++++K%2819%29+%3D+%26amp%3BH240CA1CC%0A++++K%2820%29+%3D+%26amp%3BH2DE92C6F%0A++++K%2821%29+%3D+%26amp%3BH4A7484AA%0A++++K%2822%29+%3D+%26amp%3BH5CB0A9DC%0A++++K%2823%29+%3D+%26amp%3BH76F988DA%0A++++K%2824%29+%3D+%26amp%3BH983E5152%0A++++K%2825%29+%3D+%26amp%3BHA831C66D%0A++++K%2826%29+%3D+%26amp%3BHB00327C8%0A++++K%2827%29+%3D+%26amp%3BHBF597FC7%0A++++K%2828%29+%3D+%26amp%3BHC6E00BF3%0A++++K%2829%29+%3D+%26amp%3BHD5A79147%0A++++K%2830%29+%3D+%26amp%3BH6CA6351%0A++++K%2831%29+%3D+%26amp%3BH14292967%0A++++K%2832%29+%3D+%26amp%3BH27B70A85%0A++++K%2833%29+%3D+%26amp%3BH2E1B2138%0A++++K%2834%29+%3D+%26amp%3BH4D2C6DFC%0A++++K%2835%29+%3D+%26amp%3BH53380D13%0A++++K%2836%29+%3D+%26amp%3BH650A7354%0A++++K%2837%29+%3D+%26amp%3BH766A0ABB%0A++++K%2838%29+%3D+%26amp%3BH81C2C92E%0A++++K%2839%29+%3D+%26amp%3BH92722C85%0A++++K%2840%29+%3D+%26amp%3BHA2BFE8A1%0A++++K%2841%29+%3D+%26amp%3BHA81A664B%0A++++K%2842%29+%3D+%26amp%3BHC24B8B70%0A++++K%2843%29+%3D+%26amp%3BHC76C51A3%0A++++K%2844%29+%3D+%26amp%3BHD192E819%0A++++K%2845%29+%3D+%26amp%3BHD6990624%0A++++K%2846%29+%3D+%26amp%3BHF40E3585%0A++++K%2847%29+%3D+%26amp%3BH106AA070%0A++++K%2848%29+%3D+%26amp%3BH19A4C116%0A++++K%2849%29+%3D+%26amp%3BH1E376C08%0A++++K%2850%29+%3D+%26amp%3BH2748774C%0A++++K%2851%29+%3D+%26amp%3BH34B0BCB5%0A++++K%2852%29+%3D+%26amp%3BH391C0CB3%0A++++K%2853%29+%3D+%26amp%3BH4ED8AA4A%0A++++K%2854%29+%3D+%26amp%3BH5B9CCA4F%0A++++K%2855%29+%3D+%26amp%3BH682E6FF3%0A++++K%2856%29+%3D+%26amp%3BH748F82EE%0A++++K%2857%29+%3D+%26amp%3BH78A5636F%0A++++K%2858%29+%3D+%26amp%3BH84C87814%0A++++K%2859%29+%3D+%26amp%3BH8CC70208%0A++++K%2860%29+%3D+%26amp%3BH90BEFFFA%0A++++K%2861%29+%3D+%26amp%3BHA4506CEB%0A++++K%2862%29+%3D+%26amp%3BHBEF9A3F7%0A++++K%2863%29+%3D+%26amp%3BHC67178F2%0AEnd+Sub%0A%0A%27*******************************************************************************%0A%27+LShift+%28FUNCTION%29%0A%27%0A%27+PARAMETERS%3A%0A%27+%28In%29+-+lValue+++++-+Long++++-+The+value+to+be+shifted%0A%27+%28In%29+-+iShiftBits+-+Integer+-+The+number+of+bits+to+shift+the+value+by%0A%27%0A%27+RETURN+VALUE%3A%0A%27+Long+-+The+shifted+long+integer%0A%27%0A%27+DESCRIPTION%3A%0A%27+A+left+shift+takes+all+the+set+binary+bits+and+moves+them+left%2C+in-filling%0A%27+with+zeros+in+the+vacated+bits+on+the+right.+This+function+is+equivalent+to%0A%27+the+%26lt%3B%26lt%3B+operator+in+Java+and+C%2B%2B%0A%27*******************************************************************************%0APrivate+Function+LShift%28ByVal+lValue+As+Long%2C+_%0A++++++++++++++++++++++++ByVal+iShiftBits+As+Integer%29+As+Long%0A++++%27+NOTE%3A+If+you+can+guarantee+that+the+Shift+parameter+will+be+in+the%0A++++%27+range+1+to+30+you+can+safely+strip+of+this+first+nested+if+structure+for%0A++++%27+speed.%0A++++%27%0A++++%27+A+shift+of+zero+is+no+shift+at+all.%0A++++If+iShiftBits+%3D+0+Then%0A++++++++LShift+%3D+lValue%0A++++++++Exit+Function%0A++++++++%0A++++%27+A+shift+of+31+will+result+in+the+right+most+bit+becoming+the+left+most%0A++++%27+bit+and+all+other+bits+being+cleared%0A++++ElseIf+iShiftBits+%3D+31+Then%0A++++++++If+lValue+And+1+Then%0A++++++++++++LShift+%3D+%26amp%3BH80000000%0A++++++++Else%0A++++++++++++LShift+%3D+0%0A++++++++End+If%0A++++++++Exit+Function%0A++++++++%0A++++%27+A+shift+of+less+than+zero+or+more+than+31+is+undefined%0A++++ElseIf+iShiftBits+%26lt%3B+0+Or+iShiftBits+%26gt%3B+31+Then%0A++++++++Err.Raise+6%0A++++End+If%0A++++%0A++++%27+If+the+left+most+bit+that+remains+will+end+up+in+the+negative+bit%0A++++%27+position+%28%26amp%3BH80000000%29+we+would+end+up+with+an+overflow+if+we+took+the%0A++++%27+standard+route.+We+need+to+strip+the+left+most+bit+and+add+it+back%0A++++%27+afterwards.%0A++++If+%28lValue+And+m_l2Power%2831+-+iShiftBits%29%29+Then%0A++++%0A++++++++%27+%28Value+And+OnBits%2831+-+%28Shift+%2B+1%29%29%29+chops+off+the+left+most+bits+that%0A++++++++%27+we+are+shifting+into%2C+but+also+the+left+most+bit+we+still+want+as+this%0A++++++++%27+is+going+to+end+up+in+the+negative+bit+marker+position+%28%26amp%3BH80000000%29.%0A++++++++%27+After+the+multiplication%2Fshift+we+Or+the+result+with+%26amp%3BH80000000+to%0A++++++++%27+turn+the+negative+bit+on.%0A++++++++LShift+%3D+%28%28lValue+And+m_lOnBits%2831+-+%28iShiftBits+%2B+1%29%29%29+*+_%0A++++++++++++m_l2Power%28iShiftBits%29%29+Or+%26amp%3BH80000000%0A++++%0A++++Else%0A++++%0A++++++++%27+%28Value+And+OnBits%2831-Shift%29%29+chops+off+the+left+most+bits+that+we+are%0A++++++++%27+shifting+into+so+we+do+not+get+an+overflow+error+when+we+do+the%0A++++++++%27+multiplication%2Fshift%0A++++++++LShift+%3D+%28%28lValue+And+m_lOnBits%2831+-+iShiftBits%29%29+*+_%0A++++++++++++m_l2Power%28iShiftBits%29%29%0A++++++++%0A++++End+If%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+RShift+%28FUNCTION%29%0A%27%0A%27+PARAMETERS%3A%0A%27+%28In%29+-+lValue+++++-+Long++++-+The+value+to+be+shifted%0A%27+%28In%29+-+iShiftBits+-+Integer+-+The+number+of+bits+to+shift+the+value+by%0A%27%0A%27+RETURN+VALUE%3A%0A%27+Long+-+The+shifted+long+integer%0A%27%0A%27+DESCRIPTION%3A%0A%27+The+right+shift+of+an+unsigned+long+integer+involves+shifting+all+the+set+bits%0A%27+to+the+right+and+in-filling+on+the+left+with+zeros.+This+function+is%0A%27+equivalent+to+the+%26gt%3B%26gt%3B%26gt%3B+operator+in+Java+or+the+%26gt%3B%26gt%3B+operator+in+C%2B%2B+when+used+on%0A%27+an+unsigned+long.%0A%27*******************************************************************************%0APrivate+Function+RShift%28ByVal+lValue+As+Long%2C+_%0A++++++++++++++++++++++++ByVal+iShiftBits+As+Integer%29+As+Long%0A++++%0A++++%27+NOTE%3A+If+you+can+guarantee+that+the+Shift+parameter+will+be+in+the%0A++++%27+range+1+to+30+you+can+safely+strip+of+this+first+nested+if+structure+for%0A++++%27+speed.%0A++++%27%0A++++%27+A+shift+of+zero+is+no+shift+at+all%0A++++If+iShiftBits+%3D+0+Then%0A++++++++RShift+%3D+lValue%0A++++++++Exit+Function%0A++++++++%0A++++%27+A+shift+of+31+will+clear+all+bits+and+move+the+left+most+bit+to+the+right%0A++++%27+most+bit+position%0A++++ElseIf+iShiftBits+%3D+31+Then%0A++++++++If+lValue+And+%26amp%3BH80000000+Then%0A++++++++++++RShift+%3D+1%0A++++++++Else%0A++++++++++++RShift+%3D+0%0A++++++++End+If%0A++++++++Exit+Function%0A++++++++%0A++++%27+A+shift+of+less+than+zero+or+more+than+31+is+undefined%0A++++ElseIf+iShiftBits+%26lt%3B+0+Or+iShiftBits+%26gt%3B+31+Then%0A++++++++Err.Raise+6%0A++++End+If%0A++++%0A++++%27+We+do+not+care+about+the+top+most+bit+or+the+final+bit%2C+the+top+most+bit%0A++++%27+will+be+taken+into+account+in+the+next+stage%2C+the+final+bit+%28whether+it%0A++++%27+is+an+odd+number+or+not%29+is+being+shifted+into%2C+so+we+do+not+give+a+jot%0A++++%27+about+it%0A++++RShift+%3D+%28lValue+And+%26amp%3BH7FFFFFFE%29+%5C+m_l2Power%28iShiftBits%29%0A++++%0A++++%27+If+the+top+most+bit+%28%26amp%3BH80000000%29+was+set+we+need+to+do+things+differently%0A++++%27+as+in+a+normal+VB+signed+long+integer+the+top+most+bit+is+used+to+indicate%0A++++%27+the+sign+of+the+number%2C+when+it+is+set+it+is+a+negative+number%2C+so+just%0A++++%27+deviding+by+a+factor+of+2+as+above+would+not+work.%0A++++%27+NOTE%3A+%28lValue+And++%26amp%3BH80000000%29+is+equivalent+to+%28lValue+%26lt%3B+0%29%2C+you+could%0A++++%27+get+a+very+marginal+speed+improvement+by+changing+the+test+to+%28lValue+%26lt%3B+0%29%0A++++If+%28lValue+And+%26amp%3BH80000000%29+Then%0A++++++++%27+We+take+the+value+computed+so+far%2C+and+then+add+the+left+most+negative%0A++++++++%27+bit+after+it+has+been+shifted+to+the+right+the+appropriate+number+of%0A++++++++%27+places%0A++++++++RShift+%3D+%28RShift+Or+%28%26amp%3BH40000000+%5C+m_l2Power%28iShiftBits+-+1%29%29%29%0A++++End+If%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+AddUnsigned+%28FUNCTION%29%0A%27%0A%27+PARAMETERS%3A%0A%27+%28In%29+-+lX+-+Long+-+First+value%0A%27+%28In%29+-+lY+-+Long+-+Second+value%0A%27%0A%27+RETURN+VALUE%3A%0A%27+Long+-+Result%0A%27%0A%27+DESCRIPTION%3A%0A%27+Adds+two+potentially+large+unsigned+numbers+without+overflowing%0A%27*******************************************************************************%0APrivate+Function+AddUnsigned%28ByVal+lX+As+Long%2C+_%0A+++++++++++++++++++++++++++++ByVal+lY+As+Long%29+As+Long%0A++++Dim+lX4+++++As+Long%0A++++Dim+lY4+++++As+Long%0A++++Dim+lX8+++++As+Long%0A++++Dim+lY8+++++As+Long%0A++++Dim+lResult+As+Long%0A+%0A++++lX8+%3D+lX+And+%26amp%3BH80000000%0A++++lY8+%3D+lY+And+%26amp%3BH80000000%0A++++lX4+%3D+lX+And+%26amp%3BH40000000%0A++++lY4+%3D+lY+And+%26amp%3BH40000000%0A+%0A++++lResult+%3D+%28lX+And+%26amp%3BH3FFFFFFF%29+%2B+%28lY+And+%26amp%3BH3FFFFFFF%29%0A+%0A++++If+lX4+And+lY4+Then%0A++++++++lResult+%3D+lResult+Xor+%26amp%3BH80000000+Xor+lX8+Xor+lY8%0A++++ElseIf+lX4+Or+lY4+Then%0A++++++++If+lResult+And+%26amp%3BH40000000+Then%0A++++++++++++lResult+%3D+lResult+Xor+%26amp%3BHC0000000+Xor+lX8+Xor+lY8%0A++++++++Else%0A++++++++++++lResult+%3D+lResult+Xor+%26amp%3BH40000000+Xor+lX8+Xor+lY8%0A++++++++End+If%0A++++Else%0A++++++++lResult+%3D+lResult+Xor+lX8+Xor+lY8%0A++++End+If%0A+%0A++++AddUnsigned+%3D+lResult%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+Ch+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function%0A%27*******************************************************************************%0APrivate+Function+Ch%28ByVal+x+As+Long%2C+_%0A++++++++++++++++++++ByVal+y+As+Long%2C+_%0A++++++++++++++++++++ByVal+z+As+Long%29+As+Long%0A++++Ch+%3D+%28%28x+And+y%29+Xor+%28%28Not+x%29+And+z%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+Maj+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function%0A%27*******************************************************************************%0APrivate+Function+Maj%28ByVal+x+As+Long%2C+_%0A+++++++++++++++++++++ByVal+y+As+Long%2C+_%0A+++++++++++++++++++++ByVal+z+As+Long%29+As+Long%0A++++Maj+%3D+%28%28x+And+y%29+Xor+%28x+And+z%29+Xor+%28y+And+z%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+S+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function+%28rotate+right%29%0A%27*******************************************************************************%0APrivate+Function+S%28ByVal+x+As+Long%2C+_%0A+++++++++++++++++++ByVal+n+As+Long%29+As+Long%0A++++S+%3D+%28RShift%28x%2C+%28n+And+m_lOnBits%284%29%29%29+Or+LShift%28x%2C+%2832+-+%28n+And+m_lOnBits%284%29%29%29%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+R+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function+%28just+a+right+shift%29%0A%27*******************************************************************************%0APrivate+Function+R%28ByVal+x+As+Long%2C+_%0A+++++++++++++++++++ByVal+n+As+Long%29+As+Long%0A++++R+%3D+RShift%28x%2C+CInt%28n+And+m_lOnBits%284%29%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+Sigma0+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function%0A%27*******************************************************************************%0APrivate+Function+Sigma0%28ByVal+x+As+Long%29+As+Long%0A++++Sigma0+%3D+%28S%28x%2C+2%29+Xor+S%28x%2C+13%29+Xor+S%28x%2C+22%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+Sigma1+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function%0A%27*******************************************************************************%0APrivate+Function+Sigma1%28ByVal+x+As+Long%29+As+Long%0A++++Sigma1+%3D+%28S%28x%2C+6%29+Xor+S%28x%2C+11%29+Xor+S%28x%2C+25%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+Gamma0+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function%0A%27*******************************************************************************%0APrivate+Function+Gamma0%28ByVal+x+As+Long%29+As+Long%0A++++Gamma0+%3D+%28S%28x%2C+7%29+Xor+S%28x%2C+18%29+Xor+R%28x%2C+3%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+Gamma1+%28FUNCTION%29%0A%27%0A%27+DESCRIPTION%3A%0A%27+SHA-256+function%0A%27*******************************************************************************%0APrivate+Function+Gamma1%28ByVal+x+As+Long%29+As+Long%0A++++Gamma1+%3D+%28S%28x%2C+17%29+Xor+S%28x%2C+19%29+Xor+R%28x%2C+10%29%29%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+ConvertToWordArray+%28FUNCTION%29%0A%27%0A%27+PARAMETERS%3A%0A%27+%28In%2FOut%29+-+sMessage+-+String+-+String+message%0A%27%0A%27+RETURN+VALUE%3A%0A%27+Long%28%29+-+Converted+message+as+long+array%0A%27%0A%27+DESCRIPTION%3A%0A%27+Takes+the+string+message+and+puts+it+in+a+long+array+with+padding+according+to%0A%27+the+SHA-256+rules+%28similar+to+MD5+routine%29.%0A%27*******************************************************************************%0APrivate+Function+ConvertToWordArray%28sMessage+As+String%29+As+Long%28%29%0A++++Dim+lMessageLength++As+Long%0A++++Dim+lNumberOfWords++As+Long%0A++++Dim+lWordArray%28%29++++As+Long%0A++++Dim+lBytePosition+++As+Long%0A++++Dim+lByteCount++++++As+Long%0A++++Dim+lWordCount++++++As+Long%0A++++Dim+lByte+++++++++++As+Long%0A++++%0A++++Const+MODULUS_BITS++++++As+Long+%3D+512%0A++++Const+CONGRUENT_BITS++++As+Long+%3D+448%0A++++%0A++++lMessageLength+%3D+Len%28sMessage%29%0A++++%0A++++%27+Get+padded+number+of+words.+Message+needs+to+be+congruent+to+448+bits%2C%0A++++%27+modulo+512+bits.+If+it+is+exactly+congruent+to+448+bits%2C+modulo+512+bits%0A++++%27+it+must+still+have+another+512+bits+added.+512+bits+%3D+64+bytes%0A++++%27+%28or+16+*+4+byte+words%29%2C+448+bits+%3D+56+bytes.+This+means+lNumberOfWords+must%0A++++%27+be+a+multiple+of+16+%28i.e.+16+*+4+%28bytes%29+*+8+%28bits%29%29%0A++++lNumberOfWords+%3D+%28%28%28lMessageLength+%2B+_%0A++++++++%28%28MODULUS_BITS+-+CONGRUENT_BITS%29+%5C+BITS_TO_A_BYTE%29%29+%5C+_%0A++++++++%28MODULUS_BITS+%5C+BITS_TO_A_BYTE%29%29+%2B+1%29+*+_%0A++++++++%28MODULUS_BITS+%5C+BITS_TO_A_WORD%29%0A++++ReDim+lWordArray%28lNumberOfWords+-+1%29%0A++++%0A++++%27+Combine+each+block+of+4+bytes+%28ascii+code+of+character%29+into+one+long%0A++++%27+value+and+store+in+the+message.+The+high-order+%28most+significant%29+bit+of%0A++++%27+each+byte+is+listed+first.+However%2C+unlike+MD5+we+put+the+high-order%0A++++%27+%28most+significant%29+byte+first+in+each+word.%0A++++lBytePosition+%3D+0%0A++++lByteCount+%3D+0%0A++++Do+Until+lByteCount+%26gt%3B%3D+lMessageLength%0A++++++++%27+Each+word+is+4+bytes%0A++++++++lWordCount+%3D+lByteCount+%5C+BYTES_TO_A_WORD%0A++++++++%0A++++++++lBytePosition+%3D+%283+-+%28lByteCount+Mod+BYTES_TO_A_WORD%29%29+*+BITS_TO_A_BYTE%0A++++++++%0A++++++++%27+NOTE%3A+This+is+where+we+are+using+just+the+first+byte+of+each+unicode%0A++++++++%27+character%2C+you+may+want+to+make+the+change+here%2C+or+to+the+SHA256+method%0A++++++++%27+so+it+accepts+a+byte+array.%0A++++++++lByte+%3D+AscB%28Mid%28sMessage%2C+lByteCount+%2B+1%2C+1%29%29%0A++++++++%0A++++++++lWordArray%28lWordCount%29+%3D+lWordArray%28lWordCount%29+Or+LShift%28lByte%2C+lBytePosition%29%0A++++++++lByteCount+%3D+lByteCount+%2B+1%0A++++Loop%0A%0A++++%27+Terminate+according+to+SHA-256+rules+with+a+1+bit%2C+zeros+and+the+length+in%0A++++%27+bits+stored+in+the+last+two+words%0A++++lWordCount+%3D+lByteCount+%5C+BYTES_TO_A_WORD%0A++++lBytePosition+%3D+%283+-+%28lByteCount+Mod+BYTES_TO_A_WORD%29%29+*+BITS_TO_A_BYTE%0A%0A++++%27+Add+a+terminating+1+bit%2C+all+the+rest+of+the+bits+to+the+end+of+the%0A++++%27+word+array+will+default+to+zero%0A++++lWordArray%28lWordCount%29+%3D+lWordArray%28lWordCount%29+Or+_%0A++++++++LShift%28%26amp%3BH80%2C+lBytePosition%29%0A%0A++++%27+We+put+the+length+of+the+message+in+bits+into+the+last+two+words%2C+to+get%0A++++%27+the+length+in+bits+we+need+to+multiply+by+8+%28or+left+shift+3%29.+This+left%0A++++%27+shifted+value+is+put+in+the+last+word.+Any+bits+shifted+off+the+left+edge%0A++++%27+need+to+be+put+in+the+penultimate+word%2C+we+can+work+out+which+bits+by+shifting%0A++++%27+right+the+length+by+29+bits.%0A++++lWordArray%28lNumberOfWords+-+1%29+%3D+LShift%28lMessageLength%2C+3%29%0A++++lWordArray%28lNumberOfWords+-+2%29+%3D+RShift%28lMessageLength%2C+29%29%0A++++%0A++++ConvertToWordArray+%3D+lWordArray%0AEnd+Function%0A%0A%27*******************************************************************************%0A%27+SHA256+%28FUNCTION%29%0A%27%0A%27+PARAMETERS%3A%0A%27+%28In%2FOut%29+-+sMessage+-+String+-+Message+to+digest%0A%27%0A%27+RETURN+VALUE%3A%0A%27+String+-+The+digest%0A%27%0A%27+DESCRIPTION%3A%0A%27+Takes+a+string+and+uses+the+SHA-256+digest+to+produce+a+signature+for+it.%0A%27%0A%27+NOTE%3A+Due+to+the+way+in+which+the+string+is+processed+the+routine+assumes+a%0A%27+single+byte+character+set.+VB+passes+unicode+%282-byte%29+character+strings%2C+the%0A%27+ConvertToWordArray+function+uses+on+the+first+byte+for+each+character.+This%0A%27+has+been+done+this+way+for+ease+of+use%2C+to+make+the+routine+truely+portable%0A%27+you+could+accept+a+byte+array+instead%2C+it+would+then+be+up+to+the+calling%0A%27+routine+to+make+sure+that+the+byte+array+is+generated+from+their+string+in%0A%27+a+manner+consistent+with+the+string+type.%0A%27*******************************************************************************%0APublic+Function+SHA256%28sMessage+As+String%29+As+String%0A++++Dim+HASH%287%29+As+Long%0A++++Dim+M%28%29+++++As+Long%0A++++Dim+W%2863%29+++As+Long%0A++++Dim+a+++++++As+Long%0A++++Dim+b+++++++As+Long%0A++++Dim+c+++++++As+Long%0A++++Dim+d+++++++As+Long%0A++++Dim+e+++++++As+Long%0A++++Dim+f+++++++As+Long%0A++++Dim+g+++++++As+Long%0A++++Dim+h+++++++As+Long%0A++++Dim+i+++++++As+Long%0A++++Dim+j+++++++As+Long%0A++++Dim+T1++++++As+Long%0A++++Dim+T2++++++As+Long%0A++++%0A++++%27+Initial+hash+values%0A++++HASH%280%29+%3D+%26amp%3BH6A09E667%0A++++HASH%281%29+%3D+%26amp%3BHBB67AE85%0A++++HASH%282%29+%3D+%26amp%3BH3C6EF372%0A++++HASH%283%29+%3D+%26amp%3BHA54FF53A%0A++++HASH%284%29+%3D+%26amp%3BH510E527F%0A++++HASH%285%29+%3D+%26amp%3BH9B05688C%0A++++HASH%286%29+%3D+%26amp%3BH1F83D9AB%0A++++HASH%287%29+%3D+%26amp%3BH5BE0CD19%0A++++%0A++++%27+Preprocessing.+Append+padding+bits+and+length+and+convert+to+words%0A++++M+%3D+ConvertToWordArray%28sMessage%29%0A++++%0A++++%27+Main+loop%0A++++For+i+%3D+0+To+UBound%28M%29+Step+16%0A++++++++a+%3D+HASH%280%29%0A++++++++b+%3D+HASH%281%29%0A++++++++c+%3D+HASH%282%29%0A++++++++d+%3D+HASH%283%29%0A++++++++e+%3D+HASH%284%29%0A++++++++f+%3D+HASH%285%29%0A++++++++g+%3D+HASH%286%29%0A++++++++h+%3D+HASH%287%29%0A++++++++%0A++++++++For+j+%3D+0+To+63%0A++++++++++++If+j+%26lt%3B+16+Then%0A++++++++++++++++W%28j%29+%3D+M%28j+%2B+i%29%0A++++++++++++Else%0A++++++++++++++++W%28j%29+%3D+AddUnsigned%28AddUnsigned%28AddUnsigned%28Gamma1%28W%28j+-+2%29%29%2C+_%0A++++++++++++++++++++W%28j+-+7%29%29%2C+Gamma0%28W%28j+-+15%29%29%29%2C+W%28j+-+16%29%29%0A++++++++++++End+If%0A++++++++++++++++%0A++++++++++++T1+%3D+AddUnsigned%28AddUnsigned%28AddUnsigned%28AddUnsigned%28h%2C+Sigma1%28e%29%29%2C+_%0A++++++++++++++++Ch%28e%2C+f%2C+g%29%29%2C+K%28j%29%29%2C+W%28j%29%29%0A++++++++++++T2+%3D+AddUnsigned%28Sigma0%28a%29%2C+Maj%28a%2C+b%2C+c%29%29%0A++++++++++++%0A++++++++++++h+%3D+g%0A++++++++++++g+%3D+f%0A++++++++++++f+%3D+e%0A++++++++++++e+%3D+AddUnsigned%28d%2C+T1%29%0A++++++++++++d+%3D+c%0A++++++++++++c+%3D+b%0A++++++++++++b+%3D+a%0A++++++++++++a+%3D+AddUnsigned%28T1%2C+T2%29%0A++++++++Next%0A++++++++%0A++++++++HASH%280%29+%3D+AddUnsigned%28a%2C+HASH%280%29%29%0A++++++++HASH%281%29+%3D+AddUnsigned%28b%2C+HASH%281%29%29%0A++++++++HASH%282%29+%3D+AddUnsigned%28c%2C+HASH%282%29%29%0A++++++++HASH%283%29+%3D+AddUnsigned%28d%2C+HASH%283%29%29%0A++++++++HASH%284%29+%3D+AddUnsigned%28e%2C+HASH%284%29%29%0A++++++++HASH%285%29+%3D+AddUnsigned%28f%2C+HASH%285%29%29%0A++++++++HASH%286%29+%3D+AddUnsigned%28g%2C+HASH%286%29%29%0A++++++++HASH%287%29+%3D+AddUnsigned%28h%2C+HASH%287%29%29%0A++++Next%0A++++%0A++++%27+Output+the+256+bit+digest%0A++++SHA256+%3D+LCase%28Right%28%2200000000%22+%26amp%3B+Hex%28HASH%280%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%281%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%282%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%283%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%284%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%285%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%286%29%29%2C+8%29+%26amp%3B+_%0A++++++++Right%28%2200000000%22+%26amp%3B+Hex%28HASH%287%29%29%2C+8%29%29%0AEnd+Function%3C%2Fcode%3E%3C%2Fpre%3E+4%E3%80%81%E5%9C%A8%E5%B1%9E%E6%80%A7%E9%87%8C%E9%9D%A2%E4%BF%AE%E6%94%B9%E6%A8%A1%E5%9D%97%E7%B1%BB%E5%90%8D%E4%B8%BACSHA256%EF%BC%88%E5%B1%9E%E6%80%A7%E7%AA%97%E5%8F%A3%E9%80%9A%E5%B8%B8%E5%9C%A8%E5%B7%A6%E8%BE%B9%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E7%9C%8B%E5%88%B0%E5%B1%9E%E6%80%A7%E7%AA%97%E5%8F%A3%E5%B0%B1%E8%87%AA%E5%B7%B1%E6%89%93%E5%BC%80%E5%AE%83%EF%BC%8C%E5%9C%A8%E2%80%9C%E8%A7%86%E5%9B%BE%E2%80%9D%E8%8F%9C%E5%8D%95%E4%B8%AD%E7%82%B9%E5%87%BB%E2%80%9C%E5%B1%9E%E6%80%A7%E7%AA%97%E5%8F%A3%E2%80%9D%EF%BC%89+%0A++%3Ca+href%3D%22http%3A%2F%2Fxuhehuan.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fexcel-class-module-name.jpg%22+rel%3D%22nofollow%22%3E%3Cimg+class%3D%22alignnone+size-full+wp-image-2316%22+src%3D%22http%3A%2F%2Fxuhehuan.com%2Fwp-content%2Fuploads%2F2016%2F01%2Fexcel-class-module-name.jpg%22+alt%3D%22excel-class-module-name%22%3E%3C%2Fa%3E+5%E3%80%81%E5%86%8D%E6%AC%A1%E5%9C%A8%E7%95%8C%E9%9D%A2%E7%9A%84%E2%80%9C%E5%B7%A5%E7%A8%8B%E2%80%9D%E7%A9%BA%E7%99%BD%E5%A4%84%E7%82%B9%E5%87%BB%E5%8F%B3%E9%94%AE%EF%BC%8C%E9%80%89%E6%8B%A9%E6%8F%92%E5%85%A5%E6%A8%A1%E5%9D%97%EF%BC%8C%E6%A8%A1%E5%9D%97%E4%B8%AD%E8%BE%93%E5%85%A5%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81+%0A++%3Cpre%3E%3Ccode+class%3D%22language-vb%22%3EPublic+Function+FunSHA256%28sMessage+As+String%29%0A%0A++++Dim+clsX+As+CSHA256%0A++++Set+clsX+%3D+New+CSHA256%0A%0A++++FunSHA256+%3D+clsX.SHA256%28sMessage%29%0A%0A++++Set+clsX+%3D+Nothing%0A%0AEnd+Function%3C%2Fcode%3E%3C%2Fpre%3E+6%E3%80%81%E4%BF%9D%E5%AD%98%E5%B9%B6%E5%85%B3%E9%97%AD%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%E8%AF%A5Excel%E4%B8%AD%E5%B0%B1%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0FunSHA256%E6%9D%A5%E8%AE%A1%E7%AE%97SHA256%E5%80%BC%E4%BA%86%E3%80%82+%E6%9C%80%E5%90%8E%E5%92%8C%E7%BD%91%E4%B8%8A%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9C%A8%E7%BA%BF%E7%A8%8B%E5%BA%8F%E5%AF%B9%E6%AF%94%E4%B8%8B%E7%BB%93%E6%9E%9C%EF%BC%8C%E6%B2%A1%E9%97%AE%E9%A2%98%E7%9A%84%E8%AF%9D%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86%E3%80%82%E6%AF%94%E5%A6%82%EF%BC%9AEmail%E5%9C%B0%E5%9D%80%0A++%3Ccode%3Eexample%40gmail.com%3C%2Fcode%3E%E7%BB%8F%E8%BF%87%E5%93%88%E5%B8%8C%E5%A4%84%E7%90%86%E5%90%8E%E7%9A%84%E5%80%BC%E4%B8%BA%0A++%3Ccode%3E264e53d93759bde067fd01ef2698f98d1253c730d12f021116f02eebcfa9ace6%3C%2Fcode%3E%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%E6%9F%A5%E7%9C%8B%E5%8E%9F%E6%96%87%EF%BC%9A%0A++%3Ca+href%3D%22http%3A%2F%2Fxuhehuan.com%2F2310.html%22+rel%3D%22nofollow%22%3Ehttp%3A%2F%2Fxuhehuan.com%2F2310.html%3C%2Fa%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fxhhjin%2Farticle%2Fdetails%2F50520621%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fxhhjin%2Farticle%2Fdetails%2F50520621%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}