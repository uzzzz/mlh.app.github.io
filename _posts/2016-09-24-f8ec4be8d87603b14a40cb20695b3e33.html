---
layout: default
title: Hive(四)——电商交易项目案例
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E%0A+++%E7%94%B5%E5%95%86%E4%BA%A4%E6%98%93%E9%A1%B9%E7%9B%AE%E6%A1%88%E4%BE%8B%0A++%3Cbr%3E%0A++%3Cbr%3E+Sdate%E5%AE%9A%E4%B9%89%E4%BA%86%E6%97%A5%E6%9C%9F%E7%9A%84%E5%88%86%E7%B1%BB%EF%BC%8C%E5%B0%86%E6%AF%8F%E5%A4%A9%E5%88%86%E5%88%AB%E8%B5%8B%E4%BA%88%E6%89%80%E5%B1%9E%E7%9A%84%E6%9C%88%E4%BB%BD%E3%80%81%E6%98%9F%E6%9C%9F%E3%80%81%E5%AD%A3%E5%BA%A6%E7%AD%89%E5%B1%9E%E6%80%A7%EF%BC%8C%0A++%3Cbr%3E+%E5%AD%97%E6%AE%B5%E5%88%86%E5%88%AB%E4%B8%BA%E6%97%A5%E6%9C%9F%E3%80%81%E5%B9%B4%E6%9C%88%E3%80%81%E5%B9%B4%E3%80%81%E6%9C%88%E3%80%81%E6%97%A5%E3%80%81%E5%91%A8%E5%87%A0%E3%80%81%E7%AC%AC%E5%87%A0%E5%91%A8%E3%80%81%E5%AD%A3%E5%BA%A6%E3%80%81%E6%97%AC%E3%80%81%E5%8D%8A%E6%9C%88%EF%BC%9B%0A++%3Cbr%3E+Stock%E5%AE%9A%E4%B9%89%E4%BA%86%E8%AE%A2%E5%8D%95%E8%A1%A8%E5%A4%B4%EF%BC%8C%E5%AD%97%E6%AE%B5%E5%88%86%E5%88%AB%E4%B8%BA%E8%AE%A2%E5%8D%95%E5%8F%B7%E3%80%81%E4%BA%A4%E6%98%93%E4%BD%8D%E7%BD%AE%E3%80%81%E4%BA%A4%E6%98%93%E6%97%A5%E6%9C%9F%EF%BC%9B%0A++%3Cbr%3E+StockDetail%E6%96%87%E4%BB%B6%E5%AE%9A%E4%B9%89%E4%BA%86%E8%AE%A2%E5%8D%95%E6%98%8E%E7%BB%86%EF%BC%8C%E8%AF%A5%E8%A1%A8%E5%92%8CStock%E4%BB%A5%E4%BA%A4%E6%98%93%E5%8F%B7%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%EF%BC%8C%0A++%3Cbr%3E+%E5%AD%97%E6%AE%B5%E5%88%86%E5%88%AB%E4%B8%BA%E8%AE%A2%E5%8D%95%E5%8F%B7%E3%80%81%E8%A1%8C%E5%8F%B7%E3%80%81%E8%B4%A7%E5%93%81%E3%80%81%E6%95%B0%E9%87%8F%E3%80%81%E4%BB%B7%E6%A0%BC%E3%80%81%E9%87%91%E9%A2%9D%EF%BC%9B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+CREATE+TABLE+sdate%28%0A++%3Cbr%3E+dateID+string%2C+--%E6%97%A5%E6%9C%9F%0A++%3Cbr%3E+theyearmonth+string%2C--%E5%B9%B4%E6%9C%88%0A++%3Cbr%3E+theyear+string%2C--%E5%B9%B4%0A++%3Cbr%3E+themonth+string%2C--%E6%9C%88%0A++%3Cbr%3E+thedate+string%2C--%E6%97%A5%0A++%3Cbr%3E+theweek+string%2C--%E5%91%A8%E5%87%A0%0A++%3Cbr%3E+theweeks+string%2C--%E7%AC%AC%E5%87%A0%E5%91%A8%0A++%3Cbr%3E+thequot+string%2C--%E5%AD%A3%E5%BA%A6%0A++%3Cbr%3E+thetenday+string%2C--%E6%97%AC%0A++%3Cbr%3E+thehalfmonth+string+--%E5%8D%8A%E6%9C%88%0A++%3Cbr%3E+%29%26nbsp%3B%0A++%3Cbr%3E+ROW+FORMAT+DELIMITED+FIELDS+TERMINATED+BY+%27%2C%27%0A++%3Cbr%3E+LINES+TERMINATED+BY+%27%5Cn%27+%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+CREATE+TABLE+stock%28%0A++%3Cbr%3E+ordernumber+string%2C--%E8%AE%A2%E5%8D%95%E5%8F%B7%0A++%3Cbr%3E+locationid+string%2C--%E4%BA%A4%E6%98%93%E4%BD%8D%E7%BD%AE%0A++%3Cbr%3E+dateID+string+--%E4%BA%A4%E6%98%93%E6%97%A5%E6%9C%9F%0A++%3Cbr%3E+%29%26nbsp%3B%0A++%3Cbr%3E+ROW+FORMAT+DELIMITED+FIELDS+TERMINATED+BY+%27%2C%27%0A++%3Cbr%3E+LINES+TERMINATED+BY+%27%5Cn%27+%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+CREATE+TABLE+stockdetail%28%0A++%3Cbr%3E+ordernumber+string%2C--%E8%AE%A2%E5%8D%95%E5%8F%B7%0A++%3Cbr%3E+rownum+int%2C--%E8%A1%8C%E5%8F%B7%0A++%3Cbr%3E+itemid+string%2C+--%E8%B4%A7%E5%93%81%0A++%3Cbr%3E+qty+int%2C+--%E6%95%B0%E9%87%8F%0A++%3Cbr%3E+price+int%2C+--%E4%BB%B7%E6%A0%BC%0A++%3Cbr%3E+amount+int+--%E6%80%BB%E9%87%91%E9%A2%9D%0A++%3Cbr%3E+%29+ROW+FORMAT+DELIMITED+FIELDS+TERMINATED+BY+%27%2C%27%26nbsp%3B%0A++%3Cbr%3E+LINES+TERMINATED+BY+%27%5Cn%27+%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%88%9B%E5%BB%BA%E8%A1%A8%EF%BC%8C%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%0A++%3Cbr%3E+load+data+local+inpath+%27%2Fhome%2Fzkpk%2Ftbdata%2Fsdate.txt%27%0A++%3Cbr%3E+overwrite+into+table+sdate%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+load+data+local+inpath+%27%2Fhome%2Fzkpk%2Ftbdata%2Fstock.txt%27%0A++%3Cbr%3E+overwrite+into+table+stock%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+load+data+local+inpath+%27%2Fhome%2Fzkpk%2Ftbdata%2Fstockdetail.txt%27%0A++%3Cbr%3E+overwrite+into+table+stockdetail%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+1%E3%80%81%E8%AE%A1%E7%AE%97%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E6%AF%8F%E5%B9%B4%E7%9A%84%E6%80%BB%E9%87%91%E9%A2%9D%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E8%A6%81%E8%AE%A1%E7%AE%97%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E6%AF%8F%E5%B9%B4%E7%9A%84%E6%80%BB%E9%87%91%E9%A2%9D%EF%BC%8C%E9%A6%96%E5%85%88%E9%9C%80%E8%A6%81%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E7%9A%84%E8%AE%A2%E5%8D%95%E5%8F%B7%E3%80%81%E8%AE%A2%E5%8D%95%E6%97%A5%E6%9C%9F%E5%92%8C%E8%AE%A2%E5%8D%95%E9%87%91%E4%BF%A1%E6%81%AF%EF%BC%8C%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E7%84%B6%E5%90%8E%E6%8A%8A%E8%BF%99%E4%BA%9B%E4%BF%A1%E6%81%AF%E5%92%8C%E6%97%A5%E6%9C%9F%E8%A1%A8%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%EF%BC%8C%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E8%8E%B7%E5%8F%96%E5%B9%B4%E4%BB%BD%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%9C%80%E5%90%8E%E6%A0%B9%E6%8D%AE%E8%BF%99%E5%9B%9B%E4%B8%AA%E5%88%97%E6%8C%89%E5%B9%B4%E4%BB%BD%E5%BD%92%E7%BB%84%E7%BB%9F%E8%AE%A1%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E6%AF%8F%E5%B9%B4%E7%9A%84%E6%80%BB%E9%87%91%E9%A2%9D%E3%80%82%0A++%3Cbr%3E+%E5%85%B3%E4%BA%8E%E4%B8%89%E5%BC%A0%E8%A1%A8%3Astock+a%2C+stockdetail+b%2C+sdate+c%0A++%3Cbr%3E+select+c.theyear%2Csum%28b.amount%29%26nbsp%3B%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber+and+a.dateid%3Dc.dateid%0A++%3Cbr%3E+group+by+c.theyear+order+by+c.theyear%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%3A%0A++%3Cbr%3E+2004%0A++%3Cspan%3E+%3C%2Fspan%3E3265696%0A++%3Cbr%3E+2005%0A++%3Cspan%3E+%3C%2Fspan%3E13247234%0A++%3Cbr%3E+2006%0A++%3Cspan%3E+%3C%2Fspan%3E13670416%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E16711974%0A++%3Cbr%3E+2008%0A++%3Cspan%3E+%3C%2Fspan%3E14670698%0A++%3Cbr%3E+2009%0A++%3Cspan%3E+%3C%2Fspan%3E6322137%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3E210924%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+2%E3%80%81%E8%AE%A1%E7%AE%97%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E6%AF%8F%E5%B9%B4%E6%9C%80%E5%A4%A7%E9%87%91%E9%A2%9D%E8%AE%A2%E5%8D%95%E7%9A%84%E9%94%80%E5%94%AE%E9%A2%9D%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E8%AF%A5%E7%AE%97%E6%B3%95%E5%88%86%E4%B8%BA%E4%B8%A4%E6%AD%A5%EF%BC%9A%0A++%3Cspan%3E+%3C%2Fspan%3E+%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E1.%E6%8C%89%E7%85%A7%E6%97%A5%E6%9C%9F%E5%92%8C%E8%AE%A2%E5%8D%95%E5%8F%B7%E8%BF%9B%E8%A1%8C%E5%BD%92%E7%BB%84%E8%AE%A1%E7%AE%97%EF%BC%8C%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%26nbsp%3B%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E6%AF%8F%E5%A4%A9%E7%9A%84%E9%94%80%E5%94%AE%E6%95%B0%E6%8D%AE%EF%BC%9B%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3Estock+a%2Cstockdetail+b%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+select+a.dateid%2C+a.ordernumber%2Csum%28b.amount%29+as+sumofamount%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber%0A++%3Cbr%3E+group+by+a.dateid%2Ca.ordernumber%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E2.%E6%8A%8A%E7%AC%AC%E4%B8%80%E6%AD%A5%E8%8E%B7%E5%8F%96%E7%9A%84%E6%95%B0%E6%8D%AE%E5%92%8C%E6%97%A5%E6%9C%9F%E8%A1%A8%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E8%8E%B7%E5%8F%96%E7%9A%84%E5%B9%B4%E4%BB%BD%E4%BF%A1%E6%81%AF%EF%BC%8C%0A++%3Cbr%3E%0A++%3Cspan%3E%3C%2Fspan%3E%E7%84%B6%E5%90%8E%E6%8C%89%E7%85%A7%E5%B9%B4%E4%BB%BD%E8%BF%9B%E8%A1%8C%E5%BD%92%E7%BB%84%EF%BC%8C%E4%BD%BF%E7%94%A8Max%E5%87%BD%E6%95%B0%EF%BC%8C%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E6%AF%8F%E5%B9%B4%E6%9C%80%E5%A4%A7%E9%87%91%E9%A2%9D%E8%AE%A2%E5%8D%95%E7%9A%84%E9%94%80%E5%94%AE%E9%A2%9D%E3%80%82%0A++%3Cbr%3E+sdate+c%2C%E7%AC%AC%E4%B8%80%E6%AD%A5%E8%8E%B7%E5%8F%96%E7%9A%84%E6%95%B0%E6%8D%AE+d%0A++%3Cbr%3E+select+c.theyear%2Cmax%28d.sumofamount%29+from+sdate+c%2C%0A++%3Cbr%3E+%28select+a.dateid%2C+a.ordernumber%2Csum%28b.amount%29+as+sumofamount%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber%0A++%3Cbr%3E+group+by+a.dateid%2Ca.ordernumber%29d%0A++%3Cbr%3E+where+c.dateid%3Dd.dateid%0A++%3Cbr%3E+group+by+c.theyear+order+by+c.theyear%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%3A%0A++%3Cbr%3E+2004%0A++%3Cspan%3E+%3C%2Fspan%3E23612%0A++%3Cbr%3E+2005%0A++%3Cspan%3E+%3C%2Fspan%3E38180%0A++%3Cbr%3E+2006%0A++%3Cspan%3E+%3C%2Fspan%3E36124%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E159126%0A++%3Cbr%3E+2008%0A++%3Cspan%3E+%3C%2Fspan%3E55828%0A++%3Cbr%3E+2009%0A++%3Cspan%3E+%3C%2Fspan%3E25810%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3E13063%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+3%E3%80%81%E7%BB%9F%E8%AE%A1%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E4%B8%AD%E5%AD%A3%E5%BA%A6%E9%94%80%E5%94%AE%E9%A2%9D%E5%89%8D10%E4%BD%8D%0A++%3Cbr%3E+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+select+c.theyear%2Cc.thequot%2Csum%28b.amount%29+as+sumofamount%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber+and+a.dateid%3Dc.dateid%0A++%3Cbr%3E+group+by+c.theyear%2Cc.thequot%0A++%3Cbr%3E+order+by+sumofamount+desc+limit+10%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%EF%BC%9A%0A++%3Cbr%3E+2008%0A++%3Cspan%3E+%3C%2Fspan%3E1%0A++%3Cspan%3E+%3C%2Fspan%3E+5252819%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E4%0A++%3Cspan%3E+%3C%2Fspan%3E+4613093%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E1%0A++%3Cspan%3E+%3C%2Fspan%3E+4446088%0A++%3Cbr%3E+2006%0A++%3Cspan%3E+%3C%2Fspan%3E1%0A++%3Cspan%3E+%3C%2Fspan%3E+3916638%0A++%3Cbr%3E+2008%0A++%3Cspan%3E+%3C%2Fspan%3E2%0A++%3Cspan%3E+%3C%2Fspan%3E+3886470%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E3%0A++%3Cspan%3E+%3C%2Fspan%3E+3870558%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E2%0A++%3Cspan%3E+%3C%2Fspan%3E+3782235%0A++%3Cbr%3E+2006%0A++%3Cspan%3E+%3C%2Fspan%3E4%0A++%3Cspan%3E+%3C%2Fspan%3E+3691314%0A++%3Cbr%3E+2005%0A++%3Cspan%3E+%3C%2Fspan%3E1%0A++%3Cspan%3E+%3C%2Fspan%3E+3592007%0A++%3Cbr%3E+2005%0A++%3Cspan%3E+%3C%2Fspan%3E3%0A++%3Cspan%3E+%3C%2Fspan%3E+3304243%0A++%3Cbr%3E+4%E3%80%81%E5%88%97%E5%87%BA%E9%94%80%E5%94%AE%E9%87%91%E9%A2%9D%E5%9C%A8100000%E4%BB%A5%E4%B8%8A%E7%9A%84%E5%8D%95%E6%8D%AE%28%E8%AE%A2%E5%8D%95%E5%8F%B7%29%0A++%3Cbr%3E+stock+a%2Cstockdetail+b%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+select+a.ordernumber%2Csum%28b.amount%29+as+sumofamount%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber%0A++%3Cbr%3E+group+by+a.ordernumber%0A++%3Cbr%3E+having+sumofamount%26gt%3B100000%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%3A%0A++%3Cbr%3E+HMJSL00009024%0A++%3Cspan%3E+%3C%2Fspan%3E119058%0A++%3Cbr%3E+HMJSL00009958%0A++%3Cspan%3E+%3C%2Fspan%3E159126%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+5%E3%80%81%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E4%B8%AD%E6%AF%8F%E5%B9%B4%E6%9C%80%E7%95%85%E9%94%80%E8%B4%A7%E5%93%81%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%0A++%3Cbr%3E+%E7%BB%9F%E8%AE%A1%E5%87%BA%E6%AF%8F%E5%B9%B4%E6%AF%8F%E7%A7%8D%E8%B4%A7%E5%93%81%E7%9A%84%E9%94%80%E5%94%AE%E6%80%BB%E9%87%91%E9%A2%9D%0A++%3Cbr%3E+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E+%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A++%3Cbr%3E+select+c.theyear%2Cb.itemid%2Csum%28b.amount%29+as+sumofamount%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber+and+a.dateid%3Dc.dateid%0A++%3Cbr%3E+group+by+c.theyear%2Cb.itemid%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%3A%0A++%3Cbr%3E+.........%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219365210101%0A++%3Cspan%3E+%3C%2Fspan%3E299%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219373110101%0A++%3Cspan%3E+%3C%2Fspan%3E269%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219373810101%0A++%3Cspan%3E+%3C%2Fspan%3E-269%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219373812201%0A++%3Cspan%3E+%3C%2Fspan%3E657%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219381020101%0A++%3Cspan%3E+%3C%2Fspan%3E1196%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219392110101%0A++%3Cspan%3E+%3C%2Fspan%3E299%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219392112201%0A++%3Cspan%3E+%3C%2Fspan%3E598%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3EZX219392212201%0A++%3Cspan%3E+%3C%2Fspan%3E598%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3Eyl427465200101%0A++%3Cspan%3E+%3C%2Fspan%3E398%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E7%AC%AC%E4%BA%8C%E6%AD%A5%3A%0A++%3Cbr%3E+%E5%9C%A8%E7%AC%AC%E4%B8%80%E6%AD%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%8A%EF%BC%8C%E7%BB%9F%E8%AE%A1%E5%87%BA%E6%AF%8F%E5%B9%B4%E6%9C%80%E5%A4%A7%E7%9A%84%E9%94%80%E5%94%AE%E6%80%BB%E9%87%91%E9%A2%9D%0A++%3Cbr%3E+%E5%B0%86%E7%AC%AC%E4%B8%80%E6%AD%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86%E8%B5%B7%E5%88%AB%E5%90%8D%E4%B8%BAd%3B%0A++%3Cbr%3E+select+d.theyear%2Cmax%28sumofamount%29+as+maxofamount+from%26nbsp%3B%0A++%3Cbr%3E+%28select+c.theyear%2Cb.itemid%2Csum%28b.amount%29+as+sumofamount%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber+and+a.dateid%3Dc.dateid%0A++%3Cbr%3E+group+by+c.theyear%2Cb.itemid%29+d%0A++%3Cbr%3E+group+by+d.theyear%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%3A%0A++%3Cbr%3E+2004%0A++%3Cspan%3E+%3C%2Fspan%3E53374%0A++%3Cbr%3E+2005%0A++%3Cspan%3E+%3C%2Fspan%3E56569%0A++%3Cbr%3E+2006%0A++%3Cspan%3E+%3C%2Fspan%3E113684%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3E70226%0A++%3Cbr%3E+2008%0A++%3Cspan%3E+%3C%2Fspan%3E97981%0A++%3Cbr%3E+2009%0A++%3Cspan%3E+%3C%2Fspan%3E30029%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3E4494%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%89%80%E6%9C%89%E8%AE%A2%E5%8D%95%E4%B8%AD%E6%AF%8F%E5%B9%B4%E6%9C%80%E7%95%85%E9%94%80%E8%B4%A7%E5%93%81%0A++%3Cbr%3E+e%3A%E6%AF%8F%E5%B9%B4%E6%AF%8F%E7%A7%8D%E8%B4%A7%E5%93%81%E7%9A%84%E9%94%80%E5%94%AE%E6%80%BB%E9%87%91%E9%A2%9D%0A++%3Cbr%3E+f%3A%E6%AF%8F%E5%B9%B4%E6%9C%80%E5%A4%A7%E7%9A%84%E9%94%80%E5%94%AE%E6%80%BB%E9%87%91%E9%A2%9D%0A++%3Cbr%3E+select+distinct+e.theyear%2Ce.itemid%2Cf.maxofamount+from%26nbsp%3B%0A++%3Cbr%3E+%28select+c.theyear%2Cb.itemid%2C%0A++%3Cbr%3E+sum%28b.amount%29+as+sumofamount+from+stock+a%2Cstockdetail+b%2Csdate+c%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber+and+a.dateid%3Dc.dateid%26nbsp%3B%0A++%3Cbr%3E+group+by+c.theyear%2Cb.itemid%29+e%2C%26nbsp%3B%0A++%3Cbr%3E+%28select+d.theyear%2Cmax%28d.sumofamount%29+as+maxofamount+from%0A++%3Cbr%3E+%28select+c.theyear%2Cb.itemid%2Csum%28b.amount%29+as+sumofamount%26nbsp%3B%0A++%3Cbr%3E+from+stock+a%2Cstockdetail+b%2Csdate+c%26nbsp%3B%0A++%3Cbr%3E+where+a.ordernumber%3Db.ordernumber+and+a.dateid%3Dc.dateid%26nbsp%3B%0A++%3Cbr%3E+group+by+c.theyear%2Cb.itemid%29+d%26nbsp%3B%0A++%3Cbr%3E+group+by+d.theyear%29+f%26nbsp%3B%0A++%3Cbr%3E+where+e.theyear%3Df.theyear+and+e.sumofamount%3Df.maxofamount%26nbsp%3B%0A++%3Cbr%3E+order+by+e.theyear%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Result%3A%0A++%3Cbr%3E+2004%0A++%3Cspan%3E+%3C%2Fspan%3EJY424420810101%0A++%3Cspan%3E+%3C%2Fspan%3E53374%0A++%3Cbr%3E+2005%0A++%3Cspan%3E+%3C%2Fspan%3E24124118880102%0A++%3Cspan%3E+%3C%2Fspan%3E56569%0A++%3Cbr%3E+2006%0A++%3Cspan%3E+%3C%2Fspan%3EJY425468460101%0A++%3Cspan%3E+%3C%2Fspan%3E113684%0A++%3Cbr%3E+2007%0A++%3Cspan%3E+%3C%2Fspan%3EJY425468460101%0A++%3Cspan%3E+%3C%2Fspan%3E70226%0A++%3Cbr%3E+2008%0A++%3Cspan%3E+%3C%2Fspan%3EE2628204040101%0A++%3Cspan%3E+%3C%2Fspan%3E97981%0A++%3Cbr%3E+2009%0A++%3Cspan%3E+%3C%2Fspan%3EYL327439080102%0A++%3Cspan%3E+%3C%2Fspan%3E30029%0A++%3Cbr%3E+2010%0A++%3Cspan%3E+%3C%2Fspan%3ESQ429425090101%0A++%3Cspan%3E+%3C%2Fspan%3E4494+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Faccptanggang%2Farticle%2Fdetails%2F52651630%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Faccptanggang%2Farticle%2Fdetails%2F52651630%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}