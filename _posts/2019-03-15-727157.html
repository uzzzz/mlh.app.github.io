---
layout: default
title: Crypto++库实现AES和RSA加密解密
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22article-copyright%22%3E%0A+++%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%EF%BC%9A%E6%9C%AC%E6%96%87%E4%B8%BA%E5%8D%9A%E4%B8%BB%E5%8E%9F%E5%88%9B%E6%96%87%E7%AB%A0%EF%BC%8C%E8%BD%AC%E8%BD%BD%E8%AF%B7%E8%81%94%E7%B3%BB1006325356%40qq.com%E3%80%82+https%3A%2F%2Fblog.csdn.net%2Fiamqianrenzhan%2Farticle%2Fdetails%2F88583822+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+id%3D%22content_views%22+class%3D%22markdown_views+prism-atom-one-dark%22%3E+%0A++%3C%21--+flowchart+%E7%AE%AD%E5%A4%B4%E5%9B%BE%E6%A0%87+%E5%8B%BF%E5%88%A0+--%3E+%0A++%3Csvg+xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22+style%3D%22display%3A+none%3B%22%3E%0A+++%3Cpath+stroke-linecap%3D%22round%22+d%3D%22M5%2C0+0%2C2.5+5%2C5z%22+id%3D%22raphael-marker-block%22+style%3D%22-webkit-tap-highlight-color%3A+rgba%280%2C+0%2C+0%2C+0%29%3B%22%3E%3C%2Fpath%3E%0A++%3C%2Fsvg%3E+%0A++%3Cp%3E%E6%9C%AC%E6%96%87%E4%BB%8B%E7%BB%8D%E4%BD%BF%E7%94%A8Crypto%2B%2B%E8%BF%9B%E8%A1%8CAES%E5%8A%A0%E5%AF%86%E5%92%8CRSA%E5%8A%A0%E5%AF%86%3C%2Fp%3E+%0A++%3Ch1%3E%3Ca+id%3D%22CryptoVS_2%22%3E%3C%2Fa%3ECrypto%2B%2B%E5%BA%93%E5%9C%A8VS%E4%B8%AD%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95%3C%2Fh1%3E+%0A++%3Cp%3ECrypto%2B%2B%E5%BA%93%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%EF%BC%9A%3Cbr%3E+%3Ca+href%3D%22https%3A%2F%2Fwww.cryptopp.com%2F%25EF%25BC%258C%22+rel%3D%22nofollow%22%3Ehttps%3A%2F%2Fwww.cryptopp.com%2F%EF%BC%8C%3C%2Fa%3E%3Cbr%3E+%E7%9B%AE%E5%89%8D%E5%B7%B2%E7%BB%8F%E6%9B%B4%E6%96%B0%E5%88%B08.1%E7%89%88%E6%9C%AC%E3%80%82%E6%9C%AC%E6%96%87%E4%BD%BF%E7%94%A8%E7%9A%84%E6%98%AF8.1%E7%89%88%E6%9C%AC%E7%9A%84Crypto%2B%2B%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E4%B8%8B%E8%BD%BD%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%8E%E8%A7%A3%E5%8E%8B%EF%BC%8C%E7%84%B6%E5%90%8E%E7%94%A8vs%E4%B8%AD%E7%BC%96%E8%AF%91cryptopp%E3%80%82%E7%94%9F%E6%88%90debug%E5%92%8CRealease%E7%89%88%E6%9C%AC%E7%9A%84cryptlib.lib%E9%9D%99%E6%80%81%E5%BA%93%E3%80%82%E5%9C%A8%E4%BD%BF%E7%94%A8%E6%97%B6%E5%8F%AA%E8%A6%81%E5%8C%85%E5%90%AB%E7%9B%B8%E5%BA%94%E5%8A%9F%E8%83%BD%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6%E3%80%82%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode%3E%23include+%22D%3A%5Ccryptopp810%5Crandpool.h%22%0A%23include+%22D%3A%5Ccryptopp810%5Crsa.h%22%0A%23include+%22D%3A%5Ccryptopp810%5Chex.h%22%0A%23include+%22D%3A%5Ccryptopp810%5Cfiles.h%22%0A%23include+%22D%3A%5Ccryptopp810%5Cosrng.h%22%0A%23include+%22D%3A%5Ccryptopp810%5Cbase64.h%22%0Ausing+namespace+CryptoPP%3B%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E5%92%8C%E5%BC%95%E5%85%A5lib%E5%8C%85%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode%3E%23pragma+comment%28lib%2C+%22cryptlib.lib%22%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch1%3E%3Ca+id%3D%22AES_27%22%3E%3C%2Fa%3EAES%E5%8A%A0%E5%AF%86%3C%2Fh1%3E+%0A++%3Cp%3EAES%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E6%98%AF%E5%AF%B9%E7%A7%B0%E7%A7%98%E9%92%A5%E5%8A%A0%E5%AF%86%E4%B8%AD%E6%9C%80%E6%B5%81%E8%A1%8C%E7%9A%84%E7%AE%97%E6%B3%95%E4%B9%8B%E4%B8%80%E3%80%82%E5%8A%A0%E5%AF%86%E7%9A%84%E5%8C%BA%E5%9D%97%E9%95%BF%E5%BA%A6%E6%98%AF16%E4%B8%AA%E5%AD%97%E8%8A%82%E3%80%82%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode%3E%2F%2F%E5%8F%98%E9%87%8F%E5%87%86%E5%A4%87%0Aunsigned+char+aesKey%5BAES%3A%3ADEFAULT_KEYLENGTH%5D%3B+%2F%2F%E5%AF%86%E9%92%A5%0Aunsigned+char+inBlock%5BAES%3A%3ABLOCKSIZE%5D+%3D+%22ABCDEF%22%3B+%2F%2F%E8%A6%81%E5%8A%A0%E5%AF%86%E7%9A%84%E6%95%B0%E6%8D%AE%E5%9D%97%EF%BC%8C%E5%B0%8F%E4%BA%8E16%E5%AD%97%E8%8A%82%0Aunsigned+char+outBlock%5BAES%3A%3ABLOCKSIZE%5D%3B+%2F%2F%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E5%AF%86%E6%96%87%E5%9D%97%0Aunsigned+char+xorBlock%5BAES%3A%3ABLOCKSIZE%5D%3B+%2F%2F%E5%BF%85%E9%A1%BB%E8%AE%BE%E5%AE%9A%E4%B8%BA%E5%85%A8%E9%9B%B6%0Amemset%28xorBlock%2C+0%2C+AES%3A%3ABLOCKSIZE%29%3B+%2F%2F%E7%BD%AE%E9%9B%B6%0A%0A%2F%2F%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90key%0AAutoSeededRandomPool+rnd%3B%0ASecByteBlock+key%280x00%2C+AES%3A%3ADEFAULT_KEYLENGTH%29%3B%0Arnd.GenerateBlock%28key%2C+key.size%28%29%29%3B%0A%0A%2F%2F%E5%8A%A0%E5%AF%86%0AAESEncryption+aesEncryptor%3B+%0AaesEncryptor.SetKey%28key%2C+AES%3A%3ADEFAULT_KEYLENGTH%29%3B+%0AaesEncryptor.ProcessAndXorBlock%28inBlock%2C+xorBlock%2C+outBlock%29%3B%0A%0A%0A%2F%2F%E8%A7%A3%E5%AF%86%0AAESDecryption+aesDecryptor%3B%0Aunsigned+char+plainText%5BAES%3A%3ABLOCKSIZE%5D%3B%0AaesDecryptor.SetKey%28key%2C+AES%3A%3ADEFAULT_KEYLENGTH%29%3B%0AaesDecryptor.ProcessAndXorBlock%28outBlock%2C+xorBlock%2C+plainText%29%3B%0A%0A+%2F%2F%E6%89%93%E5%8D%B0%E8%A7%A3%E5%AF%86%E7%BB%93%E6%9E%9C%0Afor+%28int+i+%3D+0%3B+i%26lt%3B16%3B+i%2B%2B%29%0A%7B%0A%09cout+%26lt%3B%26lt%3B+plainText%5Bi%5D%3B%0A%7D%0Acout+%26lt%3B%26lt%3B+endl%3B%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch1%3E%3Ca+id%3D%22RSA_64%22%3E%3C%2Fa%3ERSA%E5%8A%A0%E5%AF%86%3C%2Fh1%3E+%0A++%3Cp%3ERSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E6%98%AF%E4%B8%80%E7%A7%8D%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%EF%BC%8C%E6%98%AF%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%97%A2%E8%83%BD%E7%94%A8%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E4%B9%9F%E8%83%BD%E7%94%A8%E4%BA%8E%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%9A%84%E7%AE%97%E6%B3%95%E5%8F%AF%E7%94%A8%E4%BA%8E%E5%8A%A0%E5%AF%86%3Cbr%3E+%E5%92%8C%E7%AD%BE%E5%90%8D%E3%80%82%E8%AF%A5%E7%AE%97%E6%B3%95%E9%9C%80%E8%A6%81%E4%B8%80%E5%AF%B9%E7%A7%98%E9%92%A5%EF%BC%8C%E5%8D%B3%E7%A7%81%E9%92%A5%E5%92%8C%E5%85%AC%E9%92%A5%E3%80%82%E5%85%B6%E4%B8%AD%3Cbr%3E+%E7%A7%81%E9%92%A5%E7%94%B1%E7%94%A8%E6%88%B7%E4%BF%9D%E5%AD%98%EF%BC%8C%E4%B8%8D%E5%AF%B9%E5%A4%96%E5%85%AC%E5%BC%80%EF%BC%8C%E5%85%AC%E9%92%A5%E5%85%AC%E5%BC%80%E5%8F%91%E5%B8%83%E3%80%82%E4%BD%BF%E7%94%A8%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86%E3%80%82%E4%BD%BF%E7%94%A8%E7%A7%81%E9%92%A5%E7%AD%BE%E5%90%8D%E7%9A%84%3Cbr%3E+%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%85%AC%E9%92%A5%E9%AA%8C%E8%AF%81%E3%80%82%3C%2Fp%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_71%22%3E%3C%2Fa%3E%E7%A7%98%E9%92%A5%E7%94%9F%E6%88%90%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3E%2F%2F%E6%A0%B9%E6%8D%AE%E9%95%BF%E5%BA%A6%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5%EF%BC%8C%E5%B9%B6%E5%88%86%E5%88%AB%E4%BF%9D%E5%AD%98%E5%88%B0pubFilename%E6%96%87%E4%BB%B6%E5%92%8CprivFilename%E6%96%87%E4%BB%B6%0Avoid+GenerateRSAKey%28unsigned+int+keyLength%2C+const+char+*privFilename%2C+const+char+*pubFilename%29%0A%7B%0A%09AutoSeededRandomPool+rng%3B%0A%09InvertibleRSAFunction+privkey%3B%0A%09privkey.GenerateRandomWithKeySize%28rng%2C+keyLength%29%3B%0A%0A%09Base64Encoder+privkeysink%28new+FileSink%28privFilename%29%29%3B++%2F%2F%22privkey.txt%22%0A%09privkey.DEREncode%28privkeysink%29%3B%0A%09privkeysink.MessageEnd%28%29%3B%0A%0A%09RSAFunction+pubkey%28privkey%29%3B%0A%09Base64Encoder+pubkeysink%28new+FileSink%28pubFilename%29%29%3B++%2F%2F%22pubkey.txt%22%0A%09pubkey.DEREncode%28pubkeysink%29%3B%0A%09pubkeysink.MessageEnd%28%29%3B%0A%7D%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_93%22%3E%3C%2Fa%3E%E4%BF%A1%E6%81%AF%E5%8A%A0%E5%AF%86%EF%BC%88%E4%BB%8E%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%85%AC%E9%92%A5%EF%BC%89%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3E%2F%2F%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2plain%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E7%94%A8pubFilename%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%88%B0encryptedFilename%E4%B8%AD%E3%80%82%0Avoid+Encrypt%28const+string+%26amp%3Bplain%2C+const+char+*pubFilename%2C+const+char+*encryptedFilename%29%0A%7B%0A%09RSAES_OAEP_SHA_Encryptor+pubkey%28FileSource%28pubFilename%2C+true%2C+new+Base64Decoder%29%29%3B%0A%0A%09SecByteBlock+sbbCipherText%28pubkey.CiphertextLength%28plain.size%28%29%29%29%3B%0A%09%2F%2FsbbCipherText.begin%28%29%3B%0A%09AutoSeededRandomPool+rng%3B%0A%09pubkey.Encrypt%28%0A%09%09rng%2C%0A%09%09%28byte+const*%29plain.data%28%29%2C%0A%09%09plain.size%28%29%2C%0A%09%09sbbCipherText.begin%28%29%29%3B%0A%0A%09FileSink%28encryptedFilename%29.Put%28sbbCipherText.begin%28%29%2C+sbbCipherText.size%28%29%29%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_114%22%3E%3C%2Fa%3E%E4%BF%A1%E6%81%AF%E5%8A%A0%E5%AF%86%EF%BC%88%E5%85%AC%E9%92%A5%E5%86%99%E5%88%B0%E4%BB%A3%E7%A0%81%E4%B8%AD%EF%BC%89%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3Evoid+Encrypt2%28const+string+%26amp%3Bplain%2Cconst+char+*encryptedFilename%29%0A%7B%0A%09%2F%2FRSAES_OAEP_SHA_Encryptor+pubkey%28FileSource%28pubFilename%2C+true%2C+new+Base64Decoder%29%29%3B%0A%09string+pub+%3D+%22MIGdMA0GCSqGSIb3DQEBAQUAA4GLADCBhwKBgQC1f%2BWV5dAiVb2w1lgf21Wz84Uuou1TwCJ%2B%5C%0A%09%09ivxcpijobsHQLOLMakYSyRonH6SQJtL5CHXycBubA9sS7F2nVG2fMn6z9Ev11nu7J4IPPF9u%5C%0A%09%09v+%2F+ZqwAIlXwxVPsl4K69rWmdP4i5ezj%2B%2BI7nC+%2B+kX6qjxpcyhnQalKAl2OC8AMNEo0awIBEQ+%3D%3D+%22%3B%0A%09RSAES_OAEP_SHA_Encryptor+pubkey%28StringSource%28pub%2C+true%2C+new+Base64Decoder%29%29%3B%0A%0A%09SecByteBlock+sbbCipherText%28pubkey.CiphertextLength%28plain.size%28%29%29%29%3B%0A%09%2F%2FsbbCipherText.begin%28%29%3B%0A%09AutoSeededRandomPool+rng%3B%0A%09pubkey.Encrypt%28%0A%09%09rng%2C%0A%09%09%28byte+const*%29plain.data%28%29%2C%0A%09%09plain.size%28%29%2C%0A%09%09sbbCipherText.begin%28%29%29%3B%0A%0A%09FileSink%28encryptedFilename%29.Put%28sbbCipherText.begin%28%29%2C+sbbCipherText.size%28%29%29%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_138%22%3E%3C%2Fa%3E%E7%94%A8%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86%EF%BC%88%E4%BB%8E%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E7%A7%81%E9%92%A5%EF%BC%89%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3E%2F%2F%E7%94%A8privFilename%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86encryptedFilename%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%8A%A0%E5%AF%86%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%E8%A7%A3%E5%AF%86%E5%86%85%E5%AE%B9%E3%80%82%0Astring+Decrypt%28const+char+*privFilename%2C+const+char+*encryptedFilename%29%0A%7B%0A%09string+strContents%2C+recovered%3B%0A%09FileSource%28encryptedFilename%2C+true%2C+new+StringSink%28strContents%29%29%3B%0A%09AutoSeededRandomPool+rng%3B%0A%09RSAES_OAEP_SHA_Decryptor+privkey%28FileSource%28privFilename%2C+true%2C+new+Base64Decoder%29%29%3B%0A%09StringSource%28strContents%2C+true%2C+new+PK_DecryptorFilter%28rng%2C+privkey%2C+new+StringSink%28recovered%29%29%29%3B%0A%09return+recovered%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_153%22%3E%3C%2Fa%3E%E7%94%A8%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86%EF%BC%88%E7%A7%81%E9%92%A5%E5%86%99%E5%88%B0%E4%BB%A3%E7%A0%81%E4%B8%AD%EF%BC%89%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3Estring+Decrypt2%28const+char+*encryptedFilename%29%0A%7B%0A%09string+pri+%3D+%22MIICdAIBADANBgkqhkiG9w0BAQEFAASCAl4wggJaAgEAAoGBALV%2F5ZXl0CJVvbDWWB%2FbVbPz%5C%0A%09%09hS6i7VPAIn6K+%2F+FymKOhuwdAs4sxqRhLJGicfpJAm0vkIdfJwG5sD2xLsXadUbZ8yfrP0S+%2F+XW%5C%0A%09%09e7sngg88X26+%2F+9mrAAiVfDFU+%2B+yXgrr2taZ0+%2F+iLl7OP74jucL6RfqqPGlzKGdBqUoCXY4LwAw0%5C%0A%09%09SjRrAgERAoGAJV4YreuMu8ZbwoZ7jhaRpQx9TV3HcyAHGg2OT09ixnEn5xhMz7uG5b+%2F+92uDe%5C%0A%09%09Ha2j5+%2F+o2Zp6cRY+%2F+aR6kiVyf4cz+%2F+3FHUW0sGpLRPuE0YePQFg+%2F+%2Bz88iNyafOsNXC7XrOUlbP2%5C%0A%09%09hK9cNbk+%2F+43L0NXj3cSXPndzI7CP45gB7xl8KB2kCQQC9mFlx7VFYK3fYBrPpsOdwze604m7L%5C%0A%09%09v9jRRIDIEGtQKUHwLx0PYOxQnolOliQtALuDsK66dxOsroAWc13+%2B+UlEJAkEA9RGuAIISiIhD%5C%0A%09%09yhuP+%2F+huoI+%2B+Og+%2B+cDVVNeeYECGG36hxpDtrHZ0IfpfKsBWoekb6InRgPUC6RkpFKz58vN8+%2B+qKa%5C%0A%09%090wJALJxRR+%2F+uaq1WFnD3P+%2B+sA2dOUpG4CSiktCEx8tXEAZQAm1KXR+%2F+TumhA+%2B+kRP6rbVeIOAN5H%5C%0A%09%09Ou7Xc+%2B+zS2BslLMgTEQJBAMnSUw96LWFhKMSPK0m8bFnKhJFxoKA5GQP45ul3WAzv0spDbrKR%5C%0A%09%099AUW3e6+%2F+%2BN2erIhRTbDniz40GSJuKrBJrK0CQH%2Fhg5LLpMx80oX6JUfQFfYYZ7FkgBwfEh8v%5C%0A%09%09iUmE+%2B+zgondETTnULzWU9JxoQxrkRfg0qu9NcTPZQ5oqv%2BVnUKH4%3D%22%3B%0A%09string+strContents%2C+recovered%3B%0A%09FileSource%28encryptedFilename%2C+true%2C+new+StringSink%28strContents%29%29%3B%0A%09AutoSeededRandomPool+rng%3B%0A%09RSAES_OAEP_SHA_Decryptor+privkey%28StringSource%28pri%2C+true%2C+new+Base64Decoder%29%29%3B%0A%09StringSource%28strContents%2C+true%2C+new+PK_DecryptorFilter%28rng%2C+privkey%2C+new+StringSink%28recovered%29%29%29%3B%0A%09return+recovered%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_179%22%3E%3C%2Fa%3E%E7%94%A8%E7%A7%81%E9%92%A5%E7%AD%BE%E5%90%8D%E4%BF%A1%E6%81%AF%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3Evoid+sign%28const+char+*privFilename%2C+const+char+*tobesignedFilename%2C+const+char+*signedFilename%29%0A%7B%0A%09RSASSA_PKCS1v15_SHA_Signer+privkey%28FileSource%28privFilename%2C+true%2C+new+Base64Decoder%29%29%3B%0A%09AutoSeededRandomPool+rng%3B%0A%09FileSource%28tobesignedFilename%2C+true%2C+new+SignerFilter%28rng%2C+privkey%2C+new+HexEncoder%28new+FileSink%28signedFilename%29%29%29%29%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_190%22%3E%3C%2Fa%3E%E7%94%A8%E5%85%AC%E9%92%A5%E9%AA%8C%E8%AF%81%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3Evoid+ver%28const+char+*pubFilename%2C+const+char+*tobesignedFilename%2C+const+char+*signedFilename%29%0A%7B%0A%09RSASSA_PKCS1v15_SHA_Verifier+pubkey%28FileSource%28pubFilename%2C+true%2C+new+Base64Decoder%29%29%3B%0A%0A%09AutoSeededRandomPool+rng%3B%0A%09FileSource+signatureFile%28signedFilename%2C+true%2C+new+HexDecoder%29%3B%0A%0A%09if+%28signatureFile.MaxRetrievable%28%29+%21%3D+pubkey.SignatureLength%28%29%29%0A%09%7B%0A%09%09printf%28%22%5CnNO%5Cn%22%29%3B%0A%09%09return%3B%0A%09%7D%0A%09SecByteBlock+signature%28pubkey.SignatureLength%28%29%29%3B%0A%09signatureFile.Get%28signature%2C+signature.size%28%29%29%3B%0A%0A%09SignatureVerificationFilter+*verifierFilter+%3D+new+SignatureVerificationFilter%28pubkey%29%3B%0A%09verifierFilter-%26gt%3BPut%28signature%2C+pubkey.SignatureLength%28%29%29%3B%0A%09FileSource%28tobesignedFilename%2C+true%2C+verifierFilter%29%3B%0A%09printf%28%22%5Cn%25d%5Cn%22%2C+verifierFilter-%26gt%3BGetLastResult%28%29%29%3B%0A%7D%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_216%22%3E%3C%2Fa%3E%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%3C%2Fh2%3E+%0A++%3Cpre%3E%3Ccode%3E%09char+priKeyFile%5B128%5D+%3D+%7B+0+%7D%3B%0A%09char+pubKeyFile%5B128%5D+%3D+%7B+0+%7D%3B%0A%09char+encryptedFile%5B128%5D+%3D+%7B+0+%7D%3B%0A%0A%09strcpy%28priKeyFile%2C+%22privkey.txt%22%29%3B++%2F%2F+%E7%A7%81%E9%92%A5%E6%96%87%E4%BB%B6%E5%90%8D%0A%09strcpy%28pubKeyFile%2C+%22pubkey.txt%22%29%3B++%2F%2F+%E5%85%AC%E9%92%A5%E6%96%87%E4%BB%B6%E5%90%8D%0A%09strcpy%28encryptedFile%2C+%22encrypted.dat%22%29%3B%0A%0A%09%2F%2F%E7%94%9F%E6%88%90RSA%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5%0A%09GenerateRSAKey%281024%2C+priKeyFile%2C+pubKeyFile%29%3B%0A%0A%09string+str+%3D+%22123ADS+123ADS+123ADS+123ADS%22%3B%0A%0A%09Encrypt%28str%2C+pubKeyFile%2C+encryptedFile%29%3B%0A%09string+re+%3D+Decrypt%28priKeyFile%2C+encryptedFile%29%3B%0A++++cout+%26lt%3B%26lt%3B+re+%26lt%3B%26lt%3B+endl%3B%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Fmdeditor%2Fmarkdown_views-258a4616f7.css%22+rel%3D%22stylesheet%22%3E+%0A%3C%2Fdiv%3E" | url_decode}}