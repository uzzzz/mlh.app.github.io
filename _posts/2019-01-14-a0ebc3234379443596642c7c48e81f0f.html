---
layout: default
title: Keras实现基于MSCNN的人群计数
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cdiv+class%3D%22show-content-free%22%3E+%0A+++%3Cp%3E%E5%AF%B9%E5%9B%BE%E7%89%87%E4%B8%AD%E7%9A%84%E7%89%A9%E4%BD%93%E8%BF%9B%E8%A1%8C%E8%AE%A1%E6%95%B0%E6%98%AF%E4%B8%80%E4%B8%AA%E9%9D%9E%E5%B8%B8%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9C%BA%E6%99%AF%EF%BC%8C%E5%B0%A4%E5%85%B6%E6%98%AF%E5%AF%B9%E4%BA%BA%E7%BE%A4%E6%88%96%E8%80%85%E8%BD%A6%E8%BE%86%E8%AE%A1%E6%95%B0%EF%BC%8C%E9%80%9A%E8%BF%87%E8%AE%A1%E6%95%B0%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%BE%97%E5%BD%93%E5%89%8D%E7%8E%AF%E5%A2%83%E7%9A%84%E6%B5%81%E9%87%8F%E4%B8%8E%E6%8B%A5%E6%8C%A4%E7%8A%B6%E5%86%B5%E3%80%82%E7%8E%B0%E6%9C%89%E7%9A%84%E4%BA%BA%E7%BE%A4%E8%AE%A1%E6%95%B0%E6%96%B9%E6%B3%95%E9%80%9A%E5%B8%B8%E5%8F%AF%E4%BB%A5%E5%88%86%E4%B8%BA%E4%B8%A4%E7%B1%BB%EF%BC%9A%E5%9F%BA%E4%BA%8E%E6%A3%80%E6%B5%8B%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E5%9F%BA%E4%BA%8E%E5%9B%9E%E5%BD%92%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82%E5%9F%BA%E4%BA%8E%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E7%9A%84%E6%96%B9%E6%B3%95%E5%9C%A8%E5%AF%86%E9%9B%86%E7%9A%84%E5%B0%8F%E7%9B%AE%E6%A0%87%E4%B8%8A%E6%95%88%E6%9E%9C%E5%B9%B6%E4%B8%8D%E7%90%86%E6%83%B3%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%BE%88%E5%A4%9A%E7%A0%94%E7%A9%B6%E9%87%87%E7%94%A8%E4%BA%86%E5%9F%BA%E4%BA%8E%E5%83%8F%E7%B4%A0%E5%9B%9E%E5%BD%92%E7%9A%84%E6%96%B9%E6%B3%95%E8%BF%9B%E8%A1%8C%E8%AE%A1%E6%95%B0%E3%80%82%E6%9C%AC%E6%96%87%E5%AE%9E%E7%8E%B0%E4%BA%86%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8EKeras%E7%9A%84MSCNN%E4%BA%BA%E7%BE%A4%E8%AE%A1%E6%95%B0%E6%A8%A1%E5%9E%8B%E3%80%82%3C%2Fp%3E+%0A+++%3Cp%3E%3Cstrong%3Egithub%3C%2Fstrong%3E%EF%BC%9A%3Ca+href%3D%22https%3A%2F%2Fgithub.com%2Fxiaochus%2FMSCNN%22+rel%3D%22nofollow%22%3Ehttps%3A%2F%2Fgithub.com%2Fxiaochus%2FMSCNN%3C%2Fa%3E%3Cbr%3E%3Cstrong%3Epaper%3C%2Fstrong%3E%EF%BC%9A%3Ca+href%3D%22https%3A%2F%2Farxiv.org%2Fabs%2F1702.02359%22+rel%3D%22nofollow%22%3EMulti-scale+convolutional+neural+network+for+crowd+counting%3C%2Fa%3E%3C%2Fp%3E+%0A+++%3Ch2%3E%E7%8E%AF%E5%A2%83%3C%2Fh2%3E+%0A+++%3Cul%3E%0A++++%3Cli%3EPython+3.6%3C%2Fli%3E+%0A++++%3Cli%3EKeras+2.2.2%3C%2Fli%3E+%0A++++%3Cli%3ETensorflow-gpu+1.8.0%3C%2Fli%3E+%0A++++%3Cli%3EOpenCV+3.4%3C%2Fli%3E+%0A+++%3C%2Ful%3E%0A+++%3Ch2%3E%E6%95%B0%E6%8D%AE%3C%2Fh2%3E+%0A+++%3Cp%3E%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E9%87%87%E7%94%A8%3Ca+href%3D%22http%3A%2F%2Fpersonal.ie.cuhk.edu.hk%2F%7Eccloy%2Fdownloads_mall_dataset.html%22+rel%3D%22nofollow%22%3EMall+Dataset+crowd+counting+dataset%3C%2Fa%3E%EF%BC%8C%E8%AF%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8C%85%E6%8B%ACjpeg%E6%A0%BC%E5%BC%8F%E7%9A%84%E8%A7%86%E9%A2%91%E5%B8%A7%EF%BC%8C%E5%9C%B0%E9%9D%A2%E5%AE%9E%E5%86%B5%EF%BC%8C%E9%80%8F%E8%A7%86%E6%A0%87%E5%87%86%E5%8C%96%E7%89%B9%E5%BE%81%E5%92%8C%E9%80%8F%E8%A7%86%E6%A0%87%E5%87%86%E5%8C%96%E5%9B%BE%EF%BC%8C%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%9A%3C%2Fp%3E+%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-d4cea6393b28c7d0.jpg%22+alt%3D%225164048-d4cea6393b28c7d0.jpg%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++shopping_mall_annotated%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-02f8d6cb8ed1d8e3.jpg%22+alt%3D%225164048-02f8d6cb8ed1d8e3.jpg%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++shopping_mall_perspective%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Cp%3E%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%9A%84%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%9A%3Cbr%3E+1.%E9%A6%96%E5%85%88%E6%A0%B9%E6%8D%AE%E6%A0%87%E6%B3%A8%E6%96%87%E4%BB%B6%E8%AF%BB%E5%85%A5%E5%9B%BE%E5%83%8F%E5%92%8C%E6%A0%87%E6%B3%A8%E3%80%82%3Cbr%3E+2.%E6%A0%B9%E6%8D%AE%E7%BD%91%E7%BB%9C%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%A4%A7%E5%B0%8F%E5%A4%84%E7%90%86%E6%A0%87%E6%B3%A8%E6%96%87%E4%BB%B6%E3%80%82%3Cbr%3E+3.%E5%B0%86%E4%BA%BA%E7%BE%A4%E4%BD%8D%E7%BD%AE%E6%98%A0%E5%B0%84%E4%B8%BA%E5%AF%86%E5%BA%A6%E5%9B%BE%EF%BC%8C%E5%85%B6%E4%B8%AD%E5%AF%86%E5%BA%A6%E5%9B%BE%E4%BD%BF%E7%94%A8%E4%BA%86%E9%AB%98%E6%96%AF%E6%BB%A4%E6%B3%A2%E5%A4%84%E7%90%86%E3%80%82%3C%2Fp%3E+%0A+++%3Cpre%3E%3Ccode%3Edef+read_annotations%28%29%3A%0A++++%22%22%22read+annotation+data.%0A%0A++++Returns%3A%0A++++++++count%3A+ndarray%2C+head+count.%0A++++++++position%3A+ndarray%2C+coordinate.%0A++++%22%22%22%0A++++data+%3D+sio.loadmat%28%27data%5C%5Cmall_dataset%5C%5Cmall_gt.mat%27%29%0A++++count+%3D+data%5B%27count%27%5D%0A++++position+%3D+data%5B%27frame%27%5D%5B0%5D%0A%0A++++return+count%2C+position%0A%0A%0Adef+map_pixels%28img%2C+image_key%2C+annotations%2C+size%29%3A%0A++++%22%22%22map+annotations+to+density+map.%0A%0A++++Arguments%3A%0A++++++++img%3A+ndarray%2C+img.%0A++++++++image_key%3A+int%2C+image_key.%0A++++++++annotations%3A+ndarray%2C+annotations.%0A++++++++size%3A+resize+size.%0A%0A++++Returns%3A%0A++++++++pixels%3A+ndarray%2C+density+map.%0A++++%22%22%22%0A++++gaussian_kernel+%3D+15%0A++++h%2C+w+%3D+img.shape%5B%3A-1%5D%0A++++sh%2C+sw+%3D+size+%2F+h%2C+size+%2F+w%0A++++pixels+%3D+np.zeros%28%28size%2C+size%29%29%0A%0A++++for+a+in+annotations%5Bimage_key%5D%5B0%5D%5B0%5D%5B0%5D%3A%0A++++++++x%2C+y+%3D+int%28a%5B0%5D+*+sw%29%2C+int%28a%5B1%5D+*+sh%29%0A++++++++if+y+%26gt%3B%3D+size+or+x+%26gt%3B%3D+size%3A%0A++++++++++++print%28%22%7B%7D%2C%7B%7D+is+out+of+range%2C+skipping+annotation+for+%7B%7D%22.format%28x%2C+y%2C+image_key%29%29%0A++++++++else%3A%0A++++++++++++pixels%5By%2C+x%5D+%2B%3D+1%0A%0A++++pixels+%3D+cv2.GaussianBlur%28pixels%2C+%28gaussian_kernel%2C+gaussian_kernel%29%2C+0%29%0A%0A++++return+pixels%0A%0A%0Adef+get_data%28i%2C+size%2C+annotations%29%3A%0A++++%22%22%22get+data+accoding+to+the+image_key.%0A%0A++++Arguments%3A%0A++++++++i%3A+int%2C+image_key.%0A++++++++size%3A+int%2C+input+shape+of+network.%0A++++++++annotations%3A+ndarray%2C+annotations.%0A%0A++++Returns%3A%0A++++++++img%3A+ndarray%2C+img.%0A++++++++density_map%3A+ndarray%2C+density+map.%0A++++%22%22%22%0A++++name+%3D+%27data%5C%5Cmall_dataset%5C%5Cframes%5C%5Cseq_%7B%7D.jpg%27.format%28str%28i+%2B+1%29.zfill%286%29%29%0A++++img+%3D+cv2.imread%28name%29%0A%0A++++density_map+%3D+map_pixels%28img%2C+i%2C+annotations%2C+size+%2F%2F+4%29%0A%0A++++img+%3D+cv2.resize%28img%2C+%28size%2C+size%29%29%0A++++img+%3D+img+%2F+255.%0A++++%0A++++density_map+%3D+np.expand_dims%28density_map%2C+axis%3D-1%29%0A%0A++++return+img%2C+density_map%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+++%3Cp%3E%E5%AF%86%E5%BA%A6%E5%9B%BE%E8%BF%98%E8%A6%81%E4%BD%BF%E7%94%A8%E9%AB%98%E6%96%AF%E6%BB%A4%E6%B3%A2%E5%A4%84%E7%90%86%E6%98%AF%E5%9B%A0%E4%B8%BA%E5%9C%A8%E7%A9%BA%E9%97%B4%E4%B8%AD%E8%AE%A1%E6%95%B0%E6%97%B6%EF%BC%8C%E6%AF%8F%E4%B8%AA%E4%BA%BA%E5%8F%AA%E5%8D%A0%E4%B8%80%E4%B8%AA%E5%83%8F%E7%B4%A0%E7%82%B9%E5%AF%BC%E8%87%B4%E6%9C%80%E7%BB%88%E5%BE%97%E5%88%B0%E7%9A%84%E5%AF%86%E5%BA%A6%E5%88%86%E5%B8%83%E5%9B%BE%E7%89%B9%E5%88%AB%E7%A8%80%E7%96%8F%EF%BC%8C%E4%BC%9A%E5%AF%BC%E8%87%B4%E6%A8%A1%E5%9E%8B%E6%94%B6%E6%95%9B%E5%88%B0%E5%85%A80%E7%8A%B6%E6%80%81%E3%80%82%E5%9B%A0%E6%AD%A4%E9%80%9A%E8%BF%87%E9%AB%98%E6%96%AF%E5%A4%84%E7%90%86%E5%90%8E%EF%BC%8C%E5%AF%86%E5%BA%A6%E5%9B%BE%E5%91%88%E7%8E%B0%E5%87%BA%E7%83%AD%E5%8A%9B%E5%9B%BE%E7%9A%84%E5%BD%A2%E5%BC%8F%EF%BC%8C%E4%B8%80%E5%AE%9A%E7%A8%8B%E5%BA%A6%E4%B8%8A%E8%A7%A3%E5%86%B3%E4%BA%86%E7%A8%80%E7%96%8F%E9%97%AE%E9%A2%98%E3%80%82%E8%80%8C%E4%B8%94%E9%AB%98%E6%96%AF%E5%A4%84%E7%90%86%E5%90%8E%E7%9A%84%E5%AF%86%E5%BA%A6%E5%9B%BE%EF%BC%8C%E6%80%BB%E8%AE%A1%E6%95%B0%E6%98%AF%E4%B8%8D%E5%8F%98%E7%9A%84%E3%80%82%3C%2Fp%3E+%0A+++%3Cp%3E%E5%A4%84%E7%90%86%E8%BF%87%E7%9A%84%E8%BE%93%E5%85%A5%E5%9B%BE%E5%83%8F%E4%BB%A5%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%BA%94%E7%9A%84%E5%AF%86%E5%BA%A6%E5%9B%BE%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%9A%3C%2Fp%3E+%0A+++%3Cbr%3E%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-e19008829ce71462.png%22+alt%3D%225164048-e19008829ce71462.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++density_map%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Ch2%3E%E6%A8%A1%E5%9E%8B%3C%2Fh2%3E+%0A+++%3Cp%3E%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%95%B4%E4%BD%93%E5%A6%82%E4%B8%8B%E5%9B%BE%E6%89%80%E7%A4%BA%EF%BC%8C%E6%98%AF%E4%B8%80%E4%B8%AA%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%E7%9A%84%E7%AB%AF%E5%AF%B9%E7%AB%AF%E7%BD%91%E7%BB%9C%E3%80%82%3C%2Fp%3E+%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-e31e734257bf6282.png%22+alt%3D%225164048-e31e734257bf6282.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++Multi-scale+convolutional+neural+network+for+crowd+counting%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Cp%3E%E9%92%88%E5%AF%B9%E5%9B%BE%E5%83%8F%E4%B8%AD%E7%9A%84%E7%9B%AE%E6%A0%87%E9%83%BD%E6%98%AF%E5%B0%8F%E7%9B%AE%E6%A0%87%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E4%BD%9C%E8%80%85%E5%80%9F%E9%89%B4%E4%BA%86Inception%E6%A8%A1%E5%9E%8B%E6%8F%90%E5%87%BA%E4%BA%86%E4%B8%80%E4%B8%AAMulti-Scale+Blob+%28MSB%29+%E7%BB%93%E6%9E%84%EF%BC%8C%E7%94%A8%E6%9D%A5%E5%A2%9E%E5%BC%BA%E7%89%B9%E5%BE%81%E7%9A%84%E5%A4%9A%E6%A0%B7%E6%80%A7%E3%80%82%3C%2Fp%3E+%0A+++%3Cbr%3E%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-04ea6a3346795c19.png%22+alt%3D%225164048-04ea6a3346795c19.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++Multi-scale+blob+with+different+kernel+size%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Cp%3E%E8%AE%BA%E6%96%87%E4%B8%AD%E7%BB%99%E5%87%BA%E7%9A%84%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%9A%3C%2Fp%3E+%0A+++%3Cbr%3E%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-b18c1a2027b47869.png%22+alt%3D%225164048-b18c1a2027b47869.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++The+multi+scale+CNN+architecture%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Ch2%3E%E5%AE%9E%E7%8E%B0%3C%2Fh2%3E+%0A+++%3Cp%3E%E5%9F%BA%E4%BA%8EKeras%E5%AE%9E%E7%8E%B0%E8%BF%99%E4%B8%AA%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84%EF%BC%9A%3C%2Fp%3E+%0A+++%3Cpre%3E%3Ccode%3E%23+-*-+coding%3A+utf-8+-*-%0A%0Afrom+keras.layers+import+Input%2C+Conv2D%2C+MaxPooling2D%2C+concatenate%2C+Activation%0Afrom+keras.layers.normalization+import+BatchNormalization%0Afrom+keras.models+import+Model%0Afrom+keras.regularizers+import+l2%0Afrom+keras.utils.vis_utils+import+plot_model%0A%0A%0Adef+MSB%28filters%29%3A%0A++++%22%22%22Multi-Scale+Blob.%0A%0A++++Arguments%3A%0A++++++++filters%3A+int%2C+filters+num.%0A%0A++++Returns%3A%0A++++++++f%3A+function%2C+layer+func.%0A++++%22%22%22%0A++++params+%3D+%7B%27activation%27%3A+%27relu%27%2C+%27padding%27%3A+%27same%27%2C%0A++++++++++++++%27kernel_regularizer%27%3A+l2%285e-4%29%7D%0A%0A++++def+f%28x%29%3A%0A++++++++x1+%3D+Conv2D%28filters%2C+9%2C+**params%29%28x%29%0A++++++++x2+%3D+Conv2D%28filters%2C+7%2C+**params%29%28x%29%0A++++++++x3+%3D+Conv2D%28filters%2C+5%2C+**params%29%28x%29%0A++++++++x4+%3D+Conv2D%28filters%2C+3%2C+**params%29%28x%29%0A++++++++x+%3D+concatenate%28%5Bx1%2C+x2%2C+x3%2C+x4%5D%29%0A++++++++x+%3D+BatchNormalization%28%29%28x%29%0A++++++++x+%3D+Activation%28%27relu%27%29%28x%29%0A%0A++++++++return+x%0A++++return+f%0A%0A%0Adef+MSCNN%28input_shape%29%3A%0A++++%22%22%22Multi-scale+convolutional+neural+network+for+crowd+counting.%0A%0A++++Arguments%3A%0A++++++++input_shape%3A+tuple%2C+image+shape+with+%28w%2C+h%2C+c%29.%0A%0A++++Returns%3A%0A++++++++model%3A+Model%2C+keras+model.%0A++++%22%22%22%0A++++inputs+%3D+Input%28shape%3Dinput_shape%29%0A%0A++++x+%3D+Conv2D%2864%2C+9%2C+activation%3D%27relu%27%2C+padding%3D%27same%27%29%28inputs%29%0A++++x+%3D+MSB%284+*+16%29%28x%29%0A++++x+%3D+MaxPooling2D%28%29%28x%29%0A++++x+%3D+MSB%284+*+32%29%28x%29%0A++++x+%3D+MSB%284+*+32%29%28x%29%0A++++x+%3D+MaxPooling2D%28%29%28x%29%0A++++x+%3D+MSB%283+*+64%29%28x%29%0A++++x+%3D+MSB%283+*+64%29%28x%29%0A++++x+%3D+Conv2D%281000%2C+1%2C+activation%3D%27relu%27%2C+kernel_regularizer%3Dl2%285e-4%29%29%28x%29%0A++++x+%3D+Conv2D%281%2C+1%2C+activation%3D%27relu%27%29%28x%29%0A%0A++++model+%3D+Model%28inputs%3Dinputs%2C+outputs%3Dx%29%0A%0A++++return+model%0A%0A%0Aif+__name__+%3D%3D+%27__main__%27%3A%0A++++model+%3D+MSCNN%28%28224%2C+224%2C+3%29%29%0A%0A++++print%28model.summary%28%29%29%0A++++plot_model%28model%2C+to_file%3D%27images%5Cmodel.png%27%2C+show_shapes%3DTrue%29%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+++%3Ch2%3E%E5%AE%9E%E9%AA%8C%3C%2Fh2%3E+%0A+++%3Cp%3E%E5%9C%A8%E9%A1%B9%E7%9B%AE%E9%87%8C%E9%80%9A%E8%BF%87%E4%B8%8B%E5%88%97%E5%91%BD%E4%BB%A4%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%EF%BC%9A%3C%2Fp%3E+%0A+++%3Cpre%3E%3Ccode%3Epython+train.py+--size+224+--batch+16+--epochs+10%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+++%3Cp%3E%E7%94%B1%E4%BA%8E%E7%9B%AE%E5%89%8D%E6%B2%A1%E6%9C%89%E8%B6%B3%E9%87%8F%E7%9A%84%E8%AE%A1%E7%AE%97%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8%EF%BC%8C%E6%88%91%E4%BB%AC%E5%AF%B9%E6%A8%A1%E5%9E%8B%E5%81%9A%E4%BA%86%E4%B8%80%E4%B8%AA%E5%88%9D%E6%AD%A5%E8%AE%AD%E7%BB%83%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C%E3%80%82%3C%2Fp%3E+%0A+++%3Cp%3E%E4%B8%8B%E9%9D%A2%E6%98%AF%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%AD%E7%9B%B8%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%8C%E7%9C%9F%E5%AE%9E%E7%9A%84count%E6%98%AF30%EF%BC%8C%E9%A2%84%E6%B5%8B%E7%9A%84count%E6%98%AF27%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A4%A7%E8%87%B4%E6%8E%A5%E8%BF%91%E3%80%82%E8%80%8C%E4%B8%94%E5%85%B6%E4%BA%BA%E7%BE%A4%E5%AF%86%E5%BA%A6%E5%9B%BE%E4%B9%9F%E4%B8%8E%E5%9B%BE%E7%89%87%E4%B8%AD%E7%9A%84%E7%9C%9F%E5%AE%9E%E4%BA%BA%E7%BE%A4%E5%88%86%E5%B8%83%E5%AF%B9%E5%BA%94%E3%80%82%3C%2Fp%3E+%0A+++%3Cbr%3E%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-7e266bcbce382c9c.png%22+alt%3D%225164048-7e266bcbce382c9c.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++res1%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Cp%3E%E4%B8%8B%E9%9D%A2%E6%98%AF%E9%9A%8F%E4%BE%BF%E6%89%BE%E4%BA%86%E4%B8%80%E5%BC%A0%E8%83%8C%E6%99%AF%E5%92%8C%E8%A7%92%E5%BA%A6%E9%83%BD%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BA%BA%E7%BE%A4%E5%9B%BE%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%87%BA%E9%A2%84%E6%B5%8B%E5%87%BA%E7%8E%B0%E4%BA%86%E8%BE%83%E5%A4%A7%E7%9A%84%E5%81%8F%E5%B7%AE%E3%80%82%E8%BF%99%E6%98%AF%E5%9B%A0%E4%B8%BA%E8%AE%AD%E7%BB%83%E9%9B%86%E8%BE%83%E4%B8%BA%E5%8D%95%E4%B8%80%E7%9A%84%E7%BC%98%E6%95%85%EF%BC%8C%E6%83%B3%E8%A6%81%E5%BE%97%E5%88%B0%E9%92%88%E5%AF%B9%E7%9C%9F%E5%AE%9E%E5%9C%BA%E6%99%AF%E7%9A%84%E6%A8%A1%E5%9E%8B%EF%BC%8C%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E5%A4%9A%E6%A0%B7%E6%80%A7%E7%9A%84%E8%AE%AD%E7%BB%83%E9%9B%86%E3%80%82%3C%2Fp%3E+%0A+++%3Cp%3Ecount%EF%BC%9A24%3C%2Fp%3E+%0A+++%3Cbr%3E%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-f02b639a7edd7d66.png%22+alt%3D%225164048-f02b639a7edd7d66.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++res2%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A+++%3Cp%3Ecount%EF%BC%9A31%3C%2Fp%3E+%0A+++%3Cbr%3E%0A+++%3Cdiv+class%3D%22image-package%22%3E+%0A++++%3Cdiv+class%3D%22image-container%22%3E+%0A+++++%3Cdiv+class%3D%22image-container-fill%22%3E%3C%2Fdiv%3E+%0A+++++%3Cdiv+class%3D%22image-view%22%3E%0A++++++%3Cimg+src%3D%22https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5164048-b15d92643f701df5.png%22+alt%3D%225164048-b15d92643f701df5.png%22%3E%0A+++++%3C%2Fdiv%3E+%0A++++%3C%2Fdiv%3E+%0A++++%3Cdiv+class%3D%22image-caption%22%3E%0A+++++res3%0A++++%3C%2Fdiv%3E+%0A+++%3C%2Fdiv%3E+%0A++%3C%2Fdiv%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}