---
layout: default
title: openssl库中安全哈希算法的使用
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3ESHA%3C%2Fp%3E+%0A++%3Cp%3ESHA1%3C%2Fp%3E+%0A++%3Cp%3ESHA224%3C%2Fp%3E+%0A++%3Cp%3ESHA256%3C%2Fp%3E+%0A++%3Cp%3ESHA384%3C%2Fp%3E+%0A++%3Cp%3ESHA512%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%23include+%26lt%3Bstdio.h%26gt%3B%0A%23include+%26lt%3Bstring.h%26gt%3B%0A%23include+%26lt%3Bstdlib.h%26gt%3B%0A%0A%23include+%26lt%3Bopenssl%2Fsha.h%26gt%3B%0A%23include+%26lt%3Bopenssl%2Fcrypto.h%26gt%3B%0A%0Astatic+char+*s1+%3D+%22abc%22%3B%0Astatic+int+s1_len+%3D+3%3B%0A%0Achar+*ret_sha+%3D+%220164b8a914cd2a5e74c4f7ff082c4d97f1edf880%22%3B%0Achar+*ret_sha1+%3D+%22a9993e364706816aba3e25717850c26c9cd0d89d%22%3B%0Achar+*ret_sha224+%3D+%2223097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7%22%3B%0Achar+*ret_sha256+%3D%0A++++%22ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad%22%3B%0Achar+*ret_sha384+%3D%0A++++%22cb00753f45a35e8bb5a03d699ac65007272c32ab0eded1631a8b605a43ff5bed8086072ba1e7cc2358baeca134c825a7%22%3B%0Achar+*ret_sha512+%3D%0A++++%22ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f%22%3B%0A%0Astatic+char+*pt%28unsigned+char+*md%2C+int+len%29%0A%7B%0A%09int+i%3B%0A%09static+char+buf%5B256%5D%3B%0A%0A%09for+%28i+%3D+0%3B+i+%26lt%3B+len%3B+i%2B%2B%29%0A%09%09sprintf%28%26amp%3B%28buf%5Bi+*+2%5D%29%2C+%22%2502x%22%2C+md%5Bi%5D%29%3B%0A%09return+%28buf%29%3B%0A%7D%0A%0Avoid+sha%28void%29%0A%7B%0A%09SHA_CTX+c%3B%0A%09unsigned+char+md%5BSHA_DIGEST_LENGTH%5D%3B%0A%09char+*p%3B%0A%0A%09SHA%28%28unsigned+char+*%29s1%2C+s1_len%2C+md%29%3B%0A%09p+%3D+pt%28md%2C+SHA_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%0A%09SHA_Init%28%26amp%3Bc%29%3B%0A%09SHA_Update%28%26amp%3Bc%2C+s1%2C+s1_len%29%3B%0A%09SHA_Final%28md%2C+%26amp%3Bc%29%3B%0A%09OPENSSL_cleanse%28%26amp%3Bc%2C+sizeof%28c%29%29%3B%0A%09p+%3D+pt%28md%2C+SHA_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%7D%0A%0Avoid+sha1%28void%29%0A%7B%0A%09SHA_CTX+c%3B%0A%09unsigned+char+md%5BSHA_DIGEST_LENGTH%5D%3B%0A%09char+*p%3B%0A%0A%09SHA1%28%28unsigned+char+*%29s1%2C+s1_len%2C+md%29%3B%0A%09p+%3D+pt%28md%2C+SHA_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA1%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%0A%09SHA1_Init%28%26amp%3Bc%29%3B%0A%09SHA1_Update%28%26amp%3Bc%2C+s1%2C+s1_len%29%3B%0A%09SHA1_Final%28md%2C+%26amp%3Bc%29%3B%0A%09OPENSSL_cleanse%28%26amp%3Bc%2C+sizeof%28c%29%29%3B%0A%09p+%3D+pt%28md%2C+SHA_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA1%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%7D%0A%0Avoid+sha224%28void%29%0A%7B%0A%09SHA256_CTX+c%3B%0A%09unsigned+char+md%5BSHA224_DIGEST_LENGTH%5D%3B%0A%09char+*p%3B%0A%0A%09SHA224%28%28unsigned+char+*%29s1%2C+s1_len%2C+md%29%3B%0A%09p+%3D+pt%28md%2C+SHA224_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA224%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%0A%09SHA224_Init%28%26amp%3Bc%29%3B%0A%09SHA224_Update%28%26amp%3Bc%2C+s1%2C+s1_len%29%3B%0A%09SHA224_Final%28md%2C+%26amp%3Bc%29%3B%0A%09OPENSSL_cleanse%28%26amp%3Bc%2C+sizeof%28c%29%29%3B%0A%09p+%3D+pt%28md%2C+SHA224_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA224%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%7D%0A%0Avoid+sha256%28void%29%0A%7B%0A%09SHA256_CTX+c%3B%0A%09unsigned+char+md%5BSHA256_DIGEST_LENGTH%5D%3B%0A%09char+*p%3B%0A%0A%09SHA256%28%28unsigned+char+*%29s1%2C+s1_len%2C+md%29%3B%0A%09p+%3D+pt%28md%2C+SHA256_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA256%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%0A%09SHA256_Init%28%26amp%3Bc%29%3B%0A%09SHA256_Update%28%26amp%3Bc%2C+s1%2C+s1_len%29%3B%0A%09SHA256_Final%28md%2C+%26amp%3Bc%29%3B%0A%09OPENSSL_cleanse%28%26amp%3Bc%2C+sizeof%28c%29%29%3B%0A%09p+%3D+pt%28md%2C+SHA256_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA256%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%7D%0A%0Avoid+sha384%28void%29%0A%7B%0A%09SHA512_CTX+c%3B%0A%09unsigned+char+md%5BSHA384_DIGEST_LENGTH%5D%3B%0A%09char+*p%3B%0A%0A%09SHA384%28%28unsigned+char+*%29s1%2C+s1_len%2C+md%29%3B%0A%09p+%3D+pt%28md%2C+SHA384_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA384%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%0A%09SHA384_Init%28%26amp%3Bc%29%3B%0A%09SHA384_Update%28%26amp%3Bc%2C+s1%2C+s1_len%29%3B%0A%09SHA384_Final%28md%2C+%26amp%3Bc%29%3B%0A%09OPENSSL_cleanse%28%26amp%3Bc%2C+sizeof%28c%29%29%3B%0A%09p+%3D+pt%28md%2C+SHA384_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA384%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%7D%0A%0Avoid+sha512%28void%29%0A%7B%0A%09SHA512_CTX+c%3B%0A%09unsigned+char+md%5BSHA512_DIGEST_LENGTH%5D%3B%0A%09char+*p%3B%0A%0A%09SHA512%28%28unsigned+char+*%29s1%2C+s1_len%2C+md%29%3B%0A%09p+%3D+pt%28md%2C+SHA512_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA512%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%0A%09SHA512_Init%28%26amp%3Bc%29%3B%0A%09SHA512_Update%28%26amp%3Bc%2C+s1%2C+s1_len%29%3B%0A%09SHA512_Final%28md%2C+%26amp%3Bc%29%3B%0A%09OPENSSL_cleanse%28%26amp%3Bc%2C+sizeof%28c%29%29%3B%0A%09p+%3D+pt%28md%2C+SHA512_DIGEST_LENGTH%29%3B%0A%09printf%28%22SHA512%09%3A+%25s%5Cn%22%2C+p%29%3B%0A%7D%0A%0Aint+main%28int+argc%2C+char+*argv%5B%5D%29%0A%7B%0A%09if+%28argc+%26gt%3B+1%29+%7B%0A%09%09s1+%3D+argv%5B1%5D%3B%0A%09%7D%0A%09s1_len+%3D+strlen%28s1%29%3B%0A%0A%09printf%28%22calculating+SHA*+on+%27%25s%27%5Cn%22%2C+s1%29%3B%0A%0A%09sha%28%29%3B%0A%09sha1%28%29%3B%0A%09sha224%28%29%3B%0A%09sha256%28%29%3B%0A%09sha384%28%29%3B%0A%09sha512%28%29%3B%0A%0A%09return+0%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%3Cbr%3E+%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-plain%22%3E%24+gcc+-Wall+-lcrypto+sha.c%0A%0A%0A%24+.%2Fa.out%0Acalculating+SHA*+on+%27abc%27%0ASHA+++++%3A+0164b8a914cd2a5e74c4f7ff082c4d97f1edf880%0ASHA+++++%3A+0164b8a914cd2a5e74c4f7ff082c4d97f1edf880%0ASHA1++++%3A+a9993e364706816aba3e25717850c26c9cd0d89d%0ASHA1++++%3A+a9993e364706816aba3e25717850c26c9cd0d89d%0ASHA224++%3A+23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7%0ASHA224++%3A+23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7%0ASHA256++%3A+ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad%0ASHA256++%3A+ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad%0ASHA384++%3A+cb00753f45a35e8bb5a03d699ac65007272c32ab0eded1631a8b605a43ff5bed8086072ba1e7cc2358baeca134c825a7%0ASHA384++%3A+cb00753f45a35e8bb5a03d699ac65007272c32ab0eded1631a8b605a43ff5bed8086072ba1e7cc2358baeca134c825a7%0ASHA512++%3A+ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f%0ASHA512++%3A+ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f%0A%0A%0A%24+.%2Fa.out+123%0Acalculating+SHA*+on+%27123%27%0ASHA+++++%3A+4f797c608cab4a00501447df8ee8833f363ea7d3%0ASHA+++++%3A+4f797c608cab4a00501447df8ee8833f363ea7d3%0ASHA1++++%3A+40bd001563085fc35165329ea1ff5c5ecbdbbeef%0ASHA1++++%3A+40bd001563085fc35165329ea1ff5c5ecbdbbeef%0ASHA224++%3A+78d8045d684abd2eece923758f3cd781489df3a48e1278982466017f%0ASHA224++%3A+78d8045d684abd2eece923758f3cd781489df3a48e1278982466017f%0ASHA256++%3A+a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3%0ASHA256++%3A+a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3%0ASHA384++%3A+9a0a82f0c0cf31470d7affede3406cc9aa8410671520b727044eda15b4c25532a9b5cd8aaf9cec4919d76255b6bfb00f%0ASHA384++%3A+9a0a82f0c0cf31470d7affede3406cc9aa8410671520b727044eda15b4c25532a9b5cd8aaf9cec4919d76255b6bfb00f%0ASHA512++%3A+3c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2%0ASHA512++%3A+3c9909afec25354d551dae21590bb26e38d53f2173b8d3dc3eee4c047e7ab1c1eb8b85103e3be7ba613b31bb5c9c36214dc9f14a42fd7a2fdb84856bca5c44c2%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%3Cbr%3E+%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fzahuopuboss%2Farticle%2Fdetails%2F9632009%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fzahuopuboss%2Farticle%2Fdetails%2F9632009%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}