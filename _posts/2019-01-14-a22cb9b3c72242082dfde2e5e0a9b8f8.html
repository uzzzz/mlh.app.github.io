---
layout: default
title: 中文自然语言处理——商品评论情感判别
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22article-copyright%22%3E%0A+++%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%EF%BC%9A+https%3A%2F%2Fblog.csdn.net%2Fasialee_bird%2Farticle%2Fdetails%2F86483835+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Ch2%3E%3Cstrong%3E1%E3%80%81%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8B%E8%BD%BD%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%3Cstrong%3E%3Ca+href%3D%22https%3A%2F%2Fgithub.com%2FAsia-Lee%2Fnlp_projects%2Ftree%2Fmaster%2Fchinese_data%22+rel%3D%22nofollow%22%3E%E5%95%86%E5%93%81%EF%BC%88%E4%B9%A6%E7%B1%8D%E3%80%81%E9%85%92%E5%BA%97%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E3%80%81%E7%89%9B%E5%A5%B6%E3%80%81%E6%89%8B%E6%9C%BA%E3%80%81%E7%83%AD%E6%B0%B4%E5%99%A8%EF%BC%89%E7%AD%89%E8%AF%84%E8%AE%BA%E6%95%B0%E6%8D%AE%3C%2Fa%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Efrom+sklearn.model_selection+import+train_test_split%0Afrom+gensim.models.word2vec+import+Word2Vec%0Aimport+numpy+as+np%0Aimport+pandas+as+pd%0Aimport+jieba%0Afrom+sklearn.externals+import+joblib%0Afrom+sklearn.svm+import+SVC%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Cstrong%3E2%E3%80%81%E8%BD%BD%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%81%9A%E9%A2%84%E5%A4%84%E7%90%86%EF%BC%88%E5%88%86%E8%AF%8D%EF%BC%89%EF%BC%8C%E5%88%87%E5%88%86%E8%AE%AD%E7%BB%83%E9%9B%86%E4%B8%8E%E6%B5%8B%E8%AF%95%E9%9B%86%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E8%BD%BD%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%81%9A%E9%A2%84%E5%A4%84%E7%90%86%EF%BC%88%E5%88%86%E8%AF%8D%EF%BC%89%EF%BC%8C%E5%88%87%E5%88%86%E8%AE%AD%E7%BB%83%E9%9B%86%E4%B8%8E%E6%B5%8B%E8%AF%95%E9%9B%86%0Adef+load_file_and_preprocessing%28%29%3A%0A++++neg%3Dpd.read_excel%28%27chinese_data%2Fneg.xls%27%2Cheader%3DNone%2Cindex%3DNone%29%0A++++pos%3Dpd.read_excel%28%27chinese_data%2Fpos.xls%27%2Cheader%3DNone%2Cindex%3DNone%29%0A++++cw%3Dlambda+x%3Alist%28jieba.cut%28x%29%29%0A++++pos%5B%27words%27%5D%3Dpos%5B0%5D.apply%28cw%29%0A++++neg%5B%27words%27%5D%3Dneg%5B0%5D.apply%28cw%29%0A++++%23+use+1+for+positive+sentiment%2C0+for+negative%0A++++y%3Dnp.concatenate%28%28np.ones%28len%28pos%29%29%2Cnp.zeros%28len%28neg%29%29%29%29%0A++++%23%E8%AE%AD%E7%BB%83%E9%9B%86%EF%BC%9A%E6%B5%8B%E8%AF%95%E9%9B%86%3D8%3A2%0A++++x_train%2Cx_test%2Cy_train%2Cy_test%3Dtrain_test_split%28np.concatenate%28%28pos%5B%27words%27%5D%2Cneg%5B%27words%27%5D%29%29%2Cy%2Ctest_size%3D0.2%29%0A%0A++++%23NumPy%E6%8F%90%E4%BE%9B%E4%BA%86%E5%A4%9A%E7%A7%8D%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0%E6%96%B9%E4%BE%BF%E5%AD%98%E5%8F%96%E6%95%B0%E7%BB%84%E5%86%85%E5%AE%B9%EF%BC%88npy%E6%A0%BC%E5%BC%8F%E4%BB%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E7%9A%84%EF%BC%89%0A++++np.save%28%27pre_data%2Fy_train.npy%27%2Cy_train%29%0A++++np.save%28%27pre_data%2Fy_test.npy%27%2Cy_test%29%0A++++return+x_train%2Cx_test%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Cstrong%3E3%E3%80%81%E8%AE%A1%E7%AE%97%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E6%B5%8B%E8%AF%95%E9%9B%86%E6%AF%8F%E6%9D%A1%E8%AF%84%E8%AE%BA%E6%95%B0%E6%8D%AE%E7%9A%84%E5%90%91%E9%87%8F%E5%B9%B6%E5%AD%98%E5%85%A5%E6%96%87%E4%BB%B6%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%AF%B9%E6%AF%8F%E4%B8%AA%E5%8F%A5%E5%AD%90%E7%9A%84%E6%89%80%E6%9C%89%E8%AF%8D%E5%90%91%E9%87%8F%E5%8F%96%E5%9D%87%E5%80%BC%EF%BC%8C%E6%9D%A5%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E5%8F%A5%E5%AD%90%E7%9A%84vector%0Adef+build_sentence_vector%28text%2Csize%2Cw2v_model%29%3A%0A++++vec%3Dnp.zeros%28size%29.reshape%28%281%2Csize%29%29%0A++++count%3D0%0A++++for+word+in+text%3A%0A++++++++try%3A%0A++++++++++++vec%2B%3Dw2v_model%5Bword%5D.reshape%28%281%2Csize%29%29%0A++++++++++++count%2B%3D1%0A++++++++except+KeyError%3A%0A++++++++++++continue%0A++++if+count%21%3D0%3A%0A++++++++vec%2F%3Dcount%0A++++return+vec%0A%0A%23%E8%AE%A1%E7%AE%97%E8%AF%8D%E5%90%91%E9%87%8F%0Adef+get_train_vecs%28x_train%2Cx_test%29%3A%0A++++n_dim%3D300+%23%E8%AF%8D%E5%90%91%E9%87%8F%E7%BB%B4%E5%BA%A6%0A++++%23%E8%AF%95%E7%94%A8Word2Vec%E5%BB%BA%E7%AB%8B%E8%AF%8D%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8B%0A++++w2v_model%3DWord2Vec%28size%3Dn_dim%2Cwindow%3D5%2Csg%3D0%2Chs%3D0%2Cnegative%3D5%2Cmin_count%3D10%29%0A++++w2v_model.build_vocab%28x_train%29+%23%E5%87%86%E5%A4%87%E6%A8%A1%E5%9E%8B%E8%AF%8D%E6%B1%87%E8%A1%A8%0A++++%23%E5%9C%A8%E8%AF%84%E8%AE%BA%E8%AE%AD%E7%BB%83%E9%9B%86%E4%B8%8A%E5%BB%BA%E6%A8%A1%0A++++w2v_model.train%28x_train%2Ctotal_examples%3Dw2v_model.corpus_count%2Cepochs%3Dw2v_model.iter%29+%23%E8%AE%AD%E7%BB%83%E8%AF%8D%E5%90%91%E9%87%8F%0A%0A++++%23%E8%AE%AD%E7%BB%83%E9%9B%86%E8%AF%84%E8%AE%BA%E5%90%91%E9%87%8F%E9%9B%86%E5%90%88%0A++++train_vecs%3Dnp.concatenate%28%5Bbuild_sentence_vector%28z%2Cn_dim%2Cw2v_model%29+for+z+in+x_train%5D%29%0A++++np.save%28%27pre_data%2Ftrain_vecs.npy%27%2Ctrain_vecs%29+%23%E5%B0%86%E8%AE%AD%E7%BB%83%E9%9B%86%E4%BF%9D%E5%AD%98%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD%0A++++print%28train_vecs.shape%29++%23%E8%BE%93%E5%87%BA%E8%AE%AD%E7%BB%83%E9%9B%86%E7%9A%84%E7%BB%B4%E5%BA%A6%0A%0A++++%23%E5%9C%A8%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%8A%E8%AE%AD%E7%BB%83%0A++++w2v_model.train%28x_test%2Ctotal_examples%3Dw2v_model.corpus_count%2Cepochs%3Dw2v_model.iter%29%0A++++w2v_model.save%28%27pre_data%2Fw2v_model%2Fw2v_model.pkl%27%29%0A++++test_vecs%3Dnp.concatenate%28%5Bbuild_sentence_vector%28z%2Cn_dim%2Cw2v_model%29+for+z+in+x_test%5D%29%0A++++np.save%28%27pre_data%2Ftest_vecs.npy%27%2Ctest_vecs%29%0A++++print%28test_vecs.shape%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Cstrong%3E4%E3%80%81%E8%8E%B7%E5%BE%97%E8%AE%AD%E7%BB%83%E9%9B%86%E5%90%91%E9%87%8F%E5%92%8C%E6%A0%87%E7%AD%BE%EF%BC%8C%E6%B5%8B%E8%AF%95%E9%9B%86%E5%90%91%E9%87%8F%E5%92%8C%E6%A0%87%E7%AD%BE%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E8%8E%B7%E5%BE%97%E8%AE%AD%E7%BB%83%E9%9B%86%E5%90%91%E9%87%8F%E5%92%8C%E6%A0%87%E7%AD%BE%EF%BC%8C%E6%B5%8B%E8%AF%95%E9%9B%86%E5%90%91%E9%87%8F%E5%92%8C%E6%A0%87%E7%AD%BE%0Adef+get_data%28%29%3A%0A++++train_vecs%3Dnp.load%28%27pre_data%2Ftrain_vecs.npy%27%29%0A++++y_train%3Dnp.load%28%27pre_data%2Fy_train.npy%27%29%0A++++test_vecs%3Dnp.load%28%27pre_data%2Ftest_vecs.npy%27%29%0A++++y_test%3Dnp.load%28%27pre_data%2Fy_test.npy%27%29%0A++++return+train_vecs%2Cy_train%2Ctest_vecs%2Cy_test%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Cstrong%3E5%E3%80%81%E8%AE%AD%E7%BB%83SVM%E6%A8%A1%E5%9E%8B%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E8%AE%AD%E7%BB%83SVM%E6%A8%A1%E5%9E%8B%0Adef+svm_train%28train_vecs%2Cy_train%2Ctest_vecs%2Cy_test%29%3A%0A++++clf%3DSVC%28kernel%3D%27rbf%27%2Cverbose%3DTrue%29%0A++++clf.fit%28train_vecs%2Cy_train%29+++%23%E6%A0%B9%E6%8D%AE%E7%BB%99%E5%AE%9A%E7%9A%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E6%8B%9F%E5%90%88SVM%E6%A8%A1%E5%9E%8B%0A++++joblib.dump%28clf%2C%27pre_data%2Fsvm_model%2Fmodel.pkl%27%29++%23%E4%BF%9D%E5%AD%98%E8%AE%AD%E7%BB%83%E5%A5%BD%E7%9A%84SVM%E6%A8%A1%E5%9E%8B%0A++++print%28clf.score%28test_vecs%2Cy_test%29%29+++%23%E8%BE%93%E5%87%BA%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E7%9A%84%E5%B9%B3%E5%9D%87%E5%87%86%E7%A1%AE%E5%BA%A6%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Cstrong%3E6%E3%80%81%E6%9E%84%E5%BB%BA%E5%BE%85%E9%81%87%E6%B5%8B%E5%8F%A5%E5%AD%90%E7%9A%84%E5%90%91%E9%87%8F%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E6%9E%84%E5%BB%BA%E5%BE%85%E9%81%87%E6%B5%8B%E5%8F%A5%E5%AD%90%E7%9A%84%E5%90%91%E9%87%8F%0Adef+get_predict_vecs%28words%29%3A%0A++++n_dim%3D300%0A++++w2v_model%3DWord2Vec.load%28%27pre_data%2Fw2v_model%2Fw2v_model.pkl%27%29%0A++++train_vecs%3Dbuild_sentence_vector%28words%2Cn_dim%2Cw2v_model%29%0A++++return+train_vecs%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Cstrong%3E7%E3%80%81%E5%AF%B9%E5%8D%95%E4%B8%AA%E5%8F%A5%E5%AD%90%E8%BF%9B%E8%A1%8C%E6%83%85%E6%84%9F%E5%88%A4%E6%96%AD%3C%2Fstrong%3E%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%AF%B9%E5%8D%95%E4%B8%AA%E5%8F%A5%E5%AD%90%E8%BF%9B%E8%A1%8C%E6%83%85%E6%84%9F%E5%88%A4%E6%96%AD%0Adef+svm_predict%28string%29%3A%0A++++words%3Djieba.lcut%28string%29%0A++++words_vecs%3Dget_predict_vecs%28words%29%0A++++clf%3Djoblib.load%28%27pre_data%2Fsvm_model%2Fmodel.pkl%27%29%0A++++result%3Dclf.predict%28words_vecs%29%0A%0A++++if+int%28result%5B0%5D%29%3D%3D1%3A%0A++++++++print%28string%2C%27positive%27%29%0A++++else%3A%0A++++++++print%28string%2C%27negative%27%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Eif+__name__%3D%3D%27__main__%27%3A%0A++++%23x_train%2C+x_test%3Dload_file_and_preprocessing%28%29%0A++++%23get_train_vecs%28x_train%2C+x_test%29%0A%0A++++%23train_vecs%2C+y_train%2C+test_vecs%2C+y_test%3Dget_data%28%29%0A++++%23svm_train%28train_vecs%2C+y_train%2C+test_vecs%2C+y_test%29%0A%0A++++%23%E5%AF%B9%E8%BE%93%E5%85%A5%E5%8F%A5%E5%AD%90%E6%83%85%E6%84%9F%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD%0A++++string%3D%27%E7%94%B5%E6%B1%A0%E5%85%85%E5%AE%8C%E4%BA%86%E7%94%B5%E8%BF%9E%E6%89%8B%E6%9C%BA%E9%83%BD%E6%89%93%E4%B8%8D%E5%BC%80%EF%BC%8C%E7%AE%80%E7%9B%B4%E7%83%82%E7%9A%84%E8%A6%81%E5%91%BD%EF%BC%8C%E7%9C%9F%E6%98%AF%E9%87%91%E7%8E%89%E5%85%B6%E5%A4%96%EF%BC%8C%E8%B4%A5%E7%B5%AE%E5%85%B6%E4%B8%AD%EF%BC%81%E8%BF%9E5%E5%8F%B7%E7%94%B5%E6%B1%A0%E9%83%BD%E4%B8%8D%E5%A6%82%27%0A++++%23string%3D%27%E7%89%9B%E9%80%BC%E7%9A%84%E6%89%8B%E6%9C%BA%EF%BC%8C%E4%BB%8E3%E7%B1%B3%E9%AB%98%E7%9A%84%E5%9C%B0%E6%96%B9%E6%91%94%E4%B8%8B%E5%8E%BB%E9%83%BD%E6%B2%A1%E5%9D%8F%EF%BC%8C%E8%B4%A8%E9%87%8F%E9%9D%9E%E5%B8%B8%E5%A5%BD%27%0A++++%23string%3D%27%E8%BF%99%E6%AC%BE%E7%94%B5%E8%84%91%E6%84%9F%E8%A7%89%E8%BF%98%E8%A1%8C%EF%BC%8C%E8%83%BD%E7%94%A8%EF%BC%8C%E5%85%88%E8%AF%95%E7%94%A8%E4%B8%80%E4%B8%8B%EF%BC%8C%E5%BA%94%E8%AF%A5%E4%B8%8D%E9%94%99%27%0A++++svm_predict%28string%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2292%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190114210429595.png%22+width%3D%22938%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Ca+href%3D%22https%3A%2F%2Fwww.cnblogs.com%2Fpinard%2Fp%2F6744056.html%22+rel%3D%22nofollow%22%3E%E4%B8%AD%E6%96%87%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%3C%2Fa%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}