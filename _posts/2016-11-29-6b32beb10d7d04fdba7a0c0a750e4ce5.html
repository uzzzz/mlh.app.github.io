---
layout: default
title: DSA签名(非对称加密)
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cstrong%3E%3Cspan+style%3D%22font-size%3A14px%3B%22%3E%E8%AF%B4%E6%98%8E%EF%BC%9A%3C%2Fspan%3E%3C%2Fstrong%3E%0A++%3Cbr%3E%0A++%3Cp%3E%3Cspan+style%3D%22font-size%3A12px%3B%22%3EDSA%E4%B8%BA%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%8C%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E6%8C%87%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E6%89%80%E4%BD%BF%E7%94%A8%E7%9A%84%E5%AF%86%E9%92%A5%E4%B8%8D%E5%90%8C%EF%BC%8C%E5%88%86%E4%B8%BA%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5%EF%BC%8CDSA%E8%BF%98%E6%9C%89%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%9Aapp%E5%8F%91%E8%B5%B7%E6%94%AF%E4%BB%98%E6%97%B6%EF%BC%8C%E4%BD%BF%E7%94%A8%E7%A7%81%E9%92%A5%28%E7%A7%81%E9%92%A5%E4%B8%80%E8%88%AC%E6%94%BE%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%94%A8%E6%97%B6%E8%8E%B7%E5%8F%96%29%E5%AF%B9%E8%AE%A2%E5%8D%95%E4%B8%B2%E7%94%9F%E6%88%90%E7%AD%BE%E5%90%8D%EF%BC%8C%E7%84%B6%E5%90%8E%E5%B0%86%E8%AE%A2%E5%8D%95%E4%B8%B2%E4%B8%8E%E7%AD%BE%E5%90%8D%E4%B8%80%E8%B5%B7%E4%BC%A0%E7%BB%99%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%BF%E7%94%A8%E5%85%AC%E9%92%A5%E5%92%8C%E8%AE%A2%E5%8D%95%E4%B8%B2%E8%BF%9B%E8%A1%8C%3Cspan+style%3D%22font-size%3A12px%3B%22%3E%E7%AD%BE%E5%90%8D%3C%2Fspan%3E%E6%A0%A1%E9%AA%8C%EF%BC%8C%E8%BF%94%E5%9B%9Etrue%E8%A1%A8%E7%A4%BA%E6%A0%A1%E9%AA%8C%E9%80%9A%E8%BF%87%EF%BC%8C%E5%90%A6%E5%88%99%E8%AE%A2%E5%8D%95%E4%BF%A1%E6%81%AF%E5%B0%B1%E6%98%AF%E4%BC%AA%E9%80%A0%E7%9A%84%E3%80%82%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22font-size%3A12px%3B%22%3E%3Cbr%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22font-size%3A14px%3B%22%3E%E4%BD%BF%E7%94%A8%EF%BC%9A%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-java%22%3Epublic+class+DSAUtil+%7B%0A%09private+static+final+String+algorithm+%3D+%22DSA%22%3B%0A%09private+static+final+String+KEY_PUBLIC+%3D+%22PublicKey%22%3B%0A%09private+static+final+String+KEY_PRIVATE+%3D+%22PrivateKey%22%3B%0A%0A%09%2F**%0A%09+*+%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5%E4%B8%B2%E3%80%81%E7%A7%81%E9%92%A5%E4%B8%B2%0A%09+*+%0A%09+*+%40return+Base64%E7%BC%96%E7%A0%81%E8%BF%87%E7%9A%84%E5%85%AC%E9%92%A5%E4%B8%B2%E3%80%81Base64%E7%BC%96%E7%A0%81%E8%BF%87%E7%9A%84%E7%A7%81%E9%92%A5%E4%B8%B2%0A%09+*%2F%0A%09public+static+Map%26lt%3BString%2C+String%26gt%3B+generatorKey%28%29+%7B%0A%09%09Map%26lt%3BString%2C+String%26gt%3B+map+%3D+new+HashMap%26lt%3BString%2C+String%26gt%3B%28%29%3B%0A%09%09try+%7B%0A%09%09%09KeyPairGenerator+keygen+%3D+KeyPairGenerator.getInstance%28algorithm%29%3B%0A%09%09%09%2F%2F+%E5%88%9B%E5%BB%BA%E9%9A%8F%E6%9C%BA%E4%BA%A7%E7%94%9F%E5%99%A8%0A%09%09%09SecureRandom+secureRandom+%3D+new+SecureRandom%28%29%3B%0A%09%09%09secureRandom.setSeed%28%22abcdefg%22.getBytes%28%29%29%3B%0A%09%09%09keygen.initialize%281024%2C+secureRandom%29%3B%0A%0A%09%09%09KeyPair+keys+%3D+keygen.genKeyPair%28%29%3B%0A%09%09%09%2F%2F+%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5%0A%09%09%09DSAPublicKey+publicKey+%3D+%28DSAPublicKey%29+keys.getPublic%28%29%3B%0A%09%09%09map.put%28KEY_PUBLIC%2C+Base64.encode%28publicKey.getEncoded%28%29%29%29%3B%0A%09%09%09%2F%2F+%E7%94%9F%E6%88%90%E7%A7%81%E9%92%A5%0A%09%09%09DSAPrivateKey+privateKey+%3D+%28DSAPrivateKey%29+keys.getPrivate%28%29%3B%0A%09%09%09map.put%28KEY_PRIVATE%2C+Base64.encode%28privateKey.getEncoded%28%29%29%29%3B%0A%09%09%7D+catch+%28NoSuchAlgorithmException+e%29+%7B%0A%09%09%09e.printStackTrace%28%29%3B%0A%09%09%7D%0A%09%09return+map%3B%0A%09%7D%0A%0A%09%2F**%0A%09+*+%E7%94%A8%E7%A7%81%E9%92%A5%E5%AF%B9%E8%AE%A2%E5%8D%95%E4%B8%B2%E8%BF%9B%E8%A1%8C%E7%AD%BE%E5%90%8D%0A%09+*+%0A%09+*+%40param+orderInfo+%E6%9C%AA%E5%8A%A0%E5%AF%86%E8%AE%A2%E5%8D%95%E4%B8%B2%0A%09+*+%40param+privateKey+Base64%E7%BC%96%E7%A0%81%E8%BF%87%E7%9A%84%E7%A7%81%E9%92%A5%E4%B8%B2%0A%09+*+%0A%09+*+%40return+Base64%E7%BC%96%E7%A0%81%E8%BF%87%E7%9A%84%E7%AD%BE%E5%90%8D%E4%B8%B2%0A%09+*%2F%0A%09public+static+String+generatorSign%28String+orderInfo%2C+String+privateKey%29+%7B%0A%09%09try+%7B%0A%09%09%09%2F%2F+%E6%A0%B9%E6%8D%AE%E7%A7%81%E9%92%A5byte%5B%5D%E5%88%9B%E5%BB%BAPKCS8EncodedKeySpec%E5%AF%B9%E8%B1%A1%0A%09%09%09PKCS8EncodedKeySpec+pkcs8KeySpec+%3D+new+PKCS8EncodedKeySpec%28Base64.decode%28privateKey%29%29%3B%0A%09%09%09%2F%2F+%E6%8C%87%E5%AE%9ADSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%0A%09%09%09KeyFactory+keyFactory+%3D+KeyFactory.getInstance%28algorithm%29%3B%0A%09%09%09%2F%2F+%E5%8F%96%E5%BE%97%E7%A7%81%E9%92%A5%E5%AF%B9%E8%B1%A1%0A%09%09%09PrivateKey+priKey+%3D+keyFactory.generatePrivate%28pkcs8KeySpec%29%3B%0A%09%09%09%2F%2F+%E7%94%A8%E7%A7%81%E9%92%A5%E5%AF%B9%E8%AE%A2%E5%8D%95%E4%B8%B2%E8%BF%9B%E8%A1%8C%E7%AD%BE%E5%90%8D%0A%09%09%09Signature+signature+%3D+Signature.getInstance%28keyFactory.getAlgorithm%28%29%29%3B%0A%09%09%09signature.initSign%28priKey%29%3B%0A%09%09%09signature.update%28orderInfo.getBytes%28%29%29%3B%0A%09%09%09%2F%2F+%E5%AF%B9%E7%A7%81%E9%92%A5%E8%BF%9B%E8%A1%8CBase64%E7%BC%96%E7%A0%81%0A%09%09%09return+Base64.encode%28signature.sign%28%29%29%3B%0A%09%09%7D+catch+%28Exception+e%29+%7B%0A%09%09%09e.printStackTrace%28%29%3B%0A%09%09%7D%0A%09%09return+null%3B%0A%09%7D%0A%0A%09%2F**%0A%09+*+%E6%A0%A1%E9%AA%8C%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%0A%09+*+%0A%09+*+%40param+orderInfo+%E6%9C%AA%E5%8A%A0%E5%AF%86%E8%AE%A2%E5%8D%95%E4%B8%B2%0A%09+*+%40param+publicKey+Base64%E7%BC%96%E7%A0%81%E8%BF%87%E7%9A%84%E5%85%AC%E9%92%A5%E4%B8%B2%0A%09+*+%40param+sign+Base64%E7%BC%96%E7%A0%81%E8%BF%87%E7%9A%84%E7%AD%BE%E5%90%8D%E4%B8%B2%0A%09+*+%0A%09+*+%40return+%E6%A0%A1%E9%AA%8C%E6%88%90%E5%8A%9F%E8%BF%94%E5%9B%9Etrue%2C+%E6%A0%A1%E9%AA%8C%E5%A4%B1%E8%B4%A5%E8%BF%94%E5%9B%9Efalse%0A%09+*%2F%0A%09public+static+boolean+verifySign%28String+orderInfo%2C+String+publicKey%2C+String+sign%29+%7B%0A%09%09try+%7B%0A%09%09%09%2F%2F+%E6%A0%B9%E6%8D%AE%E5%85%AC%E9%92%A5byte%5B%5D%E5%88%9B%E5%BB%BAX509EncodedKeySpec%E5%AF%B9%E8%B1%A1%0A%09%09%09X509EncodedKeySpec+keySpec+%3D+new+X509EncodedKeySpec%28Base64.decode%28publicKey%29%29%3B%0A%09%09%09%2F%2F+%E6%8C%87%E5%AE%9ADSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%0A%09%09%09KeyFactory+keyFactory+%3D+KeyFactory.getInstance%28algorithm%29%3B%0A%09%09%09%2F%2F+%E5%8F%96%E5%85%AC%E9%92%A5%E5%AF%B9%E8%B1%A1%0A%09%09%09PublicKey+pubKey+%3D+keyFactory.generatePublic%28keySpec%29%3B%0A%09%09%09%2F%2F+%E6%A0%B9%E6%8D%AE%E5%85%AC%E9%92%A5%E5%92%8C%E5%BE%85%E5%8A%A0%E5%AF%86%E4%B8%B2%E5%88%9D%E5%A7%8B%E5%8C%96Signature%0A%09%09%09Signature+signature+%3D+Signature.getInstance%28keyFactory.getAlgorithm%28%29%29%3B%0A%09%09%09signature.initVerify%28pubKey%29%3B%0A%09%09%09signature.update%28orderInfo.getBytes%28%29%29%3B%0A%09%09%09%2F%2F+%E6%A0%B9%E6%8D%AE%E5%85%AC%E9%92%A5%E5%92%8C%E8%AE%A2%E5%8D%95%E4%B8%B2%E8%BF%9B%E8%A1%8C%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%EF%BC%8C%E9%80%9A%E8%BF%87%E8%A1%A8%E7%A4%BA%E6%AD%A3%E5%B8%B8%EF%BC%8C%E5%90%A6%E5%88%99%E8%A1%A8%E7%A4%BA%E8%AE%A2%E5%8D%95%E4%B8%B2%E6%98%AF%E4%BC%AA%E9%80%A0%E7%9A%84%E3%80%82%0A%09%09%09return+signature.verify%28Base64.decode%28sign%29%29%3B%0A%09%09%7D+catch+%28Exception+e%29+%7B%0A%09%09%09e.printStackTrace%28%29%3B%0A%09%09%7D%0A%09%09return+false%3B%0A%09%7D%0A%0A%09public+static+void+main%28String%5B%5D+args%29+%7B%0A%2F%2F%09%09%2F%2F+%E4%BA%A7%E7%94%9F%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5%EF%BC%8C%E4%BF%9D%E5%AD%98%E8%B5%B7%E6%9D%A5%E4%B8%8B%E6%AC%A1%E4%BD%BF%E7%94%A8%0A%2F%2F%09%09Map%26lt%3BString%2C+String%26gt%3B+keyMap+%3D+generatorKey%28%29%3B%0A%2F%2F%09%09%2F%2F+%E8%8E%B7%E5%BE%97%E5%85%AC%E9%92%A5%0A%2F%2F%09%09String+publicKey+%3D+keyMap.get%28KEY_PUBLIC%29%3B%0A%2F%2F%09%09%2F%2F+%E8%8E%B7%E5%BE%97%E7%A7%81%E9%92%A5%0A%2F%2F%09%09String+privateKey+%3D+keyMap.get%28KEY_PRIVATE%29%3B%0A%2F%2F%09%09System.err.println%28%22%E5%85%AC%E9%92%A5+%3A+%22+%2B+publicKey%29%3B%0A%2F%2F%09%09System.err.println%28%22%E7%A7%81%E9%92%A5+%3A+%22+%2B+privateKey%29%3B%0A%0A%09%09String+privateKey+%3D+%22MIIBSwIBADCCASwGByqGSM44BAEwggEfAoGBAP1%2FU4EddRIpUt9KnC7s5Of2EbdSPO9EAMMeP4C2USZpRV1AIlH7WT2NWPq%2FxfW6MPbLm1Vs14E7gB00b%2FJmYLdrmVClpJ%2Bf6AR7ECLCT7up1%2F63xhv4O1fnxqimFQ8E%2B4P208UewwI1VBNaFpEy9nXzrith1yrv8iIDGZ3RSAHHAhUAl2BQjxUjC8yykrmCouuEC%2FBYHPUCgYEA9%2BGghdabPd7LvKtcNrhXuXmUr7v6OuqC%2BVdMCz0HgmdRWVeOutRZT%2BZxBxCBgLRJFnEj6EwoFhO3zwkyjMim4TwWeotUfI0o4KOuHiuzpnWRbqN%2FC%2FohNWLx%2B2J6ASQ7zKTxvqhRkImog9%2FhWuWfBpKLZl6Ae1UlZAFMO%2F7PSSoEFgIUFzPw6lbL1g8H4Nj89G55StSxqPQ%3D%22%3B%0A%09%09String+publicKey+%3D+%22MIIBtzCCASwGByqGSM44BAEwggEfAoGBAP1%2FU4EddRIpUt9KnC7s5Of2EbdSPO9EAMMeP4C2USZpRV1AIlH7WT2NWPq%2FxfW6MPbLm1Vs14E7gB00b%2FJmYLdrmVClpJ%2Bf6AR7ECLCT7up1%2F63xhv4O1fnxqimFQ8E%2B4P208UewwI1VBNaFpEy9nXzrith1yrv8iIDGZ3RSAHHAhUAl2BQjxUjC8yykrmCouuEC%2FBYHPUCgYEA9%2BGghdabPd7LvKtcNrhXuXmUr7v6OuqC%2BVdMCz0HgmdRWVeOutRZT%2BZxBxCBgLRJFnEj6EwoFhO3zwkyjMim4TwWeotUfI0o4KOuHiuzpnWRbqN%2FC%2FohNWLx%2B2J6ASQ7zKTxvqhRkImog9%2FhWuWfBpKLZl6Ae1UlZAFMO%2F7PSSoDgYQAAoGAdFQMgDfhSx4MMvmtjRBvEnS%2BQ6RVLqbi2aweBsQKpsg48FtnJed%2FMaPhNWonsXltK%2F9rdeh59rws61FsoLy7A6AA%2BjYydqIcOG2vK9u94HDg3ueEttZ5of3%2FKP6bsFLiivfLqMefi9MOGyIafaffpGA%2BUPI4tPh1E0GH53TnCaI%3D%22%3B%0A%09%09%2F%2F+%E5%BE%85%E7%AD%BE%E5%90%8D%E7%9A%84%E8%AE%A2%E5%8D%95%E4%B8%B2%0A%09%09String+orderInfo+%3D+%22orderId%3D1001%26amp%3Bprice%3D10.1%26amp%3Bdesc%3D%E4%B9%A6%E6%9C%AC%26amp%3Bnum%3D1%22%3B%0A%09%09%2F%2F+%E4%BA%A7%E7%94%9F%E7%AD%BE%E5%90%8D%0A%09%09String+sign+%3D+generatorSign%28orderInfo%2C+privateKey%29%3B%0A%09%09System.err.println%28%22%E7%AD%BE%E5%90%8D+%3A+%22+%2B+sign%29%3B%0A%0A%09%09%2F%2F+%E9%AA%8C%E8%AF%81%E7%AD%BE%E5%90%8D%0A%09%09boolean+result+%3D+verifySign%28orderInfo%2C+publicKey%2C+sign%29%3B%0A%09%09System.err.println%28%22%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%E7%BB%93%E6%9E%9C%3A+%22+%2B+result%29%3B%0A%09%7D%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E%0A++%3Cspan+style%3D%22font-size%3A12px%3B%22%3E%3C%2Fspan%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fa526001650a%2Farticle%2Fdetails%2F53391302%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fa526001650a%2Farticle%2Fdetails%2F53391302%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}