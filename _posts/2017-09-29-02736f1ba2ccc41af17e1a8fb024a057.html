---
layout: default
title: 并行加速实战 二维中值滤波器
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3E%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E5%99%A8%E4%BD%BF%E7%94%A8%E4%BA%86%E5%BF%AB%E9%80%9F3x3%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E5%99%A8+%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B16U%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%E6%91%98%E8%A6%81%3C%2Fp%3E+%0A++%3Cp%3E%E6%88%91%E4%BB%AC%E4%BB%A5%E4%B8%8B%E5%B0%86%E4%BD%BF%E7%94%A8%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cstrong%3E1.+SIMD%3A+SSE%2C+AVX%3C%2Fstrong%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cstrong%3E2.+multiThread%3A+openmp%2C+std%3A%3Athread%3C%2Fstrong%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cstrong%3E3.+SIMD+%2B%26nbsp%3BmultiThread%3A%26nbsp%3BAVX+%2B%26nbsp%3Bopenmp%3Cbr%3E%3C%2Fstrong%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cstrong%3E4.+data%3A%26nbsp%3B%E5%88%86%E8%A1%8C%E5%B9%B6%E8%A1%8C%E5%8A%A0%E9%80%9F%EF%BC%8C%E5%88%86%E5%9D%97%E5%84%BF%E5%B9%B6%E8%A1%8C%E5%8A%A0%E9%80%9F%3C%2Fstrong%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%E8%BF%99%E9%87%8C%E5%85%88%E6%8A%8A%E6%96%87%E6%9C%AB%E7%9A%84%E6%80%BB%E7%BB%93%E5%86%99%E5%87%BA%E6%9D%A5%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%E6%80%BB%E7%BB%93%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cstrong%3E1.1+%E5%BF%AB%E9%80%9F3X3%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E6%9C%AC%E8%BA%AB%E7%9A%84%E8%AE%A1%E7%AE%97%E6%98%AF%E5%85%83%E7%B4%A0%E6%AF%94%E8%BE%83%E5%92%8C%E6%8E%92%E5%BA%8F%EF%BC%8C%3C%2Fstrong%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%E5%B1%9E%E4%BA%8E%E6%8E%A7%E5%88%B6%E5%AF%86%E9%9B%86%E5%9E%8B%EF%BC%8C%E8%80%8C%E9%9D%9E%E8%BF%90%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B%3Cbr%3E%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%E6%89%80%E4%BB%A5%E5%B8%A6%E5%AE%BD%E7%9A%84%E8%80%97%E6%97%B6%E6%AF%94%E8%AE%A1%E7%AE%97%E7%9A%84%E8%80%97%E6%97%B6%E6%98%8E%E6%98%BE%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E1.2+%E7%94%B1%E4%BA%8E%E7%AE%97%E6%B3%95%E9%9C%80%E8%A6%81%EF%BC%8C%E6%95%B0%E6%8D%AEIO%E4%BD%BF%E7%94%A8%E7%9A%84%E6%98%AFloadu%E5%92%8Cstoreu%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AFload%E5%92%8Cstore%E3%80%82%E8%AF%BB%E5%86%99%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E8%A6%81%E6%85%A2%E4%B8%80%E4%BA%9B%E3%80%82%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E2.+%E5%8D%95%E6%A0%B8%E7%89%88%E6%9C%AC%E5%92%8CSSE%E5%8A%A0%E9%80%9F%E7%89%88%E6%9C%AC%E8%80%97%E6%97%B6%E5%87%A0%E4%B9%8E%E4%B8%80%E6%A0%B7%EF%BC%8C%E8%BF%99%E9%87%8C%E6%98%AF%E5%9B%A0%E4%B8%BAVS%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E4%BC%98%E5%8C%96%E4%BD%BF%E5%BE%97%E5%BF%AB%E9%80%9F3X3%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E9%80%9F%E5%BA%A6%E5%BE%88%E5%BF%AB%3C%2Fp%3E+%0A++%3Cp%3E%E8%AE%A1%E7%AE%97%E9%80%9F%E5%BA%A6%E7%93%B6%E9%A2%88%E4%B8%BB%E8%A6%81%E5%9C%A8%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%3C%2Fp%3E+%0A++%3Cp%3E3.+omp%E5%8A%A0%E9%80%9F%E7%89%88%E6%9C%AC%E7%9B%B8%E6%AF%94%E5%8D%95%E6%A0%B8%E7%9A%84%E5%BF%AB%E4%BA%863.65%E5%80%8D%EF%BC%8C%E6%8E%A5%E8%BF%914%E5%80%8D%EF%BC%8C%E5%92%8C%E5%9B%9B%E6%A0%B8%E5%8A%A0%E9%80%9F%E6%AF%94%E8%BE%83%E7%AC%A6%E5%90%88%3C%2Fp%3E+%0A++%3Cp%3E4.+omp%E5%88%86%E8%A1%8C%E5%8A%A0%E9%80%9F%E5%92%8C%E5%A4%9A%E8%A1%8C%E5%88%86%E5%9D%97%E5%8A%A0%E9%80%9F%E6%98%AF%E5%87%A0%E4%B9%8E%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%A7%81%E8%BF%99%E9%87%8C%E7%9A%84%E9%A2%9D%E5%A4%96%E5%BC%80%E9%94%80%E4%B8%8D%E5%A4%A7%3C%2Fp%3E+%0A++%3Cp%3E5.+avx%E5%8A%A0%E9%80%9F%E6%98%AFsse%E5%8A%A0%E9%80%9F%E7%9A%841.62%E5%80%8D%EF%BC%8C%E6%8E%A5%E8%BF%912%E5%80%8D%EF%BC%8C%E7%AC%A6%E5%90%88128%E4%BD%8D%E6%95%B0%E6%8D%AE%E5%92%8C256%E4%BD%8D%E6%95%B0%E6%8D%AE%E7%89%B9%E6%80%A7%3C%2Fp%3E+%0A++%3Cp%3E6.+SIMD+%2B+multiThread+%3A+%E8%BF%99%E9%87%8C%E6%B5%8B%E8%AF%95%E4%BA%86avx+%2B+omp%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+6.1+%E5%9C%A8avx%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%A2%9E%E5%8A%A0omp%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A1%AE%E5%AE%9E%E8%83%BD%E5%A2%9E%E5%8A%A03.65%E5%80%8D%E9%80%9F%E5%BA%A6%EF%BC%8C%E6%8E%A5%E8%BF%914%E5%80%8D%EF%BC%8C%E5%92%8C%E5%9B%9B%E6%A0%B8%E5%8A%A0%E9%80%9F%E6%AF%94%E8%BE%83%E7%AC%A6%E5%90%88%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+6.2+avx+%2B+omp%E5%88%86%E8%A1%8C%E5%8A%A0%E9%80%9F%E5%92%8C%E5%A4%9A%E8%A1%8C%E5%88%86%E5%9D%97%E5%8A%A0%E9%80%9F%E6%98%AF%E5%87%A0%E4%B9%8E%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%A7%81%E8%BF%99%E9%87%8C%E7%9A%84%E9%A2%9D%E5%A4%96%E5%BC%80%E9%94%80%E4%B8%8D%E5%A4%A7%3C%2Fp%3E+%0A++%3Cp%3E7.+std%3A%3Athread%E7%9A%84%E9%A2%9D%E5%A4%96%E5%BC%80%E9%94%80%E5%A5%BD%E5%83%8F%E5%BE%88%E5%A4%A7%EF%BC%8C%E5%88%86%E5%9D%97%E5%B9%B6%E8%A1%8C%E5%8F%8D%E8%80%8C%E6%9B%B4%E6%85%A2%E4%BA%86%EF%BC%8C%E8%BF%9120%E5%80%8D%3Cbr%3E%3C%2Fp%3E+%0A++%3Cdiv%3E%0A+++8*+neon%E7%89%88%E6%9C%AC%E5%9C%A8%E6%96%87%E6%9C%AB%EF%BC%8C%E6%9A%82%E6%97%B6%E6%B2%A1%E6%9C%89%E6%B5%8B%E8%AF%95%E8%BF%87%0A++%3C%2Fdiv%3E+%0A++%3Cp%3E%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%E5%85%88%E7%BB%99%E5%87%BA%E5%AE%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E6%93%8D%E4%BD%9C%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%23define+med_op%28a%2Cb%2Ct%29%09%7Bt+%3D+a%3B+a+%3D+MAX%28a%2C+b%29%3B+b+%3D+MIN%28t%2C+b%29%3B%7D%0A%23define+med_op_sse%28a%2Cb%2Ct%29%09%7Bt+%3D+a%3B+a+%3D+_mm_max_epu16%28a%2C+b%29%3B+b+%3D+_mm_min_epu16%28t%2C+b%29%3B+%7D%0A%23define+med_op_neon%28a%2Cb%2Ct%29%09%7Bt+%3D+a%3B+a+%3D+vmaxq_u16%28a%2C+b%29%3B+b+%3D+vminq_u16%28t%2C+b%29%3B+%7D%0A%23define+med_op_avx%28a%2Cb%2Ct%29%09%7Bt+%3D+a%3B+a+%3D+_mm256_max_epu16%28a%2C+b%29%3B+b+%3D+_mm256_min_epu16%28t%2C+b%29%3B+%7D%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cbr%3E+%E8%BF%99%E9%87%8C%E5%85%88%E4%BB%8B%E7%BB%8D%E5%8D%95%E6%A0%B8%E7%89%88%E6%9C%AC%E7%9A%84+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Evoid+medianFilt%3A%3Amedian3%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A++++U16+p0+%3D+0%3B%0A++++U16+p1+%3D+0%3B%0A++++U16+p2+%3D+0%3B%0A++++U16+p3+%3D+0%3B%0A++++U16+p4+%3D+0%3B%0A++++U16+p5+%3D+0%3B%0A++++U16+p6+%3D+0%3B%0A++++U16+p7+%3D+0%3B%0A++++U16+p8+%3D+0%3B%0A++++U16+tmp+%3D+0%3B%0A%0A++++S32+i0+%3D+0%3B%0A++++S32+i+%3D+0%3B%0A++++S32+i2+%3D+0%3B%0A++++S32+j+%3D+0%3B%0A%0A++++U16+*psrc1+%3D+NULL%3B%0A++++U16+*psrc2+%3D+NULL%3B%0A++++U16+*psrc3+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A%0A++++psrc1+%3D+src%3B%0A++++psrc2+%3D+psrc1+%2B+width%3B%0A++++psrc3+%3D+psrc2+%2B+width%3B%0A++++pdst+%3D+dst+%2B+width%3B%0A%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++for+%28i+%3D+1%3B+i+%26lt%3B+width+-+1%3B+i%2B%2B%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++p0+%3D+psrc1%5Bi0%5D%3B%0A++++++++++++p1+%3D+psrc1%5Bi%5D%3B%0A++++++++++++p2+%3D+psrc1%5Bi2%5D%3B%0A++++++++++++p3+%3D+psrc2%5Bi0%5D%3B%0A++++++++++++p4+%3D+psrc2%5Bi%5D%3B%0A++++++++++++p5+%3D+psrc2%5Bi2%5D%3B%0A++++++++++++p6+%3D+psrc3%5Bi0%5D%3B%0A++++++++++++p7+%3D+psrc3%5Bi%5D%3B%0A++++++++++++p8+%3D+psrc3%5Bi2%5D%3B%0A%0A++++++++++++med_op%28p1%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p7%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p0%2C+p1%2C+tmp%29%3B%0A++++++++++++med_op%28p3%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p6%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p1%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p7%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p0%2C+p3%2C+tmp%29%3B%0A++++++++++++med_op%28p5%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p3%2C+p6%2C+tmp%29%3B%0A++++++++++++med_op%28p1%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p2%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p6%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p2%2C+tmp%29%3B%0A%0A++++++++++++pdst%5Bi%5D+%3D+p4%3B%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%0A++++memcpy%28pdst%2C+psrc2%2C+width+*+sizeof%28U16%29%29%3B%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+openmp%E8%A1%8C%E5%88%86%E5%9D%97%E7%9A%84%E5%8A%A0%E9%80%9F+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%2F%2F+median+omp%0Avoid+medianFilt%3A%3Amedian3_omp%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A++++S32+j+%3D+0%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A++++memcpy%28dst+%2B+width+*+height+-+width%2C+src+%2B+width+*+height+-+width%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23pragma+omp+parallel+for%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++U16+*psrc2+%3D+src+%2B+width+*+j%3B%0A++++++++U16+*pdst+%3D+dst+%2B+width+*+j%3B%0A++++++++U16+*psrc1+%3D+psrc2+-+width%3B%0A++++++++U16+*psrc3+%3D+psrc2+%2B+width%3B%0A%0A++++++++U16+p0+%3D+0%3B%0A++++++++U16+p1+%3D+0%3B%0A++++++++U16+p2+%3D+0%3B%0A++++++++U16+p3+%3D+0%3B%0A++++++++U16+p4+%3D+0%3B%0A++++++++U16+p5+%3D+0%3B%0A++++++++U16+p6+%3D+0%3B%0A++++++++U16+p7+%3D+0%3B%0A++++++++U16+p8+%3D+0%3B%0A++++++++U16+tmp+%3D+0%3B%0A%0A++++++++S32+i0+%3D+0%3B%0A++++++++S32+i+%3D+0%3B%0A++++++++S32+i2+%3D+0%3B%0A%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++for+%28i+%3D+1%3B+i+%26lt%3B+width+-+1%3B+i%2B%2B%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++p0+%3D+psrc1%5Bi0%5D%3B%0A++++++++++++p1+%3D+psrc1%5Bi%5D%3B%0A++++++++++++p2+%3D+psrc1%5Bi2%5D%3B%0A++++++++++++p3+%3D+psrc2%5Bi0%5D%3B%0A++++++++++++p4+%3D+psrc2%5Bi%5D%3B%0A++++++++++++p5+%3D+psrc2%5Bi2%5D%3B%0A++++++++++++p6+%3D+psrc3%5Bi0%5D%3B%0A++++++++++++p7+%3D+psrc3%5Bi%5D%3B%0A++++++++++++p8+%3D+psrc3%5Bi2%5D%3B%0A%0A++++++++++++med_op%28p1%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p7%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p0%2C+p1%2C+tmp%29%3B%0A++++++++++++med_op%28p3%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p6%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p1%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p7%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p0%2C+p3%2C+tmp%29%3B%0A++++++++++++med_op%28p5%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p3%2C+p6%2C+tmp%29%3B%0A++++++++++++med_op%28p1%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p2%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p6%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p2%2C+tmp%29%3B%0A%0A++++++++++++pdst%5Bi%5D+%3D+p4%3B%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A++++%7D%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E5%88%86%E5%9D%97%E7%89%88%E6%9C%AC%EF%BC%88%E8%8B%A5%E5%B9%B2%E8%A1%8C%E7%9A%84%E5%9D%97%E5%84%BF%EF%BC%89%EF%BC%8C%E5%90%8E%E9%9D%A2%E4%BC%9A%E8%A2%AB%E8%B0%83%E7%94%A8+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Estatic+void+median3_section%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A++++U16+p0+%3D+0%3B%0A++++U16+p1+%3D+0%3B%0A++++U16+p2+%3D+0%3B%0A++++U16+p3+%3D+0%3B%0A++++U16+p4+%3D+0%3B%0A++++U16+p5+%3D+0%3B%0A++++U16+p6+%3D+0%3B%0A++++U16+p7+%3D+0%3B%0A++++U16+p8+%3D+0%3B%0A++++U16+tmp+%3D+0%3B%0A%0A++++S32+i0+%3D+0%3B%0A++++S32+i+%3D+0%3B%0A++++S32+i2+%3D+0%3B%0A++++S32+j+%3D+0%3B%0A%0A++++U16+*psrc1+%3D+NULL%3B%0A++++U16+*psrc2+%3D+NULL%3B%0A++++U16+*psrc3+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++psrc1+%3D+src%3B%0A++++psrc2+%3D+psrc1+%2B+width%3B%0A++++psrc3+%3D+psrc2+%2B+width%3B%0A++++pdst+%3D+dst+%2B+width%3B%0A%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++for+%28i+%3D+1%3B+i+%26lt%3B+width+-+1%3B+i%2B%2B%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++p0+%3D+psrc1%5Bi0%5D%3B%0A++++++++++++p1+%3D+psrc1%5Bi%5D%3B%0A++++++++++++p2+%3D+psrc1%5Bi2%5D%3B%0A++++++++++++p3+%3D+psrc2%5Bi0%5D%3B%0A++++++++++++p4+%3D+psrc2%5Bi%5D%3B%0A++++++++++++p5+%3D+psrc2%5Bi2%5D%3B%0A++++++++++++p6+%3D+psrc3%5Bi0%5D%3B%0A++++++++++++p7+%3D+psrc3%5Bi%5D%3B%0A++++++++++++p8+%3D+psrc3%5Bi2%5D%3B%0A%0A++++++++++++med_op%28p1%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p7%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p0%2C+p1%2C+tmp%29%3B%0A++++++++++++med_op%28p3%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p6%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p1%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p7%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p0%2C+p3%2C+tmp%29%3B%0A++++++++++++med_op%28p5%2C+p8%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p3%2C+p6%2C+tmp%29%3B%0A++++++++++++med_op%28p1%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p2%2C+p5%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p7%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p2%2C+tmp%29%3B%0A++++++++++++med_op%28p6%2C+p4%2C+tmp%29%3B%0A++++++++++++med_op%28p4%2C+p2%2C+tmp%29%3B%0A%0A++++++++++++pdst%5Bi%5D+%3D+p4%3B%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E4%BD%BF%E7%94%A8%E5%88%86%E5%9B%9B%E5%9D%97%E7%9A%84openmp%E5%8A%A0%E9%80%9F+%EF%BC%88%E8%BF%99%E9%87%8C%E6%98%AF%E9%92%88%E5%AF%B9290%E5%88%97%E7%9A%84%E5%9B%BE%E5%83%8F%E5%86%99%E7%9A%84%E5%81%8F%E7%A7%BB72%E5%92%8C74%EF%BC%89+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Evoid+medianFilt%3A%3Amedian3_omp4%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A++++%2F%2F+++++const+S32+CPU_CORE_NUM+%3D+4%3B%0A%0A++++S32+j+%3D+0%3B%0A++++S32+offset+%3D+0%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A++++memcpy%28dst+%2B+width+*+height+-+width%2C+src+%2B+width+*+height+-+width%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23pragma+omp+parallel+for%0A++++for+%28j+%3D+0%3B+j+%26lt%3B+4%3B+j%2B%2B%29%0A++++%7B%0A++++++++offset+%3D+j+*+width+*+72%3B%0A++++++++median3_section%28src+%2B+offset%2C+dst+%2B+offset%2C+width%2C+74%29%3B%0A++++%7D%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E5%99%A8%E4%BD%BF%E7%94%A8std%3A%3Athread%E5%81%9A4%E7%BA%BF%E7%A8%8B%E5%8A%A0%E9%80%9F%EF%BC%88%E5%9B%9B%E5%9D%97%E5%84%BF%EF%BC%89%EF%BC%88%E8%BF%99%E9%87%8C%E6%98%AF%E9%92%88%E5%AF%B9290%E5%88%97%E7%9A%84%E5%9B%BE%E5%83%8F%E5%86%99%E7%9A%84%E5%81%8F%E7%A7%BB72%E5%92%8C74%EF%BC%89+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Evoid+medianFilt%3A%3Amedian3_4thd%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A%2F%2F+++++const+S32+CPU_CORE_NUM+%3D+4%3B%0A%0A++++S32+j+%3D+0%3B%0A++++S32+offset+%3D+0%3B%0A%0A++++U16+*psrc+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A++++memcpy%28dst+%2B+width+*+height+-+width%2C+src+%2B+width+*+height+-+width%2C+width+*+sizeof%28U16%29%29%3B%0A%0A++++psrc+%3D+src%3B%0A++++pdst+%3D+dst%3B%0A++++std%3A%3Athread+t1%28median3_section%2C+psrc%2C+pdst%2C+width%2C+74%29%3B%0A%0A++++offset+%3D+72+*+width%3B%0A++++psrc+%3D+src+%2B+offset%3B%0A++++pdst+%3D+dst+%2B+offset%3B%0A++++std%3A%3Athread+t2%28median3_section%2C+psrc%2C+pdst%2C+width%2C+74%29%3B%0A%0A++++offset+%3D+144+*+width%3B%0A++++psrc+%3D+src+%2B+offset%3B%0A++++pdst+%3D+dst+%2B+offset%3B%0A++++std%3A%3Athread+t3%28median3_section%2C+psrc%2C+pdst%2C+width%2C+74%29%3B%0A%0A++++offset+%3D+216+*+width%3B%0A++++psrc+%3D+src+%2B+offset%3B%0A++++pdst+%3D+dst+%2B+offset%3B%0A++++std%3A%3Athread+t4%28median3_section%2C+psrc%2C+pdst%2C+width%2C+74%29%3B%0A%0A++++t1.detach%28%29%3B%0A++++t2.detach%28%29%3B%0A++++t3.detach%28%29%3B%0A++++t4.join%28%29%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E4%BD%BF%E7%94%A8SSE%E5%8A%A0%E9%80%9F+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%2F%2F++median+SSE+version%0Avoid+medianFilt%3A%3Amedian3_sse%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A%23define+MED_VEC_SZ+8%0A%0A++++S32+i0+%3D+0%3B%0A++++S32+i+%3D+0%3B%0A++++S32+i2+%3D+0%3B%0A++++S32+j+%3D+0%3B%0A++++const+S32+xend+%3D+%28width+-+2%29+%25+MED_VEC_SZ+%2B+1%3B%0A%0A++++__m128i+v0%3B%0A++++__m128i+v1%3B%0A++++__m128i+v2%3B%0A++++__m128i+v3%3B%0A++++__m128i+v4%3B%0A++++__m128i+v5%3B%0A++++__m128i+v6%3B%0A++++__m128i+v7%3B%0A++++__m128i+v8%3B%0A++++__m128i+vtmp%3B%0A%0A++++U16+*psrc1+%3D+NULL%3B%0A++++U16+*psrc2+%3D+NULL%3B%0A++++U16+*psrc3+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A%0A++++psrc1+%3D+src%3B%0A++++psrc2+%3D+psrc1+%2B+width%3B%0A++++psrc3+%3D+psrc2+%2B+width%3B%0A++++pdst+%3D+dst+%2B+width%3B%0A%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++v0+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc1%29%29%3B%0A++++++++v1+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc1+%2B+1%29%29%3B%0A++++++++v2+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc1+%2B+2%29%29%3B%0A++++++++v3+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc2%29%29%3B%0A++++++++v4+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc2+%2B+1%29%29%3B%0A++++++++v5+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc2+%2B+2%29%29%3B%0A++++++++v6+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc3%29%29%3B%0A++++++++v7+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc3+%2B+1%29%29%3B%0A++++++++v8+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc3+%2B+2%29%29%3B%0A%0A++++++++med_op_sse%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_sse%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_sse%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_sse%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++med_op_sse%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_sse%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_sse%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_sse%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_sse%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_sse%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++med_op_sse%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_sse%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_sse%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++med_op_sse%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_sse%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_sse%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_sse%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_sse%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_sse%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++_mm_storeu_si128%28%28__m128i*%29%28pdst+%2B+1%29%2C+v4%29%3B%0A%0A++++++++for+%28i+%3D+xend%3B+i+%26lt%3B+width+-+1%3B+i+%2B%3D+MED_VEC_SZ%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++v0+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc1+%2B+i0%29%29%3B%0A++++++++++++v1+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc1+%2B+i%29%29%3B%0A++++++++++++v2+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc1+%2B+i2%29%29%3B%0A++++++++++++v3+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc2+%2B+i0%29%29%3B%0A++++++++++++v4+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc2+%2B+i%29%29%3B%0A++++++++++++v5+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc2+%2B+i2%29%29%3B%0A++++++++++++v6+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc3+%2B+i0%29%29%3B%0A++++++++++++v7+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc3+%2B+i%29%29%3B%0A++++++++++++v8+%3D+_mm_loadu_si128%28%28const+__m128i*%29%28psrc3+%2B+i2%29%29%3B%0A%0A++++++++++++med_op_sse%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_sse%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++++++_mm_storeu_si128%28%28__m128i*%29%28pdst+%2B+i%29%2C+v4%29%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%0A++++memcpy%28pdst%2C+psrc2%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23undef+MED_VEC_SZ%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E4%BD%BF%E7%94%A8AVX%E5%8A%A0%E9%80%9F%0A++%3Cbr%3E%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%2F%2F++median+AVX+version%0Avoid+medianFilt%3A%3Amedian3_avx%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A%23define+MED_VEC_SZ+16%0A%0A++++S32+i0+%3D+0%3B%0A++++S32+i+%3D+0%3B%0A++++S32+i2+%3D+0%3B%0A++++S32+j+%3D+0%3B%0A++++const+S32+xend+%3D+%28width+-+2%29+%25+MED_VEC_SZ+%2B+1%3B%0A%0A++++__m256i+v0%3B%0A++++__m256i+v1%3B%0A++++__m256i+v2%3B%0A++++__m256i+v3%3B%0A++++__m256i+v4%3B%0A++++__m256i+v5%3B%0A++++__m256i+v6%3B%0A++++__m256i+v7%3B%0A++++__m256i+v8%3B%0A++++__m256i+vtmp%3B%0A%0A++++U16+*psrc1+%3D+NULL%3B%0A++++U16+*psrc2+%3D+NULL%3B%0A++++U16+*psrc3+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A%0A++++psrc1+%3D+src%3B%0A++++psrc2+%3D+psrc1+%2B+width%3B%0A++++psrc3+%3D+psrc2+%2B+width%3B%0A++++pdst+%3D+dst+%2B+width%3B%0A%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++v0+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1%29%29%3B%0A++++++++v1+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+1%29%29%3B%0A++++++++v2+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+2%29%29%3B%0A++++++++v3+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2%29%29%3B%0A++++++++v4+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+1%29%29%3B%0A++++++++v5+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+2%29%29%3B%0A++++++++v6+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3%29%29%3B%0A++++++++v7+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+1%29%29%3B%0A++++++++v8+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+2%29%29%3B%0A%0A++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++med_op_avx%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++med_op_avx%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++med_op_avx%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++_mm256_storeu_si256%28%28__m256i*%29%28pdst+%2B+1%29%2C+v4%29%3B%0A%0A++++++++for+%28i+%3D+xend%3B+i+%26lt%3B+width+-+1%3B+i+%2B%3D+MED_VEC_SZ%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++v0+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i0%29%29%3B%0A++++++++++++v1+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i%29%29%3B%0A++++++++++++v2+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i2%29%29%3B%0A++++++++++++v3+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i0%29%29%3B%0A++++++++++++v4+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i%29%29%3B%0A++++++++++++v5+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i2%29%29%3B%0A++++++++++++v6+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i0%29%29%3B%0A++++++++++++v7+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i%29%29%3B%0A++++++++++++v8+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i2%29%29%3B%0A%0A++++++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++++++_mm256_storeu_si256%28%28__m256i*%29%28pdst+%2B+i%29%2C+v4%29%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%0A++++memcpy%28pdst%2C+psrc2%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23undef+MED_VEC_SZ%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E4%BD%BF%E7%94%A8AVX+%2B+%E5%88%86%E8%A1%8C%E7%9A%84openmp%E5%8A%A0%E9%80%9F%0A++%3Cbr%3E%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%2F%2F++median+AVX+omp+version%0Avoid+medianFilt%3A%3Amedian3_avx_omp%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A%23define+MED_VEC_SZ+16%0A%0A++++S32+j+%3D+0%3B%0A++++const+S32+xend+%3D+%28width+-+2%29+%25+MED_VEC_SZ+%2B+1%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A++++memcpy%28dst+%2B+width+*+height+-+width%2C+src+%2B+width+*+height+-+width%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23pragma+omp+parallel+for%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++U16+*psrc2+%3D+src+%2B+width+*+j%3B%0A++++++++U16+*pdst+%3D+dst+%2B+width+*+j%3B%0A++++++++U16+*psrc1+%3D+psrc2+-+width%3B%0A++++++++U16+*psrc3+%3D+psrc2+%2B+width%3B%0A%0A++++++++__m256i+v0%3B%0A++++++++__m256i+v1%3B%0A++++++++__m256i+v2%3B%0A++++++++__m256i+v3%3B%0A++++++++__m256i+v4%3B%0A++++++++__m256i+v5%3B%0A++++++++__m256i+v6%3B%0A++++++++__m256i+v7%3B%0A++++++++__m256i+v8%3B%0A++++++++__m256i+vtmp%3B%0A%0A++++++++S32+i0+%3D+0%3B%0A++++++++S32+i+%3D+0%3B%0A++++++++S32+i2+%3D+0%3B%0A%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++v0+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1%29%29%3B%0A++++++++v1+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+1%29%29%3B%0A++++++++v2+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+2%29%29%3B%0A++++++++v3+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2%29%29%3B%0A++++++++v4+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+1%29%29%3B%0A++++++++v5+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+2%29%29%3B%0A++++++++v6+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3%29%29%3B%0A++++++++v7+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+1%29%29%3B%0A++++++++v8+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+2%29%29%3B%0A%0A++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++med_op_avx%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++med_op_avx%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++med_op_avx%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++_mm256_storeu_si256%28%28__m256i*%29%28pdst+%2B+1%29%2C+v4%29%3B%0A%0A++++++++for+%28i+%3D+xend%3B+i+%26lt%3B+width+-+1%3B+i+%2B%3D+MED_VEC_SZ%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++v0+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i0%29%29%3B%0A++++++++++++v1+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i%29%29%3B%0A++++++++++++v2+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i2%29%29%3B%0A++++++++++++v3+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i0%29%29%3B%0A++++++++++++v4+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i%29%29%3B%0A++++++++++++v5+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i2%29%29%3B%0A++++++++++++v6+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i0%29%29%3B%0A++++++++++++v7+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i%29%29%3B%0A++++++++++++v8+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i2%29%29%3B%0A%0A++++++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++++++_mm256_storeu_si256%28%28__m256i*%29%28pdst+%2B+i%29%2C+v4%29%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%0A%23undef+MED_VEC_SZ%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E5%A4%9A%E8%A1%8C%E5%88%86%E5%9D%97%E7%9A%84AVX%E5%AE%9E%E7%8E%B0+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Estatic+void+median3_avx_section%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A%23define+MED_VEC_SZ+16%0A%0A++++S32+i0+%3D+0%3B%0A++++S32+i+%3D+0%3B%0A++++S32+i2+%3D+0%3B%0A++++S32+j+%3D+0%3B%0A++++const+S32+xend+%3D+%28width+-+2%29+%25+MED_VEC_SZ+%2B+1%3B%0A%0A++++__m256i+v0%3B%0A++++__m256i+v1%3B%0A++++__m256i+v2%3B%0A++++__m256i+v3%3B%0A++++__m256i+v4%3B%0A++++__m256i+v5%3B%0A++++__m256i+v6%3B%0A++++__m256i+v7%3B%0A++++__m256i+v8%3B%0A++++__m256i+vtmp%3B%0A%0A++++U16+*psrc1+%3D+NULL%3B%0A++++U16+*psrc2+%3D+NULL%3B%0A++++U16+*psrc3+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++psrc1+%3D+src%3B%0A++++psrc2+%3D+psrc1+%2B+width%3B%0A++++psrc3+%3D+psrc2+%2B+width%3B%0A++++pdst+%3D+dst+%2B+width%3B%0A%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++v0+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1%29%29%3B%0A++++++++v1+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+1%29%29%3B%0A++++++++v2+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+2%29%29%3B%0A++++++++v3+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2%29%29%3B%0A++++++++v4+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+1%29%29%3B%0A++++++++v5+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+2%29%29%3B%0A++++++++v6+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3%29%29%3B%0A++++++++v7+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+1%29%29%3B%0A++++++++v8+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+2%29%29%3B%0A%0A++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++med_op_avx%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++med_op_avx%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++med_op_avx%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_avx%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++_mm256_storeu_si256%28%28__m256i*%29%28pdst+%2B+1%29%2C+v4%29%3B%0A%0A++++++++for+%28i+%3D+xend%3B+i+%26lt%3B+width+-+1%3B+i+%2B%3D+MED_VEC_SZ%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++v0+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i0%29%29%3B%0A++++++++++++v1+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i%29%29%3B%0A++++++++++++v2+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc1+%2B+i2%29%29%3B%0A++++++++++++v3+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i0%29%29%3B%0A++++++++++++v4+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i%29%29%3B%0A++++++++++++v5+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc2+%2B+i2%29%29%3B%0A++++++++++++v6+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i0%29%29%3B%0A++++++++++++v7+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i%29%29%3B%0A++++++++++++v8+%3D+_mm256_loadu_si256%28%28const+__m256i*%29%28psrc3+%2B+i2%29%29%3B%0A%0A++++++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_avx%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++++++_mm256_storeu_si256%28%28__m256i*%29%28pdst+%2B+i%29%2C+v4%29%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%23undef+MED_VEC_SZ%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E+%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2AVX+%2B+%E5%88%86%E5%9B%9B%E5%9D%97openmp%E7%9A%84%E7%AE%97%E6%B3%95%E5%8A%A0%E9%80%9F%26nbsp%3B%EF%BC%88%E8%BF%99%E9%87%8C%E6%98%AF%E9%92%88%E5%AF%B9290%E5%88%97%E7%9A%84%E5%9B%BE%E5%83%8F%E5%86%99%E7%9A%84%E5%81%8F%E7%A7%BB72%E5%92%8C74%EF%BC%89+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Evoid+medianFilt%3A%3Amedian3_avx_omp4%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A++++%2F%2F+++++const+S32+CPU_CORE_NUM+%3D+4%3B%0A%0A++++S32+j+%3D+0%3B%0A++++S32+offset+%3D+0%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A++++memcpy%28dst+%2B+width+*+height+-+width%2C+src+%2B+width+*+height+-+width%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23pragma+omp+parallel+for%0A++++for+%28j+%3D+0%3B+j+%26lt%3B+4%3B+j%2B%2B%29%0A++++%7B%0A++++++++offset+%3D+j+*+width+*+72%3B%0A++++++++median3_avx_section%28src+%2B+offset%2C+dst+%2B+offset%2C+width%2C+74%29%3B%0A++++%7D%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%E4%BD%BF%E7%94%A8%E4%BA%86opencv%E8%AF%BB%E5%9B%BE%E5%B9%B6%E8%AE%A1%E7%AE%97%E6%97%B6%E9%97%B4%E6%B6%88%E8%80%97%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3Evoid+median1_testP%28%29%0A%7B%0A++++Mat+src%2C+dst_%2C+dst%2C+delta%3B%0A%0A++++src+%3D+imread%28%22D%3A%2Fd.pgm%22%2C+-1%29%3B%0A%0A++++medianBlur%28src%2C+dst%2C+3%29%3B%0A%0A++++dst_+%3D+src.clone%28%29%3B%0A%0A++++U16+*psrc+%3D+%28U16+*%29src.data%3B%0A++++U16+*pdst+%3D+%28U16+*%29dst_.data%3B%0A%0A++++double+t%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22%25.3fms%5Cn%22%2C+t%29%3B%0A++++%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_omp%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22omp+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_omp4%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22omp4+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_4thd%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%224thd+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_sse%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22sse+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_avx%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22avx+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_avx_omp%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22avx+omp+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++t+%3D+%28double%29getTickCount%28%29%3B%0A++++for+%28int+i+%3D+0%3B+i+%26lt%3B+CYC_NUM%3B+i%2B%2B%29%0A++++%7B%0A++++++++medianFilt%3A%3Amedian3_avx_omp4%28psrc%2C+pdst%2C+src.cols%2C+src.rows%29%3B%0A++++%7D%0A++++t+%3D+%28%28double%29getTickCount%28%29+-+t%29+*+1000+%2F+CYC_NUM+%2F+getTickFrequency%28%29%3B%0A++++printf%28%22avx+omp4+%25.3fms%5Cn%22%2C+t%29%3B%0A%0A++++Rect+roi%281%2C+1%2C+498%2C+288%29%3B%0A++++delta+%3D+%28dst_+-+dst%29%28roi%29%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E%0A++%3Cpre%3E%3Ccode+class%3D%22language-cpp%22%3E%23if+NEON_ENABLE%0A%2F%2F++median+NEON+version%0Avoid+medianFilt%3A%3Amedian3_neon%28U16+*src%2C+U16+*dst%2C+S32+width%2C+S32+height%29%0A%7B%0A%23define+MED_VEC_SZ+8%0A%0A++++S32+i0+%3D+0%3B%0A++++S32+i+%3D+0%3B%0A++++S32+i2+%3D+0%3B%0A++++S32+j+%3D+0%3B%0A++++const+S32+xend+%3D+%28width+-+2%29+%25+MED_VEC_SZ+%2B+1%3B%0A%0A++++uint16x8_t+v0%3B%0A++++uint16x8_t+v1%3B%0A++++uint16x8_t+v2%3B%0A++++uint16x8_t+v3%3B%0A++++uint16x8_t+v4%3B%0A++++uint16x8_t+v5%3B%0A++++uint16x8_t+v6%3B%0A++++uint16x8_t+v7%3B%0A++++uint16x8_t+v8%3B%0A++++uint16x8_t+vtmp%3B%0A%0A++++U16+*psrc1+%3D+NULL%3B%0A++++U16+*psrc2+%3D+NULL%3B%0A++++U16+*psrc3+%3D+NULL%3B%0A++++U16+*pdst+%3D+NULL%3B%0A%0A++++memcpy%28dst%2C+src%2C+width+*+sizeof%28U16%29%29%3B%0A%0A++++psrc1+%3D+src%3B%0A++++psrc2+%3D+psrc1+%2B+width%3B%0A++++psrc3+%3D+psrc2+%2B+width%3B%0A++++pdst+%3D+dst+%2B+width%3B%0A%0A++++for+%28j+%3D+1%3B+j+%26lt%3B+height+-+1%3B+j%2B%2B%29%0A++++%7B%0A++++++++pdst%5B0%5D+%3D+psrc2%5B0%5D%3B%0A%0A++++++++v0+%3D+vld1q_u16%28psrc1%29%3B%0A++++++++v1+%3D+vld1q_u16%28psrc1+%2B+1%29%3B%0A++++++++v2+%3D+vld1q_u16%28psrc1+%2B+2%29%3B%0A++++++++v3+%3D+vld1q_u16%28psrc2%29%3B%0A++++++++v4+%3D+vld1q_u16%28psrc2+%2B+1%29%3B%0A++++++++v5+%3D+vld1q_u16%28psrc2+%2B+2%29%3B%0A++++++++v6+%3D+vld1q_u16%28psrc3%29%3B%0A++++++++v7+%3D+vld1q_u16%28psrc3+%2B+1%29%3B%0A++++++++v8+%3D+vld1q_u16%28psrc3+%2B+2%29%3B%0A%0A++++++++med_op_neon%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_neon%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_neon%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_neon%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++med_op_neon%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_neon%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_neon%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_neon%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_neon%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_neon%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++med_op_neon%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++med_op_neon%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_neon%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++med_op_neon%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_neon%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++med_op_neon%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++med_op_neon%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++med_op_neon%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++med_op_neon%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++vst1q_u16%28%28pdst+%2B+1%29%2C+v4%29%3B%0A%0A++++++++for+%28i+%3D+xend%3B+i+%26lt%3B+width+-+1%3B+i+%2B%3D+MED_VEC_SZ%29%0A++++++++%7B%0A++++++++++++i0+%3D+i+-+1%3B%0A++++++++++++i2+%3D+i+%2B+1%3B%0A%0A++++++++++++v0+%3D+vld1q_u16%28psrc1+%2B+i0%29%3B%0A++++++++++++v1+%3D+vld1q_u16%28psrc1+%2B+i%29%3B%0A++++++++++++v2+%3D+vld1q_u16%28psrc1+%2B+i2%29%3B%0A++++++++++++v3+%3D+vld1q_u16%28psrc2+%2B+i0%29%3B%0A++++++++++++v4+%3D+vld1q_u16%28psrc2+%2B+i%29%3B%0A++++++++++++v5+%3D+vld1q_u16%28psrc2+%2B+i2%29%3B%0A++++++++++++v6+%3D+vld1q_u16%28psrc3+%2B+i0%29%3B%0A++++++++++++v7+%3D+vld1q_u16%28psrc3+%2B+i%29%3B%0A++++++++++++v8+%3D+vld1q_u16%28psrc3+%2B+i2%29%3B%0A%0A++++++++++++med_op_neon%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v0%2C+v1%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v3%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v6%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v1%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v4%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v7%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v0%2C+v3%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v5%2C+v8%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v3%2C+v6%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v1%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v2%2C+v5%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v4%2C+v7%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v4%2C+v2%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v6%2C+v4%2C+vtmp%29%3B%0A++++++++++++med_op_neon%28v4%2C+v2%2C+vtmp%29%3B%0A%0A++++++++++++vst1q_u16%28%28pdst+%2B+i%29%2C+v4%29%3B%0A++++++++%7D%0A%0A++++++++pdst%5Bi%5D+%3D+psrc2%5Bi%5D%3B%0A%0A++++++++psrc1+%2B%3D+width%3B%0A++++++++psrc2+%2B%3D+width%3B%0A++++++++psrc3+%2B%3D+width%3B%0A++++++++pdst+%2B%3D+width%3B%0A++++%7D%0A%0A++++memcpy%28pdst%2C+psrc2%2C+width+*+sizeof%28U16%29%29%3B%0A%0A%23undef+MED_VEC_SZ%0A%7D%0A%23endif%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%E7%8E%B0%E5%9C%A8%E4%BD%BF%E7%94%A8%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95%E9%80%9F%E5%BA%A6%EF%BC%88%E6%88%91%E7%9A%84%E5%B9%B3%E5%8F%B0%E6%98%AF4%E6%A0%B8CPU%EF%BC%89%3C%2Fp%3E+%0A++%3Cp%3E1+core+%3A+0.157ms%3Cbr%3E+omp+%3A+0.043ms%3Cbr%3E+omp+4+sections+%3A+0.043ms%3Cbr%3E+4threads+%3A+2.919ms%3Cbr%3E+sse+%3A+0.154ms%3Cbr%3E+avx+%3A+0.095ms%3Cbr%3E+avx+omp+%3A+0.026ms%3Cbr%3E+avx+omp+4+sections+%3A+0.028ms%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%E6%80%BB%E7%BB%93%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cstrong%3E1.1+%E5%BF%AB%E9%80%9F3X3%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E6%9C%AC%E8%BA%AB%E7%9A%84%E8%AE%A1%E7%AE%97%E6%98%AF%E5%85%83%E7%B4%A0%E6%AF%94%E8%BE%83%E5%92%8C%E6%8E%92%E5%BA%8F%EF%BC%8C%3C%2Fstrong%3E%3C%2Fspan%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%E5%B1%9E%E4%BA%8E%E6%8E%A7%E5%88%B6%E5%AF%86%E9%9B%86%E5%9E%8B%EF%BC%8C%E8%80%8C%E9%9D%9E%E8%BF%90%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B%3Cbr%3E%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%E6%89%80%E4%BB%A5%E5%B8%A6%E5%AE%BD%E7%9A%84%E8%80%97%E6%97%B6%E6%AF%94%E8%AE%A1%E7%AE%97%E7%9A%84%E8%80%97%E6%97%B6%E6%98%8E%E6%98%BE%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cstrong%3E%3Cspan+style%3D%22color%3A%23ff0000%3B%22%3E%3Cspan+style%3D%22color%3Argb%28255%2C0%2C0%29%3B%22%3E%3Cstrong%3E1.2+%E7%94%B1%E4%BA%8E%E7%AE%97%E6%B3%95%E9%9C%80%E8%A6%81%EF%BC%8C%E6%95%B0%E6%8D%AEIO%E4%BD%BF%E7%94%A8%E7%9A%84%E6%98%AFloadu%E5%92%8Cstoreu%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AFload%E5%92%8Cstore%E3%80%82%E8%AF%BB%E5%86%99%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E8%A6%81%E6%85%A2%E4%B8%80%E4%BA%9B%E3%80%82%3C%2Fstrong%3E%3C%2Fspan%3E%3Cbr%3E%3C%2Fspan%3E%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp%3E2.+%E5%8D%95%E6%A0%B8%E7%89%88%E6%9C%AC%E5%92%8CSSE%E5%8A%A0%E9%80%9F%E7%89%88%E6%9C%AC%E8%80%97%E6%97%B6%E5%87%A0%E4%B9%8E%E4%B8%80%E6%A0%B7%EF%BC%8C%E8%BF%99%E9%87%8C%E6%98%AF%E5%9B%A0%E4%B8%BAVS%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E4%BC%98%E5%8C%96%E4%BD%BF%E5%BE%97%E5%BF%AB%E9%80%9F3X3%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E9%80%9F%E5%BA%A6%E5%BE%88%E5%BF%AB%3C%2Fp%3E+%0A++%3Cp%3E%E8%AE%A1%E7%AE%97%E9%80%9F%E5%BA%A6%E7%93%B6%E9%A2%88%E4%B8%BB%E8%A6%81%E5%9C%A8%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%3C%2Fp%3E+%0A++%3Cp%3E3.+omp%E5%8A%A0%E9%80%9F%E7%89%88%E6%9C%AC%E7%9B%B8%E6%AF%94%E5%8D%95%E6%A0%B8%E7%9A%84%E5%BF%AB%E4%BA%863.65%E5%80%8D%EF%BC%8C%E6%8E%A5%E8%BF%914%E5%80%8D%EF%BC%8C%E5%92%8C%E5%9B%9B%E6%A0%B8%E5%8A%A0%E9%80%9F%E6%AF%94%E8%BE%83%E7%AC%A6%E5%90%88%3C%2Fp%3E+%0A++%3Cp%3E4.+omp%E5%88%86%E8%A1%8C%E5%8A%A0%E9%80%9F%E5%92%8C%E5%A4%9A%E8%A1%8C%E5%88%86%E5%9D%97%E5%8A%A0%E9%80%9F%E6%98%AF%E5%87%A0%E4%B9%8E%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%A7%81%E8%BF%99%E9%87%8C%E7%9A%84%E9%A2%9D%E5%A4%96%E5%BC%80%E9%94%80%E4%B8%8D%E5%A4%A7%3C%2Fp%3E+%0A++%3Cp%3E5.+avx%E5%8A%A0%E9%80%9F%E6%98%AFsse%E5%8A%A0%E9%80%9F%E7%9A%841.62%E5%80%8D%EF%BC%8C%E6%8E%A5%E8%BF%912%E5%80%8D%EF%BC%8C%E7%AC%A6%E5%90%88128%E4%BD%8D%E6%95%B0%E6%8D%AE%E5%92%8C256%E4%BD%8D%E6%95%B0%E6%8D%AE%E7%89%B9%E6%80%A7%3C%2Fp%3E+%0A++%3Cp%3E6.+SIMD+%2B+multiThread+%3A+%E8%BF%99%E9%87%8C%E6%B5%8B%E8%AF%95%E4%BA%86avx+%2B+omp%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+6.1+%E5%9C%A8avx%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%A2%9E%E5%8A%A0omp%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%A1%AE%E5%AE%9E%E8%83%BD%E5%A2%9E%E5%8A%A03.65%E5%80%8D%E9%80%9F%E5%BA%A6%EF%BC%8C%E6%8E%A5%E8%BF%914%E5%80%8D%EF%BC%8C%E5%92%8C%E5%9B%9B%E6%A0%B8%E5%8A%A0%E9%80%9F%E6%AF%94%E8%BE%83%E7%AC%A6%E5%90%88%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+6.2+avx+%2B+omp%E5%88%86%E8%A1%8C%E5%8A%A0%E9%80%9F%E5%92%8C%E5%A4%9A%E8%A1%8C%E5%88%86%E5%9D%97%E5%8A%A0%E9%80%9F%E6%98%AF%E5%87%A0%E4%B9%8E%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%A7%81%E8%BF%99%E9%87%8C%E7%9A%84%E9%A2%9D%E5%A4%96%E5%BC%80%E9%94%80%E4%B8%8D%E5%A4%A7%3C%2Fp%3E+%0A++%3Cp%3E7.+std%3A%3Athread%E7%9A%84%E9%A2%9D%E5%A4%96%E5%BC%80%E9%94%80%E5%A5%BD%E5%83%8F%E5%BE%88%E5%A4%A7%EF%BC%8C%E5%88%86%E5%9D%97%E5%B9%B6%E8%A1%8C%E5%8F%8D%E8%80%8C%E6%9B%B4%E6%85%A2%E4%BA%86%EF%BC%8C%E8%BF%9120%E5%80%8D%3C%2Fp%3E+%0A++%3Cp%3E8*+neon%E7%89%88%E6%9C%AC%E5%9C%A8%E6%96%87%E6%9C%AB%EF%BC%8C%E6%9A%82%E6%97%B6%E6%B2%A1%E6%9C%89%E6%B5%8B%E8%AF%95%E8%BF%87%3Cbr%3E%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fbillbliss%2Farticle%2Fdetails%2F78130939%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fbillbliss%2Farticle%2Fdetails%2F78130939%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}