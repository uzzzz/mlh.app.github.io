---
layout: default
title: 用gmp库实现rsa加密算法
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3E%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%EF%BC%9A%3Ca+href%3D%22https%3A%2F%2Fblog.csdn.net%2Fdbs1215%2Farticle%2Fdetails%2F48953589%22+rel%3D%22nofollow%22%3Ehttps%3A%2F%2Fblog.csdn.net%2Fdbs1215%2Farticle%2Fdetails%2F48953589%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3E%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A%3Ca+href%3D%22https%3A%2F%2Fblog.csdn.net%2Fqmickecs%2Farticle%2Fdetails%2F39676655%22+rel%3D%22nofollow%22%3Ehttps%3A%2F%2Fblog.csdn.net%2Fqmickecs%2Farticle%2Fdetails%2F39676655%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3E%E7%AE%97%E6%B3%95%E4%B8%BB%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84gmp%E5%87%BD%E6%95%B0%3C%2Fp%3E+%0A++%3Cp%3Empz_urandomb%28number%2Cgrt%2C1024%29+%2F%2F%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA0-2%5E1024%E7%9A%84%E4%B8%80%E4%B8%AA%E6%95%B0%3C%2Fp%3E+%0A++%3Cp%3Empz_nextprime%28prime_number%2Cnumber%29+%2F%2F%E4%BD%BF%E7%94%A8GMP%E8%87%AA%E5%B8%A6%E7%9A%84%E7%B4%A0%E6%95%B0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%3C%2Fp%3E+%0A++%3Cp%3Empz_mul%28mpz_t+op%2Cmpz_t+op1%2Cmpz_op2%29+%2F%2F%E5%A4%A7%E6%95%B0%E4%B9%98%E6%B3%95+op%3Dop1*op2%3C%2Fp%3E+%0A++%3Cp%3Empz_sub_ui%28mpz_t+op%2Cmpz_op2%2C1%29+%2F%2F%E5%A4%A7%E6%95%B0%E5%87%8F%E6%B3%95+op%3Dop2-1%3B%3C%2Fp%3E+%0A++%3Cp%3Empz_invert%28op1%2Cop2%2Cop3%29+%2F%2F%E6%B1%82%E9%80%86%E5%85%83%E5%87%BD%E6%95%B0%EF%BC%8C%E5%8D%B3%E6%95%B0%E8%AE%BA%E5%80%92%E6%95%B0+op1*op2+mod+op3%3D1%EF%BC%9B%3C%2Fp%3E+%0A++%3Cp%3Empz_powm%28op1%2Cop2%2Cop3%2Cop4%29+%2F%2F%E6%B1%82%E5%B9%82%E6%A8%A1%E5%87%BD%E6%95%B0+%E5%8D%B3op1%3Dop2%5Eop3%26nbsp%3B+mod+op4%3B%3C%2Fp%3E+%0A++%3Cp%3E%E7%AE%97%E6%B3%95%E5%88%86%E4%B8%BA%E8%BF%99%E5%87%A0%E6%AD%A5%E9%AA%A4%EF%BC%9A1%29+%E5%85%88%E7%94%A8%E7%B4%A0%E6%95%B0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%EF%BC%8C%E7%94%9F%E6%88%90%E4%B8%A4%E4%B8%AA%E5%A4%A7%E7%B4%A0%E6%95%B0p%E5%92%8Cq%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+2%29+%E8%AE%A1%E7%AE%97n%3Dp*q%2C+f%3D%28p-1%29*%28q-1%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+3%29+%E5%8F%96e%E7%9A%84%E5%80%BC%EF%BC%8C%E4%B8%80%E8%88%AC%E5%8F%9665537%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+4%EF%BC%89%E8%AE%A1%E7%AE%97d%E7%9A%84%E5%80%BC%EF%BC%8Ced%3D1+mod+n%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+5%29+%E5%8A%A0%E5%AF%86+C%3DM%5Ee+mod+n%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+6%29+%E8%A7%A3%E5%AF%86M%27%3DC%5Ed+mod+n%3C%2Fp%3E+%0A++%3Cp%3E%E7%AE%97%E6%B3%95%E4%BB%A3%E7%A0%81%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-cpp%22%3E%23include%26lt%3Bgmp.h%26gt%3B%0A%23include%26lt%3Btime.h%26gt%3B%0A%23include%26lt%3Bfstream%26gt%3B%0A%23include%26lt%3Bstring.h%26gt%3B%0A%23include%26lt%3Biostream%26gt%3B%0A%23include+%26lt%3Bcstdio%26gt%3B%0A%23include+%26lt%3Bctime%26gt%3B%0A%23include+%26lt%3Bcstring%26gt%3B%0A%23include+%26lt%3Bcstdlib%26gt%3B%0Ausing+namespace+std%3B%0A%0Aint+main%28%29%0A%7B%0A%09%2F%2F%E7%94%9F%E6%88%90%E5%A4%A7%E7%B4%A0%E6%95%B0%E7%AE%97%E6%B3%95%0A%09gmp_randstate_t+grt%3B%0A%09gmp_randinit_default%28grt%29%3B+%2F%2F%E8%AE%BE%E7%BD%AE%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95%E4%B8%BA%E9%BB%98%E8%AE%A4%0A%09gmp_randseed_ui%28grt%2C+time%28NULL%29%29%3B+%2F%2F%E8%AE%BE%E7%BD%AE%E9%9A%8F%E6%9C%BA%E5%8C%96%E7%A7%8D%E5%AD%90%E4%B8%BA%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%0A%0A%09mpz_t+key_p%2C+key_q%3B%0A%09mpz_init%28key_p%29%3B+%2F%2F%E5%88%9D%E5%A7%8B%E5%8C%96q%E5%92%8Cp%E5%A4%A7%E7%B4%A0%E6%95%B0%0A%09mpz_init%28key_q%29%3B%0A%0A%09mpz_urandomb%28key_p%2C+grt%2C+1024%29%3B%2F%2F%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA0-2%5E1024%E7%9A%84%E4%B8%80%E4%B8%AA%E6%95%B0%0A%09mpz_urandomb%28key_q%2C+grt%2C+1024%29%3B%0A%0A%0A%0A%09%2F%2Fmpz_t+key_pp%2C+key_qq%3B%0A%09mpz_nextprime%28key_p%2C+key_p%29%3B++%2F%2F%E4%BD%BF%E7%94%A8GMP%E8%87%AA%E5%B8%A6%E7%9A%84%E7%B4%A0%E6%95%B0%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%0A%09mpz_nextprime%28key_q%2C+key_q%29%3B%0A%09gmp_printf%28%22%25ZX%5Cn%5Cn%22%2C+key_p%29%3B%0A%09gmp_printf%28%22%25ZX%5Cn%5Cn%22%2C+key_q%29%3B%0A%0A%09%2F%2F%E8%AE%A1%E7%AE%97p*q%E7%9A%84%E5%80%BC%EF%BC%8C%E5%B9%B6%E5%AD%98%E6%94%BE%E5%9C%A8n%E4%B8%AD%0A%09mpz_t+key_n%3B%0A%09mpz_init%28key_n%29%3B%0A%09mpz_mul%28key_n%2C+key_p%2C+key_q%29%3B+%2F%2F%E8%AE%A1%E7%AE%97p*q%0A%0A%09%2F%2F%E8%AE%A1%E7%AE%97%28p-1%29*%28q-1%29%E5%B9%B6%E5%B0%86%E5%80%BC%E6%94%BE%E5%9C%A8key_f+%E4%B8%AD%0A%09mpz_t+key_f%3B%0A%09mpz_init%28key_f%29%3B%0A%09mpz_sub_ui%28key_p%2C+key_p%2C+1%29%3B%0A%09mpz_sub_ui%28key_q%2C+key_q%2C+1%29%3B%0A%09mpz_mul%28key_f%2C+key_p%2C+key_q%29%3B%0A%0A%09%2F%2F%E6%89%BE%E5%87%BA%E7%AC%A6%E5%90%88%E8%A6%81%E6%B1%82%E7%9A%84e%EF%BC%8C%E5%8D%B3%E5%85%AC%E9%92%A5%E4%B8%BA%28e%2Cn%29+e%E9%80%9A%E5%B8%B8%E5%8F%963%2C17%E5%92%8C65537%E4%B8%89%E4%B8%AA%E5%80%BC%EF%BC%8C%E6%88%91%E4%BB%AC%E7%9B%B4%E6%8E%A5%E5%8F%96e%3D65537%0A%09mpz_t+key_e%3B%0A%09mpz_init_set_ui%28key_e%2C+65537%29%3B%0A%0A%09%2F%2F%E8%BE%93%E5%87%BA%E5%85%AC%E9%92%A5%EF%BC%88e%2Cn%29%0A%09gmp_printf%28%22%25s+%28%25ZX%2C+%25ZX%29%5Cn%5Cn%5Cn%22%2C+%22public+key+is%3A%22%2C+key_n%2C+key_e%29%3B%0A%0A%09%2F%2F%E6%B1%82e%E7%9A%84%E9%80%86%E5%85%83%EF%BC%8C%E5%8D%B3ed+mod+%28f%29%3D1%3B%0A%09%2F%2F%E7%94%A8gmp%E8%87%AA%E5%B8%A6%E7%9A%84%E6%B1%82%E6%95%B0%E8%AE%BA%E9%80%86%E5%85%83%E5%87%BD%E6%95%B0%E5%AF%B9%E5%85%B6%E8%BF%9B%E8%A1%8C%E6%B1%82%E8%A7%A3%0A%09mpz_t+key_d%3B%0A%09mpz_init%28key_d%29%3B%0A%09mpz_invert%28key_d%2C+key_e%2C+key_f%29%3B%0A%09gmp_printf%28%22%25s+%28%25ZX%2C+%25ZX%29%5Cn%5Cn%5Cn%22%2C+%22private+key+is%3A%22%2C+key_d%2C+key_e%29%3B+%2F%2F%E8%BE%93%E5%87%BA%E7%A7%81%E9%92%A5%0A%0A%0A%09%2F%2F%E5%B0%86%E6%98%8E%E6%96%87m%E8%BF%9B%E8%A1%8C%E5%8A%A0%E5%AF%86+C%3Dm%5Ee+mod+n%0A%09mpz_t+M%2C+C%3B%0A%09mpz_init%28C%29%3B%0A%09mpz_init_set_ui%28M%2C+1234%29%3B%0A%09%2F%2Fmpz_get_str%28M%2C+16%2C+M%29%3B%0A%09mpz_powm%28C%2C+M%2C+key_e%2C+key_n%29%3B++%2F%2F%E4%BD%BF%E7%94%A8GMP%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%B9%82%E8%AE%A1%E7%AE%97%E5%87%BD%E6%95%B0+C%3DM%5Ee+mod+n%3B%0A%09gmp_printf%28%22%25s+%25ZX%5Cn%5Cn%22%2C+%22the+cipertxt+is%22%2C+C%29%3B%0A%0A%09%2F%2F%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0%E7%AE%97%E6%B3%95+M%3DC%5Ed+mod+n%0A%09mpz_t+M2%3B%0A%09%2F%2Fmpz_init_set_str%28C2%2CM2%2C16%29%3B%0A%09mpz_init%28M2%29%3B%0A%09mpz_powm%28M2%2C+C%2C+key_d%2C+key_n%29%3B+++%2F%2F%E4%BD%BF%E7%94%A8GMP%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%B9%82%E8%AE%A1%E7%AE%97%E5%87%BD%E6%95%B0+M%3DC%5Ed+mod+n%3B%0A%09gmp_printf%28%22%25s+%25ZX%5Cn%5Cn%22%2C%22the+M2+is%22%2C+M2%29%3B%0A%0A%09mpz_clear%28key_q%29%3B%0A%09mpz_clear%28key_p%29%3B%0A%09mpz_clear%28M%29%3B%0A%09mpz_clear%28C%29%3B%0A%09mpz_clear%28M2%29%3B%0A%09mpz_clear%28key_n%29%3B%0A%09mpz_clear%28key_f%29%3B%0A%09mpz_clear%28key_d%29%3B%0A%09return+0%3B%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E8%BF%90%E7%AE%97%E7%BB%93%E6%9E%9C%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode%3EA75752A2608271F3D462F2653BF934E71B66D14F31FAB99B17CC40B8CB6DD9F583D9D0CD50A0BB63B22C96252B68812255728453FCFD87BCB0AD5B3954C2D9569AC17701%0A%0A634D66DFF615277C68CB1FE7E60F051316B49577E6D0466B1449A2333AC642EB86408A5C6B0995D6ACFBD063A80BFD41EE38805BBCDC2E547083A94C11074BAC4C496D0969BCDB9BE9929B391DA94482F334320345B948C7B846718423937B778484477B74F86E62D732024C209265A4C0E2D3D84D3DC634F9CF12F1FF2DB767%0A%0Apublic+key+is%3A+%28D9DA45BB82CB8C8C54223423D2D59477FB04613E3A5D58D851E5CA3794B6165480480C1FFE5405C51BB104539CD3BE8AF302ED2078184A83C360C9FB7BAF2B3911676E97F1FF2703C9D0BD4AFD2755E64D44EEABDACD6D39F7391AAAC2495D87BE1487CEFC4D5E6D3502A833332C42F8E8D0A42F5D0BADC51277739B5DFAF6A266D53B1754EB1186A08041549070DA2E42D044EBB404EE2D788A2AD23399F1426C92DED43B5A4CC24BD51B8903D05B1C332C35C03A42AB8F5DB92C32343063B4E79586EBFBB256EBEA78D6DA7C691C7E8D699F9DEFDA0BA24F0F11217010500C4B411C73EE73B5FCDB25ABDCA849AB079ABA175584F9F3259705DF57A159867%2C+10001%29%0A%0A%0Aprivate+key+is%3A+%288681CE2C48458531DF807ED0DF8C1F6F34FD2F4D4C9BF60F1A01D7291A189310F9638298FE5EC27140F7BAC4254057955315AB7330B34ECEAC0346B28F5B4844A40A48AE682C31DA94F0DCEF3FFED97AA89AB70244C6317A68BA494CC548A706F8C59454A852DCCA70C08339998EEA8AE4B46DAB10B7F5428874585CC559FE887752B872EAE24EB8A96D2E13E50C473D105F944736E2BB37DEEAA826F56D552B08B596EC2F1F9F1F23995F9942CAC6D675C12163CEF81C6635728FDCF41D728B36A78612CB4CCF64E62622F3CFC4EED1F3098E6C6B96F1D95FFEBFE8265A2D9E6BF5D64CFC68A36129F55C1155B01B16FB1C22313AC983A42BBB55417D1A001%2C+10001%29%0A%0A%0Athe+cipertxt+is+956BE5472CCD11225BED957E0C8FFCD3961B330CB27E3646485E710371E270E5ECF0DC022733FDB8C6E7B80F513E1DCF52DA9A1DA306FC460D8B0BAEACCD3EA575383DFEEE7BA1148AC3EA4B0B3A28A003D29709C86FFBE585986476239D80962AFC7D3748B6365C6E20E7915E8F71B65B749355317CAA254111257BFE2056BD19AC515C28E56C02068F220630EE1ED7B897B7FE5B638BFB23F9BC93380C82CB1D08BD47F160C47D35576BA827BF634808731FE5399906DF9AD4961F3E147FC0346553C41B49C3909F311626548B423BAADF36F614066107673CB5D7BCF284807B5C571D67AB0FD42720D8966ED5847DC04714461F49A8A0F2960D5E7C5AEEC%0A%0Athe+M2+is+4D2%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%E5%8A%A0%E5%AF%86%E6%98%8E%E6%96%87%E6%98%AF1234+%E5%8C%96%E4%B8%BA16%E8%BF%9B%E5%88%B6%E5%B0%B1%E6%98%AF4D2%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fqq_40129237%2Farticle%2Fdetails%2F81286199%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fqq_40129237%2Farticle%2Fdetails%2F81286199%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}