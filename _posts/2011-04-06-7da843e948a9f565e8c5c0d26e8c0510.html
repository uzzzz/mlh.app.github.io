---
layout: default
title: 利用OpenSSL生成的私钥、公钥和证书，用来验证文件是否被修改
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3E%E7%A7%81%E9%92%A5%E6%A0%BC%E5%BC%8F%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3Ctextarea+cols%3D%2269%22+rows%3D%2215%22+name%3D%22code%22+class%3D%22c-sharp%22%3E-----BEGIN+RSA+PRIVATE+KEY-----%0AProc-Type%3A+4%2CENCRYPTED%0ADEK-Info%3A+DES-EDE3-CBC%2C9F1B06DE4A9C9270%0A%0ALIM0SMeBTPJ2%2B2Qgpk0hhowbEK%2BYwkPr1SdRpVFIEGe4c4rlUXbN%2FbyHuVGat3vA%0Atux730350dYKFjMWgg%2BmczjNkSgWHDnooGWHXGrs0nAd8nrP%2B39y0C%2BrG0VGu0k1%0ANsWwC%2Bd6cOJOZ4UP3H7CxY3hr2%2B0nAPC93hCpByrN%2FkADvoNoH%2BtUQH1JNIkLbLi%0AvujQS%2BExlhA84%2F0YlaskCffGDMA9tVRYzISTXxw7WXVEKvUkSqsEdvWiDPMev4z2%0AhP1oCo%2FTCZQb2i7Um6aI1be6Y86G82syfK0Gpk0Lar6febV8aeXXFJSGR2%2BHoVpB%0AuRDtDIPpk8kmW0UVJed7eO%2FuU5Y7nKbHD1xSigjI7JJd7d8imJ6FyM4ALlXFEdhl%0ADaIHZ91AXcV683LY%2FpoLCPG1wTJQOrFlEu2I93QWIkLBQdmIoN1KJG1nYkFOrla0%0AAzAbJqFOAK0XbDQI5JGbcyb6QQ03bdks91nG%2FGLW2Nh%2F3OA7DqnUt127mrZRPe8N%0A%2FLUT%2B1%2BiToYDXDQg8TMWtNwJySHVVd83vb4Pw5pQA%2BtsB4kM1p%2FS2ss8qD2fLh6V%0A9yG7Wrpdm5tT%2F3xRZGw%2FIoLS34iEoIk0Jy5WgFsPcWamVrJzoBhYKiyxZ%2Fx2n3dX%0AqlatSgDDcQVlpSW44uVORpYj0PKgY7v6J3qsN%2Fx%2B%2F4VBQ3v4Bbfm50m8BvfqR%2BMs%0AakQ%2B42jLks%2FjUXPXbnSBDVGQIkr6VgCl%2BbAtv01SAjCLoxYf1UQMZHSMUv2ATeZO%0AbMRonj54wkm8T7ZairSq44KvRUeo%2BeMLjrqjW%2FbnCiY29QI%2FGFOK1Q%3D%3D%0A-----END+RSA+PRIVATE+KEY-----%0A%3C%2Ftextarea%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%E8%AF%81%E4%B9%A6%E4%B8%AD%E5%8C%85%E5%90%AB%E4%BA%86%E5%85%AC%E9%92%A5%EF%BC%8C%E5%9C%A8BEGIN+CERTIFICATE%E5%92%8CEND+CERTIFICATE%E4%B9%8B%E9%97%B4%EF%BC%8C%E9%80%9A%E5%B8%B8%E6%83%85%E5%86%B5%E4%B8%8B%E6%98%AF%E6%8A%8A%E8%AF%81%E4%B9%A6%E4%B8%AD%E7%9A%84%E5%85%AC%E9%92%A5%E6%8F%90%E5%8F%96%E5%87%BA%E6%9D%A5%E8%A7%A3%E5%AF%86%EF%BC%8C%E5%85%B6%E6%A0%BC%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3Ctextarea+cols%3D%2270%22+rows%3D%2215%22+name%3D%22code%22+class%3D%22c-sharp%22%3ECertificate%3A%0A++++Data%3A%0A++++++++Version%3A+1+%280x0%29%0A++++++++Serial+Number%3A+2+%280x2%29%0A++++++++Signature+Algorithm%3A+md5WithRSAEncryption%0A++++++++Issuer%3A+C%3Dca%2C+ST%3Dcaspn%2C+L%3Dcaln%2C+O%3Dcaon%2C+OU%3Dcaoun%2C+CN%3Dcacn%2FemailAddress%3Dcaea%0A++++++++Validity%0A++++++++++++Not+Before%3A+May++8+01%3A22%3A20+2007+GMT%0A++++++++++++Not+After+%3A+May++7+01%3A22%3A20+2008+GMT%0A++++++++Subject%3A+C%3Dcn%2C+ST%3Dserversp%2C+L%3Dserverln%2C+O%3Dserveron%2C+OU%3Dserveroun%2C+CN%3Dservercn%2FemailAddress%3Dserverea%0A++++++++Subject+Public+Key+Info%3A%0A++++++++++++Public+Key+Algorithm%3A+rsaEncryption%0A++++++++++++RSA+Public+Key%3A+%281024+bit%29%0A++++++++++++++++Modulus+%281024+bit%29%3A%0A++++++++++++++++++++00%3Ab7%3Ae4%3Ae1%3Ad3%3A04%3Aaa%3Ad0%3A24%3A7b%3A94%3Aab%3A7b%3A78%3A2a%3A%0A++++++++++++++++++++bf%3A78%3A9f%3Af4%3A18%3Aaa%3A81%3Abc%3Ac7%3Acb%3A23%3Ae2%3A59%3A26%3Ad1%3A%0A++++++++++++++++++++8e%3A84%3A04%3A44%3Ab5%3Abb%3A31%3A34%3A5b%3A93%3A48%3A35%3Af8%3Ac1%3Aa4%3A%0A++++++++++++++++++++0a%3A17%3A24%3A41%3Ae5%3A76%3Abe%3A91%3A74%3Ac1%3A31%3A03%3A14%3Ab4%3A3b%3A%0A++++++++++++++++++++f4%3Aad%3Ad2%3Af9%3Ade%3A3c%3Af1%3A42%3A80%3A73%3A99%3A86%3A63%3A8a%3Aac%3A%0A++++++++++++++++++++99%3Ad7%3Acc%3Af0%3Aa8%3Aeb%3A61%3A09%3A42%3A65%3A0a%3A01%3Acf%3Aba%3A0c%3A%0A++++++++++++++++++++69%3A26%3A5b%3A66%3A34%3Af2%3Af7%3A28%3A20%3A7a%3Ad2%3A08%3Ad5%3Abe%3A1d%3A%0A++++++++++++++++++++1e%3A65%3Ac5%3A11%3A4b%3A52%3Aed%3Aac%3Af2%3Ac9%3A35%3A79%3A9d%3A6b%3A38%3A%0A++++++++++++++++++++ca%3A81%3Ad2%3Aec%3Ad9%3A02%3A03%3A0e%3Ad1%0A++++++++++++++++Exponent%3A+65537+%280x10001%29%0A++++Signature+Algorithm%3A+md5WithRSAEncryption%0A++++++++7a%3A9b%3Ab2%3Ad1%3A14%3A18%3Ac1%3A5e%3Ae7%3A1b%3A8e%3A70%3A27%3A9a%3A4d%3A87%3A6d%3A1e%3A%0A++++++++fd%3Ae6%3Abb%3A28%3Af5%3A0c%3Ac5%3A2c%3Ab6%3A38%3A75%3A0d%3A31%3A4c%3Af4%3A9b%3A1e%3Af5%3A%0A++++++++9f%3A23%3A09%3A5e%3Aa3%3A00%3A37%3A8f%3Aaf%3A56%3Ac1%3Aa5%3A0e%3Aa6%3A8a%3A46%3A6f%3A18%3A%0A++++++++0d%3A8d%3Abc%3A49%3Ad5%3A11%3A9f%3A6a%3A77%3A9b%3A2e%3A18%3A89%3A12%3A66%3Ad9%3A21%3A01%3A%0A++++++++4f%3A86%3Aa2%3Ade%3Acb%3A6b%3Ac3%3Afe%3A39%3Aa9%3Abe%3Af3%3A5d%3A06%3Ab3%3A87%3A93%3Aab%3A%0A++++++++5b%3Aa9%3A14%3Ab9%3A8d%3A91%3A06%3A43%3Ab3%3A8c%3A0d%3Af2%3A72%3A35%3Af8%3A88%3A37%3Ac7%3A%0A++++++++cf%3Aac%3A7b%3A21%3Aa5%3A19%3Aa9%3Ae9%3Ab0%3A2c%3A2d%3A26%3A9d%3A3d%3A19%3A4d%3Aec%3A94%3A%0A++++++++f4%3A66%0A-----BEGIN+CERTIFICATE-----%0AMIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV%0ABAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL%0AEwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w%0ANzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G%0AA1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2%0AZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG%0ACSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB%0AALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1%2BMGkChck%0AQeV2vpF0wTEDFLQ79K3S%2Bd488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy%0A9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN%0AAQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e%2Fea7KPUMxSy2OHUNMUz0mx71nyMJ%0AXqMAN4%2BvVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw%2F45qb7zXQaz%0Ah5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY%3D%0A-----END+CERTIFICATE-----%0A%3C%2Ftextarea%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%E9%AA%8C%E8%AF%81%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E8%A2%AB%E4%BF%AE%E6%94%B9%E7%9A%84%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3Ctextarea+cols%3D%2269%22+rows%3D%2215%22+name%3D%22code%22+class%3D%22c-sharp%22%3Econst++char+*certbuf%3D%22Certificate%3A+%2F%0A++++Data%3A+%2F%0A++++++++Version%3A+1+%280x0%29+%2F%0A++++++++Serial+Number%3A+2+%280x2%29+%2F%0A++++++++Signature+Algorithm%3A+md5WithRSAEncryption+%2F%0A++++++++Issuer%3A+C%3Dca%2C+ST%3Dcaspn%2C+L%3Dcaln%2C+O%3Dcaon%2C+OU%3Dcaoun%2C+CN%3Dcacn%2FemailAddress%3Dcaea+%2F%0A++++++++Validity+%2F%0A++++++++++++Not+Before%3A+May++8+01%3A22%3A20+2007+GMT+%2F%0A++++++++++++Not+After+%3A+May++7+01%3A22%3A20+2008+GMT+%2F%0A++++++++Subject%3A+C%3Dcn%2C+ST%3Dserversp%2C+L%3Dserverln%2C+O%3Dserveron%2C+OU%3Dserveroun%2C+CN%3Dservercn%2FemailAddress%3Dserverea+%2F%0A++++++++Subject+Public+Key+Info%3A+%2F%0A++++++++++++Public+Key+Algorithm%3A+rsaEncryption+%2F%0A++++++++++++RSA+Public+Key%3A+%281024+bit%29+%2F%0A++++++++++++++++Modulus+%281024+bit%29%3A+%2F%0A++++++++++++++++++++00%3Ab7%3Ae4%3Ae1%3Ad3%3A04%3Aaa%3Ad0%3A24%3A7b%3A94%3Aab%3A7b%3A78%3A2a%3A+%2F%0A++++++++++++++++++++bf%3A78%3A9f%3Af4%3A18%3Aaa%3A81%3Abc%3Ac7%3Acb%3A23%3Ae2%3A59%3A26%3Ad1%3A+%2F%0A++++++++++++++++++++8e%3A84%3A04%3A44%3Ab5%3Abb%3A31%3A34%3A5b%3A93%3A48%3A35%3Af8%3Ac1%3Aa4%3A+%2F%0A++++++++++++++++++++0a%3A17%3A24%3A41%3Ae5%3A76%3Abe%3A91%3A74%3Ac1%3A31%3A03%3A14%3Ab4%3A3b%3A+%2F%0A++++++++++++++++++++f4%3Aad%3Ad2%3Af9%3Ade%3A3c%3Af1%3A42%3A80%3A73%3A99%3A86%3A63%3A8a%3Aac%3A+%2F%0A++++++++++++++++++++99%3Ad7%3Acc%3Af0%3Aa8%3Aeb%3A61%3A09%3A42%3A65%3A0a%3A01%3Acf%3Aba%3A0c%3A+%2F%0A++++++++++++++++++++69%3A26%3A5b%3A66%3A34%3Af2%3Af7%3A28%3A20%3A7a%3Ad2%3A08%3Ad5%3Abe%3A1d%3A+%2F%0A++++++++++++++++++++1e%3A65%3Ac5%3A11%3A4b%3A52%3Aed%3Aac%3Af2%3Ac9%3A35%3A79%3A9d%3A6b%3A38%3A+%2F%0A++++++++++++++++++++ca%3A81%3Ad2%3Aec%3Ad9%3A02%3A03%3A0e%3Ad1+%2F%0A++++++++++++++++Exponent%3A+65537+%280x10001%29+%2F%0A++++Signature+Algorithm%3A+md5WithRSAEncryption+%2F%0A++++++++7a%3A9b%3Ab2%3Ad1%3A14%3A18%3Ac1%3A5e%3Ae7%3A1b%3A8e%3A70%3A27%3A9a%3A4d%3A87%3A6d%3A1e%3A+%2F%0A++++++++fd%3Ae6%3Abb%3A28%3Af5%3A0c%3Ac5%3A2c%3Ab6%3A38%3A75%3A0d%3A31%3A4c%3Af4%3A9b%3A1e%3Af5%3A+%2F%0A++++++++9f%3A23%3A09%3A5e%3Aa3%3A00%3A37%3A8f%3Aaf%3A56%3Ac1%3Aa5%3A0e%3Aa6%3A8a%3A46%3A6f%3A18%3A+%2F%0A++++++++0d%3A8d%3Abc%3A49%3Ad5%3A11%3A9f%3A6a%3A77%3A9b%3A2e%3A18%3A89%3A12%3A66%3Ad9%3A21%3A01%3A+%2F%0A++++++++4f%3A86%3Aa2%3Ade%3Acb%3A6b%3Ac3%3Afe%3A39%3Aa9%3Abe%3Af3%3A5d%3A06%3Ab3%3A87%3A93%3Aab%3A+%2F%0A++++++++5b%3Aa9%3A14%3Ab9%3A8d%3A91%3A06%3A43%3Ab3%3A8c%3A0d%3Af2%3A72%3A35%3Af8%3A88%3A37%3Ac7%3A+%2F%0A++++++++cf%3Aac%3A7b%3A21%3Aa5%3A19%3Aa9%3Ae9%3Ab0%3A2c%3A2d%3A26%3A9d%3A3d%3A19%3A4d%3Aec%3A94%3A+%2F%0A++++++++f4%3A66+%2F%0A-----BEGIN+CERTIFICATE-----+%2F%0AMIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV+%2F%0ABAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL+%2F%0AEwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w+%2F%0ANzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G+%2F%0AA1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2+%2F%0AZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG+%2F%0ACSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB+%2F%0AALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1%2BMGkChck+%2F%0AQeV2vpF0wTEDFLQ79K3S%2Bd488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy+%2F%0A9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN+%2F%0AAQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e%2Fea7KPUMxSy2OHUNMUz0mx71nyMJ+%2F%0AXqMAN4%2BvVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw%2F45qb7zXQaz+%2F%0Ah5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY%3D+%2F%0A-----END+CERTIFICATE-----%22%3B%0A%0A%0A%23define+RSA_ENC_SIZE++128%0A%23define+KERNEL_SIZE++2*1024*1024%0A%0Aint+verify%28const+unsigned+char+*buf%2Cchar+*signature%29%0A%7B%0A%0A%09uart_init%28%29%3B%0A%09puts%28%22signature+is%2Fn%22%29%3B%0A%09int+j%3B%0A%09for%28j%3D0%3Bj%26lt%3BRSA_ENC_SIZE%3Bj%2B%2B%29%0A%09%09puthex%28signature%5Bj%5D%29%3B%0A%09puts%28%22%2Fn%22%29%3B%0A+++++++sslRsaKey_t+*pubkey%3DNULL%3B%0A+++++++if%28X509ReadPubKey%28certbuf%2C%26amp%3Bpubkey%29%3D%3D-1%29%0A%09%7B%0A%09%09puts%28%22read+pubkey+error%2Fn%22%29%3B%0A%09%09if%28pubkey%29%0A%09%09matrixRsaFreeKey%28pubkey%29%3B%0A%09%09return+-1%3B%0A%09%7D%0A++%0A%09char+kernelhash%5BSHA1_HASH_SIZE%5D%3D%7B0%7D%3B%0A%09matrixRsaDecryptPub%280%2C+pubkey%2C+signature%2CRSA_ENC_SIZE%2Ckernelhash%2C+SHA1_HASH_SIZE%29%3B%0A%09if%28pubkey%29%0A%09%09matrixRsaFreeKey%28pubkey%29%3B%0A%0A%09%0A%09puts%28%22pre_hash%3A%2Fn%22%29%3B%0A%09int+ii%3B%0A%09for%28ii%3D0%3Bii%26lt%3BSHA1_HASH_SIZE%3Bii%2B%2B%29%0A%09%09%7B%0A%09%09puthex%28kernelhash%5Bii%5D%29%3B%0A%09%09%7D%0A%09puts%28%22%2Fn%22%29%3B%0A%0A%09unsigned+char+tmp%5BSHA1_HASH_SIZE%5D%3B%0A%09hash_state+md%3B%0A%09matrixSha1Init%28%26amp%3Bmd%29%3B%0A%09matrixSha1Update%28%26amp%3Bmd%2Cbuf%2CKERNEL_SIZE%29%3B%0A%09matrixSha1Final%28%26amp%3Bmd%2C+tmp%29%3B%0A%0A%09puts%28%22kenel+hash%3A%2Fn%22%29%3B%0A%09for%28ii%3D0%3Bii%26lt%3BSHA1_HASH_SIZE%3Bii%2B%2B%29%0A%09%09puthex%28tmp%5Bii%5D%29%3B%0A%09puts%28%22%2Fn%22%29%3B%0A%09return+memcmp%28tmp%2Ckernelhash%2CSHA1_HASH_SIZE%29%3B%0A%09%09%09%0A%7D%0A%0A%3C%2Ftextarea%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fmoruite%2Farticle%2Fdetails%2F6305748%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fmoruite%2Farticle%2Fdetails%2F6305748%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}