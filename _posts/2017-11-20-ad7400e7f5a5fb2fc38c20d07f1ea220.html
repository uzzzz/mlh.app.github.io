---
layout: default
title: 以太坊ETH代币开发教程源码学习笔记
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22article-copyright%22%3E%0A+++%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%EF%BC%9A%E6%9C%AC%E6%96%87%E4%B8%BA%E5%8D%9A%E4%B8%BB%E5%8E%9F%E5%88%9B%E6%96%87%E7%AB%A0%EF%BC%8C%E6%9C%AA%E7%BB%8F%E5%8D%9A%E4%B8%BB%E5%85%81%E8%AE%B8%E4%B8%8D%E5%BE%97%E8%BD%AC%E8%BD%BD%E3%80%82+https%3A%2F%2Fblog.csdn.net%2FjQQ53016353%2Farticle%2Fdetails%2F78580207+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e4c7a3727d.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3E%E5%89%8D%E8%A8%80%3C%2Fp%3E+%0A++%3Cp%3E%3Cspan+style%3D%22color%3Argb%28102%2C102%2C102%29%3Bfont-family%3AArial%3Bfont-size%3A14px%3Bline-height%3A24px%3Btext-indent%3A28px%3B%22%3E%E5%8C%BA%E5%9D%97%E9%93%BE%E7%88%B1%E5%A5%BD%E8%80%85%EF%BC%88QQ%EF%BC%9A53016353%EF%BC%89%3C%2Fspan%3E%3Cbr%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E%3C%2Fp%3E+%E4%BB%8E%E4%BA%8B%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E5%BC%80%E5%8F%91%EF%BC%8C%E4%B8%8D%E4%BA%86%E8%A7%A3%E5%85%B6%E5%BA%95%E5%B1%82%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E6%98%AF%E4%B8%8D%E5%A4%9F%E7%9A%84%E3%80%82%E8%AE%B8%E5%A4%9A%E4%BA%BA%E5%9C%A8%E7%9C%8B%E4%BA%86%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E7%99%BD%E7%9A%AE%E4%B9%A6%E4%B9%8B%E5%90%8E%E4%BB%8D%E7%84%B6%E4%B8%8D%E6%B8%85%E6%A5%9A%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E6%98%AF%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E7%9A%84%E6%BA%90%E7%A0%81%E8%AE%BE%E8%AE%A1%E7%B2%BE%E5%B7%A7%EF%BC%8C%E6%9C%89%E8%AE%B8%E5%A4%9A%E8%AE%BE%E8%AE%A1%E7%99%BD%E7%9A%AE%E4%B9%A6%E6%9C%AA%E6%9B%BE%E6%8F%90%E5%8F%8A%EF%BC%8C%E5%8A%A0%E4%B8%8A%E6%9C%AC%E8%BA%AB%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E7%9A%84%E6%96%87%E6%A1%A3%E7%A8%80%E5%B0%91%EF%BC%8C%E5%8A%A0%E5%A4%A7%E4%BA%86%E6%96%B0%E6%89%8B%E7%90%86%E8%A7%A3%E7%9A%84%E5%9B%B0%E9%9A%BE%E7%A8%8B%E5%BA%A6%E3%80%82%E5%B0%BD%E7%AE%A1%E7%8E%B0%E5%9C%A8%E5%B7%B2%E7%BB%8F%E6%9C%89%E8%AE%B8%E5%A4%9A%E4%BB%8B%E7%BB%8D%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E4%B9%A6%E5%92%8C%E6%96%87%E7%AB%A0%EF%BC%8C%E5%8D%B4%E5%BE%88%E5%B0%91%E6%98%AF%E4%BB%8E%E6%BA%90%E7%A0%81%E7%9D%80%E6%89%8B%E5%88%86%E6%9E%90%E7%9A%84%E3%80%82%E6%88%91%E9%80%9A%E8%BF%87%E5%8D%8A%E5%B9%B4%E6%97%B6%E9%97%B4%E5%AF%B9%E4%BA%8E%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%8C%E5%BC%80%E5%A7%8B%E6%92%B0%E5%86%99%E4%B8%80%E4%BB%BD%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E6%BA%90%E7%A0%81%E7%9A%84%E6%95%99%E7%A8%8B%E3%80%82%E6%9C%AC%E6%95%99%E7%A8%8B%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%EF%BC%8C%E9%80%9A%E8%BF%87%E5%88%86%E6%9E%90%E6%9C%80%E7%BB%8F%E5%85%B8%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E2%80%94%E2%80%94%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E7%9A%84C%2B%2B%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%BA%90%E7%A0%81%EF%BC%8C%E8%AE%A9%E5%BC%80%E5%8F%91%E8%80%85%E7%94%A8%E6%9C%80%E7%9F%AD%E7%9A%84%E6%97%B6%E9%97%B4%E4%B8%8A%E6%89%8B%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E3%80%82%E4%BA%86%E8%A7%A3%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E6%BA%90%E7%A0%81%E5%8F%AF%E5%B8%AE%E5%8A%A9%E5%BC%80%E5%8F%91%E8%80%85%E6%9B%B4%E5%A5%BD%E4%BA%86%E8%A7%A3%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%B9%B6%E5%9C%A8%E5%BA%94%E7%94%A8%E5%BD%93%E4%B8%AD%E6%A0%B9%E6%8D%AE%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E5%81%9A%E5%87%BA%E4%BF%AE%E6%94%B9%E5%92%8C%E8%B0%83%E6%95%B4%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%9C%AC%E6%96%87%E6%89%80%E5%BC%95%E7%94%A8%E7%9A%84%E6%BA%90%E7%A0%81%E5%9D%87%E6%9D%A5%E8%87%AA%E5%8E%9F%E5%A7%8B%E7%89%88%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%8C%E5%8D%B3%E7%94%B1%E4%B8%AD%E6%9C%AC%E8%81%AA%E5%8F%91%E5%B8%83%E7%9A%84%E7%AC%AC%E4%B8%80%E7%89%88%E6%BA%90%E7%A0%81%E3%80%82%E8%AF%A5%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8C%85%E6%8B%AC%E5%A4%A7%E7%BA%A616000%E8%A1%8C%E4%BB%A3%E7%A0%81%E3%80%82%E5%B0%BD%E7%AE%A1%E7%BB%8F%E8%BF%87%E6%95%B0%E5%B9%B4%E7%9A%84%E5%8F%91%E5%B1%95%EF%BC%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BB%8F%E8%BF%87%E4%BA%86%E5%87%A0%E6%AC%A1%E8%BE%83%E5%A4%A7%E6%9B%B4%E6%96%B0%EF%BC%8C%E5%85%B6%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E5%8E%9F%E7%90%86%E4%BB%8E%E8%AF%9E%E7%94%9F%E4%B9%8B%E6%97%A5%E8%B5%B7%E4%B8%80%E7%9B%B4%E5%BB%B6%E7%BB%AD%E8%87%B3%E4%BB%8A%E3%80%82%E6%9C%AC%E6%96%87%E4%BC%9A%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BF%9D%E8%AF%81%E6%96%87%E5%AD%97%E7%9A%84%E4%B8%A5%E8%B0%A8%E5%87%86%E7%A1%AE%EF%BC%8C%E8%A1%A8%E8%BE%BE%E5%BD%93%E4%B8%AD%E9%9A%BE%E5%85%8D%E4%BC%9A%E4%BA%A7%E7%94%9F%E7%96%8F%E6%BC%8F%EF%BC%8C%E6%AC%A2%E8%BF%8E%E6%8C%87%E6%AD%A3%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bitcoin-code%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%80%E7%AB%A0%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%9C%AC%E7%AB%A0%E8%8A%82%E8%AE%B2%E8%BF%B0%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%98%AF%E6%80%8E%E6%A0%B7%E7%94%9F%E6%88%90%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%B9%B6%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%88%91%E4%BB%AC%E6%9D%A5%E7%9C%8B%E4%B8%80%E4%B8%8BGenerateNewKey%28%29%E6%96%B9%E6%B3%95%EF%BC%8C%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Emain.cpp%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bool+AddKey%28const+CKey%26amp%3B+key%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CRITICAL_BLOCK%28cs_mapKeys%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+mapKeys%5Bkey.GetPubKey%28%29%5D+%3D+key.GetPrivKey%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+mapPubKeys%5BHash160%28key.GetPubKey%28%29%29%5D+%3D+key.GetPubKey%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+CWalletDB%28%29.WriteKey%28key.GetPubKey%28%29%2C+key.GetPrivKey%28%29%29%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+vector%26lt%3Bunsigned+char%26gt%3B+GenerateNewKey%28%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CKey+key%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+key.MakeNewKey%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28%21AddKey%28key%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+throw+runtime_error%28%22GenerateNewKey%28%29+%3A+AddKey+failed%5Cn%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+key.GetPubKey%28%29%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E6%AD%A5%E9%AA%A4%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%85%AC%E9%92%A5%E5%AF%B9%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E9%A6%96%E5%85%88%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84CKey%E7%B1%BB%E5%9E%8B%E5%AF%B9%E8%B1%A1%EF%BC%88%E7%AC%AC13%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E8%B0%83%E7%94%A8addKey%28%29%E6%96%B9%E6%B3%95%E5%B0%86%E6%96%B0%E5%BB%BA%E7%9A%84key%E6%B7%BB%E5%8A%A0%E8%87%B31%EF%BC%89%E5%85%A8%E5%B1%80%E6%98%A0%E5%B0%84mapKeys+%EF%BC%88%E7%AC%AC5%E8%A1%8C%EF%BC%892%EF%BC%89%E5%85%A8%E5%B1%80map+mapPubKeys%EF%BC%88%E7%AC%AC6%E8%A1%8C%EF%BC%89%E5%92%8C%E9%92%B1%E5%8C%85%E6%95%B0%E6%8D%AE%E5%BA%93wallet.dat%EF%BC%88%E7%AC%AC8%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+mapKeys%E5%BB%BA%E7%AB%8B%E5%85%AC%E9%92%A5%E4%B8%8E%E7%A7%81%E9%92%A5%E7%9A%84%E4%B8%80%E4%B8%80%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB%E3%80%82%0A++%3Cbr%3E+mapPubKeys%E5%BB%BA%E7%AB%8B%E5%85%AC%E9%92%A5%E7%9A%84hash%E5%92%8C%E5%85%AC%E9%92%A5%E6%9C%AC%E8%BA%AB%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E8%BF%94%E5%9B%9E%E5%85%AC%E9%92%A5%EF%BC%88%E7%AC%AC16%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E8%AF%A5%E5%85%AC%E9%92%A5%E4%B8%BA%E6%9C%AA%E5%8E%8B%E7%BC%A9%E7%9A%84%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%B1%9E%E4%BA%8EOpenSSL%E6%A0%87%E5%87%86%E6%A0%BC%E5%BC%8F%E4%B9%8B%E4%B8%80%E3%80%82%E5%9C%A8%E5%BE%97%E5%88%B0%E5%85%AC%E9%92%A5%E4%B9%8B%E5%90%8E%EF%BC%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BC%9A%E5%B0%86%E8%AF%A5%E5%85%AC%E9%92%A5%E4%BC%A0%E9%80%92%E8%87%B3PubKeyToAddress%28%29%E5%B9%B6%E8%B0%83%E7%94%A8Hash160ToAddress%28%29%E6%96%B9%E6%B3%95%E7%94%9F%E6%88%90%E5%9C%B0%E5%9D%80%E3%80%82%E6%9C%80%E5%90%8E%E8%BF%94%E5%9B%9E%E7%9A%84Base58%E7%BC%96%E7%A0%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%80%BC%E4%BE%BF%E6%98%AF%E4%B8%80%E4%B8%AA%E6%96%B0%E7%94%9F%E6%88%90%E7%9A%84%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%9C%B0%E5%9D%80%E3%80%82Base58%E7%94%B11-9%E5%92%8C%E9%99%A4i%EF%BC%8Cl%EF%BC%8C0%EF%BC%8Co%E4%B9%8B%E5%A4%96%E7%9A%84%E8%8B%B1%E6%96%87%E5%AD%97%E7%AC%A6%E7%BB%84%E6%88%90%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+CTransaction%E7%B1%BB%0A++%3Cbr%3E+CTransaction%E7%9A%84%E5%AE%9A%E4%B9%89%E4%BD%8D%E4%BA%8Emain.h%E3%80%82%E5%9C%A8%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%BD%93%E4%B8%AD%EF%BC%8C%E6%89%80%E8%B0%93%E5%B8%81%E7%9A%84%E6%A6%82%E5%BF%B5%E5%85%B6%E5%AE%9E%E6%98%AF%E4%B8%80%E7%B3%BB%E5%88%97%E4%BA%A4%E6%98%93Tx%E7%9A%84%E7%BB%84%E5%90%88%E3%80%82%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%E8%99%BD%E7%84%B6%E5%AE%9E%E7%8E%B0%E8%B5%B7%E6%9D%A5%E6%9B%B4%E4%B8%BA%E5%A4%8D%E6%9D%82%EF%BC%8C%E5%8D%B4%E6%8F%90%E9%AB%98%E4%BA%86%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E3%80%82%E7%94%A8%E6%88%B7%E5%8F%AF%E4%BB%A5%E4%B8%BA%E6%AF%8F%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%9C%B0%E5%9D%80%EF%BC%8C%E5%9C%B0%E5%9D%80%E5%9C%A8%E4%BD%BF%E7%94%A8%E4%B8%80%E6%AC%A1%E4%B9%8B%E5%90%8E%E5%8F%AF%E4%BB%A5%E7%AB%8B%E5%8D%B3%E4%BD%9C%E5%BA%9F%E3%80%82%E5%9B%A0%E6%AD%A4%EF%BC%8CCTransaction%E6%98%AF%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9C%80%E9%87%8D%E8%A6%81%E7%9A%84%E7%B1%BB%E4%B9%8B%E4%B8%80%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+class+CTransaction%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+public%3A%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+int+nVersion%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+vector%26lt%3BCTxIn%26gt%3B+vin%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+vector%26lt%3BCTxOut%26gt%3B+vout%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+int+nLockTime%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F......%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+CTransaction%E5%8C%85%E5%90%AB%E4%B8%A4%E4%B8%AA%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B%EF%BC%9A%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93vin%E5%92%8C%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93vout%E3%80%82%E6%AF%8F%E4%B8%AAvin%E7%94%B1%E8%8B%A5%E5%B9%B2CTxIn%E5%AF%B9%E8%B1%A1%E7%BB%84%E6%88%90%EF%BC%8C%E6%AF%8F%E4%B8%AAvout%E5%88%99%E7%94%B1CTxOut%E7%BB%84%E6%88%90%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%AF%8F%E7%AC%94%E4%BA%A4%E6%98%93Tx%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%EF%BC%88CTxIn%E7%B1%BB%EF%BC%89%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AACOutPoint%E5%AF%B9%E8%B1%A1prevout%EF%BC%8C%E8%AF%A5%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8%E5%8F%A6%E5%A4%96%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93Tx%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E4%BD%9C%E4%B8%BA%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E3%80%82%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E4%BD%BF%E5%BD%93%E5%89%8D%E4%BA%A4%E6%98%93Tx%E4%BB%8E%E5%8F%A6%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93%E5%BD%93%E4%B8%AD%E5%BE%97%E5%88%B0%E5%8F%AF%E8%8A%B1%E8%B4%B9%E7%9A%84%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E3%80%82%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93Tx%E5%8F%AF%E4%BB%A5%E6%8B%A5%E6%9C%89%E4%BB%BB%E6%84%8F%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E4%BB%BB%E4%BD%95%E4%BA%A4%E6%98%93%E5%9D%87%E7%94%B1%E4%B8%80%E4%B8%AA256%E4%BD%8Duint256%E5%93%88%E5%B8%8C%E4%BD%9C%E4%B8%BA%E5%85%B6%E5%94%AF%E4%B8%80%E8%AF%86%E5%88%AB%E3%80%82%E8%8B%A5%E8%A6%81%E5%BC%95%E7%94%A8%E6%9F%90%E4%B8%80%E7%AC%94%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93TxSource%E5%BD%93%E4%B8%AD%E6%9F%90%E4%B8%AA%E7%89%B9%E5%AE%9A%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%EF%BC%8C%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E4%B8%A4%E7%A7%8D%E4%BF%A1%E6%81%AF%EF%BC%9ATxSource%E7%9A%84%E5%93%88%E5%B8%8C%EF%BC%8C%E5%92%8C%E8%AF%A5%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%9C%A8%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%BD%93%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AEn%E3%80%82%E8%BF%99%E4%B8%A4%E7%A7%8D%E4%BF%A1%E6%81%AF%E6%9E%84%E6%88%90COutPoint%E7%B1%BB%E3%80%82%E4%B8%80%E4%B8%AACOutPoint%E5%AF%B9%E8%B1%A1%E6%8C%87%E5%90%91%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E7%9A%84%E6%9F%90%E4%B8%80%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93TxSource.vout%5Bn%5D%E3%80%82%E5%A6%82%E6%9E%9C%E8%AF%A5%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E8%A2%AB%E5%8F%A6%E5%A4%96%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93Tx%E7%9A%84%E4%BD%8D%E7%BD%AEi%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E6%89%80%E5%BC%95%E7%94%A8%EF%BC%8C%E4%BE%8B%E5%A6%82Tx.vin%5Bi%5D.prevout%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%86%E5%85%B6%E7%A7%B0%E4%B8%BATx%E7%9A%84%E7%AC%ACi%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E8%8A%B1%E8%B4%B9%E4%BA%86TxSource%E4%B8%AD%E7%9A%84%E7%AC%ACn%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+uint256%E5%92%8Cuint160%E7%B1%BB%0A++%3Cbr%3E+%E8%BF%99%E4%B8%A4%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AE%9A%E4%B9%89%E4%BD%8D%E4%BA%8Euint.h%E3%80%82%E4%B8%80%E4%B8%AAuint256%E7%B1%BB%E5%8C%85%E5%90%AB%E6%9C%89%E4%B8%80%E4%B8%AA256%E4%BD%8D%E7%9A%84%E5%93%88%E5%B8%8C%E3%80%82%E5%AE%83%E7%94%B1%E4%B8%80%E4%B8%AA%E9%95%BF%E5%BA%A6%E4%B8%BA256%2F32%3D8%E7%9A%84unsigned+int%E6%95%B0%E7%BB%84%E6%9E%84%E6%88%90%E3%80%82%E4%B8%80%E4%B8%AA%E7%9B%B8%E4%BC%BC%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%98%AFuint160%EF%BC%8C%E8%AF%A5%E7%BB%93%E6%9E%84%E7%9A%84%E5%AE%9A%E4%B9%89%E5%8F%AF%E5%9C%A8%E5%90%8C%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%BD%93%E4%B8%AD%E6%89%BE%E5%88%B0%E3%80%82%E6%97%A2%E7%84%B6SHA-256%E7%9A%84%E9%95%BF%E5%BA%A6%E4%B8%BA256bit%EF%BC%8C%E8%AF%BB%E8%80%85%E4%B8%8D%E9%9A%BE%E6%8E%A8%E6%96%AD%E5%87%BAuint160%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E5%AD%98%E6%94%BERIPEMD-160%E5%93%88%E5%B8%8C%E3%80%82uint256%E5%92%8Cuint160%E5%9D%87%E7%94%B1base_uint%E7%B1%BB%E7%BB%A7%E6%89%BF%E8%80%8C%E6%9D%A5%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+class+base_uint+%7B%0A++%3Cbr%3E+protected%3A%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+enum+%7B+WIDTH+%3D+BITS+%2F+32+%7D%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+unsigned+int+pn%5BWIDTH%5D%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+public%3A%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+bool+operator%21%28%29+const%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+%28int+i+%3D+0%3B+i+%26lt%3B+WIDTH%3B+i%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28pn%5Bi%5D+%21%3D+0%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+true%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F......%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+unsigned+int+GetSerializeSize%28int+nType+%3D+0%2C+int+nVersion+%3D+VERSION%29+const%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+sizeof%28pn%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+template+%26lt%3Btypename+Stream%26gt%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+void+Serialize%28Stream%26amp%3B+s%2C+int+nType+%3D+0%2C+int+nVersion+%3D+VERSION%29+const%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+s.write%28%28char*%29pn%2C+sizeof%28pn%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+template+%26lt%3Btypename+Stream%26gt%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+void+Unserialize%28Stream%26amp%3B+s%2C+int+nType+%3D+0%2C+int+nVersion+%3D+VERSION%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+s.read%28%28char*%29pn%2C+sizeof%28pn%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%E8%AF%A5%E7%B1%BB%E9%87%8D%E8%BD%BD%E4%BA%86%E8%8B%A5%E5%B9%B2%E8%BF%90%E7%AE%97%E7%AC%A6%E3%80%82%E6%AD%A4%E5%A4%96%E8%AF%A5%E7%B1%BB%E6%8B%A5%E6%9C%893%E4%B8%AA%E5%BA%8F%E5%88%97%E5%8C%96%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%EF%BC%8CGetSerializeSize%28%29%E3%80%81Serialize%28%29%E5%92%8CUnserialize%28%29%E3%80%82%E6%88%91%E4%BB%AC%E4%BC%9A%E5%9C%A8%E5%90%8E%E9%9D%A2%E8%AE%B2%E5%88%B0%E8%BF%99%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+SendMoney%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Emain.cpp%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bool+SendMoney%28CScript+scriptPubKey%2C+int64+nValue%2C+CWalletTx%26amp%3B+wtxNew%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CRITICAL_BLOCK%28cs_main%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+int64+nFeeRequired%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21CreateTransaction%28scriptPubKey%2C+nValue%2C+wtxNew%2C+nFeeRequired%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+string+strError%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28nValue+%2B+nFeeRequired+%26gt%3B+GetBalance%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+strError+%3D+strprintf%28%22Error%3A+This+is+an+oversized+transaction+that+requires+a+transaction+fee+of+%25s+%22%2C+FormatMoney%28nFeeRequired%29.c_str%28%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+strError+%3D+%22Error%3A+Transaction+creation+failed+%22%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wxMessageBox%28strError%2C+%22Sending...%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+error%28%22SendMoney%28%29+%3A+%25s%5Cn%22%2C+strError.c_str%28%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21CommitTransactionSpent%28wtxNew%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wxMessageBox%28%22Error+finalizing+transaction%22%2C+%22Sending...%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+error%28%22SendMoney%28%29+%3A+Error+finalizing+transaction%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+printf%28%22SendMoney%3A+%25s%5Cn%22%2C+wtxNew.GetHash%28%29.ToString%28%29.substr%280%2C6%29.c_str%28%29%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Broadcast%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21wtxNew.AcceptTransaction%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+This+must+not+fail.+The+transaction+has+already+been+signed+and+recorded.%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+throw+runtime_error%28%22SendMoney%28%29+%3A+wtxNew.AcceptTransaction%28%29+failed%5Cn%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wxMessageBox%28%22Error%3A+Transaction+not+valid%22%2C+%22Sending...%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+error%28%22SendMoney%28%29+%3A+Error%3A+Transaction+not+valid%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.RelayWalletTransaction%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+MainFrameRepaint%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+true%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%BD%93%E7%94%A8%E6%88%B7%E5%8F%91%E9%80%81%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%88%B0%E6%9F%90%E4%B8%80%E4%B8%AA%E5%9C%B0%E5%9D%80%E6%97%B6%EF%BC%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BC%9A%E8%B0%83%E7%94%A8SendMoney%28%29%E6%96%B9%E6%B3%95%E3%80%82%E8%AF%A5%E6%96%B9%E6%B3%95%E5%8C%85%E5%90%AB%E4%B8%89%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+scriptPubKey%E5%8C%85%E5%90%AB%E8%84%9A%E6%9C%AC%E4%BB%A3%E7%A0%81OP_DUP+OP_HASH160+%26lt%3B%E6%94%B6%E6%AC%BE%E4%BA%BA%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B+OP_EQUALVERIFY+OP_CHECKSIG%E3%80%82%0A++%3Cbr%3E+nValue%E8%A1%A8%E7%A4%BA%E5%B0%86%E8%A6%81%E8%BD%AC%E8%B4%A6%E7%9A%84%E9%87%91%E9%A2%9D%E3%80%82%E8%AF%A5%E9%87%91%E9%A2%9D%E5%B9%B6%E6%9C%AA%E5%8C%85%E5%90%AB%E4%BA%A4%E6%98%93%E8%B4%B9nTrasactionFee%E3%80%82%0A++%3Cbr%3E+wtxNew%E6%98%AF%E4%B8%80%E4%B8%AACWalletTx%E7%B1%BB%E7%9A%84%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8F%E3%80%82%E8%AF%A5%E5%8F%98%E9%87%8F%E7%9B%AE%E5%89%8D%E7%9A%84%E5%80%BC%E4%B8%BA%E7%A9%BA%EF%BC%8C%E4%B9%8B%E5%90%8E%E4%BC%9A%E5%8C%85%E5%90%AB%E8%8B%A5%E5%B9%B2CMerkleTX%E7%B1%BB%E5%AF%B9%E8%B1%A1%E3%80%82%E8%AF%A5%E7%B1%BB%E7%94%B1CTransaction%E8%A1%8D%E7%94%9F%E8%80%8C%E6%9D%A5%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%B7%BB%E5%8A%A0%E4%BA%86%E8%8B%A5%E5%B9%B2%E6%96%B9%E6%B3%95%E3%80%82%E6%88%91%E4%BB%AC%E6%9A%82%E6%97%B6%E5%85%88%E4%B8%8D%E7%AE%A1%E5%85%B7%E4%BD%93%E7%BB%86%E8%8A%82%EF%BC%8C%E4%BB%85%E5%B0%86%E5%85%B6%E7%9C%8B%E4%BD%9CCTransaction%E7%B1%BB%E3%80%82%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E6%B5%81%E7%A8%8B%E6%98%BE%E8%80%8C%E6%98%93%E8%A7%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E9%A6%96%E5%85%88%E5%BB%BA%E7%AB%8B%E4%B8%80%E7%AC%94%E6%96%B0%E7%9A%84%E4%BA%A4%E6%98%93%EF%BC%88CreateTransaction%28scriptPubKey%2C+nValue%2C+wtxNet%2C+nFeeRequired%29%EF%BC%8C%E7%AC%AC6%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E5%B0%9D%E8%AF%95%E5%B0%86%E8%BF%99%E7%AC%94%E4%BA%A4%E6%98%93%E6%8F%90%E4%BA%A4%E8%87%B3%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88CommitTransactionSpent%28wtxNet%29%EF%BC%8C%E7%AC%AC16%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E8%AF%A5%E7%AC%94%E4%BA%A4%E6%98%93%E6%8F%90%E4%BA%A4%E6%88%90%E5%8A%9F%EF%BC%88wtxNew.AcceptTransaction%28%29%EF%BC%8C%E7%AC%AC23%E8%A1%8C%EF%BC%89%EF%BC%8C%E5%B0%86%E5%85%B6%E5%B9%BF%E6%92%AD%E8%87%B3%E5%85%B6%E4%BB%96peer%E8%8A%82%E7%82%B9%EF%BC%88wtxNew.RelayWalletTransaction%28%29%EF%BC%8C%E7%AC%AC30%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E8%BF%99%E5%9B%9B%E4%B8%AA%E6%96%B9%E6%B3%95%E9%83%BD%E4%B8%8EwtxNew%E7%9B%B8%E5%85%B3%E3%80%82%E6%88%91%E4%BB%AC%E5%9C%A8%E6%9C%AC%E7%AB%A0%E4%BB%8B%E7%BB%8D%E4%BA%86%E7%AC%AC%E4%B8%80%E4%B8%AA%EF%BC%8C%E5%85%B6%E4%BD%99%E4%B8%89%E4%B8%AA%E5%B0%86%E4%BC%9A%E5%9C%A8%E5%90%8E%E7%BB%AD%E6%96%87%E7%AB%A0%E4%B8%AD%E4%BB%8B%E7%BB%8D%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+CreateTransaction%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Emain.cpp%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bool+CreateTransaction%28CScript+scriptPubKey%2C+int64+nValue%2C+CWalletTx%26amp%3B+wtxNew%2C+int64%26amp%3B+nFeeRequiredRet%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+nFeeRequiredRet+%3D+0%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CRITICAL_BLOCK%28cs_main%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+txdb+must+be+opened+before+the+mapWallet+lock%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+CTxDB+txdb%28%22r%22%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+CRITICAL_BLOCK%28cs_mapWallet%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+int64+nFee+%3D+nTransactionFee%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+loop%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.vin.clear%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.vout.clear%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28nValue+%26lt%3B+0%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+int64+nValueOut+%3D+nValue%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+nValue+%2B%3D+nFee%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Choose+coins+to+use%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+set%26lt%3BCWalletTx*%26gt%3B+setCoins%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21SelectCoins%28nValue%2C+setCoins%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+int64+nValueIn+%3D+0%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+foreach%28CWalletTx*+pcoin%2C+setCoins%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+nValueIn+%2B%3D+pcoin-%26gt%3BGetCredit%28%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Fill+vout%5B0%5D+to+the+payee%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.vout.push_back%28CTxOut%28nValueOut%2C+scriptPubKey%29%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Fill+vout%5B1%5D+back+to+self+with+any+change%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28nValueIn+%26gt%3B+nValue%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Use+the+same+key+as+one+of+the+coins%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vector%26lt%3Bunsigned+char%26gt%3B+vchPubKey%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+CTransaction%26amp%3B+txFirst+%3D+*%28*setCoins.begin%28%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+foreach%28const+CTxOut%26amp%3B+txout%2C+txFirst.vout%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28txout.IsMine%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28ExtractPubKey%28txout.scriptPubKey%2C+true%2C+vchPubKey%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+break%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28vchPubKey.empty%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Fill+vout%5B1%5D+to+ourself%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+CScript+scriptPubKey%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+scriptPubKey+%26lt%3B%26lt%3B+vchPubKey+%26lt%3B%26lt%3B+OP_CHECKSIG%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.vout.push_back%28CTxOut%28nValueIn+-+nValue%2C+scriptPubKey%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Fill+vin%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+foreach%28CWalletTx*+pcoin%2C+setCoins%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+%28int+nOut+%3D+0%3B+nOut+%26lt%3B+pcoin-%26gt%3Bvout.size%28%29%3B+nOut%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28pcoin-%26gt%3Bvout%5BnOut%5D.IsMine%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.vin.push_back%28CTxIn%28pcoin-%26gt%3BGetHash%28%29%2C+nOut%29%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Sign%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+int+nIn+%3D+0%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+foreach%28CWalletTx*+pcoin%2C+setCoins%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+%28int+nOut+%3D+0%3B+nOut+%26lt%3B+pcoin-%26gt%3Bvout.size%28%29%3B+nOut%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28pcoin-%26gt%3Bvout%5BnOut%5D.IsMine%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+SignSignature%28*pcoin%2C+wtxNew%2C+nIn%2B%2B%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Check+that+enough+fee+is+included%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28nFee+%26lt%3B+wtxNew.GetMinFee%28true%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+nFee+%3D+nFeeRequiredRet+%3D+wtxNew.GetMinFee%28true%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+continue%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Fill+vtxPrev+by+copying+from+previous+transactions+vtxPrev%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.AddSupportingTransactions%28txdb%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+wtxNew.fTimeReceivedIsTxTime+%3D+true%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+break%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+true%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E8%B0%83%E7%94%A8%E8%AF%A5%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E5%AE%83%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E5%9B%9B%E4%B8%AA%E5%8F%82%E6%95%B0%E5%A6%82%E4%B8%8B%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+scriptPubKey%E5%8C%85%E5%90%AB%E8%84%9A%E6%9C%AC%E4%BB%A3%E7%A0%81OP_DUP+OP_HASH160+%26lt%3B%E6%94%B6%E6%AC%BE%E4%BA%BA%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B+OP_EQUALVERIFY+OP_CHECKSIG%E3%80%82%0A++%3Cbr%3E+nValue%E6%98%AF%E5%B0%86%E8%A6%81%E8%BD%AC%E8%B4%A6%E7%9A%84%E6%95%B0%E9%A2%9D%EF%BC%8C%E4%BA%A4%E6%98%93%E8%B4%B9nTransactionFee%E5%B9%B6%E6%9C%AA%E5%8C%85%E6%8B%AC%E5%9C%A8%E5%86%85%E3%80%82%0A++%3Cbr%3E+wtxNew%E6%98%AF%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84Tx%E5%AE%9E%E4%BE%8B%E3%80%82%0A++%3Cbr%3E+nFeeRequiredRet%E6%98%AF%E4%B8%80%E7%AC%94%E7%94%A8%E6%9D%A5%E6%94%AF%E4%BB%98%E4%BA%A4%E6%98%93%E8%B4%B9%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%EF%BC%8C%E5%9C%A8%E8%AF%A5%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%E5%AE%8C%E6%88%90%E4%B9%8B%E5%90%8E%E8%8E%B7%E5%BE%97%E3%80%82%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E6%B5%81%E7%A8%8B%E5%A6%82%E4%B8%8B%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8FnValueOut+%3D+nValue%E6%9D%A5%E4%BF%9D%E5%AD%98%E5%B0%86%E8%BD%AC%E8%B4%A6%E7%9A%84%E9%87%91%E9%A2%9D%EF%BC%88%E7%AC%AC17%E8%A1%8C%EF%BC%89%E3%80%82%E5%B0%86nValue%E4%B8%8E%E4%BA%A4%E6%98%93%E8%B4%B9nFee%E7%9B%B8%E5%8A%A0%E5%BE%97%E5%88%B0%E6%96%B0%E7%9A%84%E5%8C%85%E5%90%AB%E8%BD%AC%E8%B4%A6%E8%B4%B9%E7%9A%84nValue%E3%80%82%0A++%3Cbr%3E+%E6%89%A7%E8%A1%8C%E4%BD%8D%E4%BA%8E%E7%AC%AC21%E8%A1%8C%E7%9A%84SelectCoins%28nValue%2C+setCoins%29%E5%BE%97%E5%88%B0%E4%B8%80%E7%B3%BB%E5%88%97%E5%B8%81%EF%BC%8C%E5%B9%B6%E6%94%BE%E5%85%A5setCoins%E3%80%82setCoins%E5%8C%85%E5%90%AB%E6%94%AF%E4%BB%98%E7%BB%99%E4%BD%A0%E6%9C%AC%E4%BA%BA%E5%9C%B0%E5%9D%80%E7%9A%84%E4%BA%A4%E6%98%93%EF%BC%8C%E5%8D%B3%E4%BD%A0%E6%89%80%E6%8B%A5%E6%9C%89%E7%9A%84%E5%B8%81%E3%80%82%E8%BF%99%E4%BA%9B%E4%BA%A4%E6%98%93%E5%B0%86%E6%88%90%E4%B8%BAwtxNew%E7%9A%84%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E+%E6%89%A7%E8%A1%8C%E4%BD%8D%E4%BA%8E%E7%AC%AC27%E8%A1%8C%E7%9A%84wtxNew.vout.push_back%28CTxOut+%28nValueOut%2CsciptPubKey%29%29%E5%B9%B6%E6%B7%BB%E5%8A%A0%E4%B8%80%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E8%87%B3wtxNew%E3%80%82%E8%AF%A5%E7%AC%94%E8%BE%93%E5%87%BA%E5%B0%86%E6%94%AF%E4%BB%98%E7%BB%99%26lt%3B%E6%94%B6%E6%AC%BE%E4%BA%BA%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B%EF%BC%88%E5%8C%85%E5%90%AB%E5%9C%A8scriptPubKey%E9%87%8C%E9%9D%A2%EF%BC%89%E6%95%B0%E9%87%8F%E4%B8%BA%E7%9A%84%E5%B8%81%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%E6%89%BE%E9%9B%B6%EF%BC%88nValueIn+%26gt%3B+nValue%EF%BC%89%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%8F%A6%E4%B8%80%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E8%87%B3wtxNew%E5%B9%B6%E5%B0%86%E9%9B%B6%E9%92%B1%E5%8F%91%E5%9B%9E%E6%9C%AC%E4%BA%BA%E3%80%82%E8%AF%A5%E8%BF%87%E7%A8%8B%E5%8C%85%E5%90%AB%E4%BB%A5%E4%B8%8B%E6%AD%A5%E9%AA%A4%EF%BC%9A%0A++%3Cbr%3E+%E4%BB%8EsetCoin%E5%BD%93%E4%B8%AD%E8%8E%B7%E5%8F%96%E7%AC%AC%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93txFirst%EF%BC%8C%E4%BE%9D%E6%AC%A1%E6%A3%80%E6%9F%A5txFirst.vout%E4%B8%AD%E7%9A%84%E4%BA%A4%E6%98%93%E6%98%AF%E5%90%A6%E5%B1%9E%E4%BA%8E%E6%9C%AC%E4%BA%BA%E3%80%82%E5%A6%82%E6%9E%9C%E6%98%AF%E5%88%99%E4%BB%8E%E8%AF%A5%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%BD%93%E4%B8%AD%E6%8F%90%E5%8F%96%E5%87%BA%E5%85%AC%E9%92%A5%EF%BC%8C%E5%B9%B6%E6%94%BE%E5%85%A5%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8FvchPubKey%0A++%3Cbr%3E+%E5%B0%86vchPubKey%E6%94%BE%E5%85%A5%E8%84%9A%E6%9C%ACvchPubKey+OP_CHECKSIG%EF%BC%8C%E5%B9%B6%E4%BD%BF%E7%94%A8%E8%BF%99%E6%AE%B5%E8%84%9A%E6%9C%AC%E4%BB%A3%E7%A0%81%E4%B8%BAwtxNew%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%94%AF%E4%BB%98%E7%BB%99%E6%9C%AC%E4%BA%BA%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%EF%BC%88%E7%AC%AC45%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E5%9B%A0%E4%B8%BAsetCoins%E5%8C%85%E5%90%AB%E6%94%AF%E4%BB%98%E7%BB%99%E6%9C%AC%E4%BA%BA%E7%9A%84%E4%BA%A4%E6%98%93%EF%BC%8C%E6%89%80%E4%BB%A5%E6%AF%8F%E7%AC%94%E4%BA%A4%E6%98%93%E4%B8%80%E5%AE%9A%E5%8C%85%E6%8B%AC%E8%87%B3%E5%B0%91%E4%B8%80%E7%AC%94%E6%94%AF%E4%BB%98%E7%BB%99%E6%9C%AC%E4%BA%BA%E7%9A%84%E4%BA%A4%E6%98%93%E3%80%82%E4%BB%8E%E7%AC%AC%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93txFirst%E4%B8%AD%E5%8D%B3%E5%8F%AF%E6%89%BE%E5%88%B0%E3%80%82%0A++%3Cbr%3E+%E8%87%B3%E6%AD%A4%EF%BC%8CwtxNew%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%AE%B9%E5%99%A8vout%E5%B7%B2%E5%87%86%E5%A4%87%E5%B0%B1%E7%BB%AA%E3%80%82%E7%8E%B0%E5%9C%A8%EF%BC%8C%E8%AF%A5%E8%AE%BE%E7%BD%AE%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%AE%B9%E5%99%A8vin%E3%80%82%E8%AE%B0%E4%BD%8F%E6%AF%8F%E4%B8%80%E4%B8%AA%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8vin%E5%9D%87%E5%BC%95%E7%94%A8%E4%B8%80%E7%AC%94%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%EF%BC%8C%E8%80%8C%E4%B8%94wtxNew%E7%9A%84%E6%AF%8F%E7%AC%94%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E5%9D%87%E5%8F%AF%E5%9C%A8setCoins%E4%B8%AD%E8%A2%AB%E6%89%BE%E5%88%B0%E3%80%82%E5%AF%B9%E4%BA%8E%E6%AF%8F%E4%B8%80%E7%AC%94setCoins%E4%B8%AD%E7%9A%84%E4%BA%A4%E6%98%93pcoin%EF%BC%8C%E9%80%90%E4%B8%AA%E9%81%8D%E5%8E%86%E5%85%B6%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93pcoin-%26gt%3Bvout%5BnOut%5D%E3%80%82%E5%A6%82%E6%9E%9C%E7%AC%ACnOut%E7%AC%94%E8%BE%93%E5%87%BA%E6%94%AF%E4%BB%98%E7%BB%99%E6%9C%AC%E4%BA%BA%EF%BC%88%E6%84%8F%E5%91%B3%E7%9D%80wtxNew%E4%BB%8E%E8%AF%A5%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E4%B8%AD%E8%8E%B7%E5%BE%97%E5%B8%81%EF%BC%89%EF%BC%8C%E5%88%99%E5%90%91wtxNew%E6%B7%BB%E5%8A%A0%E4%B8%80%E7%AC%94%E6%96%B0%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%EF%BC%88wtxNew.vin%28wtxNew.vin.push_back%28CTxIn%28pcoin-%26gt%3BGetHash%28%29%2C+nOut%29%29%EF%BC%8C%E7%AC%AC51%E8%A1%8C%29%E3%80%82%E8%AF%A5%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E6%8C%87%E5%90%91pcoin%E4%B8%AD%E7%9A%84%E7%AC%ACnOut%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%EF%BC%8C%E7%94%B1%E6%AD%A4%E5%B0%86wtxNew.vin%E4%B8%8Epcoin%E7%9A%84%E7%AC%ACnOut%E7%AC%94%E8%BE%93%E5%87%BA%E7%9B%B8%E8%BF%9E%E6%8E%A5%E3%80%82%0A++%3Cbr%3E+%E5%AF%B9%E4%BA%8EsetCoins%E5%BD%93%E4%B8%AD%E7%9A%84%E6%AF%8F%E7%AC%94%E4%BA%A4%E6%98%93pcoin%EF%BC%8C%E9%80%90%E4%B8%AA%E9%81%8D%E5%8E%86%E5%85%B6%E6%89%80%E6%9C%89%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93pcoin-%26gt%3Bvout%5BnOut%5D%E3%80%82%E5%A6%82%E6%9E%9C%E8%AF%A5%E7%AC%94%E4%BA%A4%E6%98%93%E5%B1%9E%E4%BA%8E%E6%9C%AC%E4%BA%BA%EF%BC%8C%E8%B0%83%E7%94%A8SignSignature%28*pcoin%2CwtxNew%2C+nIn%2B%2B%29%E4%B8%BA%E7%AC%ACnIn%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E6%B7%BB%E5%8A%A0%E7%AD%BE%E5%90%8D%E3%80%82%E6%B3%A8%E6%84%8FnIn%E4%B8%BAwtxNew%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E4%BD%8D%E7%BD%AE%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E4%BA%A4%E6%98%93%E8%B4%B9nFee%E5%B0%8F%E4%BA%8EwtxNet.GetMinFee%28true%29%EF%BC%8C%E5%B0%86nFee%E8%AE%BE%E4%B8%BA%E5%90%8E%E8%80%85%EF%BC%8C%E6%B8%85%E7%A9%BAwtxNew%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E5%B9%B6%E9%87%8D%E6%96%B0%E5%BC%80%E5%A7%8B%E6%95%B4%E4%B8%AA%E8%BF%87%E7%A8%8B%E3%80%82%E5%9C%A8%E4%BD%8D%E4%BA%8E%E7%AC%AC11%E8%A1%8C%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%BF%AD%E4%BB%A3%E5%BD%93%E4%B8%AD%EF%BC%8CnFee%E6%98%AF%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8FnTransactionFee+%3D+0%E7%9A%84%E6%9C%AC%E5%9C%B0%E5%A4%8D%E5%88%B6%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E4%BD%A0%E4%B8%8D%E6%98%8E%E7%99%BD%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%A6%82%E6%AD%A4%E8%B4%B9%E5%8A%9B%E5%9C%B0%E9%87%8D%E6%96%B0%E6%B7%BB%E6%BB%A1wtxNew%EF%BC%8C%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84GetMinFee%28%29%E6%8F%90%E4%BE%9B%E4%BA%86%E7%AD%94%E6%A1%88%EF%BC%9A%E4%BA%A4%E6%98%93%E7%9A%84%E6%9C%80%E4%BD%8E%E8%B4%B9%E7%94%A8%E4%B8%8E%E4%BA%A4%E6%98%93%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%A7%E5%B0%8F%E6%9C%89%E5%85%B3%E3%80%82wtxNew%E7%9A%84%E5%A4%A7%E5%B0%8F%E5%8F%AA%E6%9C%89%E5%9C%A8%E5%AE%8C%E6%95%B4%E6%9E%84%E5%BB%BA%E4%B9%8B%E5%90%8E%E6%89%8D%E5%8F%AF%E5%BE%97%E7%9F%A5%E3%80%82%E5%A6%82%E6%9E%9CwtxNew.GetMinFee%28true%29%E8%AE%A1%E7%AE%97%E5%BE%97%E5%88%B0%E7%9A%84%E6%9C%80%E5%B0%8F%E4%BA%A4%E6%98%93%E8%B4%B9%E7%94%A8%E5%A4%A7%E4%BA%8E%E4%B9%8B%E5%89%8D%E5%88%9B%E9%80%A0wtxNew%E6%97%B6%E5%81%87%E8%AE%BE%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9nFee%EF%BC%8C%E5%88%99%E9%99%A4%E4%BA%86%E9%87%8D%E6%96%B0%E6%9E%84%E5%BB%BAwtxNew%E4%B9%8B%E5%A4%96%E5%88%AB%E6%97%A0%E4%BB%96%E6%B3%95%E3%80%82%0A++%3Cbr%3E+%E8%BF%99%E9%87%8C%E9%81%87%E5%88%B0%E4%BA%86%E4%B8%80%E4%B8%AA%E5%85%88%E6%9C%89%E9%B8%A1%E8%BF%98%E6%98%AF%E5%85%88%E6%9C%89%E8%9B%8B%E7%9A%84%E5%B1%80%E9%9D%A2%EF%BC%9A%E8%8B%A5%E6%83%B3%E5%88%9B%E5%BB%BA%E4%B8%80%E7%AC%94%E6%96%B0%E7%9A%84%E4%BA%A4%E6%98%93%EF%BC%8C%E5%88%99%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E4%BA%A4%E6%98%93%E8%B4%B9%E7%94%A8%E6%98%AF%E5%A4%9A%E5%B0%91%E3%80%82%E8%80%8C%E4%BA%A4%E6%98%93%E8%B4%B9%E5%8F%AA%E6%9C%89%E5%9C%A8%E6%95%B4%E4%B8%AA%E4%BA%A4%E6%98%93%E8%A2%AB%E5%88%9B%E5%BB%BA%E4%BB%A5%E5%90%8E%E6%89%8D%E5%8F%AF%E5%BE%97%E7%9F%A5%E3%80%82%E4%B8%BA%E4%BA%86%E6%89%93%E7%A0%B4%E8%BF%99%E4%B8%AA%E5%BE%AA%E7%8E%AF%EF%BC%8C%E6%9C%AC%E5%9C%B0%E5%8F%98%E9%87%8FnFee%E8%A2%AB%E7%94%A8%E6%9D%A5%E6%94%BE%E7%BD%AE%E9%A2%84%E8%AE%A1%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%E7%94%A8%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%96%B0%E7%9A%84%E4%BA%A4%E6%98%93%E6%9E%84%E5%BB%BA%E5%9C%A8%E6%AD%A4%E5%9F%BA%E7%A1%80%E4%B8%8A%E3%80%82%E5%9C%A8%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%88%90%E4%B9%8B%E5%90%8E%EF%BC%8C%E5%BE%97%E5%88%B0%E7%9C%9F%E5%AE%9E%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%E5%B9%B6%E4%B8%8E%E9%A2%84%E4%BC%B0%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%E4%BD%9C%E6%AF%94%E8%BE%83%E3%80%82%E5%A6%82%E6%9E%9C%E9%A2%84%E4%BC%B0%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%E5%B0%8F%E4%BA%8E%E7%9C%9F%E5%AE%9E%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%EF%BC%8C%E5%88%99%E6%9B%BF%E6%8D%A2%E6%88%90%E7%9C%9F%E5%AE%9E%E4%BA%A4%E6%98%93%E8%B4%B9%E5%B9%B6%E9%87%8D%E6%96%B0%E6%9E%84%E9%80%A0%E6%95%B4%E4%B8%AA%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E+%E8%BF%99%E9%87%8C%E6%98%AFGetMinFee%28%29%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+int64+GetMinFee%28bool+fDiscount%3Dfalse%29+const%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+unsigned+int+nBytes+%3D+%3A%3AGetSerializeSize%28*this%2C+SER_NETWORK%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28fDiscount+%26amp%3B%26amp%3B+nBytes+%26lt%3B+10000%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+0%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+%281+%2B+%28int64%29nBytes+%2F+1000%29+*+CENT%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E8%AE%A1%E7%AE%97%E5%BE%97%E5%88%B0%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%E6%AF%94%E4%B9%8B%E5%89%8D%E9%A2%84%E8%AE%A1%E7%9A%84%E4%BA%A4%E6%98%93%E8%B4%B9%E6%9B%B4%E9%AB%98%EF%BC%8C%E5%88%99%E8%B7%B3%E5%87%BA%E7%AC%AC11%E8%A1%8C%E5%BC%80%E5%A7%8B%E7%9A%84%E5%BE%AA%E7%8E%AF%E5%B9%B6%E8%BF%94%E5%9B%9E%E6%95%B4%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%88%E7%AC%AC67%E8%A1%8C%EF%BC%89%E3%80%82%E5%9C%A8%E6%AD%A4%E4%B9%8B%E5%89%8D%EF%BC%8C%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E4%BB%A5%E4%B8%8B%E4%B8%A4%E4%B8%AA%E6%AD%A5%E9%AA%A4%EF%BC%9A%0A++%3Cbr%3E+%E6%89%A7%E8%A1%8CwtxNew.AddSupportingTransactions%28txdb%29%E3%80%82%E8%BF%99%E4%B8%80%E9%83%A8%E5%88%86%E4%BB%A5%E5%90%8E%E4%BC%9A%E8%BF%9B%E8%A1%8C%E6%9B%B4%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E3%80%82%0A++%3Cbr%3E+%E8%AE%BE%E7%BD%AEwtxNet.fTimeReceivedIsTxTime%3Dtrue%EF%BC%88%E7%AC%AC66%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+%E7%8E%B0%E5%9C%A8%E6%9D%A5%E7%9C%8B%E4%B8%80%E4%B8%8B%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87SignSignature%28%29%E7%AD%BE%E7%BD%B2%E6%96%B0%E7%94%9F%E6%88%90%E7%9A%84%E4%BA%A4%E6%98%93wtxNew%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+SignSignature%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Escript.cpp%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%AF%A5%E6%96%B9%E6%B3%95%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bool+SignSignature%28const+CTransaction%26amp%3B+txFrom%2C+CTransaction%26amp%3B+txTo%2C+unsigned+int+nIn%2C+int+nHashType%2C+CScript+scriptPrereq%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+assert%28nIn+%26lt%3B+txTo.vin.size%28%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CTxIn%26amp%3B+txin+%3D+txTo.vin%5BnIn%5D%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+assert%28txin.prevout.n+%26lt%3B+txFrom.vout.size%28%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+const+CTxOut%26amp%3B+txout+%3D+txFrom.vout%5Btxin.prevout.n%5D%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Leave+out+the+signature+from+the+hash%2C+since+a+signature+can%27t+sign+itself.%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+The+checksig+op+will+also+drop+the+signatures+from+its+hash.%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+uint256+hash+%3D+SignatureHash%28scriptPrereq+%2B+txout.scriptPubKey%2C+txTo%2C+nIn%2C+nHashType%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28%21Solver%28txout.scriptPubKey%2C+hash%2C+nHashType%2C+txin.scriptSig%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+txin.scriptSig+%3D+scriptPrereq+%2B+txin.scriptSig%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Test+solution%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28scriptPrereq.empty%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21EvalScript%28txin.scriptSig+%2B+CScript%28OP_CODESEPARATOR%29+%2B+txout.scriptPubKey%2C+txTo%2C+nIn%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+true%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E9%A6%96%E5%85%88%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E6%98%AF%EF%BC%8C%E8%AF%A5%E5%87%BD%E6%95%B0%E6%9C%895%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%8C%E8%80%8CCreateTransaction%28%29%E5%8F%AA%E6%9C%893%E4%B8%AA%E3%80%82%E8%BF%99%E6%98%AF%E5%9B%A0%E4%B8%BA%E5%9C%A8script.h%E6%96%87%E4%BB%B6%E9%87%8C%EF%BC%8C%E5%90%8E%E4%B8%A4%E4%B8%AA%E5%8F%82%E6%95%B0%E5%B7%B2%E9%BB%98%E8%AE%A4%E7%BB%99%E5%87%BA%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E4%BB%A5%E4%B8%8B%E6%98%AF%E4%BC%A0%E9%80%92%E7%BB%99CreateTransaction%28%29%E4%B8%AD%E7%9A%843%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+txFrom%E6%98%AF%E4%B8%80%E4%B8%AA*pcoin%E5%AF%B9%E8%B1%A1%E3%80%82%E5%AE%83%E6%98%AFCreateTransaction%28%29%E9%87%8CsetCoins%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%B8%81%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%80%E4%B8%AA%E3%80%82%E5%AE%83%E5%90%8C%E6%97%B6%E4%B9%9F%E6%98%AF%E4%B8%80%E7%AC%94%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E3%80%82%E5%AE%83%E7%9A%84%E8%8B%A5%E5%B9%B2%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%BD%93%E4%B8%AD%E5%8C%85%E5%90%AB%E4%BA%86%E6%96%B0%E4%BA%A4%E6%98%93%E5%B0%86%E8%A6%81%E8%8A%B1%E8%B4%B9%E7%9A%84%E5%B8%81%E3%80%82%0A++%3Cbr%3E+txTo%E6%98%AFCreateTransaction%28%29%E9%87%8C%E7%9A%84wtxNew%E5%AF%B9%E8%B1%A1%E3%80%82%E5%AE%83%E6%98%AF%E5%B0%86%E8%A6%81%E8%8A%B1%E8%B4%B9%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%E7%9A%84%E6%96%B0%E4%BA%A4%E6%98%93%E3%80%82%E6%96%B0%E4%BA%A4%E6%98%93%E9%9C%80%E8%A6%81%E8%A2%AB%E7%AD%BE%E7%BD%B2%E6%96%B9%E5%8F%AF%E7%94%9F%E6%95%88%E3%80%82%0A++%3Cbr%3E+nIn%E6%98%AF%E6%8C%87%E5%90%91txTo%E4%B8%AD%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E7%9A%84%E7%B4%A2%E5%BC%95%E4%BD%8D%E7%BD%AE%E3%80%82%E8%AF%A5%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E5%8C%85%E5%90%AB%E4%B8%80%E4%B8%AA%E5%AF%B9txFrom%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E7%9A%84%E5%BC%95%E7%94%A8%E3%80%82%E6%9B%B4%E5%87%86%E7%A1%AE%E5%9C%B0%E8%AE%B2%EF%BC%8Ctxin%3DtxTo.vin%5BnIn%5D%EF%BC%88%E7%AC%AC4%E8%A1%8C%EF%BC%89%E6%98%AFtxTo%E4%B8%AD%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%EF%BC%9Btxout%3DtxFrom.vout%5Btxin.prev.out.n%5D%EF%BC%88%E7%AC%AC6%E8%A1%8C%EF%BC%89%E6%98%AFtxin%E6%89%80%E6%8C%87%E5%90%91%E7%9A%84txFrom%E4%B8%AD%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E+%E4%BB%A5%E4%B8%8B%E6%98%AFSignSignature%28%29%E6%89%80%E5%81%9A%E7%9A%84%E5%B7%A5%E4%BD%9C%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E8%B0%83%E7%94%A8SignatureHash%28%29%E6%96%B9%E6%B3%95%E7%94%9F%E6%88%90txTo%E7%9A%84%E5%93%88%E5%B8%8C%E5%80%BC%E3%80%82%0A++%3Cbr%3E+%E8%B0%83%E7%94%A8Solver%28%29%E5%87%BD%E6%95%B0%E7%AD%BE%E7%BD%B2%E5%88%9A%E6%89%8D%E7%94%9F%E6%88%90%E7%9A%84%E5%93%88%E5%B8%8C%E3%80%82%0A++%3Cbr%3E+%E8%B0%83%E7%94%A8EvalScript%28%29%E6%9D%A5%E8%BF%90%E8%A1%8C%E4%B8%80%E5%B0%8F%E6%AE%B5%E8%84%9A%E6%9C%AC%E5%B9%B6%E6%A3%80%E6%9F%A5%E7%AD%BE%E5%90%8D%E6%98%AF%E5%90%A6%E5%90%88%E6%B3%95%E3%80%82%0A++%3Cbr%3E+%E6%88%91%E4%BB%AC%E4%B8%80%E8%B5%B7%E7%9C%8B%E4%B8%80%E4%B8%8B%E8%BF%99%E4%B8%89%E4%B8%AA%E5%87%BD%E6%95%B0%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+SignatureHash%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Escript.cpp%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AFSignatureHash%28%29%E7%9A%84%E6%BA%90%E7%A0%81%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+uint256+SignatureHash%28CScript+scriptCode%2C+const+CTransaction%26amp%3B+txTo%2C+unsigned+int+nIn%2C+int+nHashType%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28nIn+%26gt%3B%3D+txTo.vin.size%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+printf%28%22ERROR%3A+SignatureHash%28%29+%3A+nIn%3D%25d+out+of+range%5Cn%22%2C+nIn%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+1%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CTransaction+txTmp%28txTo%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+In+case+concatenating+two+scripts+ends+up+with+two+codeseparators%2C%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+or+an+extra+one+at+the+end%2C+this+prevents+all+those+possible+incompatibilities.%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+scriptCode.FindAndDelete%28CScript%28OP_CODESEPARATOR%29%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Blank+out+other+inputs%27+signatures%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+for+%28int+i+%3D+0%3B+i+%26lt%3B+txTmp.vin.size%28%29%3B+i%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vin%5Bi%5D.scriptSig+%3D+CScript%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+txTmp.vin%5BnIn%5D.scriptSig+%3D+scriptCode%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Blank+out+some+of+the+outputs%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28%28nHashType+%26amp%3B+0x1f%29+%3D%3D+SIGHASH_NONE%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Wildcard+payee%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vout.clear%28%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Let+the+others+update+at+will%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+%28int+i+%3D+0%3B+i+%26lt%3B+txTmp.vin.size%28%29%3B+i%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28i+%21%3D+nIn%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vin%5Bi%5D.nSequence+%3D+0%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+else+if+%28%28nHashType+%26amp%3B+0x1f%29+%3D%3D+SIGHASH_SINGLE%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Only+lockin+the+txout+payee+at+same+index+as+txin%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+unsigned+int+nOut+%3D+nIn%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28nOut+%26gt%3B%3D+txTmp.vout.size%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+printf%28%22ERROR%3A+SignatureHash%28%29+%3A+nOut%3D%25d+out+of+range%5Cn%22%2C+nOut%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+1%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vout.resize%28nOut%2B1%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+%28int+i+%3D+0%3B+i+%26lt%3B+nOut%3B+i%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vout%5Bi%5D.SetNull%28%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Let+the+others+update+at+will%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+%28int+i+%3D+0%3B+i+%26lt%3B+txTmp.vin.size%28%29%3B+i%2B%2B%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28i+%21%3D+nIn%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vin%5Bi%5D.nSequence+%3D+0%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Blank+out+other+inputs+completely%2C+not+recommended+for+open+transactions%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28nHashType+%26amp%3B+SIGHASH_ANYONECANPAY%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vin%5B0%5D+%3D+txTmp.vin%5BnIn%5D%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+txTmp.vin.resize%281%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Serialize+and+hash%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CDataStream+ss%28SER_GETHASH%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+ss.reserve%2810000%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+ss+%26lt%3B%26lt%3B+txTmp+%26lt%3B%26lt%3B+nHashType%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+Hash%28ss.begin%28%29%2C+ss.end%28%29%29%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%AF%A5%E5%87%BD%E6%95%B0%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%9A%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+txTo%E6%98%AF%E5%B0%86%E8%A6%81%E8%A2%AB%E7%AD%BE%E7%BD%B2%E7%9A%84%E4%BA%A4%E6%98%93%E3%80%82%E5%AE%83%E5%90%8C%E6%97%B6%E4%B9%9F%E6%98%AFCreateTransaction%28%29%E4%B8%AD%E7%9A%84wtxNew%E5%AF%B9%E8%B1%A1%E3%80%82%E5%AE%83%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E4%B8%AD%E7%9A%84%E7%AC%ACnIn%E9%A1%B9%EF%BC%8CtxTo.vin%5BnIn%5D%EF%BC%8C%E6%98%AF%E8%AF%A5%E5%87%BD%E6%95%B0%E5%B0%86%E8%A6%81%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E7%9B%AE%E6%A0%87%E3%80%82%0A++%3Cbr%3E+scriptCode%E6%98%AFscriptPrereq+%2B+txout.scriptPubKey%EF%BC%8C%E5%85%B6%E4%B8%ADtxout%E6%98%AFSignSignature%28%29%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%9A%84%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%28%29%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E3%80%82%E7%94%B1%E4%BA%8E%E6%AD%A4%E6%97%B6scriptPrereq%E4%B8%BA%E7%A9%BA%EF%BC%8CscriptCode%E4%BA%8B%E5%AE%9E%E4%B8%8A%E6%98%AF%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%E4%B8%AD%E7%9A%84%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E5%BD%93%E4%B8%AD%E8%A2%ABtxTo%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%BC%95%E7%94%A8%E7%9A%84%E9%82%A3%E7%AC%94%E7%9A%84%E8%84%9A%E6%9C%AC%E4%BB%A3%E7%A0%81%E3%80%82txout.scriptPubKey%E6%9C%89%E5%8F%AF%E8%83%BD%E5%8C%85%E5%90%AB%E4%B8%A4%E7%B1%BB%E8%84%9A%E6%9C%AC%EF%BC%9A%0A++%3Cbr%3E+%E8%84%9A%E6%9C%ACA%EF%BC%9AOP_DUP+OP_HASH160+%26lt%3B%E4%BD%A0%E5%9C%B0%E5%9D%80%E7%9A%84160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B+OP_EQUALVERIFY+OP_CECKSIG%E3%80%82%E8%AF%A5%E8%84%9A%E6%9C%AC%E5%B0%86%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%E4%B8%AD%E7%9A%84%E5%B8%81%E5%8F%91%E9%80%81%E7%BB%99%E4%BD%A0%EF%BC%8C%E5%85%B6%E4%B8%AD%26lt%3B%E4%BD%A0%E5%9C%B0%E5%9D%80%E7%9A%84160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B%E6%98%AF%E4%BD%A0%E7%9A%84%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%9C%B0%E5%9D%80%E3%80%82%0A++%3Cbr%3E+%E8%84%9A%E6%9C%ACB%EF%BC%9A%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5%26gt%3B+OP_CHECKSIG%E3%80%82%E8%AF%A5%E8%84%9A%E6%9C%AC%E5%B0%86%E5%89%A9%E4%BD%99%E7%9A%84%E5%B8%81%E9%80%80%E8%BF%98%E8%87%B3%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%E7%9A%84%E5%8F%91%E8%B5%B7%E4%BA%BA%E3%80%82%E7%94%B1%E4%BA%8E%E4%BD%A0%E5%88%9B%E5%BB%BA%E7%9A%84%E6%96%B0%E4%BA%A4%E6%98%93txTo%2FwtxNew%E5%B0%86%E4%BC%9A%E8%8A%B1%E8%B4%B9%E6%9D%A5%E8%87%AAtxFrom%E7%9A%84%E5%B8%81%EF%BC%8C%E4%BD%A0%E5%BF%85%E9%A1%BB%E5%90%8C%E6%97%B6%E4%B9%9F%E6%98%AFtxFrom%E7%9A%84%E5%88%9B%E5%BB%BA%E8%80%85%E3%80%82%E6%8D%A2%E5%8F%A5%E8%AF%9D%E8%AE%B2%EF%BC%8C%E5%BD%93%E4%BD%A0%E5%9C%A8%E5%88%9B%E5%BB%BAtxFrom%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E4%BD%A0%E5%85%B6%E5%AE%9E%E6%98%AF%E5%9C%A8%E8%8A%B1%E8%B4%B9%E4%B9%8B%E5%89%8D%E5%88%AB%E4%BA%BA%E5%8F%91%E9%80%81%E7%BB%99%E4%BD%A0%E7%9A%84%E5%B8%81%E3%80%82%E5%9B%A0%E6%AD%A4%EF%BC%8C%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5%26gt%3B%E5%8D%B3%E6%98%AFtxFrom%E5%88%9B%E5%BB%BA%E8%80%85%E7%9A%84%E5%85%AC%E9%92%A5%EF%BC%8C%E4%B9%9F%E6%98%AF%E4%BD%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%85%AC%E9%92%A5%E3%80%82%0A++%3Cbr%3E+%E6%88%91%E4%BB%AC%E5%9C%A8%E6%AD%A4%E5%81%9C%E7%95%99%E7%89%87%E5%88%BB%EF%BC%8C%E6%9D%A5%E6%80%9D%E8%80%83%E4%B8%80%E4%B8%8B%E8%84%9A%E6%9C%ACA%E5%92%8C%E8%84%9A%E6%9C%ACB%E3%80%82%E4%BD%A0%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%97%AE%EF%BC%8C%E8%BF%99%E4%BA%9B%E8%84%9A%E6%9C%AC%E6%98%AF%E4%BB%8E%E5%93%AA%E6%9D%A5%E7%9A%84%E3%80%82%E4%B8%AD%E6%9C%AC%E8%81%AA%E5%9C%A8%E5%88%9B%E9%80%A0%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E7%9A%84%E6%97%B6%E5%80%99%E4%B8%BA%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E6%B7%BB%E5%8A%A0%E4%BA%86%E4%B8%80%E5%A5%97%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%89%80%E4%BB%A5%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84%E4%BA%A4%E6%98%93%E9%83%BD%E6%98%AF%E7%94%B1%E8%84%9A%E6%9C%AC%E4%BB%A3%E7%A0%81%E5%AE%8C%E6%88%90%E7%9A%84%E3%80%82%E8%AF%A5%E8%84%9A%E6%9C%AC%E7%B3%BB%E7%BB%9F%E5%85%B6%E5%AE%9E%E4%B9%9F%E6%98%AF%E5%90%8E%E6%9D%A5%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E7%9A%84%E9%9B%8F%E5%BD%A2%E3%80%82%E8%84%9A%E6%9C%ACA%E6%9D%A5%E8%87%AA%E7%AC%AC29%E8%A1%8C%EF%BC%8C%E4%BD%8D%E4%BA%8E%E6%96%B9%E6%B3%95CSendDialog%3A%3AOnButtonSend%28%29%EF%BC%8C%E8%84%9A%E6%9C%ACB%E5%88%99%E6%9D%A5%E8%87%AA%E7%AC%AC44%E8%A1%8C%EF%BC%8C%E4%BD%8D%E4%BA%8E%E6%96%B9%E6%B3%95CreateTransaction%28%29%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%BD%93%E7%94%A8%E6%88%B7%E5%8F%91%E8%B5%B7%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93%E6%97%B6%EF%BC%8C%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BC%9A%E8%B0%83%E7%94%A8CSendDialog%3A%3AOnButtonSend%28%29%E6%96%B9%E6%B3%95%E5%B9%B6%E5%B0%86%E8%84%9A%E6%9C%ACA%E6%B7%BB%E5%8A%A0%E8%87%B3txFrom%E4%B8%AD%E7%9A%84%E4%B8%80%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E4%B8%AD%E3%80%82%E7%94%B1%E4%BA%8E%E8%AF%A5%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E7%9A%84%E6%94%B6%E6%AC%BE%E6%96%B9%E4%B8%BA%E4%BD%A0%E6%9C%AC%E4%BA%BA%EF%BC%8C%E4%BB%8E%E8%80%8C%E8%84%9A%E6%9C%AC%E4%B8%AD%E7%9A%84%26lt%3B%E6%94%B6%E6%AC%BE%E4%BA%BA%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B%EF%BC%8C%E5%B0%B1%E6%98%AF%26lt%3B%E4%BD%A0%E7%9A%84%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9CtxFrom%E6%98%AF%E4%BD%A0%E6%9C%AC%E4%BA%BA%E5%88%9B%E5%BB%BA%E7%9A%84%EF%BC%8C%E5%88%99%E8%84%9A%E6%9C%ACB%E4%BC%9A%E8%A2%AB%E6%B7%BB%E5%8A%A0%E8%87%B3CreateTransaction%28%29%E4%B8%ADtxFrom%E7%9A%84%E6%9F%90%E4%B8%80%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E3%80%82%E5%9C%A8%E8%BF%99%E9%87%8C%EF%BC%8C%E7%AC%AC44%E8%A1%8C%E4%BD%8D%E4%BA%8ECreateTransaction%28%29%E4%B8%AD%E7%9A%84%E5%85%AC%E9%92%A5vchPubKey%E6%98%AF%E4%BD%A0%E6%9C%AC%E4%BA%BA%E7%9A%84%E5%85%AC%E9%92%A5%E3%80%82%0A++%3Cbr%3E+%E5%9C%A8%E4%BA%86%E8%A7%A3%E4%BA%86%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E4%B9%8B%E5%90%8E%EF%BC%8C%E6%88%91%E4%BB%AC%E6%9D%A5%E4%B8%80%E8%B5%B7%E4%BA%86%E8%A7%A3SignatureHash%28%29%E6%98%AF%E6%80%8E%E6%A0%B7%E5%B7%A5%E4%BD%9C%E7%9A%84%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+SignatureHash%28%29%E9%A6%96%E5%85%88%E5%B0%86txTO%E6%8B%B7%E8%B4%9D%E8%87%B3txTmp%EF%BC%8C%E6%8E%A5%E7%9D%80%E6%B8%85%E7%A9%BAtxTmp.vin%E4%B8%AD%E6%AF%8F%E4%B8%80%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E7%9A%84scriptSig%EF%BC%8C%E9%99%A4%E4%BA%86txTmp.vin%5BnIn%5D%E4%B9%8B%E5%A4%96%EF%BC%8C%E8%AF%A5%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E7%9A%84scriptSig%E8%A2%AB%E8%AE%BE%E4%B8%BAscriptCode%28%E7%AC%AC14%E3%80%8115%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%8E%A5%E7%9D%80%EF%BC%8C%E8%AF%A5%E5%87%BD%E6%95%B0%E6%A3%80%E9%AA%8CnHashType%E7%9A%84%E5%80%BC%E3%80%82%E8%AF%A5%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8%E8%80%85%E5%B0%86%E4%B8%80%E4%B8%AA%E6%9E%9A%E4%B8%BE%E5%80%BC%E4%BC%A0%E9%80%92%E8%87%B3%E8%AF%A5%E5%87%BD%E6%95%B0nHashType+%3D+SIGHASH_ALL%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+enum%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+SIGHASH_ALL+%3D+1%2C%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+SIGHASH_NONE+%3D+2%2C%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+SIGHASH_SINGLE+%3D+3%2C%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+SIGHASH_ANYONECANPAY+%3D+0x80%2C%0A++%3Cbr%3E+%7D%3B%0A++%3Cbr%3E+%E7%94%B1%E4%BA%8EnHashType+%3D+SIGHASH_ALL%EF%BC%8C%E6%89%80%E6%9C%89%E7%9A%84if-else%E6%9D%A1%E4%BB%B6%E5%9D%87%E4%B8%8D%E6%88%90%E7%AB%8B%EF%BC%8C%E8%AF%A5%E5%87%BD%E6%95%B0%E5%B0%86%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C%E6%9C%80%E5%90%8E4%E8%A1%8C%E4%BB%A3%E7%A0%81%E3%80%82%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%9C%A8%E6%9C%80%E5%90%8E4%E8%A1%8C%E4%BB%A3%E7%A0%81%E4%B8%AD%EF%BC%8CtxTmp%E5%92%8CnHashType%E5%8F%98%E6%88%90%E5%BA%8F%E5%88%97%E5%8C%96%E5%90%8E%E7%9A%84%E7%B1%BB%E5%9E%8BCDataStream%E5%AF%B9%E8%B1%A1%E3%80%82%E8%AF%A5%E7%B1%BB%E5%9E%8B%E5%8C%85%E6%8B%AC%E4%B8%80%E4%B8%AA%E8%A3%85%E6%9C%89%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AD%97%E7%AC%A6%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B%E3%80%82%E6%89%80%E8%BF%94%E5%9B%9E%E7%9A%84%E5%93%88%E5%B8%8C%E5%80%BC%E6%98%AFHash%28%29%E6%96%B9%E6%B3%95%E5%9C%A8%E8%AE%A1%E7%AE%97%E5%BA%8F%E5%88%97%E5%8C%96%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E6%89%80%E5%BE%97%E5%88%B0%E7%9A%84%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E4%B8%80%E7%AC%94%E4%BA%A4%E6%98%93%E5%8F%AF%E4%BB%A5%E5%8C%85%E5%90%AB%E5%A4%9A%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E3%80%82SignatureHash%28%29%E5%8F%96%E5%85%B6%E4%B8%AD%E4%B8%80%E7%AC%94%E4%BD%9C%E4%B8%BA%E7%9B%AE%E6%A0%87%E3%80%82%E5%AE%83%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E6%AD%A5%E9%AA%A4%E7%94%9F%E6%88%90%E5%93%88%E5%B8%8C%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%B8%85%E7%A9%BA%E9%99%A4%E4%BA%86%E7%9B%AE%E6%A0%87%E4%BA%A4%E6%98%93%E4%B9%8B%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E3%80%82%0A++%3Cbr%3E+%E5%A4%8D%E5%88%B6%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93%E4%B8%AD%E8%A2%AB%E7%9B%AE%E6%A0%87%E4%BA%A4%E6%98%93%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%BC%95%E7%94%A8%E7%9A%84%E9%82%A3%E7%AC%94%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E7%9A%84%E8%84%9A%E6%9C%AC%E8%87%B3%E7%9B%AE%E6%A0%87%E4%BA%A4%E6%98%93%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E4%B8%AD%E3%80%82%0A++%3Cbr%3E+%E4%B8%BA%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84%E4%BA%A4%E6%98%93%E7%94%9F%E6%88%90%E5%93%88%E5%B8%8C%E5%80%BC%E3%80%82%0A++%3Cbr%3E+Hash%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Eutil.h%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E7%94%9F%E6%88%90%E5%93%88%E5%B8%8C%E5%80%BC%E7%9A%84%E6%96%B9%E6%B3%95Hash%28%29%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+template%26lt%3Btypename+T1%26gt%3B%0A++%3Cbr%3E+inline+uint256+Hash%28const+T1+pbegin%2C+const+T1+pend%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+uint256+hash1%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+SHA256%28%28unsigned+char*%29%26amp%3Bpbegin%5B0%5D%2C+%28pend+-+pbegin%29+*+sizeof%28pbegin%5B0%5D%29%2C+%28unsigned+char*%29%26amp%3Bhash1%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+uint256+hash2%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+SHA256%28%28unsigned+char*%29%26amp%3Bhash1%2C+sizeof%28hash1%29%2C+%28unsigned+char*%29%26amp%3Bhash2%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+hash2%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%E8%AF%A5%E5%87%BD%E6%95%B0%E5%AF%B9%E7%9B%AE%E6%A0%87%E6%95%B0%E6%8D%AE%E6%89%A7%E8%A1%8C%E4%B8%A4%E6%AC%A1SHA256%28%29%E6%96%B9%E6%B3%95%E5%B9%B6%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E3%80%82SHA256%28%29%E7%9A%84%E5%A3%B0%E6%98%8E%E5%8F%AF%E5%9C%A8openssl%2Fsha.h%E4%B8%AD%E6%89%BE%E5%88%B0%E3%80%82%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+Solver%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Escript.cpp%E3%80%82Solver%28%29%E5%9C%A8SignSignature%28%29%E4%B8%AD%E7%B4%A7%E6%8E%A5%E7%9D%80SignatureHash%28%29%E8%A2%AB%E6%89%A7%E8%A1%8C%E3%80%82%E5%AE%83%E6%98%AF%E7%9C%9F%E6%AD%A3%E7%94%A8%E6%9D%A5%E4%B8%BASignatureHash%28%29%E8%BF%94%E5%9B%9E%E7%9A%84%E5%93%88%E5%B8%8C%E5%80%BC%E7%94%9F%E6%88%90%E7%AD%BE%E5%90%8D%E7%9A%84%E5%87%BD%E6%95%B0%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bool+Solver%28const+CScript%26amp%3B+scriptPubKey%2C+uint256+hash%2C+int+nHashType%2C+CScript%26amp%3B+scriptSigRet%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+scriptSigRet.clear%28%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+vector%26lt%3Bpair%26lt%3Bopcodetype%2C+valtype%26gt%3B+%26gt%3B+vSolution%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28%21Solver%28scriptPubKey%2C+vSolution%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Compile+solution%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+CRITICAL_BLOCK%28cs_mapKeys%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+foreach%28PAIRTYPE%28opcodetype%2C+valtype%29%26amp%3B+item%2C+vSolution%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28item.first+%3D%3D+OP_PUBKEY%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Sign%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+const+valtype%26amp%3B+vchPubKey+%3D+item.second%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21mapKeys.count%28vchPubKey%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28hash+%21%3D+0%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vector%26lt%3Bunsigned+char%26gt%3B+vchSig%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21CKey%3A%3ASign%28mapKeys%5BvchPubKey%5D%2C+hash%2C+vchSig%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vchSig.push_back%28%28unsigned+char%29nHashType%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+scriptSigRet+%26lt%3B%26lt%3B+vchSig%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else+if+%28item.first+%3D%3D+OP_PUBKEYHASH%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Sign+and+give+pubkey%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+map%26lt%3Buint160%2C+valtype%26gt%3B%3A%3Aiterator+mi+%3D+mapPubKeys.find%28uint160%28item.second%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28mi+%3D%3D+mapPubKeys.end%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+const+vector%26lt%3Bunsigned+char%26gt%3B%26amp%3B+vchPubKey+%3D+%28*mi%29.second%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21mapKeys.count%28vchPubKey%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28hash+%21%3D+0%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vector%26lt%3Bunsigned+char%26gt%3B+vchSig%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21CKey%3A%3ASign%28mapKeys%5BvchPubKey%5D%2C+hash%2C+vchSig%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vchSig.push_back%28%28unsigned+char%29nHashType%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+scriptSigRet+%26lt%3B%26lt%3B+vchSig+%26lt%3B%26lt%3B+vchPubKey%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+true%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%AF%A5%E6%96%B9%E6%B3%95%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%844%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%9A%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E4%BD%8D%E4%BA%8E%E7%AC%AC10%E8%A1%8C%E7%9A%84%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0SignSignature%28%29%E5%B0%86txOut.scriptPubKey%EF%BC%8C%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%E7%9A%84%E8%BE%93%E5%87%BA%E8%84%9A%E6%9C%AC%EF%BC%8C%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E5%80%BC%E4%BC%A0%E5%85%A5%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0scriptPubKey%E3%80%82%E8%AE%B0%E4%BD%8F%E5%AE%83%E5%8F%AF%E8%83%BD%E5%8C%85%E5%90%AB%E8%84%9A%E6%9C%ACA%E6%88%96%E8%80%85%E8%84%9A%E6%9C%ACB%E3%80%82%0A++%3Cbr%3E+%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0hash%E6%98%AF%E7%94%B1SignatureHash%28%29%E7%94%9F%E6%88%90%E7%9A%84%E5%93%88%E5%B8%8C%E5%80%BC%E3%80%82%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%89%E4%B8%AA%E5%8F%82%E6%95%B0nHashType%E7%9A%84%E5%80%BC%E4%B8%BASIGHASH_ALL%E3%80%82%0A++%3Cbr%3E+%E7%AC%AC%E5%9B%9B%E4%B8%AA%E5%8F%82%E6%95%B0%E6%98%AF%E8%AF%A5%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC%EF%BC%8C%E5%8D%B3%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0SignSIgnature%28%29%E4%B8%AD%E4%BD%8D%E4%BA%8E%E7%AC%AC12%E8%A1%8C%E7%9A%84txin.scriptSig%E3%80%82%E8%AE%B0%E4%BD%8Ftxin%E6%98%AF%E6%96%B0%E7%94%9F%E6%88%90%E7%9A%84%E4%BA%A4%E6%98%93wtxNew%EF%BC%88%E5%9C%A8%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0SignSignature%28%29%E4%B8%AD%E4%BD%9C%E4%B8%BAtxTo%E5%BC%95%E7%94%A8%EF%BC%89%E4%BD%8D%E4%BA%8E%E7%AC%ACnIn%E7%9A%84%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E3%80%82%E5%9B%A0%E6%AD%A4%EF%BC%8CwtxNew%E7%AC%ACnIn%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E7%9A%84scriptSig%E5%B0%86%E5%AD%98%E6%94%BE%E8%AF%A5%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E7%9A%84%E7%AD%BE%E5%90%8D%E3%80%82%0A++%3Cbr%3E+%E8%AF%A5%E5%87%BD%E6%95%B0%E9%A6%96%E5%85%88%E4%BC%9A%E8%B0%83%E7%94%A8%E5%8F%A6%E4%B8%80%E4%B8%AA%E6%9C%892%E4%B8%AA%E5%8F%82%E6%95%B0%E7%9A%84Solver%28%29%E3%80%82%E6%88%91%E4%BB%AC%E6%9D%A5%E7%A0%94%E7%A9%B6%E4%B8%80%E4%B8%8B%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%B8%A6%E6%9C%892%E4%B8%AA%E5%8F%82%E6%95%B0%E7%9A%84Solver%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Escript.cpp%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E5%B8%A6%E6%9C%892%E4%B8%AA%E5%8F%82%E6%95%B0%E7%9A%84Solver%28%29%E7%9A%84%E6%BA%90%E7%A0%81%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+bool+Solver%28const+CScript%26amp%3B+scriptPubKey%2C+vector%26lt%3Bpair%26lt%3Bopcodetype%2C+valtype%26gt%3B+%26gt%3B%26amp%3B+vSolutionRet%29%0A++%3Cbr%3E+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Templates%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+static+vector%26lt%3BCScript%26gt%3B+vTemplates%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+%28vTemplates.empty%28%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Standard+tx%2C+sender+provides+pubkey%2C+receiver+adds+signature%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vTemplates.push_back%28CScript%28%29+%26lt%3B%26lt%3B+OP_PUBKEY+%26lt%3B%26lt%3B+OP_CHECKSIG%29%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Short+account+number+tx%2C+sender+provides+hash+of+pubkey%2C+receiver+provides+signature+and+pubkey%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vTemplates.push_back%28CScript%28%29+%26lt%3B%26lt%3B+OP_DUP+%26lt%3B%26lt%3B+OP_HASH160+%26lt%3B%26lt%3B+OP_PUBKEYHASH+%26lt%3B%26lt%3B+OP_EQUALVERIFY+%26lt%3B%26lt%3B+OP_CHECKSIG%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%2F%2F+Scan+templates%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+const+CScript%26amp%3B+script1+%3D+scriptPubKey%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+foreach%28const+CScript%26amp%3B+script2%2C+vTemplates%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vSolutionRet.clear%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+opcodetype+opcode1%2C+opcode2%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vector%26lt%3Bunsigned+char%26gt%3B+vch1%2C+vch2%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Compare%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+CScript%3A%3Aconst_iterator+pc1+%3D+script1.begin%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+CScript%3A%3Aconst_iterator+pc2+%3D+script2.begin%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+loop%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+bool+f1+%3D+script1.GetOp%28pc1%2C+opcode1%2C+vch1%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+bool+f2+%3D+script2.GetOp%28pc2%2C+opcode2%2C+vch2%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28%21f1+%26amp%3B%26amp%3B+%21f2%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%2F%2F+Success%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+reverse%28vSolutionRet.begin%28%29%2C+vSolutionRet.end%28%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+return+true%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else+if+%28f1+%21%3D+f2%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+break%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else+if+%28opcode2+%3D%3D+OP_PUBKEY%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28vch1.size%28%29+%26lt%3B%3D+sizeof%28uint256%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+break%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vSolutionRet.push_back%28make_pair%28opcode2%2C+vch1%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else+if+%28opcode2+%3D%3D+OP_PUBKEYHASH%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+%28vch1.size%28%29+%21%3D+sizeof%28uint160%29%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+break%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+vSolutionRet.push_back%28make_pair%28opcode2%2C+vch1%29%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else+if+%28opcode1+%21%3D+opcode2%29%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+break%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%7D%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+vSolutionRet.clear%28%29%3B%0A++%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+false%3B%0A++%3Cbr%3E+%7D%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0scriptPubKey%E5%8F%AF%E8%83%BD%E5%8C%85%E5%90%AB%E8%84%9A%E6%9C%ACA%E4%B9%9F%E5%8F%AF%E8%83%BD%E6%98%AF%E8%84%9A%E6%9C%ACB%E3%80%82%E5%86%8D%E4%B8%80%E6%AC%A1%E8%AF%B4%E6%98%8E%EF%BC%8C%E5%AE%83%E6%98%AFSignSignature%28%29%E4%B8%AD%E6%9D%A5%E6%BA%90%E4%BA%A4%E6%98%93txFrom%E7%9A%84%E8%BE%93%E5%87%BA%E8%84%9A%E6%9C%AC%E3%80%82%0A++%3Cbr%3E+%26nbsp%3B%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0%E7%94%A8%E6%9D%A5%E5%AD%98%E6%94%BE%E8%BE%93%E5%87%BA%E4%BA%A4%E6%98%93%E3%80%82%E5%AE%83%E6%98%AF%E4%B8%80%E4%B8%AA%E5%AE%B9%E5%99%A8%E5%AF%B9%EF%BC%8C%E6%AF%8F%E4%B8%AA%E5%AF%B9%E7%94%B1%E4%B8%80%E4%B8%AA%E8%84%9A%E6%9C%AC%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%88opcodetype%E7%B1%BB%E5%9E%8B%EF%BC%89%E5%92%8C%E8%84%9A%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%85%83%EF%BC%88valtype%E7%B1%BB%E5%9E%8B%EF%BC%89%E6%9E%84%E6%88%90%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E8%AF%A5%E5%87%BD%E6%95%B0%E7%AC%AC8-10%E8%A1%8C%E9%A6%96%E5%85%88%E5%AE%9A%E4%B9%89%E4%B8%A4%E4%B8%AA%E6%A8%A1%E6%9D%BF%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%A8%A1%E6%9D%BFA%EF%BC%9AOP_DUP+OP_HASH160+OP_PUBKEYHASH+OP_EQUALVERIFY+OP_CHECKSIG%E3%80%82%0A++%3Cbr%3E+%E6%A8%A1%E6%9D%BFB%EF%BC%9AOP_PUBKEY+OP_CHECKSIG%E3%80%82%0A++%3Cbr%3E+%E5%BE%88%E6%98%8E%E6%98%BE%EF%BC%8C%E6%A8%A1%E6%9D%BFA%E3%80%81%E6%A8%A1%E6%9D%BFB%E4%B8%8E%E8%84%9A%E6%9C%ACA%E3%80%81%E8%84%9A%E6%9C%ACB%E7%9B%B8%E5%AF%B9%E5%BA%94%E3%80%82%E4%B8%BA%E4%BA%86%E4%BE%BF%E4%BA%8E%E5%AF%B9%E6%AF%94%EF%BC%8C%E4%BB%A5%E4%B8%8B%E6%98%AF%E8%84%9A%E6%9C%ACA%E5%92%8CB%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E8%84%9A%E6%9C%ACA%EF%BC%9AOP_DUP+OP_HASH160+%26lt%3B%E4%BD%A0%E7%9A%84%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B+OP_EQUALVERIFY+OP_CHECKSIG%E3%80%82%0A++%3Cbr%3E+%E8%84%9A%E6%9C%ACB%EF%BC%9A%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5%26gt%3B+OP_CHECKSIG%E3%80%82%0A++%3Cbr%3E+%E8%AF%A5%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E5%B0%86scriptPubKey%E4%B8%8E%E4%B8%A4%E4%B8%AA%E6%A8%A1%E6%9D%BF%E7%9B%B8%E6%AF%94%E8%BE%83%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E8%BE%93%E5%85%A5%E8%84%9A%E6%9C%AC%E4%B8%BA%E8%84%9A%E6%9C%ACA%EF%BC%8C%E5%88%99%E5%B0%86%E6%A8%A1%E6%9D%BFA%E4%B8%AD%E7%9A%84OP_PUBKEYHASH%E4%B8%8E%E8%84%9A%E6%9C%ACA%E4%B8%AD%E7%9A%84%26lt%3B%E4%BD%A0%E7%9A%84%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B%E9%85%8D%E5%AF%B9%EF%BC%8C%E5%B9%B6%E5%B0%86%E8%AF%A5%E5%AF%B9%E6%94%BE%E5%85%A5vSolutionRet%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E8%BE%93%E5%85%A5%E8%84%9A%E6%9C%AC%E4%B8%BA%E8%84%9A%E6%9C%ACB%EF%BC%8C%E5%88%99%E4%BB%8E%E6%A8%A1%E6%9D%BFB%E4%B8%AD%E6%8F%90%E5%8F%96%E8%BF%90%E7%AE%97%E7%AC%A6OP_PUBKEY%EF%BC%8C%E5%92%8C%E4%BB%8E%E8%84%9A%E6%9C%ACB%E4%B8%AD%E6%8F%90%E5%8F%96%E8%BF%90%E7%AE%97%E5%85%83%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5%26gt%3B%EF%BC%8C%E5%B0%86%E4%BA%8C%E8%80%85%E9%85%8D%E5%AF%B9%E5%B9%B6%E6%94%BE%E5%85%A5vSolutionRet%E3%80%82%0A++%3Cbr%3E+%E5%A6%82%E6%9E%9C%E8%BE%93%E5%85%A5%E8%84%9A%E6%9C%AC%E4%B8%8E%E4%B8%A4%E4%B8%AA%E6%A8%A1%E6%9D%BF%E5%9D%87%E4%B8%8D%E5%8C%B9%E9%85%8D%EF%BC%8C%E5%88%99%E8%BF%94%E5%9B%9Efalse%E3%80%82%0A++%3Cbr%3E+%E5%9B%9E%E5%88%B0Solver%28%29%0A++%3Cbr%3E+%E6%88%91%E4%BB%AC%E5%9B%9E%E5%88%B0%E6%9C%894%E4%B8%AA%E5%8F%82%E6%95%B0%E7%9A%84Solver%28%29%E5%B9%B6%E7%BB%A7%E7%BB%AD%E5%AF%B9%E8%AF%A5%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E3%80%82%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E6%B8%85%E6%A5%9A%E4%BA%86%E8%AF%A5%E5%87%BD%E6%95%B0%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E3%80%82%E5%AE%83%E4%BC%9A%E5%9C%A8%E4%B8%A4%E4%B8%AA%E5%88%86%E6%94%AF%E4%B8%AD%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%8F%96%E5%86%B3%E4%BA%8E%E4%BB%8EvSolutionRet%E5%BE%97%E5%88%B0%E7%9A%84%E5%AF%B9%E6%9D%A5%E8%87%AA%E8%84%9A%E6%9C%ACA%E8%BF%98%E6%98%AF%E8%84%9A%E6%9C%ACB%E3%80%82%E5%A6%82%E6%9E%9C%E6%9D%A5%E8%87%AA%E8%84%9A%E6%9C%ACA%EF%BC%8Citem.first+%26nbsp%3B%3D%3D+OP_PUBKEYHASH%EF%BC%9B%E5%A6%82%E6%9E%9C%E6%9D%A5%E8%87%AA%E8%84%9A%E6%9C%ACB%EF%BC%8Citem.first+%26nbsp%3B%3D%3D+OP_PUBKEY%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+item.first+%26nbsp%3B%3D%3D+OP_PUBKEY%EF%BC%88%E8%84%9A%E6%9C%ACB%EF%BC%89%E3%80%82%E5%9C%A8%E8%AF%A5%E6%83%85%E5%BD%A2%E4%B8%8B%EF%BC%8Citem.second%E5%8C%85%E5%90%AB%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5%26gt%3B%E3%80%82%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8FmapKeys%E5%B0%86%E4%BD%A0%E7%9A%84%E5%85%A8%E9%83%A8%E5%85%AC%E9%92%A5%E6%98%A0%E5%B0%84%E8%87%B3%E4%B8%8E%E4%B9%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E7%A7%81%E9%92%A5%E3%80%82%E5%A6%82%E6%9E%9CmapKeys%E5%BD%93%E4%B8%AD%E6%B2%A1%E6%9C%89%E8%AF%A5%E5%85%AC%E9%92%A5%EF%BC%8C%E5%88%99%E6%8A%A5%E9%94%99%EF%BC%88%E7%AC%AC16%E8%A1%8C%EF%BC%89%E3%80%82%E5%90%A6%E5%88%99%EF%BC%8C%E7%94%A8%E4%BB%8EmapKeys%E4%B8%AD%E6%8F%90%E5%8F%96%E5%87%BA%E7%9A%84%E7%A7%81%E9%92%A5%E7%AD%BE%E7%BD%B2%E6%96%B0%E7%94%9F%E6%88%90%E7%9A%84%E4%BA%A4%E6%98%93wtxNew%E7%9A%84%E5%93%88%E5%B8%8C%E5%80%BC%EF%BC%8C%E5%85%B6%E4%B8%AD%E5%93%88%E5%B8%8C%E5%80%BC%E4%BD%9C%E4%B8%BA%E7%AC%AC2%E4%B8%AA%E8%A2%AB%E4%BC%A0%E5%85%A5%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%88CKey%3A%3ASign%28mapKeys%5BvchPubKey%5D%2C+hash%2C+vchSig%29%EF%BC%8C%E7%AC%AC23%E8%A1%8C%EF%BC%89%EF%BC%8C%E5%86%8D%E5%B0%86%E7%BB%93%E6%9E%9C%E6%94%BE%E5%85%A5vchSig%EF%BC%8C%E6%8E%A5%E7%9D%80%E5%B0%86%E5%85%B6%E5%BA%8F%E5%88%97%E5%8C%96%E6%88%90scriptSigRet%EF%BC%88scriptSigRet+%26lt%3B%26lt%3B+vchSig%EF%BC%8C%E7%AC%AC24%E8%A1%8C%EF%BC%89%E5%B9%B6%E8%BF%94%E5%9B%9E%E3%80%82%0A++%3Cbr%3E+item.first+%26nbsp%3B%3D%3D+OP_PUBKEYHASH%EF%BC%88%E8%84%9A%E6%9C%ACA%EF%BC%89%E3%80%82%E5%9C%A8%E8%AF%A5%E6%83%85%E5%BD%A2%E4%B8%8B%EF%BC%8Citem.second%E5%8C%85%E5%90%AB%26lt%3B%E4%BD%A0%E7%9A%84%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B%E3%80%82%E8%AF%A5%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E5%9C%B0%E5%9D%80%E5%B0%86%E8%A2%AB%E7%94%A8%E4%BA%8E%E4%BB%8E%E4%BD%8D%E4%BA%8E%E7%AC%AC23%E8%A1%8C%E7%9A%84%E5%85%A8%E5%B1%80%E6%98%A0%E5%B0%84mapPubKeys%E4%B8%AD%E6%89%BE%E5%88%B0%E5%85%B6%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E5%85%AC%E9%92%A5%E3%80%82%E5%85%A8%E5%B1%80%E6%98%A0%E5%B0%84mapPubKeys%E5%B0%86%E4%BD%A0%E7%9A%84%E5%9C%B0%E5%9D%80%E4%B8%8E%E7%94%9F%E6%88%90%E5%AE%83%E4%BB%AC%E7%9A%84%E5%85%AC%E9%92%A5%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%80%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB%EF%BC%88%E6%9F%A5%E7%9C%8B%E5%87%BD%E6%95%B0AddKey%28%29%EF%BC%89%E3%80%82%E6%8E%A5%E7%9D%80%EF%BC%8C%E9%80%9A%E8%BF%87%E8%AF%A5%E5%85%AC%E9%92%A5%E4%BB%8EmapKeys%E4%B8%AD%E6%89%BE%E5%88%B0%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E7%A7%81%E9%92%A5%EF%BC%8C%E5%B9%B6%E7%94%A8%E8%AF%A5%E7%A7%81%E9%92%A5%E7%AD%BE%E7%BD%B2%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0hash%E3%80%82%E7%AD%BE%E5%90%8D%E5%92%8C%E5%85%AC%E9%92%A5%E5%B0%86%E4%B8%80%E5%90%8C%E8%A2%AB%E5%BA%8F%E5%88%97%E5%8C%96%E8%87%B3scriptSigRet%E5%B9%B6%E8%BF%94%E5%9B%9E%EF%BC%88scriptSig+%26lt%3B%26lt%3B+vchSig+%26lt%3B%26lt%3B+vchPubkey%EF%BC%8C%E7%AC%AC24%E8%A1%8C%EF%BC%89%E3%80%82%0A++%3Cbr%3E+EvalScript%28%29%0A++%3Cbr%3E+%E8%AF%A5%E6%96%B9%E6%B3%95%E4%BD%8D%E4%BA%8Escript.cpp%E3%80%82%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E5%9B%9E%E5%88%B0SignSignature%28%29%E3%80%82%E5%9C%A8%E8%AF%A5%E5%87%BD%E6%95%B0%E7%9A%84%E7%AC%AC12%E8%A1%8C%E4%B9%8B%E5%90%8E%EF%BC%8Ctxin.scriptsig%EF%BC%8C%E5%8D%B3wtxNew%E7%9A%84%E7%AC%ACnIn%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E4%B8%AD%E7%9A%84scriptSig%E9%83%A8%E5%88%86%EF%BC%8C%E5%B0%86%E6%8F%92%E5%85%A5%E4%B8%80%E4%B8%AA%E7%AD%BE%E5%90%8D%E3%80%82%E8%AF%A5%E7%AD%BE%E5%90%8D%E5%8F%AF%E8%83%BD%E6%98%AF%E4%BB%A5%E4%B8%8B%E5%85%B6%E4%B8%AD%E4%B9%8B%E4%B8%80%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+vchSig+vchPubKey%EF%BC%88%E8%84%9A%E6%9C%ACA%E7%9A%84%E7%AD%BE%E5%90%8DA%EF%BC%89%0A++%3Cbr%3E+vchSig%EF%BC%88%E8%84%9A%E6%9C%ACB%E7%9A%84%E7%AD%BE%E5%90%8DB%EF%BC%89%0A++%3Cbr%3E+%E5%9C%A8%E4%B8%8B%E6%96%87%E5%BD%93%E4%B8%AD%EF%BC%8CvchSig%E5%B0%86%E8%A2%AB%E5%BC%95%E7%94%A8%E4%B8%BA%26lt%3B%E4%BD%A0%E7%9A%84%E7%AD%BE%E5%90%8D_vchSig%26gt%3B%EF%BC%8CvchPubKey%E5%88%99%E4%B8%BA%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5_vchPubKey%26gt%3B%EF%BC%8C%E4%BB%A5%E5%BC%BA%E8%B0%83%E5%AE%83%E4%BB%AC%E5%88%86%E5%88%AB%E6%98%AF%E4%BD%A0%E6%9C%AC%E4%BA%BA%E7%9A%84%E7%AD%BE%E5%90%8D%E5%92%8C%E5%85%AC%E9%92%A5%E3%80%82%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E6%88%91%E4%BB%AC%E7%8E%B0%E5%9C%A8%E5%BC%80%E5%A7%8B%E8%B0%83%E6%9F%A5EvalScript%28%29%EF%BC%8C%E8%AF%A5%E5%87%BD%E6%95%B0%E6%98%AFSignSignature%28%29%E8%B0%83%E7%94%A8%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%8C%E4%BD%8D%E4%BA%8E%E7%AC%AC15%E8%A1%8C%E3%80%82EvalScript%28%29%E5%B8%A6%E6%9C%893%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%8C%E5%88%86%E5%88%AB%E4%B8%BA%EF%BC%9A%0A++%3Cbr%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%E4%B8%BAtxin.scriptSig+%2B+CScript%28OP_CODESEPARATOR%29+%2B+txout.scriptPubKey%E3%80%82%E5%AE%83%E6%9C%89%E5%8F%AF%E8%83%BD%E6%98%AF%EF%BC%9A%0A++%3Cbr%3E+%E9%AA%8C%E8%AF%81%E6%83%85%E5%BD%A2A%EF%BC%9A%26lt%3B%E4%BD%A0%E7%9A%84%E7%AD%BE%E5%90%8D_vchSig%26gt%3B+%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5_vchPubKey%26gt%3B+OP_CODESEPARATOR+OP_DUP+OP_HASH160+%26lt%3B%E4%BD%A0%E7%9A%84%E5%9C%B0%E5%9D%80160%E4%BD%8D%E5%93%88%E5%B8%8C%26gt%3B+OP_EQUALVERIFY+OP_CHECKSIG%EF%BC%8C%E5%8D%B3%E7%AD%BE%E5%90%8DA+%2B+OP_CODESEPARATOR+%2B+%E8%84%9A%E6%9C%ACA%E3%80%82%0A++%3Cbr%3E+%E9%AA%8C%E8%AF%81%E6%83%85%E5%BD%A2B%EF%BC%9A%26lt%3B%E4%BD%A0%E7%9A%84%E7%AD%BE%E5%90%8D_vchSig%26gt%3B+OP_CODESEPARATOR+%26lt%3B%E4%BD%A0%E7%9A%84%E5%85%AC%E9%92%A5_vchPubKey%26gt%3B+OP_CHECKSIG%EF%BC%8C%E5%8D%B3%E7%AD%BE%E5%90%8DB+%2B+OP_CODESEPARATOR+%2B+%E8%84%9A%E6%9C%ACB%E3%80%82%0A++%3Cbr%3E+%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0%E4%B8%BA%E6%96%B0%E5%88%9B%E5%BB%BA%E7%9A%84%E4%BA%A4%E6%98%93txTo%EF%BC%8C%E5%8D%B3CreateTransaction%28%29%E4%B8%AD%E7%9A%84wtxNew%E3%80%82%0A++%3Cbr%3E+%E7%AC%AC%E4%B8%89%E4%B8%AA%E5%8F%82%E6%95%B0%E4%B8%BAnIn%EF%BC%8C%E5%8D%B3%E5%B0%86%E8%A2%AB%E9%AA%8C%E8%AF%81%E7%9A%84%E4%BA%A4%E6%98%93%E5%9C%A8txTo%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E5%88%97%E8%A1%A8%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE%E3%80%82%0A++%3Cbr%3E+%E9%AA%8C%E8%AF%81%E8%BF%87%E7%A8%8B%E6%88%91%E4%BB%AC%E4%BC%9A%E5%9C%A8%E5%90%8E%E9%9D%A2%E8%AF%A6%E7%BB%86%E8%AE%B2%E8%BF%B0%E3%80%82%E7%AE%80%E5%8D%95%E5%9C%B0%E8%AF%B4%EF%BC%8CEvalScript%28%29%E9%AA%8C%E8%AF%81%E6%96%B0%E5%88%9B%E5%BB%BA%E4%BA%A4%E6%98%93wtxNew%E7%9A%84%E7%AC%ACnIn%E7%AC%94%E8%BE%93%E5%85%A5%E4%BA%A4%E6%98%93%E6%98%AF%E5%90%A6%E5%8C%85%E5%90%AB%E6%9C%89%E6%95%88%E7%9A%84%E7%AD%BE%E5%90%8D%E3%80%82%E8%87%B3%E6%AD%A4%EF%BC%8C%E4%B8%80%E7%AC%94%E6%96%B0%E7%9A%84%E4%BB%A5%E5%A4%AA%E5%9D%8A%E4%BB%A3%E5%B8%81%E5%BC%80%E5%8F%91%E4%BA%A4%E6%98%93%E4%BE%BF%E5%88%9B%E5%BB%BA%E5%AE%8C%E6%88%90%E3%80%82+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2FjQQ53016353%2Farticle%2Fdetails%2F78580207%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2FjQQ53016353%2Farticle%2Fdetails%2F78580207%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E+%0A%3Cscript%3E%0A%09%09%09%09%09%09%28function%28%29%7B%0A%09%09%09%09%09%09%09function+setArticleH%28btnReadmore%2Cposi%29%7B%0A%09%09%09%09%09%09%09%09var+winH+%3D+%24%28window%29.height%28%29%3B%0A%09%09%09%09%09%09%09%09var+articleBox+%3D+%24%28%22div.article_content%22%29%3B%0A%09%09%09%09%09%09%09%09var+artH+%3D+articleBox.height%28%29%3B%0A%09%09%09%09%09%09%09%09if%28artH+%3E+winH*posi%29%7B%0A%09%09%09%09%09%09%09%09%09articleBox.css%28%7B%0A%09%09%09%09%09%09%09%09%09%09%27height%27%3AwinH*posi%2B%27px%27%2C%0A%09%09%09%09%09%09%09%09%09%09%27overflow%27%3A%27hidden%27%0A%09%09%09%09%09%09%09%09%09%7D%29%0A%09%09%09%09%09%09%09%09%09btnReadmore.click%28function%28%29%7B%0A%09%09%09%09%09%09%09%09%09%09articleBox.removeAttr%28%22style%22%29%3B%0A%09%09%09%09%09%09%09%09%09%09%24%28this%29.parent%28%29.remove%28%29%3B%0A%09%09%09%09%09%09%09%09%09%7D%29%0A%09%09%09%09%09%09%09%09%7Delse%7B%0A%09%09%09%09%09%09%09%09%09btnReadmore.parent%28%29.remove%28%29%3B%0A%09%09%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09%09var+btnReadmore+%3D+%24%28%22%23btn-readmore%22%29%3B%0A%09%09%09%09%09%09%09if%28btnReadmore.length%3E0%29%7B%0A%09%09%09%09%09%09%09%09if%28currentUserName%29%7B%0A%09%09%09%09%09%09%09%09%09setArticleH%28btnReadmore%2C3%29%3B%0A%09%09%09%09%09%09%09%09%7Delse%7B%0A%09%09%09%09%09%09%09%09%09setArticleH%28btnReadmore%2C1.2%29%3B%0A%09%09%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09%09%7D%0A%09%09%09%09%09%09%7D%29%28%29%0A%09%09%09%09%09%3C%2Fscript%3E" | url_decode}}