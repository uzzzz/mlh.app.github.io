---
layout: default
title: Logistic Regression作为二分类器的手写代码 vs 调用sklearn库
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22article-copyright%22%3E%0A+++%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%EF%BC%9A%E6%9C%AC%E6%96%87%E4%B8%BA%E5%8D%9A%E4%B8%BB%E5%8E%9F%E5%88%9B%E6%96%87%E7%AB%A0%EF%BC%8C%E6%9C%AA%E7%BB%8F%E5%8D%9A%E4%B8%BB%E5%85%81%E8%AE%B8%E4%B8%8D%E5%BE%97%E8%BD%AC%E8%BD%BD%E3%80%82+https%3A%2F%2Fblog.csdn.net%2FTriple_WDF%2Farticle%2Fdetails%2F87640069+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp%3ELogistic+Regression%E7%90%86%E8%AE%BA%E6%8E%A8%E5%AF%BC%EF%BC%9A%3Ca+href%3D%22https%3A%2F%2Fblog.csdn.net%2FTriple_WDF%2Farticle%2Fdetails%2F87555153%22+rel%3D%22nofollow%22%3ELogistic+Regression%E8%AF%A6%E7%BB%86%E5%89%96%E6%9E%90%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3ELogistic+Regression+%E4%BA%8C%E5%88%86%E7%B1%BB%E5%99%A8%3C%2Fp%3E+%0A++%3Cp%3E%E6%9C%AC%E6%96%87%E5%B1%95%E7%A4%BA%E4%B8%A4%E7%A7%8D%E4%BB%A3%E7%A0%81%EF%BC%9A%E6%9C%AC%E4%BA%BA%E6%89%8B%E5%86%99%E7%9A%84logistic+regression%E4%BB%A3%E7%A0%81%EF%BC%8C%E4%B8%8E%E8%B0%83%E7%94%A8sklearn%E5%BA%93%E4%B8%AD%E7%9A%84logistic+regression%E4%BB%A3%E7%A0%81%3C%2Fp%3E+%0A++%3Cp%3E%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode%3E-0.017612%0914.053064%090%0A-1.395634%094.662541%091%0A-0.752157%096.538620%090%0A-1.322371%097.152853%090%0A0.423363%0911.054677%090%0A0.406704%097.067335%091%0A0.667394%0912.741452%090%0A-2.460150%096.866805%091%0A0.569411%099.548755%090%0A-0.026632%0910.427743%090%0A0.850433%096.920334%091%0A1.347183%0913.175500%090%0A1.176813%093.167020%091%0A-1.781871%099.097953%090%0A-0.566606%095.749003%091%0A0.931635%091.589505%091%0A-0.024205%096.151823%091%0A-0.036453%092.690988%091%0A-0.196949%090.444165%091%0A1.014459%095.754399%091%0A1.985298%093.230619%091%0A-1.693453%09-0.557540%091%0A-0.576525%0911.778922%090%0A-0.346811%09-1.678730%091%0A-2.124484%092.672471%091%0A1.217916%099.597015%090%0A-0.733928%099.098687%090%0A-3.642001%09-1.618087%091%0A0.315985%093.523953%091%0A1.416614%099.619232%090%0A-0.386323%093.989286%091%0A0.556921%098.294984%091%0A1.224863%0911.587360%090%0A-1.347803%09-2.406051%091%0A1.196604%094.951851%091%0A0.275221%099.543647%090%0A0.470575%099.332488%090%0A-1.889567%099.542662%090%0A-1.527893%0912.150579%090%0A-1.185247%0911.309318%090%0A-0.445678%093.297303%091%0A1.042222%096.105155%091%0A-0.618787%0910.320986%090%0A1.152083%090.548467%091%0A0.828534%092.676045%091%0A-1.237728%0910.549033%090%0A-0.683565%09-2.166125%091%0A0.229456%095.921938%091%0A-0.959885%0911.555336%090%0A0.492911%0910.993324%090%0A0.184992%098.721488%090%0A-0.355715%0910.325976%090%0A-0.397822%098.058397%090%0A0.824839%0913.730343%090%0A1.507278%095.027866%091%0A0.099671%096.835839%091%0A-0.344008%0910.717485%090%0A1.785928%097.718645%091%0A-0.918801%0911.560217%090%0A-0.364009%094.747300%091%0A-0.841722%094.119083%091%0A0.490426%091.960539%091%0A-0.007194%099.075792%090%0A0.356107%0912.447863%090%0A0.342578%0912.281162%090%0A-0.810823%09-1.466018%091%0A2.530777%096.476801%091%0A1.296683%0911.607559%090%0A0.475487%0912.040035%090%0A-0.783277%0911.009725%090%0A0.074798%0911.023650%090%0A-1.337472%090.468339%091%0A-0.102781%0913.763651%090%0A-0.147324%092.874846%091%0A0.518389%099.887035%090%0A1.015399%097.571882%090%0A-1.658086%09-0.027255%091%0A1.319944%092.171228%091%0A2.056216%095.019981%091%0A-0.851633%094.375691%091%0A-1.510047%096.061992%090%0A-1.076637%09-3.181888%091%0A1.821096%0910.283990%090%0A3.010150%098.401766%091%0A-1.099458%091.688274%091%0A-0.834872%09-1.733869%091%0A-0.846637%093.849075%091%0A1.400102%0912.628781%090%0A1.752842%095.468166%091%0A0.078557%090.059736%091%0A0.089392%09-0.715300%091%0A1.825662%0912.693808%090%0A0.197445%099.744638%090%0A0.126117%090.922311%091%0A-0.679797%091.220530%091%0A0.677983%092.556666%091%0A0.761349%0910.693862%090%0A-2.168791%090.143632%091%0A1.388610%099.341997%090%0A0.317029%0914.739025%090%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E9%A6%96%E5%85%88%E6%98%AF%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E7%AE%97%E6%B3%95%E6%96%87%E4%BB%B6%EF%BC%9Afilename%EF%BC%9Alogistic_regression.py%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Eimport+numpy+as+np%0Adef+sigmoid%28x%29%3A%0A++++return+1.0+%2F+%281+%2B+np.exp%28-x%29%29%0A%0Adef+gradientDescent%28x%2C+y%2C+theta%2C+alpha%2C+m%2C+numIterations%29%3A%0A++++xTrans+%3D+x.transpose%28%29%0A++++for+i+in+range%280%2C+numIterations%29%3A%0A++++++++hypothesis+%3D+sigmoid%28np.dot%28x%2C+theta%29%29%0A++++++++loss+%3D+hypothesis+-+y%0A++++++++gradient+%3D+np.dot%28xTrans%2C+loss%29+%2F+m%0A++++++++theta+%3D+theta+-+alpha+*+gradient%0A++++return+theta%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E5%85%B6%E6%AC%A1%E6%98%AF%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E9%87%8C%E9%80%89%E5%8F%96%E4%BA%86%E5%89%8D70%E4%B8%AA%E6%A0%B7%E4%BE%8B%E4%BD%9C%E4%B8%BA%E8%AE%AD%E7%BB%83%E9%9B%86%EF%BC%8C%E5%90%8E30%E4%B8%AA%E4%BD%9C%E4%B8%BA%E6%B5%8B%E8%AF%95%E9%9B%86%EF%BC%9Afilename%EF%BC%9ALoadDataSet.py%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Eimport+numpy+as+np%0Aimport+os%0A%0Adef+loadDataset%28filepath%29%3A%0A++++train_dataMat+%3D+%5B%5D%0A++++train_labelMat+%3D+%5B%5D%0A++++test_dataMat+%3D+%5B%5D%0A++++test_labelMat+%3D+%5B%5D%0A%0A++++f+%3D+open%28filepath%29%0A++++index+%3D+0%0A++++line+%3D+f.readline%28%29%0A++++while+index+%26lt%3B+70%3A%0A++++++++lineArr+%3D+line.strip%28%29.split%28%29%0A++++++++train_dataMat.append%28%5B1.0%2C+float%28lineArr%5B0%5D%29%2C+float%28lineArr%5B1%5D%29%5D%29%0A++++++++train_labelMat.append%28int%28lineArr%5B2%5D%29%29%0A++++++++line+%3D+f.readline%28%29%0A++++++++index+%2B%3D+1%0A++++while+line%3A%0A++++++++lineArr+%3D+line.strip%28%29.split%28%29%0A++++++++test_dataMat.append%28%5B1.0%2C+float%28lineArr%5B0%5D%29%2C+float%28lineArr%5B1%5D%29%5D%29%0A++++++++test_labelMat.append%28int%28lineArr%5B2%5D%29%29%0A++++++++line+%3D+f.readline%28%29%0A++++%23%E5%A6%82%E6%9E%9C%E6%98%AF%E6%89%8B%E5%86%99LR%E4%BD%BF%E7%94%A8%E4%B8%8B%E9%9D%A2%E7%9A%84return%0A++++%23return+np.mat%28train_dataMat%29%2C+np.mat%28train_labelMat%29%2C+test_dataMat%2C+test_labelMat%0A++++%23%E5%A6%82%E6%9E%9C%E6%98%AFsklearn%E5%BA%93%E4%BD%BF%E7%94%A8%E4%B8%8B%E9%9D%A2%E7%9A%84return%0A++++%23return+train_dataMat%2C+train_labelMat%2C+test_dataMat%2C+test_labelMat%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E6%98%AF%E6%89%8B%E5%86%99Logistics+Regression%E7%9A%84%E4%BA%8C%E5%88%86%E7%B1%BB%E5%99%A8%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Eimport+numpy+as+np%0Afrom+LoadDataSet+import+loadDataset%0Afrom+logistic_regression+import+gradientDescent%0A%0Atrain_dataMat%2C+train_labelMat%2C+test_dataMat%2C+test_labelMat+%3D+loadDataset%28%27I%3A%5Cwangpengfei-D%5CDataSet%5C%5Ctwo_classier%5C%5CtestSet.txt%27%29%0Amtrain%2C+ntrain+%3D+np.shape%28train_dataMat%29%0Amtest%2C+ntest+%3D+np.shape%28test_dataMat%29%0AnumIterations+%3D+100000+%23%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E7%9A%84%E6%AC%A1%E6%95%B0%0Aalpha+%3D+0.0005+%23%E6%AF%8F%E4%B8%80%E6%AC%A1%E7%9A%84%E4%B8%8B%E9%99%8D%E6%AD%A5%E9%95%BF%0Atheta+%3D+np.ones%28shape%3D%28ntrain%2C+1%29%29+%23%E5%8F%82%E6%95%B0%CE%B8%0Atheta+%3D+gradientDescent%28train_dataMat%2C+train_labelMat.transpose%28%29%2Ctheta%2C+alpha%2C+mtrain%2C+numIterations%29+%23%E8%BF%94%E5%9B%9E%E8%AE%AD%E7%BB%83%E5%AE%8C%E6%AF%95%E7%9A%84%E5%8F%82%E6%95%B0%CE%B8%0Ay_hat+%3D+np.dot%28test_dataMat%2C+theta%29+%23%E5%BE%97%E5%88%B0%E4%BC%B0%E8%AE%A1%E7%9A%84%E7%BB%93%E6%9E%9C%E4%BF%9D%E5%AD%98%E5%88%B0y_hat%E4%B8%AD%0A%0Amark+%3D+%5B%5D%0Afor+i+in+range%2830%29%3A%0A++++res+%3D+sigmoid%28y_hat%5Bi%5D%29%0A++++if+res+%26gt%3B+0.5%3A%0A++++++++mark.append%281%29%0A++++else%3A%0A++++++++mark.append%280%29%0Aprint+%28%27predic+result%3A%27%2Cmark%29%0Aprint+%28%27real+result%3A++%27%2C+test_labelMat%29%0Aright_sum+%3D+0%3B%0Afor+i+in+range%2830%29%3A%0A++++if+mark%5Bi%5D+%3D%3D+test_labelMat%5Bi%5D%3A%0A++++++++right_sum+%2B%3D+1%0Aprint+%28%22right+number%3A+%25d%2C+right+rate%3A+%25lf%22+%25%28right_sum%2C+right_sum*1.0%2F30%29%29%0A%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E6%AD%A4%E6%97%B6%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E7%BB%93%E6%9E%9C%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2265%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190218192640673.png%22+width%3D%221021%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%98%AF%E8%B0%83%E7%94%A8sklearn%E5%BA%93%E7%9A%84%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Efrom+sklearn+import+linear_model%2C+datasets%0Afrom+LoadDataSet+import+loadDataset%0Aimport+numpy+as+np%0A%0Atrain_dataMat%2C+train_labelMat%2C+test_dataMat%2C+test_labelMat+%3D+loadDataset%28%27I%3A%5Cwangpengfei-D%5CDataSet%5C%5Ctwo_classier%5C%5CtestSet.txt%27%29%0Aprint+%28train_dataMat%29%0Aprint+%28test_dataMat%29%0Alogreg+%3D+linear_model.LogisticRegression%28solver%3D%27liblinear%27%29%0Aa+%3D+logreg.fit%28train_dataMat%2C+train_labelMat%29%0Ay_hat+%3D+logreg.predict%28test_dataMat%29%0Aprint+%28%27predic+result%3A%27%2C+np.array%28y_hat%29%29%0Aprint+%28%27real+++result%3A%27%2C+test_labelMat%29%0Ascore+%3D+0%0Afor+i+in+range%2830%29%3A%0A++++if+y_hat%5Bi%5D+%3D%3D+test_labelMat%5Bi%5D%3A%0A++++++++score+%2B%3D+1%0Aprint+%28%27right+num+%3D+%25d+right+rate+%3D+%25f%27+%25%28score%2C+score*1.0%2F30%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E5%85%B6%E7%BB%93%E6%9E%9C%E8%BF%90%E8%A1%8C%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2284%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190218193018159.png%22+width%3D%221027%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%E4%BA%8C%E8%80%85%E7%BB%93%E6%9E%9C%E4%B8%80%E8%87%B4%EF%BC%8C%E5%B0%B1%E8%BF%9E%E9%94%99%E7%9A%84%E6%A0%B7%E4%BE%8B%E9%83%BD%E4%B8%80%E8%87%B4%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}