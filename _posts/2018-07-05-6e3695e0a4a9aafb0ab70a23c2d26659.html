---
layout: default
title: 生成比特币创世块C/C++源代码
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22markdown_views%22%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+cpp%22%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bstdlib.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bstdio.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bstdbool.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Binttypes.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bctype.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bstring.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Btime.h%26gt%3B%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-preprocessor%22%3E%23include+%26lt%3Bopenssl%2Fsha.h%26gt%3B%3C%2Fspan%3E%0A%0A%3Cspan+class%3D%22hljs-comment%22%3E%2F%2FCopied+from+Bitcoin+source%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E+uint64_t+COIN+%3D+%3Cspan+class%3D%22hljs-number%22%3E100000000%3C%2Fspan%3E%3B%0A%3Cspan+class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E+uint64_t+CENT+%3D+%3Cspan+class%3D%22hljs-number%22%3E1000000%3C%2Fspan%3E%3B%0A%0Auint32_t+OP_CHECKSIG+%3D+%3Cspan+class%3D%22hljs-number%22%3E172%3C%2Fspan%3E%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+This+is+expressed+as+0xAC%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-keyword%22%3Ebool%3C%2Fspan%3E+generateBlock+%3D+%3Cspan+class%3D%22hljs-keyword%22%3Efalse%3C%2Fspan%3E%3B%0Auint32_t+startNonce+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0Auint32_t+unixtime+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A%0A%3Cspan+class%3D%22hljs-keyword%22%3Etypedef%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Estruct%3C%2Fspan%3E+%7B%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F*+Hash+of+Tx+*%2F%3C%2Fspan%3E%0A++++uint8_t+merkleHash%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F*+Tx+serialization+before+hashing+*%2F%3C%2Fspan%3E%0A++++uint8_t+*serializedData%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F*+Tx+version+*%2F%3C%2Fspan%3E%0A++++uint32_t+version%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F*+Input+*%2F%3C%2Fspan%3E%0A++++uint8_t+numInputs%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Program+assumes+one+input%3C%2Fspan%3E%0A++++uint8_t+prevOutput%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%3B%0A++++uint32_t+prevoutIndex%3B%0A++++uint8_t+*scriptSig%3B%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+nBitsLen+%2B+nBits+%2B+0x01+%2B+0x04+%2B+ScriptSig_len+%2B+timestamp%3C%2Fspan%3E%0A++++uint32_t+sequence%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F*+Output+*%2F%3C%2Fspan%3E%0A++++uint8_t+numOutputs%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Program+assumes+one+output%3C%2Fspan%3E%0A++++uint64_t+outValue%3B%0A++++uint8_t+*pubkeyScript%3B%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F0x41+%2B+pubkey+%2B+OP_CHECKSIG%3C%2Fspan%3E%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F*+Final+*%2F%3C%2Fspan%3E%0A++++uint32_t+locktime%3B%0A%7D+Transaction%3B%0A%0A%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Got+this+off+the+internet.+Am+not+sure+if+it+can+fail+in+some+circumstances%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-keyword%22%3Evoid%3C%2Fspan%3E+byteswap%28uint8_t+*buf%2C+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+length%29%0A%7B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+i%3B%0A++++uint8_t+temp%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Efor%3C%2Fspan%3E+%28i+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B+i+%26lt%3B+length+%2F+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%3B+i%2B%2B%29%0A++++%7B%0A++++++++temp+%3D+buf%5Bi%5D%3B%0A++++++++buf%5Bi%5D+%3D+buf%5Blength+-+i+-+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D%3B%0A++++++++buf%5Blength+-+i+-+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D+%3D+temp%3B%0A++++%7D%0A%7D%0A%0A%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Following+two+functions+are+borrowed+from+cgminer.%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*bin2hex%28%3Cspan+class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*p%2C+size_t+len%29%0A%7B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*s+%3D+%28%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E*%29%3Cspan+class%3D%22hljs-built_in%22%3Emalloc%3C%2Fspan%3E%28%28len+*+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%29+%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+i%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21s%29%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+NULL%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Efor%3C%2Fspan%3E+%28i+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B+i+%26lt%3B+len%3B+i%2B%2B%29%0A++++++++sprintf_s%28s+%2B+%28i+*+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%29%2C+%3Cspan+class%3D%22hljs-number%22%3E3%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-string%22%3E%22%2502x%22%3C%2Fspan%3E%2C+%28%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E%29p%5Bi%5D%29%3B%0A%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+s%3B%0A%7D%0A%0Asize_t+hex2bin%28%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*p%2C+%3Cspan+class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*hexstr%2C+size_t+len%29%0A%7B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+ret+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++size_t+retlen+%3D+len%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ewhile%3C%2Fspan%3E+%28*hexstr+%26amp%3B%26amp%3B+len%29+%7B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+hex_byte%5B%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%5D%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+v%3B%0A%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21hexstr%5B%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D%29+%7B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+ret%3B%0A++++++++%7D%0A%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememset%3C%2Fspan%3E%28hex_byte%2C+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++++++hex_byte%5B%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%5D+%3D+hexstr%5B%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%5D%3B%0A++++++++hex_byte%5B%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D+%3D+hexstr%5B%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D%3B%0A%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28sscanf_s%28hex_byte%2C+%3Cspan+class%3D%22hljs-string%22%3E%22%25x%22%3C%2Fspan%3E%2C+%26amp%3Bv%29+%21%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29+%7B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+ret%3B%0A++++++++%7D%0A%0A++++++++*p+%3D+%28%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E%29v%3B%0A%0A++++++++p%2B%2B%3B%0A++++++++hexstr+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%3B%0A++++++++len--%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28len+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E+%26amp%3B%26amp%3B+*hexstr+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29%0A++++++++ret+%3D+retlen%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+ret%3B%0A%7D%0A%0ATransaction+*InitTransaction%28%29%0A%7B%0A++++Transaction+*transaction%3B%0A%0A++++transaction+%3D+%28Transaction+*%29%3Cspan+class%3D%22hljs-built_in%22%3Ecalloc%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28*transaction%29%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21transaction%29%0A++++%7B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+NULL%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Set+some+initial+data+that+will+remain+constant+throughout+the+program%3C%2Fspan%3E%0A++++transaction-%26gt%3Bversion+%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BnumInputs+%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BnumOutputs+%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3Blocktime+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BprevoutIndex+%3D+%3Cspan+class%3D%22hljs-number%22%3E0xFFFFFFFF%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3Bsequence+%3D+%3Cspan+class%3D%22hljs-number%22%3E0xFFFFFFFF%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BoutValue+%3D+%3Cspan+class%3D%22hljs-number%22%3E50%3C%2Fspan%3E+*+COIN%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+We+initialize+the+previous+output+to+0+as+there+is+none%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememset%3C%2Fspan%3E%28transaction-%26gt%3BprevOutput%2C+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+transaction%3B%0A%7D%0A%0A%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%9A.%2Fgenesisgen+%5BPubKey%5D+%5BTimeStamp%5D+%5BnBits%5D%3C%2Fspan%3E%0A%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+main%28%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+argc%2C+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*argv%5B%5D%29%0A%7B%0A++++Transaction+*transaction%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+hash1%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%2C+hash2%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+timestamp%5B%3Cspan+class%3D%22hljs-number%22%3E255%3C%2Fspan%3E%5D%2C+pubkey%5B%3Cspan+class%3D%22hljs-number%22%3E132%3C%2Fspan%3E%5D%3B%0A++++uint32_t+timestamp_len+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+scriptSig_len+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+pubkey_len+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+pubkeyScript_len+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++uint32_t+nBits+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%28argc+-+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29+%26lt%3B+%3Cspan+class%3D%22hljs-number%22%3E3%3C%2Fspan%3E%29%0A++++%7B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Efprintf%3C%2Fspan%3E%28stderr%2C+%3Cspan+class%3D%22hljs-string%22%3E%22Usage%3A+genesisgen+%5Boptions%5D+%26lt%3Bpubkey%26gt%3B+%5C%22%26lt%3Btimestamp%26gt%3B%5C%22+%26lt%3BnBits%26gt%3B%5Cn%22%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++pubkey_len+%3D+%3Cspan+class%3D%22hljs-built_in%22%3Estrlen%3C%2Fspan%3E%28argv%5B%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D%29+%2F+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+One+byte+is+represented+as+two+hex+characters%2C+thus+we+divide+by+two+to+get+real+length.%3C%2Fspan%3E%0A++++timestamp_len+%3D+%3Cspan+class%3D%22hljs-built_in%22%3Estrlen%3C%2Fspan%3E%28argv%5B%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%5D%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28pubkey_len+%21%3D+%3Cspan+class%3D%22hljs-number%22%3E65%3C%2Fspan%3E%29%0A++++%7B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Efprintf%3C%2Fspan%3E%28stderr%2C+%3Cspan+class%3D%22hljs-string%22%3E%22Invalid+public+key+length%21+%25s%5Cn%22%3C%2Fspan%3E%2C+argv%5B%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28timestamp_len+%26gt%3B+%3Cspan+class%3D%22hljs-number%22%3E254%3C%2Fspan%3E+%7C%7C+timestamp_len+%26lt%3B%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29%0A++++%7B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Efprintf%3C%2Fspan%3E%28stderr%2C+%3Cspan+class%3D%22hljs-string%22%3E%22Size+of+timestamp+is+0+or+exceeds+maximum+length+of+254+characters%21%5Cn%22%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++transaction+%3D+InitTransaction%28%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21transaction%29%0A++++%7B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Efprintf%3C%2Fspan%3E%28stderr%2C+%3Cspan+class%3D%22hljs-string%22%3E%22Could+not+allocate+memory%21+Exiting...%5Cn%22%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++strncpy_s%28pubkey%2C+argv%5B%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D%2C+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28pubkey%29%29%3B%0A++++strncpy_s%28timestamp%2C+argv%5B%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%5D%2C+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28timestamp%29%29%3B%0A++++sscanf_s%28argv%5B%3Cspan+class%3D%22hljs-number%22%3E3%3C%2Fspan%3E%5D%2C+%3Cspan+class%3D%22hljs-string%22%3E%22%25lu%22%3C%2Fspan%3E%2C+%28%3Cspan+class%3D%22hljs-keyword%22%3Elong%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+*%29%26amp%3BnBits%29%3B%0A%0A++++pubkey_len+%3D+%3Cspan+class%3D%22hljs-built_in%22%3Estrlen%3C%2Fspan%3E%28pubkey%29+%26gt%3B%26gt%3B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++scriptSig_len+%3D+timestamp_len%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Encode+pubkey+to+binary+and+prepend+pubkey+size%2C+then+append+the+OP_CHECKSIG+byte%3C%2Fspan%3E%0A++++transaction-%26gt%3BpubkeyScript+%3D+%28uint8_t*%29%3Cspan+class%3D%22hljs-built_in%22%3Emalloc%3C%2Fspan%3E%28%28pubkey_len+%2B+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%29+*+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28uint8_t%29%29%3B%0A++++pubkeyScript_len+%3D+hex2bin%28transaction-%26gt%3BpubkeyScript+%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%2C+pubkey%2C+pubkey_len%29%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+No+error+checking%2C+yeah.%3C%2Fspan%3E%0A++++transaction-%26gt%3BpubkeyScript%5B%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x41%3C%2Fspan%3E%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+A+public+key+is+32+bytes+X+coordinate%2C+32+bytes+Y+coordinate+and+one+byte+0x04%2C+so+65+bytes+i.e+0x41+in+Hex.%3C%2Fspan%3E%0A++++pubkeyScript_len+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BpubkeyScript%5BpubkeyScript_len%2B%2B%5D+%3D+OP_CHECKSIG%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Encode+timestamp+to+binary%3C%2Fspan%3E%0A++++transaction-%26gt%3BscriptSig+%3D+%28uint8_t*%29%3Cspan+class%3D%22hljs-built_in%22%3Emalloc%3C%2Fspan%3E%28scriptSig_len+*+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28uint8_t%29%29%3B%0A++++uint32_t+scriptSig_pos+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+This+is+basically+how+I+believe+the+size+of+the+nBits+is+calculated%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28nBits+%26lt%3B%3D+%3Cspan+class%3D%22hljs-number%22%3E255%3C%2Fspan%3E%29%0A++++%7B%0A++++++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x01%3C%2Fspan%3E%3B%0A++++++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%28uint8_t%29nBits%3B%0A++++%7D%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28nBits+%26lt%3B%3D+%3Cspan+class%3D%22hljs-number%22%3E65535%3C%2Fspan%3E%29%0A++++%7B%0A++++++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x02%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BscriptSig+%2B+scriptSig_pos%2C+%26amp%3BnBits%2C+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%29%3B%0A++++++++scriptSig_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%3B%0A++++%7D%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28nBits+%26lt%3B%3D+%3Cspan+class%3D%22hljs-number%22%3E16777215%3C%2Fspan%3E%29%0A++++%7B%0A++++++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x03%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BscriptSig+%2B+scriptSig_pos%2C+%26amp%3BnBits%2C+%3Cspan+class%3D%22hljs-number%22%3E3%3C%2Fspan%3E%29%3B%0A++++++++scriptSig_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E3%3C%2Fspan%3E%3B%0A++++%7D%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2Felse+if%28nBits+%26lt%3B%3D+4294967296LL%29%3C%2Fspan%3E%0A++++%7B%0A++++++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x04%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BscriptSig+%2B+scriptSig_pos%2C+%26amp%3BnBits%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++++++scriptSig_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%3B%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Important%21+In+the+Bitcoin+code+there+is+a+statement+%27CBigNum%284%29%27+%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+i%27ve+been+wondering+for+a+while+what+it+is+but%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+seeing+as+alt-coins+keep+it+the+same%2C+we%27ll+do+it+here+as+well%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+It+should+essentially+mean+PUSH+1+byte+on+the+stack+which+in+this+case+is+0x04+or+just+4%3C%2Fspan%3E%0A++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x01%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%3Cspan+class%3D%22hljs-number%22%3E0x04%3C%2Fspan%3E%3B%0A%0A++++transaction-%26gt%3BscriptSig%5BscriptSig_pos%2B%2B%5D+%3D+%28uint8_t%29scriptSig_len%3B%0A%0A++++scriptSig_len+%2B%3D+scriptSig_pos%3B%0A++++transaction-%26gt%3BscriptSig+%3D+%28uint8_t*%29realloc%28transaction-%26gt%3BscriptSig%2C+scriptSig_len+*+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28uint8_t%29%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BscriptSig+%2B+scriptSig_pos%2C+%28%3Cspan+class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*%29timestamp%2C+timestamp_len%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Here+we+are+asuming+some+values+will+have+the+same+size%3C%2Fspan%3E%0A++++uint32_t+serializedLen+%3D%0A++++++++%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+tx+version%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+number+of+inputs%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+hash+of+previous+output%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+previous+output%27s+index%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+1+byte+for+the+size+of+scriptSig%3C%2Fspan%3E%0A++++++++%2B+scriptSig_len%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+size+of+sequence%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+number+of+outputs%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E8%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+8+bytes+for+coin+value%3C%2Fspan%3E%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+1+byte+to+represent+size+of+the+pubkey+Script%3C%2Fspan%3E%0A++++++++%2B+pubkeyScript_len%0A++++++++%2B+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%3B+++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+4+bytes+for+lock+time%3C%2Fspan%3E%0A%0A+++++++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Now+let%27s+serialize+the+data%3C%2Fspan%3E%0A++++uint32_t+serializedData_pos+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++transaction-%26gt%3BserializedData+%3D+%28uint8_t*%29%3Cspan+class%3D%22hljs-built_in%22%3Emalloc%3C%2Fspan%3E%28serializedLen+*+%3Cspan+class%3D%22hljs-keyword%22%3Esizeof%3C%2Fspan%3E%28uint8_t%29%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3Bversion%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3BnumInputs%2C+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+transaction-%26gt%3BprevOutput%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3BprevoutIndex%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3BscriptSig_len%2C+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+transaction-%26gt%3BscriptSig%2C+scriptSig_len%29%3B%0A++++serializedData_pos+%2B%3D+scriptSig_len%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3Bsequence%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3BnumOutputs%2C+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3BoutValue%2C+%3Cspan+class%3D%22hljs-number%22%3E8%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E8%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3BpubkeyScript_len%2C+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+transaction-%26gt%3BpubkeyScript%2C+pubkeyScript_len%29%3B%0A++++serializedData_pos+%2B%3D+pubkeyScript_len%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BserializedData+%2B+serializedData_pos%2C+%26amp%3Btransaction-%26gt%3Blocktime%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++serializedData_pos+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Now+that+the+data+is+serialized%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+we+hash+it+with+SHA256+and+then+hash+that+result+to+get+merkle+hash%3C%2Fspan%3E%0A++++SHA256%28transaction-%26gt%3BserializedData%2C+serializedLen%2C+hash1%29%3B%0A++++SHA256%28hash1%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%2C+hash2%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+This+copy+isn%27t+necessary+imo%2C+but+here+for+clarity%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28transaction-%26gt%3BmerkleHash%2C+hash2%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*merkleHash+%3D+bin2hex%28transaction-%26gt%3BmerkleHash%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++byteswap%28transaction-%26gt%3BmerkleHash%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*merkleHashSwapped+%3D+bin2hex%28transaction-%26gt%3BmerkleHash%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*txScriptSig+%3D+bin2hex%28transaction-%26gt%3BscriptSig%2C+scriptSig_len%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*pubScriptSig+%3D+bin2hex%28transaction-%26gt%3BpubkeyScript%2C+pubkeyScript_len%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Eprintf%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-string%22%3E%22%5CnCoinbase%3A+%25s%5Cn%5CnPubkeyScript%3A+%25s%5Cn%5CnMerkle+Hash%3A+%25s%5CnByteswapped%3A+%25s%5Cn%22%3C%2Fspan%3E%2C+txScriptSig%2C+pubScriptSig%2C+merkleHash%2C+merkleHashSwapped%29%3B%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2Fif%28generateBlock%29%3C%2Fspan%3E%0A++++%7B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Eprintf%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-string%22%3E%22Generating+block...%5Cn%22%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28%21unixtime%29%0A++++++++%7B%0A++++++++++++unixtime+%3D+time%28NULL%29%3B%0A++++++++%7D%0A%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+block_header%5B%3Cspan+class%3D%22hljs-number%22%3E80%3C%2Fspan%3E%5D%2C+block_hash1%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%2C+block_hash2%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%3B%0A++++++++uint32_t+blockversion+%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28block_header%2C+%26amp%3Bblockversion%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememset%3C%2Fspan%3E%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++++++byteswap%28transaction-%26gt%3BmerkleHash%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+We+swapped+it+before%2C+so+do+it+again+now.%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E36%3C%2Fspan%3E%2C+transaction-%26gt%3BmerkleHash%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E68%3C%2Fspan%3E%2C+%26amp%3Bunixtime%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E72%3C%2Fspan%3E%2C+%26amp%3BnBits%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-built_in%22%3Ememcpy%3C%2Fspan%3E%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E76%3C%2Fspan%3E%2C+%26amp%3BstartNonce%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%3B%0A%0A++++++++uint32_t+*pNonce+%3D+%28uint32_t+*%29%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E76%3C%2Fspan%3E%29%3B%0A++++++++uint32_t+*pUnixtime+%3D+%28uint32_t+*%29%28block_header+%2B+%3Cspan+class%3D%22hljs-number%22%3E68%3C%2Fspan%3E%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+counter+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+start+%3D+time%28NULL%29%3B%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ewhile%3C%2Fspan%3E+%28%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%0A++++++++%7B%0A++++++++++++SHA256%28block_header%2C+%3Cspan+class%3D%22hljs-number%22%3E80%3C%2Fspan%3E%2C+block_hash1%29%3B%0A++++++++++++SHA256%28block_hash1%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%2C+block_hash2%29%3B%0A%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eunsigned%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-keyword%22%3Eint%3C%2Fspan%3E+check+%3D+*%28%28uint32_t+*%29%28block_hash2+%2B+%3Cspan+class%3D%22hljs-number%22%3E28%3C%2Fspan%3E%29%29%3B+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+The+hash+is+in+little-endian%2C+so+we+check+the+last+4+bytes.%3C%2Fspan%3E%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28check+%3D%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+%5Cx00%5Cx00%5Cx00%5Cx00%3C%2Fspan%3E%0A++++++++++++%7B%0A++++++++++++++++byteswap%28block_hash2%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Echar%3C%2Fspan%3E+*blockHash+%3D+bin2hex%28block_hash2%2C+%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%29%3B%0A++++++++++++++++%3Cspan+class%3D%22hljs-built_in%22%3Eprintf%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-string%22%3E%22%5CnBlock+found%21%5CnHash%3A+%25s%5CnNonce%3A+%25u%5CnUnix+time%3A+%25u%22%3C%2Fspan%3E%2C+blockHash%2C+startNonce%2C+unixtime%29%3B%0A++++++++++++++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28blockHash%29%3B%0A++++++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Ebreak%3C%2Fspan%3E%3B%0A++++++++++++%7D%0A%0A++++++++++++startNonce%2B%2B%3B%0A++++++++++++counter+%2B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%3B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28time%28NULL%29+-+start+%26gt%3B%3D+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%29%0A++++++++++++%7B%0A++++++++++++++++%3Cspan+class%3D%22hljs-built_in%22%3Eprintf%3C%2Fspan%3E%28%3Cspan+class%3D%22hljs-string%22%3E%22%5Cr%25d+Hashes%2Fs%2C+Nonce+%25u%5Cr%22%3C%2Fspan%3E%2C+counter%2C+startNonce%29%3B%0A++++++++++++++++counter+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++++++++++++++start+%3D+time%28NULL%29%3B%0A++++++++++++%7D%0A++++++++++++*pNonce+%3D+startNonce%3B%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%28startNonce+%26gt%3B+%3Cspan+class%3D%22hljs-number%22%3E4294967294L%3C%2Fspan%3EL%29%0A++++++++++++%7B%0A++++++++++++++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2Fprintf%28%22%5CnBlock+found%21%5CnHash%3A+%25s%5CnNonce%3A+%25u%5CnUnix+time%3A+%25u%22%2C+blockHash%2C+startNonce%2C+unixtime%29%3B%3C%2Fspan%3E%0A++++++++++++++++unixtime%2B%2B%3B%0A++++++++++++++++*pUnixtime+%3D+unixtime%3B%0A++++++++++++++++startNonce+%3D+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A++++++++++++%7D%0A++++++++%7D%0A++++%7D%0A%0A++++%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F+Lots+of+cleanup%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28merkleHash%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28merkleHashSwapped%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28txScriptSig%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28pubScriptSig%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28transaction-%26gt%3BserializedData%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28transaction-%26gt%3BscriptSig%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28transaction-%26gt%3BpubkeyScript%29%3B%0A++++%3Cspan+class%3D%22hljs-built_in%22%3Efree%3C%2Fspan%3E%28transaction%29%3B%0A%0A++++getchar%28%29%3B%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%3B%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fmarkdown_views-ea0013b516.css%22%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fanda0109%2Farticle%2Fdetails%2F80927832%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fanda0109%2Farticle%2Fdetails%2F80927832%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}