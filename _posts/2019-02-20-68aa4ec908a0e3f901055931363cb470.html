---
layout: default
title: 深度学总结：Image Style Transfer pytorch方式实现，这个是非基于autoencoder和domain adversrial方式
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+id%3D%22content_views%22+class%3D%22markdown_views+prism-atom-one-dark%22%3E+%0A++%3C%21--+flowchart+%E7%AE%AD%E5%A4%B4%E5%9B%BE%E6%A0%87+%E5%8B%BF%E5%88%A0+--%3E+%0A++%3Csvg+xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22+style%3D%22display%3A+none%3B%22%3E%0A+++%3Cpath+stroke-linecap%3D%22round%22+d%3D%22M5%2C0+0%2C2.5+5%2C5z%22+id%3D%22raphael-marker-block%22+style%3D%22-webkit-tap-highlight-color%3A+rgba%280%2C+0%2C+0%2C+0%29%3B%22%3E%3C%2Fpath%3E%0A++%3C%2Fsvg%3E+%0A++%3Cp%3E%3C%2Fp%3E%0A++%3Cdiv+class%3D%22toc%22%3E%0A+++%3Ch3%3E%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95%3C%2Fh3%3E%0A+++%3Cul%3E%0A++++%3Cli%3E%3Ca+href%3D%22%23_1%22+rel%3D%22nofollow%22%3E%E8%AE%BA%E6%96%87%E9%93%BE%E6%8E%A5%EF%BC%9A%3C%2Fa%3E%3C%2Fli%3E%0A++++%3Cli%3E%3Ca+href%3D%22%23_4%22+rel%3D%22nofollow%22%3E%E4%B8%BB%E8%A6%81%E6%80%9D%E8%B7%AF%EF%BC%9A%3C%2Fa%3E%3C%2Fli%3E%0A++++%3Cli%3E%3Ca+href%3D%22%23pytorch_10%22+rel%3D%22nofollow%22%3Epytorch%E5%AE%9E%E7%8E%B0%EF%BC%9A%3C%2Fa%3E%3C%2Fli%3E%0A++++%3Cul%3E%0A+++++%3Cli%3E%3Ca+href%3D%22%23contentLoss_11%22+rel%3D%22nofollow%22%3E%E8%AE%A1%E7%AE%97content%E7%9A%84Loss%3A%3C%2Fa%3E%3C%2Fli%3E%0A+++++%3Cli%3E%3Ca+href%3D%22%23style_Loss_19%22+rel%3D%22nofollow%22%3E%E8%AE%A1%E7%AE%97style+%E7%9A%84Loss%3A%3C%2Fa%3E%3C%2Fli%3E%0A+++++%3Cli%3E%3Ca+href%3D%22%23totalLoss_71%22+rel%3D%22nofollow%22%3E%E8%AE%A1%E7%AE%97total%E7%9A%84Loss%3A%3C%2Fa%3E%3C%2Fli%3E%0A+++++%3Cli%3E%3Ca+href%3D%22%23_83%22+rel%3D%22nofollow%22%3E%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B%EF%BC%9A%3C%2Fa%3E%3C%2Fli%3E%0A++++%3C%2Ful%3E%0A+++%3C%2Ful%3E%0A++%3C%2Fdiv%3E%0A++%3Cp%3E%3C%2Fp%3E+%0A++%3Ch1%3E%3Ca+id%3D%22_1%22%3E%3C%2Fa%3E%E8%AE%BA%E6%96%87%E9%93%BE%E6%8E%A5%EF%BC%9A%3C%2Fh1%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fwww.cv-foundation.org%2Fopenaccess%2Fcontent_cvpr_2016%2Fpapers%2FGatys_Image_Style_Transfer_CVPR_2016_paper.pdf%22+rel%3D%22nofollow%22%3Ehttps%3A%2F%2Fwww.cv-foundation.org%2Fopenaccess%2Fcontent_cvpr_2016%2Fpapers%2FGatys_Image_Style_Transfer_CVPR_2016_paper.pdf%3C%2Fa%3E%3Cbr%3E+%E4%BD%9C%E8%80%85%E8%BF%90%E7%94%A8%E4%BA%86%E4%B8%80%E4%B8%AA%E6%8A%AB%E7%9D%80%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%A4%96%E8%A1%A8%E7%9A%84%E4%BC%A0%E7%BB%9F%E6%96%B9%E6%B3%95%E5%81%9A%E8%BF%99%E4%B8%AA%E9%97%AE%E9%A2%98%EF%BC%8C%E6%8A%80%E6%9C%AF%E4%B8%8D%E6%8F%90%E5%80%A1%EF%BC%8C%E6%80%9D%E8%B7%AF%E3%80%81%E6%83%B3%E6%B3%95%E5%BE%88%E5%A4%A9%E6%89%8D%E3%80%82%3C%2Fp%3E+%0A++%3Ch1%3E%3Ca+id%3D%22_4%22%3E%3C%2Fa%3E%E4%B8%BB%E8%A6%81%E6%80%9D%E8%B7%AF%EF%BC%9A%3C%2Fh1%3E+%0A++%3Cp%3E1%E3%80%81%E6%83%B3%E5%8A%9E%E6%B3%95%E5%88%86%E7%A6%BBstyle+features%E5%92%8Ccontent+features%3B%3Cbr%3E+2%E3%80%81%E6%80%8E%E4%B9%88%E5%BE%97%E5%88%B0content+features%EF%BC%8C%E4%BD%9C%E8%80%85%E5%81%B7%E6%87%92%E7%9B%B4%E6%8E%A5%E5%8F%96vgg19%E9%87%8C%E9%9D%A2conv4_2%E7%9A%84features%EF%BC%8C%E5%BD%93%E4%BD%9Ccontent+features%EF%BC%9B%3Cbr%3E+3%E3%80%81%E6%80%8E%E4%B9%88%E5%BE%97%E5%88%B0style+features%EF%BC%8C%E4%BD%9C%E8%80%85%E5%8F%91%E6%8C%A5%E5%A4%A9%E6%89%8D%E7%9A%84%E5%81%B7%E6%87%92%EF%BC%8C%E8%AE%A4%E4%B8%BAstyle%E5%B0%B1%E6%98%AFfeatures%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E5%85%B3%E5%BA%A6%EF%BC%8C%E4%BD%9C%E8%80%85%E7%9B%B4%E6%8E%A5%E5%8F%96vgg19%E9%87%8C%E9%9D%A2conv1_1%EF%BC%8Cconv2_1%EF%BC%8Cconv3_1%EF%BC%8Cconv4_1%EF%BC%8Cconv5_1%E8%BF%995%E5%B1%82%E7%9A%84feature+map%E6%9D%A5%E7%AE%97%E9%A3%8E%E6%A0%BC%E7%9B%B8%E5%85%B3%E5%BA%A6%EF%BC%8C%E4%BD%9C%E8%80%85%E5%8F%88%E5%8F%91%E7%8E%B0%E4%B8%8D%E5%90%8C%E7%9A%84layer%E5%AF%B9%E9%A3%8E%E6%A0%BC%E6%9C%89%E5%BD%B1%E5%93%8D%EF%BC%8C%E5%89%8D%E9%9D%A2%E7%9A%84%E9%A3%8E%E6%A0%BC%E7%BB%86%E8%85%BB%EF%BC%8C%E5%90%8E%E9%9D%A2%E7%9A%84%E9%A3%8E%E6%A0%BC%E7%B2%97%E7%8A%B7%EF%BC%8C%E5%8F%88%E7%BB%99%E8%BF%995%E4%B8%AA%E5%B1%82%E7%9A%84loss%E8%AF%AF%E5%B7%AE%E5%8A%A0%E4%BA%86%E6%9D%83%E9%87%8D%E3%80%82%3Cbr%3E+4%E3%80%81%E9%82%A3%E4%B9%88%E7%9B%AE%E6%A0%87%E6%98%AF%E4%BB%80%E4%B9%88%E4%BA%86%EF%BC%9F%E5%B0%B1%E6%98%AFnew_image%E5%92%8Ccontent_image%E7%9A%84%E5%86%85%E5%AE%B9%E6%8E%A5%E8%BF%91%EF%BC%8Cnew_image%E5%92%8Cstytle_image%E7%9A%84%E9%A3%8E%E6%A0%BC%E6%8E%A5%E8%BF%91%EF%BC%8C%3Cspan+class%3D%22katex--inline%22%3E%3Cspan+class%3D%22katex%22%3E%3Cspan+class%3D%22katex-mathml%22%3E%0A++++++%3Cmath%3E%0A+++++++%3Csemantics%3E%0A++++++++%3Cmrow%3E%0A+++++++++%3Cmsub%3E%0A++++++++++%3Cmi%3E%0A+++++++++++L%0A++++++++++%3C%2Fmi%3E%0A++++++++++%3Cmrow%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++o%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++a%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++l%0A+++++++++++%3C%2Fmi%3E%0A++++++++++%3C%2Fmrow%3E%0A+++++++++%3C%2Fmsub%3E%0A++++++++%3C%2Fmrow%3E%0A++++++++%3Cannotation+encoding%3D%22application%2Fx-tex%22%3E%0A+++++++++L_%7Btotal%7D%0A++++++++%3C%2Fannotation%3E%0A+++++++%3C%2Fsemantics%3E%0A++++++%3C%2Fmath%3E%3C%2Fspan%3E%3Cspan+class%3D%22katex-html%22+aria-hidden%3D%22true%22%3E%3Cspan+class%3D%22base%22%3E%3Cspan+class%3D%22strut%22+style%3D%22height%3A+0.83333em%3B+vertical-align%3A+-0.15em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22mord%22%3E%3Cspan+class%3D%22mord+mathit%22%3EL%3C%2Fspan%3E%3Cspan+class%3D%22msupsub%22%3E%3Cspan+class%3D%22vlist-t+vlist-t2%22%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.336108em%3B%22%3E%3Cspan+class%3D%22%22+style%3D%22top%3A+-2.55em%3B+margin-left%3A+0em%3B+margin-right%3A+0.05em%3B%22%3E%3Cspan+class%3D%22pstrut%22+style%3D%22height%3A+2.7em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22sizing+reset-size6+size3+mtight%22%3E%3Cspan+class%3D%22mord+mtight%22%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Eo%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Ea%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22+style%3D%22margin-right%3A+0.01968em%3B%22%3El%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-s%22%3E%E2%80%8B%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.15em%3B%22%3E%3Cspan+class%3D%22%22%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E+%3D+%3Cspan+class%3D%22katex--inline%22%3E%3Cspan+class%3D%22katex%22%3E%3Cspan+class%3D%22katex-mathml%22%3E%0A++++++%3Cmath%3E%0A+++++++%3Csemantics%3E%0A++++++++%3Cmrow%3E%0A+++++++++%3Cmsub%3E%0A++++++++++%3Cmi%3E%0A+++++++++++L%0A++++++++++%3C%2Fmi%3E%0A++++++++++%3Cmrow%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++c%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++o%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++n%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++e%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++n%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A++++++++++%3C%2Fmrow%3E%0A+++++++++%3C%2Fmsub%3E%0A++++++++%3C%2Fmrow%3E%0A++++++++%3Cannotation+encoding%3D%22application%2Fx-tex%22%3E%0A+++++++++L_%7Bcontent%7D%0A++++++++%3C%2Fannotation%3E%0A+++++++%3C%2Fsemantics%3E%0A++++++%3C%2Fmath%3E%3C%2Fspan%3E%3Cspan+class%3D%22katex-html%22+aria-hidden%3D%22true%22%3E%3Cspan+class%3D%22base%22%3E%3Cspan+class%3D%22strut%22+style%3D%22height%3A+0.83333em%3B+vertical-align%3A+-0.15em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22mord%22%3E%3Cspan+class%3D%22mord+mathit%22%3EL%3C%2Fspan%3E%3Cspan+class%3D%22msupsub%22%3E%3Cspan+class%3D%22vlist-t+vlist-t2%22%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.280556em%3B%22%3E%3Cspan+class%3D%22%22+style%3D%22top%3A+-2.55em%3B+margin-left%3A+0em%3B+margin-right%3A+0.05em%3B%22%3E%3Cspan+class%3D%22pstrut%22+style%3D%22height%3A+2.7em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22sizing+reset-size6+size3+mtight%22%3E%3Cspan+class%3D%22mord+mtight%22%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Ec%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Eo%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3En%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Ee%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3En%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-s%22%3E%E2%80%8B%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.15em%3B%22%3E%3Cspan+class%3D%22%22%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%2B%3Cspan+class%3D%22katex--inline%22%3E%3Cspan+class%3D%22katex%22%3E%3Cspan+class%3D%22katex-mathml%22%3E%0A++++++%3Cmath%3E%0A+++++++%3Csemantics%3E%0A++++++++%3Cmrow%3E%0A+++++++++%3Cmsub%3E%0A++++++++++%3Cmi%3E%0A+++++++++++L%0A++++++++++%3C%2Fmi%3E%0A++++++++++%3Cmrow%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++s%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++y%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++l%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++e%0A+++++++++++%3C%2Fmi%3E%0A++++++++++%3C%2Fmrow%3E%0A+++++++++%3C%2Fmsub%3E%0A++++++++%3C%2Fmrow%3E%0A++++++++%3Cannotation+encoding%3D%22application%2Fx-tex%22%3E%0A+++++++++L_%7Bstyle%7D%0A++++++++%3C%2Fannotation%3E%0A+++++++%3C%2Fsemantics%3E%0A++++++%3C%2Fmath%3E%3C%2Fspan%3E%3Cspan+class%3D%22katex-html%22+aria-hidden%3D%22true%22%3E%3Cspan+class%3D%22base%22%3E%3Cspan+class%3D%22strut%22+style%3D%22height%3A+0.969438em%3B+vertical-align%3A+-0.286108em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22mord%22%3E%3Cspan+class%3D%22mord+mathit%22%3EL%3C%2Fspan%3E%3Cspan+class%3D%22msupsub%22%3E%3Cspan+class%3D%22vlist-t+vlist-t2%22%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.336108em%3B%22%3E%3Cspan+class%3D%22%22+style%3D%22top%3A+-2.55em%3B+margin-left%3A+0em%3B+margin-right%3A+0.05em%3B%22%3E%3Cspan+class%3D%22pstrut%22+style%3D%22height%3A+2.7em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22sizing+reset-size6+size3+mtight%22%3E%3Cspan+class%3D%22mord+mtight%22%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Es%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22+style%3D%22margin-right%3A+0.03588em%3B%22%3Ey%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22+style%3D%22margin-right%3A+0.01968em%3B%22%3El%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Ee%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-s%22%3E%E2%80%8B%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.286108em%3B%22%3E%3Cspan+class%3D%22%22%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%EF%BC%8C%E9%A6%96%E5%85%88%E8%A6%81%E5%83%8F%EF%BC%8C%E5%85%B6%E6%AC%A1%E6%89%8D%E6%98%AF%E9%A3%8E%E6%A0%BC%EF%BC%8C%E6%89%80%E4%BB%A5%3Cspan+class%3D%22katex--inline%22%3E%3Cspan+class%3D%22katex%22%3E%3Cspan+class%3D%22katex-mathml%22%3E%0A++++++%3Cmath%3E%0A+++++++%3Csemantics%3E%0A++++++++%3Cmrow%3E%0A+++++++++%3Cmsub%3E%0A++++++++++%3Cmi%3E%0A+++++++++++L%0A++++++++++%3C%2Fmi%3E%0A++++++++++%3Cmrow%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++c%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++o%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++n%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++e%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++n%0A+++++++++++%3C%2Fmi%3E%0A+++++++++++%3Cmi%3E%0A++++++++++++t%0A+++++++++++%3C%2Fmi%3E%0A++++++++++%3C%2Fmrow%3E%0A+++++++++%3C%2Fmsub%3E%0A++++++++%3C%2Fmrow%3E%0A++++++++%3Cannotation+encoding%3D%22application%2Fx-tex%22%3E%0A+++++++++L_%7Bcontent%7D%0A++++++++%3C%2Fannotation%3E%0A+++++++%3C%2Fsemantics%3E%0A++++++%3C%2Fmath%3E%3C%2Fspan%3E%3Cspan+class%3D%22katex-html%22+aria-hidden%3D%22true%22%3E%3Cspan+class%3D%22base%22%3E%3Cspan+class%3D%22strut%22+style%3D%22height%3A+0.83333em%3B+vertical-align%3A+-0.15em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22mord%22%3E%3Cspan+class%3D%22mord+mathit%22%3EL%3C%2Fspan%3E%3Cspan+class%3D%22msupsub%22%3E%3Cspan+class%3D%22vlist-t+vlist-t2%22%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.280556em%3B%22%3E%3Cspan+class%3D%22%22+style%3D%22top%3A+-2.55em%3B+margin-left%3A+0em%3B+margin-right%3A+0.05em%3B%22%3E%3Cspan+class%3D%22pstrut%22+style%3D%22height%3A+2.7em%3B%22%3E%3C%2Fspan%3E%3Cspan+class%3D%22sizing+reset-size6+size3+mtight%22%3E%3Cspan+class%3D%22mord+mtight%22%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Ec%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Eo%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3En%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Ee%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3En%3C%2Fspan%3E%3Cspan+class%3D%22mord+mathit+mtight%22%3Et%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-s%22%3E%E2%80%8B%3C%2Fspan%3E%3C%2Fspan%3E%3Cspan+class%3D%22vlist-r%22%3E%3Cspan+class%3D%22vlist%22+style%3D%22height%3A+0.15em%3B%22%3E%3Cspan+class%3D%22%22%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fspan%3E%E7%9A%84%E6%AF%94%E9%87%8D%E8%A6%81%E5%A4%A7%E3%80%82%3C%2Fp%3E+%0A++%3Ch1%3E%3Ca+id%3D%22pytorch_10%22%3E%3C%2Fa%3Epytorch%E5%AE%9E%E7%8E%B0%EF%BC%9A%3C%2Fh1%3E+%0A++%3Ch2%3E%3Ca+id%3D%22contentLoss_11%22%3E%3C%2Fa%3E%E8%AE%A1%E7%AE%97content%E7%9A%84Loss%3A%3C%2Fh2%3E+%0A++%3Cp%3E%E5%89%8D%E9%9D%A2%E6%8F%90%E5%88%B0%E4%BA%86%E4%BD%9C%E8%80%85%E5%81%B7%E6%87%92%E7%9B%B4%E6%8E%A5%E5%8F%96vgg19%E9%87%8C%E9%9D%A2conv4_2%E7%9A%84features%EF%BC%8C%E5%BD%93%E4%BD%9Ccontent+features%EF%BC%8C%E9%82%A3%E4%B9%88%E5%8F%AA%E9%9C%80%E8%A6%81%E6%AF%94%E8%BE%83%E4%B8%A4%E4%B8%AAfeature+map%E7%9A%84%E5%B7%AE%E5%88%AB%E5%B0%B1%E8%A1%8C%E4%BA%86%E3%80%82%3Cbr%3E+%3Cimg+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190220160543599.png%22+alt%3D%22%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0%22%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22prism+language-python%22%3E%3Cspan+class%3D%22token+comment%22%3E%23+the+content+loss%3C%2Fspan%3E%0A++++content_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+torch%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Emean%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3E%3Cspan+class%3D%22token+string%22%3E%27conv4_2%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E+%3Cspan+class%3D%22token+operator%22%3E-%3C%2Fspan%3E+content_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3E%3Cspan+class%3D%22token+string%22%3E%27conv4_2%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+operator%22%3E**%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22style_Loss_19%22%3E%3C%2Fa%3E%E8%AE%A1%E7%AE%97style+%E7%9A%84Loss%3A%3C%2Fh2%3E+%0A++%3Cp%3E%3Cimg+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190220161017156.png%22+alt%3D%22%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0%22%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22prism+language-python%22%3E%3Cspan+class%3D%22token+keyword%22%3Edef%3C%2Fspan%3E+%3Cspan+class%3D%22token+function%22%3Egram_matrix%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etensor%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22token+triple-quoted-string+string%22%3E%22%22%22+Calculate+the+Gram+Matrix+of+a+given+tensor+Gram+Matrix%3A+https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FGramian_matrix+%22%22%22%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+get+the+batch_size%2C+depth%2C+height%2C+and+width+of+the+Tensor%3C%2Fspan%3E%0A++++_%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+d%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+h%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+w+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+tensor%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Esize%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+reshape+so+we%27re+multiplying+the+features+for+each+channel%3C%2Fspan%3E%0A++++tensor+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+tensor%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Eview%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Ed%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+h+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+w%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+calculate+the+gram+matrix%3C%2Fspan%3E%0A++++gram+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+torch%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Emm%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etensor%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+tensor%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Et%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+keyword%22%3Ereturn%3C%2Fspan%3E+gram%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%3Cimg+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190220161241597.png%22+alt%3D%22%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0%22%3E%3Cbr%3E+%3Cimg+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190220161259144.png%22+alt%3D%22%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0%22%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22prism+language-python%22%3E%3Cspan+class%3D%22token+comment%22%3E%23+weights+for+each+style+layer+%3C%2Fspan%3E%0A%3Cspan+class%3D%22token+comment%22%3E%23+weighting+earlier+layers+more+will+result+in+*larger*+style+artifacts%3C%2Fspan%3E%0A%3Cspan+class%3D%22token+comment%22%3E%23+notice+we+are+excluding+%60conv4_2%60+our+content+representation%3C%2Fspan%3E%0Astyle_weights+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+punctuation%22%3E%7B%3C%2Fspan%3E%3Cspan+class%3D%22token+string%22%3E%27conv1_1%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E1%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E%0A+++++++++++++++++%3Cspan+class%3D%22token+string%22%3E%27conv2_1%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E0.75%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E%0A+++++++++++++++++%3Cspan+class%3D%22token+string%22%3E%27conv3_1%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E0.2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E%0A+++++++++++++++++%3Cspan+class%3D%22token+string%22%3E%27conv4_1%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E0.2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E%0A+++++++++++++++++%3Cspan+class%3D%22token+string%22%3E%27conv5_1%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E0.2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%7D%3C%2Fspan%3E%0A+++++++++++++++++%0A%3Cspan+class%3D%22token+comment%22%3E%23+get+style+features+only+once+before+training%3C%2Fspan%3E%0Astyle_features+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+get_features%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Estyle%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+vgg%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A%0A%3Cspan+class%3D%22token+comment%22%3E%23+calculate+the+gram+matrices+for+each+layer+of+our+style+representation%3C%2Fspan%3E%0Astyle_grams+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+punctuation%22%3E%7B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E+gram_matrix%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Estyle_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E+%3Cspan+class%3D%22token+keyword%22%3Efor%3C%2Fspan%3E+layer+%3Cspan+class%3D%22token+keyword%22%3Ein%3C%2Fspan%3E+style_features%3Cspan+class%3D%22token+punctuation%22%3E%7D%3C%2Fspan%3E%0A%0A++++%3Cspan+class%3D%22token+keyword%22%3Efor%3C%2Fspan%3E+layer+%3Cspan+class%3D%22token+keyword%22%3Ein%3C%2Fspan%3E+style_weights%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+get+the+%22target%22+style+representation+for+the+layer%3C%2Fspan%3E%0A++++++++target_feature+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+target_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%0A++++++++target_gram+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+gram_matrix%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget_feature%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++++++_%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+d%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+h%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+w+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+target_feature%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Eshape%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+get+the+%22style%22+style+representation%3C%2Fspan%3E%0A++++++++style_gram+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+style_grams%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+the+style+loss+for+one+layer%2C+weighted+appropriately%3C%2Fspan%3E%0A++++++++layer_style_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+style_weights%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+torch%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Emean%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget_gram+%3Cspan+class%3D%22token+operator%22%3E-%3C%2Fspan%3E+style_gram%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+operator%22%3E**%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+add+to+the+style+loss%3C%2Fspan%3E%0A++++++++style_loss+%3Cspan+class%3D%22token+operator%22%3E%2B%3D%3C%2Fspan%3E+layer_style_loss+%3Cspan+class%3D%22token+operator%22%3E%2F%3C%2Fspan%3E+%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Ed+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+h+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+w%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22totalLoss_71%22%3E%3C%2Fa%3E%E8%AE%A1%E7%AE%97total%E7%9A%84Loss%3A%3C%2Fh2%3E+%0A++%3Cp%3E%3Cimg+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190220161929248.png%22+alt%3D%22%E5%9C%A8%E8%BF%99%E9%87%8C%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0%22%3E%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22prism+language-python%22%3E%0Acontent_weight+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E1%3C%2Fspan%3E++%3Cspan+class%3D%22token+comment%22%3E%23+alpha%3C%2Fspan%3E%0Astyle_weight+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E1e6%3C%2Fspan%3E++%3Cspan+class%3D%22token+comment%22%3E%23+beta%3C%2Fspan%3E%0A%0A%3Cspan+class%3D%22token+comment%22%3E%23+calculate+the+*total*+loss%3C%2Fspan%3E%0Atotal_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+content_weight+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+content_loss+%3Cspan+class%3D%22token+operator%22%3E%2B%3C%2Fspan%3E+style_weight+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+style_loss%0A++++%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2%3E%3Ca+id%3D%22_83%22%3E%3C%2Fa%3E%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B%EF%BC%9A%3C%2Fh2%3E+%0A++%3Cp%3E%E6%9C%89%E4%BA%BA%E5%8F%AF%E8%83%BD%E9%97%AEVGG%E5%8F%82%E6%95%B0%E5%9B%BA%E5%AE%9A%E4%BD%8F%E4%BA%86%EF%BC%8C%E9%9C%80%E8%A6%81%E7%9A%84%E5%8F%82%E6%95%B0%E6%98%AF%E4%BB%80%E4%B9%88%E4%BA%86%EF%BC%8C%E5%8F%82%E6%95%B0%E5%B0%B1%E6%98%AF%E6%96%B0%E5%9B%BE%E5%95%8A%EF%BC%9F%E9%80%9A%E8%BF%87%E4%B8%8A%E8%BF%B0loss%E8%B0%83%E6%95%B4%E5%9B%BE%E5%83%8F%E7%9A%84%E5%83%8F%E7%B4%A0%E5%80%BC%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%92%8C%E6%88%91%E4%BB%AC%E4%B8%80%E8%88%AC%E4%BA%86%E8%A7%A3%E5%88%B0%E7%9A%84%E6%9C%89%E7%82%B9%E4%B8%8D%E4%B8%80%E6%A0%B7%E3%80%82%3Cbr%3E+%E6%96%B0%E5%9B%BE%E5%B0%B1%E6%98%AF%E5%9C%A8%E5%8E%9F%E5%9B%BE%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E6%85%A2%E6%85%A2%E5%8F%98%E5%8C%96%2Cf%E5%A4%8D%E5%88%B6%E5%8E%9F%E5%9B%BE%E5%B9%B6%E8%AE%BE%E7%BD%AE%E6%96%B0%E5%9B%BE%E4%B8%BAtrainable%E7%9A%84%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22prism+language-python%22%3E%3Cspan+class%3D%22token+comment%22%3E%23+create+a+third+%22target%22+image+and+prep+it+for+change%3C%2Fspan%3E%0A%3Cspan+class%3D%22token+comment%22%3E%23+it+is+a+good+idea+to+start+of+with+the+target+as+a+copy+of+our+*content*+image%3C%2Fspan%3E%0A%3Cspan+class%3D%22token+comment%22%3E%23+then+iteratively+change+its+style%3C%2Fspan%3E%0Atarget+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+content%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Eclone%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Erequires_grad_%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+boolean%22%3ETrue%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Eto%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Edevice%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E8%AE%AD%E7%BB%83%E5%A4%A7%E6%A6%82%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode+class%3D%22prism+language-python%22%3E%3Cspan+class%3D%22token+comment%22%3E%23+for+displaying+the+target+image%2C+intermittently%3C%2Fspan%3E%0Ashow_every+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E400%3C%2Fspan%3E%0A%0A%3Cspan+class%3D%22token+comment%22%3E%23+iteration+hyperparameters%3C%2Fspan%3E%0Aoptimizer+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+optim%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3EAdam%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Etarget%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+lr%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E0.003%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0Asteps+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E2000%3C%2Fspan%3E++%3Cspan+class%3D%22token+comment%22%3E%23+decide+how+many+iterations+to+update+your+image+%285000%29%3C%2Fspan%3E%0A%0A%3Cspan+class%3D%22token+keyword%22%3Efor%3C%2Fspan%3E+ii+%3Cspan+class%3D%22token+keyword%22%3Ein%3C%2Fspan%3E+%3Cspan+class%3D%22token+builtin%22%3Erange%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E1%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+steps%3Cspan+class%3D%22token+operator%22%3E%2B%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E1%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+get+the+features+from+your+target+image%3C%2Fspan%3E%0A++++target_features+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+get_features%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+vgg%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+the+content+loss%3C%2Fspan%3E%0A++++content_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+torch%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Emean%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3E%3Cspan+class%3D%22token+string%22%3E%27conv4_2%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E+%3Cspan+class%3D%22token+operator%22%3E-%3C%2Fspan%3E+content_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3E%3Cspan+class%3D%22token+string%22%3E%27conv4_2%27%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+operator%22%3E**%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+the+style+loss%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+initialize+the+style+loss+to+0%3C%2Fspan%3E%0A++++style_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+%3Cspan+class%3D%22token+number%22%3E0%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+then+add+to+it+for+each+layer%27s+gram+matrix+loss%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22token+keyword%22%3Efor%3C%2Fspan%3E+layer+%3Cspan+class%3D%22token+keyword%22%3Ein%3C%2Fspan%3E+style_weights%3Cspan+class%3D%22token+punctuation%22%3E%3A%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+get+the+%22target%22+style+representation+for+the+layer%3C%2Fspan%3E%0A++++++++target_feature+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+target_features%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%0A++++++++target_gram+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+gram_matrix%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget_feature%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++++++_%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+d%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+h%3Cspan+class%3D%22token+punctuation%22%3E%2C%3C%2Fspan%3E+w+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+target_feature%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Eshape%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+get+the+%22style%22+style+representation%3C%2Fspan%3E%0A++++++++style_gram+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+style_grams%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+the+style+loss+for+one+layer%2C+weighted+appropriately%3C%2Fspan%3E%0A++++++++layer_style_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+style_weights%3Cspan+class%3D%22token+punctuation%22%3E%5B%3C%2Fspan%3Elayer%3Cspan+class%3D%22token+punctuation%22%3E%5D%3C%2Fspan%3E+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+torch%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Emean%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Etarget_gram+%3Cspan+class%3D%22token+operator%22%3E-%3C%2Fspan%3E+style_gram%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%3Cspan+class%3D%22token+operator%22%3E**%3C%2Fspan%3E%3Cspan+class%3D%22token+number%22%3E2%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++++++%3Cspan+class%3D%22token+comment%22%3E%23+add+to+the+style+loss%3C%2Fspan%3E%0A++++++++style_loss+%3Cspan+class%3D%22token+operator%22%3E%2B%3D%3C%2Fspan%3E+layer_style_loss+%3Cspan+class%3D%22token+operator%22%3E%2F%3C%2Fspan%3E+%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3Ed+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+h+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+w%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+calculate+the+*total*+loss%3C%2Fspan%3E%0A++++total_loss+%3Cspan+class%3D%22token+operator%22%3E%3D%3C%2Fspan%3E+content_weight+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+content_loss+%3Cspan+class%3D%22token+operator%22%3E%2B%3C%2Fspan%3E+style_weight+%3Cspan+class%3D%22token+operator%22%3E*%3C%2Fspan%3E+style_loss%0A++++%0A++++%3Cspan+class%3D%22token+comment%22%3E%23+update+your+target+image%3C%2Fspan%3E%0A++++optimizer%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Ezero_grad%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++total_loss%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Ebackward%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A++++optimizer%3Cspan+class%3D%22token+punctuation%22%3E.%3C%2Fspan%3Estep%3Cspan+class%3D%22token+punctuation%22%3E%28%3C%2Fspan%3E%3Cspan+class%3D%22token+punctuation%22%3E%29%3C%2Fspan%3E%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Fmdeditor%2Fmarkdown_views-7b4cdcb592.css%22+rel%3D%22stylesheet%22%3E+%0A%3C%2Fdiv%3E" | url_decode}}