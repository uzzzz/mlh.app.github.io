---
layout: default
title: 深度学习 | 斯坦福cs231n编程作业#1 --- k近邻算法(k-NN)
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E6%96%AF%E5%9D%A6%E7%A6%8Fcs231n%282017%E5%B9%B4%E7%89%88%29%E7%9A%84%E6%89%80%E6%9C%89%E7%BC%96%E7%A8%8B%E4%BD%9C%E4%B8%9A%E5%9D%87%E9%87%87%E7%94%A8iPython+Notebooks%E5%AE%9E%E7%8E%B0%EF%BC%8C%E4%B8%8D%E7%86%9F%E6%82%89%E7%9A%84%E6%9C%8B%E5%8F%8B%E5%8F%AF%E4%BB%A5%E6%8F%90%E5%89%8D%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%8BNotebooks%E3%80%82%E7%BC%96%E7%A8%8B%E4%BD%9C%E4%B8%9A%231%E4%B8%BB%E8%A6%81%E6%98%AF%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAkNN%E5%88%86%E7%B1%BB%E5%99%A8%E6%9D%A5%E5%AF%B9cifar-10%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E9%9B%86%E8%BF%9B%E8%A1%8C%E5%88%86%E7%B1%BB%E3%80%82%3C%2Fp%3E+%0A++%3Cp+id%3D%22main-toc%22%3E%3Cstrong%3E%E7%9B%AE%E5%BD%95%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%221.%25E5%25AE%259E%25E9%25AA%258C%25E7%25BB%25BC%25E8%25BF%25B0-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%231.%25E5%25AE%259E%25E9%25AA%258C%25E7%25BB%25BC%25E8%25BF%25B0%22+rel%3D%22nofollow%22%3E1.%E5%AE%9E%E9%AA%8C%E7%BB%BC%E8%BF%B0%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%222.%25E5%25AF%25BC%25E5%2585%25A5%25E5%25BF%2585%25E8%25A6%2581%25E7%259A%2584%25E5%258C%2585-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%232.%25E5%25AF%25BC%25E5%2585%25A5%25E5%25BF%2585%25E8%25A6%2581%25E7%259A%2584%25E5%258C%2585%22+rel%3D%22nofollow%22%3E2.%E5%AF%BC%E5%85%A5%E5%BF%85%E8%A6%81%E7%9A%84%E5%8C%85%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%223.%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%233.%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586%22+rel%3D%22nofollow%22%3E3.%E6%95%B0%E6%8D%AE%E9%9B%86%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%223.%25E5%25AE%259E%25E7%258E%25B0kNN%25E5%2588%2586%25E7%25B1%25BB%25E5%2599%25A8-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%233.%25E5%25AE%259E%25E7%258E%25B0kNN%25E5%2588%2586%25E7%25B1%25BB%25E5%2599%25A8%22+rel%3D%22nofollow%22%3E3.%E5%AE%9E%E7%8E%B0kNN%E5%88%86%E7%B1%BB%E5%99%A8%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%224.%25E4%25BA%25A4%25E5%258F%2589%25E9%25AA%258C%25E8%25AF%2581-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%234.%25E4%25BA%25A4%25E5%258F%2589%25E9%25AA%258C%25E8%25AF%2581%22+rel%3D%22nofollow%22%3E4.%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Chr+id%3D%22hr-toc%22%3E%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fpan.baidu.com%2Fs%2F1tIpOfQzZKTXwcbX26RygbA%22+rel%3D%22nofollow%22%3Ecs231%E5%85%A8%E9%83%A8%E7%BC%96%E7%A8%8B%E4%BD%9C%E4%B8%9A%28%E8%8B%B1%E6%96%87%E5%8E%9F%E7%89%88%E5%B8%A6%E7%AD%94%E6%A1%88%29%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fpan.baidu.com%2Fs%2F1BUCqNxc5P3FQ-qYmMPONRw%22+rel%3D%22nofollow%22%3Ecs231n%E5%85%A8%E9%83%A8%E7%BC%96%E7%A8%8B%E4%BD%9C%E4%B8%9A%28%E8%8B%B1%E6%96%87%E5%8E%9F%E7%89%88%E4%B8%8D%E5%B8%A6%E7%AD%94%E6%A1%88%29%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fpan.baidu.com%2Fs%2F1V_nvAhZfxzJfkVyn3tiKEQ%22+rel%3D%22nofollow%22%3E%E7%BC%96%E7%A8%8B%E4%BD%9C%E4%B8%9A%231%28%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E7%89%88%E5%B8%A6%E7%AD%94%E6%A1%88%29%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%221.%25E5%25AE%259E%25E9%25AA%258C%25E7%25BB%25BC%25E8%25BF%25B0%22%3E1.%E5%AE%9E%E9%AA%8C%E7%BB%BC%E8%BF%B0%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22300%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115211348636.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22847%22%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%222.%25E5%25AF%25BC%25E5%2585%25A5%25E5%25BF%2585%25E8%25A6%2581%25E7%259A%2584%25E5%258C%2585%22%3E2.%E5%AF%BC%E5%85%A5%E5%BF%85%E8%A6%81%E7%9A%84%E5%8C%85%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-php%22%3Eimport+random++%23Python%E5%86%85%E7%BD%AE%E7%9A%84%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%A8%A1%E5%9D%97%0Aimport+numpy+as+np%0Afrom+cs231n.data_utils+import+load_CIFAR10+%23cs231n%2Fdata_utils.py+%0Aimport+matplotlib.pyplot+as+plt%0A%0Afrom+__future__+import+print_function%0A%0A%25matplotlib+inline+%0A%23%E8%AF%A5%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0%E4%BD%BF%E5%BE%97matplotlib%E7%BB%98%E5%9B%BE%E5%9C%A8notebook%E4%B8%AD%E6%98%BE%E7%A4%BA%E4%B8%BA%E5%86%85%E8%81%94%E8%80%8C%E4%B8%8D%E6%98%AF%E5%9C%A8%E6%96%B0%E7%AA%97%E5%8F%A3%E4%B8%AD%0A%23%E8%AE%BE%E7%BD%AE%E7%BB%98%E5%9B%BE%E7%9A%84%E9%A3%8E%E6%A0%BC%0Aplt.rcParams%5B%27figure.figsize%27%5D+%3D+%2810.0%2C8.0%29+%23%E7%BB%98%E5%9B%BE%E7%9A%84%E9%BB%98%E8%AE%A4%E5%A4%A7%E5%B0%8F%0Aplt.rcParams%5B%27image.interpolation%27%5D+%3D+%27nearest%27%0Aplt.rcParams%5B%27image.cmap%27%5D+%3D+%27gray%27%0A%0A%23+notebook%E5%B0%86%E9%87%8D%E6%96%B0%E5%8A%A0%E8%BD%BD%E5%A4%96%E9%83%A8python%E6%A8%A1%E5%9D%97%0A%23+%E6%9F%A5%E7%9C%8B+http%3A%2F%2Fstackoverflow.com%2Fquestions%2F1907993%2Fautoreload-of-modules-in-ipython%0A%25load_ext+autoreload%0A%25autoreload+2%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2+id%3D%223.%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586%22%3E3.%E6%95%B0%E6%8D%AE%E9%9B%86%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E9%A6%96%E5%85%88%E8%BF%9B%E5%85%A5%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84cs231n%2Fdatasets%E7%9B%AE%E5%BD%95%EF%BC%8C%E6%9C%89%E4%B8%80%E4%B8%AAget_datasets.sh%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-bash%22%3E%23+Get+CIFAR10%0Awget+http%3A%2F%2Fwww.cs.toronto.edu%2F%7Ekriz%2Fcifar-10-python.tar.gz%0Atar+-xzvf+cifar-10-python.tar.gz%0Arm+cifar-10-python.tar.gz+%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E8%AF%A5%E8%84%9A%E6%9C%AC%E7%94%A8%E4%BA%8E%E4%B8%8B%E8%BD%BDcifar-10%E6%95%B0%E6%8D%AE%E9%9B%86%E5%B9%B6%E8%A7%A3%E5%8E%8B%EF%BC%8C%E7%84%B6%E5%90%8E%E5%88%A0%E9%99%A4%E5%8E%8B%E7%BC%A9%E5%8C%85%E3%80%82Mac%E7%94%A8%E6%88%B7%E5%8F%AF%E8%83%BD%E4%BC%9A%E6%8A%A5%E9%94%99%EF%BC%8C%E6%89%BE%E4%B8%8D%E5%88%B0wget%E5%91%BD%E4%BB%A4%EF%BC%8C%E6%AD%A4%E6%97%B6%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8Mac%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7homebrew%EF%BC%8C%E5%9C%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%BE%93%E5%85%A5+brew+install+wget+%E5%AE%89%E8%A3%85wget%E5%8D%B3%E5%8F%AF%28%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E5%AE%89%E8%A3%85homebrew%E7%9A%84%E8%AF%9D%E8%87%AA%E8%A1%8C%E7%99%BE%E5%BA%A6%E5%AE%89%E8%A3%85%EF%BC%89%E3%80%82%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E5%9C%A8%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%EF%BC%8C%E6%89%93%E5%BC%80%E5%91%BD%E4%BB%A4%E8%A1%8C%EF%BC%8C%E6%89%A7%E8%A1%8C%E8%AF%A5%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6.%2Fget_datasets.sh%2C%E5%BE%97%E5%88%B0%E8%A7%A3%E5%8E%8B%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2282%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F2019011521180619.png%22+width%3D%22428%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22400%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115213730477.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22774%22%3E%3C%2Fp%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%8A%A0%E8%BD%BD%E5%8E%9F%E5%A7%8BCIFAR-10+%E6%95%B0%E6%8D%AE%0Acifar10_dir+%3D+%27cs231n%2Fdatasets%2Fcifar-10-batches-py%2F%27%0AX_train%2Cy_train%2CX_test%2Cy_test+%3D+load_CIFAR10%28cifar10_dir%29%0A%0A%23%E6%9F%A5%E7%9C%8B%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E6%B5%8B%E8%AF%95%E9%9B%86%E7%9A%84%E5%A4%A7%E5%B0%8F%0Aprint%28%22Training+data+shape%3A+%22%2CX_train.shape%29%0Aprint%28%22Training+labels+shape%3A+%22%2Cy_train.shape%29%0Aprint%28%27Test+data+shape%3A+%27%2C+X_test.shape%29%0Aprint%28%27Test+labels+shape%3A+%27%2C+y_test.shape%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22166%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115214257438.png%22+width%3D%22788%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E6%9F%A5%E7%9C%8B%23cs231n%2Fdata_utils.py+%E4%B8%AD%E7%9A%84load_CIFAR10%E5%87%BD%E6%95%B0%EF%BC%8C%E5%AE%83%E7%94%A8%E4%BA%8E%E5%8A%A0%E8%BD%BDCIFAR-10%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Edef+load_CIFAR10%28ROOT%29%3A%0A++%22%22%22+%0A++%E5%8A%A0%E8%BD%BD%E6%89%80%E6%9C%89%E7%9A%84cifar+batch%0A++%0A++input%3A%0A++ROOT%3A%E8%A7%A3%E5%8E%8B%E5%90%8Ecifar%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E8%B7%AF%E5%BE%84%0A++%0A++output%3A%0A++Xtr%3A%E8%AE%AD%E7%BB%83%E9%9B%86+%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84%2850000%2C32%2C32%2C3%29%0A++Ytr%3A%E8%AE%AD%E7%BB%83%E9%9B%86%E5%9B%BE%E5%83%8F%E7%9A%84%E6%A0%87%E7%AD%BE+%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84+%2850000%2C%29++%E5%8F%96%E5%80%BC0-9+10%E4%B8%AA%E7%B1%BB%E5%88%AB%0A++Xte%3A%E6%B5%8B%E8%AF%95%E9%9B%86+%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84%2810000%2C32%2C32%2C3%29%0A++Yte%3A%E6%B5%8B%E8%AF%95%E9%9B%86%E5%9B%BE%E5%83%8F%E7%9A%84%E6%A0%87%E7%AD%BE+%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84+%2810000%2C%29+%E5%8F%96%E5%80%BC0-9+10%E4%B8%AA%E7%B1%BB%E5%88%AB%0A++%22%22%22%0A++%0A++xs+%3D+%5B%5D++%23%E5%88%97%E8%A1%A8+%E7%94%A8%E4%BA%8E%E5%AD%98%E5%82%A8cifar%E8%AE%AD%E7%BB%83%E9%9B%86+%E5%90%84%E4%B8%AAbatch%E7%9A%84%E6%95%B0%E6%8D%AE%28%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84%29%0A++ys+%3D+%5B%5D++%23%E5%88%97%E8%A1%A8+%E7%94%A8%E4%BA%8E%E5%AD%98%E5%82%A8cifar%E8%AE%AD%E7%BB%83%E9%9B%86+%E5%90%84%E4%B8%AAbatch%E7%9A%84%E6%A0%87%E7%AD%BE%E6%95%B0%E6%8D%AE%28%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%29%0A++for+b+in+range%281%2C6%29%3A%23b%E6%98%AF+batch%E7%9A%84%E7%BC%96%E5%8F%B7%0A++++f+%3D+os.path.join%28ROOT%2C+%27data_batch_%25d%27+%25+%28b%2C+%29%29+%23%E5%BE%97%E5%88%B0%E5%90%84%E4%B8%AAbacth%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84%0A++++X%2C+Y+%3D+load_CIFAR_batch%28f%29+%23%E5%BE%97%E5%88%B0%E5%90%84%E4%B8%AAbatch%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E5%92%8C%E6%A0%87%E7%AD%BE%0A++++xs.append%28X%29+%23%E5%B0%86%E6%AF%8F%E4%B8%AAbatch%E7%9A%84%E5%9B%BE%E7%89%87+%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84+%E8%BF%BD%E5%8A%A0%E5%88%B0xs%E4%B8%AD%0A++++ys.append%28Y%29+%23%E5%B0%86%E6%AF%8F%E4%B8%AAbatch%E7%9A%84%E5%9B%BE%E7%89%87%E6%A0%87%E7%AD%BE+%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84+%E8%BF%BD%E5%8A%A0%E5%88%B0ys%E4%B8%AD+++%0A++Xtr+%3D+np.concatenate%28xs%29++%23%E5%B0%86%E5%88%97%E8%A1%A8%E4%B8%AD%E6%89%80%E6%9C%89%E7%9A%84%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84%E6%8B%BC%E6%8E%A5%E8%B5%B7%E6%9D%A5++%E5%BE%97%E5%88%B0%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%AD%E7%BB%83%E9%9B%86%E5%9B%BE%E7%89%87%0A++Ytr+%3D+np.concatenate%28ys%29++%23%E5%B0%86%E5%88%97%E8%A1%A8%E4%B8%AD%E6%89%80%E6%9C%89%E7%9A%84%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%E6%8B%BC%E6%8E%A5%E8%B5%B7%E6%9D%A5+%E5%BE%97%E5%88%B0%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%AD%E7%BB%83%E9%9B%86%E6%A0%87%E7%AD%BE%0A++del+X%2C+Y++++%23%E5%88%A0%E9%99%A4%E4%B8%AD%E9%97%B4%E5%8F%98%E9%87%8FX%EF%BC%8CY%0A++Xte%2C+Yte+%3D+load_CIFAR_batch%28os.path.join%28ROOT%2C+%27test_batch%27%29%29+%23%E5%BE%97%E5%88%B0%E6%B5%8B%E8%AF%95%E9%9B%86%E5%9B%BE%E7%89%87%E5%92%8C%E6%A0%87%E7%AD%BE%0A++return+Xtr%2C+Ytr%2C+Xte%2C+Yte%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E6%9F%A5%E7%9C%8Bload_CIFAR_batch%E5%87%BD%E6%95%B0%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Edef+load_CIFAR_batch%28filename%29%3A%0A++%22%22%22+%0A++%E5%8A%A0%E8%BD%BDcifar%E4%B8%80%E4%B8%AAbatch%E7%9A%84%E6%95%B0%E6%8D%AE%0A++%0A++input%3A%0A++filename%3Abatch%E7%9A%84%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84%0A++%0A++output%3A%0A++X%3Abatch%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%9B%BE%E7%89%87+%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84%2810000%2C32%2C32%2C3%29%0A++Y%3Abatch%E4%B8%AD%E6%89%80%E6%9C%89%E5%9B%BE%E7%89%87%E6%A0%87%E7%AD%BE+%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%2810000%2C%29%0A++%22%22%22%0A++with+open%28filename%2C+%27rb%27%29+as+f%3A+%23%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6+%E4%BB%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%AF%BB%E5%8F%96%0A++++datadict+%3D+load_pickle%28f%29++%23%E5%BE%97%E5%88%B0%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8%0A++++X+%3D+datadict%5B%27data%27%5D+++++%23%E5%BE%97%E5%88%B0batch%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%9B%BE%E7%89%87+%0A++++Y+%3D+datadict%5B%27labels%27%5D+++%23%E5%BE%97%E5%88%B0batch%E4%B8%AD%E5%9B%BE%E7%89%87%E7%9A%84%E6%A0%87%E7%AD%BE+%0A++++X+%3D+X.reshape%2810000%2C+3%2C+32%2C+32%29.transpose%280%2C2%2C3%2C1%29.astype%28%22float%22%29+%23%E5%B0%86X%E8%BD%AC%E5%9E%8B%E4%B8%BA%2810000%2C3%2C32%2C32%29%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84%EF%BC%8C%E5%B9%B6%E8%B0%83%E6%8D%A2%E4%B8%80%E4%B8%8B%E5%90%84%E4%B8%AA%E8%BD%B4++%E5%BE%97%E5%88%B0%2810000%2C32%2C32%2C3%29%E5%9B%9B%E7%BB%B4%E6%95%B0%E7%BB%84++%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B%E4%B8%BAfloat%28np.float64%29%0A++++Y+%3D+np.array%28Y%29+%23%E5%B0%86Y%E5%8F%98%E4%B8%BA%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%0A++++return+X%2C+Y%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E6%9F%A5%E7%9C%8Bload_pickle%E5%87%BD%E6%95%B0%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Eimport+platform%0Afrom+six.moves+import+cPickle+as+pickle%0A%0Adef+load_pickle%28f%29%3A%0A++++version+%3D+platform.python_version_tuple%28%29%23%E5%BE%97%E5%88%B0Python%E7%89%88%E6%9C%AC++%0A++++if+version%5B0%5D+%3D%3D+%272%27%3A+%23%E9%92%88%E5%AF%B9Python2%0A++++++++return++pickle.load%28f%29%0A++++elif+version%5B0%5D+%3D%3D+%273%27%3A++%23%E9%92%88%E5%AF%B9Python3%0A++++++++return++pickle.load%28f%2C+encoding%3D%27latin1%27%29%0A++++raise+ValueError%28%22invalid+python+version%3A+%7B%7D%22.format%28version%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22120%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215121890.png%22+width%3D%22897%22%3E%3C%2Fp%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%E5%8F%AF%E8%A7%86%E5%8C%96%E9%83%A8%E5%88%86%E6%A0%B7%E6%9C%AC%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A0%B7%E6%9C%AC%0A%23%E5%B1%95%E7%A4%BA%E8%AE%AD%E7%BB%83%E9%9B%86%E4%B8%AD%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%88%AB%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A0%B7%E6%9C%AC%E5%9B%BE%E7%89%87%0Aclasses+%3D+%5B%27plane%27%2C%27car%27%2C%27bird%27%2C%27cat%27%2C%27deer%27%2C%27dog%27%2C%27frog%27%2C%27horse%27%2C%27ship%27%2C%27truck%27%5D%0Anum_classes+%3D+len%28classes%29+%2310%0Asamples_per_class+%3D+7+%23%E6%AF%8F%E4%B8%AA%E7%B1%BB%E5%88%AB%E5%8F%967%E4%B8%AA%E6%A0%B7%E6%9C%AC%0Afor+y%2Ccls+in+enumerate%28classes%29%3A%0A++++idxs+%3D+np.flatnonzero%28y_train%3D%3Dy%29%0A++++idxs+%3D+np.random.choice%28idxs%2C+samples_per_class%2C+replace%3DFalse%29%0A++++for+i%2C+idx+in+enumerate%28idxs%29%3A%0A++++++++plt_idx+%3D+i+*+num_classes+%2B+y+%2B+1%0A++++++++plt.subplot%28samples_per_class%2C+num_classes%2C+plt_idx%29%0A++++++++plt.imshow%28X_train%5Bidx%5D.astype%28%27uint8%27%29%29%0A++++++++plt.axis%28%27off%27%29%0A++++++++if+i+%3D%3D+0%3A%0A++++++++++++plt.title%28cls%29%0Aplt.show%28%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22400%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215233869.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22617%22%3E%3C%2Fp%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%E5%8F%96%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE%26nbsp%3B%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%8F%96%E4%B8%80%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE+%E4%BD%BF%E4%BB%A3%E7%A0%81%E8%BF%90%E8%A1%8C%E6%9B%B4%E5%BF%AB%0A%23%E8%AE%AD%E7%BB%83%E9%9B%86%E5%8F%96%E5%8E%9F%E5%A7%8B%E8%AE%AD%E7%BB%83%E9%9B%86%E7%9A%84%E5%89%8D5000%E5%BC%A0%0Anum_training+%3D+5000%0Amask+%3D+list%28range%285000%29%29%0AX_train+%3D+X_train%5Bmask%5D%0Ay_train+%3D+y_train%5Bmask%5D%0A%23%E6%B5%8B%E8%AF%95%E9%9B%86%E5%8F%96%E5%8E%9F%E5%A7%8B%E6%B5%8B%E8%AF%95%E9%9B%86%E7%9A%84%E5%89%8D500%E5%BC%A0%0Anum_test+%3D+500%0Amask+%3D+list%28range%28500%29%29%0AX_test+%3D+X_test%5Bmask%5D%0Ay_test+%3D+y_test%5Bmask%5D%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%E9%A2%84%E5%A4%84%E7%90%86%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E6%8A%8A%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E6%B5%8B%E8%AF%95%E9%9B%86%E5%BC%A0%E7%9A%84%E6%AF%8F%E5%BC%A0%E5%9B%BE%E7%89%8732*32*3+%E6%8B%89%E4%BC%B8%E4%B8%BA%E5%90%91%E9%87%8F%0AX_train+%3D+X_train.reshape%28%28X_train.shape%5B0%5D%2C-1%29%29+%23%285000%2C32*32*3%29+%0AX_test+%3D+X_test.reshape%28%28X_test.shape%5B0%5D%2C-1%29%29+%23%28500%2C32*32*3%29%0Aprint%28X_train.shape%2C+X_test.shape%29%0A%27%27%27%0A%E7%AD%89%E4%BB%B7%E5%86%99%E6%B3%95%0AX_train+%3D+np.reshape%28X_train%2C+%28X_train.shape%5B0%5D%2C+-1%29%29%0AX_test+%3D+np.reshape%28X_test%2C+%28X_test.shape%5B0%5D%2C+-1%29%29%0A%27%27%27%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2260%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215401331.png%22+width%3D%22458%22%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%223.%25E5%25AE%259E%25E7%258E%25B0kNN%25E5%2588%2586%25E7%25B1%25BB%25E5%2599%25A8%22%3E3.%E5%AE%9E%E7%8E%B0kNN%E5%88%86%E7%B1%BB%E5%99%A8%3C%2Fh2%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%E8%AE%AD%E7%BB%83kNN%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E6%9F%A5%E7%9C%8BkNN%E7%B1%BB%E4%B8%ADtrain%E6%96%B9%E6%B3%95%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E+def+train%28self%2C+X%2C+y%29%3A%0A++++%22%22%22%0A++++%E8%AE%AD%E7%BB%83KNN%E5%88%86%E7%B1%BB%E5%99%A8%EF%BC%8C%E5%8F%AA%E6%98%AF%E8%AE%B0%E4%BD%8F%E8%AE%AD%E7%BB%83%E9%9B%86%E7%9A%84%E6%95%B0%E6%8D%AE%0A%0A++++Inputs%3A%0A++++-+X%3A+%E8%AE%AD%E7%BB%83%E9%9B%86%E6%A0%B7%E6%9C%AC%2F%E5%9B%BE%E7%89%87%E7%9A%84%E7%89%B9%E5%BE%81%E7%9F%A9%E9%98%B5%EF%BC%8C%E6%AF%8F%E4%B8%80%E8%A1%8C%E4%BB%A3%E8%A1%A8%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E7%9A%84%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F%EF%BC%8C%E7%BB%B4%E5%BA%A6%28num_train%2C+D%29+%0A++++-+y%3A+%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%EF%BC%8C%E5%8C%85%E5%90%AB%E8%AE%AD%E7%BB%83%E9%9B%86%E4%B8%AD%E6%AF%8F%E4%B8%AA%E6%A0%B7%E6%9C%AC%2F%E5%9B%BE%E7%89%87%E7%9A%84%E6%A0%87%E7%AD%BE+%28num_train%2C%29+y%5Bi%5D+%E6%98%AF%E5%9B%BE%E7%89%87%2F%E6%A0%B7%E6%9C%AC+X%5Bi%5D%E7%9A%84%E6%A0%87%E7%AD%BE.%0A++++%22%22%22%0A++++self.X_train+%3D+X%0A++++self.y_train+%3D+y%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%AF%BC%E5%85%A5KNN%E7%B1%BB%0Afrom+cs231n.classifiers+import+KNearestNeighbor%0A%0A%23%E5%AE%9E%E4%BE%8B%E5%8C%96KNN%E7%B1%BB%E7%9A%84%E5%AF%B9%E8%B1%A1%0Aclassifier+%3D+KNearestNeighbor%28%29%0A%23%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E8%B0%83%E7%94%A8%E7%B1%BB%E4%B8%AD%E7%9A%84train%E6%96%B9%E6%B3%95%0A%23classfier%E5%8F%AA%E6%98%AF%E7%AE%80%E5%8D%95%E8%AE%B0%E4%BD%8F%E8%AE%AD%E7%BB%83%E9%9B%86%E7%9A%84%E6%95%B0%E6%8D%AE+%E6%B2%A1%E6%9C%89%E5%81%9A%E4%BB%BB%E4%BD%95%E5%A4%84%E7%90%86%0Aclassifier.train%28X_train%2Cy_train%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%E6%B5%8B%E8%AF%95%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22240%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215559407.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22815%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22100%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215623500.png%22+width%3D%22821%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E7%BC%96%E5%86%99%E7%B1%BB%E4%B8%AD%E7%9A%84%E8%AE%A1%E7%AE%97%E8%B7%9D%E7%A6%BB%E7%9A%84%E6%96%B9%E6%B3%95compute_distances_two_loops%3A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Edef+compute_distances_two_loops%28self%2C+X%29%3A%0A++++%22%22%22%0A++++%E8%AE%A1%E7%AE%97%E6%B5%8B%E8%AF%95%E9%9B%86X%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E8%AE%AD%E7%BB%83%E9%9B%86X_train%E4%B8%AD%E6%89%80%E6%9C%89%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E4%BD%BF%E7%94%A8%E4%B8%A4%E4%B8%AA%E5%BE%AA%E7%8E%AF%E9%81%8D%E5%8E%86%E6%89%80%E6%9C%89%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E5%92%8C%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E3%80%82%0A++++%0A++++Inputs%3A%0A++++-+X%3A+%E6%B5%8B%E8%AF%95%E9%9B%86%E6%A0%B7%E6%9C%AC%E7%9A%84%E7%89%B9%E5%BE%81%E7%9F%A9%E9%98%B5+%E6%AF%8F%E4%B8%80%E8%A1%8C%E4%BB%A3%E8%A1%A8%E4%B8%80%E4%B8%AA%E6%A0%B7%E6%9C%AC%2F%E5%9B%BE%E7%89%87%E7%9A%84%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F+%28num_test%2C+D%29+.%0A%0A++++Returns%3A%0A++++-+dists%3A+%E4%B8%80%E4%B8%AA%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84+%28num_test%2C+num_train%29%EF%BC%8C%28i%2Cj%29%E4%BB%A3%E8%A1%A8%E7%AC%ACi%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E7%AC%ACj%E4%B8%AA%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84L2%2F%E6%AC%A7%E6%B0%8F%E8%B7%9D%E7%A6%BB%E3%80%82%0A++++%22%22%22%0A++++%0A++++num_test+%3D+X.shape%5B0%5D+%23%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%2F%E5%9B%BE%E7%89%87%E6%95%B0%0A++++num_train+%3D+self.X_train.shape%5B0%5D+%23%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%2F%E5%9B%BE%E7%89%87%E6%95%B0%0A++++dists+%3D+np.zeros%28%28num_test%2C+num_train%29%29+%23%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%0A++++for+i+in+range%28num_test%29%3A%0A++++++for+j+in+range%28num_train%29%3A%0A++++++++dists%5Bi%5D%5Bj%5D+%3D+np.sqrt%28np.sum%28%28X%5Bi%5D-self.X_train%5Bj%5D%29**2%29%29%0A++++++++%0A++++return+dists%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E6%B5%8B%E8%AF%95%E5%AE%9E%E7%8E%B0%0A%23%E4%BD%BF%E7%94%A8kNN%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1classifier%E8%B0%83%E7%94%A8%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%0Adists+%3D+classifier.compute_distances_two_loops%28X_test%29%0Aprint%28dists.shape%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2268%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215649879.png%22+width%3D%22294%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E5%8F%AF%E8%A7%86%E5%8C%96%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%8F%AF%E8%A7%86%E5%8C%96%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5+%E6%AF%8F%E4%B8%80%E8%A1%8C%E4%BB%A3%E8%A1%A8%E4%B8%80%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E6%89%80%E6%9C%89%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84%E8%B7%9D%E7%A6%BB%0Aplt.imshow%28dists%2Cinterpolation%3D%27none%27%29%0Aplt.show%28%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22156%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115215835696.png%22+width%3D%22888%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E5%AE%9E%E7%8E%B0%E7%B1%BB%E4%B8%AD%E7%9A%84predict_labels%E6%96%B9%E6%B3%95%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Edef+predict_labels%28self%2C+dists%2C+k%3D1%29%3A%0A++++%22%22%22%0A++++%E7%BB%99%E5%AE%9A%E6%AF%8F%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E6%89%80%E6%9C%89%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5dists%2C%E5%BE%97%E5%88%B0%E6%AF%8F%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E7%9A%84%E6%A0%87%E7%AD%BE%E3%80%82%0A%0A++++Inputs%3A%0A++++-+dists%3A%E4%B8%80%E4%B8%AA%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84+%28num_test%2C+num_train%29%EF%BC%8C%28i%2Cj%29%E4%BB%A3%E8%A1%A8%E7%AC%ACi%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E7%AC%ACj%E4%B8%AA%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84L2%2F%E6%AC%A7%E6%B0%8F%E8%B7%9D%E7%A6%BB%E3%80%82%0A++++%0A++++Returns%3A%0A++++-+y%3A+%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84%EF%BC%8C%E5%8C%85%E5%90%AB%E6%AF%8F%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E7%9A%84%E9%A2%84%E6%B5%8B%E6%A0%87%E7%AD%BE%EF%BC%8C%E5%A4%A7%E5%B0%8F+%28num_test%2C%29++y%5Bi%5D+%E6%98%AF%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC+X%5Bi%5D%E7%9A%84%E9%A2%84%E6%B5%8B%E6%A0%87%E7%AD%BE.++%0A++++%22%22%22%0A++++num_test+%3D+dists.shape%5B0%5D+%23%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E7%9A%84%E6%95%B0%E9%87%8F%0A++++y_pred+%3D+np.zeros%28num_test%29+%23%E5%88%9D%E5%A7%8B%E5%8C%96y_pred%0A++++for+i+in+range%28num_test%29%3A%0A++++++++%23+closest_y%E5%8C%85%E5%90%AB%E4%B8%8E%E7%AC%ACi%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E6%9C%80%E8%BF%91%E7%9A%84k%E4%B8%AA%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84%E6%A0%87%E7%AD%BE%0A++++++++closest_y+%3D+%5B%5D%0A++++++++closest_y+%3D+self.y_train%5Bnp.argpartition%28dists%5Bi%5D%2Ck%29%5B0%3Ak%5D%5D%0A++++++++%23%E6%8A%95%E7%A5%A8+%E6%89%BE%E5%88%B0%E8%BF%99k%E4%B8%AA%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E6%A0%87%E7%AD%BE%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0%E6%9C%80%E5%A4%9A%E7%9A%84%E6%A0%87%E7%AD%BE%0A++++++++y_pred%5Bi%5D+%3D+np.argmax%28np.bincount%28closest_y%29%29%0A++++++++%27%27%27%0A++++++++%E7%AD%89%E4%BB%B7%E5%86%99%E6%B3%95%EF%BC%9A%0A++++++++distances%3Ddists%5Bi%2C%3A%5D%0A++++++++indexes+%3D+np.argsort%28distances%29%0A++++++++closest_y%3Dself.y_train%5Bindexes%5B%3Ak%5D%5D%0A++++++++%27%27%27%0A%0A++++return+y_pred%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%AE%9E%E7%8E%B0cs231n%2Fclassifiers%2Fk_nearest_neighbor.py%E4%B8%AD%E7%9A%84predict_labels%E6%96%B9%E6%B3%95+%0A%23%E6%B5%8B%E8%AF%95%E5%AE%9E%E7%8E%B0++%E4%BD%BF%E7%94%A8k%3D1++%0A%23%E4%BD%BF%E7%94%A8kNN%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1classifier%E8%B0%83%E7%94%A8%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%0Ay_test_pred+%3D+classifier.predict_labels%28dists%2Ck%3D1%29%0A%23%E8%AE%A1%E7%AE%97%E9%A2%84%E6%B5%8B%E5%87%86%E7%A1%AE%E7%8E%87%0Anum_correct+%3D+np.sum%28y_test_pred+%3D%3D+y_test%29%0Aaccuracy+%3D+float%28num_correct%29%2Fnum_test%0Aprint%28%27Got+%25d+%2F+%25d+correct+%3D%26gt%3B+accuracy%3A+%25f%27+%25+%28num_correct%2C+num_test%2C+accuracy%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22100%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115220322321.png%22+width%3D%22666%22%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Ey_test_pred+%3D+classifier.predict_labels%28dists%2C+k%3D5%29%0Anum_correct+%3D+np.sum%28y_test_pred+%3D%3D+y_test%29%0Aaccuracy+%3D+float%28num_correct%29+%2F+num_test%0Aprint%28%27Got+%25d+%2F+%25d+correct+%3D%26gt%3B+accuracy%3A+%25f%27+%25+%28num_correct%2C+num_test%2C+accuracy%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22100%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115220347200.png%22+width%3D%22557%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E4%BC%98%E5%8C%96%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%E7%9A%84%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%EF%BC%8C%E7%BC%96%E5%86%99%E7%B1%BB%E4%B8%AD%E7%9A%84%E8%AE%A1%E7%AE%97%E8%B7%9D%E7%A6%BB%E7%9A%84%E6%96%B9%E6%B3%95compute_distances_one_loops%3A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Edef+compute_distances_one_loop%28self%2C+X%29%3A%0A++++%22%22%22%0A+++%E8%AE%A1%E7%AE%97%E6%B5%8B%E8%AF%95%E9%9B%86X%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E8%AE%AD%E7%BB%83%E9%9B%86X_train%E4%B8%AD%E6%89%80%E6%9C%89%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA%E5%BE%AA%E7%8E%AF%E8%BF%9B%E8%A1%8C%E8%AE%A1%E7%AE%97%EF%BC%8C%E9%83%A8%E5%88%86%E5%90%91%E9%87%8F%E5%8C%96%0A%0A++++Input+%2F+Output%3A+%E5%92%8C+compute_distances_two_loops%E7%9B%B8%E5%90%8C%0A++++%22%22%22%0A++++num_test+%3D+X.shape%5B0%5D+%23%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E6%95%B0%0A++++num_train+%3D+self.X_train.shape%5B0%5D+%23%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E6%95%B0%0A++++dists+%3D+np.zeros%28%28num_test%2C+num_train%29%29%23%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%0A++++for+i+in+range%28num_test%29%3A%0A++++++++dists%5Bi%2C%3A%5D+%3D+np.sqrt%28np.sum%28%28X%5Bi%5D-self.X_train%29**2%2Caxis%3D1%29%29%0A++++%0A++++return+dists%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E5%8A%A0%E9%80%9F%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%E7%9A%84%E8%AE%A1%E7%AE%97%EF%BC%8C%E9%87%87%E7%94%A8%E9%83%A8%E5%88%86%E5%90%91%E9%87%8F%E5%8C%96+%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E5%BE%AA%E7%8E%AF%0A%23%E5%AE%9E%E7%8E%B0cs231n%2Fclassifiers%2Fk_nearest_neighbor.py%E4%B8%AD%E7%9A%84compute_distances_one_loops%E6%96%B9%E6%B3%95%0A%23%E4%BD%BF%E7%94%A8kNN%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1classifier%E8%B0%83%E7%94%A8%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%0Adists_one+%3D+classifier.compute_distances_one_loop%28X_test%29%0A%23%E8%AE%A1%E7%AE%97%E4%B8%A4%E4%B8%AA%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%E7%9A%84%E7%9B%B8%E4%BC%BC%E5%BA%A6+%E4%BD%BF%E7%94%A8Frobenius+norm+%EF%BC%9B%E4%B8%A4%E4%B8%AA%E7%9F%A9%E9%98%B5%E7%9A%84L2%E8%B7%9D%E7%A6%BB%0Adifference+%3D+np.linalg.norm%28dists+-+dists_one%2Cord+%3D+%27fro%27%29%0Aprint%28%27Difference+was%3A+%25f%27+%25+%28difference%2C+%29%29%0Aif+difference+%26lt%3B+0.001%3A%0A++++print%28%27Good%21+The+distance+matrices+are+the+same%27%29%0Aelse%3A%0A++++print%28%27Uh-oh%21+The+distance+matrices+are+different%27%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2298%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115220552599.png%22+width%3D%22782%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E8%BF%9B%E4%B8%80%E6%AD%A5%E4%BC%98%E5%8C%96%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%E7%9A%84%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%EF%BC%8C%E7%BC%96%E5%86%99%E7%B1%BB%E4%B8%AD%E7%9A%84%E8%AE%A1%E7%AE%97%E8%B7%9D%E7%A6%BB%E7%9A%84%E6%96%B9%E6%B3%95compute_distances_no_loops%3A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Edef+compute_distances_no_loops%28self%2C+X%29%3A%0A++++%22%22%22%0A++++%E8%AE%A1%E7%AE%97%E6%B5%8B%E8%AF%95%E9%9B%86X%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A0%B7%E6%9C%AC%E5%92%8C%E8%AE%AD%E7%BB%83%E9%9B%86X_train%E4%B8%AD%E6%89%80%E6%9C%89%E8%AE%AD%E7%BB%83%E6%A0%B7%E6%9C%AC%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E4%B8%8D%E4%BD%BF%E7%94%A8%E4%BB%BB%E4%BD%95%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%AE%8C%E5%85%A8%E5%90%91%E9%87%8F%E5%8C%96%E3%80%82%0A%0A++++Input+%2F+Output%3A+%E5%92%8Ccompute_distances_two_loops%E7%9B%B8%E5%90%8C%0A++++%22%22%22%0A++++num_test+%3D+X.shape%5B0%5D%0A++++num_train+%3D+self.X_train.shape%5B0%5D%0A++++dists+%3D+np.zeros%28%28num_test%2C+num_train%29%29+%0A++++%0A++++te+%3D+np.sum%28np.square%28X%29%2Caxis%3D1%29%0A++++tr+%3D+np.sum%28np.square%28self.X_train%29%2Caxis%3D1%29%0A++++M+%3D+np.dot%28X%2Cself.X_train.T%29%0A++++dists+%3D+np.sqrt%28te.reshape%28%28num_test%2C1%29%29%2Btr-2*M%29+%23%28500%2C1%29%2B%285000%2C%29+-%26gt%3B+%28500%2C5000%29%2B%28500%2C5000%29+%E5%B9%BF%E6%92%AD%0A++++%0A++++return+dists%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E7%8E%B0%E5%9C%A8%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%E7%9A%84%E5%AE%8C%E5%85%A8%E5%90%91%E9%87%8F%E5%8C%96%E7%89%88%E6%9C%AC+%E6%B2%A1%E6%9C%89%E5%BE%AA%E7%8E%AF%0A%23%E5%AE%9E%E7%8E%B0cs231n%2Fclassifiers%2Fk_nearest_neighbor.py%E4%B8%AD%E7%9A%84compute_distances_no_loops%E6%96%B9%E6%B3%95%0A%23%E4%BD%BF%E7%94%A8kNN%E7%B1%BB%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1classifier%E8%B0%83%E7%94%A8%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95%0Adists_two+%3D+classifier.compute_distances_no_loops%28X_test%29%0A%23%E8%AE%A1%E7%AE%97%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%BC%BC%E5%BA%A6%2F%E8%8C%83%E6%95%B0++F%E8%8C%83%E6%95%B0%0Adifference+%3D+np.linalg.norm%28dists+-+dists_two%2C+ord%3D%27fro%27%29%0Aprint%28%27Difference+was%3A+%25f%27+%25+%28difference%2C+%29%29%0Aif+difference+%26lt%3B+0.001%3A%0A++++print%28%27Good%21+The+distance+matrices+are+the+same%27%29%0Aelse%3A%0A++++print%28%27Uh-oh%21+The+distance+matrices+are+different%27%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2294%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115220822893.png%22+width%3D%22754%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E6%AF%94%E8%BE%83%E4%B8%8D%E5%90%8C%E8%B7%9D%E7%A6%BB%E7%9F%A9%E9%98%B5%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%E7%9A%84%E9%80%9F%E5%BA%A6%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E6%AF%94%E8%BE%83%E4%B8%8D%E5%90%8C%E5%AE%9E%E7%8E%B0%E7%89%88%E6%9C%AC%E7%9A%84%E9%80%9F%E5%BA%A6%0Adef+time_function%28f%2C+*args%29%3A%0A++++%22%22%22%0A++++Call+a+function+f+with+args+and+return+the+time+%28in+seconds%29+that+it+took+to+execute.%0A++++%22%22%22%0A++++import+time%0A++++tic+%3D+time.time%28%29%0A++++f%28*args%29%0A++++toc+%3D+time.time%28%29%0A++++return+toc+-+tic%0A%0Atwo_loop_time+%3D+time_function%28classifier.compute_distances_two_loops%2C+X_test%29%0Aprint%28%27Two+loop+version+took+%25f+seconds%27+%25+two_loop_time%29%0A%0Aone_loop_time+%3D+time_function%28classifier.compute_distances_one_loop%2C+X_test%29%0Aprint%28%27One+loop+version+took+%25f+seconds%27+%25+one_loop_time%29%0A%0Ano_loop_time+%3D+time_function%28classifier.compute_distances_no_loops%2C+X_test%29%0Aprint%28%27No+loop+version+took+%25f+seconds%27+%25+no_loop_time%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22208%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115220920352.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22754%22%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%224.%25E4%25BA%25A4%25E5%258F%2589%25E9%25AA%258C%25E8%25AF%2581%22%3E4.%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22140%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115220940334.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22803%22%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3Enum_folds+%3D+5+%235-%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81++%E6%8A%8A%E8%AE%AD%E7%BB%83%E9%9B%86%E5%88%86%E4%B8%BA5%E4%BB%BD++%E4%BB%BB%E6%84%8F4%E4%BB%BD%E8%BF%9B%E8%A1%8C%E8%AE%AD%E7%BB%83%EF%BC%8C%E4%B8%80%E4%BB%BD%E8%BF%9B%E8%A1%8C%E9%AA%8C%E8%AF%81%0A%23%E9%92%88%E5%AF%B9%E5%90%8C%E4%B8%80%E4%B8%AA%E8%B6%85%E5%8F%82%E6%95%B0%2F%E5%90%8C%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9E%8B%E8%A6%81%E8%AE%AD%E7%BB%835%E6%AC%A1+%0Ak_choices+%3D+%5B1%2C3%2C5%2C8%2C10%2C12%2C15%2C20%2C50%2C100%5D+%23%E5%8F%AF%E9%80%89%E6%8B%A9%E7%9A%84k%E5%80%BC%0A%0AX_train_folds+%3D+%5B%5D%0Ay_train_folds+%3D+%5B%5D%0A%0AX_train_folds+%3D+np.array_split%28X_train%2Cnum_folds%29%0Ay_train_folds+%3D+np.array_split%28y_train%2Cnum_folds%29%0A%0Ak_to_accuracies+%3D+%7B%7D+%23%E7%94%A8%E5%AD%97%E5%85%B8%E5%AD%98%E5%82%A8+%E4%B8%8D%E5%90%8C%E8%B6%85%E5%8F%82%E6%95%B0k%E4%B8%8B+%E5%8F%96%E5%BE%97%E7%9A%84%E5%87%86%E7%A1%AE%E7%8E%87%0Afor+ki+in+k_choices%3A++%23%E6%AF%8F%E4%B8%AA%E8%B6%85%E5%8F%82%E6%95%B0k%E9%83%BD%E6%9C%895%E4%B8%AA%E5%87%86%E7%A1%AE%E7%8E%87+%E7%94%A8%E5%88%97%E8%A1%A8%E5%AD%98%E5%82%A8%0A++++k_to_accuracies%5Bki%5D+%3D+%5B%5D%0A%23%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%0Afor+ki+in+k_choices%3A%0A++++for+fi+in+range%28num_folds%29%3A%0A++++++++X_traini+%3D+np.vstack%28%28X_train_folds%5B0%3Afi%5D%2BX_train_folds%5Bfi%2B1%3A%5D%29%29%0A++++++++y_traini+%3D+np.hstack%28%28y_train_folds%5B0%3Afi%5D%2By_train_folds%5Bfi%2B1%3A%5D%29%29%0A++++++++%0A++++++++%23%E5%AE%9E%E4%BE%8B%E5%8C%96KNN%E7%B1%BB%E5%AF%B9%E8%B1%A1%0A++++++++classifier+%3D+KNearestNeighbor%28%29%0A++++++++%23%E8%AE%AD%E7%BB%83%0A++++++++classifier.train%28X_traini%2Cy_traini%29%0A++++++++%0A++++++++dists+%3D+classifier.compute_distances_no_loops%28X_train_folds%5Bfi%5D%29%0A++++++++%0A++++++++y_predi+%3D+classifier.predict_labels%28dists%2Cki%29%0A++++++++%0A++++++++num_correct+%3D+np.sum%28y_predi%3D%3Dy_train_folds%5Bfi%5D%29%0A++++++++accuracyi+%3D+float%28num_correct%29%2Flen%28y_predi%29%0A++++++++k_to_accuracies%5Bki%5D.append%28accuracyi%29%0A%0Afor+k+in+sorted%28k_to_accuracies%29%3A%0A++++for+accuracy+in+k_to_accuracies%5Bk%5D%3A%0A++++++++print%28%27k+%3D+%25d%2C+accuracy+%3D+%25f%27+%25+%28k%2C+accuracy%29%29%0A++++++++%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-indent%3A50px%3B%22%3E%E7%BB%98%E5%9B%BE%EF%BC%9A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E7%BB%98%E5%9B%BE%0Afor+k+in+k_choices%3A%0A++++accuracies+%3D+k_to_accuracies%5Bk%5D%0A++++plt.scatter%28%5Bk%5D+*+len%28accuracies%29%2C+accuracies%29%0A%0Aaccuracies_mean+%3D+np.array%28%5Bnp.mean%28v%29+for+k%2Cv+in+sorted%28k_to_accuracies.items%28%29%29%5D%29%0Aaccuracies_std+%3D+np.array%28%5Bnp.std%28v%29+for+k%2Cv+in+sorted%28k_to_accuracies.items%28%29%29%5D%29%0A%0Aplt.errorbar%28k_choices%2C+accuracies_mean%2C+yerr%3Daccuracies_std%29%0Aplt.title%28%27Cross-validation+on+k%27%29%0Aplt.xlabel%28%27k%27%29%0Aplt.ylabel%28%27Cross-validation+accuracy%27%29%0Aplt.show%28%29%0Aprint%28accuracies_mean%29%0Aprint%28accuracies_std%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22500%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115221045172.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22798%22%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%9F%BA%E4%BA%8E%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%8C%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E6%9C%80%E5%A5%BD%E7%9A%84k%E5%80%BC%0A%23%E7%84%B6%E5%90%8E%E7%94%A8%E8%BF%99%E4%B8%AAk%E5%80%BC+%E9%87%8D%E6%96%B0%E5%9C%A8%E5%85%A8%E9%83%A8%E8%AE%AD%E7%BB%83%E9%9B%86%E4%B8%8A%E8%BF%9B%E8%A1%8C%E8%AE%AD%E7%BB%83++%E5%86%8D%E5%9C%A8%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%8A%E6%B5%8B%E8%AF%95%0Abest_k+%3D+1%0A%0Aclassifier+%3D+KNearestNeighbor%28%29%0Aclassifier.train%28X_train%2C+y_train%29%0Ay_test_pred+%3D+classifier.predict%28X_test%2C+k%3Dbest_k%29%0A%0A%23+%E8%AE%A1%E7%AE%97%E5%87%86%E7%A1%AE%E7%8E%87%0Anum_correct+%3D+np.sum%28y_test_pred+%3D%3D+y_test%29%0Aaccuracy+%3D+float%28num_correct%29+%2F+num_test%0Aprint%28%27Got+%25d+%2F+%25d+correct+%3D%26gt%3B+accuracy%3A+%25f%27+%25+%28num_correct%2C+num_test%2C+accuracy%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%2284%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115221209990.png%22+width%3D%22804%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}