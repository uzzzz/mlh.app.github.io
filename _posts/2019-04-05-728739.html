---
layout: default
title: 122.Spark大型电商项目-广告点击流量实时统计-生产环境测试
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E++%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp+id%3D%22main-toc%22%3E%3Cstrong%3E%E7%9B%AE%E5%BD%95%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%22%25E5%25B9%25BF%25E5%2591%258A%25E7%2582%25B9%25E5%2587%25BB%25E5%25AE%259E%25E6%2597%25B6%25E4%25BB%25A3%25E7%25A0%2581-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%23%25E5%25B9%25BF%25E5%2591%258A%25E7%2582%25B9%25E5%2587%25BB%25E5%25AE%259E%25E6%2597%25B6%25E4%25BB%25A3%25E7%25A0%2581%22+rel%3D%22nofollow%22%3E%E5%B9%BF%E5%91%8A%E7%82%B9%E5%87%BB%E5%AE%9E%E6%97%B6%E4%BB%A3%E7%A0%81%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%22MockRealTimeData.java-toc%22+style%3D%22margin-left%3A80px%3B%22%3E%3Ca+href%3D%22%23MockRealTimeData.java%22+rel%3D%22nofollow%22%3EMockRealTimeData.java%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Chr+id%3D%22hr-toc%22%3E%0A++%3Cp%3E%E6%9C%AC%E7%AF%87%E6%96%87%E7%AB%A0%E8%AE%B0%E5%BD%95%E5%B9%BF%E5%91%8A%E7%82%B9%E5%87%BB%E6%B5%81%E9%87%8F%E5%AE%9E%E6%97%B6%E7%BB%9F%E8%AE%A1-%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95%E3%80%82%3C%2Fp%3E+%0A++%3Ch2+id%3D%22%25E5%25B9%25BF%25E5%2591%258A%25E7%2582%25B9%25E5%2587%25BB%25E5%25AE%259E%25E6%2597%25B6%25E4%25BB%25A3%25E7%25A0%2581%22%3E%E5%B9%BF%E5%91%8A%E7%82%B9%E5%87%BB%E5%AE%9E%E6%97%B6%E4%BB%A3%E7%A0%81%3C%2Fh2%3E+%0A++%3Ch3+id%3D%22MockRealTimeData.java%22%3EMockRealTimeData.java%3C%2Fh3%3E+%0A++%3Cblockquote%3E+%0A+++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-java%22%3Epackage+graduation.java.test%3B%0A%0Aimport+java.util.Date%3B%0Aimport+java.util.HashMap%3B%0Aimport+java.util.Map%3B%0Aimport+java.util.Properties%3B%0Aimport+java.util.Random%3B%0A%0Aimport+kafka.javaapi.producer.Producer%3B%0Aimport+kafka.producer.KeyedMessage%3B%0Aimport+kafka.producer.ProducerConfig%3B%0A%0A%2F**%0A+*+FileName%3A+MockRealTimeData%0A+*+Author%3A+++hadoop%0A+*+Email%3A++++3165845957%40qq.com%0A+*+Date%3A+++++19-4-5+%E4%B8%8B%E5%8D%8810%3A40%0A+*+Description%3A%0A+*%E6%A8%A1%E6%8B%9F%E5%B9%BF%E5%91%8A%E7%82%B9%E5%87%BB%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%0A+*%2F%0Apublic+class+MockRealTimeData+extends+Thread+%7B%0A%0A++++private+static+final+Random+random+%3D+new+Random%28%29%3B%0A++++private+static+final+String%5B%5D+provinces+%3D+new+String%5B%5D%7B%22Jiangsu%22%2C+%22Hubei%22%2C+%22Hunan%22%2C+%22Henan%22%2C+%22Hebei%22%7D%3B%0A++++private+static+final+Map%26lt%3BString%2C+String%5B%5D%26gt%3B+provinceCityMap+%3D+new+HashMap%26lt%3BString%2C+String%5B%5D%26gt%3B%28%29%3B%0A%0A++++private+Producer%26lt%3BInteger%2C+String%26gt%3B+producer%3B%0A%0A++++public+MockRealTimeData%28%29+%7B%0A++++++++provinceCityMap.put%28%22Jiangsu%22%2C+new+String%5B%5D+%7B%22Nanjing%22%2C+%22Suzhou%22%7D%29%3B%0A++++++++provinceCityMap.put%28%22Hubei%22%2C+new+String%5B%5D+%7B%22Wuhan%22%2C+%22Jingzhou%22%7D%29%3B%0A++++++++provinceCityMap.put%28%22Hunan%22%2C+new+String%5B%5D+%7B%22Changsha%22%2C+%22Xiangtan%22%7D%29%3B%0A++++++++provinceCityMap.put%28%22Henan%22%2C+new+String%5B%5D+%7B%22Zhengzhou%22%2C+%22Luoyang%22%7D%29%3B%0A++++++++provinceCityMap.put%28%22Hebei%22%2C+new+String%5B%5D+%7B%22Shijiazhuang%22%2C+%22Tangshan%22%7D%29%3B%0A%0A++++++++producer+%3D+new+Producer%26lt%3BInteger%2C+String%26gt%3B%28createProducerConfig%28%29%29%3B%0A++++%7D%0A%0A++++private+ProducerConfig+createProducerConfig%28%29+%7B%0A++++++++Properties+props+%3D+new+Properties%28%29%3B%0A++++++++props.put%28%22serializer.class%22%2C+%22kafka.serializer.StringEncoder%22%29%3B%0A++++++++props.put%28%22metadata.broker.list%22%2C+%22172.17.0.1%3A9092%2C172.17.0.1%3A9092%2C172.17.0.1%3A9092%22%29%3B%0A++++++++return+new+ProducerConfig%28props%29%3B%0A++++%7D%0A%0A++++public+void+run%28%29+%7B%0A++++++++while%28true%29+%7B%0A++++++++++++String+province+%3D+provinces%5Brandom.nextInt%285%29%5D%3B%0A++++++++++++String+city+%3D+provinceCityMap.get%28province%29%5Brandom.nextInt%282%29%5D%3B%0A%0A++++++++++++String+log+%3D+new+Date%28%29.getTime%28%29+%2B+%22+%22+%2B+province+%2B+%22+%22+%2B+city+%2B+%22+%22%0A++++++++++++++++++++%2B+random.nextInt%281000%29+%2B+%22+%22+%2B+random.nextInt%2810%29%3B%0A++++++++++++producer.send%28new+KeyedMessage%26lt%3BInteger%2C+String%26gt%3B%28%22AdRealTimeLog%22%2C+log%29%29%3B%0A%0A++++++++++++try+%7B%0A++++++++++++++++Thread.sleep%28100%29%3B%0A++++++++++++%7D+catch+%28InterruptedException+e%29+%7B%0A++++++++++++++++e.printStackTrace%28%29%3B%0A++++++++++++%7D%0A++++++++%7D%0A++++%7D%0A%0A++++%2F**%0A+++++*+%E5%90%AF%E5%8A%A8Kafka+Producer%0A+++++*+%40param+args%0A+++++*%2F%0A++++public+static+void+main%28String%5B%5D+args%29+%7B%0A++++++++MockRealTimeData+producer+%3D+new+MockRealTimeData%28%29%3B%0A++++++++producer.start%28%29%3B%0A++++%7D%0A%0A%7D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3C%2Fblockquote%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}