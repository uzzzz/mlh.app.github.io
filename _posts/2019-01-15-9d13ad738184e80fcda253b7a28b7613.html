---
layout: default
title: 机器学习 | 机器学习100天(5) --- k-近邻算法(k-NN)
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp%3E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0100%E5%A4%A9%E7%B3%BB%E5%88%97%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E5%9F%BA%E4%BA%8E%3Ca+href%3D%22https%3A%2F%2Fgithub.com%2FAvik-Jain%2F100-Days-of-ML-Code-Chinese-Version%22+rel%3D%22nofollow%22%3E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0100%E5%A4%A9%28%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E7%89%88%29%3C%2Fa%3E%2C%3Ca+href%3D%22https%3A%2F%2Fgithub.com%2FAvik-Jain%2F100-Days-Of-ML-Code%22+rel%3D%22nofollow%22%3E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0100%E5%A4%A9%28%E8%8B%B1%E6%96%87%E5%8E%9F%E7%89%88%EF%BC%89%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3E%E6%89%80%E6%9C%89%E4%BB%A3%E7%A0%81%E4%BD%BF%E7%94%A8iPython+Notebook%E5%AE%9E%E7%8E%B0%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fpan.baidu.com%2Fs%2F1ya1nzCndVHThooLl7Cg36w%22+rel%3D%22nofollow%22%3E%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%22main-toc%22%3E%3Cstrong%3E%E7%9B%AE%E5%BD%95%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%22%25E5%25AE%259E%25E9%25AA%258C%25E7%25BB%25BC%25E8%25BF%25B0-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%23%25E5%25AE%259E%25E9%25AA%258C%25E7%25BB%25BC%25E8%25BF%25B0%22+rel%3D%22nofollow%22%3E%E5%AE%9E%E9%AA%8C%E7%BB%BC%E8%BF%B0%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%22%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%23%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586%22+rel%3D%22nofollow%22%3E%E6%95%B0%E6%8D%AE%E9%9B%86%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%221.%25E6%2595%25B0%25E6%258D%25AE%25E9%25A2%2584%25E5%25A4%2584%25E7%2590%2586-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%231.%25E6%2595%25B0%25E6%258D%25AE%25E9%25A2%2584%25E5%25A4%2584%25E7%2590%2586%22+rel%3D%22nofollow%22%3E1.%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%222.%25E4%25BD%25BF%25E7%2594%25A8k-NN%25E5%25AF%25B9%25E8%25AE%25AD%25E7%25BB%2583%25E9%259B%2586%25E8%25BF%259B%25E8%25A1%258C%25E8%25AE%25AD%25E7%25BB%2583-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%232.%25E4%25BD%25BF%25E7%2594%25A8k-NN%25E5%25AF%25B9%25E8%25AE%25AD%25E7%25BB%2583%25E9%259B%2586%25E8%25BF%259B%25E8%25A1%258C%25E8%25AE%25AD%25E7%25BB%2583%22+rel%3D%22nofollow%22%3E2.%E4%BD%BF%E7%94%A8k-NN%E5%AF%B9%E8%AE%AD%E7%BB%83%E9%9B%86%E8%BF%9B%E8%A1%8C%E8%AE%AD%E7%BB%83%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%223.%25E5%25AF%25B9%25E6%25B5%258B%25E8%25AF%2595%25E9%259B%2586%25E8%25BF%259B%25E8%25A1%258C%25E9%25A2%2584%25E6%25B5%258B-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%233.%25E5%25AF%25B9%25E6%25B5%258B%25E8%25AF%2595%25E9%259B%2586%25E8%25BF%259B%25E8%25A1%258C%25E9%25A2%2584%25E6%25B5%258B%22+rel%3D%22nofollow%22%3E3.%E5%AF%B9%E6%B5%8B%E8%AF%95%E9%9B%86%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp+id%3D%224.%25E7%2594%259F%25E6%2588%2590%25E6%25B7%25B7%25E6%25B7%2586%25E7%259F%25A9%25E9%2598%25B5-toc%22+style%3D%22margin-left%3A40px%3B%22%3E%3Ca+href%3D%22%234.%25E7%2594%259F%25E6%2588%2590%25E6%25B7%25B7%25E6%25B7%2586%25E7%259F%25A9%25E9%2598%25B5%22+rel%3D%22nofollow%22%3E4.%E7%94%9F%E6%88%90%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Chr+id%3D%22hr-toc%22%3E%0A++%3Ch2+id%3D%22%25E5%25AE%259E%25E9%25AA%258C%25E7%25BB%25BC%25E8%25BF%25B0%22%3E%E5%AE%9E%E9%AA%8C%E7%BB%BC%E8%BF%B0%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22850%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115192002928.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22809%22%3E%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22800%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115192044566.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22855%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22800%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F2019011519210786.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22826%22%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%22%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586%22%3E%E6%95%B0%E6%8D%AE%E9%9B%86%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22900%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115192249740.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22812%22%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%221.%25E6%2595%25B0%25E6%258D%25AE%25E9%25A2%2584%25E5%25A4%2584%25E7%2590%2586%22%3E1.%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86%3C%2Fh2%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22300%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115192313287.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22862%22%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%27%27%271.+%E5%AF%BC%E5%85%A5%E7%9B%B8%E5%85%B3%E5%BA%93%27%27%27%0Aimport+numpy+as+np%0Aimport+pandas+as+pd%0Aimport+matplotlib.pyplot+as+plt%0A%25matplotlib+inline%0A%0A%27%27%272.+%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E9%9B%86%27%27%27%0Adata+%3D+pd.read_csv%28%27Social_Network_Ads.csv%27%29%0Aprint%28data.head%28%29%29%0A%23%E5%88%86%E7%A6%BB%E7%89%B9%E5%BE%81%E7%9F%A9%E9%98%B5X%E5%92%8C%E6%A0%87%E7%AD%BE%E5%90%91%E9%87%8FY%0AX+%3D+data.iloc%5B%3A%2C2%3A-1%5D.values+%23%E5%8F%AA%E4%BD%BF%E7%94%A8%E5%B9%B4%E9%BE%84%E5%92%8C%E9%A2%84%E4%BC%B0%E8%96%AA%E8%B5%84%E4%B8%A4%E4%B8%AA%E7%89%B9%E5%BE%81%0AY+%3D+data.iloc%5B%3A%2C-1%5D.values%0A%0A%27%27%273.+%E6%A3%80%E6%9F%A5%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE%27%27%27%0A%23%E6%B2%A1%E6%9C%89%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE%0A%0A%27%27%274.+%E8%A7%A3%E6%9E%90%E5%88%86%E7%B1%BB%E6%95%B0%E6%8D%AE%27%27%27%0A%23%E6%B2%A1%E6%9C%89%E5%88%86%E7%B1%BB%E6%95%B0%E6%8D%AE+%E4%B8%8D%E9%9C%80%E8%A6%81%E6%95%B0%E5%AD%97%E5%8C%96%2F%E8%BD%AC%E5%8C%96one-hot%E7%BC%96%E7%A0%81%0A%0A%27%27%275.+%E9%81%BF%E5%85%8D%E8%99%9A%E6%8B%9F%E5%8F%98%E9%87%8F%E9%99%B7%E9%98%B1%27%27%27%0A%23%E6%B2%A1%E6%9C%89%E8%99%9A%E6%8B%9F%E5%8F%98%E9%87%8F%0A%0A%27%27%276.+%E5%88%86%E5%89%B2%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%BA%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E6%B5%8B%E8%AF%95%E9%9B%86%27%27%27%0Afrom+sklearn.model_selection+import+train_test_split%0AX_train%2CX_test%2CY_train%2CY_test+%3D+train_test_split%28X%2CY%2Ctest_size%3D0.25%2Crandom_state%3D0%29%0A%0A%27%27%277.+%E7%89%B9%E5%BE%81%E7%BC%A9%E6%94%BE%27%27%27%0Afrom+sklearn.preprocessing+import+StandardScaler%0A%23%E5%AE%9E%E4%BE%8B%E5%8C%96StandardScaler%E7%B1%BB%E7%9A%84%E5%AF%B9%E8%B1%A1%0Asc+%3D+StandardScaler%28%29%0A%23%E7%94%A8%E5%AF%B9%E8%B1%A1%E8%B0%83%E7%94%A8%E7%B1%BB%E5%86%85%E7%9A%84%E7%89%B9%E5%BE%81%E7%BC%A9%E6%94%BE%E6%96%B9%E6%B3%95%0AX_train+%3D+sc.fit_transform%28X_train%29%0AX_test+%3D+sc.fit_transform%28X_test%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22160%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115192343535.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NkdV9oYW8%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22728%22%3E%3C%2Fp%3E+%0A++%3Ch2+id%3D%222.%25E4%25BD%25BF%25E7%2594%25A8k-NN%25E5%25AF%25B9%25E8%25AE%25AD%25E7%25BB%2583%25E9%259B%2586%25E8%25BF%259B%25E8%25A1%258C%25E8%25AE%25AD%25E7%25BB%2583%22%3E2.%E4%BD%BF%E7%94%A8k-NN%E5%AF%B9%E8%AE%AD%E7%BB%83%E9%9B%86%E8%BF%9B%E8%A1%8C%E8%AE%AD%E7%BB%83%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E5%AF%BC%E5%85%A5kNN%E5%88%86%E7%B1%BB%E5%99%A8%E7%B1%BB%0Afrom+sklearn.neighbors+import+KNeighborsClassifier%0A%23%E5%AE%9E%E4%BE%8B%E5%8C%96%E7%B1%BB%E5%AF%B9%E8%B1%A1+%E6%8C%87%E5%AE%9Ak%E5%80%BC%2F%E8%B7%9D%E7%A6%BB%E5%BA%A6%E9%87%8F%E6%96%B9%E5%BC%8F%0Aclassifier+%3D+KNeighborsClassifier%28n_neighbors+%3D+5%2Cmetric%3D%27minkowski%27%2Cp%3D2%29%0A%23%E8%AE%AD%E7%BB%83%0Aclassifier+%3D+classifier.fit%28X_train%2CY_train%29+%23classifier.fit%28X_train%2CY_train%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2+id%3D%223.%25E5%25AF%25B9%25E6%25B5%258B%25E8%25AF%2595%25E9%259B%2586%25E8%25BF%259B%25E8%25A1%258C%25E9%25A2%2584%25E6%25B5%258B%22%3E3.%E5%AF%B9%E6%B5%8B%E8%AF%95%E9%9B%86%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E7%94%A8%E8%AE%AD%E7%BB%83%E5%A5%BD%E7%9A%84%E6%A8%A1%E5%9E%8B%E5%9C%A8%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%8A%E9%A2%84%E6%B5%8B%0Ay_pred+%3D+classifier.predict%28X_test%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch2+id%3D%224.%25E7%2594%259F%25E6%2588%2590%25E6%25B7%25B7%25E6%25B7%2586%25E7%259F%25A9%25E9%2598%25B5%22%3E4.%E7%94%9F%E6%88%90%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5%3C%2Fh2%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-python%22%3E%23%E8%AF%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E6%95%88%E6%9E%9C%0Afrom+sklearn.metrics+import+confusion_matrix%0A%0Acm+%3D+confusion_matrix%28Y_test%2Cy_pred%29%0Aprint%28cm%29%0A%23%E8%AE%A1%E7%AE%97%E5%87%86%E7%A1%AE%E7%8E%87%0Anum_correct+%3D+np.sum%28Y_test%3D%3Dy_pred%29%0Aaccuracy+%3D+float%28num_correct%29%2Flen%28y_pred%29%0Aprint%28accuracy%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp+style%3D%22text-align%3Acenter%3B%22%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22126%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115192539614.png%22+width%3D%22256%22%3E%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}