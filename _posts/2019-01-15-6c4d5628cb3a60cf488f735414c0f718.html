---
layout: default
title: Tensorflow 非线性回归
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp%3Eplaceholder%E7%94%A8%E6%B3%95%3C%2Fp%3E+%0A++%3Cp%3Etf.placeholder%28dtype%2C+shape%3DNone%2C+name%3DNone%29%3C%2Fp%3E+%0A++%3Cp%3ETensorFlow%E4%B8%AD%E7%9A%84%E5%8D%A0%E4%BD%8D%E7%AC%A6%EF%BC%8C%E7%94%A8%E4%BA%8E%E4%BC%A0%E5%85%A5%E5%A4%96%E9%83%A8%E6%95%B0%E6%8D%AE%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E5%8F%82%E6%95%B0%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3Edtype%3A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3Eshape%3A%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BB%B4%E5%BA%A6%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E9%BB%98%E8%AE%A4%E4%B8%BANone%EF%BC%8C%E8%A1%A8%E7%A4%BA%E6%B2%A1%E6%9C%89%E9%99%90%E5%88%B6%3C%2Fp%3E+%0A++%3Cp%3Ename%3A%E5%90%8D%E7%A7%B0%E8%BF%94%E5%9B%9E%E7%B1%BB%E5%9E%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3ETensorTensorFlow%E4%B8%AD%E5%8A%A0%E8%BD%BD%E5%9B%BE%E7%89%87%E7%9A%84%E7%BB%B4%E5%BA%A6%E4%B8%BA%5Bbatch%2C+height%2C+width%2C+channels%5D%3C%2Fp%3E+%0A++%3Cp%3E%E6%95%85placeholder%E7%9A%84shape%E5%8F%AF%E5%86%99%E4%B8%BA%5BNone%2C+None%2C+None%2C+3%5D%3Cbr%3E+%26nbsp%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode%3E%0Ax_data%3Dnp.linspace%28-0.5%2C0.5%2C200%29%5B%3A%2Cnp.newaxis%5D%0Anoise%3Dnp.random.normal%280%2C0.02%2Cx_data.shape%29%0Ay_data%3Dnp.square%28x_data%29%2Bnoise%0A%0Ax%3Dtf.placeholder%28tf.float32%2C%5BNone%2C1%5D%29%0Ay%3Dtf.placeholder%28tf.float32%2C%5BNone%2C1%5D%29%0A%0A%23%E7%AE%80%E5%8D%95%E4%B8%AD%E9%97%B4%E5%B1%82%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%BB%BA%E7%AB%8B%0AWeights_L1%3Dtf.Variable%28tf.random_normal%28%5B1%2C10%5D%29%29%0Abiases_L1%3Dtf.Variable%28tf.zeros%28%5B1%2C10%5D%29%29%0AWx_plus_b_L1%3Dtf.matmul%28x%2CWeights_L1%29%2Bbiases_L1%0AL1%3Dtf.nn.tanh%28Wx_plus_b_L1%29%0A%0A%23%E8%BE%93%E5%87%BA%E5%B1%82%0AWeights_L2%3Dtf.Variable%28tf.random_normal%28%5B10%2C1%5D%29%29%0Abiases_L2%3Dtf.Variable%28tf.zeros%28%5B1%2C1%5D%29%29%0AWx_plus_b_L2%3Dtf.matmul%28L1%2CWeights_L2%29%2Bbiases_L2%0Aprediction%3Dtf.nn.tanh%28Wx_plus_b_L2%29%0A%0A%0Aloss%3Dtf.reduce_mean%28tf.square%28y-prediction%29%29%0A%0A%0A%23%E4%BC%98%E5%8C%96%E5%99%A8%0Aoptimizer%3Dtf.train.GradientDescentOptimizer%280.1%29%0Atrain%3Doptimizer.minimize%28loss%29%0A%0Ainit%3Dtf.global_variables_initializer%28%29%0A%0Awith+tf.Session%28%29+as+sess%3A%0A++++sess.run%28init%29%0A++++for+_+in+range%282000%29%3A%0A++++++++sess.run%28train%2Cfeed_dict%3D%7Bx%3Ax_data%2Cy%3Ay_data%7D%29%0A++++prediction_value%3Dsess.run%28prediction%2Cfeed_dict%3D%7Bx%3Ax_data%7D%29%0A++++plt.figure%28%29%0A++++plt.scatter%28x_data%2Cy_data%29%0A++++plt.plot%28x_data%2Cprediction_value%2C%27r--%27%2Clw%3D5%29%0A++++plt.show%28%29%0A++++%0A++++%0A++++++++++++%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%3Cimg+alt%3D%22%22+class%3D%22has%22+height%3D%22252%22+src%3D%22https%3A%2F%2Fblog.uzzz.org.cn%2F_p%3Fhttps%3A%2F%2Fimg-blog.csdnimg.cn%2F20190115211046152.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MjE2MzIw%2Csize_16%2Ccolor_FFFFFF%2Ct_70%22+width%3D%22390%22%3E%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}