---
layout: default
title: SciKit-learn轻松使用机器学习（2）数据预处理
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp%3E%E5%8F%82%E8%80%83%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%EF%BC%9A%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fpreprocessing.html%23preprocessing%22+rel%3D%22nofollow%22%3Ehttps%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fpreprocessing.html%23preprocessing%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Chr%3E%0A++%3Ch2%3E4.3.+Preprocessing+data%3C%2Fh2%3E+%0A++%3Cp%3EThe%26nbsp%3B%3Cspan+style%3D%22color%3A%237c79e5%3B%22%3E%3Cstrong%3E%3Ccode%3Esklearn.preprocessing%3C%2Fcode%3E%26nbsp%3B%3C%2Fstrong%3E%3C%2Fspan%3Epackage+provides+several+common+utility+functions+and+transformer+classes+to+change+raw+feature+vectors+into+a+representation+that+is+more+suitable+for+the+downstream+estimators.%3C%2Fp%3E+%0A++%3Cp%3EIn+general%2C+learning+algorithms+benefit+from+standardization+of+the+data+set.+If+some+outliers+are+present+in+the+set%2C+robust+scalers+or+transformers+are+more+appropriate.+The+behaviors+of+the+different+scalers%2C+transformers%2C+and+normalizers+on+a+dataset+containing+marginal+outliers+is+highlighted+in%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fauto_examples%2Fpreprocessing%2Fplot_all_scaling.html%23sphx-glr-auto-examples-preprocessing-plot-all-scaling-py%22+rel%3D%22nofollow%22%3ECompare+the+effect+of+different+scalers+on+data+with+outliers%3C%2Fa%3E.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.1.+Standardization%2C+or+mean+removal+and+variance+scaling%3C%2Fh2%3E+%0A++%3Cp%3E%3Cstrong%3EStandardization%3C%2Fstrong%3E%26nbsp%3Bof+datasets+is+a%26nbsp%3B%3Cstrong%3Ecommon+requirement+for+many+machine+learning+estimators%3C%2Fstrong%3E%26nbsp%3Bimplemented+in+scikit-learn%3B+they+might+behave+badly+if+the+individual+features+do+not+more+or+less+look+like+standard+normally+distributed+data%3A+Gaussian+with%26nbsp%3B%3Cstrong%3Ezero+mean+and+unit+variance%3C%2Fstrong%3E.%3C%2Fp%3E+%0A++%3Cp%3EIn+practice+we+often+ignore+the+shape+of+the+distribution+and+just+transform+the+data+to+center+it+by+removing+the+mean+value+of+each+feature%2C+then+scale+it+by+dividing+non-constant+features+by+their+standard+deviation.%3C%2Fp%3E+%0A++%3Cp%3EFor+instance%2C+many+elements+used+in+the+objective+function+of+a+learning+algorithm+%28such+as+the+RBF+kernel+of+Support+Vector+Machines+or+the+l1+and+l2+regularizers+of+linear+models%29+assume+that+all+features+are+centered+around+zero+and+have+variance+in+the+same+order.+If+a+feature+has+a+variance+that+is+orders+of+magnitude+larger+than+others%2C+it+might+dominate+the+objective+function+and+make+the+estimator+unable+to+learn+from+other+features+correctly+as+expected.%3C%2Fp%3E+%0A++%3Cp%3EThe+function%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.scale.html%23sklearn.preprocessing.scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Escale%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bprovides+a+quick+and+easy+way+to+perform+this+operation+on+a+single+array-like+dataset%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+from+sklearn+import+preprocessing%0A%26gt%3B%26gt%3B%26gt%3B+import+numpy+as+np%0A%26gt%3B%26gt%3B%26gt%3B+X_train+%3D+np.array%28%5B%5B+1.%2C+-1.%2C++2.%5D%2C%0A...+++++++++++++++++++++%5B+2.%2C++0.%2C++0.%5D%2C%0A...+++++++++++++++++++++%5B+0.%2C++1.%2C+-1.%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+X_scaled+%3D+preprocessing.scale%28X_train%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+X_scaled++++++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B%5B+0.++...%2C+-1.22...%2C++1.33...%5D%2C%0A+++++++%5B+1.22...%2C++0.++...%2C+-0.26...%5D%2C%0A+++++++%5B-1.22...%2C++1.22...%2C+-1.06...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EScaled+data+has+zero+mean+and+unit+variance%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X_scaled.mean%28axis%3D0%29%0Aarray%28%5B0.%2C+0.%2C+0.%5D%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+X_scaled.std%28axis%3D0%29%0Aarray%28%5B1.%2C+1.%2C+1.%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe%26nbsp%3B%3Ccode%3Epreprocessing%3C%2Fcode%3E%26nbsp%3Bmodule+further+provides+a+utility+class%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.StandardScaler.html%23sklearn.preprocessing.StandardScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EStandardScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bthat+implements+the%26nbsp%3B%3Ccode%3ETransformer%3C%2Fcode%3E%26nbsp%3BAPI+to+compute+the+mean+and+standard+deviation+on+a+training+set+so+as+to+be+able+to+later+reapply+the+same+transformation+on+the+testing+set.+This+class+is+hence+suitable+for+use+in+the+early+steps+of+a%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.pipeline.Pipeline.html%23sklearn.pipeline.Pipeline%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.pipeline.Pipeline%3C%2Fcode%3E%3C%2Fa%3E%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+scaler+%3D+preprocessing.StandardScaler%28%29.fit%28X_train%29%0A%26gt%3B%26gt%3B%26gt%3B+scaler%0AStandardScaler%28copy%3DTrue%2C+with_mean%3DTrue%2C+with_std%3DTrue%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+scaler.mean_++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B1.+...%2C+0.+...%2C+0.33...%5D%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+scaler.scale_+++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B0.81...%2C+0.81...%2C+1.24...%5D%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+scaler.transform%28X_train%29+++++++++++++++++++++++++++%0Aarray%28%5B%5B+0.++...%2C+-1.22...%2C++1.33...%5D%2C%0A+++++++%5B+1.22...%2C++0.++...%2C+-0.26...%5D%2C%0A+++++++%5B-1.22...%2C++1.22...%2C+-1.06...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe+scaler+instance+can+then+be+used+on+new+data+to+transform+it+the+same+way+it+did+on+the+training+set%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X_test+%3D+%5B%5B-1.%2C+1.%2C+0.%5D%5D%0A%26gt%3B%26gt%3B%26gt%3B+scaler.transform%28X_test%29++++++++++++++++%0Aarray%28%5B%5B-2.44...%2C++1.22...%2C+-0.26...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EIt+is+possible+to+disable+either+centering+or+scaling+by+either+passing%26nbsp%3B%3Ccode%3Ewith_mean%3DFalse%3C%2Fcode%3E%26nbsp%3Bor%26nbsp%3B%3Ccode%3Ewith_std%3DFalse%3C%2Fcode%3E%26nbsp%3Bto+the+constructor+of%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.StandardScaler.html%23sklearn.preprocessing.StandardScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EStandardScaler%3C%2Fcode%3E%3C%2Fa%3E.%3C%2Fp%3E+%0A++%3Ch3%3E4.3.1.1.+Scaling+features+to+a+range%3C%2Fh3%3E+%0A++%3Cp%3EAn+alternative+standardization+is+scaling+features+to+lie+between+a+given+minimum+and+maximum+value%2C+often+between+zero+and+one%2C+or+so+that+the+maximum+absolute+value+of+each+feature+is+scaled+to+unit+size.+This+can+be+achieved+using%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.MinMaxScaler.html%23sklearn.preprocessing.MinMaxScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EMinMaxScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bor%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.MaxAbsScaler.html%23sklearn.preprocessing.MaxAbsScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EMaxAbsScaler%3C%2Fcode%3E%3C%2Fa%3E%2C+respectively.%3C%2Fp%3E+%0A++%3Cp%3EThe+motivation+to+use+this+scaling+include+robustness+to+very+small+standard+deviations+of+features+and+preserving+zero+entries+in+sparse+data.%3C%2Fp%3E+%0A++%3Cp%3EHere+is+an+example+to+scale+a+toy+data+matrix+to+the%26nbsp%3B%3Ccode%3E%5B0%2C%26nbsp%3B1%5D%3C%2Fcode%3E%26nbsp%3Brange%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X_train+%3D+np.array%28%5B%5B+1.%2C+-1.%2C++2.%5D%2C%0A...+++++++++++++++++++++%5B+2.%2C++0.%2C++0.%5D%2C%0A...+++++++++++++++++++++%5B+0.%2C++1.%2C+-1.%5D%5D%29%0A...%0A%26gt%3B%26gt%3B%26gt%3B+min_max_scaler+%3D+preprocessing.MinMaxScaler%28%29%0A%26gt%3B%26gt%3B%26gt%3B+X_train_minmax+%3D+min_max_scaler.fit_transform%28X_train%29%0A%26gt%3B%26gt%3B%26gt%3B+X_train_minmax%0Aarray%28%5B%5B0.5+++++++%2C+0.++++++++%2C+1.++++++++%5D%2C%0A+++++++%5B1.++++++++%2C+0.5+++++++%2C+0.33333333%5D%2C%0A+++++++%5B0.++++++++%2C+1.++++++++%2C+0.++++++++%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe+same+instance+of+the+transformer+can+then+be+applied+to+some+new+test+data+unseen+during+the+fit+call%3A+the+same+scaling+and+shifting+operations+will+be+applied+to+be+consistent+with+the+transformation+performed+on+the+train+data%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X_test+%3D+np.array%28%5B%5B-3.%2C+-1.%2C++4.%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+X_test_minmax+%3D+min_max_scaler.transform%28X_test%29%0A%26gt%3B%26gt%3B%26gt%3B+X_test_minmax%0Aarray%28%5B%5B-1.5+++++++%2C++0.++++++++%2C++1.66666667%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EIt+is+possible+to+introspect+the+scaler+attributes+to+find+about+the+exact+nature+of+the+transformation+learned+on+the+training+data%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+min_max_scaler.scale_+++++++++++++++++++++++++++++%0Aarray%28%5B0.5+++++++%2C+0.5+++++++%2C+0.33...%5D%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+min_max_scaler.min_+++++++++++++++++++++++++++++++%0Aarray%28%5B0.++++++++%2C+0.5+++++++%2C+0.33...%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EIf%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.MinMaxScaler.html%23sklearn.preprocessing.MinMaxScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EMinMaxScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bis+given+an+explicit%26nbsp%3B%3Ccode%3Efeature_range%3D%28min%2C%26nbsp%3Bmax%29%3C%2Fcode%3E%26nbsp%3Bthe+full+formula+is%3A%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3EX_std+%3D+%28X+-+X.min%28axis%3D0%29%29+%2F+%28X.max%28axis%3D0%29+-+X.min%28axis%3D0%29%29%0A%0AX_scaled+%3D+X_std+*+%28max+-+min%29+%2B+min%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.MaxAbsScaler.html%23sklearn.preprocessing.MaxAbsScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EMaxAbsScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bworks+in+a+very+similar+fashion%2C+but+scales+in+a+way+that+the+training+data+lies+within+the+range%26nbsp%3B%3Ccode%3E%5B-1%2C%26nbsp%3B1%5D%3C%2Fcode%3E%26nbsp%3Bby+dividing+through+the+largest+maximum+value+in+each+feature.+It+is+meant+for+data+that+is+already+centered+at+zero+or+sparse+data.%3C%2Fp%3E+%0A++%3Cp%3EHere+is+how+to+use+the+toy+data+from+the+previous+example+with+this+scaler%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X_train+%3D+np.array%28%5B%5B+1.%2C+-1.%2C++2.%5D%2C%0A...+++++++++++++++++++++%5B+2.%2C++0.%2C++0.%5D%2C%0A...+++++++++++++++++++++%5B+0.%2C++1.%2C+-1.%5D%5D%29%0A...%0A%26gt%3B%26gt%3B%26gt%3B+max_abs_scaler+%3D+preprocessing.MaxAbsScaler%28%29%0A%26gt%3B%26gt%3B%26gt%3B+X_train_maxabs+%3D+max_abs_scaler.fit_transform%28X_train%29%0A%26gt%3B%26gt%3B%26gt%3B+X_train_maxabs++++++++++++++++%23+doctest+%2BNORMALIZE_WHITESPACE%5E%0Aarray%28%5B%5B+0.5%2C+-1.+%2C++1.+%5D%2C%0A+++++++%5B+1.+%2C++0.+%2C++0.+%5D%2C%0A+++++++%5B+0.+%2C++1.+%2C+-0.5%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+X_test+%3D+np.array%28%5B%5B+-3.%2C+-1.%2C++4.%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+X_test_maxabs+%3D+max_abs_scaler.transform%28X_test%29%0A%26gt%3B%26gt%3B%26gt%3B+X_test_maxabs+++++++++++++++++%0Aarray%28%5B%5B-1.5%2C+-1.+%2C++2.+%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+max_abs_scaler.scale_+++++++++%0Aarray%28%5B2.%2C++1.%2C++2.%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EAs+with%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.scale.html%23sklearn.preprocessing.scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Escale%3C%2Fcode%3E%3C%2Fa%3E%2C+the+module+further+provides+convenience+functions%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.minmax_scale.html%23sklearn.preprocessing.minmax_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Eminmax_scale%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.maxabs_scale.html%23sklearn.preprocessing.maxabs_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Emaxabs_scale%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bif+you+don%E2%80%99t+want+to+create+an+object.%3C%2Fp%3E+%0A++%3Ch3%3E4.3.1.2.+Scaling+sparse+data%3C%2Fh3%3E+%0A++%3Cp%3ECentering+sparse+data+would+destroy+the+sparseness+structure+in+the+data%2C+and+thus+rarely+is+a+sensible+thing+to+do.+However%2C+it+can+make+sense+to+scale+sparse+inputs%2C+especially+if+features+are+on+different+scales.%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.MaxAbsScaler.html%23sklearn.preprocessing.MaxAbsScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EMaxAbsScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.maxabs_scale.html%23sklearn.preprocessing.maxabs_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Emaxabs_scale%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bwere+specifically+designed+for+scaling+sparse+data%2C+and+are+the+recommended+way+to+go+about+this.+However%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.scale.html%23sklearn.preprocessing.scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Escale%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.StandardScaler.html%23sklearn.preprocessing.StandardScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EStandardScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bcan+accept%26nbsp%3B%3Ccode%3Escipy.sparse%3C%2Fcode%3E%26nbsp%3Bmatrices+as+input%2C+as+long+as%26nbsp%3B%3Ccode%3Ewith_mean%3DFalse%3C%2Fcode%3E%26nbsp%3Bis+explicitly+passed+to+the+constructor.+Otherwise+a%26nbsp%3B%3Ccode%3EValueError%3C%2Fcode%3E%26nbsp%3Bwill+be+raised+as+silently+centering+would+break+the+sparsity+and+would+often+crash+the+execution+by+allocating+excessive+amounts+of+memory+unintentionally.%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.RobustScaler.html%23sklearn.preprocessing.RobustScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3ERobustScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bcannot+be+fitted+to+sparse+inputs%2C+but+you+can+use+the%26nbsp%3B%3Ccode%3Etransform%3C%2Fcode%3E%26nbsp%3Bmethod+on+sparse+inputs.%3C%2Fp%3E+%0A++%3Cp%3ENote+that+the+scalers+accept+both+Compressed+Sparse+Rows+and+Compressed+Sparse+Columns+format+%28see%26nbsp%3B%3Ccode%3Escipy.sparse.csr_matrix%3C%2Fcode%3E%26nbsp%3Band%26nbsp%3B%3Ccode%3Escipy.sparse.csc_matrix%3C%2Fcode%3E%29.+Any+other+sparse+input+will+be%26nbsp%3B%3Cstrong%3Econverted+to+the+Compressed+Sparse+Rows+representation%3C%2Fstrong%3E.+To+avoid+unnecessary+memory+copies%2C+it+is+recommended+to+choose+the+CSR+or+CSC+representation+upstream.%3C%2Fp%3E+%0A++%3Cp%3EFinally%2C+if+the+centered+data+is+expected+to+be+small+enough%2C+explicitly+converting+the+input+to+an+array+using+the%26nbsp%3B%3Ccode%3Etoarray%3C%2Fcode%3Emethod+of+sparse+matrices+is+another+option.%3C%2Fp%3E+%0A++%3Ch3%3E4.3.1.3.+Scaling+data+with+outliers%3C%2Fh3%3E+%0A++%3Cp%3EIf+your+data+contains+many+outliers%2C+scaling+using+the+mean+and+variance+of+the+data+is+likely+to+not+work+very+well.+In+these+cases%2C+you+can+use%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.robust_scale.html%23sklearn.preprocessing.robust_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Erobust_scale%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.RobustScaler.html%23sklearn.preprocessing.RobustScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3ERobustScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bas+drop-in+replacements+instead.+They+use+more+robust+estimates+for+the+center+and+range+of+your+data.%3C%2Fp%3E+%0A++%3Cp%3EReferences%3A%3C%2Fp%3E+%0A++%3Cp%3EFurther+discussion+on+the+importance+of+centering+and+scaling+data+is+available+on+this+FAQ%3A%26nbsp%3B%3Ca+href%3D%22http%3A%2F%2Fwww.faqs.org%2Ffaqs%2Fai-faq%2Fneural-nets%2Fpart2%2Fsection-16.html%22+rel%3D%22nofollow%22%3EShould+I+normalize%2Fstandardize%2Frescale+the+data%3F%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3EScaling+vs+Whitening%3C%2Fp%3E+%0A++%3Cp%3EIt+is+sometimes+not+enough+to+center+and+scale+the+features+independently%2C+since+a+downstream+model+can+further+make+some+assumption+on+the+linear+independence+of+the+features.%3C%2Fp%3E+%0A++%3Cp%3ETo+address+this+issue+you+can+use%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.decomposition.PCA.html%23sklearn.decomposition.PCA%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.decomposition.PCA%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bwith%26nbsp%3B%3Ccode%3Ewhiten%3DTrue%3C%2Fcode%3E%26nbsp%3Bto+further+remove+the+linear+correlation+across+features.%3C%2Fp%3E+%0A++%3Cp%3EScaling+a+1D+array%3C%2Fp%3E+%0A++%3Cp%3EAll+above+functions+%28i.e.%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.scale.html%23sklearn.preprocessing.scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Escale%3C%2Fcode%3E%3C%2Fa%3E%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.minmax_scale.html%23sklearn.preprocessing.minmax_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Eminmax_scale%3C%2Fcode%3E%3C%2Fa%3E%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.maxabs_scale.html%23sklearn.preprocessing.maxabs_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Emaxabs_scale%3C%2Fcode%3E%3C%2Fa%3E%2C+and%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.robust_scale.html%23sklearn.preprocessing.robust_scale%22+rel%3D%22nofollow%22%3E%3Ccode%3Erobust_scale%3C%2Fcode%3E%3C%2Fa%3E%29+accept+1D+array+which+can+be+useful+in+some+specific+case.%3C%2Fp%3E+%0A++%3Ch3%3E4.3.1.4.+Centering+kernel+matrices%3C%2Fh3%3E+%0A++%3Cp%3EIf+you+have+a+kernel+matrix+of+a+kernel%26nbsp%3BK%26nbsp%3Bthat+computes+a+dot+product+in+a+feature+space+defined+by+function%26nbsp%3Bphi%2C+a%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.KernelCenterer.html%23sklearn.preprocessing.KernelCenterer%22+rel%3D%22nofollow%22%3E%3Ccode%3EKernelCenterer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bcan+transform+the+kernel+matrix+so+that+it+contains+inner+products+in+the+feature+space+defined+by%26nbsp%3Bphifollowed+by+removal+of+the+mean+in+that+space.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.2.+Non-linear+transformation%3C%2Fh2%3E+%0A++%3Ch3%3E4.3.2.1.+Mapping+to+a+Uniform+distribution%3C%2Fh3%3E+%0A++%3Cp%3ELike+scalers%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.QuantileTransformer.html%23sklearn.preprocessing.QuantileTransformer%22+rel%3D%22nofollow%22%3E%3Ccode%3EQuantileTransformer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bputs+all+features+into+the+same%2C+known+range+or+distribution.+However%2C+by+performing+a+rank+transformation%2C+it+smooths+out+unusual+distributions+and+is+less+influenced+by+outliers+than+scaling+methods.+It+does%2C+however%2C+distort+correlations+and+distances+within+and+across+features.%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.QuantileTransformer.html%23sklearn.preprocessing.QuantileTransformer%22+rel%3D%22nofollow%22%3E%3Ccode%3EQuantileTransformer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.quantile_transform.html%23sklearn.preprocessing.quantile_transform%22+rel%3D%22nofollow%22%3E%3Ccode%3Equantile_transform%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bprovide+a+non-parametric+transformation+based+on+the+quantile+function+to+map+the+data+to+a+uniform+distribution+with+values+between+0+and+1%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+from+sklearn.datasets+import+load_iris%0A%26gt%3B%26gt%3B%26gt%3B+from+sklearn.model_selection+import+train_test_split%0A%26gt%3B%26gt%3B%26gt%3B+iris+%3D+load_iris%28%29%0A%26gt%3B%26gt%3B%26gt%3B+X%2C+y+%3D+iris.data%2C+iris.target%0A%26gt%3B%26gt%3B%26gt%3B+X_train%2C+X_test%2C+y_train%2C+y_test+%3D+train_test_split%28X%2C+y%2C+random_state%3D0%29%0A%26gt%3B%26gt%3B%26gt%3B+quantile_transformer+%3D+preprocessing.QuantileTransformer%28random_state%3D0%29%0A%26gt%3B%26gt%3B%26gt%3B+X_train_trans+%3D+quantile_transformer.fit_transform%28X_train%29%0A%26gt%3B%26gt%3B%26gt%3B+X_test_trans+%3D+quantile_transformer.transform%28X_test%29%0A%26gt%3B%26gt%3B%26gt%3B+np.percentile%28X_train%5B%3A%2C+0%5D%2C+%5B0%2C+25%2C+50%2C+75%2C+100%5D%29+%0Aarray%28%5B+4.3%2C++5.1%2C++5.8%2C++6.5%2C++7.9%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThis+feature+corresponds+to+the+sepal+length+in+cm.+Once+the+quantile+transformation+applied%2C+those+landmarks+approach+closely+the+percentiles+previously+defined%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+np.percentile%28X_train_trans%5B%3A%2C+0%5D%2C+%5B0%2C+25%2C+50%2C+75%2C+100%5D%29%0A...+%0Aarray%28%5B+0.00...+%2C++0.24...%2C++0.49...%2C++0.73...%2C++0.99...+%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThis+can+be+confirmed+on+a+independent+testing+set+with+similar+remarks%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+np.percentile%28X_test%5B%3A%2C+0%5D%2C+%5B0%2C+25%2C+50%2C+75%2C+100%5D%29%0A...+%0Aarray%28%5B+4.4++%2C++5.125%2C++5.75+%2C++6.175%2C++7.3++%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+np.percentile%28X_test_trans%5B%3A%2C+0%5D%2C+%5B0%2C+25%2C+50%2C+75%2C+100%5D%29%0A...+%0Aarray%28%5B+0.01...%2C++0.25...%2C++0.46...%2C++0.60...+%2C++0.94...%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch3%3E4.3.2.2.+Mapping+to+a+Gaussian+distribution%3C%2Fh3%3E+%0A++%3Cp%3EIn+many+modeling+scenarios%2C+normality+of+the+features+in+a+dataset+is+desirable.+Power+transforms+are+a+family+of+parametric%2C+monotonic+transformations+that+aim+to+map+data+from+any+distribution+to+as+close+to+a+Gaussian+distribution+as+possible+in+order+to+stabilize+variance+and+minimize+skewness.%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.PowerTransformer.html%23sklearn.preprocessing.PowerTransformer%22+rel%3D%22nofollow%22%3E%3Ccode%3EPowerTransformer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bcurrently+provides+two+such+power+transformations%2C+the+Yeo-Johnson+transform+and+the+Box-Cox+transform.%3C%2Fp%3E+%0A++%3Cp%3EThe+Yeo-Johnson+transform+is+given+by%3A%3C%2Fp%3E+%0A++%3Cp%3Exi%28%CE%BB%29%3D%7B%5B%28xi%2B1%29%CE%BB%E2%88%921%5D%2F%CE%BBif%26nbsp%3B%CE%BB%E2%89%A00%2Cxi%E2%89%A50%2Cln%E2%81%A1%28xi%29%2B1if%26nbsp%3B%CE%BB%3D0%2Cxi%E2%89%A50%E2%88%92%5B%28%E2%88%92xi%2B1%292%E2%88%92%CE%BB%E2%88%921%5D%2F%282%E2%88%92%CE%BB%29if%26nbsp%3B%CE%BB%E2%89%A02%2Cxi%26lt%3B0%2C%E2%88%92ln%E2%81%A1%28%E2%88%92xi%2B1%29if%26nbsp%3B%CE%BB%3D2%2Cxi%26lt%3B0%3C%2Fp%3E+%0A++%3Cp%3Ewhile+the+Box-Cox+transform+is+given+by%3A%3C%2Fp%3E+%0A++%3Cp%3Exi%28%CE%BB%29%3D%7Bxi%CE%BB%E2%88%921%CE%BBif%26nbsp%3B%CE%BB%E2%89%A00%2Cln%E2%81%A1%28xi%29if%26nbsp%3B%CE%BB%3D0%2C%3C%2Fp%3E+%0A++%3Cp%3EBox-Cox+can+only+be+applied+to+strictly+positive+data.+In+both+methods%2C+the+transformation+is+parameterized+by%26nbsp%3B%CE%BB%2C+which+is+determined+through+maximum+likelihood+estimation.+Here+is+an+example+of+using+Box-Cox+to+map+samples+drawn+from+a+lognormal+distribution+to+a+normal+distribution%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+pt+%3D+preprocessing.PowerTransformer%28method%3D%27box-cox%27%2C+standardize%3DFalse%29%0A%26gt%3B%26gt%3B%26gt%3B+X_lognormal+%3D+np.random.RandomState%28616%29.lognormal%28size%3D%283%2C+3%29%29%0A%26gt%3B%26gt%3B%26gt%3B+X_lognormal+++++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B%5B1.28...%2C+1.18...%2C+0.84...%5D%2C%0A+++++++%5B0.94...%2C+1.60...%2C+0.38...%5D%2C%0A+++++++%5B1.35...%2C+0.21...%2C+1.09...%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+pt.fit_transform%28X_lognormal%29+++++++++++++++++++%0Aarray%28%5B%5B+0.49...%2C++0.17...%2C+-0.15...%5D%2C%0A+++++++%5B-0.05...%2C++0.58...%2C+-0.57...%5D%2C%0A+++++++%5B+0.69...%2C+-0.84...%2C++0.10...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EWhile+the+above+example+sets+the%26nbsp%3Bstandardize%26nbsp%3Boption+to%26nbsp%3BFalse%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.PowerTransformer.html%23sklearn.preprocessing.PowerTransformer%22+rel%3D%22nofollow%22%3E%3Ccode%3EPowerTransformer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bwill+apply+zero-mean%2C+unit-variance+normalization+to+the+transformed+output+by+default.%3C%2Fp%3E+%0A++%3Cp%3EBelow+are+examples+of+Box-Cox+and+Yeo-Johnson+applied+to+various+probability+distributions.+Note+that+when+applied+to+certain+distributions%2C+the+power+transforms+achieve+very+Gaussian-like+results%2C+but+with+others%2C+they+are+ineffective.+This+highlights+the+importance+of+visualizing+the+data+before+and+after+transformation.%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fauto_examples%2Fpreprocessing%2Fplot_map_data_to_normal.html%22+rel%3D%22nofollow%22%3E%3Cimg+alt%3D%22..%2F_images%2Fsphx_glr_plot_map_data_to_normal_0011.png%22+class%3D%22has%22+src%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2F_images%2Fsphx_glr_plot_map_data_to_normal_0011.png%22%3E%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Cp%3EIt+is+also+possible+to+map+data+to+a+normal+distribution+using%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.QuantileTransformer.html%23sklearn.preprocessing.QuantileTransformer%22+rel%3D%22nofollow%22%3E%3Ccode%3EQuantileTransformer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bby+setting%26nbsp%3B%3Ccode%3Eoutput_distribution%3D%27normal%27%3C%2Fcode%3E.+Using+the+earlier+example+with+the+iris+dataset%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+quantile_transformer+%3D+preprocessing.QuantileTransformer%28%0A...+++++output_distribution%3D%27normal%27%2C+random_state%3D0%29%0A%26gt%3B%26gt%3B%26gt%3B+X_trans+%3D+quantile_transformer.fit_transform%28X%29%0A%26gt%3B%26gt%3B%26gt%3B+quantile_transformer.quantiles_+%0Aarray%28%5B%5B4.3...%2C+++2...%2C+++++1...%2C+++++0.1...%5D%2C%0A+++++++%5B4.31...%2C++2.02...%2C++1.01...%2C++0.1...%5D%2C%0A+++++++%5B4.32...%2C++2.05...%2C++1.02...%2C++0.1...%5D%2C%0A+++++++...%2C%0A+++++++%5B7.84...%2C++4.34...%2C++6.84...%2C++2.5...%5D%2C%0A+++++++%5B7.87...%2C++4.37...%2C++6.87...%2C++2.5...%5D%2C%0A+++++++%5B7.9...%2C+++4.4...%2C+++6.9...%2C+++2.5...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThus+the+median+of+the+input+becomes+the+mean+of+the+output%2C+centered+at+0.+The+normal+output+is+clipped+so+that+the+input%E2%80%99s+minimum+and+maximum+%E2%80%94+corresponding+to+the+1e-7+and+1+-+1e-7+quantiles+respectively+%E2%80%94+do+not+become+infinite+under+the+transformation.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.3.+Normalization%3C%2Fh2%3E+%0A++%3Cp%3E%3Cstrong%3ENormalization%3C%2Fstrong%3E%26nbsp%3Bis+the+process+of%26nbsp%3B%3Cstrong%3Escaling+individual+samples+to+have+unit+norm%3C%2Fstrong%3E.+This+process+can+be+useful+if+you+plan+to+use+a+quadratic+form+such+as+the+dot-product+or+any+other+kernel+to+quantify+the+similarity+of+any+pair+of+samples.%3C%2Fp%3E+%0A++%3Cp%3EThis+assumption+is+the+base+of+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FVector_Space_Model%22+rel%3D%22nofollow%22%3EVector+Space+Model%3C%2Fa%3E%26nbsp%3Boften+used+in+text+classification+and+clustering+contexts.%3C%2Fp%3E+%0A++%3Cp%3EThe+function%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.normalize.html%23sklearn.preprocessing.normalize%22+rel%3D%22nofollow%22%3E%3Ccode%3Enormalize%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bprovides+a+quick+and+easy+way+to+perform+this+operation+on+a+single+array-like+dataset%2C+either+using+the%26nbsp%3B%3Ccode%3El1%3C%2Fcode%3E%26nbsp%3Bor%26nbsp%3B%3Ccode%3El2%3C%2Fcode%3E%26nbsp%3Bnorms%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X+%3D+%5B%5B+1.%2C+-1.%2C++2.%5D%2C%0A...++++++%5B+2.%2C++0.%2C++0.%5D%2C%0A...++++++%5B+0.%2C++1.%2C+-1.%5D%5D%0A%26gt%3B%26gt%3B%26gt%3B+X_normalized+%3D+preprocessing.normalize%28X%2C+norm%3D%27l2%27%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+X_normalized++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B%5B+0.40...%2C+-0.40...%2C++0.81...%5D%2C%0A+++++++%5B+1.++...%2C++0.++...%2C++0.++...%5D%2C%0A+++++++%5B+0.++...%2C++0.70...%2C+-0.70...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe%26nbsp%3B%3Ccode%3Epreprocessing%3C%2Fcode%3E%26nbsp%3Bmodule+further+provides+a+utility+class%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Normalizer.html%23sklearn.preprocessing.Normalizer%22+rel%3D%22nofollow%22%3E%3Ccode%3ENormalizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bthat+implements+the+same+operation+using+the%3Ccode%3ETransformer%3C%2Fcode%3E%26nbsp%3BAPI+%28even+though+the%26nbsp%3B%3Ccode%3Efit%3C%2Fcode%3E%26nbsp%3Bmethod+is+useless+in+this+case%3A+the+class+is+stateless+as+this+operation+treats+samples+independently%29.%3C%2Fp%3E+%0A++%3Cp%3EThis+class+is+hence+suitable+for+use+in+the+early+steps+of+a%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.pipeline.Pipeline.html%23sklearn.pipeline.Pipeline%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.pipeline.Pipeline%3C%2Fcode%3E%3C%2Fa%3E%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+normalizer+%3D+preprocessing.Normalizer%28%29.fit%28X%29++%23+fit+does+nothing%0A%26gt%3B%26gt%3B%26gt%3B+normalizer%0ANormalizer%28copy%3DTrue%2C+norm%3D%27l2%27%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe+normalizer+instance+can+then+be+used+on+sample+vectors+as+any+transformer%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+normalizer.transform%28X%29++++++++++++++++++++++++++++%0Aarray%28%5B%5B+0.40...%2C+-0.40...%2C++0.81...%5D%2C%0A+++++++%5B+1.++...%2C++0.++...%2C++0.++...%5D%2C%0A+++++++%5B+0.++...%2C++0.70...%2C+-0.70...%5D%5D%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+normalizer.transform%28%5B%5B-1.%2C++1.%2C+0.%5D%5D%29+++++++++++++%0Aarray%28%5B%5B-0.70...%2C++0.70...%2C++0.++...%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3ESparse+input%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.normalize.html%23sklearn.preprocessing.normalize%22+rel%3D%22nofollow%22%3E%3Ccode%3Enormalize%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Normalizer.html%23sklearn.preprocessing.Normalizer%22+rel%3D%22nofollow%22%3E%3Ccode%3ENormalizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Baccept%26nbsp%3B%3Cstrong%3Eboth+dense+array-like+and+sparse+matrices+from+scipy.sparse+as+input%3C%2Fstrong%3E.%3C%2Fp%3E+%0A++%3Cp%3EFor+sparse+input+the+data+is%26nbsp%3B%3Cstrong%3Econverted+to+the+Compressed+Sparse+Rows+representation%3C%2Fstrong%3E%26nbsp%3B%28see%26nbsp%3B%3Ccode%3Escipy.sparse.csr_matrix%3C%2Fcode%3E%29+before+being+fed+to+efficient+Cython+routines.+To+avoid+unnecessary+memory+copies%2C+it+is+recommended+to+choose+the+CSR+representation+upstream.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.4.+Encoding+categorical+features%3C%2Fh2%3E+%0A++%3Cp%3EOften+features+are+not+given+as+continuous+values+but+categorical.+For+example+a+person+could+have+features%26nbsp%3B%3Ccode%3E%5B%22male%22%2C%26nbsp%3B%22female%22%5D%3C%2Fcode%3E%2C%26nbsp%3B%3Ccode%3E%5B%22from%26nbsp%3BEurope%22%2C%26nbsp%3B%22from%26nbsp%3BUS%22%2C%26nbsp%3B%22from%26nbsp%3BAsia%22%5D%3C%2Fcode%3E%2C%3Ccode%3E%5B%22uses%26nbsp%3BFirefox%22%2C%26nbsp%3B%22uses%26nbsp%3BChrome%22%2C%26nbsp%3B%22uses%26nbsp%3BSafari%22%2C%26nbsp%3B%22uses%26nbsp%3BInternet%26nbsp%3BExplorer%22%5D%3C%2Fcode%3E.+Such+features+can+be+efficiently+coded+as+integers%2C+for+instance%26nbsp%3B%3Ccode%3E%5B%22male%22%2C%26nbsp%3B%22from%26nbsp%3BUS%22%2C%26nbsp%3B%22uses%26nbsp%3BInternet%26nbsp%3BExplorer%22%5D%3C%2Fcode%3E%26nbsp%3Bcould+be+expressed+as%26nbsp%3B%3Ccode%3E%5B0%2C%26nbsp%3B1%2C%26nbsp%3B3%5D%3C%2Fcode%3Ewhile%26nbsp%3B%3Ccode%3E%5B%22female%22%2C%26nbsp%3B%22from%26nbsp%3BAsia%22%2C%26nbsp%3B%22uses%26nbsp%3BChrome%22%5D%3C%2Fcode%3E%26nbsp%3Bwould+be%26nbsp%3B%3Ccode%3E%5B1%2C%26nbsp%3B2%2C%26nbsp%3B1%5D%3C%2Fcode%3E.%3C%2Fp%3E+%0A++%3Cp%3ETo+convert+categorical+features+to+such+integer+codes%2C+we+can+use+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.OrdinalEncoder.html%23sklearn.preprocessing.OrdinalEncoder%22+rel%3D%22nofollow%22%3E%3Ccode%3EOrdinalEncoder%3C%2Fcode%3E%3C%2Fa%3E.+This+estimator+transforms+each+categorical+feature+to+one+new+feature+of+integers+%280+to+n_categories+-+1%29%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+enc+%3D+preprocessing.OrdinalEncoder%28%29%0A%26gt%3B%26gt%3B%26gt%3B+X+%3D+%5B%5B%27male%27%2C+%27from+US%27%2C+%27uses+Safari%27%5D%2C+%5B%27female%27%2C+%27from+Europe%27%2C+%27uses+Firefox%27%5D%5D%0A%26gt%3B%26gt%3B%26gt%3B+enc.fit%28X%29++%0AOrdinalEncoder%28categories%3D%27auto%27%2C+dtype%3D%26lt%3B...+%27numpy.float64%27%26gt%3B%29%0A%26gt%3B%26gt%3B%26gt%3B+enc.transform%28%5B%5B%27female%27%2C+%27from+US%27%2C+%27uses+Safari%27%5D%5D%29%0Aarray%28%5B%5B0.%2C+1.%2C+1.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3ESuch+integer+representation+can%2C+however%2C+not+be+used+directly+with+all+scikit-learn+estimators%2C+as+these+expect+continuous+input%2C+and+would+interpret+the+categories+as+being+ordered%2C+which+is+often+not+desired+%28i.e.+the+set+of+browsers+was+ordered+arbitrarily%29.%3C%2Fp%3E+%0A++%3Cp%3EAnother+possibility+to+convert+categorical+features+to+features+that+can+be+used+with+scikit-learn+estimators+is+to+use+a+one-of-K%2C+also+known+as+one-hot+or+dummy+encoding.+This+type+of+encoding+can+be+obtained+with+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.OneHotEncoder.html%23sklearn.preprocessing.OneHotEncoder%22+rel%3D%22nofollow%22%3E%3Ccode%3EOneHotEncoder%3C%2Fcode%3E%3C%2Fa%3E%2C+which+transforms+each+categorical+feature+with%26nbsp%3B%3Ccode%3En_categories%3C%2Fcode%3E%26nbsp%3Bpossible+values+into%26nbsp%3B%3Ccode%3En_categories%3C%2Fcode%3E%26nbsp%3Bbinary+features%2C+with+one+of+them+1%2C+and+all+others+0.%3C%2Fp%3E+%0A++%3Cp%3EContinuing+the+example+above%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+enc+%3D+preprocessing.OneHotEncoder%28%29%0A%26gt%3B%26gt%3B%26gt%3B+X+%3D+%5B%5B%27male%27%2C+%27from+US%27%2C+%27uses+Safari%27%5D%2C+%5B%27female%27%2C+%27from+Europe%27%2C+%27uses+Firefox%27%5D%5D%0A%26gt%3B%26gt%3B%26gt%3B+enc.fit%28X%29++%0AOneHotEncoder%28categorical_features%3DNone%2C+categories%3DNone%2C%0A+++++++dtype%3D%26lt%3B...+%27numpy.float64%27%26gt%3B%2C+handle_unknown%3D%27error%27%2C%0A+++++++n_values%3DNone%2C+sparse%3DTrue%29%0A%26gt%3B%26gt%3B%26gt%3B+enc.transform%28%5B%5B%27female%27%2C+%27from+US%27%2C+%27uses+Safari%27%5D%2C%0A...++++++++++++++++%5B%27male%27%2C+%27from+Europe%27%2C+%27uses+Safari%27%5D%5D%29.toarray%28%29%0Aarray%28%5B%5B1.%2C+0.%2C+0.%2C+1.%2C+0.%2C+1.%5D%2C%0A+++++++%5B0.%2C+1.%2C+1.%2C+0.%2C+0.%2C+1.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EBy+default%2C+the+values+each+feature+can+take+is+inferred+automatically+from+the+dataset+and+can+be+found+in+the%26nbsp%3B%3Ccode%3Ecategories_%3C%2Fcode%3E%26nbsp%3Battribute%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+enc.categories_%0A%5Barray%28%5B%27female%27%2C+%27male%27%5D%2C+dtype%3Dobject%29%2C+array%28%5B%27from+Europe%27%2C+%27from+US%27%5D%2C+dtype%3Dobject%29%2C+array%28%5B%27uses+Firefox%27%2C+%27uses+Safari%27%5D%2C+dtype%3Dobject%29%5D%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EIt+is+possible+to+specify+this+explicitly+using+the+parameter%26nbsp%3B%3Ccode%3Ecategories%3C%2Fcode%3E.+There+are+two+genders%2C+four+possible+continents+and+four+web+browsers+in+our+dataset%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+genders+%3D+%5B%27female%27%2C+%27male%27%5D%0A%26gt%3B%26gt%3B%26gt%3B+locations+%3D+%5B%27from+Africa%27%2C+%27from+Asia%27%2C+%27from+Europe%27%2C+%27from+US%27%5D%0A%26gt%3B%26gt%3B%26gt%3B+browsers+%3D+%5B%27uses+Chrome%27%2C+%27uses+Firefox%27%2C+%27uses+IE%27%2C+%27uses+Safari%27%5D%0A%26gt%3B%26gt%3B%26gt%3B+enc+%3D+preprocessing.OneHotEncoder%28categories%3D%5Bgenders%2C+locations%2C+browsers%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+%23+Note+that+for+there+are+missing+categorical+values+for+the+2nd+and+3rd%0A%26gt%3B%26gt%3B%26gt%3B+%23+feature%0A%26gt%3B%26gt%3B%26gt%3B+X+%3D+%5B%5B%27male%27%2C+%27from+US%27%2C+%27uses+Safari%27%5D%2C+%5B%27female%27%2C+%27from+Europe%27%2C+%27uses+Firefox%27%5D%5D%0A%26gt%3B%26gt%3B%26gt%3B+enc.fit%28X%29+%0AOneHotEncoder%28categorical_features%3DNone%2C%0A+++++++categories%3D%5B...%5D%2C%0A+++++++dtype%3D%26lt%3B...+%27numpy.float64%27%26gt%3B%2C+handle_unknown%3D%27error%27%2C%0A+++++++n_values%3DNone%2C+sparse%3DTrue%29%0A%26gt%3B%26gt%3B%26gt%3B+enc.transform%28%5B%5B%27female%27%2C+%27from+Asia%27%2C+%27uses+Chrome%27%5D%5D%29.toarray%28%29%0Aarray%28%5B%5B1.%2C+0.%2C+0.%2C+1.%2C+0.%2C+0.%2C+1.%2C+0.%2C+0.%2C+0.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EIf+there+is+a+possibility+that+the+training+data+might+have+missing+categorical+features%2C+it+can+often+be+better+to+specify%26nbsp%3B%3Ccode%3Ehandle_unknown%3D%27ignore%27%3C%2Fcode%3E%26nbsp%3Binstead+of+setting+the%26nbsp%3B%3Ccode%3Ecategories%3C%2Fcode%3E%26nbsp%3Bmanually+as+above.+When%26nbsp%3B%3Ccode%3Ehandle_unknown%3D%27ignore%27%3C%2Fcode%3E%26nbsp%3Bis+specified+and+unknown+categories+are+encountered+during+transform%2C+no+error+will+be+raised+but+the+resulting+one-hot+encoded+columns+for+this+feature+will+be+all+zeros+%28%3Ccode%3Ehandle_unknown%3D%27ignore%27%3C%2Fcode%3E%26nbsp%3Bis+only+supported+for+one-hot+encoding%29%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+enc+%3D+preprocessing.OneHotEncoder%28handle_unknown%3D%27ignore%27%29%0A%26gt%3B%26gt%3B%26gt%3B+X+%3D+%5B%5B%27male%27%2C+%27from+US%27%2C+%27uses+Safari%27%5D%2C+%5B%27female%27%2C+%27from+Europe%27%2C+%27uses+Firefox%27%5D%5D%0A%26gt%3B%26gt%3B%26gt%3B+enc.fit%28X%29+%0AOneHotEncoder%28categorical_features%3DNone%2C+categories%3DNone%2C%0A+++++++dtype%3D%26lt%3B...+%27numpy.float64%27%26gt%3B%2C+handle_unknown%3D%27ignore%27%2C%0A+++++++n_values%3DNone%2C+sparse%3DTrue%29%0A%26gt%3B%26gt%3B%26gt%3B+enc.transform%28%5B%5B%27female%27%2C+%27from+Asia%27%2C+%27uses+Chrome%27%5D%5D%29.toarray%28%29%0Aarray%28%5B%5B1.%2C+0.%2C+0.%2C+0.%2C+0.%2C+0.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3ESee%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Ffeature_extraction.html%23dict-feature-extraction%22+rel%3D%22nofollow%22%3ELoading+features+from+dicts%3C%2Fa%3E%26nbsp%3Bfor+categorical+features+that+are+represented+as+a+dict%2C+not+as+scalars.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.5.+Discretization%3C%2Fh2%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FDiscretization_of_continuous_features%22+rel%3D%22nofollow%22%3EDiscretization%3C%2Fa%3E%26nbsp%3B%28otherwise+known+as+quantization+or+binning%29+provides+a+way+to+partition+continuous+features+into+discrete+values.+Certain+datasets+with+continuous+features+may+benefit+from+discretization%2C+because+discretization+can+transform+the+dataset+of+continuous+attributes+to+one+with+only+nominal+attributes.%3C%2Fp%3E+%0A++%3Cp%3EOne-hot+encoded+discretized+features+can+make+a+model+more+expressive%2C+while+maintaining+interpretability.+For+instance%2C+pre-processing+with+a+discretizer+can+introduce+nonlinearity+to+linear+models.%3C%2Fp%3E+%0A++%3Ch3%3E4.3.5.1.+K-bins+discretization%3C%2Fh3%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.KBinsDiscretizer.html%23sklearn.preprocessing.KBinsDiscretizer%22+rel%3D%22nofollow%22%3E%3Ccode%3EKBinsDiscretizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bdiscretizers+features+into%26nbsp%3B%3Ccode%3Ek%3C%2Fcode%3E%26nbsp%3Bequal+width+bins%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X+%3D+np.array%28%5B%5B+-3.%2C+5.%2C+15+%5D%2C%0A...+++++++++++++++%5B++0.%2C+6.%2C+14+%5D%2C%0A...+++++++++++++++%5B++6.%2C+3.%2C+11+%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+est+%3D+preprocessing.KBinsDiscretizer%28n_bins%3D%5B3%2C+2%2C+2%5D%2C+encode%3D%27ordinal%27%29.fit%28X%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EBy+default+the+output+is+one-hot+encoded+into+a+sparse+matrix+%28See%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fpreprocessing.html%23preprocessing-categorical-features%22+rel%3D%22nofollow%22%3EEncoding+categorical+features%3C%2Fa%3E%29+and+this+can+be+configured+with+the%26nbsp%3B%3Ccode%3Eencode%3C%2Fcode%3E%26nbsp%3Bparameter.+For+each+feature%2C+the+bin+edges+are+computed+during%26nbsp%3B%3Ccode%3Efit%3C%2Fcode%3E%26nbsp%3Band+together+with+the+number+of+bins%2C+they+will+define+the+intervals.+Therefore%2C+for+the+current+example%2C+these+intervals+are+defined+as%3A%3C%2Fp%3E+%0A++%3Cblockquote%3E+%0A+++%3Cul%3E%0A++++%3Cli%3Efeature+1%3A%26nbsp%3B%5B%E2%88%92%E2%88%9E%2C%E2%88%921%29%2C%5B%E2%88%921%2C2%29%2C%5B2%2C%E2%88%9E%29%3C%2Fli%3E+%0A++++%3Cli%3Efeature+2%3A%26nbsp%3B%5B%E2%88%92%E2%88%9E%2C5%29%2C%5B5%2C%E2%88%9E%29%3C%2Fli%3E+%0A++++%3Cli%3Efeature+3%3A%26nbsp%3B%5B%E2%88%92%E2%88%9E%2C14%29%2C%5B14%2C%E2%88%9E%29%3C%2Fli%3E+%0A+++%3C%2Ful%3E%0A+++%3Cp%3EBased+on+these+bin+intervals%2C%26nbsp%3B%3Ccode%3EX%3C%2Fcode%3E%26nbsp%3Bis+transformed+as+follows%3A%3C%2Fp%3E+%26gt%3B%26gt%3B%26gt%3B+%0A+++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+est.transform%28X%29++++++++++++++++++++++%0Aarray%28%5B%5B+0.%2C+1.%2C+1.%5D%2C%0A+++++++%5B+1.%2C+1.%2C+1.%5D%2C%0A+++++++%5B+2.%2C+0.%2C+0.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3C%2Fblockquote%3E+%0A++%3Cp%3EThe+resulting+dataset+contains+ordinal+attributes+which+can+be+further+used+in+a%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.pipeline.Pipeline.html%23sklearn.pipeline.Pipeline%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.pipeline.Pipeline%3C%2Fcode%3E%3C%2Fa%3E.%3C%2Fp%3E+%0A++%3Cp%3EDiscretization+is+similar+to+constructing+histograms+for+continuous+data.+However%2C+histograms+focus+on+counting+features+which+fall+into+particular+bins%2C+whereas+discretization+focuses+on+assigning+feature+values+to+these+bins.%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.KBinsDiscretizer.html%23sklearn.preprocessing.KBinsDiscretizer%22+rel%3D%22nofollow%22%3E%3Ccode%3EKBinsDiscretizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bimplements+different+binning+strategies%2C+which+can+be+selected+with+the%26nbsp%3B%3Ccode%3Estrategy%3C%2Fcode%3E%26nbsp%3Bparameter.+The+%E2%80%98uniform%E2%80%99+strategy+uses+constant-width+bins.+The+%E2%80%98quantile%E2%80%99+strategy+uses+the+quantiles+values+to+have+equally+populated+bins+in+each+feature.+The+%E2%80%98kmeans%E2%80%99+strategy+defines+bins+based+on+a+k-means+clustering+procedure+performed+on+each+feature+independently.%3C%2Fp%3E+%0A++%3Cp%3EExamples%3A%3C%2Fp%3E+%0A++%3Cul%3E%0A+++%3Cli%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fauto_examples%2Fpreprocessing%2Fplot_discretization.html%23sphx-glr-auto-examples-preprocessing-plot-discretization-py%22+rel%3D%22nofollow%22%3EUsing+KBinsDiscretizer+to+discretize+continuous+features%3C%2Fa%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fauto_examples%2Fpreprocessing%2Fplot_discretization_classification.html%23sphx-glr-auto-examples-preprocessing-plot-discretization-classification-py%22+rel%3D%22nofollow%22%3EFeature+discretization%3C%2Fa%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fauto_examples%2Fpreprocessing%2Fplot_discretization_strategies.html%23sphx-glr-auto-examples-preprocessing-plot-discretization-strategies-py%22+rel%3D%22nofollow%22%3EDemonstrating+the+different+strategies+of+KBinsDiscretizer%3C%2Fa%3E%3C%2Fli%3E+%0A++%3C%2Ful%3E%0A++%3Ch3%3E4.3.5.2.+Feature+binarization%3C%2Fh3%3E+%0A++%3Cp%3E%3Cstrong%3EFeature+binarization%3C%2Fstrong%3E%26nbsp%3Bis+the+process+of%26nbsp%3B%3Cstrong%3Ethresholding+numerical+features+to+get+boolean+values%3C%2Fstrong%3E.+This+can+be+useful+for+downstream+probabilistic+estimators+that+make+assumption+that+the+input+data+is+distributed+according+to+a+multi-variate%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FBernoulli_distribution%22+rel%3D%22nofollow%22%3EBernoulli+distribution%3C%2Fa%3E.+For+instance%2C+this+is+the+case+for+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.neural_network.BernoulliRBM.html%23sklearn.neural_network.BernoulliRBM%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.neural_network.BernoulliRBM%3C%2Fcode%3E%3C%2Fa%3E.%3C%2Fp%3E+%0A++%3Cp%3EIt+is+also+common+among+the+text+processing+community+to+use+binary+feature+values+%28probably+to+simplify+the+probabilistic+reasoning%29+even+if+normalized+counts+%28a.k.a.+term+frequencies%29+or+TF-IDF+valued+features+often+perform+slightly+better+in+practice.%3C%2Fp%3E+%0A++%3Cp%3EAs+for+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Normalizer.html%23sklearn.preprocessing.Normalizer%22+rel%3D%22nofollow%22%3E%3Ccode%3ENormalizer%3C%2Fcode%3E%3C%2Fa%3E%2C+the+utility+class%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Binarizer.html%23sklearn.preprocessing.Binarizer%22+rel%3D%22nofollow%22%3E%3Ccode%3EBinarizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bis+meant+to+be+used+in+the+early+stages+of%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.pipeline.Pipeline.html%23sklearn.pipeline.Pipeline%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.pipeline.Pipeline%3C%2Fcode%3E%3C%2Fa%3E.+The%26nbsp%3B%3Ccode%3Efit%3C%2Fcode%3E%26nbsp%3Bmethod+does+nothing+as+each+sample+is+treated+independently+of+others%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X+%3D+%5B%5B+1.%2C+-1.%2C++2.%5D%2C%0A...++++++%5B+2.%2C++0.%2C++0.%5D%2C%0A...++++++%5B+0.%2C++1.%2C+-1.%5D%5D%0A%0A%26gt%3B%26gt%3B%26gt%3B+binarizer+%3D+preprocessing.Binarizer%28%29.fit%28X%29++%23+fit+does+nothing%0A%26gt%3B%26gt%3B%26gt%3B+binarizer%0ABinarizer%28copy%3DTrue%2C+threshold%3D0.0%29%0A%0A%26gt%3B%26gt%3B%26gt%3B+binarizer.transform%28X%29%0Aarray%28%5B%5B1.%2C+0.%2C+1.%5D%2C%0A+++++++%5B1.%2C+0.%2C+0.%5D%2C%0A+++++++%5B0.%2C+1.%2C+0.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EIt+is+possible+to+adjust+the+threshold+of+the+binarizer%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+binarizer+%3D+preprocessing.Binarizer%28threshold%3D1.1%29%0A%26gt%3B%26gt%3B%26gt%3B+binarizer.transform%28X%29%0Aarray%28%5B%5B0.%2C+0.%2C+1.%5D%2C%0A+++++++%5B1.%2C+0.%2C+0.%5D%2C%0A+++++++%5B0.%2C+0.%2C+0.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EAs+for+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.StandardScaler.html%23sklearn.preprocessing.StandardScaler%22+rel%3D%22nofollow%22%3E%3Ccode%3EStandardScaler%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Normalizer.html%23sklearn.preprocessing.Normalizer%22+rel%3D%22nofollow%22%3E%3Ccode%3ENormalizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bclasses%2C+the+preprocessing+module+provides+a+companion+function%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.binarize.html%23sklearn.preprocessing.binarize%22+rel%3D%22nofollow%22%3E%3Ccode%3Ebinarize%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bto+be+used+when+the+transformer+API+is+not+necessary.%3C%2Fp%3E+%0A++%3Cp%3ENote+that+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Binarizer.html%23sklearn.preprocessing.Binarizer%22+rel%3D%22nofollow%22%3E%3Ccode%3EBinarizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bis+similar+to+the%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.KBinsDiscretizer.html%23sklearn.preprocessing.KBinsDiscretizer%22+rel%3D%22nofollow%22%3E%3Ccode%3EKBinsDiscretizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Bwhen%26nbsp%3B%3Ccode%3Ek%26nbsp%3B%3D%26nbsp%3B2%3C%2Fcode%3E%2C+and+when+the+bin+edge+is+at+the+value%26nbsp%3B%3Ccode%3Ethreshold%3C%2Fcode%3E.%3C%2Fp%3E+%0A++%3Cp%3ESparse+input%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.binarize.html%23sklearn.preprocessing.binarize%22+rel%3D%22nofollow%22%3E%3Ccode%3Ebinarize%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Band%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.Binarizer.html%23sklearn.preprocessing.Binarizer%22+rel%3D%22nofollow%22%3E%3Ccode%3EBinarizer%3C%2Fcode%3E%3C%2Fa%3E%26nbsp%3Baccept%26nbsp%3B%3Cstrong%3Eboth+dense+array-like+and+sparse+matrices+from+scipy.sparse+as+input%3C%2Fstrong%3E.%3C%2Fp%3E+%0A++%3Cp%3EFor+sparse+input+the+data+is%26nbsp%3B%3Cstrong%3Econverted+to+the+Compressed+Sparse+Rows+representation%3C%2Fstrong%3E%26nbsp%3B%28see%26nbsp%3B%3Ccode%3Escipy.sparse.csr_matrix%3C%2Fcode%3E%29.+To+avoid+unnecessary+memory+copies%2C+it+is+recommended+to+choose+the+CSR+representation+upstream.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.6.+Imputation+of+missing+values%3C%2Fh2%3E+%0A++%3Cp%3ETools+for+imputing+missing+values+are+discussed+at%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fimpute.html%23impute%22+rel%3D%22nofollow%22%3EImputation+of+missing+values%3C%2Fa%3E.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.7.+Generating+polynomial+features%3C%2Fh2%3E+%0A++%3Cp%3EOften+it%E2%80%99s+useful+to+add+complexity+to+the+model+by+considering+nonlinear+features+of+the+input+data.+A+simple+and+common+method+to+use+is+polynomial+features%2C+which+can+get+features%E2%80%99+high-order+and+interaction+terms.+It+is+implemented+in%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.PolynomialFeatures.html%23sklearn.preprocessing.PolynomialFeatures%22+rel%3D%22nofollow%22%3E%3Ccode%3EPolynomialFeatures%3C%2Fcode%3E%3C%2Fa%3E%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+import+numpy+as+np%0A%26gt%3B%26gt%3B%26gt%3B+from+sklearn.preprocessing+import+PolynomialFeatures%0A%26gt%3B%26gt%3B%26gt%3B+X+%3D+np.arange%286%29.reshape%283%2C+2%29%0A%26gt%3B%26gt%3B%26gt%3B+X+++++++++++++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B%5B0%2C+1%5D%2C%0A+++++++%5B2%2C+3%5D%2C%0A+++++++%5B4%2C+5%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+poly+%3D+PolynomialFeatures%282%29%0A%26gt%3B%26gt%3B%26gt%3B+poly.fit_transform%28X%29+++++++++++++++++++++++++++++%0Aarray%28%5B%5B+1.%2C++0.%2C++1.%2C++0.%2C++0.%2C++1.%5D%2C%0A+++++++%5B+1.%2C++2.%2C++3.%2C++4.%2C++6.%2C++9.%5D%2C%0A+++++++%5B+1.%2C++4.%2C++5.%2C+16.%2C+20.%2C+25.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe+features+of+X+have+been+transformed+from%26nbsp%3B%28X1%2CX2%29%26nbsp%3Bto%26nbsp%3B%281%2CX1%2CX2%2CX12%2CX1X2%2CX22%29.%3C%2Fp%3E+%0A++%3Cp%3EIn+some+cases%2C+only+interaction+terms+among+features+are+required%2C+and+it+can+be+gotten+with+the+setting%26nbsp%3B%3Ccode%3Einteraction_only%3DTrue%3C%2Fcode%3E%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+X+%3D+np.arange%289%29.reshape%283%2C+3%29%0A%26gt%3B%26gt%3B%26gt%3B+X+++++++++++++++++++++++++++++++++++++++++++++++++%0Aarray%28%5B%5B0%2C+1%2C+2%5D%2C%0A+++++++%5B3%2C+4%2C+5%5D%2C%0A+++++++%5B6%2C+7%2C+8%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+poly+%3D+PolynomialFeatures%28degree%3D3%2C+interaction_only%3DTrue%29%0A%26gt%3B%26gt%3B%26gt%3B+poly.fit_transform%28X%29+++++++++++++++++++++++++++++%0Aarray%28%5B%5B++1.%2C+++0.%2C+++1.%2C+++2.%2C+++0.%2C+++0.%2C+++2.%2C+++0.%5D%2C%0A+++++++%5B++1.%2C+++3.%2C+++4.%2C+++5.%2C++12.%2C++15.%2C++20.%2C++60.%5D%2C%0A+++++++%5B++1.%2C+++6.%2C+++7.%2C+++8.%2C++42.%2C++48.%2C++56.%2C+336.%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EThe+features+of+X+have+been+transformed+from%26nbsp%3B%28X1%2CX2%2CX3%29%26nbsp%3Bto%26nbsp%3B%281%2CX1%2CX2%2CX3%2CX1X2%2CX1X3%2CX2X3%2CX1X2X3%29.%3C%2Fp%3E+%0A++%3Cp%3ENote+that+polynomial+features+are+used+implicitly+in%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FKernel_method%22+rel%3D%22nofollow%22%3Ekernel+methods%3C%2Fa%3E%26nbsp%3B%28e.g.%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.svm.SVC.html%23sklearn.svm.SVC%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.svm.SVC%3C%2Fcode%3E%3C%2Fa%3E%2C%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.decomposition.KernelPCA.html%23sklearn.decomposition.KernelPCA%22+rel%3D%22nofollow%22%3E%3Ccode%3Esklearn.decomposition.KernelPCA%3C%2Fcode%3E%3C%2Fa%3E%29+when+using+polynomial%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fsvm.html%23svm-kernels%22+rel%3D%22nofollow%22%3EKernel+functions%3C%2Fa%3E.%3C%2Fp%3E+%0A++%3Cp%3ESee%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fauto_examples%2Flinear_model%2Fplot_polynomial_interpolation.html%23sphx-glr-auto-examples-linear-model-plot-polynomial-interpolation-py%22+rel%3D%22nofollow%22%3EPolynomial+interpolation%3C%2Fa%3E%26nbsp%3Bfor+Ridge+regression+using+created+polynomial+features.%3C%2Fp%3E+%0A++%3Ch2%3E4.3.8.+Custom+transformers%3C%2Fh2%3E+%0A++%3Cp%3EOften%2C+you+will+want+to+convert+an+existing+Python+function+into+a+transformer+to+assist+in+data+cleaning+or+processing.+You+can+implement+a+transformer+from+an+arbitrary+function+with%26nbsp%3B%3Ca+href%3D%22https%3A%2F%2Fscikit-learn.org%2Fstable%2Fmodules%2Fgenerated%2Fsklearn.preprocessing.FunctionTransformer.html%23sklearn.preprocessing.FunctionTransformer%22+rel%3D%22nofollow%22%3E%3Ccode%3EFunctionTransformer%3C%2Fcode%3E%3C%2Fa%3E.+For+example%2C+to+build+a+transformer+that+applies+a+log+transformation+in+a+pipeline%2C+do%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+import+numpy+as+np%0A%26gt%3B%26gt%3B%26gt%3B+from+sklearn.preprocessing+import+FunctionTransformer%0A%26gt%3B%26gt%3B%26gt%3B+transformer+%3D+FunctionTransformer%28np.log1p%2C+validate%3DTrue%29%0A%26gt%3B%26gt%3B%26gt%3B+X+%3D+np.array%28%5B%5B0%2C+1%5D%2C+%5B2%2C+3%5D%5D%29%0A%26gt%3B%26gt%3B%26gt%3B+transformer.transform%28X%29%0Aarray%28%5B%5B0.++++++++%2C+0.69314718%5D%2C%0A+++++++%5B1.09861229%2C+1.38629436%5D%5D%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EYou+can+ensure+that%26nbsp%3B%3Ccode%3Efunc%3C%2Fcode%3E%26nbsp%3Band%26nbsp%3B%3Ccode%3Einverse_func%3C%2Fcode%3E%26nbsp%3Bare+the+inverse+of+each+other+by+setting%26nbsp%3B%3Ccode%3Echeck_inverse%3DTrue%3C%2Fcode%3E%26nbsp%3Band+calling%26nbsp%3B%3Ccode%3Efit%3C%2Fcode%3E%26nbsp%3Bbefore%26nbsp%3B%3Ccode%3Etransform%3C%2Fcode%3E.+Please+note+that+a+warning+is+raised+and+can+be+turned+into+an+error+with+a%26nbsp%3B%3Ccode%3Efilterwarnings%3C%2Fcode%3E%3A%3C%2Fp%3E+%0A++%3Cp%3E%26gt%3B%26gt%3B%26gt%3B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22has%22%3E%0A%3Ccode+class%3D%22language-html%22%3E%26gt%3B%26gt%3B%26gt%3B+import+warnings%0A%26gt%3B%26gt%3B%26gt%3B+warnings.filterwarnings%28%22error%22%2C+message%3D%22.*check_inverse*.%22%2C%0A...+++++++++++++++++++++++++category%3DUserWarning%2C+append%3DFalse%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}