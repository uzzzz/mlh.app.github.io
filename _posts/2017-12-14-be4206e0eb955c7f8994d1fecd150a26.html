---
layout: default
title: 从TuShare读取开市日历然后计算保存交易日历
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3ETuShare%E6%8F%90%E4%BE%9B%E7%9A%84%E6%97%A5%E5%8E%86%E6%8F%90%E4%BE%9B%E4%BA%86%E8%87%AA%E4%BA%A4%E6%98%93%E6%89%80%E5%BC%80%E5%A7%8B%E4%BA%A4%E6%98%93%E4%BB%A5%E6%9D%A5%E6%AF%8F%E4%B8%80%E5%A4%A9%E6%98%AF%E5%90%A6%E5%BC%80%E5%B8%82%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C+%E4%BD%86%E6%98%AF%E6%B2%A1%E6%9C%89%E6%8F%90%E4%BE%9B%E5%85%B6%E4%BB%96%E5%9C%A8%E5%9B%9E%E6%B5%8B%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E5%88%B0%E7%9A%84%E6%97%A5%E5%8E%86%E4%BF%A1%E6%81%AF%EF%BC%88%E4%BE%8B%E5%A6%82%E6%9F%90%E4%B8%80%E5%A4%A9%E6%98%AF%E5%90%A6%E6%98%AF%E4%B8%80%E4%B8%AA%E6%9C%88%E7%9A%84%E9%A6%96%E4%B8%AA%E4%BA%A4%E6%98%93%E6%97%A5%E6%88%96%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E4%BA%A4%E6%98%93%E6%97%A5%EF%BC%89%EF%BC%8C+%E6%9C%AC%E6%96%87%E4%BB%8ETuShare%E8%AF%BB%E5%8F%96%E5%BC%80%E5%B8%82%E6%97%A5%E5%8E%86%E7%84%B6%E5%90%8E%E8%AE%A1%E7%AE%97%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BA%A4%E6%98%93%E6%97%A5%E5%8E%86%E5%B9%B6%E4%BF%9D%E5%AD%98%E7%9A%84%E6%9C%AC%E5%9C%B0%E3%80%82+%E8%BF%99%E6%A0%B7%E5%85%B6%E4%BB%96%E7%A8%8B%E5%BA%8F%E5%8F%AF%E4%BB%A5%E8%AF%BB%E5%8F%96%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BA%A4%E6%98%93%E6%97%A5%E5%8E%86%E4%BB%8E%E8%80%8C%E9%81%BF%E5%85%8D%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E9%87%8D%E5%A4%8D%E8%AE%A1%E7%AE%97%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E%0A++%3Cpre%3E%3Ccode+class%3D%22language-python%22%3Eimport+numpy+as+np++%0Aimport+pandas+as+pd++%0Aimport+tushare+as+ts++%0Aimport+datetime++%0Aimport+time++%0Aimport+tushare+as+ts++%0Aimport+os++%0Aimport+matplotlib++%0Aimport+matplotlib.pyplot+as+plt++%0A%0Adef+gen_save_exchange_calendar%28%29%3A%0A++++%23%E4%BB%8ETuShare%E8%AF%BB%E5%8F%96%E5%BC%80%E5%B8%82%E6%97%A5%E5%8E%86%EF%BC%8C%E7%84%B6%E5%90%8E%E8%87%AA%E5%B7%B1%E8%AE%A1%E7%AE%97week%2Fmonth%2Fquerter%2Fyear+sart%2Fend+%E5%B1%9E%E6%80%A7%0A++++%23%E7%84%B6%E5%90%8E%E4%BF%9D%E5%AD%98%E5%9C%A8%E6%9C%AC%E5%9C%B0%E4%BB%A5%E4%BE%9B%E4%BB%A5%E5%90%8E%E4%BD%BF%E7%94%A8%0A++++cal_dates+%3D+ts.trade_cal%28%29%0A++++cal_dates%5B%27isWeekStart%27%5D+%3D+0%0A++++cal_dates%5B%27isWeekEnd%27%5D+%3D+0%0A++++cal_dates%5B%27isMonthStart%27%5D+%3D+0%0A++++cal_dates%5B%27isMonthEnd%27%5D+%3D+0%0A++++cal_dates%5B%27isQuarterStart%27%5D+%3D+0%0A++++cal_dates%5B%27isQuarterEnd%27%5D+%3D+0%0A++++cal_dates%5B%27isYearStart%27%5D+%3D+0%0A++++cal_dates%5B%27isYearEnd%27%5D+%3D+0%0A++++previous_i+%3D+-1%0A++++previous_open_week+%3D+-1%0A++++previous_open_month+%3D+-1%0A++++previous_open_year+%3D+-1%0A%0A++++for+i+in+cal_dates.index%3A%0A++++++++str_date+%3D+cal_dates.loc%5Bi%5D%5B%27calendarDate%27%5D%0A++++++++isOpen+%3D+cal_dates.loc%5Bi%5D%5B%27isOpen%27%5D%0A++++++++if+not+isOpen%3A%0A++++++++++++continue%0A++++++++date+%3D+datetime.datetime.strptime%28str_date%2C+%27%25Y-%25m-%25d%27%29.date%28%29%0A++++++++%23%E8%AE%BE%E7%BD%AEisWeekStart%E5%92%8CisWeekEnd%0A++++++++current_open_week+%3D+date.isocalendar%28%29%5B1%5D%0A++++++++if+current_open_week+%21%3D+previous_open_week%3A%0A++++++++++++cal_dates.ix%5Bi%2C+%27isWeekStart%27%5D+%3D+1%0A++++++++++++if+previous_open_week+%21%3D+-1%3A%0A++++++++++++++++cal_dates.ix%5Bprevious_i%2C+%27isWeekEnd%27%5D+%3D+1%0A++++++++++++%0A++++++++%23%E8%AE%BE%E7%BD%AEisMonthStart%E5%92%8CisMonthEnd%0A++++++++current_open_month+%3D+date.month%0A++++++++if+current_open_month+%21%3D+previous_open_month%3A%0A++++++++++++cal_dates.ix%5Bi%2C+%27isMonthStart%27%5D+%3D+1%0A++++++++++++if+previous_open_month+%21%3D+-1%3A%0A++++++++++++++++cal_dates.ix%5Bprevious_i%2C+%27isMonthEnd%27%5D+%3D+1%0A++++++++++++%23%E9%A1%BA%E4%BE%BF%E6%A0%B9%E6%8D%AE%E6%9C%88%E4%BB%BD%E8%AE%BE%E7%BD%AEisQuarterStart%E5%92%8CisQuarterEnd%0A++++++++++++if+current_open_month+in+%5B1%2C+4%2C+7%2C+10%5D%3A%0A++++++++++++++++cal_dates.ix%5Bi%2C+%27isQuarterStart%27%5D+%3D+1+%0A++++++++++++++++if+previous_open_month+%21%3D+-1%3A%0A++++++++++++++++++++cal_dates.ix%5Bprevious_i%2C+%27isQuarterEnd%27%5D+%3D+1%0A++++++++++++%23%E6%9C%89%E4%B8%AA%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5%E6%98%AF%E4%BA%A4%E6%98%93%E6%89%80%E5%BC%80%E5%A7%8B%E7%AC%AC%E4%B8%80%E5%A4%A9%E5%BA%94%E4%B8%BAQuarterStart%0A++++++++++++if+previous_open_month+%3D%3D+-1%3A%0A++++++++++++++++cal_dates.ix%5Bi%2C+%27isQuarterStart%27%5D+%3D+1%0A++++++++++++++++%0A++++++++%23%E8%AE%BE%E7%BD%AEisYearStart%E5%92%8CisYearEnd%0A++++++++current_open_year+%3D+date.year%0A++++++++if+current_open_year+%21%3D+previous_open_year%3A%0A++++++++++++cal_dates.ix%5Bi%2C+%27isYearStart%27%5D+%3D+1%0A++++++++++++if+previous_open_year+%21%3D+-1%3A%0A++++++++++++++++cal_dates.ix%5Bprevious_i%2C+%27isYearEnd%27%5D+%3D+1++++++++++++%0A%0A++++++++previous_i+%3D+i%0A++++++++previous_open_week+%3D+current_open_week%0A++++++++previous_open_month+%3D+current_open_month%0A++++++++previous_open_year+%3D+current_open_year%0A++++++++%0A++++%23%E4%BF%9D%E5%AD%98%E5%88%B0%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E4%B8%AD%0A++++file_name+%3D+%27D%3A%5C%5Cpython_study%5C%5Cstock_hist_data%5C%5Cexchange_calendar.h5%27%0A++++hdf5_file%3Dpd.HDFStore%28file_name%2C+%27w%27%2Ccomplevel%3D4%2C+complib%3D%27blosc%27%29%0A++++hdf5_file%5B%27data%27%5D%3Dcal_dates+%0A++++hdf5_file.close%28%29++%0A++++%0A++++%0Agen_save_exchange_calendar%28%29%0A%3C%2Fcode%3E%3C%2Fpre%3E%0A++%3Cbr%3E%0A++%3Cbr%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fwqfhenanxc%2Farticle%2Fdetails%2F78808548%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fwqfhenanxc%2Farticle%2Fdetails%2F78808548%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}