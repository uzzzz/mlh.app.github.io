---
layout: default
title: TensorFlow之迁移学习CNN图像分类及模型保存与调用
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-f57960eb32.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22+id%3D%22content_views%22%3E+%0A++%3Cp%3E%E6%9C%AC%E6%96%87%E4%B8%BB%E8%A6%81%E9%80%9A%E8%BF%87CNN%E8%BF%9B%E8%A1%8C%E8%8A%B1%E5%8D%89%E7%9A%84%E5%88%86%E7%B1%BB%EF%BC%8C%E8%AE%AD%E7%BB%83%E7%BB%93%E6%9D%9F%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B%EF%BC%8C%E6%9C%80%E5%90%8E%E9%80%9A%E8%BF%87%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B%EF%BC%8C%E8%BE%93%E5%85%A5%E8%8A%B1%E5%8D%89%E7%9A%84%E5%9B%BE%E7%89%87%E9%80%9A%E8%BF%87%E6%A8%A1%E5%9E%8B%E6%9D%A5%E8%BF%9B%E8%A1%8C%E7%B1%BB%E5%88%AB%E7%9A%84%E9%A2%84%E6%B5%8B%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0%EF%BC%9Awin+10%2Btensorflow+1.2%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%9Ahttp%3A%2F%2Fdownload.tensorflow.org%2Fexample_images%2Fflower_photos.tgz%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%AD%E6%80%BB%E5%85%B1%E6%9C%89%E4%BA%94%E7%A7%8D%E8%8A%B1%EF%BC%8C%E5%88%86%E5%88%AB%E6%94%BE%E5%9C%A8%E4%BA%94%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E4%B8%80%E3%80%81CNN%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%A8%A1%E5%9E%8B%E5%B0%BA%E5%AF%B8%E5%88%86%E6%9E%90%EF%BC%9A%E5%8D%B7%E7%A7%AF%E5%B1%82%E5%85%A8%E9%83%BD%E9%87%87%E7%94%A8%E4%BA%86%E8%A1%A50%EF%BC%8C%E6%89%80%E4%BB%A5%E7%BB%8F%E8%BF%87%E5%8D%B7%E7%A7%AF%E5%B1%82%E9%95%BF%E5%92%8C%E5%AE%BD%E4%B8%8D%E5%8F%98%EF%BC%8C%E5%8F%AA%E6%9C%89%E6%B7%B1%E5%BA%A6%E5%8A%A0%E6%B7%B1%E3%80%82%E6%B1%A0%E5%8C%96%E5%B1%82%E5%85%A8%E9%83%BD%E6%B2%A1%E6%9C%89%E8%A1%A50%EF%BC%8C%E6%89%80%E4%BB%A5%E7%BB%8F%E8%BF%87%E6%B1%A0%E5%8C%96%E5%B1%82%E9%95%BF%E5%92%8C%E5%AE%BD%E5%9D%87%E5%87%8F%E5%B0%8F%EF%BC%8C%E6%B7%B1%E5%BA%A6%E4%B8%8D%E5%8F%98%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%A8%A1%E5%9E%8B%E5%B0%BA%E5%AF%B8%E5%8F%98%E5%8C%96%EF%BC%9A100%C3%97100%C3%973-%26gt%3B100%C3%97100%C3%9732-%26gt%3B50%C3%9750%C3%9732-%26gt%3B50%C3%9750%C3%9764-%26gt%3B25%C3%9725%C3%9764-%26gt%3B25%C3%9725%C3%97128-%26gt%3B12%C3%9712%C3%97128-%26gt%3B12%C3%9712%C3%97128-%26gt%3B6%C3%976%C3%97128%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3BCNN%E8%AE%AD%E7%BB%83%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+from+skimage+import+io%2Ctransform%3Cbr%3E+import+glob%3Cbr%3E+import+os%3Cbr%3E+import+tensorflow+as+tf%3Cbr%3E+import+numpy+as+np%3Cbr%3E+import+time%3C%2Fp%3E+%0A++%3Cp%3E%23%E6%95%B0%E6%8D%AE%E9%9B%86%E5%9C%B0%E5%9D%80%3Cbr%3E+path%3D%27E%3A%2Fdata%2Fdatasets%2Fflower_photos%2F%27%3Cbr%3E+%23%E6%A8%A1%E5%9E%8B%E4%BF%9D%E5%AD%98%E5%9C%B0%E5%9D%80%3Cbr%3E+model_path%3D%27E%3A%2Fdata%2Fmodel%2Fflower%2Fmodel.ckpt%27%3C%2Fp%3E+%0A++%3Cp%3E%23%E5%B0%86%E6%89%80%E6%9C%89%E7%9A%84%E5%9B%BE%E7%89%87resize%E6%88%90100*100%3Cbr%3E+w%3D100%3Cbr%3E+h%3D100%3Cbr%3E+c%3D3%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+%23%E8%AF%BB%E5%8F%96%E5%9B%BE%E7%89%87%3Cbr%3E+def+read_img%28path%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+cate%3D%5Bpath%2Bx+for+x+in+os.listdir%28path%29+if+os.path.isdir%28path%2Bx%29%5D%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+imgs%3D%5B%5D%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+labels%3D%5B%5D%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+for+idx%2Cfolder+in+enumerate%28cate%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+for+im+in+glob.glob%28folder%2B%27%2F*.jpg%27%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+print%28%27reading+the+images%3A%25s%27%25%28im%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+img%3Dio.imread%28im%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+img%3Dtransform.resize%28img%2C%28w%2Ch%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+imgs.append%28img%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+labels.append%28idx%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+np.asarray%28imgs%2Cnp.float32%29%2Cnp.asarray%28labels%2Cnp.int32%29%3Cbr%3E+data%2Clabel%3Dread_img%28path%29%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+%23%E6%89%93%E4%B9%B1%E9%A1%BA%E5%BA%8F%3Cbr%3E+num_example%3Ddata.shape%5B0%5D%3Cbr%3E+arr%3Dnp.arange%28num_example%29%3Cbr%3E+np.random.shuffle%28arr%29%3Cbr%3E+data%3Ddata%5Barr%5D%3Cbr%3E+label%3Dlabel%5Barr%5D%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+%23%E5%B0%86%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E5%88%86%E4%B8%BA%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E9%AA%8C%E8%AF%81%E9%9B%86%3Cbr%3E+ratio%3D0.8%3Cbr%3E+s%3Dnp.int%28num_example*ratio%29%3Cbr%3E+x_train%3Ddata%5B%3As%5D%3Cbr%3E+y_train%3Dlabel%5B%3As%5D%3Cbr%3E+x_val%3Ddata%5Bs%3A%5D%3Cbr%3E+y_val%3Dlabel%5Bs%3A%5D%3C%2Fp%3E+%0A++%3Cp%3E%23-----------------%E6%9E%84%E5%BB%BA%E7%BD%91%E7%BB%9C----------------------%3Cbr%3E+%23%E5%8D%A0%E4%BD%8D%E7%AC%A6%3Cbr%3E+x%3Dtf.placeholder%28tf.float32%2Cshape%3D%5BNone%2Cw%2Ch%2Cc%5D%2Cname%3D%27x%27%29%3Cbr%3E+y_%3Dtf.placeholder%28tf.int32%2Cshape%3D%5BNone%2C%5D%2Cname%3D%27y_%27%29%3C%2Fp%3E+%0A++%3Cp%3Edef+inference%28input_tensor%2C+train%2C+regularizer%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%27layer1-conv1%27%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv1_weights+%3D+tf.get_variable%28%22weight%22%2C%5B5%2C5%2C3%2C32%5D%2Cinitializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv1_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B32%5D%2C+initializer%3Dtf.constant_initializer%280.0%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv1+%3D+tf.nn.conv2d%28input_tensor%2C+conv1_weights%2C+strides%3D%5B1%2C+1%2C+1%2C+1%5D%2C+padding%3D%27SAME%27%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+relu1+%3D+tf.nn.relu%28tf.nn.bias_add%28conv1%2C+conv1_biases%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.name_scope%28%22layer2-pool1%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+pool1+%3D+tf.nn.max_pool%28relu1%2C+ksize+%3D+%5B1%2C2%2C2%2C1%5D%2Cstrides%3D%5B1%2C2%2C2%2C1%5D%2Cpadding%3D%22VALID%22%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%22layer3-conv2%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv2_weights+%3D+tf.get_variable%28%22weight%22%2C%5B5%2C5%2C32%2C64%5D%2Cinitializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv2_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B64%5D%2C+initializer%3Dtf.constant_initializer%280.0%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv2+%3D+tf.nn.conv2d%28pool1%2C+conv2_weights%2C+strides%3D%5B1%2C+1%2C+1%2C+1%5D%2C+padding%3D%27SAME%27%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+relu2+%3D+tf.nn.relu%28tf.nn.bias_add%28conv2%2C+conv2_biases%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.name_scope%28%22layer4-pool2%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+pool2+%3D+tf.nn.max_pool%28relu2%2C+ksize%3D%5B1%2C+2%2C+2%2C+1%5D%2C+strides%3D%5B1%2C+2%2C+2%2C+1%5D%2C+padding%3D%27VALID%27%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%22layer5-conv3%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv3_weights+%3D+tf.get_variable%28%22weight%22%2C%5B3%2C3%2C64%2C128%5D%2Cinitializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv3_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B128%5D%2C+initializer%3Dtf.constant_initializer%280.0%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv3+%3D+tf.nn.conv2d%28pool2%2C+conv3_weights%2C+strides%3D%5B1%2C+1%2C+1%2C+1%5D%2C+padding%3D%27SAME%27%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+relu3+%3D+tf.nn.relu%28tf.nn.bias_add%28conv3%2C+conv3_biases%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.name_scope%28%22layer6-pool3%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+pool3+%3D+tf.nn.max_pool%28relu3%2C+ksize%3D%5B1%2C+2%2C+2%2C+1%5D%2C+strides%3D%5B1%2C+2%2C+2%2C+1%5D%2C+padding%3D%27VALID%27%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%22layer7-conv4%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv4_weights+%3D+tf.get_variable%28%22weight%22%2C%5B3%2C3%2C128%2C128%5D%2Cinitializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv4_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B128%5D%2C+initializer%3Dtf.constant_initializer%280.0%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+conv4+%3D+tf.nn.conv2d%28pool3%2C+conv4_weights%2C+strides%3D%5B1%2C+1%2C+1%2C+1%5D%2C+padding%3D%27SAME%27%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+relu4+%3D+tf.nn.relu%28tf.nn.bias_add%28conv4%2C+conv4_biases%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.name_scope%28%22layer8-pool4%22%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+pool4+%3D+tf.nn.max_pool%28relu4%2C+ksize%3D%5B1%2C+2%2C+2%2C+1%5D%2C+strides%3D%5B1%2C+2%2C+2%2C+1%5D%2C+padding%3D%27VALID%27%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+nodes+%3D+6*6*128%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+reshaped+%3D+tf.reshape%28pool4%2C%5B-1%2Cnodes%5D%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%27layer9-fc1%27%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc1_weights+%3D+tf.get_variable%28%22weight%22%2C+%5Bnodes%2C+1024%5D%2C%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+initializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+regularizer+%21%3D+None%3A+tf.add_to_collection%28%27losses%27%2C+regularizer%28fc1_weights%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc1_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B1024%5D%2C+initializer%3Dtf.constant_initializer%280.1%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc1+%3D+tf.nn.relu%28tf.matmul%28reshaped%2C+fc1_weights%29+%2B+fc1_biases%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+train%3A+fc1+%3D+tf.nn.dropout%28fc1%2C+0.5%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%27layer10-fc2%27%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc2_weights+%3D+tf.get_variable%28%22weight%22%2C+%5B1024%2C+512%5D%2C%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+initializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+regularizer+%21%3D+None%3A+tf.add_to_collection%28%27losses%27%2C+regularizer%28fc2_weights%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc2_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B512%5D%2C+initializer%3Dtf.constant_initializer%280.1%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc2+%3D+tf.nn.relu%28tf.matmul%28fc1%2C+fc2_weights%29+%2B+fc2_biases%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+train%3A+fc2+%3D+tf.nn.dropout%28fc2%2C+0.5%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+with+tf.variable_scope%28%27layer11-fc3%27%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc3_weights+%3D+tf.get_variable%28%22weight%22%2C+%5B512%2C+5%5D%2C%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+initializer%3Dtf.truncated_normal_initializer%28stddev%3D0.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+regularizer+%21%3D+None%3A+tf.add_to_collection%28%27losses%27%2C+regularizer%28fc3_weights%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+fc3_biases+%3D+tf.get_variable%28%22bias%22%2C+%5B5%5D%2C+initializer%3Dtf.constant_initializer%280.1%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+logit+%3D+tf.matmul%28fc2%2C+fc3_weights%29+%2B+fc3_biases%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+return+logit%3C%2Fp%3E+%0A++%3Cp%3E%23---------------------------%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9D%9F---------------------------%3Cbr%3E+regularizer+%3D+tf.contrib.layers.l2_regularizer%280.0001%29%3Cbr%3E+logits+%3D+inference%28x%2CFalse%2Cregularizer%29%3C%2Fp%3E+%0A++%3Cp%3E%23%28%E5%B0%8F%E5%A4%84%E7%90%86%29%E5%B0%86logits%E4%B9%98%E4%BB%A51%E8%B5%8B%E5%80%BC%E7%BB%99logits_eval%EF%BC%8C%E5%AE%9A%E4%B9%89name%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%9C%A8%E5%90%8E%E7%BB%AD%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B%E6%97%B6%E9%80%9A%E8%BF%87tensor%E5%90%8D%E5%AD%97%E8%B0%83%E7%94%A8%E8%BE%93%E5%87%BAtensor%3Cbr%3E+b+%3D+tf.constant%28value%3D1%2Cdtype%3Dtf.float32%29%3Cbr%3E+logits_eval+%3D+tf.multiply%28logits%2Cb%2Cname%3D%27logits_eval%27%29%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3Eloss%3Dtf.nn.sparse_softmax_cross_entropy_with_logits%28logits%3Dlogits%2C+labels%3Dy_%29%3Cbr%3E+train_op%3Dtf.train.AdamOptimizer%28learning_rate%3D0.001%29.minimize%28loss%29%3Cbr%3E+correct_prediction+%3D+tf.equal%28tf.cast%28tf.argmax%28logits%2C1%29%2Ctf.int32%29%2C+y_%29+%26nbsp%3B+%26nbsp%3B%3Cbr%3E+acc%3D+tf.reduce_mean%28tf.cast%28correct_prediction%2C+tf.float32%29%29%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+%23%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%8C%E6%8C%89%E6%89%B9%E6%AC%A1%E5%8F%96%E6%95%B0%E6%8D%AE%3Cbr%3E+def+minibatches%28inputs%3DNone%2C+targets%3DNone%2C+batch_size%3DNone%2C+shuffle%3DFalse%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+assert+len%28inputs%29+%3D%3D+len%28targets%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+if+shuffle%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+indices+%3D+np.arange%28len%28inputs%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+np.random.shuffle%28indices%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+for+start_idx+in+range%280%2C+len%28inputs%29+-+batch_size+%2B+1%2C+batch_size%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+if+shuffle%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+excerpt+%3D+indices%5Bstart_idx%3Astart_idx+%2B+batch_size%5D%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+else%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+excerpt+%3D+slice%28start_idx%2C+start_idx+%2B+batch_size%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+yield+inputs%5Bexcerpt%5D%2C+targets%5Bexcerpt%5D%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+%23%E8%AE%AD%E7%BB%83%E5%92%8C%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%8F%AF%E5%B0%86n_epoch%E8%AE%BE%E7%BD%AE%E6%9B%B4%E5%A4%A7%E4%B8%80%E4%BA%9B%3C%2Fp%3E+%0A++%3Cp%3En_epoch%3D10+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%26nbsp%3B%3Cbr%3E+batch_size%3D64%3Cbr%3E+saver%3Dtf.train.Saver%28%29%3Cbr%3E+sess%3Dtf.Session%28%29+%26nbsp%3B%3Cbr%3E+sess.run%28tf.global_variables_initializer%28%29%29%3Cbr%3E+for+epoch+in+range%28n_epoch%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+start_time+%3D+time.time%28%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%23training%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+train_loss%2C+train_acc%2C+n_batch+%3D+0%2C+0%2C+0%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+for+x_train_a%2C+y_train_a+in+minibatches%28x_train%2C+y_train%2C+batch_size%2C+shuffle%3DTrue%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+_%2Cerr%2Cac%3Dsess.run%28%5Btrain_op%2Closs%2Cacc%5D%2C+feed_dict%3D%7Bx%3A+x_train_a%2C+y_%3A+y_train_a%7D%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+train_loss+%2B%3D+err%3B+train_acc+%2B%3D+ac%3B+n_batch+%2B%3D+1%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+print%28%22+%26nbsp%3B+train+loss%3A+%25f%22+%25+%28np.sum%28train_loss%29%2F+n_batch%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+print%28%22+%26nbsp%3B+train+acc%3A+%25f%22+%25+%28np.sum%28train_acc%29%2F+n_batch%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%23validation%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+val_loss%2C+val_acc%2C+n_batch+%3D+0%2C+0%2C+0%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+for+x_val_a%2C+y_val_a+in+minibatches%28x_val%2C+y_val%2C+batch_size%2C+shuffle%3DFalse%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+err%2C+ac+%3D+sess.run%28%5Bloss%2Cacc%5D%2C+feed_dict%3D%7Bx%3A+x_val_a%2C+y_%3A+y_val_a%7D%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+val_loss+%2B%3D+err%3B+val_acc+%2B%3D+ac%3B+n_batch+%2B%3D+1%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+print%28%22+%26nbsp%3B+validation+loss%3A+%25f%22+%25+%28np.sum%28val_loss%29%2F+n_batch%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+print%28%22+%26nbsp%3B+validation+acc%3A+%25f%22+%25+%28np.sum%28val_acc%29%2F+n_batch%29%29%3Cbr%3E+saver.save%28sess%2Cmodel_path%29%3Cbr%3E+sess.close%28%29123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E4%BA%8C%E3%80%81%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E8%8A%B1%E5%8D%89%E7%9A%84%E9%A2%84%E6%B5%8B%EF%BC%8C%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3Efrom+skimage+import+io%2Ctransform%3Cbr%3E+import+tensorflow+as+tf%3Cbr%3E+import+numpy+as+np%3C%2Fp%3E+%0A++%3Cp%3E%3Cbr%3E+path1+%3D+%22E%3A%2Fdata%2Fdatasets%2Fflower_photos%2Fdaisy%2F5547758_eea9edfd54_n.jpg%22%3Cbr%3E+path2+%3D+%22E%3A%2Fdata%2Fdatasets%2Fflower_photos%2Fdandelion%2F7355522_b66e5d3078_m.jpg%22%3Cbr%3E+path3+%3D+%22E%3A%2Fdata%2Fdatasets%2Fflower_photos%2Froses%2F394990940_7af082cf8d_n.jpg%22%3Cbr%3E+path4+%3D+%22E%3A%2Fdata%2Fdatasets%2Fflower_photos%2Fsunflowers%2F6953297_8576bf4ea3.jpg%22%3Cbr%3E+path5+%3D+%22E%3A%2Fdata%2Fdatasets%2Fflower_photos%2Ftulips%2F10791227_7168491604.jpg%22%3C%2Fp%3E+%0A++%3Cp%3Eflower_dict+%3D+%7B0%3A%27dasiy%27%2C1%3A%27dandelion%27%2C2%3A%27roses%27%2C3%3A%27sunflowers%27%2C4%3A%27tulips%27%7D%3C%2Fp%3E+%0A++%3Cp%3Ew%3D100%3Cbr%3E+h%3D100%3Cbr%3E+c%3D3%3C%2Fp%3E+%0A++%3Cp%3Edef+read_one_image%28path%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+img+%3D+io.imread%28path%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+img+%3D+transform.resize%28img%2C%28w%2Ch%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+return+np.asarray%28img%29%3C%2Fp%3E+%0A++%3Cp%3Ewith+tf.Session%28%29+as+sess%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data+%3D+%5B%5D%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data1+%3D+read_one_image%28path1%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data2+%3D+read_one_image%28path2%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data3+%3D+read_one_image%28path3%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data4+%3D+read_one_image%28path4%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data5+%3D+read_one_image%28path5%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data.append%28data1%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data.append%28data2%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data.append%28data3%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data.append%28data4%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+data.append%28data5%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+saver+%3D+tf.train.import_meta_graph%28%27E%3A%2Fdata%2Fmodel%2Fflower%2Fmodel.ckpt.meta%27%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+saver.restore%28sess%2Ctf.train.latest_checkpoint%28%27E%3A%2Fdata%2Fmodel%2Fflower%2F%27%29%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+graph+%3D+tf.get_default_graph%28%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+x+%3D+graph.get_tensor_by_name%28%22x%3A0%22%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+feed_dict+%3D+%7Bx%3Adata%7D%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+logits+%3D+graph.get_tensor_by_name%28%22logits_eval%3A0%22%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+classification_result+%3D+sess.run%28logits%2Cfeed_dict%29%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%23%E6%89%93%E5%8D%B0%E5%87%BA%E9%A2%84%E6%B5%8B%E7%9F%A9%E9%98%B5%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+print%28classification_result%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%23%E6%89%93%E5%8D%B0%E5%87%BA%E9%A2%84%E6%B5%8B%E7%9F%A9%E9%98%B5%E6%AF%8F%E4%B8%80%E8%A1%8C%E6%9C%80%E5%A4%A7%E5%80%BC%E7%9A%84%E7%B4%A2%E5%BC%95%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+print%28tf.argmax%28classification_result%2C1%29.eval%28%29%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%23%E6%A0%B9%E6%8D%AE%E7%B4%A2%E5%BC%95%E9%80%9A%E8%BF%87%E5%AD%97%E5%85%B8%E5%AF%B9%E5%BA%94%E8%8A%B1%E7%9A%84%E5%88%86%E7%B1%BB%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+output+%3D+%5B%5D%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+output+%3D+tf.argmax%28classification_result%2C1%29.eval%28%29%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+for+i+in+range%28len%28output%29%29%3A%3Cbr%3E+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+print%28%22%E7%AC%AC%22%2Ci%2B1%2C%22%E6%9C%B5%E8%8A%B1%E9%A2%84%E6%B5%8B%3A%22%2Bflower_dict%5Boutput%5Bi%5D%5D%29%3C%2Fp%3E+%0A++%3Cp%3E123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B%3C%2Fp%3E+%0A++%3Cp%3E%5B%5B+%26nbsp%3B5.76620245+%26nbsp%3B+3.18228579+%26nbsp%3B-3.89464641+%26nbsp%3B-2.81310582+%26nbsp%3B+1.40294015%5D%3Cbr%3E+%26nbsp%3B%5B+-1.01490593+%26nbsp%3B+3.55570269+%26nbsp%3B-2.76053429+%26nbsp%3B+2.93104005+%26nbsp%3B-3.47138596%5D%3Cbr%3E+%26nbsp%3B%5B+-8.05292606+%26nbsp%3B-7.26499033+%26nbsp%3B11.70479774+%26nbsp%3B+0.59627819+%26nbsp%3B+2.15948296%5D%3Cbr%3E+%26nbsp%3B%5B+-5.12940931+%26nbsp%3B+2.18423128+%26nbsp%3B-3.33257103+%26nbsp%3B+9.0591135+%26nbsp%3B+%26nbsp%3B5.03963232%5D%3Cbr%3E+%26nbsp%3B%5B+-4.25288343+%26nbsp%3B-0.95963973+%26nbsp%3B-2.33347392+%26nbsp%3B+1.54485476+%26nbsp%3B+5.76069307%5D%5D%3Cbr%3E+%5B0+1+2+3+4%5D%3Cbr%3E+%E7%AC%AC+1+%E6%9C%B5%E8%8A%B1%E9%A2%84%E6%B5%8B%3Adasiy%3Cbr%3E+%E7%AC%AC+2+%E6%9C%B5%E8%8A%B1%E9%A2%84%E6%B5%8B%3Adandelion%3Cbr%3E+%E7%AC%AC+3+%E6%9C%B5%E8%8A%B1%E9%A2%84%E6%B5%8B%3Aroses%3Cbr%3E+%E7%AC%AC+4+%E6%9C%B5%E8%8A%B1%E9%A2%84%E6%B5%8B%3Asunflowers%3Cbr%3E+%E7%AC%AC+5+%E6%9C%B5%E8%8A%B1%E9%A2%84%E6%B5%8B%3Atulips1234567891011%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E9%A2%84%E6%B5%8B%E7%BB%93%E6%9E%9C%E5%92%8C%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B%E4%BB%A3%E7%A0%81%E4%B8%AD%E7%9A%84%E4%BA%94%E4%B8%AA%E8%B7%AF%E5%BE%84%E7%9B%B8%E6%AF%94%E8%BE%83%E6%98%AF%E5%AE%8C%E5%85%A8%E5%87%86%E7%A1%AE%E7%9A%84%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%9C%AC%E6%96%87%E7%9A%84%E6%A8%A1%E5%9E%8B%E5%AF%B9%E4%BA%8E%E8%8A%B1%E5%8D%89%E7%9A%84%E5%88%86%E7%B1%BB%E5%87%86%E7%A1%AE%E7%8E%87%E5%A4%A7%E6%A6%82%E5%9C%A870%25%E5%B7%A6%E5%8F%B3%EF%BC%8C%E9%87%87%E7%94%A8%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0%E8%B0%83%E7%94%A8Inception-v3%E6%A8%A1%E5%9E%8B%E5%AF%B9%E6%9C%AC%E6%96%87%E4%B8%AD%E7%9A%84%E8%8A%B1%E5%8D%89%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%86%E7%B1%BB%E5%87%86%E7%A1%AE%E7%8E%87%E5%9C%A895%25%E5%B7%A6%E5%8F%B3%E3%80%82%E4%B8%BB%E8%A6%81%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%9C%A8%E4%BA%8E%E6%9C%AC%E6%96%87%E7%9A%84CNN%E6%A8%A1%E5%9E%8B%E8%BE%83%E4%BA%8E%E7%AE%80%E5%8D%95%EF%BC%8C%E8%80%8C%E4%B8%94%E8%8A%B1%E5%8D%89%E6%95%B0%E6%8D%AE%E9%9B%86%E6%9C%AC%E8%BA%AB%E5%B0%B1%E6%AF%94mnist%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%86%E7%B1%BB%E9%9A%BE%E5%BA%A6%E5%B0%B1%E8%A6%81%E5%A4%A7%E4%B8%80%E7%82%B9%EF%BC%8C%E5%90%8C%E6%A0%B7%E7%9A%84%E6%A8%A1%E5%9E%8B%E5%9C%A8mnist%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8A%E5%87%86%E7%A1%AE%E7%8E%87%E8%A6%81%E6%AF%94%E8%8A%B1%E5%8D%89%E6%95%B0%E6%8D%AE%E9%9B%86%E5%87%86%E7%A1%AE%E7%8E%87%E9%AB%98%E4%B8%8D%E5%B0%91%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E6%9C%AC%E6%96%87%E7%9A%84CNN%E6%A8%A1%E5%9E%8B%E5%AE%8C%E5%85%A8%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E5%A2%9E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%88%96%E8%80%85%E6%94%B9%E5%8F%82%E6%95%B0%E8%B0%83%E8%AF%95%E4%BB%A5%E5%8F%8A%E5%AF%B9%E5%9B%BE%E5%83%8F%E8%BF%9B%E8%A1%8C%E9%A2%84%E5%A4%84%E7%90%86%E6%9D%A5%E6%8F%90%E9%AB%98%E5%87%86%E7%A1%AE%E7%8E%87%EF%BC%8C%E4%BD%86%E6%9C%AC%E6%96%87%E5%8F%AA%E6%98%AF%E6%83%B3%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8B%E6%9C%80%E8%BF%91%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%8C%E8%BF%99%E5%B7%B2%E7%BB%8F%E8%B6%B3%E5%A4%9F%E4%BA%86%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%26nbsp%3B+%26nbsp%3B+%26nbsp%3B+%26nbsp%3B%E5%8F%82%E8%80%83%E5%8D%9A%E5%AE%A2%EF%BC%9Ahttp%3A%2F%2Fwww.cnblogs.com%2Fdenny402%2Fp%2F6931338.html%3Cbr%3E+---------------------%26nbsp%3B%3Cbr%3E+%E4%BD%9C%E8%80%85%EF%BC%9AEnchanted_ZhouH%26nbsp%3B%3Cbr%3E+%E6%9D%A5%E6%BA%90%EF%BC%9ACSDN%26nbsp%3B%3Cbr%3E+%E5%8E%9F%E6%96%87%EF%BC%9Ahttps%3A%2F%2Fblog.csdn.net%2FEnchanted_ZhouH%2Farticle%2Fdetails%2F74116823%26nbsp%3B%3Cbr%3E+%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%EF%BC%9A%E6%9C%AC%E6%96%87%E4%B8%BA%E5%8D%9A%E4%B8%BB%E5%8E%9F%E5%88%9B%E6%96%87%E7%AB%A0%EF%BC%8C%E8%BD%AC%E8%BD%BD%E8%AF%B7%E9%99%84%E4%B8%8A%E5%8D%9A%E6%96%87%E9%93%BE%E6%8E%A5%EF%BC%81%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E" | url_decode}}