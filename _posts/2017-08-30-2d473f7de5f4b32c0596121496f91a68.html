---
layout: default
title: pybitcointools源码分析之BIP32实现
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22markdown_views%22%3E+%0A++%3Cp%3E%E5%9C%A8%E7%9C%8B%E6%9C%AC%E7%AF%87%E4%B9%8B%E5%89%8D%EF%BC%8C%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E4%B8%80%E4%B8%AA%E5%BE%88%E9%87%8D%E8%A6%81%E7%9A%84%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86%E3%80%82%E9%82%A3%E5%B0%B1%E6%98%AF+%3Cstrong%3EHD%E9%92%B1%E5%8C%85%3C%2Fstrong%3E%E5%92%8C+%E6%AF%94%E7%89%B9%E5%B8%81%E5%8D%8F%E8%AE%AE+%3Cstrong%3EBIP32%3C%2Fstrong%3E%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E5%85%B3%E4%BA%8EHD%E9%92%B1%E5%8C%85%E7%9A%84%E6%A6%82%E5%BF%B5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E5%A4%A7%E5%AE%B6%E5%8E%BB%E7%9C%8B%E7%9C%8B%26lt%3B%26lt%3B%E7%B2%BE%E9%80%9A%E6%AF%94%E7%89%B9%E5%B8%81%26gt%3B%26gt%3B%E3%80%82BIP32%E5%8F%AF%E4%BB%A5%E7%9C%8B%E4%B8%8B%E4%B8%8B%E9%9D%A2%E8%BF%99%E7%AF%87%E7%BF%BB%E8%AF%91%3A%3C%2Fp%3E+%0A++%3Cp%3E%3Ca+href%3D%22http%3A%2F%2Fblog.csdn.net%2Fpony_maggie%2Farticle%2Fdetails%2F76178228%22+rel%3D%22nofollow%22%3Ehttp%3A%2F%2Fblog.csdn.net%2Fpony_maggie%2Farticle%2Fdetails%2F76178228%3C%2Fa%3E%3C%2Fp%3E+%0A++%3Chr%3E+%0A++%3Cp%3E%E5%BC%80%E5%A7%8B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%82%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+ini%22%3E%3Cspan+class%3D%22hljs-setting%22%3Emaster+%3D+%3Cspan+class%3D%22hljs-value%22%3Ebip32_master_key%28safe_from_hex%28%3Cspan+class%3D%22hljs-string%22%3E%22000102030405060708090a0b0c0d0e0f%22%3C%2Fspan%3E%29%29%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3Esafe_from_hex%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%BD%A2%E5%BC%8F%E7%9A%8416%E8%BF%9B%E5%88%B6%E6%95%B0%E5%AD%97%E8%BD%AC%E6%8D%A2%E6%88%90byte%E5%BD%A2%E5%BC%8F%EF%BC%8C+%E4%BE%8B%E5%A6%82%E2%80%9D1234%E2%80%9D-%26gt%3Bb%E2%80%9D%5Cx12%5Cx34%E2%80%9D%E3%80%82+%3Cbr%3E+%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%E4%B8%8D%E8%AF%A6%E8%BF%B0%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3Ebip32_master_key%E5%87%BD%E6%95%B0%E6%98%AF%E7%94%A8%E4%BA%8E%E4%BA%A7%E7%94%9F%E7%AC%A6%E5%90%88bip32%E7%9A%84%E4%B8%BB%E5%AF%86%E9%92%A5%E3%80%82%E9%82%A3%E8%BE%B9%E9%97%AE%E9%A2%98%E6%9D%A5%E4%BA%86%EF%BC%8C%E4%BB%80%E4%B9%88%E6%98%AF+bip32%E7%9A%84%E4%B8%BB%E5%AF%86%E9%92%A5%E5%91%A2%EF%BC%9F%3C%2Fp%3E+%0A++%3Cp%3E%E6%A0%B9%E6%8D%AEbip32%E7%BA%A6%E5%AE%9A%EF%BC%8C%E4%B8%BB%E5%AF%86%E9%92%A5%E6%98%AF%E4%BB%8E%E4%B8%80%E4%B8%AA%E7%9F%AD%E7%A7%8D%E5%AD%90%E5%80%BC%E7%94%9F%E6%88%90%E7%9A%84%EF%BC%8C%E6%AD%A5%E9%AA%A4%E5%A6%82%E4%B8%8B%3A%3C%2Fp%3E+%0A++%3Cul%3E+%0A+++%3Cli%3E%3Cp%3E%E4%BB%8E%EF%BC%88P%EF%BC%89RNG%E7%94%9F%E6%88%90%E6%89%80%E9%80%89%E9%95%BF%E5%BA%A6%EF%BC%88128%E5%88%B0512%E4%BD%8D%3B%E5%BB%BA%E8%AE%AE256%E4%BD%8D%EF%BC%89%E7%9A%84%E7%A7%8D%E5%AD%90%E5%AD%97%E8%8A%82%E5%BA%8F%E5%88%97S%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E%E8%AE%A1%E7%AE%97I+%3D+HMAC-SHA512%EF%BC%88Key+%3D%E2%80%9CBitcoin+seed%E2%80%9D%EF%BC%8CData+%3D+S%EF%BC%89%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E%E5%B0%86I%E5%88%86%E4%B8%BA%E4%B8%A4%E4%B8%AA32%E5%AD%97%E8%8A%82%E5%BA%8F%E5%88%97%EF%BC%8CIL%E5%92%8CIR%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E%E4%BD%BF%E7%94%A8parse256%EF%BC%88IL%EF%BC%89%E4%BD%9C%E4%B8%BA%E4%B8%BB%E5%AF%86%E9%92%A5%EF%BC%8CIR%E4%BD%9C%E4%B8%BA%E4%B8%BB%E9%93%BE%E7%A0%81%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A++%3C%2Ful%3E+%0A++%3Chr%3E+%0A++%3Cp%3E%E6%9C%89%E4%BA%86%E4%B8%8A%E9%9D%A2%E7%9A%84%E7%90%86%E8%AE%BA%E6%94%AF%E6%92%91%EF%BC%8C%E5%86%8D%E6%9D%A5%E7%9C%8B%E4%BB%A3%E7%A0%81%E5%B0%B1%E6%AF%94%E8%BE%83%E5%AE%B9%E6%98%93%E7%90%86%E8%A7%A3%E4%BA%86%E3%80%82%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+python%22%3E%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Edef%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ebip32_master_key%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28seed%2C+vbytes%3DMAINNET_PRIVATE%29%3C%2Fspan%3E%3A%3C%2Fspan%3E%0A++++I+%3D+hmac.new%28from_string_to_bytes%28%3Cspan+class%3D%22hljs-string%22%3E%22Bitcoin+seed%22%3C%2Fspan%3E%29%2C+seed%2C+hashlib.sha512%29.digest%28%29%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+bip32_serialize%28%28vbytes%2C+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-string%22%3Eb%27%5Cx00%27%3C%2Fspan%3E*%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E0%3C%2Fspan%3E%2C+I%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%3A%5D%2C+I%5B%3A%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%2B%3Cspan+class%3D%22hljs-string%22%3Eb%27%5Cx01%27%3C%2Fspan%3E%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EI%E6%98%AFhmac-sha512%E7%AE%97%E6%B3%95%E8%AE%A1%E7%AE%97%E5%BE%97%E5%88%B0%E7%9A%84%EF%BC%8C%E7%94%A8%E7%9A%84key%E6%98%AF%E2%80%9DBitcoin+seed%E2%80%9D%EF%BC%8Cdata%E6%98%AF%E5%89%8D%E9%9D%A2%E4%BC%A0%E8%BF%87%E6%9D%A5%E7%9A%84%E7%9F%AD%E7%A7%8D%E5%AD%90%E5%80%BC%3A+%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+tex%22%3Eb%22%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E00%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E01%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E02%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E03%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E04%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E05%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E06%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E07%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E08%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E09%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E0a%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E0b%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E0c%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E0d%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E0e%3Cspan+class%3D%22hljs-command%22%3E%5Cx%3C%2Fspan%3E0f%22%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3EI%5B32%3A%5D%E5%B0%B1%E6%98%AFIR%EF%BC%8C+I%5B%3A32%5D%E6%98%AFIL%E3%80%82%E6%A0%B9%E6%8D%AE%E8%A7%84%E8%8C%83IL%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BD%9C%E4%B8%BA%E4%B8%BB%E5%AF%86%E9%92%A5%E4%BA%86%EF%BC%8C%E9%82%A3bip32_serialize%E6%98%AF%E5%B9%B2%E5%95%A5%E7%9A%84%E5%91%A2%EF%BC%9F%3C%2Fp%3E+%0A++%3Cp%3E%E5%8E%9F%E6%9D%A5%E6%98%AF%E4%B8%BA%E4%BA%86%E6%96%B9%E4%BE%BF%E8%A1%A8%E7%A4%BA%EF%BC%8Cbip32%E5%BC%95%E5%85%A5%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E6%A6%82%E5%BF%B5%EF%BC%8C%E8%BF%87%E7%A8%8B%E5%A6%82%E4%B8%8B%3A%3C%2Fp%3E+%0A++%3Cul%3E+%0A+++%3Cli%3E%3Cp%3E4%E5%AD%97%E8%8A%82%EF%BC%9A%E7%89%88%E6%9C%AC%E5%AD%97%E8%8A%82%EF%BC%88mainnet%EF%BC%9A0x0488B21E+public%EF%BC%8C0x0488ADE4+private%3B+testnet%EF%BC%9A0x043587CF+public%EF%BC%8C0x04358394+private%EF%BC%89%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E1%E5%AD%97%E8%8A%82%EF%BC%9A%E6%B7%B1%E5%BA%A6%EF%BC%9A%E4%B8%BB%E8%8A%82%E7%82%B9%E4%B8%BA0x00%EF%BC%8C%E7%BA%A7%E5%88%AB1%E6%B4%BE%E7%94%9F%E5%AF%86%E9%92%A5%E4%B8%BA0x01%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E4%E5%AD%97%E8%8A%82%EF%BC%9A%E7%88%B6%E5%AF%86%E9%92%A5%E7%9A%84%E6%8C%87%E7%BA%B9%EF%BC%88%E5%A6%82%E6%9E%9C%E4%B8%BB%E5%AF%86%E9%92%A5%E4%B8%BA0x00000000%EF%BC%89%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E4%E5%AD%97%E8%8A%82%EF%BC%9A%E5%AD%90%E6%95%B0%E5%AD%97%E3%80%82%E8%BF%99%E6%98%AF%E5%AF%B9%E4%BA%8Ei%E5%9C%A8xi+%3D+xpar+%2F+i%E4%B8%AD%E7%9A%84ser32%EF%BC%88i%EF%BC%89%EF%BC%8C%E5%85%B6%E4%B8%ADxi%E6%98%AF%E9%94%AE%E5%BA%8F%E5%88%97%E5%8C%96%E3%80%82+%EF%BC%88%E5%A6%82%E6%9E%9C%E4%B8%BB%E5%AF%86%E9%92%A5%E4%B8%BA0x00000000%EF%BC%89%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E32%E5%AD%97%E8%8A%82%EF%BC%9A%E9%93%BE%E7%A0%81%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E33%E5%AD%97%E8%8A%82%EF%BC%9A%E5%85%AC%E9%92%A5%E6%88%96%E7%A7%81%E9%92%A5%E6%95%B0%E6%8D%AE%EF%BC%88%E5%85%AC%E9%92%A5%E7%9A%84serP%EF%BC%88K%EF%BC%89%EF%BC%8C%E7%A7%81%E9%92%A5%E7%9A%840x00+%7C%7C+ser256%EF%BC%88k%EF%BC%89%EF%BC%89%3C%2Fp%3E%3C%2Fli%3E+%0A++%3C%2Ful%3E+%0A++%3Cp%3E%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E9%A6%96%E5%85%88%E6%B7%BB%E5%8A%A032%E4%B8%AA%E6%A0%A1%E9%AA%8C%E5%92%8C%E4%BD%8D%EF%BC%88%E4%BB%8E%E5%8F%8CSHA-256%E6%A0%A1%E9%AA%8C%E5%92%8C%E6%B4%BE%E7%94%9F%EF%BC%89%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BD%AC%E6%8D%A2%E4%B8%BABase58%E8%A1%A8%E7%A4%BA%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3Ebip32_serialize%E5%85%A5%E5%8F%82%E6%9C%89%E5%85%AD%E4%B8%AA%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%92%8C%E4%B8%8A%E9%9D%A2%E4%B8%80%E4%B8%80%E5%AF%B9%E5%BA%94%E4%B8%8B%EF%BC%8C%3C%2Fp%3E+%0A++%3Cp%3Evbytes%E6%98%AF%E7%89%88%E6%9C%AC%E5%AD%97%E8%8A%82%EF%BC%8C0x0488ADE4%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E0%E8%A1%A8%E7%A4%BA%E6%B7%B1%E5%BA%A6%EF%BC%8C%E8%BF%99%E9%87%8C%E6%98%AF%E4%B8%BB%E5%AF%86%E9%92%A5%EF%BC%8C%E6%B7%B1%E5%BA%A6%E8%A1%A8%E7%A4%BA%E4%B8%BA0%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3Eb%E2%80%99%5Cx00%E2%80%99*4%E5%9C%A8python%E4%B8%AD%E5%B0%B1%E6%98%AFb%E2%80%99%5Cx00%5Cx00%5Cx00%5Cx00%E2%80%99%EF%BC%8C%E5%AF%B9%E5%BA%94%E7%88%B6%E5%AF%86%E9%92%A5%E7%9A%84%E6%8C%87%E7%BA%B9%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%9A%840%E5%AF%B9%E5%BA%94%E5%AD%90%E6%95%B0%E5%AD%97%EF%BC%8C%E5%9C%A8bip32_serialize%E5%87%BD%E6%95%B0%E9%87%8C%E4%BC%9A%E8%BD%AC%E4%B8%BA4%E5%AD%97%E8%8A%82%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3EI%5B32%3A%5D%E4%B9%9F%E5%8F%ABIR%EF%BC%8C%E5%AF%B9%E5%BA%94%E9%93%BE%E7%A0%81%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3EI%5B%3A32%5D%2Bb%E2%80%99%5Cx01%E2%80%99%EF%BC%8C33%E5%AD%97%E8%8A%82%E5%AF%B9%E5%BA%94%E7%A7%81%E9%92%A5%E6%95%B0%E6%8D%AE%28%E8%BF%99%E9%87%8C%E6%98%AF%E7%A7%81%E9%92%A5%29%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E8%BF%9B%E5%85%A5bip32_serialize%E9%87%8C%E9%9D%A2%EF%BC%8C%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+python%22%3E%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Edef%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ebip32_serialize%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28rawtuple%29%3C%2Fspan%3E%3A%3C%2Fspan%3E%0A++++vbytes%2C+depth%2C+fingerprint%2C+i%2C+chaincode%2C+key+%3D+rawtuple%0A++++i+%3D+encode%28i%2C+%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%0A%0A++++keydata+%3D+%3Cspan+class%3D%22hljs-string%22%3Eb%27%5Cx00%27%3C%2Fspan%3E%2Bkey%5B%3A-%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%5D+%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+vbytes+%3Cspan+class%3D%22hljs-keyword%22%3Ein%3C%2Fspan%3E+PRIVATE+%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E+key%0A++++bindata+%3D+vbytes+%2B+from_int_to_byte%28depth+%25+%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%29+%2B+fingerprint+%2B+i+%2B+chaincode+%2B+keydata%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+changebase%28bindata%2Bbin_dbl_sha256%28bindata%29%5B%3A%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%5D%2C+%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E58%3C%2Fspan%3E%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3Ei%E7%9A%84%E5%80%BC%E6%98%AF0%EF%BC%8C+i+%3D+encode%28i%2C+256%2C+4%29%E6%8A%8A0%E8%BD%AC%E6%8D%A2%E4%B8%BAb%E2%80%99%5Cx00%5Cx00%5Cx00%5Cx00%E2%80%99%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3Ekeydata%E6%98%AF%E5%B0%B1%E6%98%AF%E5%85%AC%E9%92%A5%E6%88%96%E8%80%85%E7%A7%81%E9%92%A5%E6%95%B0%E6%8D%AE%28%E8%BF%99%E9%87%8C%E6%98%AF%E7%A7%81%E9%92%A5%29%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E6%9C%80%E5%90%8E%E6%8B%BC%E6%8E%A5%E7%84%B6%E5%90%8E%E8%BD%AC%E6%8D%A2%E4%B8%BAbase58%E8%A1%A8%E7%A4%BA%E3%80%82%3C%2Fp%3E+%0A++%3Chr%3E+%0A++%3Cp%3E%E4%B8%8B%E9%9D%A2%E7%9C%8B%E7%9C%8B%E5%A6%82%E4%BD%95%E7%94%A8%E4%B8%BB%E5%AF%86%E9%92%A5%E8%A1%8D%E7%94%9F%E5%87%BA%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AD%90%E5%AF%86%E9%92%A5%E3%80%82%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+erlang%22%3E%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-title%22%3Ebip32_ckd%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28master%2C+%3Cspan+class%3D%22hljs-string%22%3E%220%22%3C%2Fspan%3E%29%3C%2Fspan%3E%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E5%8F%82%E6%95%B00%E6%98%AF%E4%B8%80%E4%B8%AA%E7%B4%A2%E5%BC%95%E5%80%BC%EF%BC%8C%E8%A1%A8%E7%A4%BA%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AD%90%E5%AF%86%E9%92%A5%E3%80%82%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+python%22%3E%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Edef%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Ebip32_ckd%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28data%2C+i%29%3C%2Fspan%3E%3A%3C%2Fspan%3E%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+bip32_serialize%28raw_bip32_ckd%28bip32_deserialize%28data%29%2C+i%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3Ebip32_serialize%E8%BF%99%E4%B8%AA%E4%B9%8B%E5%89%8D%E8%AF%B4%E8%BF%87%E4%BA%86%EF%BC%8Cbip32_deserialize%E5%BE%88%E6%98%8E%E6%98%BE%E6%98%AF%E7%9B%B8%E5%AF%B9%E7%9A%84%EF%BC%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E3%80%82%E5%B0%B1%E6%98%AF%E6%8A%8A%E4%B8%BB%E5%AF%86%E9%92%A5%E5%86%8D%E5%8F%98%E5%9B%9E%E5%85%83%E7%BB%84%E7%9A%84%E8%A1%A8%E7%A4%BA%E3%80%82%3C%2Fp%3E+%0A++%3Cp%3E%E6%89%80%E4%BB%A5%E6%A0%B8%E5%BF%83%E7%9A%84%E5%87%BD%E6%95%B0%E6%98%AFraw_bip32_ckd%E3%80%82%E5%9C%A8%E5%88%86%E6%9E%90%E8%BF%99%E4%B8%AA%E5%87%BD%E6%95%B0%E4%B9%8B%E5%89%8D%E8%BF%98%E6%98%AF%E8%A6%81%E5%85%88%E6%9D%A5%E7%82%B9%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86%EF%BC%8C%E7%9C%8B%E7%9C%8BBIP32%E9%87%8C%E5%AF%B9%E4%BA%8E%E4%B8%BB%E5%AF%86%E9%92%A5%28%E7%A7%81%E9%92%A5%29%E8%A1%8D%E7%94%9F%E5%AD%90%E5%AF%86%E9%92%A5%E6%98%AF%E6%80%8E%E4%B9%88%E8%AF%B4%E7%9A%84%EF%BC%8C%3C%2Fp%3E+%0A++%3Cp%3E%E5%87%BD%E6%95%B0CKDpriv%EF%BC%88%EF%BC%88kpar%EF%BC%8Ccpar%EF%BC%89%EF%BC%8Ci%EF%BC%89%E2%86%92%EF%BC%88ki%EF%BC%8Cci%EF%BC%89%E4%BB%8E%E7%88%B6%E6%89%A9%E5%B1%95%E7%A7%81%E9%92%A5%E8%AE%A1%E7%AE%97%E5%AD%90%E6%89%A9%E5%B1%95%E7%A7%81%E9%92%A5%EF%BC%9A%3C%2Fp%3E+%0A++%3Col%3E+%0A+++%3Cli%3E%3Cp%3E%E6%A3%80%E6%9F%A5+%E6%98%AF%E5%90%A6+i+%E2%89%A5+2%5E31%28%E5%AD%90%E7%A7%81%E9%92%A5%29%E3%80%82%3C%2Fp%3E+%3Cp%3E%E5%A6%82%E6%9E%9C%E6%98%AF%EF%BC%88%E7%A1%AC%E5%8C%96%E7%9A%84%E5%AD%90%E5%AF%86%E9%92%A5%EF%BC%89%EF%BC%9A%E8%AE%A9I%3D+HMAC-SHA512%EF%BC%88Key+%3D+cpar%EF%BC%8CData+%3D+0x00+%7C%7C+ser256%EF%BC%88kpar%EF%BC%89%7C%7C+ser32%EF%BC%88i%EF%BC%89%EF%BC%89%E3%80%82+%EF%BC%88%E6%B3%A8%E6%84%8F%EF%BC%9A0x00%E5%B0%86%E7%A7%81%E9%92%A5%E8%A1%A5%E9%BD%90%E5%88%B033%E5%AD%97%E8%8A%82%E9%95%BF%E3%80%82%EF%BC%89%3C%2Fp%3E+%3Cp%3E%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%98%AF%EF%BC%88%E6%99%AE%E9%80%9A%E7%9A%84%E5%AD%90%E5%AF%86%E9%92%A5%EF%BC%89%EF%BC%9A%E8%AE%A9I%3D+HMAC-SHA512%EF%BC%88Key+%3D+cpar%EF%BC%8CData+%3D+serP%EF%BC%88point%EF%BC%88kpar%EF%BC%89%EF%BC%89%7C%7C+ser32%EF%BC%88i%EF%BC%89%EF%BC%89%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E%E5%B0%86I%E5%88%86%E4%B8%BA%E4%B8%A4%E4%B8%AA32%E5%AD%97%E8%8A%82%E5%BA%8F%E5%88%97%EF%BC%8CIL%E5%92%8CIR%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AD%90%E5%AF%86%E9%92%A5ki%E6%98%AFparse256%EF%BC%88IL%EF%BC%89%2B+kpar%EF%BC%88mod+n%EF%BC%89%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A+++%3Cli%3E%3Cp%3E%E8%BF%94%E5%9B%9E%E7%9A%84%E9%93%BE%E7%A0%81ci%E6%98%AFIR%E3%80%82%3C%2Fp%3E%3C%2Fli%3E+%0A++%3C%2Fol%3E+%0A++%3Cp%3E%3Cstrong%3E%E5%A6%82%E6%9E%9Cparse256%EF%BC%88IL%EF%BC%89%E2%89%A5n%E6%88%96ki+%3D+0%EF%BC%8C%E5%88%99%E7%94%9F%E6%88%90%E7%9A%84%E5%AF%86%E9%92%A5%E6%97%A0%E6%95%88%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%BA%94%E7%BB%A7%E7%BB%AD%E4%B8%8B%E4%B8%80%E4%B8%AAi%E5%80%BC%E3%80%82+%EF%BC%88%E6%B3%A8%EF%BC%9A%E6%A6%82%E7%8E%87%E4%BD%8E%E4%BA%8E1%2F2127%EF%BC%89%3C%2Fstrong%3E%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+python%22%3E%3Cspan+class%3D%22hljs-function%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Edef%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-title%22%3Eraw_bip32_ckd%3C%2Fspan%3E%3Cspan+class%3D%22hljs-params%22%3E%28rawtuple%2C+i%29%3C%2Fspan%3E%3A%3C%2Fspan%3E%0A++++vbytes%2C+depth%2C+fingerprint%2C+oldi%2C+chaincode%2C+key+%3D+rawtuple%0A++++i+%3D+int%28i%29%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+vbytes+%3Cspan+class%3D%22hljs-keyword%22%3Ein%3C%2Fspan%3E+PRIVATE%3A%0A++++++++priv+%3D+key%0A++++++++pub+%3D+privtopub%28key%29%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E%3A%0A++++++++pub+%3D+key%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+i+%26gt%3B%3D+%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E**%3Cspan+class%3D%22hljs-number%22%3E31%3C%2Fspan%3E%3A%0A++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+vbytes+%3Cspan+class%3D%22hljs-keyword%22%3Ein%3C%2Fspan%3E+PUBLIC%3A%0A++++++++++++%3Cspan+class%3D%22hljs-keyword%22%3Eraise%3C%2Fspan%3E+Exception%28%3Cspan+class%3D%22hljs-string%22%3E%22Can%27t+do+private+derivation+on+public+key%21%22%3C%2Fspan%3E%29%0A++++++++I+%3D+hmac.new%28chaincode%2C+%3Cspan+class%3D%22hljs-string%22%3Eb%27%5Cx00%27%3C%2Fspan%3E%2Bpriv%5B%3A%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%2Bencode%28i%2C+%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%2C+hashlib.sha512%29.digest%28%29%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eelse%3C%2Fspan%3E%3A%0A++++++++I+%3D+hmac.new%28chaincode%2C+pub%2Bencode%28i%2C+%3Cspan+class%3D%22hljs-number%22%3E256%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%29%2C+hashlib.sha512%29.digest%28%29%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+vbytes+%3Cspan+class%3D%22hljs-keyword%22%3Ein%3C%2Fspan%3E+PRIVATE%3A%0A++++++++newkey+%3D+add_privkeys%28I%5B%3A%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%2BB%3Cspan+class%3D%22hljs-string%22%3E%27%5Cx01%27%3C%2Fspan%3E%2C+priv%29%0A++++++++fingerprint+%3D+bin_hash160%28privtopub%28key%29%29%5B%3A%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%5D%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+vbytes+%3Cspan+class%3D%22hljs-keyword%22%3Ein%3C%2Fspan%3E+PUBLIC%3A%0A++++++++newkey+%3D+add_pubkeys%28compress%28privtopub%28I%5B%3A%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%5D%29%29%2C+key%29%0A++++++++fingerprint+%3D+bin_hash160%28key%29%5B%3A%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%5D%0A%0A++++%3Cspan+class%3D%22hljs-keyword%22%3Ereturn%3C%2Fspan%3E+%28vbytes%2C+depth+%2B+%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%2C+fingerprint%2C+i%2C+I%5B%3Cspan+class%3D%22hljs-number%22%3E32%3C%2Fspan%3E%3A%5D%2C+newkey%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E4%BB%A3%E7%A0%81%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%EF%BC%8C%E9%83%BD%E6%98%AF%E6%8C%89%E7%85%A7%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%B5%81%E7%A8%8B%E7%BC%96%E5%86%99%E7%9A%84%E3%80%82%E8%BF%99%E9%87%8C%E5%8F%AA%E9%9C%80%E8%A6%81%E7%89%B9%E5%88%AB%E8%AF%B4%E6%98%8E%E5%AF%86%E9%92%A5%E6%8C%87%E7%BA%B9%28fingerprint%29%E7%9A%84%E8%AE%A1%E7%AE%97%E8%A7%84%E5%88%99%EF%BC%8C%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+bash%22%3Efingerprint+%3D+bin_%3Cspan+class%3D%22hljs-built_in%22%3Ehash%3C%2Fspan%3E160%28privtopub%28key%29%29%5B%3A%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%5D%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E%E6%A0%B9%E6%8D%AEBIP32%2C%E6%89%A9%E5%B1%95%E5%AF%86%E9%92%A5%E5%8F%AF%E4%BB%A5%E7%94%B1%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84ECSDA%E5%85%AC%E9%92%A5K%E7%9A%84Hash160%EF%BC%88SHA256%E4%B9%8B%E5%90%8E%E7%9A%84RIPEMD160%EF%BC%89%E6%A0%87%E8%AF%86%E3%80%82+%3C%2Fp%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fmarkdown_views-ea0013b516.css%22%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fpony_maggie%2Farticle%2Fdetails%2F77713909%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fpony_maggie%2Farticle%2Fdetails%2F77713909%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}