---
layout: default
title: golang中关于RSA加密、解密、签名、验签的总结
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Cdiv+class%3D%22markdown_views%22%3E+%0A++%3Ch1+id%3D%22golang%E4%B8%AD%E5%85%B3%E4%BA%8Ersa%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%AD%BE%E5%90%8D%E9%AA%8C%E7%AD%BE%E7%9A%84%E6%80%BB%E7%BB%93%22%3Egolang%E4%B8%AD%E5%85%B3%E4%BA%8ERSA%E5%8A%A0%E5%AF%86%E3%80%81%E8%A7%A3%E5%AF%86%E3%80%81%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E7%AD%BE%E7%9A%84%E6%80%BB%E7%BB%93%3C%2Fh1%3E+%0A++%3Cpre%3E%3Ccode%3Egolang%E4%B8%AD%E5%85%B3%E4%BA%8ERSA%E7%9A%84%E5%8A%A0%E5%AF%86%E3%80%81%E8%A7%A3%E5%AF%86%E3%80%81%E7%AD%BE%E5%90%8D%E3%80%81%E9%AA%8C%E7%AD%BE%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%BB%E8%A6%81%E5%9C%A8%E4%BA%8E%E4%BD%BF%E7%94%A8x509%E5%8F%8Arsa+package%E4%B8%8B%E7%9B%B8%E5%85%B3%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch3+id%3D%22%E4%BB%A5%E4%B8%8B%E6%80%BB%E7%BB%93%E7%9B%B8%E5%85%B3%E7%9A%84%E5%90%84%E7%A7%8D%E5%8F%98%E5%8C%96%E7%B1%BB%E5%9E%8B%22%3E%E4%BB%A5%E4%B8%8B%E6%80%BB%E7%BB%93%E7%9B%B8%E5%85%B3%E7%9A%84%E5%90%84%E7%A7%8D%E5%8F%98%E5%8C%96%E7%B1%BB%E5%9E%8B%3C%2Fh3%3E+%0A++%3Ch3+id%3D%221%E7%A7%98%E9%92%A5%E5%8A%A0%E5%AF%86%E7%AD%BE%E5%90%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8A%A0%E5%AF%86%E7%9A%84%E6%A0%BC%E5%BC%8F%22%3E1.%E7%A7%98%E9%92%A5%E3%80%81%E5%8A%A0%E5%AF%86%2F%E7%AD%BE%E5%90%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8A%A0%E5%AF%86%E7%9A%84%E6%A0%BC%E5%BC%8F%3C%2Fh3%3E+%0A++%3Cp%3E%E7%9B%AE%E5%89%8D%E4%B8%BB%E8%A6%81%E8%A7%81%E5%88%B0%E6%9C%89hex%E5%8F%8Abase64%3C%2Fp%3E+%0A++%3Ch4+id%3D%221hex%22%3E%EF%BC%881%EF%BC%89hex%3C%2Fh4%3E+%0A++%3Cp%3E%E9%92%88%E5%AF%B9hex%E7%9A%84%E5%8A%A0%E8%A7%A3%E5%AF%86%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+cs%22%3Ehex.DecodeString%28s+%3Cspan+class%3D%22hljs-keyword%22%3Estring%3C%2Fspan%3E%29%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E8%A7%A3%E5%AF%86%3C%2Fspan%3E%0Ahex.EncodeToString%28src+%5B%5D%3Cspan+class%3D%22hljs-keyword%22%3Ebyte%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Estring%3C%2Fspan%3E%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E5%8A%A0%E5%AF%86%3C%2Fspan%3E%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%222base64%22%3E%EF%BC%882%EF%BC%89base64%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+cs%22%3Ebase64.StdEncoding.DecodeString%28s+%3Cspan+class%3D%22hljs-keyword%22%3Estring%3C%2Fspan%3E%29+%28%5B%5D%3Cspan+class%3D%22hljs-keyword%22%3Ebyte%3C%2Fspan%3E%2C+error%29%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E8%A7%A3%E5%AF%86%3C%2Fspan%3E%0Abase64.StdEncoding.EncodeToString%28src+%5B%5D%3Cspan+class%3D%22hljs-keyword%22%3Ebyte%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Estring%3C%2Fspan%3E%3Cspan+class%3D%22hljs-comment%22%3E%2F%2F%E5%8A%A0%E5%AF%86%3C%2Fspan%3E%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch3+id%3D%222%E7%A7%81%E9%92%A5%E7%9A%84%E6%A0%BC%E5%BC%8F%22%3E2.%E7%A7%81%E9%92%A5%E7%9A%84%E6%A0%BC%E5%BC%8F%3C%2Fh3%3E+%0A++%3Cp%3E%E8%A7%A3%E6%9E%90%E7%A7%81%E9%92%A5%E7%9A%84%E6%96%B9%E5%BC%8F%E5%A6%82%E4%B8%8B%EF%BC%9A%3C%2Fp%3E+%0A++%3Ch4+id%3D%221pkcs1%22%3E%EF%BC%881%EF%BC%89PKCS1%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+axapta%22%3Ex509.ParsePKCS1PrivateKey%28der+%5B%5D%3Cspan+class%3D%22hljs-keyword%22%3Ebyte%3C%2Fspan%3E%29+%28key+%3Cspan+class%3D%22hljs-class%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Einterface%3C%2Fspan%3E%7B%3C%2Fspan%3E%7D%2C+err+error%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%222pkcs8%22%3E%EF%BC%882%EF%BC%89PKCS8%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+axapta%22%3Ex509.ParsePKCS8PrivateKey%28der+%5B%5D%3Cspan+class%3D%22hljs-keyword%22%3Ebyte%3C%2Fspan%3E%29+%28key+%3Cspan+class%3D%22hljs-class%22%3E%3Cspan+class%3D%22hljs-keyword%22%3Einterface%3C%2Fspan%3E%7B%3C%2Fspan%3E%7D%2C+err+error%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch3+id%3D%223%E9%87%87%E7%94%A8%E7%9A%84%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95sha%22%3E3.%E9%87%87%E7%94%A8%E7%9A%84%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95SHA%3C%2Fh3%3E+%0A++%3Cp%3E%E4%BB%A5%E4%B8%8B%E5%BA%94RSA+sign%E7%9A%84%E4%B8%8D%E5%90%8C%E8%AF%B4%E6%98%8E%EF%BC%9A%3C%2Fp%3E+%0A++%3Ch4+id%3D%221sha1%22%3E%EF%BC%881%EF%BC%89SHA1%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+avrasm%22%3E++++hash+%3A%3D+sha1%3Cspan+class%3D%22hljs-preprocessor%22%3E.New%3C%2Fspan%3E%28%29%0A++++hash%3Cspan+class%3D%22hljs-preprocessor%22%3E.Write%3C%2Fspan%3E%28%5B%5Dbyte%28originalData%29%29%0A++++encryptedData%2C+err+%3A%3D+rsa%3Cspan+class%3D%22hljs-preprocessor%22%3E.SignPKCS%3C%2Fspan%3E1v15%28rand%3Cspan+class%3D%22hljs-preprocessor%22%3E.Reader%3C%2Fspan%3E%2C+prvKey%2C+crypto%3Cspan+class%3D%22hljs-preprocessor%22%3E.SHA%3C%2Fspan%3E1%2C+hash%3Cspan+class%3D%22hljs-preprocessor%22%3E.Sum%3C%2Fspan%3E%28nil%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%222sha256%22%3E%EF%BC%882%EF%BC%89SHA256%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+avrasm%22%3E++++hash+%3A%3D+sha256%3Cspan+class%3D%22hljs-preprocessor%22%3E.New%3C%2Fspan%3E%28%29%0A++++hash%3Cspan+class%3D%22hljs-preprocessor%22%3E.Write%3C%2Fspan%3E%28%5B%5Dbyte%28originalData%29%29%0A++++encryptedData%2C+err+%3A%3D+rsa%3Cspan+class%3D%22hljs-preprocessor%22%3E.SignPKCS%3C%2Fspan%3E1v15%28rand%3Cspan+class%3D%22hljs-preprocessor%22%3E.Reader%3C%2Fspan%3E%2C+prvKey%2C+crypto%3Cspan+class%3D%22hljs-preprocessor%22%3E.SHA%3C%2Fspan%3E256%2C+hash%3Cspan+class%3D%22hljs-preprocessor%22%3E.Sum%3C%2Fspan%3E%28nil%29%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch3+id%3D%224rsa%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B%22%3E4.RSA%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B%3C%2Fh3%3E+%0A++%3Cp%3E%E4%B8%BB%E8%A6%81%E6%9C%89%E5%8A%A0%E5%AF%86%2F%E8%A7%A3%E5%AF%86%E3%80%81%E7%AD%BE%E5%90%8D%2F%E9%AA%8C%E7%AD%BE4%E4%B8%AD%E6%96%B9%E5%BC%8F%EF%BC%8C%E4%B8%94%E5%8A%A0%E5%AF%86%2F%E8%A7%A3%E5%AF%86%E4%B8%8E%E7%AD%BE%E5%90%8D%2F%E9%AA%8C%E7%AD%BE%E5%9D%87%E6%98%AF%E4%B8%80%E4%B8%AA%E7%9B%B8%E5%8F%8D%E7%9A%84%E8%BF%87%E7%A8%8B%E3%80%82%E4%B8%A4%E5%AF%B9%E6%98%AF%E6%A0%B9%E6%8D%AE%E5%AF%B9%E5%85%AC%E9%92%A5%E5%8F%8A%E7%A7%81%E9%92%A5%E7%9A%84%E4%BD%BF%E7%94%A8%E5%88%92%E5%88%86%E7%9A%84%E3%80%82%3C%2Fp%3E+%0A++%3Cpre%3E%3Ccode%3E%E5%8A%A0%E5%AF%86%2F%E8%A7%A3%E5%AF%86%E6%98%AF%E9%87%87%E7%94%A8%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86%EF%BC%8C%E7%A7%81%E9%92%A5%E8%A7%A3%E5%AF%86%E3%80%82%0A%E7%AD%BE%E5%90%8D%2F%E9%AA%8C%E7%AD%BE%E6%98%AF%E9%87%87%E7%94%A8%E7%A7%81%E9%92%A5%E7%AD%BE%E5%90%8D%EF%BC%8C%E5%85%AC%E9%92%A5%E9%AA%8C%E7%AD%BE%E3%80%82%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%221%E5%8A%A0%E5%AF%86%22%3E%EF%BC%881%EF%BC%89%E5%8A%A0%E5%AF%86%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+vbnet%22%3Ersa.EncryptPKCS1v15%28rand+io.Reader%2C+pub+*PublicKey%2C+msg+%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%29+%28%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%222%E8%A7%A3%E5%AF%86%22%3E%EF%BC%882%EF%BC%89%E8%A7%A3%E5%AF%86%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+vbnet%22%3Ersa.DecryptPKCS1v15%28rand+io.Reader%2C+priv+*PrivateKey%2C+ciphertext+%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%29+%28%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%29%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%223%E7%AD%BE%E5%90%8D%22%3E%EF%BC%883%EF%BC%89%E7%AD%BE%E5%90%8D%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+vbnet%22%3Ersa.SignPKCS1v15%28rand+io.Reader%2C+priv+*PrivateKey%2C+hash+crypto.Hash%2C+hashed+%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%29+%28%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%29%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Ch4+id%3D%224%E9%AA%8C%E7%AD%BE%22%3E%EF%BC%884%EF%BC%89%E9%AA%8C%E7%AD%BE%3C%2Fh4%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+vbnet%22%3Ersa.VerifyPKCS1v15%28pub+*PublicKey%2C+hash+crypto.Hash%2C+hashed+%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%2C+sig+%5B%5D%3Cspan+class%3D%22hljs-built_in%22%3Ebyte%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A++%3Cp%3E5.%E5%85%B7%E4%BD%93%E7%9A%84%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%3C%2Fp%3E+%0A++%3Cpre+class%3D%22prettyprint%22%3E%3Ccode+class%3D%22+hljs+vbscript%22%3E%EF%BC%88%3Cspan+class%3D%22hljs-number%22%3E1%3C%2Fspan%3E%EF%BC%89%E5%8A%A0%E5%AF%86%EF%BC%9A%E9%87%87%E7%94%A8sha1%E7%AE%97%E6%B3%95%E5%8A%A0%E5%AF%86%E5%90%8E%E8%BD%ACbase64%E6%A0%BC%E5%BC%8F%0Afunc+RsaEncryptWithSha1Base64%28originalData%2CpublicKey+%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%29%28%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%2C%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%29%7B%0A+++key%2C+_+%3A%3D+base64.StdEncoding.DecodeString%28publicKey%29%0A+++pubKey%2C+_+%3A%3D+x509.ParsePKIXPublicKey%28key%29%0A+++encryptedData%2C%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%3A%3Drsa.EncryptPKCS1v15%28rand.Reader%2C+pubKey.%28*rsa.PublicKey%29%2C+%5B%5Dbyte%28originalData%29%29%0A+++return+base64.StdEncoding.EncodeToString%28encryptedData%29%2C%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A%7D%0A%0A%EF%BC%88%3Cspan+class%3D%22hljs-number%22%3E2%3C%2Fspan%3E%EF%BC%89%E8%A7%A3%E5%AF%86%EF%BC%9A%E5%AF%B9%E9%87%87%E7%94%A8sha1%E7%AE%97%E6%B3%95%E5%8A%A0%E5%AF%86%E5%90%8E%E8%BD%ACbase64%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86%EF%BC%88%E7%A7%81%E9%92%A5PKCS1%E6%A0%BC%E5%BC%8F%EF%BC%89%0Afunc+RsaDecryptWithSha1Base64%28encryptedData%2CprivateKey+%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%29%28%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%2C%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%29%7B%0A+++encryptedDecodeBytes%2C%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%3A%3Dbase64.StdEncoding.DecodeString%28encryptedData%29%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%21%3Dnil+%7B%0A++++++return+%3Cspan+class%3D%22hljs-string%22%3E%22%22%3C%2Fspan%3E%2C%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A+++%7D%0A+++key%2C_%3A%3Dbase64.StdEncoding.DecodeString%28privateKey%29%0A+++prvKey%2C_%3A%3Dx509.ParsePKCS1PrivateKey%28key%29%0A+++originalData%2C%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%3A%3Drsa.DecryptPKCS1v15%28rand.Reader%2CprvKey%2CencryptedDecodeBytes%29%0A+++return+%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%28originalData%29%2C%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A%7D%0A%0A%EF%BC%88%3Cspan+class%3D%22hljs-number%22%3E3%3C%2Fspan%3E%EF%BC%89%E7%AD%BE%E5%90%8D%EF%BC%9A%E9%87%87%E7%94%A8sha1%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E7%AD%BE%E5%90%8D%E5%B9%B6%E8%BE%93%E5%87%BA%E4%B8%BA%3Cspan+class%3D%22hljs-built_in%22%3Ehex%3C%2Fspan%3E%E6%A0%BC%E5%BC%8F%EF%BC%88%E7%A7%81%E9%92%A5PKCS8%E6%A0%BC%E5%BC%8F%EF%BC%89%0Afunc+RsaSignWithSha1Hex%28data+%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%2C+prvKey+%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%29+%28%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%29+%7B%0A+++keyByts%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%3A%3D+%3Cspan+class%3D%22hljs-built_in%22%3Ehex%3C%2Fspan%3E.DecodeString%28prvKey%29%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%21%3D+nil+%7B%0A++++++fmt.Println%28%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%29%0A++++++return+%3Cspan+class%3D%22hljs-string%22%3E%22%22%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A+++%7D%0A+++privateKey%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%3A%3D+x509.ParsePKCS8PrivateKey%28keyByts%29%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%21%3D+nil+%7B%0A++++++fmt.Println%28%3Cspan+class%3D%22hljs-string%22%3E%22ParsePKCS8PrivateKey+err%22%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%29%0A++++++return+%3Cspan+class%3D%22hljs-string%22%3E%22%22%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A+++%7D%0A+++h+%3A%3D+sha1.%3Cspan+class%3D%22hljs-keyword%22%3ENew%3C%2Fspan%3E%28%29%0A+++h.Write%28%5B%5Dbyte%28%5B%5Dbyte%28data%29%29%29%0A+++hash+%3A%3D+h.Sum%28nil%29%0A+++signature%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%3A%3D+rsa.SignPKCS1v15%28rand.Reader%2C+privateKey.%28*rsa.PrivateKey%29%2C+crypto.SHA1%2C+hash%5B%3A%5D%29%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%21%3D+nil+%7B%0A++++++fmt.Printf%28%3Cspan+class%3D%22hljs-string%22%3E%22Error+from+signing%3A+%25s%5Cn%22%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%29%0A++++++return+%3Cspan+class%3D%22hljs-string%22%3E%22%22%3C%2Fspan%3E%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A+++%7D%0A+++out+%3A%3D+%3Cspan+class%3D%22hljs-built_in%22%3Ehex%3C%2Fspan%3E.EncodeToString%28signature%29%0A+++return+out%2C+nil%0A%7D%0A%0A%EF%BC%88%3Cspan+class%3D%22hljs-number%22%3E4%3C%2Fspan%3E%EF%BC%89%E9%AA%8C%E7%AD%BE%EF%BC%9A%E5%AF%B9%E9%87%87%E7%94%A8sha1%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E7%AD%BE%E5%90%8D%E5%90%8E%E8%BD%ACbase64%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E9%AA%8C%E7%AD%BE%0Afunc+RsaVerySignWithSha1Base64%28originalData%2C+signData%2C+pubKey+%3Cspan+class%3D%22hljs-built_in%22%3Estring%3C%2Fspan%3E%29+%3Cspan+class%3D%22hljs-keyword%22%3Eerror%3C%2Fspan%3E%7B%0A+++sign%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%3A%3D+base64.StdEncoding.DecodeString%28signData%29%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%21%3D+nil+%7B%0A++++++return+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A+++%7D%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E%2C+_+%3A%3D+base64.StdEncoding.DecodeString%28pubKey%29%0A+++pub%2C+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%3A%3D+x509.ParsePKIXPublicKey%28%3Cspan+class%3D%22hljs-keyword%22%3Epublic%3C%2Fspan%3E%29%0A+++%3Cspan+class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E+%21%3D+nil+%7B%0A++++++return+%3Cspan+class%3D%22hljs-built_in%22%3Eerr%3C%2Fspan%3E%0A+++%7D%0A+++hash+%3A%3D+sha1.%3Cspan+class%3D%22hljs-keyword%22%3ENew%3C%2Fspan%3E%28%29%0A+++hash.Write%28%5B%5Dbyte%28originalData%29%29%0A+++return+rsa.VerifyPKCS1v15%28pub.%28*rsa.PublicKey%29%2C+crypto.SHA1%2C+hash.Sum%28nil%29%2C+sign%29%0A%7D%0A%0A%3C%2Fcode%3E%3C%2Fpre%3E+%0A+%3C%2Fdiv%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fmarkdown_views-ea0013b516.css%22%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fxz_studying%2Farticle%2Fdetails%2F80314111%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fxz_studying%2Farticle%2Fdetails%2F80314111%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}