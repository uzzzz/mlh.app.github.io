---
layout: default
title: samtools mpileup原始结果文件处理，非bcf/vcf格式
---

{{ "%3Cdiv+id%3D%22article_content%22+class%3D%22article_content+clearfix+csdn-tracking-statistics%22+data-pid%3D%22blog%22+data-mod%3D%22popu_307%22+data-dsm%3D%22post%22%3E+%0A+%3Clink+rel%3D%22stylesheet%22+href%3D%22https%3A%2F%2Fcsdnimg.cn%2Frelease%2Fphoenix%2Ftemplate%2Fcss%2Fck_htmledit_views-e2445db1a8.css%22%3E+%0A+%3Cdiv+class%3D%22htmledit_views%22%3E+%0A++%3Cp%3Esamtools+mpileup%E5%A4%84%E7%90%86%E7%9A%84%E5%8E%9F%E5%A7%8B%E7%BB%93%E6%9E%9C%E5%90%91%E6%9D%A5%E6%AF%94%E8%BE%83%E9%BA%BB%E7%83%A6%EF%BC%8C%E5%86%99%E4%BA%86%E4%B8%80%E4%B8%AA%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%AA%E7%94%9F%E6%88%90%E7%A2%B1%E5%9F%BAreads%EF%BC%8C%E4%BD%86%E4%B8%8D%E8%BF%9B%E8%A1%8C%E4%BB%BB%E4%BD%95%E8%BF%87%E6%BB%A4%EF%BC%9A%3C%2Fp%3E+%0A++%3Cp%3E%3C%2Fp%3E%0A++%3Cpre%3E%3Ccode+class%3D%22language-plain%22%3E%23%21%2Fusr%2Fbin%2Fenv+perl+%0Ause+strict%3B%0Ause+warnings%3B%0Ause+Getopt%3A%3ALong%3B%0A%0Amy+%25opt%3B%0AGetOptions%28%5C%25opt%2C+%22i%3Ds%22%2C+%22o%3Ds%22%2C+%22sd%3Ds%22%2C+%22ad%3Ds%22%2C+%22aq%3Ds%22%29%3B%0A%0Amy+%24usage+%3D+%26lt%3B%26lt%3B%22USAGE%22%3B%0A%0A%09Usage%3A+perl+%240+-i+%26lt%3Bpileup%26gt%3B++%5Boptions%5D%0A%09CreationTime%3A+%0A%09ModifyTime%3A+%0A%09Note%3A+%0A%0A%09Options%3A%0A%09-i%09%09%09input+file%0A%0A%09eg%3A+perl+%240+-i+file.pileup+%26gt%3B+result%0A%0AUSAGE%0A%0Adie+%24usage+if%28%21%24opt%7Bi%7D%29%3B%0A%0Aopen+IN%2C+%28%24opt%7Bi%7D+%3D%7E+%2F%5C.gz%24%2F%29+%3F+%22gzip+-dc+%24opt%7Bi%7D+%7C%22+%3A+%24opt%7Bi%7D+or+die+%24%21%3B%0Amy+%28%40tmp%2C+%40qual%2C+%40base%2C+%25index%29%3B%0Awhile%28%26lt%3BIN%26gt%3B%29%0A%7B%0A%09chomp%3B%0A%09%40tmp+%3D+split+%2F%5Ct%2F%3B%0A%09next+if%28%24tmp%5B2%5D+eq+%22N%22%29%3B%0A%0A%09while%28%24tmp%5B4%5D+%3D%7E+%2F%5B%5C%2B-%5D%28%5Cd%2B%29%5BATCGNatcgn%5D%2B%2F%29%0A%09%7B%0A%09%09%24tmp%5B4%5D+%3D%7E+s%2F%5B%5C%2B-%5D%5Cd%2B%5BATCGNatcgn%5D%7B%241%7D%2F%2F%3B%0A%09%7D%0A%09%24tmp%5B4%5D+%3D%7E+s%2F%5C%5E%5CS%2F%2Fg%3B+%23%5C%26lt%3B%5C%3D%5C%26gt%3B%5C-%5C%21%5C%3F%5C%2F%5C%27%5C%22%5C%29%5C%28%5C%5D%5C%5B%5C*%5C%5C%5C.%5C%2B%2C%3B%3A%40%26amp%3B%23%250-9A-Z%0A%09%24tmp%5B4%5D+%3D%7E+s%2F%5B%5C%5E%5C%24%5D%2F%2Fg%3B%0A%0A%09%40base+%3D+split+%2F%2F%2C+%24tmp%5B4%5D%3B%0A%09%0A%09my+%25hash+%3D+%28%27r%27%3D%26gt%3B0%2C+%27A%27%3D%26gt%3B0%2C+%27T%27%3D%26gt%3B0%2C+%27C%27%3D%26gt%3B0%2C+%27G%27%3D%26gt%3B0%29%3B%0A%09foreach+my+%24b%28%40base%29%0A%09%7B%0A%09%09if%28%24b+%3D%7E+%2F%5B%5C.%2C%5D%2F%29%0A%09%09%7B%0A%09%09%09%24hash%7B%27r%27%7D+%2B%2B%3B%0A%09%09%09next%3B%0A%09%09%7D%0A%09%09if%28%24b%3D%7E+%2F%5BAa%5D%2F%29%0A%09%09%7B%0A%09%09%09%24hash%7B%27A%27%7D+%2B%2B%3B%0A%09%09%09next%3B%0A%09%09%7D%0A%09%09if%28%24b+%3D%7E+%2F%5BTt%5D%2F%29%0A%09%09%7B%0A%09%09%09%24hash%7B%27T%27%7D+%2B%2B%3B%0A%09%09%09next%3B%0A%09%09%7D%0A%09%09if%28%24b+%3D%7E+%2F%5BCc%5D%2F%29%0A%09%09%7B%0A%09%09%09%24hash%7B%27C%27%7D+%2B%2B%3B%0A%09%09%09next%3B%0A%09%09%7D%0A%09%09if%28%24b+%3D%7E+%2F%5BGg%5D%2F%29%0A%09%09%7B%0A%09%09%09%24hash%7B%27G%27%7D+%2B%2B%3B%0A%09%09%09next%3B%0A%09%09%7D%0A%09%7D%0A%09my+%28%24m%2C+%24fb%2C+%24fbn%2C+%24sb%2C+%24sbn%29%3B%0A%09foreach+my+%24i%28sort+%7B%24hash%7B%24b%7D+%26lt%3B%3D%26gt%3B+%24hash%7B%24a%7D%7D+keys+%25hash%29%0A%09%7B%0A%09%09%24m+%2B%2B%3B%0A%09%09if%28%24m+%3D%3D+1+and+%24i+eq+%22r%22%29%0A%09%09%7B%0A%09%09%09%24fb+%3D+%24tmp%5B2%5D%3B%0A%09%09%09%24fbn+%3D+%24hash%7B%24i%7D%3B%0A%09%09%09next%3B%0A%09%09%7Delsif%28%24m+%3D%3D+1%29%7B%0A%09%09%09%24fb+%3D+%24i%3B%0A%09%09%09%24fbn+%3D+%24hash%7B%24i%7D%3B%0A%09%09%09next%3B%0A%09%09%7D%0A%09%09if%28%24m+%3D%3D+2+and+%24i+eq+%27r%27%29%0A%09%09%7B%0A%09%09%09%24sb+%3D+%24tmp%5B2%5D%3B%0A%09%09%09%24sbn+%3D+%24hash%7B%24i%7D%3B%0A%09%09%09last%3B%0A%09%09%7Delsif%28%24m+%3D%3D+2%29%7B%0A%09%09%09%24sb+%3D+%24i%3B%0A%09%09%09%24sbn+%3D+%24hash%7B%24i%7D%3B%0A%09%09%09last%3B%0A%09%09%7D%0A%09%7D%0A%09print+join+%22%5Ct%22%2C+%40tmp%5B0..2%5D%2C+%24fb%2C+%24fbn%2C+%24sb%2C+%24sbn%2C+%22%5Cn%22%3B%0A%7D%0Aclose+IN%3B%0A%0Asub+showtime%0A%7B%0A%09my+%28%24x%29+%3D+%40_%3B%0A%09my+%24t+%3D+localtime%3B%0A%09print+STDERR+%22%5B%24t%5D+%24x%5Cn%22%3B%0A%7D%3C%2Fcode%3E%3C%2Fpre%3E%E5%B0%A4%E5%85%B6%E6%98%AF%E6%B2%A1%E6%9C%89%E8%BF%87%E6%BB%A4%E8%B4%A8%E9%87%8F%E5%80%BC%EF%BC%8C%E6%89%80%E4%BB%A5%E5%BE%97%E5%88%B0%E7%9A%84reads%E8%82%AF%E5%AE%9A%E6%98%AF%E4%B8%8D%E5%87%86%E7%A1%AE%E7%9A%84%EF%BC%8C%E5%8F%A6%E5%A4%96%E4%B8%80%E4%B8%AA%E8%BF%87%E6%BB%A4%E7%89%88%E6%9C%AC%E7%94%B1%E4%BA%8E%E6%9F%90%E4%BA%9B%E7%BB%8F%E9%AA%8C%E4%B8%8A%E7%9A%84%E5%88%A4%E5%AE%9A%E5%8E%9F%E5%9B%A0%E6%9A%82%E4%B8%8D%E5%8F%91%E5%B8%83%E3%80%82+%0A+%3C%2Fdiv%3E+%0A%3C%2Fdiv%3E+%0A%3Cdiv+class%3D%22hide-article-box+text-center%22%3E+%0A+%3Ca+class%3D%22btn+btn-red-hollow%22+id%3D%22btn-readmore%22+data-track-view%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fskenoy%2Farticle%2Fdetails%2F24675139%2C%26quot%3B%7D%22+data-track-click%3D%22%7B%26quot%3Bmod%26quot%3B%3A%26quot%3Bpopu_376%26quot%3B%2C%26quot%3Bcon%26quot%3B%3A%26quot%3B%2Chttps%3A%2F%2Fblog.csdn.net%2Fskenoy%2Farticle%2Fdetails%2F24675139%2C%26quot%3B%7D%22%3E%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A%3C%2Fa%3E+%0A%3C%2Fdiv%3E" | url_decode}}