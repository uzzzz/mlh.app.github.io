<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>银联卡QPBOC处理流程及数据分析 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="银联卡QPBOC处理流程及数据分析" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="qPBOC基本信息数据采用TLV（tag-length-value）的表示方式，即每项由tag标签(T)，长度(L)和取值(V)构成。 标签： 　　tag标签的属性为bit，由16进制表示，占1～2个字节长度。若tag标签的第一个字节（注：字节排序方向为从左往右数(b8~b0)，第一个字节即为最左边的字节。bit排序规则同理。）的后四个bit为“1111”，则说明该tag占两个字节，例如“9F33”；否则占一个字节，例如“95”。b8和b7两位标识tag所属类别.&nbsp;这个可以暂时不用理.&nbsp;&nbsp;b6决定当前的TLV数据是一个单一的数据和复合结构的数据.&nbsp;复合的TLV是指value域里也包含一个或多个TLV,&nbsp;类似嵌套的编码格式.&nbsp;b5~b1如果全为1，则说明这个tag下面还有一个子字节.&nbsp;占两个字节,&nbsp;否则tag占一个字节。 长度： 　　长度（即L本身）的属性也为bit，占1～3个字节长度。具体编码规则如下： 　　a)当L字段最左边字节的最左bit位（即bit8）为0，表示该L字段占一个字节，它的后续7个bit位（即bit7～bit1）表示取值的长度，采用二进制数表示取值长度的十进制数。 　　b)当L字段最左边字节的最左bit位（即bit8）为1，表示该L字段不止占一个字节，那么它到底占几个字节由该最左字节的后续7个bit位（即bit7～bit1）的十进制取值表示。例如，若最左字节为10000010，表示L字段除该字节外，后面还有两个字节。其后续字节的十进制取值表示取值的长度。 银联卡QPBOC处理流程及数据分析。。。 银联卡处理 交易金额确定 检查IC卡参数 选择QPBOC目录 AID选应用: send:00A404000E&nbsp;325041592E5359532E4444463031 recv: 6F&nbsp;30//FCI模板 84&nbsp;0E&nbsp;325041592E5359532E4444463031 A5&nbsp;1E&nbsp;//FCI专有模板 BF0C&nbsp;1B//模板,文件控制信息(FCI)专有数据 61&nbsp;19//模板 4F&nbsp;08&nbsp;A000000333010101//应用标示符(AID) 50&nbsp;0A&nbsp;50424F43204445424954//应用标签 87&nbsp;01&nbsp;01//应用优先指示器 9000 卡片校验 终端IC卡参数检查 rcode=0x00 选择ICPParm.TVL9F06 AID选应用: send:00A4040008&nbsp;A000000333010101 recv: 6F&nbsp;36//FCI模板 84&nbsp;08&nbsp;A000000333010101//专有(DF)文件名称 A5&nbsp;2A&nbsp;//FCI专有模板 50&nbsp;0A&nbsp;50424F43204445424954//应用标签 87&nbsp;01&nbsp;01//应用优先指示器 9F38&nbsp;18&nbsp;//处理选项数据对象列表PDOL //PDOL中的标签 9F66&nbsp;04//终端交易属性 9F02&nbsp;06&nbsp;//授权金额 9F03&nbsp;06&nbsp;//其他金额 9F1A&nbsp;02&nbsp;//国家代码 95&nbsp;05&nbsp;//终端验证结果TVR 5F2A&nbsp;02//交易货币代码 9A&nbsp;03&nbsp;//交易日期 9C&nbsp;01//交易类型 9F37&nbsp;04//不可预知数 9000 &nbsp; rcode=0x9000 交易扣钱 读取余额 send:80CA9F7900 recv:9F79&nbsp;06&nbsp;000000000076 9000 &nbsp; GPO前准备工作 &nbsp; 发送GPO命令 send:80A80000238321 2A000000//PDOL中的终端交易属性9F66 000000000001 //授权金额 000000000000 //其他金额 0156//国家代码 0000000000//终端验证结果TVR 0156//交易货币代码 131111//交易日期 00//交易类型 35383F5B//不可预知数 00 recv: 77&nbsp;5A//模板 82&nbsp;02&nbsp;7C00 //应用交互特征AIP 9F36&nbsp;02&nbsp;0075//应用交易计数器ATC 9F10&nbsp;13&nbsp;07010103900000010A010000000075C5B41C32//发卡行应用数据 9F26&nbsp;08&nbsp;B5D1C169FA969D76//应用密文AC 9F6C&nbsp;02&nbsp;0000 57&nbsp;13&nbsp;6214834270000244D22102200484900826610F//磁条2等效数据，卡BIn 5F34&nbsp;01&nbsp;00//应用PAN序列号 94&nbsp;10//应用文件定位器(AFL) 10&nbsp;03&nbsp;04&nbsp;00&nbsp;&nbsp;//读取文件10的第3条到第4条记录 10 09 0B 01 //读取文件10的第9条到0B条，即09，0A，0B 30 01 01 00 //读取文件30的第1条 28 01 01 00//读取文件28的第1条 &nbsp; 9000 &nbsp; TLV数据解析 &nbsp; 卡bin号检查 &nbsp; 根据AFL文件定位器读取相关文件 读取记录: send:00B2031400 recv:7081B39081B0A33373F56850C06B1DE59D93F4F2A362CEA2A57C37D5DC78E3BF84914B608A43ACD22539B6C0491E88652244D2A199E6516D0C6F3C632F65202561106420FA406F530AE8D39CAF6EA5730E4A5AB15763FB42EAFA0AEE69A9E69640642E29CA15D5449B7AB74411A50EF811ACDEF4D8F93004C423E77E55AC263DA89308FCC05E3E0AA599565590C83CCE7FF6B17602F1BD7DB22C48A5A039FB97C48A8FA16083CC56DD6FEC3C6E7E81F37DCA25A949EC9000 读取记录: send:00B2041400 recv:70488F0103920433DFA0159F3201039F4701039F482A7523A98A790DCBAAF8E3771B9584942288691B3813C5FBBFDF4BF06C2664A3B4DC1106E8CF90E96EFEC39F49039F37049F4A01829000 读取记录: send:00B2091400 recv:70465F24032210315F25031210185A0862148342700002449F0702FF008E0C000000000000000042031E039F0D05D8609CA8009F0E0500100000009F0F05D8689CF8005F280201569000 读取记录: send:00B20A1400 recv:708193938190794DDFB6EF2B5C8849C9900315CE0DB4F7E8F8BDEC674BEAE0BC19D50149316CF36337E62AE3E92F98A0300FD2DA8CEAE31FBEE5E7013CC3AB31EB9AA136659E53906E83C06421123A5DABF6A5B3D283E2AB0D8CCB598390D3F3DED42A8B3CB517BFC24BD52957EAD943DAC0EFA69C6843EAEE57EDC271854E357B8DB4C09C10D9375C349BCBD7818F699C7689C4B9A19000 &nbsp; &nbsp; 读取记录: send:00B20B1400 recv:7081949F46819079D536285A08A1E179FB62C23AD67D84A9F252E5540B0378EC25F9087DBFABA30F3BC7301A36E64271A3441051814FC3B21ABDB778223E2C8EFBCAA2C88EEA225AF7F8B2CA3E457EDB067DED077CB7909A72F7170CA43F80AB913384157FAADF400DF6E4E9A783FEBDDB780BF8886688CA32FE5363088AC951FB5DF0D33AF4F5B799D0441AFD821D876F1AD63A80C1809000 读取记录: send:00B2013400 recv:70819D9F4B81906E550C4CFE23FE956BB65807531F77806154C8B073C229692D06E9560CAB83AAD2F2FCB83E715A5392B3D820B288F693CDF5EED96B7339059C05CA3EB2E183E48354D609757BD89D754C9F6D9795EB2B1F8808F0EC4F92BC42CDEDACAF4F414ABC0675F6BD973BFC152D22E6703BB65351D7C7A6D9154A91B41A3B9D146562F32A2A67EA6ED8ACB6D944668A6C7782149F5D060000000000759000 读取记录: send:00B2012C00 recv:70099F74064543433030319000 &nbsp; 脱机数据认证.. 卡处理结束 脱机数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然后用这个公钥来验证IC卡的动态签名。&nbsp; １.通过从用户卡获取的索引和RID，终端能够确认并取得存放在终端的认证中心公钥的模，指数和与密钥相关的信息，以及将使用的相应算法。如果终端没有存储与这个索引及RID相关联的密钥，那么脱机数据认证失败 ； ２.用认证中心公钥对从用户卡获取的发卡行公钥证书中恢复出发卡行公钥，并进行格式及哈希校验； ３.用发卡行公钥对从用户卡获取的IC卡公钥证书中恢复出IC卡公钥，并进行格式及哈希校验； ４.用IC卡公钥对从用户卡获取的动态签名中恢复出动态数据，并进行格式及哈希校验； 完整指令和数据如下： ----------------------------------------------------------------------------------------------------------- 通用指令--选择QPBOC应用 00A404000E325041592E5359532E4444463031 6F30840E325041592E5359532E4444463031A51EBF0C1B61194F08A000000333010101500A50424F432044454249548701019000 ----------------------------------------------------------------------------------------------------------- 通用指令--选择电子现金AID 00A4040008A000000333010101 6F548408A000000333010101A548500A50424F432044454249548701019F38189F66049F02069F03069F1A0295055F2A029A039C019F37045F2D027A689F1101019F120A50424F43204445424954BF0C059F4D020B0A9000 ----------------------------------------------------------------------------------------------------------- 通用指令--读电子现金余额 80CA9F7900 9F79060000000002479000 ----------------------------------------------------------------------------------------------------------- 添加指令--GPO指令 80A800002383212A000000000000000001000000000000015600000000000156131111001915270200 7781DB82027C00940810020300180104019F360201C89F2608F60D0DF4E5AB42619F100F07110103900000010601000000024657136217876300000144401D22102201000029300F5F3401019F4B8180E3CF2D39C54236139C74D2D15D344491AF55B12D994E2A65945A3784FCCD6B6F613687A9F01E59AE958004683027686BF9876CDA9D931FA26B86A3FC0932B81438464969EAA75D1294D2D50EF25CCD854B7E8CECC8834EE2624658BAA78B9276DD829A82E538340C57330262F04DF5D488ACFE4AD5371478882BC53AF90A034E9F6C0200009F5D060000000002469000 ----------------------------------------------------------------------------------------------------------- 添加指令--根据AFL读取记录 00B2031400 70379F3201039224FF3685821C5BCDDC1C8DD348084CF3AF6F5080BD4445D630BFA0006649EC3289E574BDC58F01039F4701039F49039F37049000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2021400 7081B39081B0551593050C8A8252F4C27289B1F48DA4C3B254318B58F863A1C8A6E5F8A0FE7C258AE433E5C90CABF09BEA86B106E849D360BE72FCC4CA6C9AC3E48464F2A3515D7649B5D55FCC5A4D56ECF40178ED36E6C6DAFBAC71C6DAFD9AF5EBB7F7298B422893D65AA9B325B1FA ----------------------------------------------------------------------------------------------------------- D37081BFED1C0D3A4A2A3B6EF7E2AC7219345B376D3B6C42A3C7E00B92BAB2ED6CC575A288429000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2011C00 70425F24032210315A0A6217876300000144401F9F0702FF008E0C00000000000000005E031F009F0D05D8603CA8009F0E0500108000009F0F05D8683CF8005F280201569000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2021C00 70559F4A01828C1B9F02069F03069F1A0295055F2A029A039C019F37049F21039F4E148D1D8A029F02069F03069F1A0295055F2A029A039C019F37049F21039F4E149F420201565F300202209F080200205F25031210169000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2031C00 7081BD9F4681B08377E6C2F9CCA0E0D4831348875022E973FFF4B9A1D1485BD13BEADF8980064BC2DBB8AA942EDF4F656476B8E48A4D23B386D219473F3B37AA1947CD06615C330EC6E3A7ACD9FCD11D2A1EDAA099C2CA96F3D85CFAB6063DCD2C41B185DF734E6F24C78AC275AA810C84D472DAD6FFC81BB329DEB82ABB36CFF489DBD53D4FB76CFAE8F12B0FA089631206E362AEEF1FC6F1A7AF3B94B54759178146E6DBE0F8EE7B7CEC67D80D880D0789C5BA72657E9F74064543433030319000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2041C00 7081B39381B03083906618D04895A44F87F5896AC200BF5E9E96CAC576921F93F813C0C85E5680DCFEEEAB780277A5C87014C89C92B656BBCB929472FA4B45C9789BCB505454DC668B98156493314AD61DDF0EB4934CE6E3827E3D9BB0A10A3AA5ED0B2FD686446DBA89CDCCA4AB9EFDC776D627040BFAA2C18EF796E07D4053502927C57C8D6F51A3D4A1B6D7225D869147A520F922138FAE233FED1875F640D1AFF4480AB9B5EB9CDDE7BB15A1728C341BD253C54D9000 ----------------------------------------------------------------------------------------------------------- 通用指令--读电子现金余额 80CA9F7900 9F79060000000002469000 ----------------------------------------------------------------------------------------------------------- 阅读更多" />
<meta property="og:description" content="qPBOC基本信息数据采用TLV（tag-length-value）的表示方式，即每项由tag标签(T)，长度(L)和取值(V)构成。 标签： 　　tag标签的属性为bit，由16进制表示，占1～2个字节长度。若tag标签的第一个字节（注：字节排序方向为从左往右数(b8~b0)，第一个字节即为最左边的字节。bit排序规则同理。）的后四个bit为“1111”，则说明该tag占两个字节，例如“9F33”；否则占一个字节，例如“95”。b8和b7两位标识tag所属类别.&nbsp;这个可以暂时不用理.&nbsp;&nbsp;b6决定当前的TLV数据是一个单一的数据和复合结构的数据.&nbsp;复合的TLV是指value域里也包含一个或多个TLV,&nbsp;类似嵌套的编码格式.&nbsp;b5~b1如果全为1，则说明这个tag下面还有一个子字节.&nbsp;占两个字节,&nbsp;否则tag占一个字节。 长度： 　　长度（即L本身）的属性也为bit，占1～3个字节长度。具体编码规则如下： 　　a)当L字段最左边字节的最左bit位（即bit8）为0，表示该L字段占一个字节，它的后续7个bit位（即bit7～bit1）表示取值的长度，采用二进制数表示取值长度的十进制数。 　　b)当L字段最左边字节的最左bit位（即bit8）为1，表示该L字段不止占一个字节，那么它到底占几个字节由该最左字节的后续7个bit位（即bit7～bit1）的十进制取值表示。例如，若最左字节为10000010，表示L字段除该字节外，后面还有两个字节。其后续字节的十进制取值表示取值的长度。 银联卡QPBOC处理流程及数据分析。。。 银联卡处理 交易金额确定 检查IC卡参数 选择QPBOC目录 AID选应用: send:00A404000E&nbsp;325041592E5359532E4444463031 recv: 6F&nbsp;30//FCI模板 84&nbsp;0E&nbsp;325041592E5359532E4444463031 A5&nbsp;1E&nbsp;//FCI专有模板 BF0C&nbsp;1B//模板,文件控制信息(FCI)专有数据 61&nbsp;19//模板 4F&nbsp;08&nbsp;A000000333010101//应用标示符(AID) 50&nbsp;0A&nbsp;50424F43204445424954//应用标签 87&nbsp;01&nbsp;01//应用优先指示器 9000 卡片校验 终端IC卡参数检查 rcode=0x00 选择ICPParm.TVL9F06 AID选应用: send:00A4040008&nbsp;A000000333010101 recv: 6F&nbsp;36//FCI模板 84&nbsp;08&nbsp;A000000333010101//专有(DF)文件名称 A5&nbsp;2A&nbsp;//FCI专有模板 50&nbsp;0A&nbsp;50424F43204445424954//应用标签 87&nbsp;01&nbsp;01//应用优先指示器 9F38&nbsp;18&nbsp;//处理选项数据对象列表PDOL //PDOL中的标签 9F66&nbsp;04//终端交易属性 9F02&nbsp;06&nbsp;//授权金额 9F03&nbsp;06&nbsp;//其他金额 9F1A&nbsp;02&nbsp;//国家代码 95&nbsp;05&nbsp;//终端验证结果TVR 5F2A&nbsp;02//交易货币代码 9A&nbsp;03&nbsp;//交易日期 9C&nbsp;01//交易类型 9F37&nbsp;04//不可预知数 9000 &nbsp; rcode=0x9000 交易扣钱 读取余额 send:80CA9F7900 recv:9F79&nbsp;06&nbsp;000000000076 9000 &nbsp; GPO前准备工作 &nbsp; 发送GPO命令 send:80A80000238321 2A000000//PDOL中的终端交易属性9F66 000000000001 //授权金额 000000000000 //其他金额 0156//国家代码 0000000000//终端验证结果TVR 0156//交易货币代码 131111//交易日期 00//交易类型 35383F5B//不可预知数 00 recv: 77&nbsp;5A//模板 82&nbsp;02&nbsp;7C00 //应用交互特征AIP 9F36&nbsp;02&nbsp;0075//应用交易计数器ATC 9F10&nbsp;13&nbsp;07010103900000010A010000000075C5B41C32//发卡行应用数据 9F26&nbsp;08&nbsp;B5D1C169FA969D76//应用密文AC 9F6C&nbsp;02&nbsp;0000 57&nbsp;13&nbsp;6214834270000244D22102200484900826610F//磁条2等效数据，卡BIn 5F34&nbsp;01&nbsp;00//应用PAN序列号 94&nbsp;10//应用文件定位器(AFL) 10&nbsp;03&nbsp;04&nbsp;00&nbsp;&nbsp;//读取文件10的第3条到第4条记录 10 09 0B 01 //读取文件10的第9条到0B条，即09，0A，0B 30 01 01 00 //读取文件30的第1条 28 01 01 00//读取文件28的第1条 &nbsp; 9000 &nbsp; TLV数据解析 &nbsp; 卡bin号检查 &nbsp; 根据AFL文件定位器读取相关文件 读取记录: send:00B2031400 recv:7081B39081B0A33373F56850C06B1DE59D93F4F2A362CEA2A57C37D5DC78E3BF84914B608A43ACD22539B6C0491E88652244D2A199E6516D0C6F3C632F65202561106420FA406F530AE8D39CAF6EA5730E4A5AB15763FB42EAFA0AEE69A9E69640642E29CA15D5449B7AB74411A50EF811ACDEF4D8F93004C423E77E55AC263DA89308FCC05E3E0AA599565590C83CCE7FF6B17602F1BD7DB22C48A5A039FB97C48A8FA16083CC56DD6FEC3C6E7E81F37DCA25A949EC9000 读取记录: send:00B2041400 recv:70488F0103920433DFA0159F3201039F4701039F482A7523A98A790DCBAAF8E3771B9584942288691B3813C5FBBFDF4BF06C2664A3B4DC1106E8CF90E96EFEC39F49039F37049F4A01829000 读取记录: send:00B2091400 recv:70465F24032210315F25031210185A0862148342700002449F0702FF008E0C000000000000000042031E039F0D05D8609CA8009F0E0500100000009F0F05D8689CF8005F280201569000 读取记录: send:00B20A1400 recv:708193938190794DDFB6EF2B5C8849C9900315CE0DB4F7E8F8BDEC674BEAE0BC19D50149316CF36337E62AE3E92F98A0300FD2DA8CEAE31FBEE5E7013CC3AB31EB9AA136659E53906E83C06421123A5DABF6A5B3D283E2AB0D8CCB598390D3F3DED42A8B3CB517BFC24BD52957EAD943DAC0EFA69C6843EAEE57EDC271854E357B8DB4C09C10D9375C349BCBD7818F699C7689C4B9A19000 &nbsp; &nbsp; 读取记录: send:00B20B1400 recv:7081949F46819079D536285A08A1E179FB62C23AD67D84A9F252E5540B0378EC25F9087DBFABA30F3BC7301A36E64271A3441051814FC3B21ABDB778223E2C8EFBCAA2C88EEA225AF7F8B2CA3E457EDB067DED077CB7909A72F7170CA43F80AB913384157FAADF400DF6E4E9A783FEBDDB780BF8886688CA32FE5363088AC951FB5DF0D33AF4F5B799D0441AFD821D876F1AD63A80C1809000 读取记录: send:00B2013400 recv:70819D9F4B81906E550C4CFE23FE956BB65807531F77806154C8B073C229692D06E9560CAB83AAD2F2FCB83E715A5392B3D820B288F693CDF5EED96B7339059C05CA3EB2E183E48354D609757BD89D754C9F6D9795EB2B1F8808F0EC4F92BC42CDEDACAF4F414ABC0675F6BD973BFC152D22E6703BB65351D7C7A6D9154A91B41A3B9D146562F32A2A67EA6ED8ACB6D944668A6C7782149F5D060000000000759000 读取记录: send:00B2012C00 recv:70099F74064543433030319000 &nbsp; 脱机数据认证.. 卡处理结束 脱机数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然后用这个公钥来验证IC卡的动态签名。&nbsp; １.通过从用户卡获取的索引和RID，终端能够确认并取得存放在终端的认证中心公钥的模，指数和与密钥相关的信息，以及将使用的相应算法。如果终端没有存储与这个索引及RID相关联的密钥，那么脱机数据认证失败 ； ２.用认证中心公钥对从用户卡获取的发卡行公钥证书中恢复出发卡行公钥，并进行格式及哈希校验； ３.用发卡行公钥对从用户卡获取的IC卡公钥证书中恢复出IC卡公钥，并进行格式及哈希校验； ４.用IC卡公钥对从用户卡获取的动态签名中恢复出动态数据，并进行格式及哈希校验； 完整指令和数据如下： ----------------------------------------------------------------------------------------------------------- 通用指令--选择QPBOC应用 00A404000E325041592E5359532E4444463031 6F30840E325041592E5359532E4444463031A51EBF0C1B61194F08A000000333010101500A50424F432044454249548701019000 ----------------------------------------------------------------------------------------------------------- 通用指令--选择电子现金AID 00A4040008A000000333010101 6F548408A000000333010101A548500A50424F432044454249548701019F38189F66049F02069F03069F1A0295055F2A029A039C019F37045F2D027A689F1101019F120A50424F43204445424954BF0C059F4D020B0A9000 ----------------------------------------------------------------------------------------------------------- 通用指令--读电子现金余额 80CA9F7900 9F79060000000002479000 ----------------------------------------------------------------------------------------------------------- 添加指令--GPO指令 80A800002383212A000000000000000001000000000000015600000000000156131111001915270200 7781DB82027C00940810020300180104019F360201C89F2608F60D0DF4E5AB42619F100F07110103900000010601000000024657136217876300000144401D22102201000029300F5F3401019F4B8180E3CF2D39C54236139C74D2D15D344491AF55B12D994E2A65945A3784FCCD6B6F613687A9F01E59AE958004683027686BF9876CDA9D931FA26B86A3FC0932B81438464969EAA75D1294D2D50EF25CCD854B7E8CECC8834EE2624658BAA78B9276DD829A82E538340C57330262F04DF5D488ACFE4AD5371478882BC53AF90A034E9F6C0200009F5D060000000002469000 ----------------------------------------------------------------------------------------------------------- 添加指令--根据AFL读取记录 00B2031400 70379F3201039224FF3685821C5BCDDC1C8DD348084CF3AF6F5080BD4445D630BFA0006649EC3289E574BDC58F01039F4701039F49039F37049000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2021400 7081B39081B0551593050C8A8252F4C27289B1F48DA4C3B254318B58F863A1C8A6E5F8A0FE7C258AE433E5C90CABF09BEA86B106E849D360BE72FCC4CA6C9AC3E48464F2A3515D7649B5D55FCC5A4D56ECF40178ED36E6C6DAFBAC71C6DAFD9AF5EBB7F7298B422893D65AA9B325B1FA ----------------------------------------------------------------------------------------------------------- D37081BFED1C0D3A4A2A3B6EF7E2AC7219345B376D3B6C42A3C7E00B92BAB2ED6CC575A288429000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2011C00 70425F24032210315A0A6217876300000144401F9F0702FF008E0C00000000000000005E031F009F0D05D8603CA8009F0E0500108000009F0F05D8683CF8005F280201569000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2021C00 70559F4A01828C1B9F02069F03069F1A0295055F2A029A039C019F37049F21039F4E148D1D8A029F02069F03069F1A0295055F2A029A039C019F37049F21039F4E149F420201565F300202209F080200205F25031210169000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2031C00 7081BD9F4681B08377E6C2F9CCA0E0D4831348875022E973FFF4B9A1D1485BD13BEADF8980064BC2DBB8AA942EDF4F656476B8E48A4D23B386D219473F3B37AA1947CD06615C330EC6E3A7ACD9FCD11D2A1EDAA099C2CA96F3D85CFAB6063DCD2C41B185DF734E6F24C78AC275AA810C84D472DAD6FFC81BB329DEB82ABB36CFF489DBD53D4FB76CFAE8F12B0FA089631206E362AEEF1FC6F1A7AF3B94B54759178146E6DBE0F8EE7B7CEC67D80D880D0789C5BA72657E9F74064543433030319000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2041C00 7081B39381B03083906618D04895A44F87F5896AC200BF5E9E96CAC576921F93F813C0C85E5680DCFEEEAB780277A5C87014C89C92B656BBCB929472FA4B45C9789BCB505454DC668B98156493314AD61DDF0EB4934CE6E3827E3D9BB0A10A3AA5ED0B2FD686446DBA89CDCCA4AB9EFDC776D627040BFAA2C18EF796E07D4053502927C57C8D6F51A3D4A1B6D7225D869147A520F922138FAE233FED1875F640D1AFF4480AB9B5EB9CDDE7BB15A1728C341BD253C54D9000 ----------------------------------------------------------------------------------------------------------- 通用指令--读电子现金余额 80CA9F7900 9F79060000000002469000 ----------------------------------------------------------------------------------------------------------- 阅读更多" />
<link rel="canonical" href="https://mlh.app/2014/04/16/ddc4e742186c0b0b20c82db3f0b7b49f.html" />
<meta property="og:url" content="https://mlh.app/2014/04/16/ddc4e742186c0b0b20c82db3f0b7b49f.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-04-16T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"qPBOC基本信息数据采用TLV（tag-length-value）的表示方式，即每项由tag标签(T)，长度(L)和取值(V)构成。 标签： 　　tag标签的属性为bit，由16进制表示，占1～2个字节长度。若tag标签的第一个字节（注：字节排序方向为从左往右数(b8~b0)，第一个字节即为最左边的字节。bit排序规则同理。）的后四个bit为“1111”，则说明该tag占两个字节，例如“9F33”；否则占一个字节，例如“95”。b8和b7两位标识tag所属类别.&nbsp;这个可以暂时不用理.&nbsp;&nbsp;b6决定当前的TLV数据是一个单一的数据和复合结构的数据.&nbsp;复合的TLV是指value域里也包含一个或多个TLV,&nbsp;类似嵌套的编码格式.&nbsp;b5~b1如果全为1，则说明这个tag下面还有一个子字节.&nbsp;占两个字节,&nbsp;否则tag占一个字节。 长度： 　　长度（即L本身）的属性也为bit，占1～3个字节长度。具体编码规则如下： 　　a)当L字段最左边字节的最左bit位（即bit8）为0，表示该L字段占一个字节，它的后续7个bit位（即bit7～bit1）表示取值的长度，采用二进制数表示取值长度的十进制数。 　　b)当L字段最左边字节的最左bit位（即bit8）为1，表示该L字段不止占一个字节，那么它到底占几个字节由该最左字节的后续7个bit位（即bit7～bit1）的十进制取值表示。例如，若最左字节为10000010，表示L字段除该字节外，后面还有两个字节。其后续字节的十进制取值表示取值的长度。 银联卡QPBOC处理流程及数据分析。。。 银联卡处理 交易金额确定 检查IC卡参数 选择QPBOC目录 AID选应用: send:00A404000E&nbsp;325041592E5359532E4444463031 recv: 6F&nbsp;30//FCI模板 84&nbsp;0E&nbsp;325041592E5359532E4444463031 A5&nbsp;1E&nbsp;//FCI专有模板 BF0C&nbsp;1B//模板,文件控制信息(FCI)专有数据 61&nbsp;19//模板 4F&nbsp;08&nbsp;A000000333010101//应用标示符(AID) 50&nbsp;0A&nbsp;50424F43204445424954//应用标签 87&nbsp;01&nbsp;01//应用优先指示器 9000 卡片校验 终端IC卡参数检查 rcode=0x00 选择ICPParm.TVL9F06 AID选应用: send:00A4040008&nbsp;A000000333010101 recv: 6F&nbsp;36//FCI模板 84&nbsp;08&nbsp;A000000333010101//专有(DF)文件名称 A5&nbsp;2A&nbsp;//FCI专有模板 50&nbsp;0A&nbsp;50424F43204445424954//应用标签 87&nbsp;01&nbsp;01//应用优先指示器 9F38&nbsp;18&nbsp;//处理选项数据对象列表PDOL //PDOL中的标签 9F66&nbsp;04//终端交易属性 9F02&nbsp;06&nbsp;//授权金额 9F03&nbsp;06&nbsp;//其他金额 9F1A&nbsp;02&nbsp;//国家代码 95&nbsp;05&nbsp;//终端验证结果TVR 5F2A&nbsp;02//交易货币代码 9A&nbsp;03&nbsp;//交易日期 9C&nbsp;01//交易类型 9F37&nbsp;04//不可预知数 9000 &nbsp; rcode=0x9000 交易扣钱 读取余额 send:80CA9F7900 recv:9F79&nbsp;06&nbsp;000000000076 9000 &nbsp; GPO前准备工作 &nbsp; 发送GPO命令 send:80A80000238321 2A000000//PDOL中的终端交易属性9F66 000000000001 //授权金额 000000000000 //其他金额 0156//国家代码 0000000000//终端验证结果TVR 0156//交易货币代码 131111//交易日期 00//交易类型 35383F5B//不可预知数 00 recv: 77&nbsp;5A//模板 82&nbsp;02&nbsp;7C00 //应用交互特征AIP 9F36&nbsp;02&nbsp;0075//应用交易计数器ATC 9F10&nbsp;13&nbsp;07010103900000010A010000000075C5B41C32//发卡行应用数据 9F26&nbsp;08&nbsp;B5D1C169FA969D76//应用密文AC 9F6C&nbsp;02&nbsp;0000 57&nbsp;13&nbsp;6214834270000244D22102200484900826610F//磁条2等效数据，卡BIn 5F34&nbsp;01&nbsp;00//应用PAN序列号 94&nbsp;10//应用文件定位器(AFL) 10&nbsp;03&nbsp;04&nbsp;00&nbsp;&nbsp;//读取文件10的第3条到第4条记录 10 09 0B 01 //读取文件10的第9条到0B条，即09，0A，0B 30 01 01 00 //读取文件30的第1条 28 01 01 00//读取文件28的第1条 &nbsp; 9000 &nbsp; TLV数据解析 &nbsp; 卡bin号检查 &nbsp; 根据AFL文件定位器读取相关文件 读取记录: send:00B2031400 recv:7081B39081B0A33373F56850C06B1DE59D93F4F2A362CEA2A57C37D5DC78E3BF84914B608A43ACD22539B6C0491E88652244D2A199E6516D0C6F3C632F65202561106420FA406F530AE8D39CAF6EA5730E4A5AB15763FB42EAFA0AEE69A9E69640642E29CA15D5449B7AB74411A50EF811ACDEF4D8F93004C423E77E55AC263DA89308FCC05E3E0AA599565590C83CCE7FF6B17602F1BD7DB22C48A5A039FB97C48A8FA16083CC56DD6FEC3C6E7E81F37DCA25A949EC9000 读取记录: send:00B2041400 recv:70488F0103920433DFA0159F3201039F4701039F482A7523A98A790DCBAAF8E3771B9584942288691B3813C5FBBFDF4BF06C2664A3B4DC1106E8CF90E96EFEC39F49039F37049F4A01829000 读取记录: send:00B2091400 recv:70465F24032210315F25031210185A0862148342700002449F0702FF008E0C000000000000000042031E039F0D05D8609CA8009F0E0500100000009F0F05D8689CF8005F280201569000 读取记录: send:00B20A1400 recv:708193938190794DDFB6EF2B5C8849C9900315CE0DB4F7E8F8BDEC674BEAE0BC19D50149316CF36337E62AE3E92F98A0300FD2DA8CEAE31FBEE5E7013CC3AB31EB9AA136659E53906E83C06421123A5DABF6A5B3D283E2AB0D8CCB598390D3F3DED42A8B3CB517BFC24BD52957EAD943DAC0EFA69C6843EAEE57EDC271854E357B8DB4C09C10D9375C349BCBD7818F699C7689C4B9A19000 &nbsp; &nbsp; 读取记录: send:00B20B1400 recv:7081949F46819079D536285A08A1E179FB62C23AD67D84A9F252E5540B0378EC25F9087DBFABA30F3BC7301A36E64271A3441051814FC3B21ABDB778223E2C8EFBCAA2C88EEA225AF7F8B2CA3E457EDB067DED077CB7909A72F7170CA43F80AB913384157FAADF400DF6E4E9A783FEBDDB780BF8886688CA32FE5363088AC951FB5DF0D33AF4F5B799D0441AFD821D876F1AD63A80C1809000 读取记录: send:00B2013400 recv:70819D9F4B81906E550C4CFE23FE956BB65807531F77806154C8B073C229692D06E9560CAB83AAD2F2FCB83E715A5392B3D820B288F693CDF5EED96B7339059C05CA3EB2E183E48354D609757BD89D754C9F6D9795EB2B1F8808F0EC4F92BC42CDEDACAF4F414ABC0675F6BD973BFC152D22E6703BB65351D7C7A6D9154A91B41A3B9D146562F32A2A67EA6ED8ACB6D944668A6C7782149F5D060000000000759000 读取记录: send:00B2012C00 recv:70099F74064543433030319000 &nbsp; 脱机数据认证.. 卡处理结束 脱机数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然后用这个公钥来验证IC卡的动态签名。&nbsp; １.通过从用户卡获取的索引和RID，终端能够确认并取得存放在终端的认证中心公钥的模，指数和与密钥相关的信息，以及将使用的相应算法。如果终端没有存储与这个索引及RID相关联的密钥，那么脱机数据认证失败 ； ２.用认证中心公钥对从用户卡获取的发卡行公钥证书中恢复出发卡行公钥，并进行格式及哈希校验； ３.用发卡行公钥对从用户卡获取的IC卡公钥证书中恢复出IC卡公钥，并进行格式及哈希校验； ４.用IC卡公钥对从用户卡获取的动态签名中恢复出动态数据，并进行格式及哈希校验； 完整指令和数据如下： ----------------------------------------------------------------------------------------------------------- 通用指令--选择QPBOC应用 00A404000E325041592E5359532E4444463031 6F30840E325041592E5359532E4444463031A51EBF0C1B61194F08A000000333010101500A50424F432044454249548701019000 ----------------------------------------------------------------------------------------------------------- 通用指令--选择电子现金AID 00A4040008A000000333010101 6F548408A000000333010101A548500A50424F432044454249548701019F38189F66049F02069F03069F1A0295055F2A029A039C019F37045F2D027A689F1101019F120A50424F43204445424954BF0C059F4D020B0A9000 ----------------------------------------------------------------------------------------------------------- 通用指令--读电子现金余额 80CA9F7900 9F79060000000002479000 ----------------------------------------------------------------------------------------------------------- 添加指令--GPO指令 80A800002383212A000000000000000001000000000000015600000000000156131111001915270200 7781DB82027C00940810020300180104019F360201C89F2608F60D0DF4E5AB42619F100F07110103900000010601000000024657136217876300000144401D22102201000029300F5F3401019F4B8180E3CF2D39C54236139C74D2D15D344491AF55B12D994E2A65945A3784FCCD6B6F613687A9F01E59AE958004683027686BF9876CDA9D931FA26B86A3FC0932B81438464969EAA75D1294D2D50EF25CCD854B7E8CECC8834EE2624658BAA78B9276DD829A82E538340C57330262F04DF5D488ACFE4AD5371478882BC53AF90A034E9F6C0200009F5D060000000002469000 ----------------------------------------------------------------------------------------------------------- 添加指令--根据AFL读取记录 00B2031400 70379F3201039224FF3685821C5BCDDC1C8DD348084CF3AF6F5080BD4445D630BFA0006649EC3289E574BDC58F01039F4701039F49039F37049000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2021400 7081B39081B0551593050C8A8252F4C27289B1F48DA4C3B254318B58F863A1C8A6E5F8A0FE7C258AE433E5C90CABF09BEA86B106E849D360BE72FCC4CA6C9AC3E48464F2A3515D7649B5D55FCC5A4D56ECF40178ED36E6C6DAFBAC71C6DAFD9AF5EBB7F7298B422893D65AA9B325B1FA ----------------------------------------------------------------------------------------------------------- D37081BFED1C0D3A4A2A3B6EF7E2AC7219345B376D3B6C42A3C7E00B92BAB2ED6CC575A288429000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2011C00 70425F24032210315A0A6217876300000144401F9F0702FF008E0C00000000000000005E031F009F0D05D8603CA8009F0E0500108000009F0F05D8683CF8005F280201569000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2021C00 70559F4A01828C1B9F02069F03069F1A0295055F2A029A039C019F37049F21039F4E148D1D8A029F02069F03069F1A0295055F2A029A039C019F37049F21039F4E149F420201565F300202209F080200205F25031210169000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2031C00 7081BD9F4681B08377E6C2F9CCA0E0D4831348875022E973FFF4B9A1D1485BD13BEADF8980064BC2DBB8AA942EDF4F656476B8E48A4D23B386D219473F3B37AA1947CD06615C330EC6E3A7ACD9FCD11D2A1EDAA099C2CA96F3D85CFAB6063DCD2C41B185DF734E6F24C78AC275AA810C84D472DAD6FFC81BB329DEB82ABB36CFF489DBD53D4FB76CFAE8F12B0FA089631206E362AEEF1FC6F1A7AF3B94B54759178146E6DBE0F8EE7B7CEC67D80D880D0789C5BA72657E9F74064543433030319000 ----------------------------------------------------------------------------------------------------------- 添加指令-- 00B2041C00 7081B39381B03083906618D04895A44F87F5896AC200BF5E9E96CAC576921F93F813C0C85E5680DCFEEEAB780277A5C87014C89C92B656BBCB929472FA4B45C9789BCB505454DC668B98156493314AD61DDF0EB4934CE6E3827E3D9BB0A10A3AA5ED0B2FD686446DBA89CDCCA4AB9EFDC776D627040BFAA2C18EF796E07D4053502927C57C8D6F51A3D4A1B6D7225D869147A520F922138FAE233FED1875F640D1AFF4480AB9B5EB9CDDE7BB15A1728C341BD253C54D9000 ----------------------------------------------------------------------------------------------------------- 通用指令--读电子现金余额 80CA9F7900 9F79060000000002469000 ----------------------------------------------------------------------------------------------------------- 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2014/04/16/ddc4e742186c0b0b20c82db3f0b7b49f.html","headline":"银联卡QPBOC处理流程及数据分析","dateModified":"2014-04-16T00:00:00+08:00","datePublished":"2014-04-16T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2014/04/16/ddc4e742186c0b0b20c82db3f0b7b49f.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>银联卡QPBOC处理流程及数据分析</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="background-color:inherit;font-family:'微软雅黑';"> <span style="background-color:inherit;font-family:'宋体';"><span style="font-size:14px;"><span style="font-family:Arial;">qPBOC</span><span style="font-family:'宋体';">基本信息数据采用</span><span style="font-family:Arial;">TLV</span><span style="font-family:'宋体';">（</span><span style="font-family:Arial;">tag-length-value</span><span style="font-family:'宋体';">）的表示方式，即每项由</span><span style="font-family:Arial;">tag</span><span style="font-family:'宋体';">标签</span><span style="font-family:Arial;">(T)</span><span style="font-family:'宋体';">，长度</span><span style="font-family:Arial;">(L)</span><span style="font-family:'宋体';">和取值</span><span style="font-family:Arial;">(V)</span><span style="font-family:'宋体';">构成。</span></span><br></span></p> 
  <p style="background-color:inherit;"><span style="background-color:inherit;"><span style="font-size:14px;"></span></span></p> 
  <p style="font-family:'宋体';vertical-align:baseline;"> <span style="font-family:'宋体';">标签：</span><span style="font-family:Arial;"></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';">　　</span><span style="font-family:Arial;">tag</span><span style="font-family:'宋体';">标签的属性为</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">，由</span><span style="font-family:Arial;">16</span><span style="font-family:'宋体';">进制表示，占</span><span style="font-family:Arial;">1</span><span style="font-family:'宋体';">～</span><span style="font-family:Arial;">2</span><span style="font-family:'宋体';">个字节长度。若</span><span style="font-family:Arial;">tag</span><span style="font-family:'宋体';">标签的第一个字节（注：字节排序方向为从左往右数(b8~b0)，第一个字节即为最左边的字节。</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">排序规则同理。）的后四个</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">为“</span><span style="font-family:Arial;">1111</span><span style="font-family:Arial;">”，则说明该</span><span style="font-family:Arial;">tag</span><span style="font-family:'宋体';">占两个字节，例如“</span><span style="font-family:Arial;">9F33</span><span style="font-family:Arial;">”；否则占一个字节，例如“</span><span style="font-family:Arial;">95</span><span style="font-family:Arial;">”。</span><span style="font-family:Arial;background-color:inherit;">b8</span><span style="background-color:inherit;font-family:'宋体';">和</span><span style="font-family:Arial;background-color:inherit;">b7</span><span style="background-color:inherit;font-family:'宋体';">两位标识</span><span style="font-family:Arial;background-color:inherit;">tag</span><span style="background-color:inherit;font-family:'宋体';">所属类别</span><span style="font-family:Arial;background-color:inherit;">.&nbsp;</span><span style="background-color:inherit;font-family:'宋体';">这个可以暂时不用理</span><span style="font-family:Arial;background-color:inherit;">.&nbsp;&nbsp;b6</span><span style="background-color:inherit;font-family:'宋体';">决定当前的</span><span style="font-family:Arial;background-color:inherit;">TLV</span><span style="background-color:inherit;font-family:'宋体';">数据是一个单一的数据和复合结构的数据</span><span style="font-family:Arial;background-color:inherit;">.&nbsp;</span><span style="background-color:inherit;font-family:'宋体';">复合的</span><span style="font-family:Arial;background-color:inherit;">TLV</span><span style="background-color:inherit;font-family:'宋体';">是指</span><span style="font-family:Arial;background-color:inherit;">value</span><span style="background-color:inherit;font-family:'宋体';">域里也包含一个或多个</span><span style="font-family:Arial;background-color:inherit;">TLV,&nbsp;</span><span style="background-color:inherit;font-family:'宋体';">类似嵌套的编码格式</span><span style="font-family:Arial;background-color:inherit;">.&nbsp;b5~b1</span><span style="background-color:inherit;font-family:'宋体';">如果全为</span><span style="font-family:Arial;background-color:inherit;">1</span><span style="background-color:inherit;font-family:'宋体';">，则说明这个</span><span style="font-family:Arial;background-color:inherit;">tag</span><span style="background-color:inherit;font-family:'宋体';">下面还有一个子字节</span><span style="font-family:Arial;background-color:inherit;">.&nbsp;</span><span style="background-color:inherit;font-family:'宋体';">占两个字节</span><span style="font-family:Arial;background-color:inherit;">,&nbsp;</span><span style="background-color:inherit;font-family:'宋体';">否则</span><span style="font-family:Arial;background-color:inherit;">tag</span><span style="background-color:inherit;font-family:'宋体';">占一个字节</span><span style="background-color:inherit;"><span style="font-family:Arial;">。</span></span></p> 
  <p style="font-family:'宋体';vertical-align:baseline;"> <span style="font-family:'宋体';">长度：</span><span style="font-family:Arial;"></span></p> 
  <p style="font-family:'宋体';vertical-align:baseline;"> <span style="font-family:'宋体';">　　长度（即</span><span style="font-family:Arial;">L</span><span style="font-family:'宋体';">本身）的属性也为</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">，占</span><span style="font-family:Arial;">1</span><span style="font-family:'宋体';">～</span><span style="font-family:Arial;">3</span><span style="font-family:'宋体';">个字节长度。具体编码规则如下：</span></p> 
  <p style="font-family:'宋体';vertical-align:baseline;"> <span style="font-family:'宋体';">　　</span><span style="font-family:Arial;">a)</span><span style="font-family:'宋体';">当</span><span style="font-family:Arial;">L</span><span style="font-family:'宋体';">字段最左边字节的最左</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">位（即</span><span style="font-family:Arial;">bit8</span><span style="font-family:'宋体';">）为</span><span style="font-family:Arial;">0</span><span style="font-family:'宋体';">，表示该</span><span style="font-family:Arial;">L</span><span style="font-family:'宋体';">字段占一个字节，它的后续</span><span style="font-family:Arial;">7</span><span style="font-family:'宋体';">个</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">位（即</span><span style="font-family:Arial;">bit7</span><span style="font-family:'宋体';">～</span><span style="font-family:Arial;">bit1</span><span style="font-family:'宋体';">）表示取值的长度，采用二进制数表示取值长度的十进制数。</span></p> 
  <p style="font-family:'宋体';vertical-align:baseline;"> <span style="font-family:'宋体';">　　</span><span style="font-family:Arial;">b)</span><span style="font-family:'宋体';">当</span><span style="font-family:Arial;">L</span><span style="font-family:'宋体';">字段最左边字节的最左</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">位（即</span><span style="font-family:Arial;">bit8</span><span style="font-family:'宋体';">）为</span><span style="font-family:Arial;">1</span><span style="font-family:'宋体';">，表示该</span><span style="font-family:Arial;">L</span><span style="font-family:'宋体';">字段不止占一个字节，那么它到底占几个字节由该最左字节的后续</span><span style="font-family:Arial;">7</span><span style="font-family:'宋体';">个</span><span style="font-family:Arial;">bit</span><span style="font-family:'宋体';">位（即</span><span style="font-family:Arial;">bit7</span><span style="font-family:'宋体';">～</span><span style="font-family:Arial;">bit1</span><span style="font-family:'宋体';">）的十进制取值表示。例如，若最左字节为</span><span style="font-family:Arial;">10000010</span><span style="font-family:'宋体';">，表示</span><span style="font-family:Arial;">L</span><span style="font-family:'宋体';">字段除该字节外，后面还有两个字节。其后续字节的十进制取值表示取值的长度。</span><span style="font-size:20pt;font-family:Arial;"></span></p> 银联卡QPBOC处理流程及数据分析。。。
  <br>
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">银联卡处理</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">交易金额确定</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">检查</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">IC</span><span style="background-color:inherit;font-family:'宋体';">卡参数</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">选择</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">QPBOC</span><span style="background-color:inherit;font-family:'宋体';">目录</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">AID</span><span style="background-color:inherit;font-family:'宋体';">选应用</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:<span style="background-color:inherit;color:rgb(95,73,122);">00A404000E</span>&nbsp;<span style="background-color:inherit;color:#FF0000;">325041592E5359532E4444463031</span></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">6F</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">30</span>//FCI</span><span style="background-color:inherit;font-family:'宋体';">模板</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">84</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">&nbsp;0E</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;325041592E5359532E4444463031</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">A5</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">1E</span>&nbsp;//FCI</span><span style="background-color:inherit;font-family:'宋体';">专有模板</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">BF0C</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">&nbsp;1B</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">//</span><span style="background-color:inherit;font-family:'宋体';">模板</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">,</span><span style="background-color:inherit;font-family:'宋体';">文件控制信息</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">(FCI)</span><span style="background-color:inherit;font-family:'宋体';">专有数据</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">61</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">19</span>//</span><span style="background-color:inherit;font-family:'宋体';">模板</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">4F</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">08</span>&nbsp;A000000333010101//</span><span style="background-color:inherit;font-family:'宋体';">应用标示符</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">(AID)</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">50</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">&nbsp;0A</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;50424F43204445424954//</span><span style="background-color:inherit;font-family:'宋体';">应用标签</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">87</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">01&nbsp;</span>01//</span><span style="background-color:inherit;font-family:'宋体';">应用优先指示器</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">9000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">卡片校验</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">终端</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">IC</span><span style="background-color:inherit;font-family:'宋体';">卡参数检查</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">rcode=0x00</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">选择</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">ICPParm.TVL9F06</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">AID</span><span style="background-color:inherit;font-family:'宋体';">选应用</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:<span style="background-color:inherit;color:rgb(95,73,122);">00A4040008</span>&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">A000000333010101</span></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">6F</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;36//FCI</span><span style="background-color:inherit;font-family:'宋体';">模板</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">84&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">08</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;A000000333010101//</span><span style="background-color:inherit;font-family:'宋体';">专有</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">(DF)</span><span style="background-color:inherit;font-family:'宋体';">文件名称</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">A5</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">2A</span>&nbsp;//FCI</span><span style="background-color:inherit;font-family:'宋体';">专有模板</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">50</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">0A&nbsp;</span>50424F43204445424954//</span><span style="background-color:inherit;font-family:'宋体';">应用标签</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">87</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">&nbsp;01</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;01//</span><span style="background-color:inherit;font-family:'宋体';">应用优先指示器</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9F38</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">18</span>&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">处理选项数据对象列表</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">PDOL</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">//PDOL</span><span style="background-color:inherit;font-family:'宋体';">中的标签</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9F66</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">04</span>//</span><span style="background-color:inherit;font-family:'宋体';">终端交易属性</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9F02</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">06</span>&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">授权金额</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9F03</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">06</span>&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">其他金额</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9F1A</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">02</span>&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">国家代码</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">95</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">05</span>&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">终端验证结果</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">TVR</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">5F2A</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">02</span>//</span><span style="background-color:inherit;font-family:'宋体';">交易货币代码</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9A&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">03</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">交易日期</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9C</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">01</span>//</span><span style="background-color:inherit;font-family:'宋体';">交易类型</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:#FF0000;" xml:lang="en-us">9F37</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">04</span>//</span><span style="background-color:inherit;font-family:'宋体';">不可预知数</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">9000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">rcode=0x9000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">交易扣钱</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取余额</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:<span style="background-color:inherit;color:rgb(95,73,122);">80CA9F7900</span></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:<span style="background-color:inherit;color:rgb(192,0,0);">9F79</span><span style="background-color:inherit;color:rgb(31,73,125);">&nbsp;06</span>&nbsp;000000000076 9000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">GPO</span><span style="background-color:inherit;font-family:'宋体';">前准备工作</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">发送</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">GPO</span><span style="background-color:inherit;font-family:'宋体';">命令</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:<span style="background-color:inherit;color:rgb(95,73,122);">80A80000238321</span></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">2A000000//PDOL</span><span style="background-color:inherit;font-family:'宋体';">中的终端交易属性</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">9F66</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">000000000001 //</span><span style="background-color:inherit;font-family:'宋体';">授权金额</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">000000000000 //</span><span style="background-color:inherit;font-family:'宋体';">其他金额</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">0156//</span><span style="background-color:inherit;font-family:'宋体';">国家代码</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">0000000000//</span><span style="background-color:inherit;font-family:'宋体';">终端验证结果</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">TVR</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">0156//</span><span style="background-color:inherit;font-family:'宋体';">交易货币代码</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">131111//</span><span style="background-color:inherit;font-family:'宋体';">交易日期</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">00//</span><span style="background-color:inherit;font-family:'宋体';">交易类型</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">35383F5B//</span><span style="background-color:inherit;font-family:'宋体';">不可预知数</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">00</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">77</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">&nbsp;5A</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">//</span><span style="background-color:inherit;font-family:'宋体';">模板</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">82</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;<span style="background-color:inherit;color:rgb(31,73,125);">02</span>&nbsp;7C00 //</span><span style="background-color:inherit;font-family:'宋体';">应用交互特征</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">AIP</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us"></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">9F36</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">&nbsp;02</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;0075//</span><span style="background-color:inherit;font-family:'宋体';">应用交易计数器</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">ATC</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">9F10&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">13</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;07010103900000010A010000000075C5B41C32//</span><span style="background-color:inherit;font-family:'宋体';">发卡行应用数据</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">9F26&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">08</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;B5D1C169FA969D76//</span><span style="background-color:inherit;font-family:'宋体';">应用密文</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">AC</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">9F6C&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">02</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;0000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">57&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">13</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;6214834270000244D22102200484900826610F//</span><span style="background-color:inherit;font-family:'宋体';">磁条</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">2</span><span style="background-color:inherit;font-family:'宋体';">等效数据，卡</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">BIn</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">5F34&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">01</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;00//</span><span style="background-color:inherit;font-family:'宋体';">应用</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">PAN</span><span style="background-color:inherit;font-family:'宋体';">序列号</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(192,0,0);" xml:lang="en-us">94&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(31,73,125);" xml:lang="en-us">10</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">//</span><span style="background-color:inherit;font-family:'宋体';">应用文件定位器</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">(AFL)</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;color:rgb(112,48,160);" xml:lang="en-us">10&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(0,176,80);" xml:lang="en-us">03&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(0,32,96);" xml:lang="en-us">04&nbsp;</span><span lang="en-us" style="background-color:inherit;color:rgb(95,73,122);" xml:lang="en-us">00</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;&nbsp;//</span><span style="background-color:inherit;font-family:'宋体';">读取文件</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">10</span><span style="background-color:inherit;font-family:'宋体';">的第</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">3</span><span style="background-color:inherit;font-family:'宋体';">条到第</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">4</span><span style="background-color:inherit;font-family:'宋体';">条记录</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">10 09 0B 01 //</span><span style="background-color:inherit;font-family:'宋体';">读取文件</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">10</span><span style="background-color:inherit;font-family:'宋体';">的第</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">9</span><span style="background-color:inherit;font-family:'宋体';">条到</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">0B</span><span style="background-color:inherit;font-family:'宋体';">条，即</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">09</span><span style="background-color:inherit;font-family:'宋体';">，</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">0A</span><span style="background-color:inherit;font-family:'宋体';">，</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">0B</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">30 01 01 00 //</span><span style="background-color:inherit;font-family:'宋体';">读取文件</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">30</span><span style="background-color:inherit;font-family:'宋体';">的第</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">1</span><span style="background-color:inherit;font-family:'宋体';">条</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">28 01 01 00//</span><span style="background-color:inherit;font-family:'宋体';">读取文件</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">28</span><span style="background-color:inherit;font-family:'宋体';">的第</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">1</span><span style="background-color:inherit;font-family:'宋体';">条</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us"></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">9000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">TLV</span><span style="background-color:inherit;font-family:'宋体';">数据解析</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">卡</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">bin</span><span style="background-color:inherit;font-family:'宋体';">号检查</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">根据</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">AFL</span><span style="background-color:inherit;font-family:'宋体';">文件定位器读取相关文件</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:<span style="background-color:inherit;color:rgb(95,73,122);">00B2031400</span></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:7081B39081B0A33373F56850C06B1DE59D93F4F2A362CEA2A57C37D5DC78E3BF84914B608A43ACD22539B6C0491E88652244D2A199E6516D0C6F3C632F65202561106420FA406F530AE8D39CAF6EA5730E4A5AB15763FB42EAFA0AEE69A9E69640642E29CA15D5449B7AB74411A50EF811ACDEF4D8F93004C423E77E55AC263DA89308FCC05E3E0AA599565590C83CCE7FF6B17602F1BD7DB22C48A5A039FB97C48A8FA16083CC56DD6FEC3C6E7E81F37DCA25A949EC9000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:00B2041400</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:70488F0103920433DFA0159F3201039F4701039F482A7523A98A790DCBAAF8E3771B9584942288691B3813C5FBBFDF4BF06C2664A3B4DC1106E8CF90E96EFEC39F49039F37049F4A01829000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:00B2091400</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:70465F24032210315F25031210185A0862148342700002449F0702FF008E0C000000000000000042031E039F0D05D8609CA8009F0E0500100000009F0F05D8689CF8005F280201569000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:00B20A1400</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:708193938190794DDFB6EF2B5C8849C9900315CE0DB4F7E8F8BDEC674BEAE0BC19D50149316CF36337E62AE3E92F98A0300FD2DA8CEAE31FBEE5E7013CC3AB31EB9AA136659E53906E83C06421123A5DABF6A5B3D283E2AB0D8CCB598390D3F3DED42A8B3CB517BFC24BD52957EAD943DAC0EFA69C6843EAEE57EDC271854E357B8DB4C09C10D9375C349BCBD7818F699C7689C4B9A19000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:00B20B1400</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:7081949F46819079D536285A08A1E179FB62C23AD67D84A9F252E5540B0378EC25F9087DBFABA30F3BC7301A36E64271A3441051814FC3B21ABDB778223E2C8EFBCAA2C88EEA225AF7F8B2CA3E457EDB067DED077CB7909A72F7170CA43F80AB913384157FAADF400DF6E4E9A783FEBDDB780BF8886688CA32FE5363088AC951FB5DF0D33AF4F5B799D0441AFD821D876F1AD63A80C1809000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:00B2013400</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:70819D9F4B81906E550C4CFE23FE956BB65807531F77806154C8B073C229692D06E9560CAB83AAD2F2FCB83E715A5392B3D820B288F693CDF5EED96B7339059C05CA3EB2E183E48354D609757BD89D754C9F6D9795EB2B1F8808F0EC4F92BC42CDEDACAF4F414ABC0675F6BD973BFC152D22E6703BB65351D7C7A6D9154A91B41A3B9D146562F32A2A67EA6ED8ACB6D944668A6C7782149F5D060000000000759000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">读取记录</span><span lang="en-us" style="background-color:inherit;" xml:lang="en-us">:</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">send:00B2012C00</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">recv:70099F74064543433030319000</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span lang="en-us" style="background-color:inherit;" xml:lang="en-us">&nbsp;</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';">脱机数据认证..</span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';font-size:14px;"> <span style="background-color:inherit;font-family:'宋体';"><span style="font-family:'宋体';font-size:14px;">卡处理结束</span><br></span></p> 
  <p style="background-color:inherit;font-family:'微软雅黑';"> <span style="background-color:inherit;font-family:'宋体';"><span style="font-family:'宋体';"></span></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-size:14px;"><span style="font-family:'宋体';">脱机数据认证采用了一个三层的公钥证书方案。每一个</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡的签名，终端需要先通过验证两个证书来恢复和验证</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡公钥，然后用这个公钥来验证</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡的动态签名。&nbsp;</span></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-size:14px;"><span style="font-family:'宋体';"></span></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';">１</span><span style="font-family:Arial;">.</span><span style="font-family:'宋体';">通过从用户卡获取的索引和</span><span style="font-family:Arial;">RID</span><span style="font-family:'宋体';">，终端能够确认并取得存放在终端的认证中心公钥的模，指数和与密钥相关的信息，以及将使用的相应算法。如果终端没有存储与这个索引及</span><span style="font-family:Arial;">RID</span><span style="font-family:'宋体';">相关联的密钥，那么脱机数据认证失败 ；</span><span style="font-family:Arial;"></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';">２</span><span style="font-family:Arial;">.</span><span style="font-family:'宋体';">用认证中心公钥对从用户卡获取的发卡行公钥证书中恢复出发卡行公钥，并进行格式及哈希校验；</span><span style="font-family:Arial;"></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';">３</span><span style="font-family:Arial;">.</span><span style="font-family:'宋体';">用发卡行公钥对从用户卡获取的</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡公钥证书中恢复出</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡公钥，并进行格式及哈希校验；</span><span style="font-family:Arial;"></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';">４</span><span style="font-family:Arial;">.</span><span style="font-family:'宋体';">用</span><span style="font-family:Arial;">IC</span><span style="font-family:'宋体';">卡公钥对从用户卡获取的动态签名中恢复出动态数据，并进行格式及哈希校验；</span><span style="font-size:20pt;font-family:Arial;"></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';">完整指令和数据如下：</span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';"><span style="color:#6633ff;">-----------------------------------------------------------------------------------------------------------<br> 通用指令--选择QPBOC应用<br> 00A404000E325041592E5359532E4444463031<br> 6F30840E325041592E5359532E4444463031A51EBF0C1B61194F08A000000333010101500A50424F432044454249548701019000<br> -----------------------------------------------------------------------------------------------------------<br> 通用指令--选择电子现金AID<br> 00A4040008A000000333010101<br> 6F548408A000000333010101A548500A50424F432044454249548701019F38189F66049F02069F03069F1A0295055F2A029A039C019F37045F2D027A689F1101019F120A50424F43204445424954BF0C059F4D020B0A9000<br> -----------------------------------------------------------------------------------------------------------<br> 通用指令--读电子现金余额<br> 80CA9F7900<br> 9F79060000000002479000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--GPO指令<br> 80A800002383212A000000000000000001000000000000015600000000000156131111001915270200<br> 7781DB82027C00940810020300180104019F360201C89F2608F60D0DF4E5AB42619F100F07110103900000010601000000024657136217876300000144401D22102201000029300F5F3401019F4B8180E3CF2D39C54236139C74D2D15D344491AF55B12D994E2A65945A3784FCCD6B6F613687A9F01E59AE958004683027686BF9876CDA9D931FA26B86A3FC0932B81438464969EAA75D1294D2D50EF25CCD854B7E8CECC8834EE2624658BAA78B9276DD829A82E538340C57330262F04DF5D488ACFE4AD5371478882BC53AF90A034E9F6C0200009F5D060000000002469000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--根据AFL读取记录<br> 00B2031400<br> 70379F3201039224FF3685821C5BCDDC1C8DD348084CF3AF6F5080BD4445D630BFA0006649EC3289E574BDC58F01039F4701039F49039F37049000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--<br> 00B2021400<br> 7081B39081B0551593050C8A8252F4C27289B1F48DA4C3B254318B58F863A1C8A6E5F8A0FE7C258AE433E5C90CABF09BEA86B106E849D360BE72FCC4CA6C9AC3E48464F2A3515D7649B5D55FCC5A4D56ECF40178ED36E6C6DAFBAC71C6DAFD9AF5EBB7F7298B422893D65AA9B325B1FA<br> -----------------------------------------------------------------------------------------------------------<br> D37081BFED1C0D3A4A2A3B6EF7E2AC7219345B376D3B6C42A3C7E00B92BAB2ED6CC575A288429000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--<br> 00B2011C00<br> 70425F24032210315A0A6217876300000144401F9F0702FF008E0C00000000000000005E031F009F0D05D8603CA8009F0E0500108000009F0F05D8683CF8005F280201569000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--<br> 00B2021C00<br> 70559F4A01828C1B9F02069F03069F1A0295055F2A029A039C019F37049F21039F4E148D1D8A029F02069F03069F1A0295055F2A029A039C019F37049F21039F4E149F420201565F300202209F080200205F25031210169000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--<br> 00B2031C00<br> 7081BD9F4681B08377E6C2F9CCA0E0D4831348875022E973FFF4B9A1D1485BD13BEADF8980064BC2DBB8AA942EDF4F656476B8E48A4D23B386D219473F3B37AA1947CD06615C330EC6E3A7ACD9FCD11D2A1EDAA099C2CA96F3D85CFAB6063DCD2C41B185DF734E6F24C78AC275AA810C84D472DAD6FFC81BB329DEB82ABB36CFF489DBD53D4FB76CFAE8F12B0FA089631206E362AEEF1FC6F1A7AF3B94B54759178146E6DBE0F8EE7B7CEC67D80D880D0789C5BA72657E9F74064543433030319000<br> -----------------------------------------------------------------------------------------------------------<br> 添加指令--<br> 00B2041C00<br> 7081B39381B03083906618D04895A44F87F5896AC200BF5E9E96CAC576921F93F813C0C85E5680DCFEEEAB780277A5C87014C89C92B656BBCB929472FA4B45C9789BCB505454DC668B98156493314AD61DDF0EB4934CE6E3827E3D9BB0A10A3AA5ED0B2FD686446DBA89CDCCA4AB9EFDC776D627040BFAA2C18EF796E07D4053502927C57C8D6F51A3D4A1B6D7225D869147A520F922138FAE233FED1875F640D1AFF4480AB9B5EB9CDDE7BB15A1728C341BD253C54D9000<br> -----------------------------------------------------------------------------------------------------------<br> 通用指令--读电子现金余额<br> 80CA9F7900<br> 9F79060000000002469000<br> -----------------------------------------------------------------------------------------------------------</span><br></span></p> 
  <p style="vertical-align:baseline;"> <span style="font-family:'宋体';"><span style="color:#6633ff;"><br></span></span></p> 
  <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20140416164020218?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveXl6XzE5ODc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="">
  <br>
  <br> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yyz_1987/article/details/23852883,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yyz_1987/article/details/23852883,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
