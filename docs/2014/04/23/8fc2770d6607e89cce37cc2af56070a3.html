<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>基因芯片（Affymetrix）分析4：GO和KEGG分析 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="基因芯片（Affymetrix）分析4：GO和KEGG分析" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="基因列表的分析一般都会涉及GO和KEGG分析，Bioconductor提供了很多这方面的R工具包。 选择工作目录，读入上一次分析和保存的数据： results.sig &lt;- read.csv(&quot;results.lim.7d.csv&quot;, header=TRUE, as.is=TRUE) head(results.sig) ## X logFC AveExpr t P.Value adj.P.Val B ## 1 254818_at 6.215 10.363 41.38 7.304e-10 1.169e-05 11.538 ## 2 254805_at 6.844 7.280 30.81 6.095e-09 4.878e-05 10.431 ## 3 245998_at 2.778 10.011 25.44 2.411e-08 9.545e-05 9.528 ## 4 265119_at 4.380 8.282 24.07 3.588e-08 9.545e-05 9.240 ## 5 256114_at 4.461 7.668 23.92 3.745e-08 9.545e-05 9.208 ## 6 265722_at -2.913 9.276 -23.91 3.760e-08 9.545e-05 9.205 colnames(results.sig)[1] &lt;- &quot;probe_id&quot; ; genes.sig &lt;- results.sig[, 1] 1 获取AGI、GO和KEGG注释 library(ath1121501.db) ls(&quot;package:ath1121501.db&quot;) ## [1] &quot;ath1121501&quot; &quot;ath1121501ACCNUM&quot; ## [3] &quot;ath1121501ARACYC&quot; &quot;ath1121501ARACYCENZYME&quot; ## [5] &quot;ath1121501CHR&quot; &quot;ath1121501CHRLENGTHS&quot; ## [7] &quot;ath1121501CHRLOC&quot; &quot;ath1121501CHRLOCEND&quot; ## [9] &quot;ath1121501.db&quot; &quot;ath1121501_dbconn&quot; ## [11] &quot;ath1121501_dbfile&quot; &quot;ath1121501_dbInfo&quot; ## [13] &quot;ath1121501_dbschema&quot; &quot;ath1121501ENZYME&quot; ## [15] &quot;ath1121501ENZYME2PROBE&quot; &quot;ath1121501GENENAME&quot; ## [17] &quot;ath1121501GO&quot; &quot;ath1121501GO2ALLPROBES&quot; ## [19] &quot;ath1121501GO2PROBE&quot; &quot;ath1121501MAPCOUNTS&quot; ## [21] &quot;ath1121501ORGANISM&quot; &quot;ath1121501ORGPKG&quot; ## [23] &quot;ath1121501PATH&quot; &quot;ath1121501PATH2PROBE&quot; ## [25] &quot;ath1121501PMID&quot; &quot;ath1121501PMID2PROBE&quot; ## [27] &quot;ath1121501SYMBOL&quot; ath1121501GO为拟南芥基因的GO数据库，ath1121501PATH为KEGG pathway数据库。但不是每一个基因（probeset）都有GO或KEGG注释，哪些基因有注释可以用mappedkeys函数获得： length(mappedkeys(ath1121501PATH)) ## [1] 3018 length(mappedkeys(ath1121501GO)) ## [1] 20299 head(mappedkeys(ath1121501PATH)) ## [1] &quot;261579_at&quot; &quot;261569_at&quot; &quot;261583_at&quot; &quot;261574_at&quot; &quot;261043_at&quot; &quot;261044_at&quot; 有PATH注释的probesets只有3018个，而有GO注释的有2万多个。 通过ath1121501XXXX获得的数据是AnnotationDbi软件包定义的ProbeAnnDbBimap类型数据，它们可以用as.list转成列表形式。列表内每一个基因的注释内容也是列表形式： all.path &lt;- ath1121501PATH[mappedkeys(ath1121501PATH)] class(all.path) ## [1] &quot;ProbeAnnDbBimap&quot; ## attr(,&quot;package&quot;) ## [1] &quot;AnnotationDbi&quot; as.list(all.path)[1] ## $`261579_at` ## [1] &quot;00190&quot; 转换成列表类型的ProbeAnnDbBimap数据仍然是列表，但PATH和ACCNUM数据是二级列表（列表下只有一级列表），而GO数据是三级列表（列表下还有两级的列表）。所以得先编写get.GO函数，它把as.list产生的GO三级列表转成二级结构，和AGI和KEGG的列表类似，方便后面的统一处理： get.GO &lt;- function(the.keys, goList){ results &lt;- NULL for (i in 1:length(the.keys)){ n &lt;- length(goList[[i]]) info &lt;- NULL for(j in 1:n){info &lt;- c(info, goList[[i]][[j]]$GOID)} info &lt;- list(info) names(info) &lt;- the.keys[i] results &lt;- c(results, info) } results } 使用这个函数和下列代码就可以获得AGI、GO和KEGG注释： library(plyr) results.anno &lt;- results.sig[,1:2] for(i in 1:3){ anno &lt;- switch(i, ath1121501ACCNUM, ath1121501GO, ath1121501PATH) anno.label &lt;- switch(i, &quot;AGI&quot;, &quot;GO&quot;, &quot;PATH&quot;) mapped.probes &lt;- mappedkeys(anno) mapped.present &lt;- intersect(genes.sig, mapped.probes) mapped.anno &lt;- as.list(anno[mapped.present]) if(anno.label==&quot;GO&quot;) mapped.anno &lt;- get.GO(mapped.present, mapped.anno) mapped.anno &lt;- llply(mapped.anno, unique) mapped.anno &lt;- ldply(mapped.anno, paste, collapse=&quot;; &quot;) colnames(mapped.anno) &lt;- c(&quot;probe_id&quot;, anno.label) results.anno &lt;- merge(results.anno, mapped.anno, by.x = &quot;probe_id&quot;, all = TRUE) } 上面代码有两点要注意： switch()函数使用。switch()是非常神奇的条件转向开关函数，它的参数（列表）可以是各种类型，变量、表达式、函数等都可以使用。 列表到数据框类型数据的转换，我们使用了plyr软件包的llply和ldply函数。plyr是很著名的软件包，用于数据糅合。这不属于本节的讨论范围，先不介绍，请自行学习使用。 由于探针id是唯一的，上面的代码用它作为关键字糅合数据。得到的结果是数据框： str(results.anno) ## &#39;data.frame&#39;: 740 obs. of 5 variables: ## $ probe_id: chr &quot;245015_at&quot; &quot;245042_at&quot; &quot;245088_at&quot; &quot;245196_at&quot; ... ## $ logFC : num 1.37 -1.13 -1.62 -1.71 1.44 ... ## $ AGI : chr &quot;ATCG00490&quot; &quot;AT2G26540&quot; &quot;AT2G39850&quot; &quot;AT1G67750&quot; ... ## $ GO : chr &quot;GO:0006091; GO:0006354; GO:0009737; GO:0015977; GO:0015979; GO:0018119; GO:0046686; GO:0016020; GO:0005618; GO:0009507; GO:0009&quot;| __truncated__ &quot;GO:0006779; GO:0006780; GO:0033014; GO:0009507; GO:0004852&quot; &quot;GO:0008152; GO:0006508; GO:0043086; GO:0005576; GO:0009505; GO:0004252; GO:0042802&quot; &quot;GO:0008150; GO:0005576; GO:0030570&quot; ... ## $ PATH : chr NA NA NA &quot;00040&quot; ... 这样每一个探针都得到了对应的AGI、GO和KEGG途径注释（如果有）。其他类型数据如Pubmed ID可以使用类似方法获得，但编程之前得先了解它们的数据结构，最直接的方法就是使用head，summary和str等函数查看。 得到的结果用write.csv或其他存盘函数保存。 2 GO和KEGG富集分析 Bioconductor中有不少软件包可以进行GO和KEGG统计分析和作图，如GOstats和KEGGgraph，但我不建议使用它们。 对于这类分析，我推荐使用另外一个不是R软件包的网络分析软件：Cytoscape。它是免费的开源软件，由多所大学和几个公司联合开发和维护，已经逐渐成为网络分析的标准工具，软件网址为：http://www.cytoscape.org/ R软件包RCytoscape可以把R的分析结果推送到Cytoscape，充分利用R的统计功能和Cytoscape的可视化能力。但是RCytoscape不一定能跟上Cytoscape的软件更新步伐，所以最好还是把R分析的结果保存成文件，再用Cytoscape直接分析。 事实上，如果使用Cytoscape进行GO和KEGG富集或网络分析，我们只需要获得AGI列表，而不需要获得GO和KEGG注释。 3 Session Info sessionInfo() ## R version 3.1.0 (2014-04-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## ## locale: ## [1] LC_CTYPE=zh_CN.UTF-8 LC_NUMERIC=C ## [3] LC_TIME=zh_CN.UTF-8 LC_COLLATE=zh_CN.UTF-8 ## [5] LC_MONETARY=zh_CN.UTF-8 LC_MESSAGES=zh_CN.UTF-8 ## [7] LC_PAPER=zh_CN.UTF-8 LC_NAME=C ## [9] LC_ADDRESS=C LC_TELEPHONE=C ## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C ## ## attached base packages: ## [1] parallel tcltk stats graphics grDevices utils datasets ## [8] methods base ## ## other attached packages: ## [1] plyr_1.8.1 ath1121501.db_2.14.0 org.At.tair.db_2.14.0 ## [4] RSQLite_0.11.4 DBI_0.2-7 AnnotationDbi_1.27.3 ## [7] GenomeInfoDb_1.1.2 Biobase_2.25.0 BiocGenerics_0.11.0 ## [10] zblog_0.1.0 knitr_1.5 ## ## loaded via a namespace (and not attached): ## [1] evaluate_0.5.3 formatR_0.10 highr_0.3 IRanges_1.99.2 ## [5] Rcpp_0.11.1 S4Vectors_0.0.2 stats4_3.1.0 stringr_0.6.2 ## [9] tools_3.1.0 阅读更多" />
<meta property="og:description" content="基因列表的分析一般都会涉及GO和KEGG分析，Bioconductor提供了很多这方面的R工具包。 选择工作目录，读入上一次分析和保存的数据： results.sig &lt;- read.csv(&quot;results.lim.7d.csv&quot;, header=TRUE, as.is=TRUE) head(results.sig) ## X logFC AveExpr t P.Value adj.P.Val B ## 1 254818_at 6.215 10.363 41.38 7.304e-10 1.169e-05 11.538 ## 2 254805_at 6.844 7.280 30.81 6.095e-09 4.878e-05 10.431 ## 3 245998_at 2.778 10.011 25.44 2.411e-08 9.545e-05 9.528 ## 4 265119_at 4.380 8.282 24.07 3.588e-08 9.545e-05 9.240 ## 5 256114_at 4.461 7.668 23.92 3.745e-08 9.545e-05 9.208 ## 6 265722_at -2.913 9.276 -23.91 3.760e-08 9.545e-05 9.205 colnames(results.sig)[1] &lt;- &quot;probe_id&quot; ; genes.sig &lt;- results.sig[, 1] 1 获取AGI、GO和KEGG注释 library(ath1121501.db) ls(&quot;package:ath1121501.db&quot;) ## [1] &quot;ath1121501&quot; &quot;ath1121501ACCNUM&quot; ## [3] &quot;ath1121501ARACYC&quot; &quot;ath1121501ARACYCENZYME&quot; ## [5] &quot;ath1121501CHR&quot; &quot;ath1121501CHRLENGTHS&quot; ## [7] &quot;ath1121501CHRLOC&quot; &quot;ath1121501CHRLOCEND&quot; ## [9] &quot;ath1121501.db&quot; &quot;ath1121501_dbconn&quot; ## [11] &quot;ath1121501_dbfile&quot; &quot;ath1121501_dbInfo&quot; ## [13] &quot;ath1121501_dbschema&quot; &quot;ath1121501ENZYME&quot; ## [15] &quot;ath1121501ENZYME2PROBE&quot; &quot;ath1121501GENENAME&quot; ## [17] &quot;ath1121501GO&quot; &quot;ath1121501GO2ALLPROBES&quot; ## [19] &quot;ath1121501GO2PROBE&quot; &quot;ath1121501MAPCOUNTS&quot; ## [21] &quot;ath1121501ORGANISM&quot; &quot;ath1121501ORGPKG&quot; ## [23] &quot;ath1121501PATH&quot; &quot;ath1121501PATH2PROBE&quot; ## [25] &quot;ath1121501PMID&quot; &quot;ath1121501PMID2PROBE&quot; ## [27] &quot;ath1121501SYMBOL&quot; ath1121501GO为拟南芥基因的GO数据库，ath1121501PATH为KEGG pathway数据库。但不是每一个基因（probeset）都有GO或KEGG注释，哪些基因有注释可以用mappedkeys函数获得： length(mappedkeys(ath1121501PATH)) ## [1] 3018 length(mappedkeys(ath1121501GO)) ## [1] 20299 head(mappedkeys(ath1121501PATH)) ## [1] &quot;261579_at&quot; &quot;261569_at&quot; &quot;261583_at&quot; &quot;261574_at&quot; &quot;261043_at&quot; &quot;261044_at&quot; 有PATH注释的probesets只有3018个，而有GO注释的有2万多个。 通过ath1121501XXXX获得的数据是AnnotationDbi软件包定义的ProbeAnnDbBimap类型数据，它们可以用as.list转成列表形式。列表内每一个基因的注释内容也是列表形式： all.path &lt;- ath1121501PATH[mappedkeys(ath1121501PATH)] class(all.path) ## [1] &quot;ProbeAnnDbBimap&quot; ## attr(,&quot;package&quot;) ## [1] &quot;AnnotationDbi&quot; as.list(all.path)[1] ## $`261579_at` ## [1] &quot;00190&quot; 转换成列表类型的ProbeAnnDbBimap数据仍然是列表，但PATH和ACCNUM数据是二级列表（列表下只有一级列表），而GO数据是三级列表（列表下还有两级的列表）。所以得先编写get.GO函数，它把as.list产生的GO三级列表转成二级结构，和AGI和KEGG的列表类似，方便后面的统一处理： get.GO &lt;- function(the.keys, goList){ results &lt;- NULL for (i in 1:length(the.keys)){ n &lt;- length(goList[[i]]) info &lt;- NULL for(j in 1:n){info &lt;- c(info, goList[[i]][[j]]$GOID)} info &lt;- list(info) names(info) &lt;- the.keys[i] results &lt;- c(results, info) } results } 使用这个函数和下列代码就可以获得AGI、GO和KEGG注释： library(plyr) results.anno &lt;- results.sig[,1:2] for(i in 1:3){ anno &lt;- switch(i, ath1121501ACCNUM, ath1121501GO, ath1121501PATH) anno.label &lt;- switch(i, &quot;AGI&quot;, &quot;GO&quot;, &quot;PATH&quot;) mapped.probes &lt;- mappedkeys(anno) mapped.present &lt;- intersect(genes.sig, mapped.probes) mapped.anno &lt;- as.list(anno[mapped.present]) if(anno.label==&quot;GO&quot;) mapped.anno &lt;- get.GO(mapped.present, mapped.anno) mapped.anno &lt;- llply(mapped.anno, unique) mapped.anno &lt;- ldply(mapped.anno, paste, collapse=&quot;; &quot;) colnames(mapped.anno) &lt;- c(&quot;probe_id&quot;, anno.label) results.anno &lt;- merge(results.anno, mapped.anno, by.x = &quot;probe_id&quot;, all = TRUE) } 上面代码有两点要注意： switch()函数使用。switch()是非常神奇的条件转向开关函数，它的参数（列表）可以是各种类型，变量、表达式、函数等都可以使用。 列表到数据框类型数据的转换，我们使用了plyr软件包的llply和ldply函数。plyr是很著名的软件包，用于数据糅合。这不属于本节的讨论范围，先不介绍，请自行学习使用。 由于探针id是唯一的，上面的代码用它作为关键字糅合数据。得到的结果是数据框： str(results.anno) ## &#39;data.frame&#39;: 740 obs. of 5 variables: ## $ probe_id: chr &quot;245015_at&quot; &quot;245042_at&quot; &quot;245088_at&quot; &quot;245196_at&quot; ... ## $ logFC : num 1.37 -1.13 -1.62 -1.71 1.44 ... ## $ AGI : chr &quot;ATCG00490&quot; &quot;AT2G26540&quot; &quot;AT2G39850&quot; &quot;AT1G67750&quot; ... ## $ GO : chr &quot;GO:0006091; GO:0006354; GO:0009737; GO:0015977; GO:0015979; GO:0018119; GO:0046686; GO:0016020; GO:0005618; GO:0009507; GO:0009&quot;| __truncated__ &quot;GO:0006779; GO:0006780; GO:0033014; GO:0009507; GO:0004852&quot; &quot;GO:0008152; GO:0006508; GO:0043086; GO:0005576; GO:0009505; GO:0004252; GO:0042802&quot; &quot;GO:0008150; GO:0005576; GO:0030570&quot; ... ## $ PATH : chr NA NA NA &quot;00040&quot; ... 这样每一个探针都得到了对应的AGI、GO和KEGG途径注释（如果有）。其他类型数据如Pubmed ID可以使用类似方法获得，但编程之前得先了解它们的数据结构，最直接的方法就是使用head，summary和str等函数查看。 得到的结果用write.csv或其他存盘函数保存。 2 GO和KEGG富集分析 Bioconductor中有不少软件包可以进行GO和KEGG统计分析和作图，如GOstats和KEGGgraph，但我不建议使用它们。 对于这类分析，我推荐使用另外一个不是R软件包的网络分析软件：Cytoscape。它是免费的开源软件，由多所大学和几个公司联合开发和维护，已经逐渐成为网络分析的标准工具，软件网址为：http://www.cytoscape.org/ R软件包RCytoscape可以把R的分析结果推送到Cytoscape，充分利用R的统计功能和Cytoscape的可视化能力。但是RCytoscape不一定能跟上Cytoscape的软件更新步伐，所以最好还是把R分析的结果保存成文件，再用Cytoscape直接分析。 事实上，如果使用Cytoscape进行GO和KEGG富集或网络分析，我们只需要获得AGI列表，而不需要获得GO和KEGG注释。 3 Session Info sessionInfo() ## R version 3.1.0 (2014-04-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## ## locale: ## [1] LC_CTYPE=zh_CN.UTF-8 LC_NUMERIC=C ## [3] LC_TIME=zh_CN.UTF-8 LC_COLLATE=zh_CN.UTF-8 ## [5] LC_MONETARY=zh_CN.UTF-8 LC_MESSAGES=zh_CN.UTF-8 ## [7] LC_PAPER=zh_CN.UTF-8 LC_NAME=C ## [9] LC_ADDRESS=C LC_TELEPHONE=C ## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C ## ## attached base packages: ## [1] parallel tcltk stats graphics grDevices utils datasets ## [8] methods base ## ## other attached packages: ## [1] plyr_1.8.1 ath1121501.db_2.14.0 org.At.tair.db_2.14.0 ## [4] RSQLite_0.11.4 DBI_0.2-7 AnnotationDbi_1.27.3 ## [7] GenomeInfoDb_1.1.2 Biobase_2.25.0 BiocGenerics_0.11.0 ## [10] zblog_0.1.0 knitr_1.5 ## ## loaded via a namespace (and not attached): ## [1] evaluate_0.5.3 formatR_0.10 highr_0.3 IRanges_1.99.2 ## [5] Rcpp_0.11.1 S4Vectors_0.0.2 stats4_3.1.0 stringr_0.6.2 ## [9] tools_3.1.0 阅读更多" />
<link rel="canonical" href="https://mlh.app/2014/04/23/8fc2770d6607e89cce37cc2af56070a3.html" />
<meta property="og:url" content="https://mlh.app/2014/04/23/8fc2770d6607e89cce37cc2af56070a3.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-04-23T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"基因列表的分析一般都会涉及GO和KEGG分析，Bioconductor提供了很多这方面的R工具包。 选择工作目录，读入上一次分析和保存的数据： results.sig &lt;- read.csv(&quot;results.lim.7d.csv&quot;, header=TRUE, as.is=TRUE) head(results.sig) ## X logFC AveExpr t P.Value adj.P.Val B ## 1 254818_at 6.215 10.363 41.38 7.304e-10 1.169e-05 11.538 ## 2 254805_at 6.844 7.280 30.81 6.095e-09 4.878e-05 10.431 ## 3 245998_at 2.778 10.011 25.44 2.411e-08 9.545e-05 9.528 ## 4 265119_at 4.380 8.282 24.07 3.588e-08 9.545e-05 9.240 ## 5 256114_at 4.461 7.668 23.92 3.745e-08 9.545e-05 9.208 ## 6 265722_at -2.913 9.276 -23.91 3.760e-08 9.545e-05 9.205 colnames(results.sig)[1] &lt;- &quot;probe_id&quot; ; genes.sig &lt;- results.sig[, 1] 1 获取AGI、GO和KEGG注释 library(ath1121501.db) ls(&quot;package:ath1121501.db&quot;) ## [1] &quot;ath1121501&quot; &quot;ath1121501ACCNUM&quot; ## [3] &quot;ath1121501ARACYC&quot; &quot;ath1121501ARACYCENZYME&quot; ## [5] &quot;ath1121501CHR&quot; &quot;ath1121501CHRLENGTHS&quot; ## [7] &quot;ath1121501CHRLOC&quot; &quot;ath1121501CHRLOCEND&quot; ## [9] &quot;ath1121501.db&quot; &quot;ath1121501_dbconn&quot; ## [11] &quot;ath1121501_dbfile&quot; &quot;ath1121501_dbInfo&quot; ## [13] &quot;ath1121501_dbschema&quot; &quot;ath1121501ENZYME&quot; ## [15] &quot;ath1121501ENZYME2PROBE&quot; &quot;ath1121501GENENAME&quot; ## [17] &quot;ath1121501GO&quot; &quot;ath1121501GO2ALLPROBES&quot; ## [19] &quot;ath1121501GO2PROBE&quot; &quot;ath1121501MAPCOUNTS&quot; ## [21] &quot;ath1121501ORGANISM&quot; &quot;ath1121501ORGPKG&quot; ## [23] &quot;ath1121501PATH&quot; &quot;ath1121501PATH2PROBE&quot; ## [25] &quot;ath1121501PMID&quot; &quot;ath1121501PMID2PROBE&quot; ## [27] &quot;ath1121501SYMBOL&quot; ath1121501GO为拟南芥基因的GO数据库，ath1121501PATH为KEGG pathway数据库。但不是每一个基因（probeset）都有GO或KEGG注释，哪些基因有注释可以用mappedkeys函数获得： length(mappedkeys(ath1121501PATH)) ## [1] 3018 length(mappedkeys(ath1121501GO)) ## [1] 20299 head(mappedkeys(ath1121501PATH)) ## [1] &quot;261579_at&quot; &quot;261569_at&quot; &quot;261583_at&quot; &quot;261574_at&quot; &quot;261043_at&quot; &quot;261044_at&quot; 有PATH注释的probesets只有3018个，而有GO注释的有2万多个。 通过ath1121501XXXX获得的数据是AnnotationDbi软件包定义的ProbeAnnDbBimap类型数据，它们可以用as.list转成列表形式。列表内每一个基因的注释内容也是列表形式： all.path &lt;- ath1121501PATH[mappedkeys(ath1121501PATH)] class(all.path) ## [1] &quot;ProbeAnnDbBimap&quot; ## attr(,&quot;package&quot;) ## [1] &quot;AnnotationDbi&quot; as.list(all.path)[1] ## $`261579_at` ## [1] &quot;00190&quot; 转换成列表类型的ProbeAnnDbBimap数据仍然是列表，但PATH和ACCNUM数据是二级列表（列表下只有一级列表），而GO数据是三级列表（列表下还有两级的列表）。所以得先编写get.GO函数，它把as.list产生的GO三级列表转成二级结构，和AGI和KEGG的列表类似，方便后面的统一处理： get.GO &lt;- function(the.keys, goList){ results &lt;- NULL for (i in 1:length(the.keys)){ n &lt;- length(goList[[i]]) info &lt;- NULL for(j in 1:n){info &lt;- c(info, goList[[i]][[j]]$GOID)} info &lt;- list(info) names(info) &lt;- the.keys[i] results &lt;- c(results, info) } results } 使用这个函数和下列代码就可以获得AGI、GO和KEGG注释： library(plyr) results.anno &lt;- results.sig[,1:2] for(i in 1:3){ anno &lt;- switch(i, ath1121501ACCNUM, ath1121501GO, ath1121501PATH) anno.label &lt;- switch(i, &quot;AGI&quot;, &quot;GO&quot;, &quot;PATH&quot;) mapped.probes &lt;- mappedkeys(anno) mapped.present &lt;- intersect(genes.sig, mapped.probes) mapped.anno &lt;- as.list(anno[mapped.present]) if(anno.label==&quot;GO&quot;) mapped.anno &lt;- get.GO(mapped.present, mapped.anno) mapped.anno &lt;- llply(mapped.anno, unique) mapped.anno &lt;- ldply(mapped.anno, paste, collapse=&quot;; &quot;) colnames(mapped.anno) &lt;- c(&quot;probe_id&quot;, anno.label) results.anno &lt;- merge(results.anno, mapped.anno, by.x = &quot;probe_id&quot;, all = TRUE) } 上面代码有两点要注意： switch()函数使用。switch()是非常神奇的条件转向开关函数，它的参数（列表）可以是各种类型，变量、表达式、函数等都可以使用。 列表到数据框类型数据的转换，我们使用了plyr软件包的llply和ldply函数。plyr是很著名的软件包，用于数据糅合。这不属于本节的讨论范围，先不介绍，请自行学习使用。 由于探针id是唯一的，上面的代码用它作为关键字糅合数据。得到的结果是数据框： str(results.anno) ## &#39;data.frame&#39;: 740 obs. of 5 variables: ## $ probe_id: chr &quot;245015_at&quot; &quot;245042_at&quot; &quot;245088_at&quot; &quot;245196_at&quot; ... ## $ logFC : num 1.37 -1.13 -1.62 -1.71 1.44 ... ## $ AGI : chr &quot;ATCG00490&quot; &quot;AT2G26540&quot; &quot;AT2G39850&quot; &quot;AT1G67750&quot; ... ## $ GO : chr &quot;GO:0006091; GO:0006354; GO:0009737; GO:0015977; GO:0015979; GO:0018119; GO:0046686; GO:0016020; GO:0005618; GO:0009507; GO:0009&quot;| __truncated__ &quot;GO:0006779; GO:0006780; GO:0033014; GO:0009507; GO:0004852&quot; &quot;GO:0008152; GO:0006508; GO:0043086; GO:0005576; GO:0009505; GO:0004252; GO:0042802&quot; &quot;GO:0008150; GO:0005576; GO:0030570&quot; ... ## $ PATH : chr NA NA NA &quot;00040&quot; ... 这样每一个探针都得到了对应的AGI、GO和KEGG途径注释（如果有）。其他类型数据如Pubmed ID可以使用类似方法获得，但编程之前得先了解它们的数据结构，最直接的方法就是使用head，summary和str等函数查看。 得到的结果用write.csv或其他存盘函数保存。 2 GO和KEGG富集分析 Bioconductor中有不少软件包可以进行GO和KEGG统计分析和作图，如GOstats和KEGGgraph，但我不建议使用它们。 对于这类分析，我推荐使用另外一个不是R软件包的网络分析软件：Cytoscape。它是免费的开源软件，由多所大学和几个公司联合开发和维护，已经逐渐成为网络分析的标准工具，软件网址为：http://www.cytoscape.org/ R软件包RCytoscape可以把R的分析结果推送到Cytoscape，充分利用R的统计功能和Cytoscape的可视化能力。但是RCytoscape不一定能跟上Cytoscape的软件更新步伐，所以最好还是把R分析的结果保存成文件，再用Cytoscape直接分析。 事实上，如果使用Cytoscape进行GO和KEGG富集或网络分析，我们只需要获得AGI列表，而不需要获得GO和KEGG注释。 3 Session Info sessionInfo() ## R version 3.1.0 (2014-04-10) ## Platform: x86_64-pc-linux-gnu (64-bit) ## ## locale: ## [1] LC_CTYPE=zh_CN.UTF-8 LC_NUMERIC=C ## [3] LC_TIME=zh_CN.UTF-8 LC_COLLATE=zh_CN.UTF-8 ## [5] LC_MONETARY=zh_CN.UTF-8 LC_MESSAGES=zh_CN.UTF-8 ## [7] LC_PAPER=zh_CN.UTF-8 LC_NAME=C ## [9] LC_ADDRESS=C LC_TELEPHONE=C ## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C ## ## attached base packages: ## [1] parallel tcltk stats graphics grDevices utils datasets ## [8] methods base ## ## other attached packages: ## [1] plyr_1.8.1 ath1121501.db_2.14.0 org.At.tair.db_2.14.0 ## [4] RSQLite_0.11.4 DBI_0.2-7 AnnotationDbi_1.27.3 ## [7] GenomeInfoDb_1.1.2 Biobase_2.25.0 BiocGenerics_0.11.0 ## [10] zblog_0.1.0 knitr_1.5 ## ## loaded via a namespace (and not attached): ## [1] evaluate_0.5.3 formatR_0.10 highr_0.3 IRanges_1.99.2 ## [5] Rcpp_0.11.1 S4Vectors_0.0.2 stats4_3.1.0 stringr_0.6.2 ## [9] tools_3.1.0 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2014/04/23/8fc2770d6607e89cce37cc2af56070a3.html","headline":"基因芯片（Affymetrix）分析4：GO和KEGG分析","dateModified":"2014-04-23T00:00:00+08:00","datePublished":"2014-04-23T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2014/04/23/8fc2770d6607e89cce37cc2af56070a3.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>基因芯片（Affymetrix）分析4：GO和KEGG分析</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>基因列表的分析一般都会涉及GO和KEGG分析，Bioconductor提供了很多这方面的R工具包。</p> 
  <p>选择工作目录，读入上一次分析和保存的数据：</p> 
  <p></p> 
  <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
   <div> 
    <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
     <pre class="knitr r"><span style="color:#000000;">results.sig</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">read.csv</span><span style="color:#000000;">(</span><span style="color:#d10000;">"results.lim.7d.csv"</span><span style="color:#000000;">,</span> <span style="color:#005400;">header</span><span style="color:#000000;">=</span><span style="color:#b85d00;">TRUE</span><span style="color:#000000;">,</span> <span style="color:#005400;">as.is</span><span style="color:#000000;">=</span><span style="color:#b85d00;">TRUE</span><span style="color:#000000;">)</span>
<span style="color:#002a54;">head</span><span style="color:#000000;">(results.sig)</span>
</pre> 
    </div> 
    <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
     <pre class="knitr r">##           X  logFC AveExpr      t   P.Value adj.P.Val      B
## 1 254818_at  6.215  10.363  41.38 7.304e-10 1.169e-05 11.538
## 2 254805_at  6.844   7.280  30.81 6.095e-09 4.878e-05 10.431
## 3 245998_at  2.778  10.011  25.44 2.411e-08 9.545e-05  9.528
## 4 265119_at  4.380   8.282  24.07 3.588e-08 9.545e-05  9.240
## 5 256114_at  4.461   7.668  23.92 3.745e-08 9.545e-05  9.208
## 6 265722_at -2.913   9.276 -23.91 3.760e-08 9.545e-05  9.205
</pre> 
    </div> 
    <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
     <pre class="knitr r"><span style="color:#002a54;">colnames</span><span style="color:#000000;">(results.sig)[</span><span style="color:#b85d00;">1</span><span style="color:#000000;">]</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#d10000;">"probe_id"</span> <span style="color:#000000;">;</span>
<span style="color:#000000;">genes.sig</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#000000;">results.sig[,</span> <span style="color:#b85d00;">1</span><span style="color:#000000;">]</span>
</pre> 
    </div> 
   </div> 
  </div> 
  <p></p> 
  <div id="outline-container-sec-1" class="outline-2"> 
   <h2 id="sec-1"><span class="section-number-2">1</span> 获取AGI、GO和KEGG注释</h2> 
   <div class="outline-text-2" id="text-1"> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">library</span><span style="color:#000000;">(ath1121501.db)</span>
<span style="color:#002a54;">ls</span><span style="color:#000000;">(</span><span style="color:#d10000;">"package:ath1121501.db"</span><span style="color:#000000;">)</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">##  [1] "ath1121501"             "ath1121501ACCNUM"      
##  [3] "ath1121501ARACYC"       "ath1121501ARACYCENZYME"
##  [5] "ath1121501CHR"          "ath1121501CHRLENGTHS"  
##  [7] "ath1121501CHRLOC"       "ath1121501CHRLOCEND"   
##  [9] "ath1121501.db"          "ath1121501_dbconn"     
## [11] "ath1121501_dbfile"      "ath1121501_dbInfo"     
## [13] "ath1121501_dbschema"    "ath1121501ENZYME"      
## [15] "ath1121501ENZYME2PROBE" "ath1121501GENENAME"    
## [17] "ath1121501GO"           "ath1121501GO2ALLPROBES"
## [19] "ath1121501GO2PROBE"     "ath1121501MAPCOUNTS"   
## [21] "ath1121501ORGANISM"     "ath1121501ORGPKG"      
## [23] "ath1121501PATH"         "ath1121501PATH2PROBE"  
## [25] "ath1121501PMID"         "ath1121501PMID2PROBE"  
## [27] "ath1121501SYMBOL"
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <p>ath1121501GO为拟南芥基因的GO数据库，ath1121501PATH为KEGG pathway数据库。但不是每一个基因（probeset）都有GO或KEGG注释，哪些基因有注释可以用mappedkeys函数获得：</p> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">length</span><span style="color:#000000;">(</span><span style="color:#002a54;">mappedkeys</span><span style="color:#000000;">(ath1121501PATH))</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## [1] 3018
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">length</span><span style="color:#000000;">(</span><span style="color:#002a54;">mappedkeys</span><span style="color:#000000;">(ath1121501GO))</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## [1] 20299
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">head</span><span style="color:#000000;">(</span><span style="color:#002a54;">mappedkeys</span><span style="color:#000000;">(ath1121501PATH))</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## [1] "261579_at" "261569_at" "261583_at" "261574_at" "261043_at" "261044_at"
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <p>有PATH注释的probesets只有3018个，而有GO注释的有2万多个。</p> 
    <p>通过ath1121501XXXX获得的数据是AnnotationDbi软件包定义的ProbeAnnDbBimap类型数据，它们可以用as.list转成列表形式。列表内每一个基因的注释内容也是列表形式：</p> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#000000;">all.path</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#000000;">ath1121501PATH[</span><span style="color:#002a54;">mappedkeys</span><span style="color:#000000;">(ath1121501PATH)]</span>
<span style="color:#002a54;">class</span><span style="color:#000000;">(all.path)</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## [1] "ProbeAnnDbBimap"
## attr(,"package")
## [1] "AnnotationDbi"
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">as.list</span><span style="color:#000000;">(all.path)[</span><span style="color:#b85d00;">1</span><span style="color:#000000;">]</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## $`261579_at`
## [1] "00190"
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <p>转换成列表类型的ProbeAnnDbBimap数据仍然是列表，但PATH和ACCNUM数据是二级列表（列表下只有一级列表），而GO数据是三级列表（列表下还有两级的列表）。所以得先编写get.GO函数，它把as.list产生的GO三级列表转成二级结构，和AGI和KEGG的列表类似，方便后面的统一处理：</p> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#000000;">get.GO</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#00007f;">function</span><span style="color:#000000;">(</span><span style="color:#005400;">the.keys</span><span style="color:#000000;">,</span> <span style="color:#005400;">goList</span><span style="color:#000000;">){</span>
        <span style="color:#000000;">results</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#00007f;">NULL</span>
        <span style="color:#00007f;">for</span> <span style="color:#000000;">(i</span> <span style="color:#00007f;">in</span> <span style="color:#b85d00;">1</span><span style="color:#000000;">:</span><span style="color:#002a54;">length</span><span style="color:#000000;">(the.keys)){</span>
                <span style="color:#000000;">n</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">length</span><span style="color:#000000;">(goList[[i]])</span>
                <span style="color:#000000;">info</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#00007f;">NULL</span>
                <span style="color:#00007f;">for</span><span style="color:#000000;">(j</span> <span style="color:#00007f;">in</span> <span style="color:#b85d00;">1</span><span style="color:#000000;">:</span><span style="color:#000000;">n){info</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">c</span><span style="color:#000000;">(info, goList[[i]][[j]]</span><span style="color:#000000;">$</span><span style="color:#000000;">GOID)}</span>
                <span style="color:#000000;">info</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">list</span><span style="color:#000000;">(info)</span>
                <span style="color:#002a54;">names</span><span style="color:#000000;">(info)</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#000000;">the.keys[i]</span>
                <span style="color:#000000;">results</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">c</span><span style="color:#000000;">(results, info)</span>
        <span style="color:#000000;">}</span>
        <span style="color:#000000;">results</span>
<span style="color:#000000;">}</span>
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <p>使用这个函数和下列代码就可以获得AGI、GO和KEGG注释：</p> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">library</span><span style="color:#000000;">(plyr)</span>
<span style="color:#000000;">results.anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#000000;">results.sig[,</span><span style="color:#b85d00;">1</span><span style="color:#000000;">:</span><span style="color:#b85d00;">2</span><span style="color:#000000;">]</span>
<span style="color:#00007f;">for</span><span style="color:#000000;">(i</span> <span style="color:#00007f;">in</span> <span style="color:#b85d00;">1</span><span style="color:#000000;">:</span><span style="color:#b85d00;">3</span><span style="color:#000000;">){</span>
    <span style="color:#000000;">anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">switch</span><span style="color:#000000;">(i, ath1121501ACCNUM, ath1121501GO, ath1121501PATH)</span>
    <span style="color:#000000;">anno.label</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">switch</span><span style="color:#000000;">(i,</span> <span style="color:#d10000;">"AGI"</span><span style="color:#000000;">,</span> <span style="color:#d10000;">"GO"</span><span style="color:#000000;">,</span> <span style="color:#d10000;">"PATH"</span><span style="color:#000000;">)</span>
    <span style="color:#000000;">mapped.probes</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">mappedkeys</span><span style="color:#000000;">(anno)</span>
    <span style="color:#000000;">mapped.present</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">intersect</span><span style="color:#000000;">(genes.sig, mapped.probes)</span>
    <span style="color:#000000;">mapped.anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">as.list</span><span style="color:#000000;">(anno[mapped.present])</span>
    <span style="color:#00007f;">if</span><span style="color:#000000;">(anno.label</span><span style="color:#000000;">==</span><span style="color:#d10000;">"GO"</span><span style="color:#000000;">) mapped.anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">get.GO</span><span style="color:#000000;">(mapped.present, mapped.anno)</span>
        <span style="color:#000000;">mapped.anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">llply</span><span style="color:#000000;">(mapped.anno, unique)</span>
    <span style="color:#000000;">mapped.anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">ldply</span><span style="color:#000000;">(mapped.anno, paste,</span> <span style="color:#005400;">collapse</span><span style="color:#000000;">=</span><span style="color:#d10000;">"; "</span><span style="color:#000000;">)</span>
    <span style="color:#002a54;">colnames</span><span style="color:#000000;">(mapped.anno)</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">c</span><span style="color:#000000;">(</span><span style="color:#d10000;">"probe_id"</span><span style="color:#000000;">, anno.label)</span>
    <span style="color:#000000;">results.anno</span> <span style="color:#540054;"><strong>&lt;-</strong></span> <span style="color:#002a54;">merge</span><span style="color:#000000;">(results.anno, mapped.anno,</span> <span style="color:#005400;">by.x</span> <span style="color:#000000;">=</span> <span style="color:#d10000;">"probe_id"</span><span style="color:#000000;">,</span> <span style="color:#005400;">all</span> <span style="color:#000000;">=</span> <span style="color:#b85d00;">TRUE</span><span style="color:#000000;">)</span>
<span style="color:#000000;">}</span>
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <p>上面代码有两点要注意：</p> 
    <ul class="org-ul">
     <li>switch()函数使用。switch()是非常神奇的条件转向开关函数，它的参数（列表）可以是各种类型，变量、表达式、函数等都可以使用。</li>
     <li>列表到数据框类型数据的转换，我们使用了plyr软件包的llply和ldply函数。plyr是很著名的软件包，用于数据糅合。这不属于本节的讨论范围，先不介绍，请自行学习使用。</li>
    </ul>
    <p>由于探针id是唯一的，上面的代码用它作为关键字糅合数据。得到的结果是数据框：</p> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">str</span><span style="color:#000000;">(results.anno)</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## 'data.frame':	740 obs. of  5 variables:
##  $ probe_id: chr  "245015_at" "245042_at" "245088_at" "245196_at" ...
##  $ logFC   : num  1.37 -1.13 -1.62 -1.71 1.44 ...
##  $ AGI     : chr  "ATCG00490" "AT2G26540" "AT2G39850" "AT1G67750" ...
##  $ GO      : chr  "GO:0006091; GO:0006354; GO:0009737; GO:0015977; GO:0015979; GO:0018119; GO:0046686; GO:0016020; GO:0005618; GO:0009507; GO:0009"| __truncated__ "GO:0006779; GO:0006780; GO:0033014; GO:0009507; GO:0004852" "GO:0008152; GO:0006508; GO:0043086; GO:0005576; GO:0009505; GO:0004252; GO:0042802" "GO:0008150; GO:0005576; GO:0030570" ...
##  $ PATH    : chr  NA NA NA "00040" ...
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <p>这样每一个探针都得到了对应的AGI、GO和KEGG途径注释（如果有）。其他类型数据如Pubmed ID可以使用类似方法获得，但编程之前得先了解它们的数据结构，最直接的方法就是使用head，summary和str等函数查看。</p> 
    <p>得到的结果用write.csv或其他存盘函数保存。</p> 
   </div> 
  </div> 
  <div id="outline-container-sec-2" class="outline-2"> 
   <h2 id="sec-2"><span class="section-number-2">2</span> GO和KEGG富集分析</h2> 
   <div class="outline-text-2" id="text-2"> 
    <p>Bioconductor中有不少软件包可以进行GO和KEGG统计分析和作图，如GOstats和KEGGgraph，但我不建议使用它们。</p> 
    <p>对于这类分析，我推荐使用另外一个不是R软件包的网络分析软件：Cytoscape。它是免费的开源软件，由多所大学和几个公司联合开发和维护，已经逐渐成为网络分析的标准工具，软件网址为：<a href="http://www.cytoscape.org/" rel="nofollow">http://www.cytoscape.org/</a></p> 
    <p>R软件包RCytoscape可以把R的分析结果推送到Cytoscape，充分利用R的统计功能和Cytoscape的可视化能力。但是RCytoscape不一定能跟上Cytoscape的软件更新步伐，所以最好还是把R分析的结果保存成文件，再用Cytoscape直接分析。</p> 
    <p>事实上，如果使用Cytoscape进行GO和KEGG富集或网络分析，我们只需要获得AGI列表，而不需要获得GO和KEGG注释。</p> 
   </div> 
  </div> 
  <div id="outline-container-sec-3" class="outline-2"> 
   <h2 id="sec-3"><span class="section-number-2">3</span> Session Info</h2> 
   <div class="outline-text-2" id="text-3"> 
    <p></p> 
    <div style="background-color:#FFFFFF;border:solid 1px #B0B0B0;"> 
     <div> 
      <div style="border:solid 1px #F7F7F7;background-color:#d6d6d6;"> 
       <pre class="knitr r"><span style="color:#002a54;">sessionInfo</span><span style="color:#000000;">()</span>
</pre> 
      </div> 
      <div style="border:solid 1px #F7F7F7;background-color:#F5F5F5;"> 
       <pre class="knitr r">## R version 3.1.0 (2014-04-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## 
## locale:
##  [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    
##  [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   
##  [7] LC_PAPER=zh_CN.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  tcltk     stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] plyr_1.8.1            ath1121501.db_2.14.0  org.At.tair.db_2.14.0
##  [4] RSQLite_0.11.4        DBI_0.2-7             AnnotationDbi_1.27.3 
##  [7] GenomeInfoDb_1.1.2    Biobase_2.25.0        BiocGenerics_0.11.0  
## [10] zblog_0.1.0           knitr_1.5            
## 
## loaded via a namespace (and not attached):
## [1] evaluate_0.5.3  formatR_0.10    highr_0.3       IRanges_1.99.2 
## [5] Rcpp_0.11.1     S4Vectors_0.0.2 stats4_3.1.0    stringr_0.6.2  
## [9] tools_3.1.0
</pre> 
      </div> 
     </div> 
    </div> 
    <p></p> 
    <hr>
   </div> 
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u014801157/article/details/24372393,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u014801157/article/details/24372393,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
