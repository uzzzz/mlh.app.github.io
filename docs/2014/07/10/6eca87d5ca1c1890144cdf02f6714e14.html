<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>加密壳之ACProtect之OEP的处理 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="加密壳之ACProtect之OEP的处理" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="菜驹也玩加密壳之ACProtect之OEP的处理 附件下载：加壳文件和pdf 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;加密过程： ACProctect v1.41版本 分析对OEP入口点代码的偷取 &nbsp; 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分析过程： 载入后，EIP= 00412000 00412000&gt;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00412001&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00412007 00412006&nbsp; - 7E 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jle Xvcmfc库1.00411F8B 00412008&nbsp;&nbsp;&nbsp; 04 24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add al,0x24 0041200A&nbsp;&nbsp;&nbsp; 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push es 0041200B&nbsp;&nbsp;&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn 0041200C&nbsp;&nbsp;&nbsp; 77 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.0041200F 0041200E&nbsp;&nbsp;&nbsp; 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc ebx 0041200F&nbsp;&nbsp;&nbsp; FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cld 00412010&nbsp;&nbsp;&nbsp; 75 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz Xvcmfc库1.00412013 入口点是在壳段（地址：00412000,大小:19000） &nbsp; 根据壳的特征，用ESP，在00412001处下HR ESP &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 来到这里： 0041254A&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 0041254B&nbsp;&nbsp;&nbsp; 8F05 A1294100&nbsp;&nbsp; pop dword ptr ds:[0x4129A1] 00412551&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00412552&nbsp;&nbsp;&nbsp; 78 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js Xvcmfc库1.00412557 00412554&nbsp;&nbsp;&nbsp; 79 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jns Xvcmfc库1.00412557 00412556&nbsp;&nbsp;&nbsp; 7B 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jpo Xvcmfc库1.00412598 &nbsp; 可以看到pushad,清除上面的硬件断点后，在pushad下面下HR ESP 来到这里： 00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;; [889] = ecx 0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx 00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp 0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptr ds:[esi] 0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp 004277A9&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop 004277AA&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop 004277AB&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 004277AC&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.004277B2 004277B1&nbsp; ^ 77 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.00427736 注意其中的nop nop pushad 这三条指令，出现这个意味着这就是偷取的代码的开始。。。。当然，这里的nop是随意填充的，可能没有，也可能有一个，也可能有两个，也可能多个..关键是pushad指令 &nbsp; 把NOP之前的指令全部复制成二进制保存。 00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889] = ecx 0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx 00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp 0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;mov ecx,dword ptr ds:[esi] 0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp &nbsp; 这段代码的二进制数据为： 51 8F 05 89 2841 00 60 61 51 8F 05 CD 29 41 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E128 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F 05 3D 28 41 00 8B 15 3D 28 41 0089 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 29 41 00 89 25 192B 41 00 &nbsp; &nbsp; &nbsp; 重复上面的步骤，直到n次，怎么确定n,我这里是弹出试用版nag之后就出现了。 把这n次之间的二进制数据都保存下来。 00429106&nbsp;&nbsp; /EB 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp Xvcmfc库1.00429109 00429108&nbsp;&nbsp; |E8 FF254B91&nbsp;&nbsp;&nbsp;&nbsp; call 918DB70C 0042910D&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc edx &nbsp; 00429106处是一个近跳，F7进去 00429109&nbsp; - FF25 4B914200&nbsp;&nbsp; jmp dword ptr ds:[0x42914B]&nbsp;&nbsp;&nbsp; ; vcmfc库1.00405391 0042910F&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00429110&nbsp;&nbsp;&nbsp; E8 00000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00429115 00429115&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 00429116&nbsp;&nbsp;&nbsp; 83EE 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esi,0x6 其中： ds:[0042914B]=00405391 (vcmfc库1.00405391) 这是一个跨段的长跳转，何为跨段？当前指令是在00429109 它要跳到00405391， 从模块图中看出，它是要从.perplex段跳到.text段执行..这就是传说中的跨段 &nbsp; 所以说，进到代码段后，就是传说中的伪OEP了，伪OEP是长得这个样子的 &nbsp; &nbsp; 下面就把它DUMP出来 用import rec修复下IAT，没有问题 fix一下dump出来的文件 &nbsp; Import rec会给文件加一个.mackt的区段，里面存的是输入表，大小为1000，输入表用不了这么大的空间，我们把被偷的代码放在这个区段里好了。 用OD打开修复过和dump_.exe，在0042b000的段处找一个空的位置， 我找的是0042BBA0，把上面得到的二进制贴上去，贴完后，再加上一句JMP&nbsp;&nbsp;&nbsp;&nbsp; 00405391（跳到伪OEP） 0042BEBF&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP&nbsp;&nbsp;&nbsp;&nbsp; EAX 0042BEC0&nbsp;&nbsp;&nbsp;8908&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; DWORD PTR DS:[EAX], ECX 0042BEC2&nbsp;&nbsp;&nbsp;A1 A4604000&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; EAX, DWORD PTR DS:[0x4060A4] 0042BEC7&nbsp;- E9 C594FDFF&nbsp;&nbsp;&nbsp;&nbsp; JMP&nbsp;&nbsp;&nbsp;&nbsp; dumped_.&lt;ModuleEntryPoint&gt; &nbsp; 用LOAD PE把入口点修改成0042BBA0，OK，完工。。。 &nbsp; &nbsp; &nbsp; 保存的所有的二进制数据: 00427753&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp;8F05 89284100&nbsp;&nbsp; pop dword ptrds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889]= ecx 0042775A&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp;61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp;8F05 CD294100&nbsp;&nbsp; pop dword ptrds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd]= ecx 00427763&nbsp;&nbsp;&nbsp;FF35 CD294100&nbsp;&nbsp; push dword ptrds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp;8915 E1284100&nbsp;&nbsp; mov dword ptrds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp;FF35 E1284100&nbsp;&nbsp; push dword ptrds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp;BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp;8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E &nbsp;&nbsp;&nbsp;52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp;59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp;8F05 3D284100&nbsp;&nbsp; pop dword ptrds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp;8B15 3D284100&nbsp;&nbsp; mov edx,dword ptrds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp;8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptrds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;[412911] = ebp 0042778E&nbsp;&nbsp;&nbsp;8F05 A12A4100&nbsp;&nbsp; pop dword ptrds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp;BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp;8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptrds:[esi] 0042779C&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp;FF35 11294100&nbsp;&nbsp; push dword ptrds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp;8925 192B4100&nbsp;&nbsp; mov dword ptrds:[0x412B19],esp &nbsp; 51 8F 05 89 28 41 00 60 61 51 8F 05 CD 2941 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E1 28 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F05 3D 28 41 00 8B 15 3D 28 41 00 89 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 2941 00 89 25 19 2B 41 00 &nbsp; FF 35 19 2B 41 00 8F 05 C1 29 41 00 56 BEC1 29 41 00 8B 2E 5E 57 BF 9D 29 41 00 89 1F 5F FF 35 9D 29 41 00 89 35 31 28 41 00 FF 35 31 2841 00 68 FF FF FF FF 5E 89 35 99 2A 41 00 8B 1D 99 2A 41 00 8F 05 0D 2A 41 00 8B 35 0D 2A 41 0057 &nbsp; 89 1C 24 8F 05 05 29 41 00 8F 05 19 28 4100 FF 35 19 28 41 00 5B FF 35 05 29 41 00 89 05 D5 2A 41 00 FF 35 D5 2A 41 00 89 3C 24 89 0C 24C7 04 24 A0 61 40 00 57 8F 05 E1 2A 41 00 FF 35 E1 2A 41 00 89 1C 24 C7 04 24 C0 54 40 00 &nbsp; 64 A1 00 00 00 00 89 05 A5 29 41 00 FF 35A5 29 41 00 89 1C 24 89 0D 85 2A 41 00 FF 35 85 2A 41 00 57 BF 91 29 41 00 8B CF 5F 56 8B F1 8BDE 5E 8B 0C 24 8F 05 B5 2A 41 00 89 03 8B 1C 24 8F 05 ED 28 41 00 FF 35 91 29 41 00 &nbsp; 64 89 25 00 00 00 00 83 EC 68 53 8F 05 D529 41 00 FF 35 D5 29 41 00 8F 05 99 28 41 00 FF 35 99 28 41 00 57 89 04 24 8F 05 65 29 41 00 FF35 65 29 41 00 89 34 24 52 8F 05 F1 28 41 00 FF 35 F1 28 41 00 89 3D C9 2A 41 00 FF 35 C9 2A 4100 &nbsp; 56 8F 05 31 2A 41 00 60 61 68 E5 2A 41 005F 51 8B CF 8B D1 59 8F 05 B9 28 41 00 8B 3D B9 28 41 00 89 3A 8F 05 D1 28 41 00 53 BB D1 28 4100 8B 13 5B FF 35 E5 2A 41 00 89 65 E8 33 DB 89 5D FC 89 15 85 29 41 00 FF 35 85 29 41 00 89 3424 53 89 14 24 50 B8 02 00 00 00 60 &nbsp; 8B D0 58 52 5E 8F 05 01 2A 41 00 8B 15 012A 41 00 56 89 14 24 50 B8 25 29 41 00 8B D0 58 89 32 8F 05 AD 29 41 00 8B 15 AD 29 41 00 8B 3424 8F 05 B9 2A 41 00 FF 35 25 29 41 00 FF 15 98 60 40 00 8F 05 01 29 41 00 50 B8 5D 2A 41 00 8938 58 &nbsp; FF 35 5D 2A 41 00 51 C7 04 24 01 29 41 008F 05 85 28 41 00 8B 3D 85 28 41 00 8B 0F 8B 3C 24 8F 05 61 29 41 00 83 0D B4 F1 40 00 FF 83 0DB8 F1 40 00 FF FF 15 9C 60 40 00 89 05 C1 28 41 00 FF 35 C1 28 41 00 57 BF 35 28 41 00 8B C7 5F89 30 &nbsp; 8B 04 24 8F 05 41 28 41 00 FF 35 35 28 4100 50 8F 05 6D 2A 41 00 FF 35 6D 2A 41 00 89 3D 39 28 41 00 FF 35 39 28 41 00 51 B9 7C 71 40 008B F9 59 57 58 5F 50 5E 8F 05 2D 2A 41 00 8B 05 2D 2A 41 00 8B 0E 8F 05 11 2B 41 00 FF 35 11 2B41 00 &nbsp; 55 8F 05 25 2B 41 00 60 61 5E 89 08 FF 15A0 60 40 00 52 8F 05 55 2A 41 00 FF 35 55 2A 41 00 C7 05 29 29 41 00 78 71 40 00 FF 35 29 29 4100 8F 05 35 2A 41 00 8B 15 35 2A 41 00 8B 0A 8F 05 C9 28 41 00 50 B8 C9 28 41 00 8B 10 58 89 08A1 A4 60 40 00 &nbsp; 阅读更多" />
<meta property="og:description" content="菜驹也玩加密壳之ACProtect之OEP的处理 附件下载：加壳文件和pdf 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;加密过程： ACProctect v1.41版本 分析对OEP入口点代码的偷取 &nbsp; 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分析过程： 载入后，EIP= 00412000 00412000&gt;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00412001&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00412007 00412006&nbsp; - 7E 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jle Xvcmfc库1.00411F8B 00412008&nbsp;&nbsp;&nbsp; 04 24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add al,0x24 0041200A&nbsp;&nbsp;&nbsp; 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push es 0041200B&nbsp;&nbsp;&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn 0041200C&nbsp;&nbsp;&nbsp; 77 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.0041200F 0041200E&nbsp;&nbsp;&nbsp; 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc ebx 0041200F&nbsp;&nbsp;&nbsp; FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cld 00412010&nbsp;&nbsp;&nbsp; 75 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz Xvcmfc库1.00412013 入口点是在壳段（地址：00412000,大小:19000） &nbsp; 根据壳的特征，用ESP，在00412001处下HR ESP &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 来到这里： 0041254A&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 0041254B&nbsp;&nbsp;&nbsp; 8F05 A1294100&nbsp;&nbsp; pop dword ptr ds:[0x4129A1] 00412551&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00412552&nbsp;&nbsp;&nbsp; 78 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js Xvcmfc库1.00412557 00412554&nbsp;&nbsp;&nbsp; 79 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jns Xvcmfc库1.00412557 00412556&nbsp;&nbsp;&nbsp; 7B 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jpo Xvcmfc库1.00412598 &nbsp; 可以看到pushad,清除上面的硬件断点后，在pushad下面下HR ESP 来到这里： 00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;; [889] = ecx 0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx 00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp 0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptr ds:[esi] 0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp 004277A9&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop 004277AA&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop 004277AB&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 004277AC&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.004277B2 004277B1&nbsp; ^ 77 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.00427736 注意其中的nop nop pushad 这三条指令，出现这个意味着这就是偷取的代码的开始。。。。当然，这里的nop是随意填充的，可能没有，也可能有一个，也可能有两个，也可能多个..关键是pushad指令 &nbsp; 把NOP之前的指令全部复制成二进制保存。 00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889] = ecx 0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx 00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp 0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;mov ecx,dword ptr ds:[esi] 0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp &nbsp; 这段代码的二进制数据为： 51 8F 05 89 2841 00 60 61 51 8F 05 CD 29 41 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E128 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F 05 3D 28 41 00 8B 15 3D 28 41 0089 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 29 41 00 89 25 192B 41 00 &nbsp; &nbsp; &nbsp; 重复上面的步骤，直到n次，怎么确定n,我这里是弹出试用版nag之后就出现了。 把这n次之间的二进制数据都保存下来。 00429106&nbsp;&nbsp; /EB 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp Xvcmfc库1.00429109 00429108&nbsp;&nbsp; |E8 FF254B91&nbsp;&nbsp;&nbsp;&nbsp; call 918DB70C 0042910D&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc edx &nbsp; 00429106处是一个近跳，F7进去 00429109&nbsp; - FF25 4B914200&nbsp;&nbsp; jmp dword ptr ds:[0x42914B]&nbsp;&nbsp;&nbsp; ; vcmfc库1.00405391 0042910F&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00429110&nbsp;&nbsp;&nbsp; E8 00000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00429115 00429115&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 00429116&nbsp;&nbsp;&nbsp; 83EE 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esi,0x6 其中： ds:[0042914B]=00405391 (vcmfc库1.00405391) 这是一个跨段的长跳转，何为跨段？当前指令是在00429109 它要跳到00405391， 从模块图中看出，它是要从.perplex段跳到.text段执行..这就是传说中的跨段 &nbsp; 所以说，进到代码段后，就是传说中的伪OEP了，伪OEP是长得这个样子的 &nbsp; &nbsp; 下面就把它DUMP出来 用import rec修复下IAT，没有问题 fix一下dump出来的文件 &nbsp; Import rec会给文件加一个.mackt的区段，里面存的是输入表，大小为1000，输入表用不了这么大的空间，我们把被偷的代码放在这个区段里好了。 用OD打开修复过和dump_.exe，在0042b000的段处找一个空的位置， 我找的是0042BBA0，把上面得到的二进制贴上去，贴完后，再加上一句JMP&nbsp;&nbsp;&nbsp;&nbsp; 00405391（跳到伪OEP） 0042BEBF&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP&nbsp;&nbsp;&nbsp;&nbsp; EAX 0042BEC0&nbsp;&nbsp;&nbsp;8908&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; DWORD PTR DS:[EAX], ECX 0042BEC2&nbsp;&nbsp;&nbsp;A1 A4604000&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; EAX, DWORD PTR DS:[0x4060A4] 0042BEC7&nbsp;- E9 C594FDFF&nbsp;&nbsp;&nbsp;&nbsp; JMP&nbsp;&nbsp;&nbsp;&nbsp; dumped_.&lt;ModuleEntryPoint&gt; &nbsp; 用LOAD PE把入口点修改成0042BBA0，OK，完工。。。 &nbsp; &nbsp; &nbsp; 保存的所有的二进制数据: 00427753&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp;8F05 89284100&nbsp;&nbsp; pop dword ptrds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889]= ecx 0042775A&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp;61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp;8F05 CD294100&nbsp;&nbsp; pop dword ptrds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd]= ecx 00427763&nbsp;&nbsp;&nbsp;FF35 CD294100&nbsp;&nbsp; push dword ptrds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp;8915 E1284100&nbsp;&nbsp; mov dword ptrds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp;FF35 E1284100&nbsp;&nbsp; push dword ptrds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp;BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp;8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E &nbsp;&nbsp;&nbsp;52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp;59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp;8F05 3D284100&nbsp;&nbsp; pop dword ptrds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp;8B15 3D284100&nbsp;&nbsp; mov edx,dword ptrds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp;8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptrds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;[412911] = ebp 0042778E&nbsp;&nbsp;&nbsp;8F05 A12A4100&nbsp;&nbsp; pop dword ptrds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp;BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp;8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptrds:[esi] 0042779C&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp;FF35 11294100&nbsp;&nbsp; push dword ptrds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp;8925 192B4100&nbsp;&nbsp; mov dword ptrds:[0x412B19],esp &nbsp; 51 8F 05 89 28 41 00 60 61 51 8F 05 CD 2941 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E1 28 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F05 3D 28 41 00 8B 15 3D 28 41 00 89 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 2941 00 89 25 19 2B 41 00 &nbsp; FF 35 19 2B 41 00 8F 05 C1 29 41 00 56 BEC1 29 41 00 8B 2E 5E 57 BF 9D 29 41 00 89 1F 5F FF 35 9D 29 41 00 89 35 31 28 41 00 FF 35 31 2841 00 68 FF FF FF FF 5E 89 35 99 2A 41 00 8B 1D 99 2A 41 00 8F 05 0D 2A 41 00 8B 35 0D 2A 41 0057 &nbsp; 89 1C 24 8F 05 05 29 41 00 8F 05 19 28 4100 FF 35 19 28 41 00 5B FF 35 05 29 41 00 89 05 D5 2A 41 00 FF 35 D5 2A 41 00 89 3C 24 89 0C 24C7 04 24 A0 61 40 00 57 8F 05 E1 2A 41 00 FF 35 E1 2A 41 00 89 1C 24 C7 04 24 C0 54 40 00 &nbsp; 64 A1 00 00 00 00 89 05 A5 29 41 00 FF 35A5 29 41 00 89 1C 24 89 0D 85 2A 41 00 FF 35 85 2A 41 00 57 BF 91 29 41 00 8B CF 5F 56 8B F1 8BDE 5E 8B 0C 24 8F 05 B5 2A 41 00 89 03 8B 1C 24 8F 05 ED 28 41 00 FF 35 91 29 41 00 &nbsp; 64 89 25 00 00 00 00 83 EC 68 53 8F 05 D529 41 00 FF 35 D5 29 41 00 8F 05 99 28 41 00 FF 35 99 28 41 00 57 89 04 24 8F 05 65 29 41 00 FF35 65 29 41 00 89 34 24 52 8F 05 F1 28 41 00 FF 35 F1 28 41 00 89 3D C9 2A 41 00 FF 35 C9 2A 4100 &nbsp; 56 8F 05 31 2A 41 00 60 61 68 E5 2A 41 005F 51 8B CF 8B D1 59 8F 05 B9 28 41 00 8B 3D B9 28 41 00 89 3A 8F 05 D1 28 41 00 53 BB D1 28 4100 8B 13 5B FF 35 E5 2A 41 00 89 65 E8 33 DB 89 5D FC 89 15 85 29 41 00 FF 35 85 29 41 00 89 3424 53 89 14 24 50 B8 02 00 00 00 60 &nbsp; 8B D0 58 52 5E 8F 05 01 2A 41 00 8B 15 012A 41 00 56 89 14 24 50 B8 25 29 41 00 8B D0 58 89 32 8F 05 AD 29 41 00 8B 15 AD 29 41 00 8B 3424 8F 05 B9 2A 41 00 FF 35 25 29 41 00 FF 15 98 60 40 00 8F 05 01 29 41 00 50 B8 5D 2A 41 00 8938 58 &nbsp; FF 35 5D 2A 41 00 51 C7 04 24 01 29 41 008F 05 85 28 41 00 8B 3D 85 28 41 00 8B 0F 8B 3C 24 8F 05 61 29 41 00 83 0D B4 F1 40 00 FF 83 0DB8 F1 40 00 FF FF 15 9C 60 40 00 89 05 C1 28 41 00 FF 35 C1 28 41 00 57 BF 35 28 41 00 8B C7 5F89 30 &nbsp; 8B 04 24 8F 05 41 28 41 00 FF 35 35 28 4100 50 8F 05 6D 2A 41 00 FF 35 6D 2A 41 00 89 3D 39 28 41 00 FF 35 39 28 41 00 51 B9 7C 71 40 008B F9 59 57 58 5F 50 5E 8F 05 2D 2A 41 00 8B 05 2D 2A 41 00 8B 0E 8F 05 11 2B 41 00 FF 35 11 2B41 00 &nbsp; 55 8F 05 25 2B 41 00 60 61 5E 89 08 FF 15A0 60 40 00 52 8F 05 55 2A 41 00 FF 35 55 2A 41 00 C7 05 29 29 41 00 78 71 40 00 FF 35 29 29 4100 8F 05 35 2A 41 00 8B 15 35 2A 41 00 8B 0A 8F 05 C9 28 41 00 50 B8 C9 28 41 00 8B 10 58 89 08A1 A4 60 40 00 &nbsp; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2014/07/10/6eca87d5ca1c1890144cdf02f6714e14.html" />
<meta property="og:url" content="https://mlh.app/2014/07/10/6eca87d5ca1c1890144cdf02f6714e14.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-07-10T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"菜驹也玩加密壳之ACProtect之OEP的处理 附件下载：加壳文件和pdf 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;加密过程： ACProctect v1.41版本 分析对OEP入口点代码的偷取 &nbsp; 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分析过程： 载入后，EIP= 00412000 00412000&gt;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00412001&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00412007 00412006&nbsp; - 7E 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jle Xvcmfc库1.00411F8B 00412008&nbsp;&nbsp;&nbsp; 04 24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add al,0x24 0041200A&nbsp;&nbsp;&nbsp; 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push es 0041200B&nbsp;&nbsp;&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn 0041200C&nbsp;&nbsp;&nbsp; 77 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.0041200F 0041200E&nbsp;&nbsp;&nbsp; 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc ebx 0041200F&nbsp;&nbsp;&nbsp; FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cld 00412010&nbsp;&nbsp;&nbsp; 75 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz Xvcmfc库1.00412013 入口点是在壳段（地址：00412000,大小:19000） &nbsp; 根据壳的特征，用ESP，在00412001处下HR ESP &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 来到这里： 0041254A&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 0041254B&nbsp;&nbsp;&nbsp; 8F05 A1294100&nbsp;&nbsp; pop dword ptr ds:[0x4129A1] 00412551&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00412552&nbsp;&nbsp;&nbsp; 78 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js Xvcmfc库1.00412557 00412554&nbsp;&nbsp;&nbsp; 79 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jns Xvcmfc库1.00412557 00412556&nbsp;&nbsp;&nbsp; 7B 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jpo Xvcmfc库1.00412598 &nbsp; 可以看到pushad,清除上面的硬件断点后，在pushad下面下HR ESP 来到这里： 00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;; [889] = ecx 0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx 00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp 0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptr ds:[esi] 0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp 004277A9&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop 004277AA&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop 004277AB&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 004277AC&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.004277B2 004277B1&nbsp; ^ 77 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.00427736 注意其中的nop nop pushad 这三条指令，出现这个意味着这就是偷取的代码的开始。。。。当然，这里的nop是随意填充的，可能没有，也可能有一个，也可能有两个，也可能多个..关键是pushad指令 &nbsp; 把NOP之前的指令全部复制成二进制保存。 00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889] = ecx 0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx 00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp 0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;mov ecx,dword ptr ds:[esi] 0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp &nbsp; 这段代码的二进制数据为： 51 8F 05 89 2841 00 60 61 51 8F 05 CD 29 41 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E128 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F 05 3D 28 41 00 8B 15 3D 28 41 0089 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 29 41 00 89 25 192B 41 00 &nbsp; &nbsp; &nbsp; 重复上面的步骤，直到n次，怎么确定n,我这里是弹出试用版nag之后就出现了。 把这n次之间的二进制数据都保存下来。 00429106&nbsp;&nbsp; /EB 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp Xvcmfc库1.00429109 00429108&nbsp;&nbsp; |E8 FF254B91&nbsp;&nbsp;&nbsp;&nbsp; call 918DB70C 0042910D&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc edx &nbsp; 00429106处是一个近跳，F7进去 00429109&nbsp; - FF25 4B914200&nbsp;&nbsp; jmp dword ptr ds:[0x42914B]&nbsp;&nbsp;&nbsp; ; vcmfc库1.00405391 0042910F&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 00429110&nbsp;&nbsp;&nbsp; E8 00000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00429115 00429115&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 00429116&nbsp;&nbsp;&nbsp; 83EE 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esi,0x6 其中： ds:[0042914B]=00405391 (vcmfc库1.00405391) 这是一个跨段的长跳转，何为跨段？当前指令是在00429109 它要跳到00405391， 从模块图中看出，它是要从.perplex段跳到.text段执行..这就是传说中的跨段 &nbsp; 所以说，进到代码段后，就是传说中的伪OEP了，伪OEP是长得这个样子的 &nbsp; &nbsp; 下面就把它DUMP出来 用import rec修复下IAT，没有问题 fix一下dump出来的文件 &nbsp; Import rec会给文件加一个.mackt的区段，里面存的是输入表，大小为1000，输入表用不了这么大的空间，我们把被偷的代码放在这个区段里好了。 用OD打开修复过和dump_.exe，在0042b000的段处找一个空的位置， 我找的是0042BBA0，把上面得到的二进制贴上去，贴完后，再加上一句JMP&nbsp;&nbsp;&nbsp;&nbsp; 00405391（跳到伪OEP） 0042BEBF&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP&nbsp;&nbsp;&nbsp;&nbsp; EAX 0042BEC0&nbsp;&nbsp;&nbsp;8908&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; DWORD PTR DS:[EAX], ECX 0042BEC2&nbsp;&nbsp;&nbsp;A1 A4604000&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; EAX, DWORD PTR DS:[0x4060A4] 0042BEC7&nbsp;- E9 C594FDFF&nbsp;&nbsp;&nbsp;&nbsp; JMP&nbsp;&nbsp;&nbsp;&nbsp; dumped_.&lt;ModuleEntryPoint&gt; &nbsp; 用LOAD PE把入口点修改成0042BBA0，OK，完工。。。 &nbsp; &nbsp; &nbsp; 保存的所有的二进制数据: 00427753&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 00427754&nbsp;&nbsp;&nbsp;8F05 89284100&nbsp;&nbsp; pop dword ptrds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889]= ecx 0042775A&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 0042775B&nbsp;&nbsp;&nbsp;61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 0042775C&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx 0042775D&nbsp;&nbsp;&nbsp;8F05 CD294100&nbsp;&nbsp; pop dword ptrds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd]= ecx 00427763&nbsp;&nbsp;&nbsp;FF35 CD294100&nbsp;&nbsp; push dword ptrds:[0x4129CD] 00427769&nbsp;&nbsp;&nbsp;8915 E1284100&nbsp;&nbsp; mov dword ptrds:[0x4128E1],edx 0042776F&nbsp;&nbsp;&nbsp;FF35 E1284100&nbsp;&nbsp; push dword ptrds:[0x4128E1] 00427775&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427776&nbsp;&nbsp;&nbsp;BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911 0042777B&nbsp;&nbsp;&nbsp;8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi 0042777D&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042777E &nbsp;&nbsp;&nbsp;52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx 0042777F&nbsp;&nbsp;&nbsp;59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911 00427780&nbsp;&nbsp;&nbsp;8F05 3D284100&nbsp;&nbsp; pop dword ptrds:[0x41283D] 00427786&nbsp;&nbsp;&nbsp;8B15 3D284100&nbsp;&nbsp; mov edx,dword ptrds:[0x41283D] 0042778C&nbsp;&nbsp;&nbsp;8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptrds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;[412911] = ebp 0042778E&nbsp;&nbsp;&nbsp;8F05 A12A4100&nbsp;&nbsp; pop dword ptrds:[0x412AA1] 00427794&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi 00427795&nbsp;&nbsp;&nbsp;BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1 0042779A&nbsp;&nbsp;&nbsp;8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptrds:[esi] 0042779C&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi 0042779D&nbsp;&nbsp;&nbsp;FF35 11294100&nbsp;&nbsp; push dword ptrds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp 004277A3&nbsp;&nbsp;&nbsp;8925 192B4100&nbsp;&nbsp; mov dword ptrds:[0x412B19],esp &nbsp; 51 8F 05 89 28 41 00 60 61 51 8F 05 CD 2941 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E1 28 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F05 3D 28 41 00 8B 15 3D 28 41 00 89 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 2941 00 89 25 19 2B 41 00 &nbsp; FF 35 19 2B 41 00 8F 05 C1 29 41 00 56 BEC1 29 41 00 8B 2E 5E 57 BF 9D 29 41 00 89 1F 5F FF 35 9D 29 41 00 89 35 31 28 41 00 FF 35 31 2841 00 68 FF FF FF FF 5E 89 35 99 2A 41 00 8B 1D 99 2A 41 00 8F 05 0D 2A 41 00 8B 35 0D 2A 41 0057 &nbsp; 89 1C 24 8F 05 05 29 41 00 8F 05 19 28 4100 FF 35 19 28 41 00 5B FF 35 05 29 41 00 89 05 D5 2A 41 00 FF 35 D5 2A 41 00 89 3C 24 89 0C 24C7 04 24 A0 61 40 00 57 8F 05 E1 2A 41 00 FF 35 E1 2A 41 00 89 1C 24 C7 04 24 C0 54 40 00 &nbsp; 64 A1 00 00 00 00 89 05 A5 29 41 00 FF 35A5 29 41 00 89 1C 24 89 0D 85 2A 41 00 FF 35 85 2A 41 00 57 BF 91 29 41 00 8B CF 5F 56 8B F1 8BDE 5E 8B 0C 24 8F 05 B5 2A 41 00 89 03 8B 1C 24 8F 05 ED 28 41 00 FF 35 91 29 41 00 &nbsp; 64 89 25 00 00 00 00 83 EC 68 53 8F 05 D529 41 00 FF 35 D5 29 41 00 8F 05 99 28 41 00 FF 35 99 28 41 00 57 89 04 24 8F 05 65 29 41 00 FF35 65 29 41 00 89 34 24 52 8F 05 F1 28 41 00 FF 35 F1 28 41 00 89 3D C9 2A 41 00 FF 35 C9 2A 4100 &nbsp; 56 8F 05 31 2A 41 00 60 61 68 E5 2A 41 005F 51 8B CF 8B D1 59 8F 05 B9 28 41 00 8B 3D B9 28 41 00 89 3A 8F 05 D1 28 41 00 53 BB D1 28 4100 8B 13 5B FF 35 E5 2A 41 00 89 65 E8 33 DB 89 5D FC 89 15 85 29 41 00 FF 35 85 29 41 00 89 3424 53 89 14 24 50 B8 02 00 00 00 60 &nbsp; 8B D0 58 52 5E 8F 05 01 2A 41 00 8B 15 012A 41 00 56 89 14 24 50 B8 25 29 41 00 8B D0 58 89 32 8F 05 AD 29 41 00 8B 15 AD 29 41 00 8B 3424 8F 05 B9 2A 41 00 FF 35 25 29 41 00 FF 15 98 60 40 00 8F 05 01 29 41 00 50 B8 5D 2A 41 00 8938 58 &nbsp; FF 35 5D 2A 41 00 51 C7 04 24 01 29 41 008F 05 85 28 41 00 8B 3D 85 28 41 00 8B 0F 8B 3C 24 8F 05 61 29 41 00 83 0D B4 F1 40 00 FF 83 0DB8 F1 40 00 FF FF 15 9C 60 40 00 89 05 C1 28 41 00 FF 35 C1 28 41 00 57 BF 35 28 41 00 8B C7 5F89 30 &nbsp; 8B 04 24 8F 05 41 28 41 00 FF 35 35 28 4100 50 8F 05 6D 2A 41 00 FF 35 6D 2A 41 00 89 3D 39 28 41 00 FF 35 39 28 41 00 51 B9 7C 71 40 008B F9 59 57 58 5F 50 5E 8F 05 2D 2A 41 00 8B 05 2D 2A 41 00 8B 0E 8F 05 11 2B 41 00 FF 35 11 2B41 00 &nbsp; 55 8F 05 25 2B 41 00 60 61 5E 89 08 FF 15A0 60 40 00 52 8F 05 55 2A 41 00 FF 35 55 2A 41 00 C7 05 29 29 41 00 78 71 40 00 FF 35 29 29 4100 8F 05 35 2A 41 00 8B 15 35 2A 41 00 8B 0A 8F 05 C9 28 41 00 50 B8 C9 28 41 00 8B 10 58 89 08A1 A4 60 40 00 &nbsp; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2014/07/10/6eca87d5ca1c1890144cdf02f6714e14.html","headline":"加密壳之ACProtect之OEP的处理","dateModified":"2014-07-10T00:00:00+08:00","datePublished":"2014-07-10T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2014/07/10/6eca87d5ca1c1890144cdf02f6714e14.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>加密壳之ACProtect之OEP的处理</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p align="center"><strong>菜驹也玩加密壳之ACProtect之OEP的处理</strong></p>
  <p>附件下载：<a href="http://download.csdn.net/detail/xiaocaiju/7616757" rel="nofollow">加壳文件和pdf</a></p>
  <p><br></p>
  <p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;加密过程：</p>
  <p>ACProctect v1.41版本</p>
  <p> </p>
  <p>分析对OEP入口点代码的偷取</p>
  <p>&nbsp;</p>
  <p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;分析过程：</p>
  <p>载入后，EIP= 00412000</p>
  <p>00412000&gt;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</p>
  <p>00412001&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00412007</p>
  <p>00412006&nbsp; - 7E 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jle Xvcmfc库1.00411F8B</p>
  <p>00412008&nbsp;&nbsp;&nbsp; 04 24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add al,0x24</p>
  <p>0041200A&nbsp;&nbsp;&nbsp; 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push es</p>
  <p>0041200B&nbsp;&nbsp;&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn</p>
  <p>0041200C&nbsp;&nbsp;&nbsp; 77 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.0041200F</p>
  <p>0041200E&nbsp;&nbsp;&nbsp; 43&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc ebx</p>
  <p>0041200F&nbsp;&nbsp;&nbsp; FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cld</p>
  <p>00412010&nbsp;&nbsp;&nbsp; 75 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz Xvcmfc库1.00412013</p>
  <p>入口点是在壳段（地址：00412000,大小:19000）</p>
  <p>&nbsp;</p>
  <p>根据壳的特征，用ESP，在00412001处下HR ESP</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 来到这里：</p>
  <p>0041254A&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>0041254B&nbsp;&nbsp;&nbsp; 8F05 A1294100&nbsp;&nbsp; pop dword ptr ds:[0x4129A1]</p>
  <p>00412551&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</p>
  <p>00412552&nbsp;&nbsp;&nbsp; 78 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; js Xvcmfc库1.00412557</p>
  <p>00412554&nbsp;&nbsp;&nbsp; 79 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jns Xvcmfc库1.00412557</p>
  <p>00412556&nbsp;&nbsp;&nbsp; 7B 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jpo Xvcmfc库1.00412598</p>
  <p>&nbsp;</p>
  <p>可以看到pushad,清除上面的硬件断点后，在pushad下面下HR ESP</p>
  <p>来到这里：</p>
  <p>00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</p>
  <p>00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;; [889] = ecx</p>
  <p>0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</p>
  <p>0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad</p>
  <p>0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</p>
  <p>0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx</p>
  <p>00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD]</p>
  <p>00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx</p>
  <p>0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1]</p>
  <p>00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911</p>
  <p>0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi</p>
  <p>0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx</p>
  <p>0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911</p>
  <p>00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D]</p>
  <p>00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D]</p>
  <p>0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp</p>
  <p>0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1]</p>
  <p>00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1</p>
  <p>0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptr ds:[esi]</p>
  <p>0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp</p>
  <p>004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp</p>
  <p><span style="color:#FF0000;">004277A9&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop</span></p>
  <p><span style="color:#FF0000;">004277AA&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop</span></p>
  <p><span style="color:#FF0000;">004277AB&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</span></p>
  <p>004277AC&nbsp;&nbsp;&nbsp; E8 01000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.004277B2</p>
  <p>004277B1&nbsp; ^ 77 83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ja Xvcmfc库1.00427736</p>
  <p>注意其中的nop nop pushad 这三条指令，出现这个意味着这就是偷取的代码的开始。。。。当然，这里的nop是随意填充的，可能没有，也可能有一个，也可能有两个，也可能多个..关键是pushad指令</p>
  <p>&nbsp;</p>
  <p>把NOP之前的指令全部复制成二进制保存。</p>
  <p>00427753&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</p>
  <p>00427754&nbsp;&nbsp;&nbsp; 8F05 89284100&nbsp;&nbsp; pop dword ptr ds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889] = ecx</p>
  <p>0042775A&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</p>
  <p>0042775B&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad</p>
  <p>0042775C&nbsp;&nbsp;&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</p>
  <p>0042775D&nbsp;&nbsp;&nbsp; 8F05 CD294100&nbsp;&nbsp; pop dword ptr ds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd] = ecx</p>
  <p>00427763&nbsp;&nbsp;&nbsp; FF35 CD294100&nbsp;&nbsp; push dword ptr ds:[0x4129CD]</p>
  <p>00427769&nbsp;&nbsp;&nbsp; 8915 E1284100&nbsp;&nbsp; mov dword ptr ds:[0x4128E1],edx</p>
  <p>0042776F&nbsp;&nbsp;&nbsp; FF35 E1284100&nbsp;&nbsp; push dword ptr ds:[0x4128E1]</p>
  <p>00427775&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>00427776&nbsp;&nbsp;&nbsp; BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911</p>
  <p>0042777B&nbsp;&nbsp;&nbsp; 8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi</p>
  <p>0042777D&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>0042777E&nbsp;&nbsp;&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx</p>
  <p>0042777F&nbsp;&nbsp;&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911</p>
  <p>00427780&nbsp;&nbsp;&nbsp; 8F05 3D284100&nbsp;&nbsp; pop dword ptr ds:[0x41283D]</p>
  <p>00427786&nbsp;&nbsp;&nbsp; 8B15 3D284100&nbsp;&nbsp; mov edx,dword ptr ds:[0x41283D]</p>
  <p>0042778C&nbsp;&nbsp;&nbsp; 8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr ds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [412911] = ebp</p>
  <p>0042778E&nbsp;&nbsp;&nbsp; 8F05 A12A4100&nbsp;&nbsp; pop dword ptr ds:[0x412AA1]</p>
  <p>00427794&nbsp;&nbsp;&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>00427795&nbsp;&nbsp;&nbsp; BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1</p>
  <p>0042779A&nbsp;&nbsp;&nbsp; 8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;mov ecx,dword ptr ds:[esi]</p>
  <p>0042779C&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>0042779D&nbsp;&nbsp;&nbsp; FF35 11294100&nbsp;&nbsp; push dword ptr ds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp</p>
  <p>004277A3&nbsp;&nbsp;&nbsp; 8925 192B4100&nbsp;&nbsp; mov dword ptr ds:[0x412B19],esp</p>
  <p>&nbsp;</p>
  <p>这段代码的二进制数据为：</p>
  <p>51 8F 05 89 2841 00 60 61 51 8F 05 CD 29 41 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E128 41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F 05 3D 28 41 00 8B 15 3D 28 41 0089 29 8F 05 A1 2A 41 00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 29 41 00 89 25 192B 41 00</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>重复上面的步骤，直到n次，怎么确定n,我这里是弹出试用版nag之后就出现了。</p>
  <p>把这n次之间的二进制数据都保存下来。</p>
  <p>00429106&nbsp;&nbsp; /EB 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp Xvcmfc库1.00429109</p>
  <p>00429108&nbsp;&nbsp; |E8 FF254B91&nbsp;&nbsp;&nbsp;&nbsp; call 918DB70C</p>
  <p>0042910D&nbsp;&nbsp;&nbsp; 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc edx</p>
  <p>&nbsp;</p>
  <p>00429106处是一个近跳，F7进去</p>
  <p>00429109&nbsp; - FF25 4B914200&nbsp;&nbsp; jmp dword ptr ds:[0x42914B]&nbsp;&nbsp;&nbsp; ; vcmfc库1.00405391</p>
  <p>0042910F&nbsp;&nbsp;&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</p>
  <p>00429110&nbsp;&nbsp;&nbsp; E8 00000000&nbsp;&nbsp;&nbsp;&nbsp; call vcmfc库1.00429115</p>
  <p>00429115&nbsp;&nbsp;&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>00429116&nbsp;&nbsp;&nbsp; 83EE 06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esi,0x6</p>
  <p>其中：</p>
  <p>ds:[0042914B]=00405391 (vcmfc库1.00405391)</p>
  <p>这是一个跨段的长跳转，<strong><span style="color:#FF0000;">何为跨段？</span></strong>当前指令是在00429109 它要跳到00405391，</p>
  <p> </p>
  <p>从模块图中看出，它是要从.perplex段跳到.text段执行..这就是传说中的跨段</p>
  <p>&nbsp;</p>
  <p>所以说，进到代码段后，就是传说中的伪OEP了，伪OEP是长得这个样子的</p>
  <p> </p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>下面就把它DUMP出来</p>
  <p>用import rec修复下IAT，没有问题 fix一下dump出来的文件</p>
  <p>&nbsp;</p>
  <p>Import rec会给文件加一个.mackt的区段，里面存的是输入表，大小为1000，输入表用不了这么大的空间，我们把被偷的代码放在这个区段里好了。</p>
  <p>用OD打开修复过和dump_.exe，在0042b000的段处找一个空的位置，</p>
  <p>我找的是0042BBA0，把上面得到的二进制贴上去，贴完后，再加上一句JMP&nbsp;&nbsp;&nbsp;&nbsp; 00405391（跳到伪OEP）</p>
  <p>0042BEBF&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP&nbsp;&nbsp;&nbsp;&nbsp; EAX</p>
  <p>0042BEC0&nbsp;&nbsp;&nbsp;8908&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; DWORD PTR DS:[EAX], ECX</p>
  <p>0042BEC2&nbsp;&nbsp;&nbsp;A1 A4604000&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp;&nbsp; EAX, DWORD PTR DS:[0x4060A4]</p>
  <p>0042BEC7&nbsp;- E9 C594FDFF&nbsp;&nbsp;&nbsp;&nbsp; JMP&nbsp;&nbsp;&nbsp;&nbsp; dumped_.&lt;ModuleEntryPoint&gt;</p>
  <p>&nbsp;</p>
  <p>用LOAD PE把入口点修改成0042BBA0，OK，完工。。。</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>保存的所有的二进制数据:</p>
  <p>00427753&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</p>
  <p>00427754&nbsp;&nbsp;&nbsp;8F05 89284100&nbsp;&nbsp; pop dword ptrds:[0x412889]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [889]= ecx</p>
  <p>0042775A&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad</p>
  <p>0042775B&nbsp;&nbsp;&nbsp;61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad</p>
  <p>0042775C&nbsp;&nbsp;&nbsp;51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</p>
  <p>0042775D&nbsp;&nbsp;&nbsp;8F05 CD294100&nbsp;&nbsp; pop dword ptrds:[0x4129CD]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; [9cd]= ecx</p>
  <p>00427763&nbsp;&nbsp;&nbsp;FF35 CD294100&nbsp;&nbsp; push dword ptrds:[0x4129CD]</p>
  <p>00427769&nbsp;&nbsp;&nbsp;8915 E1284100&nbsp;&nbsp; mov dword ptrds:[0x4128E1],edx</p>
  <p>0042776F&nbsp;&nbsp;&nbsp;FF35 E1284100&nbsp;&nbsp; push dword ptrds:[0x4128E1]</p>
  <p>00427775&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>00427776&nbsp;&nbsp;&nbsp;BE 11294100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412911</p>
  <p>0042777B&nbsp;&nbsp;&nbsp;8BD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx,esi</p>
  <p>0042777D&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>0042777E &nbsp;&nbsp;&nbsp;52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push edx</p>
  <p>0042777F&nbsp;&nbsp;&nbsp;59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; ecx =edx = 412911</p>
  <p>00427780&nbsp;&nbsp;&nbsp;8F05 3D284100&nbsp;&nbsp; pop dword ptrds:[0x41283D]</p>
  <p>00427786&nbsp;&nbsp;&nbsp;8B15 3D284100&nbsp;&nbsp; mov edx,dword ptrds:[0x41283D]</p>
  <p>0042778C&nbsp;&nbsp;&nbsp;8929&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptrds:[ecx],ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;[412911] = ebp</p>
  <p>0042778E&nbsp;&nbsp;&nbsp;8F05 A12A4100&nbsp;&nbsp; pop dword ptrds:[0x412AA1]</p>
  <p>00427794&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push esi</p>
  <p>00427795&nbsp;&nbsp;&nbsp;BE A12A4100&nbsp;&nbsp;&nbsp;&nbsp; mov esi,vcmfc库1.00412AA1</p>
  <p>0042779A&nbsp;&nbsp;&nbsp;8B0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,dword ptrds:[esi]</p>
  <p>0042779C&nbsp;&nbsp;&nbsp;5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop esi</p>
  <p>0042779D&nbsp;&nbsp;&nbsp;FF35 11294100&nbsp;&nbsp; push dword ptrds:[0x412911]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; 这地方就是被偷的第一句代码pushebp</p>
  <p>004277A3&nbsp;&nbsp;&nbsp;8925 192B4100&nbsp;&nbsp; mov dword ptrds:[0x412B19],esp</p>
  <p>&nbsp;</p>
  <p>51 8F 05 89 28 41 00 60 61 51 8F 05 CD 2941 00 FF 35 CD 29 41 00 89 15 E1 28 41 00 FF 35 E1 28</p>
  <p>41 00 56 BE 11 29 41 00 8B D6 5E 52 59 8F05 3D 28 41 00 8B 15 3D 28 41 00 89 29 8F 05 A1 2A 41</p>
  <p>00 56 BE A1 2A 41 00 8B 0E 5E FF 35 11 2941 00 89 25 19 2B 41 00</p>
  <p>&nbsp;</p>
  <p>FF 35 19 2B 41 00 8F 05 C1 29 41 00 56 BEC1 29 41 00 8B 2E 5E 57 BF 9D 29 41 00 89 1F 5F FF 35</p>
  <p>9D 29 41 00 89 35 31 28 41 00 FF 35 31 2841 00 68 FF FF FF FF 5E 89 35 99 2A 41 00 8B 1D 99 2A</p>
  <p>41 00 8F 05 0D 2A 41 00 8B 35 0D 2A 41 0057</p>
  <p>&nbsp;</p>
  <p>89 1C 24 8F 05 05 29 41 00 8F 05 19 28 4100 FF 35 19 28 41 00 5B FF 35 05 29 41 00 89 05 D5 2A</p>
  <p>41 00 FF 35 D5 2A 41 00 89 3C 24 89 0C 24C7 04 24 A0 61 40 00 57 8F 05 E1 2A 41 00 FF 35 E1 2A</p>
  <p>41 00 89 1C 24 C7 04 24 C0 54 40 00</p>
  <p>&nbsp;</p>
  <p>64 A1 00 00 00 00 89 05 A5 29 41 00 FF 35A5 29 41 00 89 1C 24 89 0D 85 2A 41 00 FF 35 85 2A 41</p>
  <p>00 57 BF 91 29 41 00 8B CF 5F 56 8B F1 8BDE 5E 8B 0C 24 8F 05 B5 2A 41 00 89 03 8B 1C 24 8F 05</p>
  <p>ED 28 41 00 FF 35 91 29 41 00</p>
  <p>&nbsp;</p>
  <p>64 89 25 00 00 00 00 83 EC 68 53 8F 05 D529 41 00 FF 35 D5 29 41 00 8F 05 99 28 41 00 FF 35 99</p>
  <p>28 41 00 57 89 04 24 8F 05 65 29 41 00 FF35 65 29 41 00 89 34 24 52 8F 05 F1 28 41 00 FF 35 F1</p>
  <p>28 41 00 89 3D C9 2A 41 00 FF 35 C9 2A 4100</p>
  <p>&nbsp;</p>
  <p>56 8F 05 31 2A 41 00 60 61 68 E5 2A 41 005F 51 8B CF 8B D1 59 8F 05 B9 28 41 00 8B 3D B9 28 41</p>
  <p>00 89 3A 8F 05 D1 28 41 00 53 BB D1 28 4100 8B 13 5B FF 35 E5 2A 41 00 89 65 E8 33 DB 89 5D FC</p>
  <p>89 15 85 29 41 00 FF 35 85 29 41 00 89 3424 53 89 14 24 50 B8 02 00 00 00 60</p>
  <p>&nbsp;</p>
  <p>8B D0 58 52 5E 8F 05 01 2A 41 00 8B 15 012A 41 00 56 89 14 24 50 B8 25 29 41 00 8B D0 58 89 32</p>
  <p>8F 05 AD 29 41 00 8B 15 AD 29 41 00 8B 3424 8F 05 B9 2A 41 00 FF 35 25 29 41 00 FF 15 98 60 40</p>
  <p>00 8F 05 01 29 41 00 50 B8 5D 2A 41 00 8938 58</p>
  <p>&nbsp;</p>
  <p>FF 35 5D 2A 41 00 51 C7 04 24 01 29 41 008F 05 85 28 41 00 8B 3D 85 28 41 00 8B 0F 8B 3C 24 8F</p>
  <p>05 61 29 41 00 83 0D B4 F1 40 00 FF 83 0DB8 F1 40 00 FF FF 15 9C 60 40 00 89 05 C1 28 41 00 FF</p>
  <p>35 C1 28 41 00 57 BF 35 28 41 00 8B C7 5F89 30</p>
  <p>&nbsp;</p>
  <p>8B 04 24 8F 05 41 28 41 00 FF 35 35 28 4100 50 8F 05 6D 2A 41 00 FF 35 6D 2A 41 00 89 3D 39 28</p>
  <p>41 00 FF 35 39 28 41 00 51 B9 7C 71 40 008B F9 59 57 58 5F 50 5E 8F 05 2D 2A 41 00 8B 05 2D 2A</p>
  <p>41 00 8B 0E 8F 05 11 2B 41 00 FF 35 11 2B41 00</p>
  <p>&nbsp;</p>
  <p>55 8F 05 25 2B 41 00 60 61 5E 89 08 FF 15A0 60 40 00 52 8F 05 55 2A 41 00 FF 35 55 2A 41 00 C7</p>
  <p>05 29 29 41 00 78 71 40 00 FF 35 29 29 4100 8F 05 35 2A 41 00 8B 15 35 2A 41 00 8B 0A 8F 05 C9</p>
  <p>28 41 00 50 B8 C9 28 41 00 8B 10 58 89 08A1 A4 60 40 00</p>
  <p>&nbsp;</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/xiaocaiju/article/details/37656995,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/xiaocaiju/article/details/37656995,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
