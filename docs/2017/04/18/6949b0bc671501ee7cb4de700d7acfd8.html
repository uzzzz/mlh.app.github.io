<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>git fabric 1.0.0 官方源码进行编译，生成 docker images | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="git fabric 1.0.0 官方源码进行编译，生成 docker images" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="系统环境：centos 7 64位 docker docker-compose 不要使用 centos yum 仓库带的 docker，版本过低。 安装docker 官方的repo 里面的版本 $ sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-&#39;EOF&#39; [dockerrepo] name=Docker Repository baseurl=https://yum.dockerproject.org/repo/main/centos/7/ enabled=1 gpgcheck=1 gpgkey=https://yum.dockerproject.org/gpg EOF yum update yum install docker-engine systemctl enable docker systemctl restart docker 一.添加 fabric 用户和设置存放源码的目录 useradd fabric # 以 fabric 用户登录，建立如下项目目录. mkdir /home/fabric/fabric 二.安装 go 的开发环境和必须的组件 以 root 用户安装 wget https://storage.googleapis.com/golang/go1.8.1.linux-amd64.tar.gz tar -xzvf go1.8.1.linux-amd64.tar.gz mv ./go /usr/local //修改 etc/profile，增加 如下2行内容 export GOROOT=/usr/local/go export PATH=$PATH:$GOROOT/bin source /etc/profile #安装后,确认 go 1.8 安装成功 go version go version go1.8 darwin/amd64 #如果无法科学上网，使用如下步骤: # 1. 以 root安装 gopm export GOPATH=/usr/local go get -u github.com/gpmgo/gopm #确认在/usr/local/bin 目录下有 gopm # 2. 以 fabric 用户，通过 gopm 安装 goimports export GOPATH=/home/fabric/fabric gopm get -g -d golang.org/x/tools/cmd/goimports #再使用 go install 安装 goimports go install golang.org/x/tools/cmd/goimports #确认在/home/fabric/fabric/bin 目录下有 goimports 以 fabric 用户 安装 gocov GOPATH=/home/fabric/fabric gopm get -g -d golang.org/x/tools/cover gopm get -g -d github.com/axw/gocov/gocov go install github.com/axw/gocov/gocov # 确认 /home/fabric/fabric/bin 目录下有 gocov 安装 gocov-xml GOPATH=/home/fabric/fabric gopm get -g -d github.com/AlekSi/gocov-xml go install github.com/AlekSi/gocov-xml #确认 /home/fabric/fabric/bin 目录下有 gocov-xml 三. 安装其他必须的组件 以 root 用户安装 ``` centos 下需要安装 yum install -y gcc libtool libltdl-dev libtool-ltdl-devel openssl ## 四.设置fabric环境变量 vim ~/.bashrc export GOPATH=/home/fabric/fabric 使得环境变量生效 source ~/.bashrc ``` 五.进入项目目录 cd $GOPATH 六. 建立 go 源码目录结构(一定要建立 src/github.com/hyperledger ，否则无法使用 go 进行编译) cd $GOPATH mkdir -p src/github.com/hyperledger 七.拉取 fabric 的源码 cd $GOPATH/src/github.com/hyperledger git clone https://github.com/hyperledger/fabric.git 八.编译生成 protoc-gen-go #编译生成 protoc-gen-go cd $GOPATH gopm get -g -d github.com/golang/protobuf/protoc-gen-go go install github.com/golang/protobuf/protoc-gen-go #确认在$GOPATH/bin出现protoc-gen-go执行文件 九. 编译 fabric docker 环境 cd $GOPATH/src/github.com/hyperledger/fabric make docker 如果出现 Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock 这个错误。 解决方案： 1. 把 fabric 用户加入到 sudo 组 a. 以 root 用户登录 b. vim /etc/sudoers c. 增加 fabric ALL=(ALL) ALL 一行到root ALL=(ALL) ALL下面 2. sudo usermod -a -G docker \(USER 3. newgrp - docker 4. newgrp - `groups \){USER} | cut -d&#39; &#39; -f1` 参考： https://techoverflow.net/2017/03/01/solving-docker-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket/ 十.如果出现文件或者命令没找到的错误，复制go 的相关文件到 fabric 编译环境 cp $GOPATH/bin/protoc-gen-go $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ cp $GOPATH/bin/gocov $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ 十一.编译 fabric ca 环境 cd /root git clone https://github.com/hyperledger/fabric-ca.git cd fabric-ca make docker 十二. 部署和测试 e2e 应用 一键启动 cd $GOPATH/src/github.com/hyperledger/fabric/examples/e2e_cli ./network_setup.sh up mytestchannel 十三. 部署 Fabric Sample 官方文档：http://hyperledger-fabric.readthedocs.io/en/latest/samples.html 1.拉取Fabric Sample 的源码 cd ~ git clone https://github.com/hyperledger/fabric-samples.git cd ~/fabric-samples 2. 下载所需要的执行文件。 官方方法 直接 通过如下命令 ： curl -sSL https://goo.gl/iX9dek | bash 由于不能科学上网。只能通过 浏览器访问 https://goo.gl/iX9dek 或则 访问 https://raw.githubusercontent.com/hyperledger/fabric/master/scripts/bootstrap-1.0.0.sh 然后把这个 shell 文件保存到 ~/fabric-samples/run.sh 文件内。 然后chmod +xxx ~/fabric-samples/run.sh 。 成功后运行 run.sh。 shell 会自动拉取所有的 fabric 1.0.0 的 image 并且生成 bin目录。目录下有下列文件： cryptogen, configtxgen, configtxlator peer Finally, the script will download the Hyperledger Fabric docker images from Docker Hub into your local Docker registry and tag them as ‘latest’. The script lists out the Docker images installed upon conclusion. Look at the names for each image; these are the components that will ultimately comprise our Hyperledger Fabric network. You will also notice that you have two instances of the same image ID - one tagged as “x86_64-1.0.0” and one tagged as “latest”. 3. 更新环境变量 PATH export PATH=/home/fabric/fabric-samples/bin:$PATH 4. run it now cd ~/fabric-samples/first-network ./byfn.sh -m generate 成功后，控制台显示 [fabric@fabirc first-network]$ ./byfn.sh -m generate Generating certs and genesis block for with channel &#39;mychannel&#39; and CLI timeout of &#39;10000&#39; Continue (y/n)? y proceeding ... /home/fabric/fabric-samples/bin/cryptogen ########################################################## ##### Generate certificates using cryptogen tool ######### ########################################################## org1.example.com org2.example.com /home/fabric/fabric-samples/bin/configtxgen ########################################################## ######### Generating Orderer Genesis block ############## ########################################################## 2017-07-21 15:05:30.414 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.453 CST [common/configtx/tool] doOutputBlock -&gt; INFO 002 Generating genesis block 2017-07-21 15:05:30.455 CST [common/configtx/tool] doOutputBlock -&gt; INFO 003 Writing genesis block ################################################################# ### Generating channel configuration transaction &#39;channel.tx&#39; ### ################################################################# 2017-07-21 15:05:30.489 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.496 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 002 Generating new channel configtx 2017-07-21 15:05:30.497 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 003 Writing new channel tx ################################################################# ####### Generating anchor peer update for Org1MSP ########## ################################################################# 2017-07-21 15:05:30.541 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.545 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update 2017-07-21 15:05:30.546 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update ################################################################# ####### Generating anchor peer update for Org2MSP ########## ################################################################# 2017-07-21 15:05:30.590 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update 2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update [fabric@fabirc first-network]$ 5.启动网络 ./byfn.sh -m up 如果以前做过测试，特别是通过源码编译，运行过e2e_cli 例子后。这里可能会报告 容器已经存在的错误。 ERROR: for peer0.org1.example.com Cannot create container for service peer0.org1.example.com: Conflict. The container name &quot;/peer0.org1.example.com&quot; is already in use by container &quot;f8ab810101f3db4eb5e0a15ef2e06f0fee19259225541031d73c6eaa70a0640e&quot;.Creating peer1.org1.example.com ... error ERROR: for peer1.org1.example.com Cannot create container for service peer1.org1.example.com: Conflict. The container name &quot;/peer1.org1.example.com&quot; is already in use by container &quot;1517363d7424e01e07f1e5230fcc955d2cc4a1f8778842777ea5a237fedc9b3b&quot;.Creating peer0.org2.example.com ... error ERROR: for peer0.org2.example.com Cannot create container for service peer0.org2.example.com: Conflict. The container name &quot;/peer0.org2.example.com&quot; is already in use by container &quot;513aeb4b3d8f9b3ec2f90c42d19d6c4a9b2aa058ad39f931de009be8980a192f&quot;.Creating peer1.org2.example.com ... error ERROR: for peer1.org2.example.com Cannot create container for service peer1.org2.example.com: Conflict. The container name &quot;/peer1.org2.example.com&quot; is already in use by container &quot;c9ac14cc4a6b002dec353bcd2e008752c00f4129d811e250b38c2702c9d83e28&quot;.Creating orderer.example.com ... error 可以通过下面命令，清除一下原有的容器，并且删除原来的测试容器用的 images docker rm -f $(docker ps -aq) docker rmi $(docker images -a | grep dev- | awk &#39;{print $3 }&#39;) 控制台出现 ： Starting with channel &#39;mychannel&#39; and CLI timeout of &#39;10000&#39; Continue (y/n)?y proceeding ... Creating network &quot;net_byfn&quot; with the default driver Creating peer0.org1.example.com Creating peer1.org1.example.com Creating peer0.org2.example.com Creating orderer.example.com Creating peer1.org2.example.com Creating cli ____ _____ _ ____ _____ / ___| |_ _| / \ | _ \ |_ _| \___ \ | | / _ \ | |_) | | | ___) | | | / ___ \ | _ &lt; | | |____/ |_| /_/ \_\ |_| \_\ |_| Channel name : mychannel Creating channel... The logs will continue from there. This will launch all of the containers, and then drive a complete end-to-end application scenario. Upon successful completion, it should report the following in your terminal window: Attempting to Query PEER3 ...3 secs 2017-07-21 07:22:03.903 UTC [msp] GetLocalMSP -&gt; DEBU 001 Returning existing local MSP 2017-07-21 07:22:03.903 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 002 Obtaining default signing identity 2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 003 Using default escc 2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 004 Using default vscc 2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 005 Sign: plaintext: 0A95070A6708031A0C089BD7C6CB0510...6D7963631A0A0A0571756572790A0161 2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 006 Sign: digest: 56559226BBF8E0BAC8522F3728F6AC5141868518117FEBE522CC7354DB856494 Query Result: 90 2017-07-21 07:22:18.236 UTC [main] main -&gt; INFO 007 Exiting..... ===================== Query on PEER3 on channel &#39;mychannel&#39; is successful ===================== ========= All GOOD, BYFN execution completed =========== _____ _ _ ____ | ____| | \ | | | _ \ | _| | \| | | | | | | |___ | |\ | | |_| | |_____| |_| \_| |____/ 6.停止和卸载，删除容器，镜像. The following will kill your containers, remove the crypto material and four artifacts, and delete the chaincode images from your Docker Registry: ./byfn.sh -m down 阅读更多" />
<meta property="og:description" content="系统环境：centos 7 64位 docker docker-compose 不要使用 centos yum 仓库带的 docker，版本过低。 安装docker 官方的repo 里面的版本 $ sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-&#39;EOF&#39; [dockerrepo] name=Docker Repository baseurl=https://yum.dockerproject.org/repo/main/centos/7/ enabled=1 gpgcheck=1 gpgkey=https://yum.dockerproject.org/gpg EOF yum update yum install docker-engine systemctl enable docker systemctl restart docker 一.添加 fabric 用户和设置存放源码的目录 useradd fabric # 以 fabric 用户登录，建立如下项目目录. mkdir /home/fabric/fabric 二.安装 go 的开发环境和必须的组件 以 root 用户安装 wget https://storage.googleapis.com/golang/go1.8.1.linux-amd64.tar.gz tar -xzvf go1.8.1.linux-amd64.tar.gz mv ./go /usr/local //修改 etc/profile，增加 如下2行内容 export GOROOT=/usr/local/go export PATH=$PATH:$GOROOT/bin source /etc/profile #安装后,确认 go 1.8 安装成功 go version go version go1.8 darwin/amd64 #如果无法科学上网，使用如下步骤: # 1. 以 root安装 gopm export GOPATH=/usr/local go get -u github.com/gpmgo/gopm #确认在/usr/local/bin 目录下有 gopm # 2. 以 fabric 用户，通过 gopm 安装 goimports export GOPATH=/home/fabric/fabric gopm get -g -d golang.org/x/tools/cmd/goimports #再使用 go install 安装 goimports go install golang.org/x/tools/cmd/goimports #确认在/home/fabric/fabric/bin 目录下有 goimports 以 fabric 用户 安装 gocov GOPATH=/home/fabric/fabric gopm get -g -d golang.org/x/tools/cover gopm get -g -d github.com/axw/gocov/gocov go install github.com/axw/gocov/gocov # 确认 /home/fabric/fabric/bin 目录下有 gocov 安装 gocov-xml GOPATH=/home/fabric/fabric gopm get -g -d github.com/AlekSi/gocov-xml go install github.com/AlekSi/gocov-xml #确认 /home/fabric/fabric/bin 目录下有 gocov-xml 三. 安装其他必须的组件 以 root 用户安装 ``` centos 下需要安装 yum install -y gcc libtool libltdl-dev libtool-ltdl-devel openssl ## 四.设置fabric环境变量 vim ~/.bashrc export GOPATH=/home/fabric/fabric 使得环境变量生效 source ~/.bashrc ``` 五.进入项目目录 cd $GOPATH 六. 建立 go 源码目录结构(一定要建立 src/github.com/hyperledger ，否则无法使用 go 进行编译) cd $GOPATH mkdir -p src/github.com/hyperledger 七.拉取 fabric 的源码 cd $GOPATH/src/github.com/hyperledger git clone https://github.com/hyperledger/fabric.git 八.编译生成 protoc-gen-go #编译生成 protoc-gen-go cd $GOPATH gopm get -g -d github.com/golang/protobuf/protoc-gen-go go install github.com/golang/protobuf/protoc-gen-go #确认在$GOPATH/bin出现protoc-gen-go执行文件 九. 编译 fabric docker 环境 cd $GOPATH/src/github.com/hyperledger/fabric make docker 如果出现 Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock 这个错误。 解决方案： 1. 把 fabric 用户加入到 sudo 组 a. 以 root 用户登录 b. vim /etc/sudoers c. 增加 fabric ALL=(ALL) ALL 一行到root ALL=(ALL) ALL下面 2. sudo usermod -a -G docker \(USER 3. newgrp - docker 4. newgrp - `groups \){USER} | cut -d&#39; &#39; -f1` 参考： https://techoverflow.net/2017/03/01/solving-docker-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket/ 十.如果出现文件或者命令没找到的错误，复制go 的相关文件到 fabric 编译环境 cp $GOPATH/bin/protoc-gen-go $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ cp $GOPATH/bin/gocov $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ 十一.编译 fabric ca 环境 cd /root git clone https://github.com/hyperledger/fabric-ca.git cd fabric-ca make docker 十二. 部署和测试 e2e 应用 一键启动 cd $GOPATH/src/github.com/hyperledger/fabric/examples/e2e_cli ./network_setup.sh up mytestchannel 十三. 部署 Fabric Sample 官方文档：http://hyperledger-fabric.readthedocs.io/en/latest/samples.html 1.拉取Fabric Sample 的源码 cd ~ git clone https://github.com/hyperledger/fabric-samples.git cd ~/fabric-samples 2. 下载所需要的执行文件。 官方方法 直接 通过如下命令 ： curl -sSL https://goo.gl/iX9dek | bash 由于不能科学上网。只能通过 浏览器访问 https://goo.gl/iX9dek 或则 访问 https://raw.githubusercontent.com/hyperledger/fabric/master/scripts/bootstrap-1.0.0.sh 然后把这个 shell 文件保存到 ~/fabric-samples/run.sh 文件内。 然后chmod +xxx ~/fabric-samples/run.sh 。 成功后运行 run.sh。 shell 会自动拉取所有的 fabric 1.0.0 的 image 并且生成 bin目录。目录下有下列文件： cryptogen, configtxgen, configtxlator peer Finally, the script will download the Hyperledger Fabric docker images from Docker Hub into your local Docker registry and tag them as ‘latest’. The script lists out the Docker images installed upon conclusion. Look at the names for each image; these are the components that will ultimately comprise our Hyperledger Fabric network. You will also notice that you have two instances of the same image ID - one tagged as “x86_64-1.0.0” and one tagged as “latest”. 3. 更新环境变量 PATH export PATH=/home/fabric/fabric-samples/bin:$PATH 4. run it now cd ~/fabric-samples/first-network ./byfn.sh -m generate 成功后，控制台显示 [fabric@fabirc first-network]$ ./byfn.sh -m generate Generating certs and genesis block for with channel &#39;mychannel&#39; and CLI timeout of &#39;10000&#39; Continue (y/n)? y proceeding ... /home/fabric/fabric-samples/bin/cryptogen ########################################################## ##### Generate certificates using cryptogen tool ######### ########################################################## org1.example.com org2.example.com /home/fabric/fabric-samples/bin/configtxgen ########################################################## ######### Generating Orderer Genesis block ############## ########################################################## 2017-07-21 15:05:30.414 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.453 CST [common/configtx/tool] doOutputBlock -&gt; INFO 002 Generating genesis block 2017-07-21 15:05:30.455 CST [common/configtx/tool] doOutputBlock -&gt; INFO 003 Writing genesis block ################################################################# ### Generating channel configuration transaction &#39;channel.tx&#39; ### ################################################################# 2017-07-21 15:05:30.489 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.496 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 002 Generating new channel configtx 2017-07-21 15:05:30.497 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 003 Writing new channel tx ################################################################# ####### Generating anchor peer update for Org1MSP ########## ################################################################# 2017-07-21 15:05:30.541 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.545 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update 2017-07-21 15:05:30.546 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update ################################################################# ####### Generating anchor peer update for Org2MSP ########## ################################################################# 2017-07-21 15:05:30.590 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update 2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update [fabric@fabirc first-network]$ 5.启动网络 ./byfn.sh -m up 如果以前做过测试，特别是通过源码编译，运行过e2e_cli 例子后。这里可能会报告 容器已经存在的错误。 ERROR: for peer0.org1.example.com Cannot create container for service peer0.org1.example.com: Conflict. The container name &quot;/peer0.org1.example.com&quot; is already in use by container &quot;f8ab810101f3db4eb5e0a15ef2e06f0fee19259225541031d73c6eaa70a0640e&quot;.Creating peer1.org1.example.com ... error ERROR: for peer1.org1.example.com Cannot create container for service peer1.org1.example.com: Conflict. The container name &quot;/peer1.org1.example.com&quot; is already in use by container &quot;1517363d7424e01e07f1e5230fcc955d2cc4a1f8778842777ea5a237fedc9b3b&quot;.Creating peer0.org2.example.com ... error ERROR: for peer0.org2.example.com Cannot create container for service peer0.org2.example.com: Conflict. The container name &quot;/peer0.org2.example.com&quot; is already in use by container &quot;513aeb4b3d8f9b3ec2f90c42d19d6c4a9b2aa058ad39f931de009be8980a192f&quot;.Creating peer1.org2.example.com ... error ERROR: for peer1.org2.example.com Cannot create container for service peer1.org2.example.com: Conflict. The container name &quot;/peer1.org2.example.com&quot; is already in use by container &quot;c9ac14cc4a6b002dec353bcd2e008752c00f4129d811e250b38c2702c9d83e28&quot;.Creating orderer.example.com ... error 可以通过下面命令，清除一下原有的容器，并且删除原来的测试容器用的 images docker rm -f $(docker ps -aq) docker rmi $(docker images -a | grep dev- | awk &#39;{print $3 }&#39;) 控制台出现 ： Starting with channel &#39;mychannel&#39; and CLI timeout of &#39;10000&#39; Continue (y/n)?y proceeding ... Creating network &quot;net_byfn&quot; with the default driver Creating peer0.org1.example.com Creating peer1.org1.example.com Creating peer0.org2.example.com Creating orderer.example.com Creating peer1.org2.example.com Creating cli ____ _____ _ ____ _____ / ___| |_ _| / \ | _ \ |_ _| \___ \ | | / _ \ | |_) | | | ___) | | | / ___ \ | _ &lt; | | |____/ |_| /_/ \_\ |_| \_\ |_| Channel name : mychannel Creating channel... The logs will continue from there. This will launch all of the containers, and then drive a complete end-to-end application scenario. Upon successful completion, it should report the following in your terminal window: Attempting to Query PEER3 ...3 secs 2017-07-21 07:22:03.903 UTC [msp] GetLocalMSP -&gt; DEBU 001 Returning existing local MSP 2017-07-21 07:22:03.903 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 002 Obtaining default signing identity 2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 003 Using default escc 2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 004 Using default vscc 2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 005 Sign: plaintext: 0A95070A6708031A0C089BD7C6CB0510...6D7963631A0A0A0571756572790A0161 2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 006 Sign: digest: 56559226BBF8E0BAC8522F3728F6AC5141868518117FEBE522CC7354DB856494 Query Result: 90 2017-07-21 07:22:18.236 UTC [main] main -&gt; INFO 007 Exiting..... ===================== Query on PEER3 on channel &#39;mychannel&#39; is successful ===================== ========= All GOOD, BYFN execution completed =========== _____ _ _ ____ | ____| | \ | | | _ \ | _| | \| | | | | | | |___ | |\ | | |_| | |_____| |_| \_| |____/ 6.停止和卸载，删除容器，镜像. The following will kill your containers, remove the crypto material and four artifacts, and delete the chaincode images from your Docker Registry: ./byfn.sh -m down 阅读更多" />
<link rel="canonical" href="https://mlh.app/2017/04/18/6949b0bc671501ee7cb4de700d7acfd8.html" />
<meta property="og:url" content="https://mlh.app/2017/04/18/6949b0bc671501ee7cb4de700d7acfd8.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-04-18T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"系统环境：centos 7 64位 docker docker-compose 不要使用 centos yum 仓库带的 docker，版本过低。 安装docker 官方的repo 里面的版本 $ sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-&#39;EOF&#39; [dockerrepo] name=Docker Repository baseurl=https://yum.dockerproject.org/repo/main/centos/7/ enabled=1 gpgcheck=1 gpgkey=https://yum.dockerproject.org/gpg EOF yum update yum install docker-engine systemctl enable docker systemctl restart docker 一.添加 fabric 用户和设置存放源码的目录 useradd fabric # 以 fabric 用户登录，建立如下项目目录. mkdir /home/fabric/fabric 二.安装 go 的开发环境和必须的组件 以 root 用户安装 wget https://storage.googleapis.com/golang/go1.8.1.linux-amd64.tar.gz tar -xzvf go1.8.1.linux-amd64.tar.gz mv ./go /usr/local //修改 etc/profile，增加 如下2行内容 export GOROOT=/usr/local/go export PATH=$PATH:$GOROOT/bin source /etc/profile #安装后,确认 go 1.8 安装成功 go version go version go1.8 darwin/amd64 #如果无法科学上网，使用如下步骤: # 1. 以 root安装 gopm export GOPATH=/usr/local go get -u github.com/gpmgo/gopm #确认在/usr/local/bin 目录下有 gopm # 2. 以 fabric 用户，通过 gopm 安装 goimports export GOPATH=/home/fabric/fabric gopm get -g -d golang.org/x/tools/cmd/goimports #再使用 go install 安装 goimports go install golang.org/x/tools/cmd/goimports #确认在/home/fabric/fabric/bin 目录下有 goimports 以 fabric 用户 安装 gocov GOPATH=/home/fabric/fabric gopm get -g -d golang.org/x/tools/cover gopm get -g -d github.com/axw/gocov/gocov go install github.com/axw/gocov/gocov # 确认 /home/fabric/fabric/bin 目录下有 gocov 安装 gocov-xml GOPATH=/home/fabric/fabric gopm get -g -d github.com/AlekSi/gocov-xml go install github.com/AlekSi/gocov-xml #确认 /home/fabric/fabric/bin 目录下有 gocov-xml 三. 安装其他必须的组件 以 root 用户安装 ``` centos 下需要安装 yum install -y gcc libtool libltdl-dev libtool-ltdl-devel openssl ## 四.设置fabric环境变量 vim ~/.bashrc export GOPATH=/home/fabric/fabric 使得环境变量生效 source ~/.bashrc ``` 五.进入项目目录 cd $GOPATH 六. 建立 go 源码目录结构(一定要建立 src/github.com/hyperledger ，否则无法使用 go 进行编译) cd $GOPATH mkdir -p src/github.com/hyperledger 七.拉取 fabric 的源码 cd $GOPATH/src/github.com/hyperledger git clone https://github.com/hyperledger/fabric.git 八.编译生成 protoc-gen-go #编译生成 protoc-gen-go cd $GOPATH gopm get -g -d github.com/golang/protobuf/protoc-gen-go go install github.com/golang/protobuf/protoc-gen-go #确认在$GOPATH/bin出现protoc-gen-go执行文件 九. 编译 fabric docker 环境 cd $GOPATH/src/github.com/hyperledger/fabric make docker 如果出现 Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock 这个错误。 解决方案： 1. 把 fabric 用户加入到 sudo 组 a. 以 root 用户登录 b. vim /etc/sudoers c. 增加 fabric ALL=(ALL) ALL 一行到root ALL=(ALL) ALL下面 2. sudo usermod -a -G docker \\(USER 3. newgrp - docker 4. newgrp - `groups \\){USER} | cut -d&#39; &#39; -f1` 参考： https://techoverflow.net/2017/03/01/solving-docker-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket/ 十.如果出现文件或者命令没找到的错误，复制go 的相关文件到 fabric 编译环境 cp $GOPATH/bin/protoc-gen-go $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ cp $GOPATH/bin/gocov $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ 十一.编译 fabric ca 环境 cd /root git clone https://github.com/hyperledger/fabric-ca.git cd fabric-ca make docker 十二. 部署和测试 e2e 应用 一键启动 cd $GOPATH/src/github.com/hyperledger/fabric/examples/e2e_cli ./network_setup.sh up mytestchannel 十三. 部署 Fabric Sample 官方文档：http://hyperledger-fabric.readthedocs.io/en/latest/samples.html 1.拉取Fabric Sample 的源码 cd ~ git clone https://github.com/hyperledger/fabric-samples.git cd ~/fabric-samples 2. 下载所需要的执行文件。 官方方法 直接 通过如下命令 ： curl -sSL https://goo.gl/iX9dek | bash 由于不能科学上网。只能通过 浏览器访问 https://goo.gl/iX9dek 或则 访问 https://raw.githubusercontent.com/hyperledger/fabric/master/scripts/bootstrap-1.0.0.sh 然后把这个 shell 文件保存到 ~/fabric-samples/run.sh 文件内。 然后chmod +xxx ~/fabric-samples/run.sh 。 成功后运行 run.sh。 shell 会自动拉取所有的 fabric 1.0.0 的 image 并且生成 bin目录。目录下有下列文件： cryptogen, configtxgen, configtxlator peer Finally, the script will download the Hyperledger Fabric docker images from Docker Hub into your local Docker registry and tag them as ‘latest’. The script lists out the Docker images installed upon conclusion. Look at the names for each image; these are the components that will ultimately comprise our Hyperledger Fabric network. You will also notice that you have two instances of the same image ID - one tagged as “x86_64-1.0.0” and one tagged as “latest”. 3. 更新环境变量 PATH export PATH=/home/fabric/fabric-samples/bin:$PATH 4. run it now cd ~/fabric-samples/first-network ./byfn.sh -m generate 成功后，控制台显示 [fabric@fabirc first-network]$ ./byfn.sh -m generate Generating certs and genesis block for with channel &#39;mychannel&#39; and CLI timeout of &#39;10000&#39; Continue (y/n)? y proceeding ... /home/fabric/fabric-samples/bin/cryptogen ########################################################## ##### Generate certificates using cryptogen tool ######### ########################################################## org1.example.com org2.example.com /home/fabric/fabric-samples/bin/configtxgen ########################################################## ######### Generating Orderer Genesis block ############## ########################################################## 2017-07-21 15:05:30.414 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.453 CST [common/configtx/tool] doOutputBlock -&gt; INFO 002 Generating genesis block 2017-07-21 15:05:30.455 CST [common/configtx/tool] doOutputBlock -&gt; INFO 003 Writing genesis block ################################################################# ### Generating channel configuration transaction &#39;channel.tx&#39; ### ################################################################# 2017-07-21 15:05:30.489 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.496 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 002 Generating new channel configtx 2017-07-21 15:05:30.497 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 003 Writing new channel tx ################################################################# ####### Generating anchor peer update for Org1MSP ########## ################################################################# 2017-07-21 15:05:30.541 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.545 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update 2017-07-21 15:05:30.546 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update ################################################################# ####### Generating anchor peer update for Org2MSP ########## ################################################################# 2017-07-21 15:05:30.590 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration 2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update 2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update [fabric@fabirc first-network]$ 5.启动网络 ./byfn.sh -m up 如果以前做过测试，特别是通过源码编译，运行过e2e_cli 例子后。这里可能会报告 容器已经存在的错误。 ERROR: for peer0.org1.example.com Cannot create container for service peer0.org1.example.com: Conflict. The container name &quot;/peer0.org1.example.com&quot; is already in use by container &quot;f8ab810101f3db4eb5e0a15ef2e06f0fee19259225541031d73c6eaa70a0640e&quot;.Creating peer1.org1.example.com ... error ERROR: for peer1.org1.example.com Cannot create container for service peer1.org1.example.com: Conflict. The container name &quot;/peer1.org1.example.com&quot; is already in use by container &quot;1517363d7424e01e07f1e5230fcc955d2cc4a1f8778842777ea5a237fedc9b3b&quot;.Creating peer0.org2.example.com ... error ERROR: for peer0.org2.example.com Cannot create container for service peer0.org2.example.com: Conflict. The container name &quot;/peer0.org2.example.com&quot; is already in use by container &quot;513aeb4b3d8f9b3ec2f90c42d19d6c4a9b2aa058ad39f931de009be8980a192f&quot;.Creating peer1.org2.example.com ... error ERROR: for peer1.org2.example.com Cannot create container for service peer1.org2.example.com: Conflict. The container name &quot;/peer1.org2.example.com&quot; is already in use by container &quot;c9ac14cc4a6b002dec353bcd2e008752c00f4129d811e250b38c2702c9d83e28&quot;.Creating orderer.example.com ... error 可以通过下面命令，清除一下原有的容器，并且删除原来的测试容器用的 images docker rm -f $(docker ps -aq) docker rmi $(docker images -a | grep dev- | awk &#39;{print $3 }&#39;) 控制台出现 ： Starting with channel &#39;mychannel&#39; and CLI timeout of &#39;10000&#39; Continue (y/n)?y proceeding ... Creating network &quot;net_byfn&quot; with the default driver Creating peer0.org1.example.com Creating peer1.org1.example.com Creating peer0.org2.example.com Creating orderer.example.com Creating peer1.org2.example.com Creating cli ____ _____ _ ____ _____ / ___| |_ _| / \\ | _ \\ |_ _| \\___ \\ | | / _ \\ | |_) | | | ___) | | | / ___ \\ | _ &lt; | | |____/ |_| /_/ \\_\\ |_| \\_\\ |_| Channel name : mychannel Creating channel... The logs will continue from there. This will launch all of the containers, and then drive a complete end-to-end application scenario. Upon successful completion, it should report the following in your terminal window: Attempting to Query PEER3 ...3 secs 2017-07-21 07:22:03.903 UTC [msp] GetLocalMSP -&gt; DEBU 001 Returning existing local MSP 2017-07-21 07:22:03.903 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 002 Obtaining default signing identity 2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 003 Using default escc 2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 004 Using default vscc 2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 005 Sign: plaintext: 0A95070A6708031A0C089BD7C6CB0510...6D7963631A0A0A0571756572790A0161 2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 006 Sign: digest: 56559226BBF8E0BAC8522F3728F6AC5141868518117FEBE522CC7354DB856494 Query Result: 90 2017-07-21 07:22:18.236 UTC [main] main -&gt; INFO 007 Exiting..... ===================== Query on PEER3 on channel &#39;mychannel&#39; is successful ===================== ========= All GOOD, BYFN execution completed =========== _____ _ _ ____ | ____| | \\ | | | _ \\ | _| | \\| | | | | | | |___ | |\\ | | |_| | |_____| |_| \\_| |____/ 6.停止和卸载，删除容器，镜像. The following will kill your containers, remove the crypto material and four artifacts, and delete the chaincode images from your Docker Registry: ./byfn.sh -m down 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2017/04/18/6949b0bc671501ee7cb4de700d7acfd8.html","headline":"git fabric 1.0.0 官方源码进行编译，生成 docker images","dateModified":"2017-04-18T00:00:00+08:00","datePublished":"2017-04-18T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2017/04/18/6949b0bc671501ee7cb4de700d7acfd8.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>git fabric 1.0.0 官方源码进行编译，生成 docker images</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>系统环境：centos 7 64位<br> docker<br> docker-compose</p> 
  <p>不要使用 centos yum 仓库带的 docker，版本过低。<br> 安装docker 官方的repo 里面的版本</p> 
  <pre><code>$ sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-'EOF'
[dockerrepo]
name=Docker Repository
baseurl=https://yum.dockerproject.org/repo/main/centos/7/
enabled=1
gpgcheck=1
gpgkey=https://yum.dockerproject.org/gpg
EOF

yum update

yum install docker-engine

systemctl enable docker

systemctl restart docker

</code></pre> 
  <h2 id="toc_0">一.添加 fabric 用户和设置存放源码的目录</h2> 
  <pre><code>useradd fabric
# 以 fabric 用户登录，建立如下项目目录.
mkdir /home/fabric/fabric
</code></pre> 
  <h2 id="toc_1">二.安装 go 的开发环境和必须的组件</h2> 
  <p>以 root 用户安装</p> 
  <pre><code>wget https://storage.googleapis.com/golang/go1.8.1.linux-amd64.tar.gz

tar -xzvf go1.8.1.linux-amd64.tar.gz

mv ./go  /usr/local

//修改 etc/profile，增加 如下2行内容
export GOROOT=/usr/local/go
export PATH=$PATH:$GOROOT/bin

source /etc/profile
</code></pre> 
  <pre><code>#安装后,确认 go 1.8 安装成功
go version
go version go1.8 darwin/amd64

#如果无法科学上网，使用如下步骤:
# 1. 以 root安装 gopm
    export GOPATH=/usr/local
    go get -u github.com/gpmgo/gopm
    #确认在/usr/local/bin 目录下有 gopm
# 2. 以 fabric 用户，通过 gopm 安装 goimports
    export GOPATH=/home/fabric/fabric
    gopm get -g -d golang.org/x/tools/cmd/goimports
    #再使用 go install 安装 goimports
    go install golang.org/x/tools/cmd/goimports
    #确认在/home/fabric/fabric/bin 目录下有 goimports
</code></pre> 
  <p>以 fabric 用户 安装 gocov</p> 
  <pre><code>GOPATH=/home/fabric/fabric
gopm get -g -d golang.org/x/tools/cover
gopm get -g -d github.com/axw/gocov/gocov
go install github.com/axw/gocov/gocov
# 确认 /home/fabric/fabric/bin 目录下有 gocov
</code></pre> 
  <p>安装 gocov-xml</p> 
  <pre><code>GOPATH=/home/fabric/fabric
gopm get -g -d github.com/AlekSi/gocov-xml
go install github.com/AlekSi/gocov-xml
#确认 /home/fabric/fabric/bin 目录下有 gocov-xml
</code></pre> 
  <h2 id="toc_2">三. 安装其他必须的组件</h2> 
  <p>以 root 用户安装<br> ```</p> 
  <h1 id="toc_3">centos 下需要安装</h1> 
  <p>yum install -y gcc libtool libltdl-dev libtool-ltdl-devel openssl</p> 
  <pre><code>## 四.设置fabric环境变量

</code></pre> 
  <p>vim ~/.bashrc<br> export GOPATH=/home/fabric/fabric</p> 
  <h1 id="toc_4">使得环境变量生效</h1> 
  <p>source ~/.bashrc<br> ```</p> 
  <h2 id="toc_5">五.进入项目目录</h2> 
  <pre><code>cd $GOPATH
</code></pre> 
  <h2 id="toc_6">六. 建立 go 源码目录结构(一定要建立 src/github.com/hyperledger ，否则无法使用 go 进行编译)</h2> 
  <pre><code>cd $GOPATH
mkdir -p src/github.com/hyperledger
</code></pre> 
  <h2 id="toc_7">七.拉取 fabric 的源码</h2> 
  <pre><code>cd $GOPATH/src/github.com/hyperledger
git clone https://github.com/hyperledger/fabric.git
</code></pre> 
  <h2 id="toc_8">八.编译生成 protoc-gen-go</h2> 
  <pre><code>#编译生成 protoc-gen-go 
cd $GOPATH
gopm get -g -d github.com/golang/protobuf/protoc-gen-go
go install github.com/golang/protobuf/protoc-gen-go
#确认在$GOPATH/bin出现protoc-gen-go执行文件
</code></pre> 
  <h2 id="toc_9">九. 编译 fabric docker 环境</h2> 
  <pre><code>cd $GOPATH/src/github.com/hyperledger/fabric
make docker
</code></pre> 
  <p>如果出现 Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock 这个错误。<br> 解决方案：<br> 1. 把 fabric 用户加入到 sudo 组<br> a. 以 root 用户登录<br> b. vim /etc/sudoers<br> c. 增加 fabric ALL=(ALL) ALL 一行到root ALL=(ALL) ALL下面<br> 2. sudo usermod -a -G docker \(USER<br> 3. newgrp - docker<br> 4. newgrp - `groups \){USER} | cut -d' ' -f1`<br> 参考： <br><a href="https://techoverflow.net/2017/03/01/solving-docker-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket/" rel="nofollow">https://techoverflow.net/2017/03/01/solving-docker-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket/</a></p> 
  <h2 id="toc_10">十.如果出现文件或者命令没找到的错误，复制go 的相关文件到 fabric 编译环境</h2> 
  <pre><code>cp $GOPATH/bin/protoc-gen-go $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ 

cp $GOPATH/bin/gocov $GOPATH/src/github.com/hyperledger/fabric/build/docker/gotools/bin/ 
</code></pre> 
  <h2 id="toc_11">十一.编译 fabric ca 环境</h2> 
  <pre><code>cd /root
git clone https://github.com/hyperledger/fabric-ca.git
cd fabric-ca
make docker
</code></pre> 
  <h2 id="toc_12">十二. 部署和测试 e2e 应用</h2> 
  <p>一键启动<br> cd $GOPATH/src/github.com/hyperledger/fabric/examples/e2e_cli<br> ./network_setup.sh up mytestchannel</p> 
  <h2 id="toc_13">十三. 部署 Fabric Sample</h2> 
  <p>官方文档：<br><a href="http://hyperledger-fabric.readthedocs.io/en/latest/samples.html" rel="nofollow">http://hyperledger-fabric.readthedocs.io/en/latest/samples.html</a></p> 
  <h3 id="toc_14">1.拉取Fabric Sample 的源码</h3> 
  <pre><code>cd ~
git clone https://github.com/hyperledger/fabric-samples.git
cd ~/fabric-samples
</code></pre> 
  <h3 id="toc_15">2. 下载所需要的执行文件。</h3> 
  <p>官方方法 直接 通过如下命令 ：<br> curl -sSL <a href="https://goo.gl/iX9dek" rel="nofollow">https://goo.gl/iX9dek</a> | bash</p> 
  <p>由于不能科学上网。只能通过 浏览器访问 </p> 
  <pre><code>https://goo.gl/iX9dek
</code></pre> 
  <p>或则 访问 </p> 
  <pre><code>https://raw.githubusercontent.com/hyperledger/fabric/master/scripts/bootstrap-1.0.0.sh
</code></pre> 
  <p>然后把这个 shell 文件保存到 ~/fabric-samples/run.sh 文件内。<br> 然后chmod +xxx ~/fabric-samples/run.sh 。<br> 成功后运行 run.sh。<br> shell 会自动拉取所有的 fabric 1.0.0 的 image<br> 并且生成 bin目录。目录下有下列文件：</p> 
  <ul>
   <li>cryptogen,</li> 
   <li>configtxgen,</li> 
   <li>configtxlator</li> 
   <li>peer</li> 
  </ul>
  <p>Finally, the script will download the Hyperledger Fabric docker images from Docker Hub into your local Docker registry and tag them as ‘latest’.</p> 
  <p>The script lists out the Docker images installed upon conclusion.</p> 
  <p>Look at the names for each image; these are the components that will ultimately comprise our Hyperledger Fabric network. You will also notice that you have two instances of the same image ID - one tagged as “x86_64-1.0.0” and one tagged as “latest”.</p> 
  <h3 id="toc_16">3. 更新环境变量 PATH</h3> 
  <pre><code>export PATH=/home/fabric/fabric-samples/bin:$PATH
</code></pre> 
  <h3 id="toc_17">4. run it now</h3> 
  <pre><code>cd ~/fabric-samples/first-network
./byfn.sh -m generate
</code></pre> 
  <p>成功后，控制台显示</p> 
  <pre><code>[fabric@fabirc first-network]$ ./byfn.sh -m generate
Generating certs and genesis block for with channel 'mychannel' and CLI timeout of '10000'
Continue (y/n)? y
proceeding ...
/home/fabric/fabric-samples/bin/cryptogen

##########################################################
##### Generate certificates using cryptogen tool #########
##########################################################
org1.example.com
org2.example.com

/home/fabric/fabric-samples/bin/configtxgen
##########################################################
#########  Generating Orderer Genesis block ##############
##########################################################
2017-07-21 15:05:30.414 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration
2017-07-21 15:05:30.453 CST [common/configtx/tool] doOutputBlock -&gt; INFO 002 Generating genesis block
2017-07-21 15:05:30.455 CST [common/configtx/tool] doOutputBlock -&gt; INFO 003 Writing genesis block

#################################################################
### Generating channel configuration transaction 'channel.tx' ###
#################################################################
2017-07-21 15:05:30.489 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration
2017-07-21 15:05:30.496 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 002 Generating new channel configtx
2017-07-21 15:05:30.497 CST [common/configtx/tool] doOutputChannelCreateTx -&gt; INFO 003 Writing new channel tx

#################################################################
#######    Generating anchor peer update for Org1MSP   ##########
#################################################################
2017-07-21 15:05:30.541 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration
2017-07-21 15:05:30.545 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update
2017-07-21 15:05:30.546 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update

#################################################################
#######    Generating anchor peer update for Org2MSP   ##########
#################################################################
2017-07-21 15:05:30.590 CST [common/configtx/tool] main -&gt; INFO 001 Loading configuration
2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 002 Generating anchor peer update
2017-07-21 15:05:30.593 CST [common/configtx/tool] doOutputAnchorPeersUpdate -&gt; INFO 003 Writing anchor peer update

[fabric@fabirc first-network]$
</code></pre> 
  <h3 id="toc_18">5.启动网络</h3> 
  <pre><code>./byfn.sh -m up
</code></pre> 
  <p>如果以前做过测试，特别是通过源码编译，运行过e2e_cli 例子后。这里可能会报告 容器已经存在的错误。</p> 
  <pre><code>    ERROR: for peer0.org1.example.com  Cannot create container for service peer0.org1.example.com: Conflict. The container name "/peer0.org1.example.com" is already in use by container "f8ab810101f3db4eb5e0a15ef2e06f0fee19259225541031d73c6eaa70a0640e".Creating peer1.org1.example.com ... error
    
    ERROR: for peer1.org1.example.com  Cannot create container for service peer1.org1.example.com: Conflict. The container name "/peer1.org1.example.com" is already in use by container "1517363d7424e01e07f1e5230fcc955d2cc4a1f8778842777ea5a237fedc9b3b".Creating peer0.org2.example.com ... error
    
    ERROR: for peer0.org2.example.com  Cannot create container for service peer0.org2.example.com: Conflict. The container name "/peer0.org2.example.com" is already in use by container "513aeb4b3d8f9b3ec2f90c42d19d6c4a9b2aa058ad39f931de009be8980a192f".Creating peer1.org2.example.com ... error
    
    ERROR: for peer1.org2.example.com  Cannot create container for service peer1.org2.example.com: Conflict. The container name "/peer1.org2.example.com" is already in use by container "c9ac14cc4a6b002dec353bcd2e008752c00f4129d811e250b38c2702c9d83e28".Creating orderer.example.com ... error
</code></pre> 
  <p>可以通过下面命令，清除一下原有的容器，并且删除原来的测试容器用的 images</p> 
  <pre><code>docker rm -f $(docker ps -aq)
docker rmi  $(docker images -a | grep dev-  | awk '{print $3 }')
</code></pre> 
  <p>控制台出现 ：</p> 
  <pre><code>Starting with channel 'mychannel' and CLI timeout of '10000'
Continue (y/n)?y
proceeding ...
Creating network "net_byfn" with the default driver
Creating peer0.org1.example.com
Creating peer1.org1.example.com
Creating peer0.org2.example.com
Creating orderer.example.com
Creating peer1.org2.example.com
Creating cli


 ____    _____      _      ____    _____
/ ___|  |_   _|    / \    |  _ \  |_   _|
\___ \    | |     / _ \   | |_) |   | |
 ___) |   | |    / ___ \  |  _ &lt;    | |
|____/    |_|   /_/   \_\ |_| \_\   |_|

Channel name : mychannel
Creating channel...

</code></pre> 
  <p>The logs will continue from there. This will launch all of the containers, and then drive a complete end-to-end application scenario. Upon successful completion, it should report the following in your terminal window:</p> 
  <pre><code>Attempting to Query PEER3 ...3 secs

2017-07-21 07:22:03.903 UTC [msp] GetLocalMSP -&gt; DEBU 001 Returning existing local MSP
2017-07-21 07:22:03.903 UTC [msp] GetDefaultSigningIdentity -&gt; DEBU 002 Obtaining default signing identity
2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 003 Using default escc
2017-07-21 07:22:03.903 UTC [chaincodeCmd] checkChaincodeCmdParams -&gt; INFO 004 Using default vscc
2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 005 Sign: plaintext: 0A95070A6708031A0C089BD7C6CB0510...6D7963631A0A0A0571756572790A0161
2017-07-21 07:22:03.903 UTC [msp/identity] Sign -&gt; DEBU 006 Sign: digest: 56559226BBF8E0BAC8522F3728F6AC5141868518117FEBE522CC7354DB856494
Query Result: 90
2017-07-21 07:22:18.236 UTC [main] main -&gt; INFO 007 Exiting.....
===================== Query on PEER3 on channel 'mychannel' is successful =====================

========= All GOOD, BYFN execution completed ===========


 _____   _   _   ____
| ____| | \ | | |  _ \
|  _|   |  \| | | | | |
| |___  | |\  | | |_| |
|_____| |_| \_| |____/

</code></pre> 
  <h3 id="toc_19">6.停止和卸载，删除容器，镜像.</h3> 
  <p>The following will kill your containers, remove the crypto material and four artifacts, and delete the chaincode images from your Docker Registry:</p> 
  <pre><code>./byfn.sh -m down
</code></pre> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/remote_roamer/article/details/70228662,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/remote_roamer/article/details/70228662,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
