<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>离散对数和椭圆曲线加密原理-那些零零散散的算法(放些算法相关的东西) | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="离散对数和椭圆曲线加密原理-那些零零散散的算法(放些算法相关的东西)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/qmickecs/article/details/76585303 序言 现代公钥加密系统中，常用的加密算法除了RSA还有离散对数加密和椭圆曲线加密。这两者原理比较相似，在这里一并介绍。 离散对数问题 我们在中学里学的对数问题是指， 给定正实数 a a 和 ax a x ，求 x x 。也就是计算 x=logaax x = log a ⁡ a x 。 这是实数域上的对数问题，不是什么难算的东西，随便按一下计算器结果就出来了。 而离散对数问题是指这样的问题： 给定素数 p p 和正整数 g g ，知道 gxmodp g x mod p 的值，求 x x 对于符合特定条件的 p p 和 g g ，这个问题是很难解的，更准确地说，是没有多项式时间的解法。 Diffie–Hellman密钥交换 Diffie–Hellman密钥交换（以下简称DH）是用于双方在可能被窃听环境下安全交换密钥的一种方法。 算法的安全性是由上面提到的离散对数难题保证。 具体算法流程如下： 小红和小明约定 p p 和 g g 的值 小红生成私钥 x x ，计算 gxmodp g x mod p 作为公钥公布出去 小明生成私钥 y y ，计算 gymodp g y mod p 作为公钥公布出去 小红得知 gymodp g y mod p 后，计算 s=(gymodp)xmodp=(gy)xmodp=gxymodp s = ( g y mod p ) x mod p = ( g y ) x mod p = g x y mod p 小明得到 gxmodp g x mod p 后，计算 s=(gxmodp)ymodp=(gx)ymodp=gxymodp s = ( g x mod p ) y mod p = ( g x ) y mod p = g x y mod p 双方都得到了相同的密钥的 s s ，交换完毕 上面的流程中， x x 和 y y 始终由两人自行保管的，第三方窃听得到的只有 p p 、 g g 、 gxmodp g x mod p 和 gymodp g y mod p 这几个值。 上面说过，离散对数是很难算的，所以第三方不能由这些信息计算出 x x 或 y y ，也就没办法计算出密钥 s s 了。 椭圆曲线 中学的时候我们学过圆锥曲线，比如椭圆、双曲线和抛物线。因为描述这些曲线的方程都是二次方程，圆锥曲线又被称为二次曲线。而椭圆曲线是则是由三次方程描述的一些曲线。更准确地说，椭圆曲线是由下面的方程描述的曲线： y2=x3+ax+b其中4a3+27b2≠0 y 2 = x 3 + a x + b 其 中 4 a 3 + 27 b 2 ≠ 0 需要注意的是，椭圆曲线之所以叫“椭圆曲线”，是因为其曲线方程跟利用微积分计算椭圆周长的公式相似。实际上它的图像跟椭圆完全不搭边。 下图是椭圆曲线 y2=x3−x+1 y 2 = x 3 − x + 1 的图像 椭圆曲线有这样的两个性质： 关于X轴对称 画一条直线跟椭圆曲线相交，它们最多有三个交点 椭圆曲线上的运算 由于椭圆曲线加密进行的运算实际上都是在椭圆曲线上进行的，所以接下来需要定义一些椭圆曲线上的运算。 必须注意的是，这里把这些运算称为“加法”和“乘法”仅仅是方便描述，他们跟平时认知的加法和乘法完全是两码事，完全可以给他们取其它名字（比如”乘法“和”幂运算“等）。 首先定义坐标系中距离X轴无穷远点为椭圆曲线上的一个特殊点，称为0点。 那么此时上述第二条性质可以加强为：过曲线上任意两点（可重合）的直线必定与曲线相交于第三点。 然后定义椭圆曲线上点的加法。设椭圆曲线上有两点，A和B点，那么作过这两点的直线与该曲线相交于第三点（C点），然后关于X轴对称得到D点，则D为这两个点的和，记作 D=A+B D = A + B 。很明显，D点也在该曲线上。所以椭圆曲线上两点之和也是曲线上的点。 特别地，如果两点重合，则作椭圆曲线在A点处的切线，与曲线相交于第二点（B点），然后关于X轴对称得到C点，则C点为A点与自身的和，记作 C=A+A C = A + A 那么关于这个加法，我们可以得到以下结论： A+B=B+A A + B = B + A 也就是椭圆曲线上的加法满足交换律。 A+0=A A + 0 = A 因为0点是无穷远点，所以过A点与0点的直线是垂直于X轴的，它与曲线相交于另一点B点，那么B点关于X轴对称的点就是A点，即A点为A点和0点之和。 然后在加法的基础上，定义椭圆曲线上点的乘法。 设 P P 是椭圆曲线上的一个点，那么正整数 k k 乘以点 P P 的结果由下面的式子定义，注意式子中的加法是上面提到的椭圆曲线上点的加法： 1∗P=P 1 ∗ P = P 2∗P=P+P 2 ∗ P = P + P 3∗P=2∗P+P 3 ∗ P = 2 ∗ P + P … k∗P=(k−1)∗P+P k ∗ P = ( k − 1 ) ∗ P + P 这个乘法满足以下性质： 对于任意正整数 k k 和 j j ，有 k∗(j∗P)=(kj)∗P=(jk)∗P=j∗(k∗P) k ∗ ( j ∗ P ) = ( k j ) ∗ P = ( j k ) ∗ P = j ∗ ( k ∗ P ) 这个性质在椭圆曲线密钥交换中会利用到。 椭圆曲线上的离散对数问题 定义了基本的加法和乘法运算后，我们可以由此得到椭圆曲线加密依赖的数学难题。 k k 为正整数， P P 是椭圆曲线上的点（称为基点），已知 k∗P k ∗ P 和 P P ，计算 k k 从程序实现的角度来考虑，假设有这么一个函数： Point add(Point A, Point B) {...} 函数参数是两个椭圆曲线上的点，返回值是过两个点的直线与椭圆曲线相交的第三个点关于X轴对称的点。 那么按照如下方式调用函数： Point result = P; for (int i = 0; i &lt; k - 1; i++) result = add(P, result); sendTo((result, P), others); 如果别人只知道result和P点，是很难求出k的值是多少的。 如果我们改一种记法，把椭圆曲线上点的加法记作乘法，原来的乘法就变成了幂运算，那么上述难题的形式跟离散对数问题应该是一致的。即： k k 为正整数， P P 是椭圆曲线上的点，已知 Pk P k 和 P P ，计算 k=logPPk k = log P ⁡ P k 。 所以这个难题叫椭圆曲线上的离散对数问题。 尽管两者形式一致，但是他们并不等价。实际上这个问题比大整数质因子分解（RSA）和离散对数（DH）难题都要难得多，以致于同样的安全强度下，椭圆曲线加密的密钥比RSA和DH的短不少，这是椭圆曲线加密的一大优势。 有限域上的椭圆曲线 但是密码学中，并不能使用上面介绍的实数域上的椭圆曲线。因为 1. 实数域上的椭圆曲线是连续的，有无限个点，密码学要求有限点。 2. 实数域上的椭圆曲线的运算有误差，不精确。密码学要求精确。 所以我们需要引入有限域上的椭圆曲线。 所谓有限域上的椭圆曲线，简单来说就是满足下面式子要求的曲线（x, y, a, b都是小于素数p的非负整数）： y2=x3+ax+bmodp其中4a3+27b2≠0modp y 2 = x 3 + a x + b mod p 其 中 4 a 3 + 27 b 2 ≠ 0 mod p 对比一下原先的椭圆曲线的方程： y2=x3+ax+b其中4a3+27b2≠0 y 2 = x 3 + a x + b 其 中 4 a 3 + 27 b 2 ≠ 0 可以看到这个只是对原式进行了简单的取模处理而已。实际上RSA和DH中也是基于这种形式的取模运算。 下图是椭圆曲线 y2=x3−x+1 y 2 = x 3 − x + 1 对素数97取模后的图像（图片来自参考文献） 原本连续光滑的曲线变成了离散的点，基本已经面目全非了，但是依然可以看到它是关于某条水平直线（y=97/2）对称的。 而且上面定义的椭圆曲线的加法仍然可用（当然乘法也可以）（图片来自参考文献）。 注意：密码学中有限域上的椭圆曲线一般有两种，一种是定义在以素数p为模的整数域GF(p)，也就是上面介绍的；另一种则是定义在特征为2的伽罗瓦域GF(2^m)上，篇幅所限，这里就不介绍了。 基于椭圆曲线的DH密钥交换（ECDH） ECDH跟DH的流程基本是一致的。 小红和小明约定使用某条椭圆曲线（包括曲线参数，有限域参数以及基点P等） 小红生成私钥 x x ，计算 x∗P x ∗ P 作为公钥公布出去 小明生成私钥 y y ，计算 y∗P y ∗ P 作为公钥公布出去 小红得知 y∗P y ∗ P 后，计算 s=x∗(y∗P)=xy∗P s = x ∗ ( y ∗ P ) = x y ∗ P 小明得到 x∗P x ∗ P 后，计算 s=y∗(x∗P)=yx∗P s = y ∗ ( x ∗ P ) = y x ∗ P 双方都得到了相同的密钥的 s s ，交换完毕 由于计算椭圆曲线上的离散对数是很难的，所以第三方没办法在只知道 x∗P x ∗ P 和 y∗P y ∗ P 的情况下计算出 x x 或 y y 的值。 实际应用中，我们并不需要关心椭圆曲线的众多参数如何选取（要选对参数对于普通使用者来说并不现实），只要从密码学家们精心挑选的一堆曲线中选择一个就行了。一般来说曲线Curve25519，prime256v1是比较常用的，比特币选择secp256k1则是有自己的考量。 参考文献 浅说椭圆曲线 A (relatively easy to understand) primer on elliptic curve cryptography Wikipedia: Elliptic curve Wikipedia: Elliptic curve cryptography Bitcoin加密技术之椭圆曲线密码学 椭圆曲线密码体制 阅读更多" />
<meta property="og:description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/qmickecs/article/details/76585303 序言 现代公钥加密系统中，常用的加密算法除了RSA还有离散对数加密和椭圆曲线加密。这两者原理比较相似，在这里一并介绍。 离散对数问题 我们在中学里学的对数问题是指， 给定正实数 a a 和 ax a x ，求 x x 。也就是计算 x=logaax x = log a ⁡ a x 。 这是实数域上的对数问题，不是什么难算的东西，随便按一下计算器结果就出来了。 而离散对数问题是指这样的问题： 给定素数 p p 和正整数 g g ，知道 gxmodp g x mod p 的值，求 x x 对于符合特定条件的 p p 和 g g ，这个问题是很难解的，更准确地说，是没有多项式时间的解法。 Diffie–Hellman密钥交换 Diffie–Hellman密钥交换（以下简称DH）是用于双方在可能被窃听环境下安全交换密钥的一种方法。 算法的安全性是由上面提到的离散对数难题保证。 具体算法流程如下： 小红和小明约定 p p 和 g g 的值 小红生成私钥 x x ，计算 gxmodp g x mod p 作为公钥公布出去 小明生成私钥 y y ，计算 gymodp g y mod p 作为公钥公布出去 小红得知 gymodp g y mod p 后，计算 s=(gymodp)xmodp=(gy)xmodp=gxymodp s = ( g y mod p ) x mod p = ( g y ) x mod p = g x y mod p 小明得到 gxmodp g x mod p 后，计算 s=(gxmodp)ymodp=(gx)ymodp=gxymodp s = ( g x mod p ) y mod p = ( g x ) y mod p = g x y mod p 双方都得到了相同的密钥的 s s ，交换完毕 上面的流程中， x x 和 y y 始终由两人自行保管的，第三方窃听得到的只有 p p 、 g g 、 gxmodp g x mod p 和 gymodp g y mod p 这几个值。 上面说过，离散对数是很难算的，所以第三方不能由这些信息计算出 x x 或 y y ，也就没办法计算出密钥 s s 了。 椭圆曲线 中学的时候我们学过圆锥曲线，比如椭圆、双曲线和抛物线。因为描述这些曲线的方程都是二次方程，圆锥曲线又被称为二次曲线。而椭圆曲线是则是由三次方程描述的一些曲线。更准确地说，椭圆曲线是由下面的方程描述的曲线： y2=x3+ax+b其中4a3+27b2≠0 y 2 = x 3 + a x + b 其 中 4 a 3 + 27 b 2 ≠ 0 需要注意的是，椭圆曲线之所以叫“椭圆曲线”，是因为其曲线方程跟利用微积分计算椭圆周长的公式相似。实际上它的图像跟椭圆完全不搭边。 下图是椭圆曲线 y2=x3−x+1 y 2 = x 3 − x + 1 的图像 椭圆曲线有这样的两个性质： 关于X轴对称 画一条直线跟椭圆曲线相交，它们最多有三个交点 椭圆曲线上的运算 由于椭圆曲线加密进行的运算实际上都是在椭圆曲线上进行的，所以接下来需要定义一些椭圆曲线上的运算。 必须注意的是，这里把这些运算称为“加法”和“乘法”仅仅是方便描述，他们跟平时认知的加法和乘法完全是两码事，完全可以给他们取其它名字（比如”乘法“和”幂运算“等）。 首先定义坐标系中距离X轴无穷远点为椭圆曲线上的一个特殊点，称为0点。 那么此时上述第二条性质可以加强为：过曲线上任意两点（可重合）的直线必定与曲线相交于第三点。 然后定义椭圆曲线上点的加法。设椭圆曲线上有两点，A和B点，那么作过这两点的直线与该曲线相交于第三点（C点），然后关于X轴对称得到D点，则D为这两个点的和，记作 D=A+B D = A + B 。很明显，D点也在该曲线上。所以椭圆曲线上两点之和也是曲线上的点。 特别地，如果两点重合，则作椭圆曲线在A点处的切线，与曲线相交于第二点（B点），然后关于X轴对称得到C点，则C点为A点与自身的和，记作 C=A+A C = A + A 那么关于这个加法，我们可以得到以下结论： A+B=B+A A + B = B + A 也就是椭圆曲线上的加法满足交换律。 A+0=A A + 0 = A 因为0点是无穷远点，所以过A点与0点的直线是垂直于X轴的，它与曲线相交于另一点B点，那么B点关于X轴对称的点就是A点，即A点为A点和0点之和。 然后在加法的基础上，定义椭圆曲线上点的乘法。 设 P P 是椭圆曲线上的一个点，那么正整数 k k 乘以点 P P 的结果由下面的式子定义，注意式子中的加法是上面提到的椭圆曲线上点的加法： 1∗P=P 1 ∗ P = P 2∗P=P+P 2 ∗ P = P + P 3∗P=2∗P+P 3 ∗ P = 2 ∗ P + P … k∗P=(k−1)∗P+P k ∗ P = ( k − 1 ) ∗ P + P 这个乘法满足以下性质： 对于任意正整数 k k 和 j j ，有 k∗(j∗P)=(kj)∗P=(jk)∗P=j∗(k∗P) k ∗ ( j ∗ P ) = ( k j ) ∗ P = ( j k ) ∗ P = j ∗ ( k ∗ P ) 这个性质在椭圆曲线密钥交换中会利用到。 椭圆曲线上的离散对数问题 定义了基本的加法和乘法运算后，我们可以由此得到椭圆曲线加密依赖的数学难题。 k k 为正整数， P P 是椭圆曲线上的点（称为基点），已知 k∗P k ∗ P 和 P P ，计算 k k 从程序实现的角度来考虑，假设有这么一个函数： Point add(Point A, Point B) {...} 函数参数是两个椭圆曲线上的点，返回值是过两个点的直线与椭圆曲线相交的第三个点关于X轴对称的点。 那么按照如下方式调用函数： Point result = P; for (int i = 0; i &lt; k - 1; i++) result = add(P, result); sendTo((result, P), others); 如果别人只知道result和P点，是很难求出k的值是多少的。 如果我们改一种记法，把椭圆曲线上点的加法记作乘法，原来的乘法就变成了幂运算，那么上述难题的形式跟离散对数问题应该是一致的。即： k k 为正整数， P P 是椭圆曲线上的点，已知 Pk P k 和 P P ，计算 k=logPPk k = log P ⁡ P k 。 所以这个难题叫椭圆曲线上的离散对数问题。 尽管两者形式一致，但是他们并不等价。实际上这个问题比大整数质因子分解（RSA）和离散对数（DH）难题都要难得多，以致于同样的安全强度下，椭圆曲线加密的密钥比RSA和DH的短不少，这是椭圆曲线加密的一大优势。 有限域上的椭圆曲线 但是密码学中，并不能使用上面介绍的实数域上的椭圆曲线。因为 1. 实数域上的椭圆曲线是连续的，有无限个点，密码学要求有限点。 2. 实数域上的椭圆曲线的运算有误差，不精确。密码学要求精确。 所以我们需要引入有限域上的椭圆曲线。 所谓有限域上的椭圆曲线，简单来说就是满足下面式子要求的曲线（x, y, a, b都是小于素数p的非负整数）： y2=x3+ax+bmodp其中4a3+27b2≠0modp y 2 = x 3 + a x + b mod p 其 中 4 a 3 + 27 b 2 ≠ 0 mod p 对比一下原先的椭圆曲线的方程： y2=x3+ax+b其中4a3+27b2≠0 y 2 = x 3 + a x + b 其 中 4 a 3 + 27 b 2 ≠ 0 可以看到这个只是对原式进行了简单的取模处理而已。实际上RSA和DH中也是基于这种形式的取模运算。 下图是椭圆曲线 y2=x3−x+1 y 2 = x 3 − x + 1 对素数97取模后的图像（图片来自参考文献） 原本连续光滑的曲线变成了离散的点，基本已经面目全非了，但是依然可以看到它是关于某条水平直线（y=97/2）对称的。 而且上面定义的椭圆曲线的加法仍然可用（当然乘法也可以）（图片来自参考文献）。 注意：密码学中有限域上的椭圆曲线一般有两种，一种是定义在以素数p为模的整数域GF(p)，也就是上面介绍的；另一种则是定义在特征为2的伽罗瓦域GF(2^m)上，篇幅所限，这里就不介绍了。 基于椭圆曲线的DH密钥交换（ECDH） ECDH跟DH的流程基本是一致的。 小红和小明约定使用某条椭圆曲线（包括曲线参数，有限域参数以及基点P等） 小红生成私钥 x x ，计算 x∗P x ∗ P 作为公钥公布出去 小明生成私钥 y y ，计算 y∗P y ∗ P 作为公钥公布出去 小红得知 y∗P y ∗ P 后，计算 s=x∗(y∗P)=xy∗P s = x ∗ ( y ∗ P ) = x y ∗ P 小明得到 x∗P x ∗ P 后，计算 s=y∗(x∗P)=yx∗P s = y ∗ ( x ∗ P ) = y x ∗ P 双方都得到了相同的密钥的 s s ，交换完毕 由于计算椭圆曲线上的离散对数是很难的，所以第三方没办法在只知道 x∗P x ∗ P 和 y∗P y ∗ P 的情况下计算出 x x 或 y y 的值。 实际应用中，我们并不需要关心椭圆曲线的众多参数如何选取（要选对参数对于普通使用者来说并不现实），只要从密码学家们精心挑选的一堆曲线中选择一个就行了。一般来说曲线Curve25519，prime256v1是比较常用的，比特币选择secp256k1则是有自己的考量。 参考文献 浅说椭圆曲线 A (relatively easy to understand) primer on elliptic curve cryptography Wikipedia: Elliptic curve Wikipedia: Elliptic curve cryptography Bitcoin加密技术之椭圆曲线密码学 椭圆曲线密码体制 阅读更多" />
<link rel="canonical" href="https://mlh.app/2017/08/03/1005242189109f6312749d77ce2654b5.html" />
<meta property="og:url" content="https://mlh.app/2017/08/03/1005242189109f6312749d77ce2654b5.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-08-03T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/qmickecs/article/details/76585303 序言 现代公钥加密系统中，常用的加密算法除了RSA还有离散对数加密和椭圆曲线加密。这两者原理比较相似，在这里一并介绍。 离散对数问题 我们在中学里学的对数问题是指， 给定正实数 a a 和 ax a x ，求 x x 。也就是计算 x=logaax x = log a ⁡ a x 。 这是实数域上的对数问题，不是什么难算的东西，随便按一下计算器结果就出来了。 而离散对数问题是指这样的问题： 给定素数 p p 和正整数 g g ，知道 gxmodp g x mod p 的值，求 x x 对于符合特定条件的 p p 和 g g ，这个问题是很难解的，更准确地说，是没有多项式时间的解法。 Diffie–Hellman密钥交换 Diffie–Hellman密钥交换（以下简称DH）是用于双方在可能被窃听环境下安全交换密钥的一种方法。 算法的安全性是由上面提到的离散对数难题保证。 具体算法流程如下： 小红和小明约定 p p 和 g g 的值 小红生成私钥 x x ，计算 gxmodp g x mod p 作为公钥公布出去 小明生成私钥 y y ，计算 gymodp g y mod p 作为公钥公布出去 小红得知 gymodp g y mod p 后，计算 s=(gymodp)xmodp=(gy)xmodp=gxymodp s = ( g y mod p ) x mod p = ( g y ) x mod p = g x y mod p 小明得到 gxmodp g x mod p 后，计算 s=(gxmodp)ymodp=(gx)ymodp=gxymodp s = ( g x mod p ) y mod p = ( g x ) y mod p = g x y mod p 双方都得到了相同的密钥的 s s ，交换完毕 上面的流程中， x x 和 y y 始终由两人自行保管的，第三方窃听得到的只有 p p 、 g g 、 gxmodp g x mod p 和 gymodp g y mod p 这几个值。 上面说过，离散对数是很难算的，所以第三方不能由这些信息计算出 x x 或 y y ，也就没办法计算出密钥 s s 了。 椭圆曲线 中学的时候我们学过圆锥曲线，比如椭圆、双曲线和抛物线。因为描述这些曲线的方程都是二次方程，圆锥曲线又被称为二次曲线。而椭圆曲线是则是由三次方程描述的一些曲线。更准确地说，椭圆曲线是由下面的方程描述的曲线： y2=x3+ax+b其中4a3+27b2≠0 y 2 = x 3 + a x + b 其 中 4 a 3 + 27 b 2 ≠ 0 需要注意的是，椭圆曲线之所以叫“椭圆曲线”，是因为其曲线方程跟利用微积分计算椭圆周长的公式相似。实际上它的图像跟椭圆完全不搭边。 下图是椭圆曲线 y2=x3−x+1 y 2 = x 3 − x + 1 的图像 椭圆曲线有这样的两个性质： 关于X轴对称 画一条直线跟椭圆曲线相交，它们最多有三个交点 椭圆曲线上的运算 由于椭圆曲线加密进行的运算实际上都是在椭圆曲线上进行的，所以接下来需要定义一些椭圆曲线上的运算。 必须注意的是，这里把这些运算称为“加法”和“乘法”仅仅是方便描述，他们跟平时认知的加法和乘法完全是两码事，完全可以给他们取其它名字（比如”乘法“和”幂运算“等）。 首先定义坐标系中距离X轴无穷远点为椭圆曲线上的一个特殊点，称为0点。 那么此时上述第二条性质可以加强为：过曲线上任意两点（可重合）的直线必定与曲线相交于第三点。 然后定义椭圆曲线上点的加法。设椭圆曲线上有两点，A和B点，那么作过这两点的直线与该曲线相交于第三点（C点），然后关于X轴对称得到D点，则D为这两个点的和，记作 D=A+B D = A + B 。很明显，D点也在该曲线上。所以椭圆曲线上两点之和也是曲线上的点。 特别地，如果两点重合，则作椭圆曲线在A点处的切线，与曲线相交于第二点（B点），然后关于X轴对称得到C点，则C点为A点与自身的和，记作 C=A+A C = A + A 那么关于这个加法，我们可以得到以下结论： A+B=B+A A + B = B + A 也就是椭圆曲线上的加法满足交换律。 A+0=A A + 0 = A 因为0点是无穷远点，所以过A点与0点的直线是垂直于X轴的，它与曲线相交于另一点B点，那么B点关于X轴对称的点就是A点，即A点为A点和0点之和。 然后在加法的基础上，定义椭圆曲线上点的乘法。 设 P P 是椭圆曲线上的一个点，那么正整数 k k 乘以点 P P 的结果由下面的式子定义，注意式子中的加法是上面提到的椭圆曲线上点的加法： 1∗P=P 1 ∗ P = P 2∗P=P+P 2 ∗ P = P + P 3∗P=2∗P+P 3 ∗ P = 2 ∗ P + P … k∗P=(k−1)∗P+P k ∗ P = ( k − 1 ) ∗ P + P 这个乘法满足以下性质： 对于任意正整数 k k 和 j j ，有 k∗(j∗P)=(kj)∗P=(jk)∗P=j∗(k∗P) k ∗ ( j ∗ P ) = ( k j ) ∗ P = ( j k ) ∗ P = j ∗ ( k ∗ P ) 这个性质在椭圆曲线密钥交换中会利用到。 椭圆曲线上的离散对数问题 定义了基本的加法和乘法运算后，我们可以由此得到椭圆曲线加密依赖的数学难题。 k k 为正整数， P P 是椭圆曲线上的点（称为基点），已知 k∗P k ∗ P 和 P P ，计算 k k 从程序实现的角度来考虑，假设有这么一个函数： Point add(Point A, Point B) {...} 函数参数是两个椭圆曲线上的点，返回值是过两个点的直线与椭圆曲线相交的第三个点关于X轴对称的点。 那么按照如下方式调用函数： Point result = P; for (int i = 0; i &lt; k - 1; i++) result = add(P, result); sendTo((result, P), others); 如果别人只知道result和P点，是很难求出k的值是多少的。 如果我们改一种记法，把椭圆曲线上点的加法记作乘法，原来的乘法就变成了幂运算，那么上述难题的形式跟离散对数问题应该是一致的。即： k k 为正整数， P P 是椭圆曲线上的点，已知 Pk P k 和 P P ，计算 k=logPPk k = log P ⁡ P k 。 所以这个难题叫椭圆曲线上的离散对数问题。 尽管两者形式一致，但是他们并不等价。实际上这个问题比大整数质因子分解（RSA）和离散对数（DH）难题都要难得多，以致于同样的安全强度下，椭圆曲线加密的密钥比RSA和DH的短不少，这是椭圆曲线加密的一大优势。 有限域上的椭圆曲线 但是密码学中，并不能使用上面介绍的实数域上的椭圆曲线。因为 1. 实数域上的椭圆曲线是连续的，有无限个点，密码学要求有限点。 2. 实数域上的椭圆曲线的运算有误差，不精确。密码学要求精确。 所以我们需要引入有限域上的椭圆曲线。 所谓有限域上的椭圆曲线，简单来说就是满足下面式子要求的曲线（x, y, a, b都是小于素数p的非负整数）： y2=x3+ax+bmodp其中4a3+27b2≠0modp y 2 = x 3 + a x + b mod p 其 中 4 a 3 + 27 b 2 ≠ 0 mod p 对比一下原先的椭圆曲线的方程： y2=x3+ax+b其中4a3+27b2≠0 y 2 = x 3 + a x + b 其 中 4 a 3 + 27 b 2 ≠ 0 可以看到这个只是对原式进行了简单的取模处理而已。实际上RSA和DH中也是基于这种形式的取模运算。 下图是椭圆曲线 y2=x3−x+1 y 2 = x 3 − x + 1 对素数97取模后的图像（图片来自参考文献） 原本连续光滑的曲线变成了离散的点，基本已经面目全非了，但是依然可以看到它是关于某条水平直线（y=97/2）对称的。 而且上面定义的椭圆曲线的加法仍然可用（当然乘法也可以）（图片来自参考文献）。 注意：密码学中有限域上的椭圆曲线一般有两种，一种是定义在以素数p为模的整数域GF(p)，也就是上面介绍的；另一种则是定义在特征为2的伽罗瓦域GF(2^m)上，篇幅所限，这里就不介绍了。 基于椭圆曲线的DH密钥交换（ECDH） ECDH跟DH的流程基本是一致的。 小红和小明约定使用某条椭圆曲线（包括曲线参数，有限域参数以及基点P等） 小红生成私钥 x x ，计算 x∗P x ∗ P 作为公钥公布出去 小明生成私钥 y y ，计算 y∗P y ∗ P 作为公钥公布出去 小红得知 y∗P y ∗ P 后，计算 s=x∗(y∗P)=xy∗P s = x ∗ ( y ∗ P ) = x y ∗ P 小明得到 x∗P x ∗ P 后，计算 s=y∗(x∗P)=yx∗P s = y ∗ ( x ∗ P ) = y x ∗ P 双方都得到了相同的密钥的 s s ，交换完毕 由于计算椭圆曲线上的离散对数是很难的，所以第三方没办法在只知道 x∗P x ∗ P 和 y∗P y ∗ P 的情况下计算出 x x 或 y y 的值。 实际应用中，我们并不需要关心椭圆曲线的众多参数如何选取（要选对参数对于普通使用者来说并不现实），只要从密码学家们精心挑选的一堆曲线中选择一个就行了。一般来说曲线Curve25519，prime256v1是比较常用的，比特币选择secp256k1则是有自己的考量。 参考文献 浅说椭圆曲线 A (relatively easy to understand) primer on elliptic curve cryptography Wikipedia: Elliptic curve Wikipedia: Elliptic curve cryptography Bitcoin加密技术之椭圆曲线密码学 椭圆曲线密码体制 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2017/08/03/1005242189109f6312749d77ce2654b5.html","headline":"离散对数和椭圆曲线加密原理-那些零零散散的算法(放些算法相关的东西)","dateModified":"2017-08-03T00:00:00+08:00","datePublished":"2017-08-03T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2017/08/03/1005242189109f6312749d77ce2654b5.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>离散对数和椭圆曲线加密原理-那些零零散散的算法(放些算法相关的东西)</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/qmickecs/article/details/76585303 
 </div> 
 <div class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h1 id="序言">序言</h1> 
  <hr> 
  <p>现代公钥加密系统中，常用的加密算法除了RSA还有离散对数加密和椭圆曲线加密。这两者原理比较相似，在这里一并介绍。</p> 
  <h1 id="离散对数问题">离散对数问题</h1> 
  <hr> 
  <p>我们在中学里学的对数问题是指，</p> 
  <blockquote> 
   <p>给定正实数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-1" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        a
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-1">a</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>a</mi><mi>x</mi></msup></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-4" style="width: 1.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1001.03em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="msubsup" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.52em, 4.174em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-8" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <msup>
        <mi>
         a
        </mi>
        <mi>
         x
        </mi>
       </msup>
      </math></span></span><script type="math/tex" id="MathJax-Element-2">a^x</script>，求<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-9" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        x
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-3">x</script>。也就是计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><msub><mi>log</mi><mi>a</mi></msub><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mi>x</mi></msup></mrow></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-12" style="width: 6.117em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.86em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1004.86em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.289em;"><span style="display: inline-block; position: relative; width: 1.717em; height: 0px;"><span style="position: absolute; clip: rect(3.146em, 1001.26em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Main;">log</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.769em; left: 1.26em;"><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-19"></span><span class="texatom" id="MathJax-Span-20" style="padding-left: 0.174em;"><span class="mrow" id="MathJax-Span-21"><span class="msubsup" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.52em, 4.174em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        x
       </mi>
       <mo>
        =
       </mo>
       <msub>
        <mi>
         log
        </mi>
        <mi>
         a
        </mi>
       </msub>
       <mo>
        ⁡
       </mo>
       <mrow class="MJX-TeXAtom-ORD">
        <msup>
         <mi>
          a
         </mi>
         <mi>
          x
         </mi>
        </msup>
       </mrow>
      </math></span></span><script type="math/tex" id="MathJax-Element-4">x=\log_a{a^x}</script>。</p> 
  </blockquote> 
  <p>这是实数域上的对数问题，不是什么难算的东西，随便按一下计算器结果就出来了。</p> 
  <p>而离散对数问题是指这样的问题：</p> 
  <blockquote> 
   <p>给定素数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-25" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.746em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        p
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-5">p</script>和正整数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-28" style="width: 0.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.46em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.46em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        g
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-6">g</script>，知道<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-31" style="width: 6.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1004.8em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-36"><span class="mspace" id="MathJax-Span-37" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-39" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-40" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <msup>
        <mi>
         g
        </mi>
        <mi>
         x
        </mi>
       </msup>
       <mspace width="0.667em"></mspace>
       <mi>
        mod
       </mi>
       <mspace width="thinmathspace"></mspace>
       <mspace width="thinmathspace"></mspace>
       <mi>
        p
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-7">g^x\mod p</script>的值，求<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-42" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        x
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-8">x</script></p> 
  </blockquote> 
  <p>对于符合特定条件的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-45" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       p
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-9">p</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-48" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       g
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-10">g</script>，这个问题是很难解的，更准确地说，是没有多项式时间的解法。</p> 
  <h1 id="diffiehellman密钥交换">Diffie–Hellman密钥交换</h1> 
  <hr> 
  <p>Diffie–Hellman密钥交换（以下简称DH）是用于双方在可能被窃听环境下安全交换密钥的一种方法。 <br> 算法的安全性是由上面提到的离散对数难题保证。</p> 
  <p>具体算法流程如下：</p> 
  <blockquote> 
   <ul> 
    <li>小红和小明约定<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-51" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.746em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-11">p</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-54" style="width: 0.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.46em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.46em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         g
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-12">g</script>的值</li> 
    <li>小红生成私钥<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-57" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         x
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-13">x</script>，计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-60" style="width: 6.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1004.8em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-61"><span class="msubsup" id="MathJax-Span-62"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-65"><span class="mspace" id="MathJax-Span-66" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-68" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-69" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mi>
          g
         </mi>
         <mi>
          x
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-14">g^x\mod p</script>作为公钥公布出去</li> 
    <li>小明生成私钥<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-71" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         y
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-15">y</script>，计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>y</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-74" style="width: 5.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.746em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1004.75em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="msubsup" id="MathJax-Span-76"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-79"><span class="mspace" id="MathJax-Span-80" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-82" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-83" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mi>
          g
         </mi>
         <mi>
          y
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-16">g^y\mod p</script>作为公钥公布出去</li> 
    <li>小红得知<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>y</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-85" style="width: 5.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.746em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1004.75em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="msubsup" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-90"><span class="mspace" id="MathJax-Span-91" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-93" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-94" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mi>
          g
         </mi>
         <mi>
          y
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-17">g^y\mod p</script>后，计算 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>g</mi><mi>y</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>g</mi><mi>y</mi></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><mo>=</mo><msup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mi>y</mi></mrow></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-96" style="width: 31.831em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.431em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.489em, 1025.43em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.289em;">(</span><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-104"><span class="mspace" id="MathJax-Span-105" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-107" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-108" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span><span class="msubsup" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 0.86em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.29em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.403em;"><span class="mi" id="MathJax-Span-112" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-113"><span class="mspace" id="MathJax-Span-114" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-116" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-117" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.289em;">(</span><span class="msubsup" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 0.86em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.29em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.403em;"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-127"><span class="mspace" id="MathJax-Span-128" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-130" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-131" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="msubsup" id="MathJax-Span-134" style="padding-left: 0.289em;"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-140"><span class="mspace" id="MathJax-Span-141" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-143" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-144" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         s
        </mi>
        <mo>
         =
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msup>
         <mi>
          g
         </mi>
         <mi>
          y
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
        <msup>
         <mo stretchy="false">
          )
         </mo>
         <mi>
          x
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
        <mo>
         =
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msup>
         <mi>
          g
         </mi>
         <mi>
          y
         </mi>
        </msup>
        <msup>
         <mo stretchy="false">
          )
         </mo>
         <mi>
          x
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
        <mo>
         =
        </mo>
        <msup>
         <mi>
          g
         </mi>
         <mrow class="MJX-TeXAtom-ORD">
          <mi>
           x
          </mi>
          <mi>
           y
          </mi>
         </mrow>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-18">s=(g^y\mod p)^x\mod p=(g^y)^x\mod p=g^{xy}\mod p</script></li> 
    <li>小明得到<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-146" style="width: 6.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1004.8em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-147"><span class="msubsup" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-151"><span class="mspace" id="MathJax-Span-152" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-154" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-155" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup>
         <mi>
          g
         </mi>
         <mi>
          x
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-19">g^x\mod p</script>后，计算 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>g</mi><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>y</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>g</mi><mi>x</mi></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mi>y</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><mo>=</mo><msup><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mi>y</mi></mrow></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-157" style="width: 31.831em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.431em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.489em, 1025.43em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.289em;">(</span><span class="msubsup" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-165"><span class="mspace" id="MathJax-Span-166" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-168" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-169" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span><span class="msubsup" id="MathJax-Span-171"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.29em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.403em;"><span class="mi" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-174"><span class="mspace" id="MathJax-Span-175" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-177" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-178" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.289em;">(</span><span class="msubsup" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.29em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.403em;"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-188"><span class="mspace" id="MathJax-Span-189" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-191" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-192" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="msubsup" id="MathJax-Span-195" style="padding-left: 0.289em;"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.46em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.517em;"><span class="texatom" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-201"><span class="mspace" id="MathJax-Span-202" style="height: 0em; vertical-align: 0em; width: 0.689em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.174em;">mod</span><span class="mspace" id="MathJax-Span-204" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-205" style="height: 0em; vertical-align: 0em; width: 0.174em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic; padding-left: 0.174em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         s
        </mi>
        <mo>
         =
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msup>
         <mi>
          g
         </mi>
         <mi>
          x
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
        <msup>
         <mo stretchy="false">
          )
         </mo>
         <mi>
          y
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
        <mo>
         =
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msup>
         <mi>
          g
         </mi>
         <mi>
          x
         </mi>
        </msup>
        <msup>
         <mo stretchy="false">
          )
         </mo>
         <mi>
          y
         </mi>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
        <mo>
         =
        </mo>
        <msup>
         <mi>
          g
         </mi>
         <mrow class="MJX-TeXAtom-ORD">
          <mi>
           x
          </mi>
          <mi>
           y
          </mi>
         </mrow>
        </msup>
        <mspace width="0.667em"></mspace>
        <mi>
         mod
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mspace width="thinmathspace"></mspace>
        <mi>
         p
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-20">s=(g^x\mod p)^y\mod p=(g^x)^y\mod p=g^{xy}\mod p</script></li> 
    <li>双方都得到了相同的密钥的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-207" style="width: 0.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.46em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.4em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         s
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-21">s</script>，交换完毕</li> 
   </ul> 
  </blockquote> 
  <p>上面的流程中，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-210" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       x
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-22">x</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-213" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       y
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-23">y</script>始终由两人自行保管的，第三方窃听得到的只有<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-216" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       p
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-24">p</script>、<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-219" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       g
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-25">g</script>、<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>x</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-222" style="width: 5.853em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.652em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1004.65em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-223"><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.552em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-227"><span class="mspace" id="MathJax-Span-228" style="height: 0em; vertical-align: 0em; width: 0.653em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.152em;">mod</span><span class="mspace" id="MathJax-Span-230" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-231" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mi>
        g
       </mi>
       <mi>
        x
       </mi>
      </msup>
      <mspace width="0.667em"></mspace>
      <mi>
       mod
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mspace width="thinmathspace"></mspace>
      <mi>
       p
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-26">g^x\mod p</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>g</mi><mi>y</mi></msup><mspace width=&quot;0.667em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-233" style="width: 5.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1004.6em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-234"><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.552em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-238"><span class="mspace" id="MathJax-Span-239" style="height: 0em; vertical-align: 0em; width: 0.653em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Main; padding-left: 0.152em;">mod</span><span class="mspace" id="MathJax-Span-241" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-242" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mi>
        g
       </mi>
       <mi>
        y
       </mi>
      </msup>
      <mspace width="0.667em"></mspace>
      <mi>
       mod
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mspace width="thinmathspace"></mspace>
      <mi>
       p
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-27">g^y\mod p</script>这几个值。 <br> 上面说过，离散对数是很难算的，所以第三方不能由这些信息计算出<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-244" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       x
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-28">x</script>或<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-247" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       y
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-29">y</script>，也就没办法计算出密钥<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-250" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.4em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       s
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-30">s</script>了。</p> 
  <h1 id="椭圆曲线">椭圆曲线</h1> 
  <hr> 
  <p>中学的时候我们学过圆锥曲线，比如椭圆、双曲线和抛物线。因为描述这些曲线的方程都是二次方程，圆锥曲线又被称为二次曲线。而椭圆曲线是则是由三次方程描述的一些曲线。更准确地说，椭圆曲线是由下面的方程描述的曲线： <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span></p>
  <div class="MathJax_Display">
   <span class="MathJax MathJax_FullWidth" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5176;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x4E2D;</mo></mrow><mn>4</mn><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><mn>27</mn><msup><mi>b</mi><mn>2</mn></msup><mo>&amp;#x2260;</mo><mn>0</mn></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-253" style="width: 100%; display: inline-block; min-width: 9.253em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.952em, 1007.35em, 5.902em, -999.998em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.952em, 1007.25em, 4.353em, -999.998em); top: -3.998em; left: 50%; margin-left: -3.647em;"><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="msubsup" id="MathJax-Span-259" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">b</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(2.952em, 1007.35em, 4.353em, -999.998em); top: -2.498em; left: 50%; margin-left: -3.698em;"><span class="mspace" id="MathJax-Span-267" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mo" id="MathJax-Span-270"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 80%; font-style: normal; font-weight: normal;">其</span></span></span></span><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mo" id="MathJax-Span-273"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 80%; font-style: normal; font-weight: normal;">中</span></span></span></span><span class="mn" id="MathJax-Span-274" style="font-family: MathJax_Main;">4</span><span class="msubsup" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.202em;">27</span><span class="msubsup" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.4em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.453em;"><span class="mn" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.302em;">≠</span><span class="mn" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.302em;">0</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 3.378em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msup>
       <mi>
        y
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        x
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       +
      </mo>
      <mi>
       a
      </mi>
      <mi>
       x
      </mi>
      <mo>
       +
      </mo>
      <mi>
       b
      </mi>
      <mspace linebreak="newline"></mspace>
      <mrow class="MJX-TeXAtom-ORD">
       <mo>
        其
       </mo>
      </mrow>
      <mrow class="MJX-TeXAtom-ORD">
       <mo>
        中
       </mo>
      </mrow>
      <mn>
       4
      </mn>
      <msup>
       <mi>
        a
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       +
      </mo>
      <mn>
       27
      </mn>
      <msup>
       <mi>
        b
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       ≠
      </mo>
      <mn>
       0
      </mn>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-31">y^2=x^3+ax+b\\
其中4a^3+27b^2\neq 0</script> 
  <br> 需要注意的是，椭圆曲线之所以叫“椭圆曲线”，是因为其曲线方程跟利用微积分计算椭圆周长的公式相似。实际上它的图像跟椭圆完全不搭边。
  <p></p> 
  <p>下图是椭圆曲线<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>&amp;#x2212;</mo><mi>x</mi><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-285" style="width: 8.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1006.75em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-286"><span class="msubsup" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.552em;"><span class="mn" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="msubsup" id="MathJax-Span-291" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.552em;"><span class="mn" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main; padding-left: 0.202em;">−</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">x</span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-297" style="font-family: MathJax_Main; padding-left: 0.202em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mi>
        y
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        x
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       −
      </mo>
      <mi>
       x
      </mi>
      <mo>
       +
      </mo>
      <mn>
       1
      </mn>
     </math></span></span><script type="math/tex" id="MathJax-Element-32">y^2=x^3-x+1</script>的图像 <br> <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170802194458504?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcW1pY2tlY3M=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""></p> 
  <p>椭圆曲线有这样的两个性质：</p> 
  <blockquote> 
   <ol> 
    <li>关于X轴对称</li> 
    <li>画一条直线跟椭圆曲线相交，它们最多有三个交点</li> 
   </ol> 
  </blockquote> 
  <h1 id="椭圆曲线上的运算">椭圆曲线上的运算</h1> 
  <hr> 
  <p>由于椭圆曲线加密进行的运算实际上都是在椭圆曲线上进行的，所以接下来需要定义一些椭圆曲线上的运算。</p> 
  <p>必须注意的是，这里把这些运算称为“加法”和“乘法”仅仅是方便描述，他们跟平时认知的加法和乘法完全是两码事，完全可以给他们取其它名字（比如”乘法“和”幂运算“等）。</p> 
  <ol> 
   <li><p>首先定义坐标系中距离X轴无穷远点为椭圆曲线上的一个特殊点，称为<strong>0点</strong>。 <br> 那么此时上述第二条性质可以加强为：过曲线上任意两点（可重合）的直线必定与曲线相交于第三点。</p></li> 
   <li><p>然后定义椭圆曲线上点的<strong>加法</strong>。设椭圆曲线上有两点，A和B点，那么作过这两点的直线与该曲线相交于第三点（C点），然后关于X轴对称得到D点，则D为这两个点的和，记作<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-298" style="width: 6.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.902em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1004.9em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">A</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">B</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         D
        </mi>
        <mo>
         =
        </mo>
        <mi>
         A
        </mi>
        <mo>
         +
        </mo>
        <mi>
         B
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-33">D=A+B</script>。很明显，D点也在该曲线上。所以椭圆曲线上两点之和也是曲线上的点。 <br> <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170802210746976?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcW1pY2tlY3M=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="A+B" title=""></p> <p>特别地，如果两点重合，则作椭圆曲线在A点处的切线，与曲线相交于第二点（B点），然后关于X轴对称得到C点，则C点为A点与自身的和，记作<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>A</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-305" style="width: 6.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1004.8em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">A</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">A</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         C
        </mi>
        <mo>
         =
        </mo>
        <mi>
         A
        </mi>
        <mo>
         +
        </mo>
        <mi>
         A
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-34">C=A+A</script> <br> <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170802212227449?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcW1pY2tlY3M=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="A+A" title=""></p> <p>那么关于这个加法，我们可以得到以下结论：</p> 
    <ul>
     <li><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>+</mo><mi>B</mi><mo>=</mo><mi>B</mi><mo>+</mo><mi>A</mi></math>" role="presentation" style="position: relative;">
        <nobr aria-hidden="true">
         <span class="math" id="MathJax-Span-312" style="width: 8.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.753em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1006.75em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-313"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">B</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">B</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">A</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span>
        </nobr><span class="MJX_Assistive_MathML" role="presentation">
         <math xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>
           A
          </mi>
          <mo>
           +
          </mo>
          <mi>
           B
          </mi>
          <mo>
           =
          </mo>
          <mi>
           B
          </mi>
          <mo>
           +
          </mo>
          <mi>
           A
          </mi>
         </math></span></span><script type="math/tex" id="MathJax-Element-35">A+B=B+A</script> <br> 也就是椭圆曲线上的加法满足交换律。</p></li> 
     <li><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>+</mo><mn>0</mn><mo>=</mo><mi>A</mi></math>" role="presentation" style="position: relative;">
        <nobr aria-hidden="true">
         <span class="math" id="MathJax-Span-321" style="width: 5.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.553em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1004.55em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-325" style="font-family: MathJax_Main; padding-left: 0.202em;">0</span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">A</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span>
        </nobr><span class="MJX_Assistive_MathML" role="presentation">
         <math xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>
           A
          </mi>
          <mo>
           +
          </mo>
          <mn>
           0
          </mn>
          <mo>
           =
          </mo>
          <mi>
           A
          </mi>
         </math></span></span><script type="math/tex" id="MathJax-Element-36">A+0=A</script> <br> 因为0点是无穷远点，所以过A点与0点的直线是垂直于X轴的，它与曲线相交于另一点B点，那么B点关于X轴对称的点就是A点，即A点为A点和0点之和。 <br> <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170802235027351?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcW1pY2tlY3M=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="A+0" title=""></p></li>
    </ul></li> 
   <li><p>然后在加法的基础上，定义椭圆曲线上点的<strong>乘法</strong>。 <br> 设<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-328" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.753em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.75em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-329"><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-37">P</script>是椭圆曲线上的一个点，那么正整数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-331" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.5em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         k
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-38">k</script>乘以点<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-334" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.753em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.75em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-39">P</script>的结果由下面的式子定义，注意式子中的加法是上面提到的椭圆曲线上点的加法： <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2217;</mo><mi>P</mi><mo>=</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-337" style="width: 5.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.252em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1004.25em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mn" id="MathJax-Span-339" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mn>
         1
        </mn>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo>
         =
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-40">1*P=P</script> <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mo>&amp;#x2217;</mo><mi>P</mi><mo>=</mo><mi>P</mi><mo>+</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-344" style="width: 7.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.202em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1006.2em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-345"><span class="mn" id="MathJax-Span-346" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mn>
         2
        </mn>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo>
         =
        </mo>
        <mi>
         P
        </mi>
        <mo>
         +
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-41">2*P=P+P</script> <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn><mo>&amp;#x2217;</mo><mi>P</mi><mo>=</mo><mn>2</mn><mo>&amp;#x2217;</mo><mi>P</mi><mo>+</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-353" style="width: 9.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1007.6em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-354"><span class="mn" id="MathJax-Span-355" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mn" id="MathJax-Span-359" style="font-family: MathJax_Main; padding-left: 0.302em;">2</span><span class="mo" id="MathJax-Span-360" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mn>
         3
        </mn>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo>
         =
        </mo>
        <mn>
         2
        </mn>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo>
         +
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-42">3*P=2*P+P</script> <br> … <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2217;</mo><mi>P</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mi>P</mi><mo>+</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-364" style="width: 12.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.103em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em, 1010.1em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-365"><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-367" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main; padding-left: 0.302em;">(</span><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main; padding-left: 0.202em;">−</span><span class="mn" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.202em;">1</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         k
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo>
         =
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         k
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo>
         +
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-43">k*P=(k-1)*P+P</script></p> <p>这个乘法满足以下性质：</p> 
    <blockquote> 
     <p>对于任意正整数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-379" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>
          k
         </mi>
        </math></span></span><script type="math/tex" id="MathJax-Element-44">k</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-382" style="width: 0.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.4em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>
          j
         </mi>
        </math></span></span><script type="math/tex" id="MathJax-Element-45">j</script>，有 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo>&amp;#x2217;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mi>P</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mi>P</mi><mo>=</mo><mi>j</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>&amp;#x2217;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-385" style="width: 24.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.66em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.489em, 1019.55em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-388" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main; padding-left: 0.231em;">(</span><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span class="mo" id="MathJax-Span-393" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main; padding-left: 0.289em;">(</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.289em;">(</span><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math-italic; padding-left: 0.289em;">j</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main; padding-left: 0.231em;">(</span><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>
          k
         </mi>
         <mo>
          ∗
         </mo>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          j
         </mi>
         <mo>
          ∗
         </mo>
         <mi>
          P
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          =
         </mo>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          k
         </mi>
         <mi>
          j
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          ∗
         </mo>
         <mi>
          P
         </mi>
         <mo>
          =
         </mo>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          j
         </mi>
         <mi>
          k
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          ∗
         </mo>
         <mi>
          P
         </mi>
         <mo>
          =
         </mo>
         <mi>
          j
         </mi>
         <mo>
          ∗
         </mo>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          k
         </mi>
         <mo>
          ∗
         </mo>
         <mi>
          P
         </mi>
         <mo stretchy="false">
          )
         </mo>
        </math></span></span><script type="math/tex" id="MathJax-Element-46">k*(j*P)=(kj)*P=(jk)*P=j*(k*P)</script></p> 
    </blockquote> <p>这个性质在椭圆曲线密钥交换中会利用到。</p></li> 
  </ol> 
  <h1 id="椭圆曲线上的离散对数问题">椭圆曲线上的离散对数问题</h1> 
  <hr> 
  <p>定义了基本的加法和乘法运算后，我们可以由此得到椭圆曲线加密依赖的数学难题。</p> 
  <blockquote> 
   <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-416" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        k
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-47">k</script>为正整数，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-419" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.75em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        P
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-48">P</script>是椭圆曲线上的点（称为基点），已知<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-422" style="width: 2.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.231em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1002.23em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-423"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        k
       </mi>
       <mo>
        ∗
       </mo>
       <mi>
        P
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-49">k*P</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-427" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.75em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        P
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-50">P</script>，计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-430" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        k
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-51">k</script></p> 
  </blockquote> 
  <p>从程序实现的角度来考虑，假设有这么一个函数：</p> 
  <pre class="prettyprint"><code class="language-c++ hljs r"> Point add(Point A, Point B) {<span class="hljs-keyword">...</span>}</code></pre> 
  <p>函数参数是两个椭圆曲线上的点，返回值是过两个点的直线与椭圆曲线相交的第三个点关于X轴对称的点。 <br> 那么按照如下方式调用函数：</p> 
  <pre class="prettyprint"><code class="language-c++ hljs oxygene">Point <span class="hljs-keyword">result</span> = P;
<span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; k - <span class="hljs-number">1</span>; i++)
    <span class="hljs-keyword">result</span> = <span class="hljs-keyword">add</span>(P, <span class="hljs-keyword">result</span>);
sendTo((<span class="hljs-keyword">result</span>, P), others);</code></pre> 
  <p>如果别人只知道<code>result</code>和<code>P</code>点，是很难求出<code>k</code>的值是多少的。</p> 
  <p>如果我们改一种记法，把椭圆曲线上点的加法记作乘法，原来的乘法就变成了幂运算，那么上述难题的形式跟离散对数问题应该是一致的。即：</p> 
  <blockquote> 
   <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-433" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        k
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-52">k</script>为正整数，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-436" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.75em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-437"><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        P
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-53">P</script>是椭圆曲线上的点，已知<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>P</mi><mi>k</mi></msup></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-439" style="width: 1.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.26em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.374em, 1001.26em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="msubsup" id="MathJax-Span-441"><span style="display: inline-block; position: relative; width: 1.26em; height: 0px;"><span style="position: absolute; clip: rect(3.146em, 1000.75em, 4.174em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.86em;"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <msup>
        <mi>
         P
        </mi>
        <mi>
         k
        </mi>
       </msup>
      </math></span></span><script type="math/tex" id="MathJax-Element-54">P^k</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-444" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.746em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.75em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        P
       </mi>
      </math></span></span><script type="math/tex" id="MathJax-Element-55">P</script>，计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>=</mo><msub><mi>log</mi><mi>P</mi></msub><mo>&amp;#x2061;</mo><msup><mi>P</mi><mi>k</mi></msup></math>" role="presentation" style="position: relative;">
     <nobr aria-hidden="true">
      <span class="math" id="MathJax-Span-447" style="width: 6.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.374em, 1005.2em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-450" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="msubsup" id="MathJax-Span-451" style="padding-left: 0.289em;"><span style="display: inline-block; position: relative; width: 1.889em; height: 0px;"><span style="position: absolute; clip: rect(3.146em, 1001.26em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Main;">log</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.769em; left: 1.26em;"><span class="mi" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-454"></span><span class="msubsup" id="MathJax-Span-455" style="padding-left: 0.174em;"><span style="display: inline-block; position: relative; width: 1.26em; height: 0px;"><span style="position: absolute; clip: rect(3.146em, 1000.75em, 4.174em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.34em; left: 0.86em;"><span class="mi" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span>
     </nobr><span class="MJX_Assistive_MathML" role="presentation">
      <math xmlns="http://www.w3.org/1998/Math/MathML">
       <mi>
        k
       </mi>
       <mo>
        =
       </mo>
       <msub>
        <mi>
         log
        </mi>
        <mi>
         P
        </mi>
       </msub>
       <mo>
        ⁡
       </mo>
       <msup>
        <mi>
         P
        </mi>
        <mi>
         k
        </mi>
       </msup>
      </math></span></span><script type="math/tex" id="MathJax-Element-56">k=\log_PP^k</script>。</p> 
  </blockquote> 
  <p>所以这个难题叫椭圆曲线上的离散对数问题。</p> 
  <p>尽管两者形式一致，但是他们<strong>并不等价</strong>。实际上这个问题比大整数质因子分解（RSA）和离散对数（DH）难题都要难得多，以致于同样的安全强度下，椭圆曲线加密的密钥比RSA和DH的短不少，这是椭圆曲线加密的一大优势。</p> 
  <h1 id="有限域上的椭圆曲线">有限域上的椭圆曲线</h1> 
  <hr> 
  <p>但是密码学中，并不能使用上面介绍的实数域上的椭圆曲线。因为 <br> 1. 实数域上的椭圆曲线是连续的，有无限个点，密码学要求有限点。 <br> 2. 实数域上的椭圆曲线的运算有误差，不精确。密码学要求精确。 </p> 
  <p>所以我们需要引入有限域上的椭圆曲线。</p> 
  <p>所谓有限域上的椭圆曲线，简单来说就是满足下面式子要求的曲线（x, y, a, b都是小于素数p的非负整数）： <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span></p>
  <div class="MathJax_Display">
   <span class="MathJax MathJax_FullWidth" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace width=&quot;1em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5176;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x4E2D;</mo></mrow><mn>4</mn><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><mn>27</mn><msup><mi>b</mi><mn>2</mn></msup><mo>&amp;#x2260;</mo><mn>0</mn><mspace width=&quot;1em&quot; /><mi>mod</mi><mspace width=&quot;thinmathspace&quot; /><mspace width=&quot;thinmathspace&quot; /><mi>p</mi></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-720" style="width: 100%; display: inline-block; min-width: 14.253em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.952em, 1011.4em, 5.902em, -999.998em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-721"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.952em, 1011.3em, 4.353em, -999.998em); top: -3.998em; left: 50%; margin-left: -5.647em;"><span class="msubsup" id="MathJax-Span-722"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-723" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-724" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="msubsup" id="MathJax-Span-726" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-727" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-728" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-732" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">b</span><span class="TeXmathchoice" id="MathJax-Span-734"><span class="mspace" id="MathJax-Span-735" style="height: 0em; vertical-align: 0em; width: 1.002em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Main; padding-left: 0.152em;">mod</span><span class="mspace" id="MathJax-Span-737" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-738" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">p</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(2.952em, 1011.4em, 4.353em, -999.998em); top: -2.498em; left: 50%; margin-left: -5.697em;"><span class="mspace" id="MathJax-Span-740" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-741"><span class="mrow" id="MathJax-Span-742"><span class="mo" id="MathJax-Span-743"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 80%; font-style: normal; font-weight: normal;">其</span></span></span></span><span class="texatom" id="MathJax-Span-744"><span class="mrow" id="MathJax-Span-745"><span class="mo" id="MathJax-Span-746"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 80%; font-style: normal; font-weight: normal;">中</span></span></span></span><span class="mn" id="MathJax-Span-747" style="font-family: MathJax_Main;">4</span><span class="msubsup" id="MathJax-Span-748"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-750" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.202em;">27</span><span class="msubsup" id="MathJax-Span-753"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.4em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.453em;"><span class="mn" id="MathJax-Span-755" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main; padding-left: 0.302em;">≠</span><span class="mn" id="MathJax-Span-757" style="font-family: MathJax_Main; padding-left: 0.302em;">0</span><span class="TeXmathchoice" id="MathJax-Span-758"><span class="mspace" id="MathJax-Span-759" style="height: 0em; vertical-align: 0em; width: 1.002em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Main; padding-left: 0.152em;">mod</span><span class="mspace" id="MathJax-Span-761" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-762" style="height: 0em; vertical-align: 0em; width: 0.152em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-763" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">p</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 3.378em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msup>
       <mi>
        y
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        x
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       +
      </mo>
      <mi>
       a
      </mi>
      <mi>
       x
      </mi>
      <mo>
       +
      </mo>
      <mi>
       b
      </mi>
      <mspace width="1em"></mspace>
      <mi>
       mod
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mspace width="thinmathspace"></mspace>
      <mi>
       p
      </mi>
      <mspace linebreak="newline"></mspace>
      <mrow class="MJX-TeXAtom-ORD">
       <mo>
        其
       </mo>
      </mrow>
      <mrow class="MJX-TeXAtom-ORD">
       <mo>
        中
       </mo>
      </mrow>
      <mn>
       4
      </mn>
      <msup>
       <mi>
        a
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       +
      </mo>
      <mn>
       27
      </mn>
      <msup>
       <mi>
        b
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       ≠
      </mo>
      <mn>
       0
      </mn>
      <mspace width="1em"></mspace>
      <mi>
       mod
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mspace width="thinmathspace"></mspace>
      <mi>
       p
      </mi>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-76">y^2 =x^3+ax+b \mod p\\
其中4a^3+27b^2\neq 0\mod p</script>
  <p></p> 
  <p>对比一下原先的椭圆曲线的方程： <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span></p>
  <div class="MathJax_Display">
   <span class="MathJax MathJax_FullWidth" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5176;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x4E2D;</mo></mrow><mn>4</mn><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><mn>27</mn><msup><mi>b</mi><mn>2</mn></msup><mo>&amp;#x2260;</mo><mn>0</mn></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-764" style="width: 100%; display: inline-block; min-width: 9.253em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.952em, 1007.35em, 5.902em, -999.998em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.952em, 1007.25em, 4.353em, -999.998em); top: -3.998em; left: 50%; margin-left: -3.647em;"><span class="msubsup" id="MathJax-Span-766"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-767" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-768" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-769" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="msubsup" id="MathJax-Span-770" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-772" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mi" id="MathJax-Span-775" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">b</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(2.952em, 1007.35em, 4.353em, -999.998em); top: -2.498em; left: 50%; margin-left: -3.698em;"><span class="mspace" id="MathJax-Span-778" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-779"><span class="mrow" id="MathJax-Span-780"><span class="mo" id="MathJax-Span-781"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 80%; font-style: normal; font-weight: normal;">其</span></span></span></span><span class="texatom" id="MathJax-Span-782"><span class="mrow" id="MathJax-Span-783"><span class="mo" id="MathJax-Span-784"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 80%; font-style: normal; font-weight: normal;">中</span></span></span></span><span class="mn" id="MathJax-Span-785" style="font-family: MathJax_Main;">4</span><span class="msubsup" id="MathJax-Span-786"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-787" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.552em;"><span class="mn" id="MathJax-Span-788" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-789" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-790" style="font-family: MathJax_Main; padding-left: 0.202em;">27</span><span class="msubsup" id="MathJax-Span-791"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.4em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.453em;"><span class="mn" id="MathJax-Span-793" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main; padding-left: 0.302em;">≠</span><span class="mn" id="MathJax-Span-795" style="font-family: MathJax_Main; padding-left: 0.302em;">0</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 3.378em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msup>
       <mi>
        y
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        x
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       +
      </mo>
      <mi>
       a
      </mi>
      <mi>
       x
      </mi>
      <mo>
       +
      </mo>
      <mi>
       b
      </mi>
      <mspace linebreak="newline"></mspace>
      <mrow class="MJX-TeXAtom-ORD">
       <mo>
        其
       </mo>
      </mrow>
      <mrow class="MJX-TeXAtom-ORD">
       <mo>
        中
       </mo>
      </mrow>
      <mn>
       4
      </mn>
      <msup>
       <mi>
        a
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       +
      </mo>
      <mn>
       27
      </mn>
      <msup>
       <mi>
        b
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       ≠
      </mo>
      <mn>
       0
      </mn>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-77">y^2=x^3+ax+b\\
其中4a^3+27b^2\neq 0</script> 
  <br> 可以看到这个只是对原式进行了简单的取模处理而已。实际上RSA和DH中也是基于这种形式的取模运算。
  <p></p> 
  <p>下图是椭圆曲线<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>&amp;#x2212;</mo><mi>x</mi><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-796" style="width: 8.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1006.75em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="msubsup" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.552em;"><span class="mn" id="MathJax-Span-800" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-801" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="msubsup" id="MathJax-Span-802" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.552em;"><span class="mn" id="MathJax-Span-804" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-805" style="font-family: MathJax_Main; padding-left: 0.202em;">−</span><span class="mi" id="MathJax-Span-806" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">x</span><span class="mo" id="MathJax-Span-807" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mn" id="MathJax-Span-808" style="font-family: MathJax_Main; padding-left: 0.202em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mi>
        y
       </mi>
       <mn>
        2
       </mn>
      </msup>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        x
       </mi>
       <mn>
        3
       </mn>
      </msup>
      <mo>
       −
      </mo>
      <mi>
       x
      </mi>
      <mo>
       +
      </mo>
      <mn>
       1
      </mn>
     </math></span></span><script type="math/tex" id="MathJax-Element-78">y^2 = x^3 - x + 1</script>对素数97取模后的图像（图片来自参考文献） <br> <img src="https://cdn.arstechnica.net/wp-content/uploads/2013/10/elliptic-curve-crypt-image06-640x456.png" alt="" title=""> <br> 原本连续光滑的曲线变成了离散的点，基本已经面目全非了，但是依然可以看到它是关于某条水平直线（y=97/2）对称的。</p> 
  <p>而且上面定义的椭圆曲线的加法仍然可用（当然乘法也可以）（图片来自参考文献）。 <br> <img src="https://cdn.arstechnica.net/wp-content/uploads/2013/10/elliptic-curve-crypt-image01.gif" alt="" title=""></p> 
  <p>注意：密码学中有限域上的椭圆曲线一般有两种，一种是定义在以素数p为模的整数域GF(p)，也就是上面介绍的；另一种则是定义在特征为2的伽罗瓦域GF(2^m)上，篇幅所限，这里就不介绍了。</p> 
  <h1 id="基于椭圆曲线的dh密钥交换ecdh">基于椭圆曲线的DH密钥交换（ECDH）</h1> 
  <hr> 
  <p>ECDH跟DH的流程基本是一致的。</p> 
  <blockquote> 
   <ul> 
    <li>小红和小明约定使用某条椭圆曲线（包括曲线参数，有限域参数以及基点P等）</li> 
    <li>小红生成私钥<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-553" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-554"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         x
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-60">x</script>，计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-556" style="width: 2.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.289em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1002.29em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-557"><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         x
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-61">x*P</script>作为公钥公布出去</li> 
    <li>小明生成私钥<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-561" style="width: 0.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.517em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.52em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         y
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-62">y</script>，计算<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-564" style="width: 2.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.231em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1002.23em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-565"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         y
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-63">y*P</script>作为公钥公布出去</li> 
    <li>小红得知<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-569" style="width: 2.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.231em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1002.23em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-573" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         y
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-64">y*P</script>后，计算 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><mi>x</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2217;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>x</mi><mi>y</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-574" style="width: 13.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.46em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.489em, 1010.46em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math-italic; padding-left: 0.289em;">x</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main; padding-left: 0.231em;">(</span><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-585" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic; padding-left: 0.289em;">x</span><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-588" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         s
        </mi>
        <mo>
         =
        </mo>
        <mi>
         x
        </mi>
        <mo>
         ∗
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         y
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         =
        </mo>
        <mi>
         x
        </mi>
        <mi>
         y
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-65">s=x*(y*P)=xy*P</script></li> 
    <li>小明得到<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-590" style="width: 2.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.289em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1002.29em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-591"><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         x
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-66">x*P</script>后，计算 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>=</mo><mi>y</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2217;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>y</mi><mi>x</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-595" style="width: 13.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.46em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.489em, 1010.46em, 2.803em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic; padding-left: 0.289em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main; padding-left: 0.231em;">(</span><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main; padding-left: 0.289em;">=</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic; padding-left: 0.289em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main; padding-left: 0.231em;">∗</span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic; padding-left: 0.231em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.117em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         s
        </mi>
        <mo>
         =
        </mo>
        <mi>
         y
        </mi>
        <mo>
         ∗
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         x
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         =
        </mo>
        <mi>
         y
        </mi>
        <mi>
         x
        </mi>
        <mo>
         ∗
        </mo>
        <mi>
         P
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-67">s=y*(x*P)=yx*P</script></li> 
    <li>双方都得到了相同的密钥的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation" style="position: relative;">
      <nobr aria-hidden="true">
       <span class="math" id="MathJax-Span-611" style="width: 0.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.46em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.774em, 1000.4em, 2.574em, -999.997em); top: -2.397em; left: 0em;"><span class="mrow" id="MathJax-Span-612"><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.403em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span>
      </nobr><span class="MJX_Assistive_MathML" role="presentation">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>
         s
        </mi>
       </math></span></span><script type="math/tex" id="MathJax-Element-68">s</script>，交换完毕</li> 
   </ul> 
  </blockquote> 
  <p>由于计算椭圆曲线上的离散对数是很难的，所以第三方没办法在只知道<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-614" style="width: 2.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.202em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1002.2em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-618" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       x
      </mi>
      <mo>
       ∗
      </mo>
      <mi>
       P
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-69">x*P</script>和<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>&amp;#x2217;</mo><mi>P</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-619" style="width: 2.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.152em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1002.15em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       y
      </mi>
      <mo>
       ∗
      </mo>
      <mi>
       P
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-70">y*P</script>的情况下计算出<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-624" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-625"><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       x
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-71">x</script>或<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-627" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-628"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       y
      </mi>
     </math></span></span><script type="math/tex" id="MathJax-Element-72">y</script>的值。</p> 
  <p>实际应用中，我们并不需要关心椭圆曲线的众多参数如何选取（要选对参数对于普通使用者来说并不现实），只要从密码学家们精心挑选的一堆曲线中选择一个就行了。一般来说曲线Curve25519，prime256v1是比较常用的，比特币选择secp256k1则是有自己的考量。</p> 
  <h1 id="参考文献">参考文献</h1> 
  <p><a href="www.global-sci.org/mc/issues/4/no3/freepdf/70s.pdf" rel="nofollow">浅说椭圆曲线</a> <br> <a href="https://arstechnica.com/information-technology/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/?comments=1" rel="nofollow">A (relatively easy to understand) primer on elliptic curve cryptography</a> <br> <a href="https://en.wikipedia.org/wiki/Elliptic_curve" rel="nofollow">Wikipedia: Elliptic curve</a> <br> <a href="https://en.wikipedia.org/wiki/Elliptic_curve_cryptography" rel="nofollow">Wikipedia: Elliptic curve cryptography</a> <br> <a href="http://pangjiuzala.github.io/2016/03/03/Bitcoin%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="nofollow">Bitcoin加密技术之椭圆曲线密码学</a> <br> <a href="ftp://ftp.cs.sjtu.edu.cn:990/liu-sl/Applied%20Algebra/%CD%D6%D4%B2%C7%FA%CF%DF%BD%B2%D2%E5/%CD%D6%D4%B2%C7%FA%CF%DF%C3%DC%C2%EB%CC%E5%D6%C6.doc" rel="nofollow">椭圆曲线密码体制</a></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7f770a53f2.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/qmickecs/article/details/76585303,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/qmickecs/article/details/76585303,&quot;}">阅读更多</a> 
</div> 
<script>
						(function(){
							function setArticleH(btnReadmore,posi){
								var winH = $(window).height();
								var articleBox = $("div.article_content");
								var artH = articleBox.height();
								if(artH > winH*posi){
									articleBox.css({
										'height':winH*posi+'px',
										'overflow':'hidden'
									})
									btnReadmore.click(function(){
										articleBox.removeAttr("style");
										$(this).parent().remove();
									})
								}else{
									btnReadmore.parent().remove();
								}
							}
							var btnReadmore = $("#btn-readmore");
							if(btnReadmore.length>0){
								if(currentUserName){
									setArticleH(btnReadmore,3);
								}else{
									setArticleH(btnReadmore,1.2);
								}
							}
						})()
					</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
