<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>比特币开发指南 - 交易Transactions（转） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="比特币开发指南 - 交易Transactions（转）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="转自:http://8btc.com/article-1759-1.html 交易Transactions &nbsp;“交易”是用户使用比特币的过程。每个交易由几个部分构成，一个交易即可以是简单的直接支付，也可以是复杂的交易。本小节会描述交易的每一个部门，而且说明怎样把各个部分合起来构建成一个完整的交易。 为了简单起便，本小节假设&nbsp;coinbase&nbsp;transactions&nbsp;不存在。&nbsp;coinbase&nbsp;transactions只能被矿机创建并且这些交易是下面很多规则的例外。与其一一指出&nbsp;coinbase&nbsp;transactions交易的例外，我们更加建议读者阅读本指南”区块链”一章里面关于&nbsp;coinbase&nbsp;transactions的内容。 &nbsp;&nbsp; 上面的图标说明了比特币交易的核心部分。每个交易至少由一个input和一个output。每个input&nbsp;使用上一个oupt的比特币作为输入。每个output作为未花费的output【Unspent&nbsp;Transaction&nbsp;Output&nbsp;(UTXO)】等待着，直到一个最近的inptut使用这个output。当你的比特币钱包告诉你余额有10BTC时，它真正的意思是说你有10BTC在一个或者多少UTXOs等待被花费出去。 每个交易的前缀由四个字节的“交易版本序号”组成，这可以让比特币节点和矿工知道本交易适用于哪些规则。这也方便开发者未来开发出的新规则和旧规则能相兼容。 下面的图帮助你了解交易的一些特点，图示的工作流是ALICE发送了一个交易给BOB，稍后BOB又把这个交易发送出去。ALICE和BOB使用的都是最常见的标准交易类型，Pay-To-Public-Key-Hash&nbsp;(P2PKH)。P2PKH&nbsp;&nbsp;让ALICE可以把比特币发送到一个典型的比特币地址上，然后又让BOB可以进一步通过简单的密钥对把比特币发送出去。 &nbsp;&nbsp; 在ALICE创建第一笔交易前，Bob必须先生成公钥/私钥对。标准的比特币私钥是长度为256b的随机字符串。一份私钥的数据，最后会经过变成而成“公钥”。因为那个变形可以在稍后重复进行，所以公钥并不需要保存。 接着公钥将加密并未得哈希值。公钥的哈希值同样也可以再次求出来，所以也不需要保存。哈希值比较短，而且也经过混淆，使得手工抄写比较简单，而且也提供了对抗未知问题的安全性，这些未知问题如允许在往后的日子里面通过公钥重新构造成私钥。 BOB把公钥的哈希值提供给ALICE。公钥哈希就是大家所熟知的编码过的比特币地址，编码采用的base58进行，里面包含了一个版本序号、哈希值以及一个用来校验错误的值。比特币地址可能通过任何介质传播，当然也包括单向的介质，这样可以切断发款人和收款人的联系，比特币地址还可以被进一步编码成其它的格式，比如包括”bitcoion：”的二维码地址。 只要ALICE拿到地址，而且解码还原为原来的标准哈希值，她就可以创建第一笔交易了。她创建了一个标准的P2PKH交易输出，里面包括了可以让任何人花费这笔输出的“说明”，只这他能证明他拥有与BOB的公钥对应的私钥。那些说明，称为“script”。 ALICE广播那一笔交易并且把它添加到区块链。比特币网络会收集这一笔交易，并把它作为未花费的交易【Unspent&nbsp;Transaction&nbsp;Output&nbsp;(UTXO),】，并在bob的钱包软件显示为可以使用的余额。 未来，如果bob决定把那个UTXO用出去，他必须创建一个引用了ALICE创建的交易的哈希值（这个哈希值被称为交易标识（txid）），而且还要引用ALICE使用过的那一笔的输出索引。BOB必须创建一个“scriptSig”，&nbsp;scriptSig是指一个包括满足ALICE之前那笔交易设置的条件的数据集合。 &nbsp;&nbsp; Bob并不需要和ALICE进行沟通，BOB只要简单地在比特币点对点网络上证明，他可以满足那些script指定的条件就可恼。对于P2PKH类型的输出，BOB的scriptSig只需要包含下面两个条件即可： 1.&nbsp;他提供的完整公钥（未经过哈希运算），以便于script&nbsp;可以通过重新求得哈希值来验 &nbsp;证ALICE提供的哈希值是否一致。 2.&nbsp;一个用bob提供私钥采用ECDSA&nbsp;加密算法计算出的包含确定的交易数据的签名。这个签名用来验证BOB是否拥有那个生成公钥的私钥。 Bob的签名不仅仅是证明BOB拥有他的私钥，签名同时还保证了BOB的签名不被篡改，这样就可以在比特币P2P网络安全地进行广播。 &nbsp; 如上图所示，bob的签名包括了txid和前一个交易的输出索引、前一个交易的script、bob创建的可以让下一个接收者花费它这个output的script、总共要转给下一具接者的比特币数量。本质上来说，整个交易都被签名除了scriptSigs，因为scriptSigs持有了公钥以及相关的signatures。 把他的signature&nbsp;和公钥放到scriptSig后，BOB通过P2P网络广播这一笔交易给比特币矿机。在进一步广播以及被包含进区块链之前，每一个节点和矿机都独立地验证这一笔交易。 P2PKH&nbsp;Script&nbsp;Validation 验证的过程需要重新评估script。在一个P2PKH类型的output里面，script&nbsp;如下： OP_DUP&nbsp;OP_HASH160&nbsp;&lt;pubkeyhash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG&lt;/pubkeyhash&gt; 发送者的scriptSig&nbsp;是经过验证的，而且也是script的开头部分。在一个标准的P2PKH&nbsp;交易中，scriptSig&nbsp;包含了一个signature&nbsp;以及一个完整公钥创建的字符串连接： &lt;sig&gt;&nbsp;&lt;pubkey&gt;&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG script&nbsp;&nbsp;语言是一种类似Forth的基于堆栈的语言，它是故意设计成与状态无关且是”图灵不完备”(Turing&nbsp;complete&nbsp;图灵完备)的。与其它状态无关保证了只要交易一写入到区块链，就没有其它条件可以把使其永远不可以花费出去。”图灵不完备”可以使得script&nbsp;语言少了些灵活性，而且预测性更加地好，这极大简化了安全模块。 为了测试一个交易是否合法，一次只把一个scriptSig&nbsp;和&nbsp;script的参数推入到堆栈里面去,从bob的scriptSig&nbsp;开始，以Alice的&nbsp;script结束。下面的图展示了怎样检验一个标准的&nbsp;P2PKH&nbsp;script；图示下面是这个过程的描述。 &nbsp;&nbsp; ·&nbsp;signature&nbsp;(由BOB的scriptSig生成)被添加到一个空栈里面。因为只是一些数据，所以只是简单地把这些数据添加到栈，并没有做其它东西。公钥(同样也从scriptSig获得)被添加到signature的上面。 ·&nbsp;从ALICE的script里面，操作&nbsp;OP_DUP被添加到堆栈。&nbsp;OP_DUP用下一层的数据把自己替换掉，这样就把BOB提供的公钥复制了一次。 ·&nbsp;接着继续操作一下个，OP_HASH160,用下一层的数据（也就是BOB的公钥）把自己替换掉。这样就创建了BOB公钥的哈希值。 ·&nbsp;接着Alice的&nbsp;script&nbsp;把从她和BOB的第一笔交易得到的公钥哈希添加到堆栈里面。这样，堆栈顶部就有两份BOB的公钥哈希了。 现在事情变得有趣起来：Alice’的script把OP_EQUALVERIFY&nbsp;添加到堆栈里面，OP_EQUALVERIFY&nbsp;可以展开为&nbsp;OP_EQUAL&nbsp;和&nbsp;OP_VERIFY（隐性地）。 OP_EQUAL&nbsp;(隐性地)检查它下面的两个值；在这个例子里，它会检查BOB提供的完整公钥生成的公钥哈希是否和ALICE创建的交易#1相等。OP_EQUAL&nbsp;接着比较的结果:0(false)或者1(true)替换掉。 OP_VERIFY&nbsp;(隐性地)马上检查它下面的值。如果值为false，则马上停止堆栈内的检查，宣告交易检验失败。否则，它会把自己以及true值抛出栈外。 ·&nbsp;最后，ALICE的&nbsp;&nbsp;script&nbsp;把&nbsp;OP_CHECKSIG压入堆栈，用以对BOB提供的signature&nbsp;和BOB提供的当前经过验证的公钥进行校验。如果signature&nbsp;符合公钥，OP_CHECKSIG会被&nbsp;替换成true； &nbsp; P2SH脚本 输出脚本由支付者创建，他们（钱花出去之后）不怎么关心他们消费的比特聪的长期安全或者对别人是否有用。收款人则关心输出脚本指定的条件。如果收款人愿意，他们可以请求支付者使用某种特定脚本。遗憾的是，定制的脚本没有短小的比特币地址方便，也不像P2PKH的公钥哈希方案(&nbsp;P2PKHpubkey&nbsp;hashes)那样容易保护。 为了解决这些问题，“支付到脚本哈希”（P2SH）交易在2012年被创建，它让支付者创建一个输出脚本，里边包含另一个脚本的哈希，另一个脚本称为“认领脚本”。 下图是基本的P2SH流程图，它看起来几乎与P2PKH流程一模一样。Bob随心所欲创建一个认领脚本，计算它的哈希，并把这个哈希值发给Alice。Alice创建一个P2SH风格的输出，其中包含Bob的认领脚本的哈希值。 &nbsp;&nbsp; 当Bob想花费这个输出时，他把他的签名和完整的（序列化的）认领脚本放在输入的scriptSig域。比特币网络会确认，认领脚本被哈希后，得到的值与Alice输出里放的脚本哈希相同。然后网络会像处理原生脚本（即由Alice提供的脚本）那样，处理认领脚本，如果返回值为真，则允许Bob花费这个输出。 认领脚本的哈希和公钥哈希有相同的属性（主要指长度和范围），所以它可以被转换为标准的比特币地址格式，除了加上一点点小的变化，把它和标准地址区分开。这让接收P2SH风格的地址就像接收P2PKH风格的地址一样简单。哈希过程也混淆了认领脚本里的所有公钥，这使得P2SH脚本和P2PKH公钥哈希一样安全。 标准交易 必须小心避免非标准的输出脚本。按照比特币核心版本0.9，标准的脚本类型包括： 公钥哈希(P2PKH) P2PKH是最常见的脚本形式，用于把交易发至一个或多个比特币地址。 script:&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&lt;PubKeyHash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG 脚本哈希(P2SH) P2SH用于把交易发至一个脚本哈希。每一种标准脚本都可以用在P2SH认领脚本里。但实践中，只有多重签名(multisig)脚本是有意义的，除非以后有更多的交易类型变成标准的。 阅读更多" />
<meta property="og:description" content="转自:http://8btc.com/article-1759-1.html 交易Transactions &nbsp;“交易”是用户使用比特币的过程。每个交易由几个部分构成，一个交易即可以是简单的直接支付，也可以是复杂的交易。本小节会描述交易的每一个部门，而且说明怎样把各个部分合起来构建成一个完整的交易。 为了简单起便，本小节假设&nbsp;coinbase&nbsp;transactions&nbsp;不存在。&nbsp;coinbase&nbsp;transactions只能被矿机创建并且这些交易是下面很多规则的例外。与其一一指出&nbsp;coinbase&nbsp;transactions交易的例外，我们更加建议读者阅读本指南”区块链”一章里面关于&nbsp;coinbase&nbsp;transactions的内容。 &nbsp;&nbsp; 上面的图标说明了比特币交易的核心部分。每个交易至少由一个input和一个output。每个input&nbsp;使用上一个oupt的比特币作为输入。每个output作为未花费的output【Unspent&nbsp;Transaction&nbsp;Output&nbsp;(UTXO)】等待着，直到一个最近的inptut使用这个output。当你的比特币钱包告诉你余额有10BTC时，它真正的意思是说你有10BTC在一个或者多少UTXOs等待被花费出去。 每个交易的前缀由四个字节的“交易版本序号”组成，这可以让比特币节点和矿工知道本交易适用于哪些规则。这也方便开发者未来开发出的新规则和旧规则能相兼容。 下面的图帮助你了解交易的一些特点，图示的工作流是ALICE发送了一个交易给BOB，稍后BOB又把这个交易发送出去。ALICE和BOB使用的都是最常见的标准交易类型，Pay-To-Public-Key-Hash&nbsp;(P2PKH)。P2PKH&nbsp;&nbsp;让ALICE可以把比特币发送到一个典型的比特币地址上，然后又让BOB可以进一步通过简单的密钥对把比特币发送出去。 &nbsp;&nbsp; 在ALICE创建第一笔交易前，Bob必须先生成公钥/私钥对。标准的比特币私钥是长度为256b的随机字符串。一份私钥的数据，最后会经过变成而成“公钥”。因为那个变形可以在稍后重复进行，所以公钥并不需要保存。 接着公钥将加密并未得哈希值。公钥的哈希值同样也可以再次求出来，所以也不需要保存。哈希值比较短，而且也经过混淆，使得手工抄写比较简单，而且也提供了对抗未知问题的安全性，这些未知问题如允许在往后的日子里面通过公钥重新构造成私钥。 BOB把公钥的哈希值提供给ALICE。公钥哈希就是大家所熟知的编码过的比特币地址，编码采用的base58进行，里面包含了一个版本序号、哈希值以及一个用来校验错误的值。比特币地址可能通过任何介质传播，当然也包括单向的介质，这样可以切断发款人和收款人的联系，比特币地址还可以被进一步编码成其它的格式，比如包括”bitcoion：”的二维码地址。 只要ALICE拿到地址，而且解码还原为原来的标准哈希值，她就可以创建第一笔交易了。她创建了一个标准的P2PKH交易输出，里面包括了可以让任何人花费这笔输出的“说明”，只这他能证明他拥有与BOB的公钥对应的私钥。那些说明，称为“script”。 ALICE广播那一笔交易并且把它添加到区块链。比特币网络会收集这一笔交易，并把它作为未花费的交易【Unspent&nbsp;Transaction&nbsp;Output&nbsp;(UTXO),】，并在bob的钱包软件显示为可以使用的余额。 未来，如果bob决定把那个UTXO用出去，他必须创建一个引用了ALICE创建的交易的哈希值（这个哈希值被称为交易标识（txid）），而且还要引用ALICE使用过的那一笔的输出索引。BOB必须创建一个“scriptSig”，&nbsp;scriptSig是指一个包括满足ALICE之前那笔交易设置的条件的数据集合。 &nbsp;&nbsp; Bob并不需要和ALICE进行沟通，BOB只要简单地在比特币点对点网络上证明，他可以满足那些script指定的条件就可恼。对于P2PKH类型的输出，BOB的scriptSig只需要包含下面两个条件即可： 1.&nbsp;他提供的完整公钥（未经过哈希运算），以便于script&nbsp;可以通过重新求得哈希值来验 &nbsp;证ALICE提供的哈希值是否一致。 2.&nbsp;一个用bob提供私钥采用ECDSA&nbsp;加密算法计算出的包含确定的交易数据的签名。这个签名用来验证BOB是否拥有那个生成公钥的私钥。 Bob的签名不仅仅是证明BOB拥有他的私钥，签名同时还保证了BOB的签名不被篡改，这样就可以在比特币P2P网络安全地进行广播。 &nbsp; 如上图所示，bob的签名包括了txid和前一个交易的输出索引、前一个交易的script、bob创建的可以让下一个接收者花费它这个output的script、总共要转给下一具接者的比特币数量。本质上来说，整个交易都被签名除了scriptSigs，因为scriptSigs持有了公钥以及相关的signatures。 把他的signature&nbsp;和公钥放到scriptSig后，BOB通过P2P网络广播这一笔交易给比特币矿机。在进一步广播以及被包含进区块链之前，每一个节点和矿机都独立地验证这一笔交易。 P2PKH&nbsp;Script&nbsp;Validation 验证的过程需要重新评估script。在一个P2PKH类型的output里面，script&nbsp;如下： OP_DUP&nbsp;OP_HASH160&nbsp;&lt;pubkeyhash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG&lt;/pubkeyhash&gt; 发送者的scriptSig&nbsp;是经过验证的，而且也是script的开头部分。在一个标准的P2PKH&nbsp;交易中，scriptSig&nbsp;包含了一个signature&nbsp;以及一个完整公钥创建的字符串连接： &lt;sig&gt;&nbsp;&lt;pubkey&gt;&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG script&nbsp;&nbsp;语言是一种类似Forth的基于堆栈的语言，它是故意设计成与状态无关且是”图灵不完备”(Turing&nbsp;complete&nbsp;图灵完备)的。与其它状态无关保证了只要交易一写入到区块链，就没有其它条件可以把使其永远不可以花费出去。”图灵不完备”可以使得script&nbsp;语言少了些灵活性，而且预测性更加地好，这极大简化了安全模块。 为了测试一个交易是否合法，一次只把一个scriptSig&nbsp;和&nbsp;script的参数推入到堆栈里面去,从bob的scriptSig&nbsp;开始，以Alice的&nbsp;script结束。下面的图展示了怎样检验一个标准的&nbsp;P2PKH&nbsp;script；图示下面是这个过程的描述。 &nbsp;&nbsp; ·&nbsp;signature&nbsp;(由BOB的scriptSig生成)被添加到一个空栈里面。因为只是一些数据，所以只是简单地把这些数据添加到栈，并没有做其它东西。公钥(同样也从scriptSig获得)被添加到signature的上面。 ·&nbsp;从ALICE的script里面，操作&nbsp;OP_DUP被添加到堆栈。&nbsp;OP_DUP用下一层的数据把自己替换掉，这样就把BOB提供的公钥复制了一次。 ·&nbsp;接着继续操作一下个，OP_HASH160,用下一层的数据（也就是BOB的公钥）把自己替换掉。这样就创建了BOB公钥的哈希值。 ·&nbsp;接着Alice的&nbsp;script&nbsp;把从她和BOB的第一笔交易得到的公钥哈希添加到堆栈里面。这样，堆栈顶部就有两份BOB的公钥哈希了。 现在事情变得有趣起来：Alice’的script把OP_EQUALVERIFY&nbsp;添加到堆栈里面，OP_EQUALVERIFY&nbsp;可以展开为&nbsp;OP_EQUAL&nbsp;和&nbsp;OP_VERIFY（隐性地）。 OP_EQUAL&nbsp;(隐性地)检查它下面的两个值；在这个例子里，它会检查BOB提供的完整公钥生成的公钥哈希是否和ALICE创建的交易#1相等。OP_EQUAL&nbsp;接着比较的结果:0(false)或者1(true)替换掉。 OP_VERIFY&nbsp;(隐性地)马上检查它下面的值。如果值为false，则马上停止堆栈内的检查，宣告交易检验失败。否则，它会把自己以及true值抛出栈外。 ·&nbsp;最后，ALICE的&nbsp;&nbsp;script&nbsp;把&nbsp;OP_CHECKSIG压入堆栈，用以对BOB提供的signature&nbsp;和BOB提供的当前经过验证的公钥进行校验。如果signature&nbsp;符合公钥，OP_CHECKSIG会被&nbsp;替换成true； &nbsp; P2SH脚本 输出脚本由支付者创建，他们（钱花出去之后）不怎么关心他们消费的比特聪的长期安全或者对别人是否有用。收款人则关心输出脚本指定的条件。如果收款人愿意，他们可以请求支付者使用某种特定脚本。遗憾的是，定制的脚本没有短小的比特币地址方便，也不像P2PKH的公钥哈希方案(&nbsp;P2PKHpubkey&nbsp;hashes)那样容易保护。 为了解决这些问题，“支付到脚本哈希”（P2SH）交易在2012年被创建，它让支付者创建一个输出脚本，里边包含另一个脚本的哈希，另一个脚本称为“认领脚本”。 下图是基本的P2SH流程图，它看起来几乎与P2PKH流程一模一样。Bob随心所欲创建一个认领脚本，计算它的哈希，并把这个哈希值发给Alice。Alice创建一个P2SH风格的输出，其中包含Bob的认领脚本的哈希值。 &nbsp;&nbsp; 当Bob想花费这个输出时，他把他的签名和完整的（序列化的）认领脚本放在输入的scriptSig域。比特币网络会确认，认领脚本被哈希后，得到的值与Alice输出里放的脚本哈希相同。然后网络会像处理原生脚本（即由Alice提供的脚本）那样，处理认领脚本，如果返回值为真，则允许Bob花费这个输出。 认领脚本的哈希和公钥哈希有相同的属性（主要指长度和范围），所以它可以被转换为标准的比特币地址格式，除了加上一点点小的变化，把它和标准地址区分开。这让接收P2SH风格的地址就像接收P2PKH风格的地址一样简单。哈希过程也混淆了认领脚本里的所有公钥，这使得P2SH脚本和P2PKH公钥哈希一样安全。 标准交易 必须小心避免非标准的输出脚本。按照比特币核心版本0.9，标准的脚本类型包括： 公钥哈希(P2PKH) P2PKH是最常见的脚本形式，用于把交易发至一个或多个比特币地址。 script:&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&lt;PubKeyHash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG 脚本哈希(P2SH) P2SH用于把交易发至一个脚本哈希。每一种标准脚本都可以用在P2SH认领脚本里。但实践中，只有多重签名(multisig)脚本是有意义的，除非以后有更多的交易类型变成标准的。 阅读更多" />
<link rel="canonical" href="https://mlh.app/2017/11/04/154e0a0364d8c630469ba5d6289e60da.html" />
<meta property="og:url" content="https://mlh.app/2017/11/04/154e0a0364d8c630469ba5d6289e60da.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-11-04T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"转自:http://8btc.com/article-1759-1.html 交易Transactions &nbsp;“交易”是用户使用比特币的过程。每个交易由几个部分构成，一个交易即可以是简单的直接支付，也可以是复杂的交易。本小节会描述交易的每一个部门，而且说明怎样把各个部分合起来构建成一个完整的交易。 为了简单起便，本小节假设&nbsp;coinbase&nbsp;transactions&nbsp;不存在。&nbsp;coinbase&nbsp;transactions只能被矿机创建并且这些交易是下面很多规则的例外。与其一一指出&nbsp;coinbase&nbsp;transactions交易的例外，我们更加建议读者阅读本指南”区块链”一章里面关于&nbsp;coinbase&nbsp;transactions的内容。 &nbsp;&nbsp; 上面的图标说明了比特币交易的核心部分。每个交易至少由一个input和一个output。每个input&nbsp;使用上一个oupt的比特币作为输入。每个output作为未花费的output【Unspent&nbsp;Transaction&nbsp;Output&nbsp;(UTXO)】等待着，直到一个最近的inptut使用这个output。当你的比特币钱包告诉你余额有10BTC时，它真正的意思是说你有10BTC在一个或者多少UTXOs等待被花费出去。 每个交易的前缀由四个字节的“交易版本序号”组成，这可以让比特币节点和矿工知道本交易适用于哪些规则。这也方便开发者未来开发出的新规则和旧规则能相兼容。 下面的图帮助你了解交易的一些特点，图示的工作流是ALICE发送了一个交易给BOB，稍后BOB又把这个交易发送出去。ALICE和BOB使用的都是最常见的标准交易类型，Pay-To-Public-Key-Hash&nbsp;(P2PKH)。P2PKH&nbsp;&nbsp;让ALICE可以把比特币发送到一个典型的比特币地址上，然后又让BOB可以进一步通过简单的密钥对把比特币发送出去。 &nbsp;&nbsp; 在ALICE创建第一笔交易前，Bob必须先生成公钥/私钥对。标准的比特币私钥是长度为256b的随机字符串。一份私钥的数据，最后会经过变成而成“公钥”。因为那个变形可以在稍后重复进行，所以公钥并不需要保存。 接着公钥将加密并未得哈希值。公钥的哈希值同样也可以再次求出来，所以也不需要保存。哈希值比较短，而且也经过混淆，使得手工抄写比较简单，而且也提供了对抗未知问题的安全性，这些未知问题如允许在往后的日子里面通过公钥重新构造成私钥。 BOB把公钥的哈希值提供给ALICE。公钥哈希就是大家所熟知的编码过的比特币地址，编码采用的base58进行，里面包含了一个版本序号、哈希值以及一个用来校验错误的值。比特币地址可能通过任何介质传播，当然也包括单向的介质，这样可以切断发款人和收款人的联系，比特币地址还可以被进一步编码成其它的格式，比如包括”bitcoion：”的二维码地址。 只要ALICE拿到地址，而且解码还原为原来的标准哈希值，她就可以创建第一笔交易了。她创建了一个标准的P2PKH交易输出，里面包括了可以让任何人花费这笔输出的“说明”，只这他能证明他拥有与BOB的公钥对应的私钥。那些说明，称为“script”。 ALICE广播那一笔交易并且把它添加到区块链。比特币网络会收集这一笔交易，并把它作为未花费的交易【Unspent&nbsp;Transaction&nbsp;Output&nbsp;(UTXO),】，并在bob的钱包软件显示为可以使用的余额。 未来，如果bob决定把那个UTXO用出去，他必须创建一个引用了ALICE创建的交易的哈希值（这个哈希值被称为交易标识（txid）），而且还要引用ALICE使用过的那一笔的输出索引。BOB必须创建一个“scriptSig”，&nbsp;scriptSig是指一个包括满足ALICE之前那笔交易设置的条件的数据集合。 &nbsp;&nbsp; Bob并不需要和ALICE进行沟通，BOB只要简单地在比特币点对点网络上证明，他可以满足那些script指定的条件就可恼。对于P2PKH类型的输出，BOB的scriptSig只需要包含下面两个条件即可： 1.&nbsp;他提供的完整公钥（未经过哈希运算），以便于script&nbsp;可以通过重新求得哈希值来验 &nbsp;证ALICE提供的哈希值是否一致。 2.&nbsp;一个用bob提供私钥采用ECDSA&nbsp;加密算法计算出的包含确定的交易数据的签名。这个签名用来验证BOB是否拥有那个生成公钥的私钥。 Bob的签名不仅仅是证明BOB拥有他的私钥，签名同时还保证了BOB的签名不被篡改，这样就可以在比特币P2P网络安全地进行广播。 &nbsp; 如上图所示，bob的签名包括了txid和前一个交易的输出索引、前一个交易的script、bob创建的可以让下一个接收者花费它这个output的script、总共要转给下一具接者的比特币数量。本质上来说，整个交易都被签名除了scriptSigs，因为scriptSigs持有了公钥以及相关的signatures。 把他的signature&nbsp;和公钥放到scriptSig后，BOB通过P2P网络广播这一笔交易给比特币矿机。在进一步广播以及被包含进区块链之前，每一个节点和矿机都独立地验证这一笔交易。 P2PKH&nbsp;Script&nbsp;Validation 验证的过程需要重新评估script。在一个P2PKH类型的output里面，script&nbsp;如下： OP_DUP&nbsp;OP_HASH160&nbsp;&lt;pubkeyhash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG&lt;/pubkeyhash&gt; 发送者的scriptSig&nbsp;是经过验证的，而且也是script的开头部分。在一个标准的P2PKH&nbsp;交易中，scriptSig&nbsp;包含了一个signature&nbsp;以及一个完整公钥创建的字符串连接： &lt;sig&gt;&nbsp;&lt;pubkey&gt;&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG script&nbsp;&nbsp;语言是一种类似Forth的基于堆栈的语言，它是故意设计成与状态无关且是”图灵不完备”(Turing&nbsp;complete&nbsp;图灵完备)的。与其它状态无关保证了只要交易一写入到区块链，就没有其它条件可以把使其永远不可以花费出去。”图灵不完备”可以使得script&nbsp;语言少了些灵活性，而且预测性更加地好，这极大简化了安全模块。 为了测试一个交易是否合法，一次只把一个scriptSig&nbsp;和&nbsp;script的参数推入到堆栈里面去,从bob的scriptSig&nbsp;开始，以Alice的&nbsp;script结束。下面的图展示了怎样检验一个标准的&nbsp;P2PKH&nbsp;script；图示下面是这个过程的描述。 &nbsp;&nbsp; ·&nbsp;signature&nbsp;(由BOB的scriptSig生成)被添加到一个空栈里面。因为只是一些数据，所以只是简单地把这些数据添加到栈，并没有做其它东西。公钥(同样也从scriptSig获得)被添加到signature的上面。 ·&nbsp;从ALICE的script里面，操作&nbsp;OP_DUP被添加到堆栈。&nbsp;OP_DUP用下一层的数据把自己替换掉，这样就把BOB提供的公钥复制了一次。 ·&nbsp;接着继续操作一下个，OP_HASH160,用下一层的数据（也就是BOB的公钥）把自己替换掉。这样就创建了BOB公钥的哈希值。 ·&nbsp;接着Alice的&nbsp;script&nbsp;把从她和BOB的第一笔交易得到的公钥哈希添加到堆栈里面。这样，堆栈顶部就有两份BOB的公钥哈希了。 现在事情变得有趣起来：Alice’的script把OP_EQUALVERIFY&nbsp;添加到堆栈里面，OP_EQUALVERIFY&nbsp;可以展开为&nbsp;OP_EQUAL&nbsp;和&nbsp;OP_VERIFY（隐性地）。 OP_EQUAL&nbsp;(隐性地)检查它下面的两个值；在这个例子里，它会检查BOB提供的完整公钥生成的公钥哈希是否和ALICE创建的交易#1相等。OP_EQUAL&nbsp;接着比较的结果:0(false)或者1(true)替换掉。 OP_VERIFY&nbsp;(隐性地)马上检查它下面的值。如果值为false，则马上停止堆栈内的检查，宣告交易检验失败。否则，它会把自己以及true值抛出栈外。 ·&nbsp;最后，ALICE的&nbsp;&nbsp;script&nbsp;把&nbsp;OP_CHECKSIG压入堆栈，用以对BOB提供的signature&nbsp;和BOB提供的当前经过验证的公钥进行校验。如果signature&nbsp;符合公钥，OP_CHECKSIG会被&nbsp;替换成true； &nbsp; P2SH脚本 输出脚本由支付者创建，他们（钱花出去之后）不怎么关心他们消费的比特聪的长期安全或者对别人是否有用。收款人则关心输出脚本指定的条件。如果收款人愿意，他们可以请求支付者使用某种特定脚本。遗憾的是，定制的脚本没有短小的比特币地址方便，也不像P2PKH的公钥哈希方案(&nbsp;P2PKHpubkey&nbsp;hashes)那样容易保护。 为了解决这些问题，“支付到脚本哈希”（P2SH）交易在2012年被创建，它让支付者创建一个输出脚本，里边包含另一个脚本的哈希，另一个脚本称为“认领脚本”。 下图是基本的P2SH流程图，它看起来几乎与P2PKH流程一模一样。Bob随心所欲创建一个认领脚本，计算它的哈希，并把这个哈希值发给Alice。Alice创建一个P2SH风格的输出，其中包含Bob的认领脚本的哈希值。 &nbsp;&nbsp; 当Bob想花费这个输出时，他把他的签名和完整的（序列化的）认领脚本放在输入的scriptSig域。比特币网络会确认，认领脚本被哈希后，得到的值与Alice输出里放的脚本哈希相同。然后网络会像处理原生脚本（即由Alice提供的脚本）那样，处理认领脚本，如果返回值为真，则允许Bob花费这个输出。 认领脚本的哈希和公钥哈希有相同的属性（主要指长度和范围），所以它可以被转换为标准的比特币地址格式，除了加上一点点小的变化，把它和标准地址区分开。这让接收P2SH风格的地址就像接收P2PKH风格的地址一样简单。哈希过程也混淆了认领脚本里的所有公钥，这使得P2SH脚本和P2PKH公钥哈希一样安全。 标准交易 必须小心避免非标准的输出脚本。按照比特币核心版本0.9，标准的脚本类型包括： 公钥哈希(P2PKH) P2PKH是最常见的脚本形式，用于把交易发至一个或多个比特币地址。 script:&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&lt;PubKeyHash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG 脚本哈希(P2SH) P2SH用于把交易发至一个脚本哈希。每一种标准脚本都可以用在P2SH认领脚本里。但实践中，只有多重签名(multisig)脚本是有意义的，除非以后有更多的交易类型变成标准的。 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2017/11/04/154e0a0364d8c630469ba5d6289e60da.html","headline":"比特币开发指南 - 交易Transactions（转）","dateModified":"2017-11-04T00:00:00+08:00","datePublished":"2017-11-04T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2017/11/04/154e0a0364d8c630469ba5d6289e60da.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>比特币开发指南 - 交易Transactions（转）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <div class="bct fc05 fc11 nbw-blog ztag">
   <h1 style="color:rgb(74,74,74);font-family:'Microsoft Yahei', SimSun, sans-serif;"><span style="font-family:'宋体';font-weight:normal;"><font size="3">转自:</font></span><a style="font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, '宋体';font-size:16px;font-weight:normal;" href="http://8btc.com/article-1759-1.html" rel="nofollow">http://8btc.com/article-1759-1.html</a></h1>
   <h1 style="font-size:1em;color:rgb(74,74,74);font-family:'Microsoft Yahei', SimSun, sans-serif;"><span style="font-size:24pt;font-family:'宋体';">交易Transactions</span><span style="font-size:24pt;font-family:'宋体';"></span></h1>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">&nbsp;“交易”是用户使用比特币的过程。每个交易由几个部分构成，一个交易即可以是简单的直接支付，也可以是复杂的交易。本小节会描述交易的每一个部门，而且说明怎样把各个部分合起来构建成一个完整的交易。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">为了简单起便，本小节假设</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="A special transaction which miners must create when they generate a block" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-coinbase-tx" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">coinbase&nbsp;transactions</span></a><span style="font-size:10.5pt;font-family:Calibri;">&nbsp;不存在。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="A special transaction which miners must create when they generate a block" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-coinbase-tx" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">coinbase&nbsp;transactions</span></a><span style="font-size:10.5pt;font-family:Calibri;">只能被矿机创建并且这些交易是下面很多规则的例外。与其一一指出</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="A special transaction which miners must create when they generate a block" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-coinbase-tx" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">coinbase&nbsp;transactions</span></a><span style="font-size:10.5pt;font-family:Calibri;">交易的例外，我们更加建议读者阅读本指南</span><span style="font-size:10.5pt;font-family:Calibri;">”</span><span style="font-size:10.5pt;font-family:Calibri;">区块链</span><span style="font-size:10.5pt;font-family:Calibri;">”</span><span style="font-size:10.5pt;font-family:Calibri;">一章里面关于</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="A special transaction which miners must create when they generate a block" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-coinbase-tx" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">coinbase&nbsp;transactions</span></a><span style="font-size:10.5pt;font-family:Calibri;">的内容。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <div>
    <img title="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" alt="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" src="http://img0.ph.126.net/lqb1YQGRkYDIY9p1p83f8w==/646829496499207737.png">
   </div>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"><span style="font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, '宋体';">&nbsp;</span>&nbsp;</span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">上面的图标说明了比特币交易的核心部分。每个交易至少由一个<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">input</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">和一个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">output</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">。每个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">input&nbsp;</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">使用上一个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">oupt</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的比特币作为输入。每个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">output</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">作为未花费的</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">output</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">【</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Unspent&nbsp;Transaction&nbsp;</span><a title="The output of a transaction which transfers value to a script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-output" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Output</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;(</span><a title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-utxo" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">UTXO</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">)</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">】等待着，直到一个最近的<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">inptut</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">使用这个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">output</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">。当你的比特币钱包告诉你余额有</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">10BTC</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">时，它真正的意思是说你有</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">10BTC</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">在一个或者多少</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">UTXOs</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">等待被花费出去。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'宋体';">每个交易的前缀由四个字节的“交易版本序号”组成，这可以让比特币节点和矿工知道本交易适用于哪些规则。这也方便开发者未来开发出的新规则和旧规则能相兼容。</span><span style="font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">下面的图帮助你了解交易的一些特点，图示的工作流是<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">发送了一个交易给</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">，稍后</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">又把这个交易发送出去。</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">和</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">使用的都是最常见的标准交易类型，</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Pay-To-Public-Key-Hash&nbsp;(</span><a title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-p2pkh" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">P2PKH</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">)</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">。</span><a title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-p2pkh" rel="nofollow"><span style="color:rgb(0,0,0);font-size:12pt;font-family:Helvetica;">P2PKH</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">&nbsp;让<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">可以把比特币发送到一个典型的比特币地址上，然后又让</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">可以进一步通过简单的密钥对把比特币发送出去。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <div>
    <img title="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" alt="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" src="http://img0.ph.126.net/QC0pvpkx82fknmf9Tvz4Tw==/6630240932956515732.png">
   </div>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"><span style="font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, '宋体';">&nbsp;</span>&nbsp;</span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">在<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">创建第一笔交易前，</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Bob</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">必须先生成公钥</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">/</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">私钥对。标准的比特币私钥是长度为</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">256b</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的随机字符串。一份私钥的数据，最后会经过变成而成“公钥”。因为那个变形可以在稍后重复进行，所以公钥并不需要保存。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">接着公钥将加密并未得哈希值。公钥的哈希值同样也可以再次求出来，所以也不需要保存。哈希值比较短，而且也经过混淆，使得手工抄写比较简单，而且也提供了对抗未知问题的安全性，这些未知问题如允许在往后的日子里面通过公钥重新构造成私钥。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">BOB<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">把公钥的哈希值提供给</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">。公钥哈希就是大家所熟知的编码过的比特币地址，编码采用的</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">base58</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">进行，里面包含了一个版本序号、哈希值以及一个用来校验错误的值。比特币地址可能通过任何介质传播，当然也包括单向的介质，这样可以切断发款人和收款人的联系，比特币地址还可以被进一步编码成其它的格式，比如包括</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">”</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">bitcoion<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">：</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">”</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">的二维码地址。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">只要<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">拿到地址，而且解码还原为原来的标准哈希值，她就可以创建第一笔交易了。她创建了一个标准的</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2PKH</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">交易输出，里面包括了可以让任何人花费这笔输出的“说明”，只这他能证明他拥有与</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的公钥对应的私钥。那些说明，称为“</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">script</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">”。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">ALICE<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">广播那一笔交易并且把它添加到区块链。比特币网络会收集这一笔交易，并把它作为未花费的交易【</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Unspent&nbsp;Transaction&nbsp;</span><a title="The output of a transaction which transfers value to a script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-output" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Output</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;(</span><a title="Unspent Transaction Output (UTXO) holding satoshis which have not yet been spent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-utxo" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">UTXO</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">),</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">】，并在<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">bob</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的钱包软件显示为可以使用的余额。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">未来，如果<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">bob</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">决定把那个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">UTXO</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">用出去，他必须创建一个引用了</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">创建的交易的哈希值（这个哈希值被称为交易标识（</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">txid</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">）），而且还要引用</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">使用过的那一笔的输出索引。</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">必须创建一个“</font></span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">”，</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">是指一个包括满足<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">之前那笔交易设置的条件的数据集合。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <div>
    <img title="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" alt="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" src="http://img1.ph.126.net/rRtp6SSzuMO_zk7jv6NuZg==/6608532175376701237.png">
   </div>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"><span style="font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, '宋体';">&nbsp;</span>&nbsp;</span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">B</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">ob<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">并不需要和</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">进行沟通，</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">只要简单地在比特币点对点网络上证明，他可以满足那些</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">script</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">指定的条件就可恼。对于</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2PKH</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">类型的输出，</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的</font></span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">只需要包含下面两个条件即可：</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="margin-left:21pt;color:rgb(74,74,74);text-indent:-21pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">1.&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">他提供的完整公钥（未经过哈希运算），以便于</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">可以通过重新求得哈希值来验</span><span style="color:rgb(100,100,100);font-family:'宋体';font-size:12pt;line-height:18pt;text-indent:-21pt;"></span><img title="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" alt="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" src="http://img1.ph.126.net/cujW224NVpAvk8XhKgOKyA==/6630582881073468403.png" style="font-family:'hiragino sans gb w3', 'hiragino sans gb', arial, helvetica, simsun, '宋体';"></p>
   <p style="margin-left:21pt;color:rgb(74,74,74);text-indent:-21pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-family:'宋体';font-size:12pt;line-height:18pt;text-indent:-21pt;">&nbsp;证</span><font style="color:rgb(100,100,100);font-size:12pt;line-height:18pt;text-indent:-21pt;">ALICE</font><font style="color:rgb(100,100,100);font-size:12pt;line-height:18pt;text-indent:-21pt;">提供的哈希值是否一致。</font></p>
   <p style="margin-left:21pt;color:rgb(74,74,74);text-indent:-21pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">2.&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">一个用<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">bob</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">提供私钥采用</font></span><a style="color:rgb(102,102,102);text-decoration:none;" href="https://en.wikipedia.org/wiki/Elliptic_Curve_DSA" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">ECDSA</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">加密算法计算出的包含确定的交易数据的签名。这个签名用来验证<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">是否拥有那个生成公钥的私钥。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">B</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">ob<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的签名不仅仅是证明</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">拥有他的私钥，签名同时还保证了</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的签名不被篡改，这样就可以在比特币</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2P</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">网络安全地进行广播。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">如上图所示，<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">bob</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的签名包括了</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">txid</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">和前一个交易的输出索引、前一个交易的</font></span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">、</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">bob<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">创建的可以让下一个接收者花费它这个</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">output</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的</font></span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">、总共要转给下一具接者的比特币数量。本质上来说，整个交易都被签名除了</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSigs</span></a><span style="font-size:10.5pt;font-family:Calibri;">，因为</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSigs</span></a><span style="font-size:10.5pt;font-family:Calibri;">持有了公钥以及相关的</span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signatures</span></a><span style="font-size:10.5pt;font-family:Calibri;">。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">把他的</span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signature</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">和公钥放到</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="font-size:10.5pt;font-family:Calibri;">后，BOB通过P2P网络广播这一笔交易给比特币矿机。在进一步广播以及被包含进区块链之前，每一个节点和矿机都独立地验证这一笔交易。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <h2 style="font-size:1em;color:rgb(74,74,74);font-family:'Microsoft Yahei', SimSun, sans-serif;"><a style="color:rgb(102,102,102);" name="_Toc389387663"></a><span style="font-size:18pt;font-family:'宋体';">P2PKH&nbsp;Script&nbsp;Validation</span><span style="font-size:18pt;font-family:'宋体';"></span></h2>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">验证的过程需要重新评估</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">。在一个P2PKH类型的output里面，</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">&nbsp;如下：</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);border:.75pt solid rgb(204,204,204);line-height:18pt;background-color:rgb(245,245,245);font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:9pt;font-family:'Courier New';">OP_DUP&nbsp;OP_HASH160&nbsp;&lt;pubkeyhash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG&lt;/pubkeyhash&gt;</span><span style="color:rgb(100,100,100);font-size:9pt;font-family:'Courier New';"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">发送者的</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">是经过验证的，而且也是</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">的开头部分。在一个标准的</span><a title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-p2pkh" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">P2PKH</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">交易中，</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">包含了一个</span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signature</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">以及一个完整公钥创建的字符串连接：</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);border:.75pt solid rgb(204,204,204);line-height:18pt;background-color:rgb(245,245,245);font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:9pt;font-family:'Courier New';">&lt;sig&gt;&nbsp;&lt;pubkey&gt;&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG</span><span style="color:rgb(100,100,100);font-size:9pt;font-family:'Courier New';"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">&nbsp;语言是一种类似<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Forth</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的基于堆栈的语言，它是故意设计成与状态无关且是</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">”</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">图灵不完备</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">”</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">(Turing&nbsp;complete&nbsp;<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">图灵完备</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">)</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的。与其它状态无关保证了只要交易一写入到区块链，就没有其它条件可以把使其永远不可以花费出去。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">”</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">图灵不完备</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">”</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">可以使得</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">语言少了些灵活性，而且预测性更加地好，这极大简化了安全模块。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">为了测试一个交易是否合法，一次只把一个</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">和&nbsp;</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">的参数推入到堆栈里面去,从bob的</span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">开始，以</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Alice</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">的</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">结束。下面的图展示了怎样检验一个标准的</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-p2pkh" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">P2PKH</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">；图示下面是这个过程的描述。</span><span style="font-size:10.5pt;font-family:Calibri;"></span></p>
   <div>
    <img title="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" alt="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" src="http://img0.ph.126.net/BCfJ4jvVGxDRjvVE9LlRog==/6619187542561697409.png">
   </div>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"><span style="font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, '宋体';">&nbsp;</span>&nbsp;</span></p>
   <p style="color:rgb(74,74,74);text-indent:-18pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:10pt;font-family:Symbol;">·&nbsp;</span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signature</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">(<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">由</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的</font></span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="font-size:10.5pt;font-family:Calibri;">生成</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">)<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">被添加到一个空栈里面。因为只是一些数据，所以只是简单地把这些数据添加到栈，并没有做其它东西。公钥</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">(</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">同样也从</font></span><a title="Data generated by a spender which is almost always used as variables to satisfy an output script" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-scriptsig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">scriptSig</span></a><span style="font-size:10.5pt;font-family:Calibri;">获得</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">)<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">被添加到</font></span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signature</span></a><span style="font-size:10.5pt;font-family:Calibri;">的上面。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);text-indent:-18pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:10pt;font-family:Symbol;">·&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">从<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的</font></span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">里面，操作</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="Operation which duplicates the entry below it on the stack" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-dup" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_DUP</span></a><span style="font-size:10.5pt;font-family:Calibri;">被添加到堆栈。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="Operation which duplicates the entry below it on the stack" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-dup" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_DUP</span></a><span style="font-size:10.5pt;font-family:Calibri;">用下一层的数据把自己替换掉，这样就把BOB提供的公钥复制了一次。</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);text-indent:-18pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:10pt;font-family:Symbol;">·&nbsp;</span><span style="font-size:12pt;font-family:'宋体';">接着继续操作一下个，</span><a title="Operation which converts the entry below it on the stack into a RIPEMD(SHA256()) hashed version of itself" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-hash160" rel="nofollow"><span style="color:rgb(0,0,0);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_HASH160</span></a><span style="font-size:12pt;font-family:Helvetica;">,</span><span style="font-size:12pt;font-family:'宋体';">用下一层的数据（也就是<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的公钥）把自己替换掉。这样就创建了</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">公钥的哈希值。</font></span><span style="font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);text-indent:-18pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:10pt;font-family:Symbol;">·&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">接着</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Alice</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">的</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">把从她和<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的第一笔交易得到的公钥哈希添加到堆栈里面。这样，堆栈顶部就有两份</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的公钥哈希了。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">现在事情变得有趣起来：</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">Alice’</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">的</span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="font-size:10.5pt;font-family:Calibri;">把</span><a title="Operation which terminates the script in failure unless the two entries below it on the stack are equivalent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-equalverify" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_EQUALVERIFY</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">添加到堆栈里面，</span><a title="Operation which terminates the script in failure unless the two entries below it on the stack are equivalent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-equalverify" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_EQUALVERIFY</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">可以展开为</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="Operation which returns true if the two entries below it on the stack are equivalent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-equal" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_EQUAL</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">和</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="Operation which terminates the script if the entry below it on the stack is non-true (zero)" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-verify" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_VERIFY</span></a><span style="font-size:10.5pt;font-family:Calibri;">（隐性地）。</span><span style="font-size:10.5pt;font-family:Calibri;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><a title="Operation which returns true if the two entries below it on the stack are equivalent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-equal" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_EQUAL</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">(<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">隐性地</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">)</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">检查它下面的两个值；在这个例子里，它会检查</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">提供的完整公钥生成的公钥哈希是否和</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">创建的交易</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">#1</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">相等。</font></span><a title="Operation which returns true if the two entries below it on the stack are equivalent" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-equal" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_EQUAL</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">接着比较的结果<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">:0(false)</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">或者</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">1(true)</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">替换掉。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><a title="Operation which terminates the script if the entry below it on the stack is non-true (zero)" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-verify" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_VERIFY</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">(<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">隐性地</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">)</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">马上检查它下面的值。如果值为</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">false</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">，则马上停止堆栈内的检查，宣告交易检验失败。否则，它会把自己以及</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">true</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">值抛出栈外。</font></span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);text-indent:-18pt;line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:10pt;font-family:Symbol;">·&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">最后，<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">ALICE</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的&nbsp;&nbsp;</font></span><a title="The part of an output which sets the conditions for spending of the satoshis in that output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-script" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">script</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">把&nbsp;</span><a title="Op code which returns true if a signature signs the correct parts of a transaction and matches a provided public key" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-checksig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_CHECKSIG</span></a><span style="font-size:10.5pt;font-family:Calibri;">压入堆栈，用以对BOB提供的</span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signature</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">和<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">BOB</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">提供的当前经过验证的公钥进行校验。如果</font></span><a title="The result of combining a private key and some data in an ECDSA signature operation which allows anyone with the corresponding public key to verify the signature" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-signature" rel="nofollow"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">signature</span></a><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;">&nbsp;</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'宋体';">符合公钥，</span><a title="Op code which returns true if a signature signs the correct parts of a transaction and matches a provided public key" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-op-checksig" rel="nofollow"><span style="color:rgb(100,100,100);font-size:10.5pt;font-family:'Courier New';background-color:rgb(245,245,245);">OP_CHECKSIG</span></a><span style="font-size:10.5pt;font-family:Calibri;">会被&nbsp;替换成true；</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:10.5pt;font-family:Calibri;">&nbsp;</span></p>
   <h2 style="font-size:1em;color:rgb(74,74,74);font-family:'Microsoft Yahei', SimSun, sans-serif;"><span style="font-size:18pt;font-family:'宋体';">P2SH</span><span style="font-size:18pt;font-family:'宋体';">脚本</span><span style="font-size:18pt;font-family:'宋体';"></span></h2>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:Helvetica;">输出脚本由支付者创建，他们</span><span style="font-size:12pt;font-family:'宋体';">（</span><span style="font-size:12pt;font-family:Helvetica;">钱花出去之后）不怎么关心他们消费的比特聪</span><span style="font-size:12pt;font-family:'宋体';">的</span><span style="font-size:12pt;font-family:Helvetica;">长期安全或者</span><span style="font-size:12pt;font-family:'宋体';">对别人</span><span style="font-size:12pt;font-family:Helvetica;">是否有用。收款人</span><span style="font-size:12pt;font-family:'宋体';">则</span><span style="font-size:12pt;font-family:Helvetica;">关心输出脚本</span><span style="font-size:12pt;font-family:'宋体';">指定</span><span style="font-size:12pt;font-family:Helvetica;">的条件。如果</span><span style="font-size:12pt;font-family:'宋体';">收款人</span><span style="font-size:12pt;font-family:Helvetica;">愿意，他们可以请求支付者</span><span style="font-size:12pt;font-family:'宋体';">使用</span><span style="font-size:12pt;font-family:Helvetica;">某种特定脚本。</span><span style="font-size:12pt;font-family:'宋体';">遗憾的是</span><span style="font-size:12pt;font-family:Helvetica;">，定制的脚本没有短小的</span><span style="font-size:12pt;font-family:'宋体';">比特币</span><span style="font-size:12pt;font-family:Helvetica;">地址方便，也</span><span style="font-size:12pt;font-family:'宋体';">不像<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2PKH</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的</font></span><span style="font-size:12pt;font-family:Helvetica;">公钥哈希</span><span style="font-size:12pt;font-family:'宋体';">方案<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">(</font></span><span style="font-size:12pt;font-family:Helvetica;">&nbsp;</span><a title="A script which Pays To Pubkey Hashes (P2PKH), allowing spending of satoshis to anyone with a Bitcoin address" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-p2pkh" rel="nofollow"><span style="color:rgb(0,0,0);font-size:12pt;font-family:Helvetica;">P2PKH</span></a><a title="The hash of a public key which can be included in a P2PKH output" style="color:rgb(102,102,102);text-decoration:none;" href="http://8btc.com/article-1759-1.html#term-pubkey-hash" rel="nofollow"><span style="color:rgb(0,0,0);font-size:12pt;font-family:Helvetica;">pubkey&nbsp;hashes</span></a><span style="font-size:12pt;font-family:'宋体';">)<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">那样</font></span><span style="font-size:12pt;font-family:Helvetica;">容易保护。</span><span style="font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'宋体';">为了解决</span><span style="font-size:12pt;font-family:Helvetica;">这些问题，</span><span style="font-size:12pt;font-family:'宋体';">“</span><span style="font-size:12pt;font-family:Helvetica;">支付到</span><span style="font-size:12pt;font-family:'宋体';">脚本</span><span style="font-size:12pt;font-family:Helvetica;">哈希</span><span style="font-size:12pt;font-family:'宋体';">”（<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2</font></span><span style="font-size:12pt;font-family:Helvetica;">SH<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">）</font></span><span style="font-size:12pt;font-family:'宋体';">交易</span><span style="font-size:12pt;font-family:Helvetica;">在</span><span style="font-size:12pt;font-family:'宋体';">2012<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">年</font></span><span style="font-size:12pt;font-family:Helvetica;">被创建，它让支付者创建</span><span style="font-size:12pt;font-family:'宋体';">一个</span><span style="font-size:12pt;font-family:Helvetica;">输出脚本，里边包含另一个脚本的哈希，</span><span style="font-size:12pt;font-family:'宋体';">另一个</span><span style="font-size:12pt;font-family:Helvetica;">脚本</span><span style="font-size:12pt;font-family:'宋体';">称为“认领脚本”。</span><span style="font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'宋体';">下图</span><span style="font-size:12pt;font-family:Helvetica;">是基本的</span><span style="font-size:12pt;font-family:'宋体';">P2SH<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">流程图</font></span><span style="font-size:12pt;font-family:Helvetica;">，它看起来几乎与</span><span style="font-size:12pt;font-family:'宋体';">P2PKH<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">流程一模一样</font></span><span style="font-size:12pt;font-family:Helvetica;">。<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Bob</font></span><span style="font-size:12pt;font-family:'宋体';">随心所欲</span><span style="font-size:12pt;font-family:Helvetica;">创建一个认领脚本，</span><span style="font-size:12pt;font-family:'宋体';">计算</span><span style="font-size:12pt;font-family:Helvetica;">它的哈希，并把这个哈希</span><span style="font-size:12pt;font-family:'宋体';">值</span><span style="font-size:12pt;font-family:Helvetica;">发给<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Alice</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">。</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Alice</font></span><span style="font-size:12pt;font-family:'宋体';">创建</span><span style="font-size:12pt;font-family:Helvetica;">一个</span><span style="font-size:12pt;font-family:'宋体';">P2SH<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">风格</font></span><span style="font-size:12pt;font-family:Helvetica;">的输出，其中包含<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Bob</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">的认领脚本的哈希</font></span><span style="font-size:12pt;font-family:'宋体';">值</span><span style="font-size:12pt;font-family:Helvetica;">。</span><span style="font-size:12pt;font-family:Helvetica;"></span></p>
   <div>
    <img title="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" alt="比特币开发指南 - 交易Transactions（转） - ♂苹果 - 眼睛想旅行" src="http://img2.ph.126.net/PdMNYLxS76VzdLXY5nLX7w==/2782661619779659352.png">
   </div>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:Helvetica;"><span style="font-family:'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, '宋体';">&nbsp;</span>&nbsp;</span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'宋体';">当</span><span style="font-size:12pt;font-family:Helvetica;">Bob<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">想花费这个输出时，</font></span><span style="font-size:12pt;font-family:'宋体';">他</span><span style="font-size:12pt;font-family:Helvetica;">把他的签名和完整的（</span><span style="font-size:12pt;font-family:'宋体';">序列化</span><span style="font-size:12pt;font-family:Helvetica;">的</span><span style="font-size:12pt;font-family:'宋体';">）认领脚本</span><span style="font-size:12pt;font-family:Helvetica;">放在输入的<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">scriptSig</font></span><span style="font-size:12pt;font-family:'宋体';">域</span><span style="font-size:12pt;font-family:Helvetica;">。</span><span style="font-size:12pt;font-family:'宋体';">比特币</span><span style="font-size:12pt;font-family:Helvetica;">网络</span><span style="font-size:12pt;font-family:'宋体';">会确认，</span><span style="font-size:12pt;font-family:Helvetica;">认领脚本</span><span style="font-size:12pt;font-family:'宋体';">被</span><span style="font-size:12pt;font-family:Helvetica;">哈希</span><span style="font-size:12pt;font-family:'宋体';">后</span><span style="font-size:12pt;font-family:Helvetica;">，得到</span><span style="font-size:12pt;font-family:'宋体';">的</span><span style="font-size:12pt;font-family:Helvetica;">值</span><span style="font-size:12pt;font-family:'宋体';">与</span><span style="font-size:12pt;font-family:Helvetica;">Alice<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">输出里放的脚本哈希</font></span><span style="font-size:12pt;font-family:'宋体';">相同</span><span style="font-size:12pt;font-family:Helvetica;">。</span><span style="font-size:12pt;font-family:'宋体';">然后</span><span style="font-size:12pt;font-family:Helvetica;">网络会</span><span style="font-size:12pt;font-family:'宋体';">像</span><span style="font-size:12pt;font-family:Helvetica;">处理</span><span style="font-size:12pt;font-family:'宋体';">原生</span><span style="font-size:12pt;font-family:Helvetica;">脚本</span><span style="font-size:12pt;font-family:'宋体';">（</span><span style="font-size:12pt;font-family:Helvetica;">即由<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">Alice</font></span><span style="font-size:12pt;font-family:'宋体';">提供</span><span style="font-size:12pt;font-family:Helvetica;">的脚本）那样，处理认领脚本，如果返回值为真，则</span><span style="font-size:12pt;font-family:'宋体';">允许</span><span style="font-size:12pt;font-family:Helvetica;">Bob</span><span style="font-size:12pt;font-family:'宋体';">花费</span><span style="font-size:12pt;font-family:Helvetica;">这个输出。</span><span style="font-size:12pt;font-family:Helvetica;"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'宋体';">认领脚本</span><span style="font-size:12pt;font-family:Helvetica;">的哈希和</span><span style="font-size:12pt;font-family:'宋体';">公钥</span><span style="font-size:12pt;font-family:Helvetica;">哈希有相同的</span><span style="font-size:12pt;font-family:'宋体';">属性（主要</span><span style="font-size:12pt;font-family:Helvetica;">指</span><span style="font-size:12pt;font-family:'宋体';">长度</span><span style="font-size:12pt;font-family:Helvetica;">和范围），所以它可以被转换为标准的比特币地址格式，</span><span style="font-size:12pt;font-family:'宋体';">除了加上</span><span style="font-size:12pt;font-family:Helvetica;">一点点小的变化，</span><span style="font-size:12pt;font-family:'宋体';">把它</span><span style="font-size:12pt;font-family:Helvetica;">和</span><span style="font-size:12pt;font-family:'宋体';">标准</span><span style="font-size:12pt;font-family:Helvetica;">地址区分开。这让</span><span style="font-size:12pt;font-family:'宋体';">接收<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2SH</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">风格</font></span><span style="font-size:12pt;font-family:Helvetica;">的地址</span><span style="font-size:12pt;font-family:'宋体';">就像接收<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2PKH</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">风格的</font></span><span style="font-size:12pt;font-family:Helvetica;">地址一样简单。</span><span style="font-size:12pt;font-family:'宋体';">哈希</span><span style="font-size:12pt;font-family:Helvetica;">过程也</span><span style="font-size:12pt;font-family:'宋体';">混淆</span><span style="font-size:12pt;font-family:Helvetica;">了认领脚本里的</span><span style="font-size:12pt;font-family:'宋体';">所有</span><span style="font-size:12pt;font-family:Helvetica;">公钥，这</span><span style="font-size:12pt;font-family:'宋体';">使得<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">P2SH</font><font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">脚本</font></span><span style="font-size:12pt;font-family:Helvetica;">和</span><span style="font-size:12pt;font-family:'宋体';">P2PKH<font style="font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;">公钥</font></span><span style="font-size:12pt;font-family:Helvetica;">哈希一样安全。</span></p>
   <h2 style="font-size:1em;color:rgb(74,74,74);font-family:'Microsoft Yahei', SimSun, sans-serif;"><span style="font-size:18pt;font-family:'新宋体';">标准交易</span><span style="font-size:18pt;font-family:'新宋体';"></span></h2>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:12pt;font-family:'新宋体';">必须小心避免非标准的输出脚本。按照比特币核心版本0.9，标准的脚本类型包括：</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'新宋体';"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-weight:bold;font-size:12pt;font-family:'新宋体';">公钥哈希(P2PKH)</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'新宋体';"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'新宋体';">P2PKH是最常见的脚本形式，用于把交易发至一个或多个比特币地址。</span><span style="font-size:12pt;font-family:'新宋体';"></span></p>
   <p style="color:rgb(74,74,74);border:.75pt solid rgb(204,204,204);line-height:18pt;background-color:rgb(245,245,245);font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-size:9pt;font-family:'新宋体';">script:&nbsp;OP_DUP&nbsp;OP_HASH160&nbsp;&lt;PubKeyHash&gt;&nbsp;OP_EQUALVERIFY&nbsp;OP_CHECKSIG</span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="color:rgb(100,100,100);font-weight:bold;font-size:12pt;font-family:'新宋体';">脚本哈希(P2SH)</span><span style="color:rgb(100,100,100);font-size:12pt;font-family:'新宋体';"></span></p>
   <p style="color:rgb(74,74,74);line-height:18pt;font-family:'Microsoft YaHei', SimHei, Verdana, Arial, sans-serif !important;"><span style="font-size:12pt;font-family:'新宋体';">P2SH用于把交易发至一个脚本哈希。每一种标准脚本都可以用在P2SH认领脚本里。但实践中，只有多重签名(multisig)脚本是有意义的，除非以后有更多的交易类型变成标准的。</span></p>
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/fengmm521/article/details/78446407,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/fengmm521/article/details/78446407,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
