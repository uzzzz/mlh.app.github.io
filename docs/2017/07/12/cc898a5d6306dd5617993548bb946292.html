<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>【比特币】虚拟币教程自己动手编译比特币客户端 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="【比特币】虚拟币教程自己动手编译比特币客户端" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="本帖只谈技术实现，首先我们自己来编译一个比特币客户端吧， 技术讨论QQ群，306888500，欢迎大家入伙(注明：csdn)。 2014.7.18更新: 静态编译的第三方依赖和MINGW64工具链以及v0.9.1的官方源代码在github上： https://github.com/imharrywu/betcoin 本文遇到的问题大部分是使用动态库构建的时候遇到的，仅仅作为一个备份，大家可以直接迁出上面的代码或者直接跳到本文的最后看《自动脚本》 不带任何qt-style风格的qt界面库构建出来的比特币satoshi客户端 ======================================================================================================================= 先看一下最后编出来的带qt前端的客户端版本截图，会有测试版本提示 (使用tag的源代码编译正式版本) (建议：备份您之前安装的%APPDATA%bitcoin目录)。 参考github上的描述文件 https://github.com/bitcoin/bitcoin/blob/master/doc/build-msw.md 1) 签出代码 GitHub上的官方源代码 git clonehttps://github.com/bitcoin/bitcoin.git[/code]&nbsp; 也可以从csdn的code上签出本文的整个项目组 git clone git://code.csdn.net/wuzh1230/bitcoin.git 提示： &lt;1&gt;已经包含了预编译的依赖库在3rd目录下； &lt;2&gt;已经包含了ming32工具链，请修改msys/1.0/etc/fstab。 &lt;3&gt;文章遇到的问题大多是使用动态库构造的时候遇到的，建议大家用--enable-static构造所有的依赖，直接跳到最后一节《自动脚本》。 2) 下载依赖包 Libraries you need to download separately and build: name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default path &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; download ---------------------------------------------------- OpenSSL &nbsp; &nbsp; &nbsp; &nbsp; \openssl-1.0.1c-mgw &nbsp; &nbsp; &nbsp; http://www.openssl.org/source/ Berkeley DB &nbsp; &nbsp; \db-4.8.30.NC-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.oracle.com/technology/software/products/berkeley-db/index.html Boost &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \boost-1.50.0-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.boost.org/users/download/ miniupnpc &nbsp; &nbsp; &nbsp; \miniupnpc-1.6-mgw &nbsp; &nbsp; &nbsp; &nbsp;http://miniupnp.tuxfamily.org/files/[/code]&nbsp; 3) 编译依赖包 3.1) OpenSSL cd /c/openssl-1.0.1c-mgw ./config make 未发现问题，如有任何问题，欢迎讨论。 3.2) Berkeley DB cd /c/db-4.8.30.NC-mgw/build_unix sh ../dist/configure --enable-mingw --enable-cxx --disable-replication make 注意：卸载mingw安装包中pthread组件，否则，BDB会尝试构建repmgr模块（repmgr_posix.c需要posix支持，mingw32不支持）。 注意：2014.4.19更新，在用i686-w64-ming32编译的时候发现，repmgr模块还依赖iostream标准头文件，可以考虑直接--disable-replication，而不必删除编译器的pthread组件。sh ../dist/configure --enable-mingw --enable-cxx --disable-replication 3.3) &nbsp;Boost downloaded boost jam 3.1.18 cd \boost-1.50.0-mgw (0) 修改一个类的dll导出修饰 boost\program_options\detail\config_file.hpp, 参考最好的注意事项 (1) 准备bjam.exe，考虑到boost对mingw的支持不是很好，折中的办法是用vc++的命令行构建一个bjam（比如：bootstrap.bat vc9）；然后用这个b2.exe构建mingw版本的boost。 (2）执行 b2 --prefix=/d/workspace/temp install toolset=gcc link=shared variant=release runtime-link=shared threading=multi --without-mpi --without-python --without-wave --without-graph --without-graph_parallel 3.4) &nbsp;MiniUPnPc cd /c/miniupnpc-1.6-mgw make -f Makefile.mingw mkdir miniupnpc cp *.h miniupnpc/ （1）修改一个miniupnpc.def里面的LIBRARY指定的库名称为空的问题； （2）修改一个Makefile.mingw的del命令； （3）添加-Wl,前缀给-enable-stdcall-fixup选项 （4）可以考虑使用最新的版本，1.9.20140401版本，已经修复了上面提到的3个问题 3.5) libpng 编译png编码库(libpng下载地址)支持二维码生成 ./configure --prefix=/usr/local/libpng-1.6.10 &amp;&amp; make &amp;&amp; make install 3.6) qrencode 二维码编码库( 下载QREncode地址)，需要png和pkg-config支持，下载一个lite版本解压到mingw目录下 ./configure --prefix=/usr/local/qrencode-3.4.3 png_CFLAGS=&quot;-I/usr/local/libpng-1.6.10/include&quot; png_LIBS=&quot;-L/usr/local/libpng-1.6.10/lib -lpng16&quot; &amp;&amp; make &amp;&amp; make install 3.7) zlib $ make -f win32/Makefile.gcc install \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SHARED_MODE=1 \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESTDIR=/usr/local/zlib-1.2.8/ \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BINARY_PATH=bin \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INCLUDE_PATH=include \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBRARY_PATH=lib 3.8) protobuf $ ./configure --prefix=/usr/local/protobuf-2.5.0 \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CPPFLAGS=-I/usr/local/zlib-1.2.8/include\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LDFLAGS=-L/usr/local/zlib-1.2.8/lib \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBS=-lz 4) 编译bitcoin客户端 编译脚本samplebuild.sh的代码，请修改DEPEND_HOME变量 export DEPEND_HOME=/d/cifs/try/buildbtc/csdn/bitcoin/3rd ./configure \ --disable-tests \ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \ --with-miniupnpc=yes \ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \ LDFLAGS=&quot;-L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot;&nbsp; 4.1) 解决::UnRegisterSleepEx()错误 添加 -D_WIN32_WINNT=0x0601 -DWINVER=0x0601&nbsp; 4.2) 解决WSAPOLLFD未定义 参考：http://sourceforge.net/p/mingw/bugs/1980/&nbsp; 在mingw的winsock2.h里面的第912行附近添加 typedef struct pollfd { &nbsp; SOCKET fd; &nbsp; short &nbsp;events; &nbsp; short &nbsp;revents; } WSAPOLLFD, *PWSAPOLLFD, *LPWSAPOLLFD; 4.3) 解决boost连接问题 参考这个comment 4.3.1) boost_program_options 查看src/m4/ax_boost_program_options.m4的第74行附近： for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.so.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.dylib.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.a.*$;\1;&#39;` ; do 修改为： for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.so.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.dylib.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dll.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.dll\.a.*$;\1;&#39;` ; do 4.3.2) boost_chrono 查看src/m4/ax_boost_chrono.m4的第81行附近： for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_chrono.*\)\.so.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.dylib.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.a.*$;\1;&#39;` ; do 修改为： for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.dll.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_chrono.*\)\.so.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.dylib.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.dll\.a.*$;\1;&#39;` ; do 4.4) 修复bitcoin构建时的库依赖顺序 libbitcoin_wallet.a依赖于boost的filesystem,但是在src/Makefile.am里面boost_libs设置在libbitcoin_wallet.a之前，但是如果--disable-wallet编译不发现问题。 参考：https://github.com/bitcoin/bitcoin/commit/d696820b45d9b6be1c21a65f2c8ed3b260938cb7 5) 编译核心模块bitcoind sh autogen.sh &amp;&amp; sh samplebuild.sh &amp;&amp; make $ make &nbsp; &nbsp; ...//很多输出 &nbsp; CXXLD &nbsp;bitcoind.exe &nbsp; CXX &nbsp; &nbsp;bitcoin-cli.o &nbsp; CXXLD &nbsp;bitcoin-cli.exe make[3]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[2]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[1]: Entering directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master&#39; make[1]: Nothing to be done for `all-am&#39;. make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master&#39; 运行命令行版本的bitcoin的client，看看帮助提示: $ ./bitcoin-cli.exe --help Bitcoin RPC client version v0.8.2-820-gf65dc44-dirty-beta Usage: &nbsp; bitcoin-cli [options] &lt;command&gt; [params] &nbsp;Send command to Bitcoin server &nbsp; bitcoin-cli [options] help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List commands &nbsp; bitcoin-cli [options] help &lt;command&gt; &nbsp; &nbsp; &nbsp;Get help for a command Options: &nbsp; -? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This help message &nbsp; -conf=&lt;file&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specify configuration file (default: bitcoin.conf) &nbsp; -datadir=&lt;dir&gt; &nbsp; &nbsp; &nbsp; &nbsp; Specify data directory &nbsp; -testnet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use the test network &nbsp; -rpcconnect=&lt;ip&gt; &nbsp; &nbsp; &nbsp; Send commands to node running on &lt;ip&gt; (default: 127.0.0 .1) &nbsp; -rpcwait &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wait for RPC server to start &nbsp; -rpcuser=&lt;user&gt; &nbsp; &nbsp; &nbsp; &nbsp;Username for JSON-RPC connections &nbsp; -rpcpassword=&lt;pw&gt; &nbsp; &nbsp; &nbsp;Password for JSON-RPC connections &nbsp; -rpcport=&lt;port&gt; &nbsp; &nbsp; &nbsp; &nbsp;Connect to JSON-RPC on &lt;port&gt; (default: 8332 or testnet : 18332) SSL options: (see the Bitcoin Wiki for SSL setup instructions) &nbsp; -rpcssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use OpenSSL (https) for JSON-RPC conn ections 6) 编译qt前端 如何使用Ming32构建Qt，参考这个文章。 构建好以后放到3rd目录下备用。 另外下载google的protocbuf工具编译后，放到3rd目录下。 楼主会在git上push所有的需要的lib和工具到3rd目录，包括打包用的makensis工具。 好了吧，开始配置带qt前端的bticoin。 示例脚本：samplebuild.sh export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46 export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd export PATH=$PATH:$MAKENSIS_HOME ./configure \ --disable-tests \ --disable-ipv6 \ --disable-ccache \ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \ --with-miniupnpc=yes \ --with-qt-incdir=${QT_INC_HOME} \ --with-qt-libdir=${QT_LIB_HOME} \ --with-qt-bindir=${QT_BIN_HOME} \ --with-qt-plugindir=${QT_PLUGIN_HOME} \ --with-protoc-bindir=${PROTOC_BIN_HOME} \ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \ LDFLAGS=&quot;-L${PROTOC_LIB_HOME}-L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot;&nbsp; 楼主没有打算使用pkg_config。有兴趣的同学可以试试。 如果需要二维码支持，请使用这个sh samplebuild.sh export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46 export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins export QR_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/include export QR_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/lib export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd export PATH=$PATH:$MAKENSIS_HOME ./configure \ --disable-tests \ --disable-ipv6 \ --disable-ccache \ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \ --with-miniupnpc=yes \ --with-qt-incdir=${QT_INC_HOME} \ --with-qt-libdir=${QT_LIB_HOME} \ --with-qt-bindir=${QT_BIN_HOME} \ --with-qt-plugindir=${QT_PLUGIN_HOME} \ --with-protoc-bindir=${PROTOC_BIN_HOME} \ QR_LIBS=&quot;-lqrencode&quot; \ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${QR_INC_HOME} -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \ LDFLAGS=&quot;-L${QR_LIB_HOME} -L${PROTOC_LIB_HOME} -L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot; 然后再来一个make吧(mingw32-make可能会有CreateProcess失败的提示，linux和windows的路径的问题） 耐心的等待吧，时间还好，比qt4的构建时间短多了。&nbsp; 运行make deploy可以生成一个安装包，前提是你配置了了makensis打包软件。 并且需要修改一下share/setup.nsi里面的几个linux路径为windows路径, 主要是File指令后面的参数。 安装吧，安装完成以后需要添加几个依赖的dll到安装目录，boost, miniupnpc, berkeley db, protocbuf， 以及mingw的crt等。 Done! 7) 注意事项 1) boost 1) GCC 4.8 warns of ignored attribute in declaration &nbsp; &nbsp; &nbsp; &nbsp; Ticket #8725 (closed &nbsp;Bugs: fixed) 2)MINGW构建boost失败 &nbsp; &nbsp; &nbsp; &nbsp; Ticket #6350: mingw.jam &nbsp; &nbsp; &nbsp; &nbsp; boost官方网站表示cygwin和mingw的支持程度是不一样的 3) 导出common_config_file_iterator &nbsp; &nbsp; &nbsp; &nbsp; https://github.com/boostorg/program_options/commit/4ae33ce15e5b6345e6eefa19466fdf7cd28a7bbd 2) MiniUPNPc 建议使用最新的1.9版本以上，已经修复以下几个1.6版本的问题： 1) 修改Makefile.mingw 这个是patch文件, 添加del 命令定义，添加-Wl,前缀 需要修改-enable-stdcall-fixup为-Wl,-enable-stdcall-fixup: 否则-enable-stdcall-fixup的-e会被理解成windows上可执行文件的入口指令，这应该是编译器的一个bug。 谢谢 steking1 同学的提醒 --- D:/cifs/lab/tarballs/Makefile.mingw 周二 四月 19 04:05:38 2011 +++ D:/cifs/lab/tarballs/Makefile.mingw.fixed 周二 二月 25 10:44:20 2014 @@ -8,6 +8,7 @@ CC = gcc &nbsp;#CFLAGS = -Wall -g -DDEBUG -D_WIN32_WINNT=0X501 &nbsp;CFLAGS = -Wall -Os -DNDEBUG -D_WIN32_WINNT=0X501 &nbsp;LDLIBS = -lws2_32 -liphlpapi +DEL &nbsp; &nbsp;= rm -rf &nbsp;# -lwsock32 &nbsp;# -liphlpapi is used for GetBestRoute() &nbsp;PYTHON=\utils\python25\python @@ -23,11 +24,11 @@ init: &nbsp; echo init &gt; init &nbsp; &nbsp;clean: - del upnpc testminixml *.o - del dll\*.o - del *.exe - del miniupnpc.dll - del libminiupnpc.a + $(DEL) upnpc testminixml *.o + $(DEL) dll\*.o + $(DEL) *.exe + $(DEL) miniupnpc.dll + $(DEL) libminiupnpc.a &nbsp; &nbsp;libminiupnpc.a: $(OBJS) &nbsp; $(AR) cr $@ $? @@ -58,10 +59,10 @@ upnpc.o: &nbsp; $(CC) $(CFLAGS) -c -o dll/$@ $&lt; &nbsp; &nbsp;upnpc-static: upnpc.o libminiupnpc.a - $(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS) + $(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS) &nbsp; &nbsp;upnpc-shared: dll/upnpc.o miniupnpc.lib - $(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS) + $(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS) &nbsp; &nbsp;wingenminiupnpcstrings: wingenminiupnpcstrings.o 2) 从DLL生成导入lib库的时候出错 dllwrap -k --driver-name gcc \ &nbsp; &nbsp; &nbsp; &nbsp; --def miniupnpc.def \ &nbsp; &nbsp; &nbsp; &nbsp; --output-def miniupnpc.dll.def \ &nbsp; &nbsp; &nbsp; &nbsp; --implib miniupnpc.lib -o miniupnpc.dll \ &nbsp; &nbsp; &nbsp; &nbsp; dll/miniwget.o dll/minixml.o dll/igd_desc_parse.o dll/minisoap.o dll/min iupnpc.o dll/upnpreplyparse.o dll/upnpcommands.o dll/upnperrors.o dll/connecthos tport.o dll/portlistingparse.o dll/receivedata.o -lws2_32 -liphlpapi D:\cifs\mingw32\bin\dlltool: Syntax error in def file miniupnpc.def:5 D:\cifs\mingw32\bin\dlltool: Syntax error in def file miniupnpc.def:5 看看def文件的前面5行，dlltool工具不允许空的library指令，修改一下，在第一行LIBRARY指令后面添加一下库的名字miniupnpc: LIBRARY miniupnpc ; miniupnpc library EXPORTS ; miniupnpc 3) BerkeleyDB 可以考虑直接禁用repmgr模块 --disable-replication,因为这个模块依赖依赖posix的一些系统api，mingw支持不好。 # Replication can be disabled. if test &quot;$db_cv_build_replication&quot; = &quot;yes&quot;; then AC_DEFINE(HAVE_REPLICATION) AH_TEMPLATE(HAVE_REPLICATION, &nbsp; &nbsp;[Define to 1 if building replication support.]) ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS \$(REP_OBJS)&quot; # If we&#39;re building replication and detected POSIX threads, build the # replication manager. AH_TEMPLATE(HAVE_REPLICATION_THREADS, &nbsp; &nbsp;[Define to 1 if building the Berkeley DB replication framework.]) if test &quot;$ac_cv_header_pthread_h&quot; = yes; then AC_DEFINE(HAVE_REPLICATION_THREADS) # Solaris requires the socket and nsl libraries to build the # replication manager. &nbsp;Don&#39;t add nsl regardless of the OS, # it causes RPC to fail on AIX 4.3.3. case &quot;$host_os&quot; in solaris*) AC_HAVE_LIBRARY(nsl, LIBSO_LIBS=&quot;$LIBSO_LIBS -lnsl&quot;) AC_HAVE_LIBRARY(socket, &nbsp; &nbsp;LIBSO_LIBS=&quot;$LIBSO_LIBS -lsocket&quot;);; esac ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS \$(REPMGR_OBJS)&quot; else ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS repmgr_stub${o}&quot; fi else ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS rep_stub${o} repmgr_stub${o}&quot; fi 4) mingw32在linux交叉编译openssl http://www.blogcompiler.com/2011/12/21/openssl-for-windows/ http://www.wagner.pp.ru/~vitus/articles/openssl-mingw.html 5) 自动脚本 for windows native building with mingw64, with GUI, used for client # 1) zlib make install -f win32/Makefile.gcc \ DESTDIR=/usr/local/zlib-1.2.8/ \ INCLUDE_PATH=include \ LIBRARY_PATH=lib \ BINARY_PATH=bin # 2) libpng ./configure --prefix=/usr/local/libpng-1.6.9 \ --enable-shared=no \ --enable-static=yes # 3) qrencode&nbsp; ./configure --prefix=/usr/local/qrencode-3.4.3 \ --enable-shared=no \ --enable-static=yes \ png_CFLAGS=&quot;-I/usr/local/libpng-1.6.9/include&quot; \ png_LIBS=&quot;-L/usr/local/libpng-1.6.9/lib -lpng16&quot; # 4) protobuf ./configure --prefix=/usr/local/protobuf-2.5.0 \ --enable-static=yes \ --enable-shared=no # 5) BerkeleyDB cd build_unix &amp;&amp; sh ../dist/configure \ --enable-mingw \ --enable-cxx \ --disable-replication # 6) miniupnpc make -f Makefile.mingw &amp;&amp; mkdir miniupnpc &amp;&amp; cp *.h miniupnpc&nbsp; # 7) OpenSSL ./config \ no-shared \ no-threads \ no-asm \ no-zlib \ --prefix=/usr/local/ssl \ &amp;&amp; make &amp;&amp; make install # 8) Boost b2 install --prefix=/usr/local/boost-1.53 \ toolset=gcc \ link=shared \ variant=release \ runtime-link=shared \ threading=multi \ --without-mpi \ --without-python \ --without-wave \ --without-graph \ --without-graph_parallel&nbsp; # 9) qt4 configure.exe \ &nbsp; &nbsp; -I &quot;/usr/local/ssl/include&quot; \ &nbsp; &nbsp; -L &quot;/usr/local/ssl/lib&quot; \ &nbsp; &nbsp; -l ssl \ &nbsp; &nbsp; -l crypto \ &nbsp; &nbsp; -release \ &nbsp; &nbsp; -opensource \ &nbsp; &nbsp; -confirm-license \ &nbsp; &nbsp; -static \ &nbsp; &nbsp; -no-ltcg \ &nbsp; &nbsp; -no-fast \ &nbsp; &nbsp; -exceptions \ &nbsp; &nbsp; -accessibility \ &nbsp; &nbsp; -stl \ &nbsp; &nbsp; -no-sql-sqlite \ &nbsp; &nbsp; -no-qt3support \ &nbsp; &nbsp; -no-opengl \ &nbsp; &nbsp; -no-openvg \ &nbsp; &nbsp; -platform win32-g++ \ &nbsp; &nbsp; -no-system-proxies \ &nbsp; &nbsp; -qt-zlib \ &nbsp; &nbsp; -no-gif \ &nbsp; &nbsp; -qt-libpng \ &nbsp; &nbsp; -no-libmng \ &nbsp; &nbsp; -no-libtiff \ &nbsp; &nbsp; -qt-libjpeg \ &nbsp; &nbsp; -no-dsp \ &nbsp; &nbsp; -no-vcproj \ &nbsp; &nbsp; -no-incredibuild-xge \ &nbsp; &nbsp; -plugin-manifests \ &nbsp; &nbsp; -qmake \ &nbsp; &nbsp; -process -nomake demos -nomake examples -nomake tools \ &nbsp; &nbsp; -no-rtti \ &nbsp; &nbsp; -no-mmx \ &nbsp; &nbsp; -no-3dnow \ &nbsp; &nbsp; -no-sse \ &nbsp; &nbsp; -no-sse2 \ &nbsp; &nbsp; -openssl \ &nbsp; &nbsp; -no-dbus \ &nbsp; &nbsp; -no-phonon -no-phonon-backend \ &nbsp; &nbsp; -no-multimedia -no-audio-backend \ &nbsp; &nbsp; -no-webkit \ &nbsp; &nbsp; -no-script -no-scripttools -no-declarative \ &nbsp; &nbsp; -arch windows \ &nbsp; &nbsp; -no-style-plastique \ &nbsp; &nbsp; -no-style-windowsxp -no-style-windowsvista \ &nbsp; &nbsp; -no-style-cleanlooks -no-style-cde \ &nbsp; &nbsp; -no-style-motif \ &nbsp; &nbsp; -no-native-gestures \ &nbsp; &nbsp; -saveconfig csdnbuild &nbsp; &nbsp; # 10) export DEPEND_HOME=/usr/local export MAKENSIS_HOME=${DEPEND_HOME}/nsis-2.46 export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/include export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/lib export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.55 export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.55/include/boost-1_55 export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.55/lib export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.9/include export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.9/lib export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib export QT_BIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/bin export QT_INC_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/include export QT_LIB_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/lib export QT_PLUGIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins export QT_CODECS_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins/codecs export SSL_INC_HOME=${DEPEND_HOME}/ssl/include export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib export PATH=${PATH}:${MAKENSIS_HOME} ./configure \ &nbsp; &nbsp; --enable-wallet \ &nbsp; &nbsp; --disable-tests \ &nbsp; &nbsp; --disable-ipv6 \ &nbsp; &nbsp; --disable-ccache \ &nbsp; &nbsp; --with-boost=&quot;${BOOST_TOP_HOME}&quot; \ &nbsp; &nbsp; --with-qrencode=yes \ &nbsp; &nbsp; --with-miniupnpc=yes \ &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \ &nbsp; &nbsp; --with-cli=yes \ &nbsp; &nbsp; --with-daemon=yes \ &nbsp; &nbsp; --with-gui=qt4 \ &nbsp; &nbsp; --with-qt-incdir=${QT_INC_HOME} \ &nbsp; &nbsp; --with-qt-libdir=${QT_LIB_HOME} \ &nbsp; &nbsp; --with-qt-bindir=${QT_BIN_HOME} \ &nbsp; &nbsp; --with-qt-plugindir=${QT_PLUGIN_HOME} \ &nbsp; &nbsp; CPPFLAGS=&quot;-w -g -O0 -I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}&quot; \ &nbsp; &nbsp; LDFLAGS=&quot;-L${QR_LIB_HOME} -L${QT_CODECS_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}&quot; for linux native building with gcc, without gui, used for mining and service. # 1) Boost ./b2 install --prefix=/root/harrywu/build/3rd/boost toolset=gcc variant=release link=static threading=multi runtime-link=static --without-graph --without-graph_parallel --without-mpi --without-python --without-regex --without-wave # 2) BerkeleyDB cd build_unix &amp;&amp; ../dist/configure --prefix=/root/harrywu/build/3rd/bdb48 --enable-static=yes --enable-shared=no --enable-cxx --disable-replication --disable-debug # 3) miniupnpc make DESTDIR=/root/harrywu/build/3rd/miniupnpc-1.9.0 INSTALLPREFIX= install # 4) protobuf ./configure --prefix=/root/harrywu/build/3rd/protobuf-2.5.0 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz # 5) qrencode ./configure --prefix=/root/harrywu/build/3rd/qrencode-3.4.3 --enable-shared=no --enable-static=yes png_CFLAGS=-I/root/harrywu/build/3rd/libpng-1.6.10/ png_LIBS=-L/root/harrywu/build/3rd/libpng-1.6.10/lib/ -lpng16 # 6) ssl ./config no-threads no-shared no-zlib no-asm --prefix=/root/harrywu/build/3rd/ssl # 7) zlib ./configure --prefix=/root/harrywu/build/3rd/zlib-1.2.8 --static # 8) libpng ./configure --prefix=/root/harrywu/build/3rd/libpng-1.6.10 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz # 9) qt missing # 10) Bitcoin export DEPEND_HOME=/root/harrywu/build/3rd export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/include export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/lib export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.53 export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.53/include/boost-1_55 export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.53/lib export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.10/include export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.10/lib export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib export SSL_INC_HOME=${DEPEND_HOME}/ssl/include export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib ./configure \ &nbsp; &nbsp; --enable-wallet \ &nbsp; &nbsp; --disable-tests \ &nbsp; &nbsp; --disable-ipv6 \ &nbsp; &nbsp; --disable-ccache \ &nbsp; &nbsp; --with-boost=&quot;${BOOST_TOP_HOME}&quot; \ &nbsp; &nbsp; --with-qrencode=yes \ &nbsp; &nbsp; --with-miniupnpc=yes \ &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \ &nbsp; &nbsp; --with-cli=yes \ &nbsp; &nbsp; --with-daemon=yes \ &nbsp; &nbsp; --with-gui=no \ &nbsp; &nbsp; CPPFLAGS=&quot;-I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}&quot; \ &nbsp; &nbsp; LDFLAGS=&quot;-L${QR_LIB_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}&quot; \ LIBS=&quot;-lrt -ldl&quot; 阅读更多" />
<meta property="og:description" content="本帖只谈技术实现，首先我们自己来编译一个比特币客户端吧， 技术讨论QQ群，306888500，欢迎大家入伙(注明：csdn)。 2014.7.18更新: 静态编译的第三方依赖和MINGW64工具链以及v0.9.1的官方源代码在github上： https://github.com/imharrywu/betcoin 本文遇到的问题大部分是使用动态库构建的时候遇到的，仅仅作为一个备份，大家可以直接迁出上面的代码或者直接跳到本文的最后看《自动脚本》 不带任何qt-style风格的qt界面库构建出来的比特币satoshi客户端 ======================================================================================================================= 先看一下最后编出来的带qt前端的客户端版本截图，会有测试版本提示 (使用tag的源代码编译正式版本) (建议：备份您之前安装的%APPDATA%bitcoin目录)。 参考github上的描述文件 https://github.com/bitcoin/bitcoin/blob/master/doc/build-msw.md 1) 签出代码 GitHub上的官方源代码 git clonehttps://github.com/bitcoin/bitcoin.git[/code]&nbsp; 也可以从csdn的code上签出本文的整个项目组 git clone git://code.csdn.net/wuzh1230/bitcoin.git 提示： &lt;1&gt;已经包含了预编译的依赖库在3rd目录下； &lt;2&gt;已经包含了ming32工具链，请修改msys/1.0/etc/fstab。 &lt;3&gt;文章遇到的问题大多是使用动态库构造的时候遇到的，建议大家用--enable-static构造所有的依赖，直接跳到最后一节《自动脚本》。 2) 下载依赖包 Libraries you need to download separately and build: name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default path &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; download ---------------------------------------------------- OpenSSL &nbsp; &nbsp; &nbsp; &nbsp; \openssl-1.0.1c-mgw &nbsp; &nbsp; &nbsp; http://www.openssl.org/source/ Berkeley DB &nbsp; &nbsp; \db-4.8.30.NC-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.oracle.com/technology/software/products/berkeley-db/index.html Boost &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \boost-1.50.0-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.boost.org/users/download/ miniupnpc &nbsp; &nbsp; &nbsp; \miniupnpc-1.6-mgw &nbsp; &nbsp; &nbsp; &nbsp;http://miniupnp.tuxfamily.org/files/[/code]&nbsp; 3) 编译依赖包 3.1) OpenSSL cd /c/openssl-1.0.1c-mgw ./config make 未发现问题，如有任何问题，欢迎讨论。 3.2) Berkeley DB cd /c/db-4.8.30.NC-mgw/build_unix sh ../dist/configure --enable-mingw --enable-cxx --disable-replication make 注意：卸载mingw安装包中pthread组件，否则，BDB会尝试构建repmgr模块（repmgr_posix.c需要posix支持，mingw32不支持）。 注意：2014.4.19更新，在用i686-w64-ming32编译的时候发现，repmgr模块还依赖iostream标准头文件，可以考虑直接--disable-replication，而不必删除编译器的pthread组件。sh ../dist/configure --enable-mingw --enable-cxx --disable-replication 3.3) &nbsp;Boost downloaded boost jam 3.1.18 cd \boost-1.50.0-mgw (0) 修改一个类的dll导出修饰 boost\program_options\detail\config_file.hpp, 参考最好的注意事项 (1) 准备bjam.exe，考虑到boost对mingw的支持不是很好，折中的办法是用vc++的命令行构建一个bjam（比如：bootstrap.bat vc9）；然后用这个b2.exe构建mingw版本的boost。 (2）执行 b2 --prefix=/d/workspace/temp install toolset=gcc link=shared variant=release runtime-link=shared threading=multi --without-mpi --without-python --without-wave --without-graph --without-graph_parallel 3.4) &nbsp;MiniUPnPc cd /c/miniupnpc-1.6-mgw make -f Makefile.mingw mkdir miniupnpc cp *.h miniupnpc/ （1）修改一个miniupnpc.def里面的LIBRARY指定的库名称为空的问题； （2）修改一个Makefile.mingw的del命令； （3）添加-Wl,前缀给-enable-stdcall-fixup选项 （4）可以考虑使用最新的版本，1.9.20140401版本，已经修复了上面提到的3个问题 3.5) libpng 编译png编码库(libpng下载地址)支持二维码生成 ./configure --prefix=/usr/local/libpng-1.6.10 &amp;&amp; make &amp;&amp; make install 3.6) qrencode 二维码编码库( 下载QREncode地址)，需要png和pkg-config支持，下载一个lite版本解压到mingw目录下 ./configure --prefix=/usr/local/qrencode-3.4.3 png_CFLAGS=&quot;-I/usr/local/libpng-1.6.10/include&quot; png_LIBS=&quot;-L/usr/local/libpng-1.6.10/lib -lpng16&quot; &amp;&amp; make &amp;&amp; make install 3.7) zlib $ make -f win32/Makefile.gcc install \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SHARED_MODE=1 \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESTDIR=/usr/local/zlib-1.2.8/ \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BINARY_PATH=bin \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INCLUDE_PATH=include \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBRARY_PATH=lib 3.8) protobuf $ ./configure --prefix=/usr/local/protobuf-2.5.0 \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CPPFLAGS=-I/usr/local/zlib-1.2.8/include\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LDFLAGS=-L/usr/local/zlib-1.2.8/lib \ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBS=-lz 4) 编译bitcoin客户端 编译脚本samplebuild.sh的代码，请修改DEPEND_HOME变量 export DEPEND_HOME=/d/cifs/try/buildbtc/csdn/bitcoin/3rd ./configure \ --disable-tests \ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \ --with-miniupnpc=yes \ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \ LDFLAGS=&quot;-L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot;&nbsp; 4.1) 解决::UnRegisterSleepEx()错误 添加 -D_WIN32_WINNT=0x0601 -DWINVER=0x0601&nbsp; 4.2) 解决WSAPOLLFD未定义 参考：http://sourceforge.net/p/mingw/bugs/1980/&nbsp; 在mingw的winsock2.h里面的第912行附近添加 typedef struct pollfd { &nbsp; SOCKET fd; &nbsp; short &nbsp;events; &nbsp; short &nbsp;revents; } WSAPOLLFD, *PWSAPOLLFD, *LPWSAPOLLFD; 4.3) 解决boost连接问题 参考这个comment 4.3.1) boost_program_options 查看src/m4/ax_boost_program_options.m4的第74行附近： for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.so.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.dylib.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.a.*$;\1;&#39;` ; do 修改为： for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.so.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.dylib.*$;\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dll.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_program_options.*\)\.dll\.a.*$;\1;&#39;` ; do 4.3.2) boost_chrono 查看src/m4/ax_boost_chrono.m4的第81行附近： for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_chrono.*\)\.so.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.dylib.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.a.*$;\1;&#39;` ; do 修改为： for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.dll.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\(boost_chrono.*\)\.so.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.dylib.*$;\1;&#39; -e &#39;s;^lib\(boost_chrono.*\)\.dll\.a.*$;\1;&#39;` ; do 4.4) 修复bitcoin构建时的库依赖顺序 libbitcoin_wallet.a依赖于boost的filesystem,但是在src/Makefile.am里面boost_libs设置在libbitcoin_wallet.a之前，但是如果--disable-wallet编译不发现问题。 参考：https://github.com/bitcoin/bitcoin/commit/d696820b45d9b6be1c21a65f2c8ed3b260938cb7 5) 编译核心模块bitcoind sh autogen.sh &amp;&amp; sh samplebuild.sh &amp;&amp; make $ make &nbsp; &nbsp; ...//很多输出 &nbsp; CXXLD &nbsp;bitcoind.exe &nbsp; CXX &nbsp; &nbsp;bitcoin-cli.o &nbsp; CXXLD &nbsp;bitcoin-cli.exe make[3]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[2]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[1]: Entering directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master&#39; make[1]: Nothing to be done for `all-am&#39;. make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master&#39; 运行命令行版本的bitcoin的client，看看帮助提示: $ ./bitcoin-cli.exe --help Bitcoin RPC client version v0.8.2-820-gf65dc44-dirty-beta Usage: &nbsp; bitcoin-cli [options] &lt;command&gt; [params] &nbsp;Send command to Bitcoin server &nbsp; bitcoin-cli [options] help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List commands &nbsp; bitcoin-cli [options] help &lt;command&gt; &nbsp; &nbsp; &nbsp;Get help for a command Options: &nbsp; -? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This help message &nbsp; -conf=&lt;file&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specify configuration file (default: bitcoin.conf) &nbsp; -datadir=&lt;dir&gt; &nbsp; &nbsp; &nbsp; &nbsp; Specify data directory &nbsp; -testnet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use the test network &nbsp; -rpcconnect=&lt;ip&gt; &nbsp; &nbsp; &nbsp; Send commands to node running on &lt;ip&gt; (default: 127.0.0 .1) &nbsp; -rpcwait &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wait for RPC server to start &nbsp; -rpcuser=&lt;user&gt; &nbsp; &nbsp; &nbsp; &nbsp;Username for JSON-RPC connections &nbsp; -rpcpassword=&lt;pw&gt; &nbsp; &nbsp; &nbsp;Password for JSON-RPC connections &nbsp; -rpcport=&lt;port&gt; &nbsp; &nbsp; &nbsp; &nbsp;Connect to JSON-RPC on &lt;port&gt; (default: 8332 or testnet : 18332) SSL options: (see the Bitcoin Wiki for SSL setup instructions) &nbsp; -rpcssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use OpenSSL (https) for JSON-RPC conn ections 6) 编译qt前端 如何使用Ming32构建Qt，参考这个文章。 构建好以后放到3rd目录下备用。 另外下载google的protocbuf工具编译后，放到3rd目录下。 楼主会在git上push所有的需要的lib和工具到3rd目录，包括打包用的makensis工具。 好了吧，开始配置带qt前端的bticoin。 示例脚本：samplebuild.sh export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46 export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd export PATH=$PATH:$MAKENSIS_HOME ./configure \ --disable-tests \ --disable-ipv6 \ --disable-ccache \ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \ --with-miniupnpc=yes \ --with-qt-incdir=${QT_INC_HOME} \ --with-qt-libdir=${QT_LIB_HOME} \ --with-qt-bindir=${QT_BIN_HOME} \ --with-qt-plugindir=${QT_PLUGIN_HOME} \ --with-protoc-bindir=${PROTOC_BIN_HOME} \ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \ LDFLAGS=&quot;-L${PROTOC_LIB_HOME}-L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot;&nbsp; 楼主没有打算使用pkg_config。有兴趣的同学可以试试。 如果需要二维码支持，请使用这个sh samplebuild.sh export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46 export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins export QR_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/include export QR_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/lib export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd export PATH=$PATH:$MAKENSIS_HOME ./configure \ --disable-tests \ --disable-ipv6 \ --disable-ccache \ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \ --with-miniupnpc=yes \ --with-qt-incdir=${QT_INC_HOME} \ --with-qt-libdir=${QT_LIB_HOME} \ --with-qt-bindir=${QT_BIN_HOME} \ --with-qt-plugindir=${QT_PLUGIN_HOME} \ --with-protoc-bindir=${PROTOC_BIN_HOME} \ QR_LIBS=&quot;-lqrencode&quot; \ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${QR_INC_HOME} -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \ LDFLAGS=&quot;-L${QR_LIB_HOME} -L${PROTOC_LIB_HOME} -L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot; 然后再来一个make吧(mingw32-make可能会有CreateProcess失败的提示，linux和windows的路径的问题） 耐心的等待吧，时间还好，比qt4的构建时间短多了。&nbsp; 运行make deploy可以生成一个安装包，前提是你配置了了makensis打包软件。 并且需要修改一下share/setup.nsi里面的几个linux路径为windows路径, 主要是File指令后面的参数。 安装吧，安装完成以后需要添加几个依赖的dll到安装目录，boost, miniupnpc, berkeley db, protocbuf， 以及mingw的crt等。 Done! 7) 注意事项 1) boost 1) GCC 4.8 warns of ignored attribute in declaration &nbsp; &nbsp; &nbsp; &nbsp; Ticket #8725 (closed &nbsp;Bugs: fixed) 2)MINGW构建boost失败 &nbsp; &nbsp; &nbsp; &nbsp; Ticket #6350: mingw.jam &nbsp; &nbsp; &nbsp; &nbsp; boost官方网站表示cygwin和mingw的支持程度是不一样的 3) 导出common_config_file_iterator &nbsp; &nbsp; &nbsp; &nbsp; https://github.com/boostorg/program_options/commit/4ae33ce15e5b6345e6eefa19466fdf7cd28a7bbd 2) MiniUPNPc 建议使用最新的1.9版本以上，已经修复以下几个1.6版本的问题： 1) 修改Makefile.mingw 这个是patch文件, 添加del 命令定义，添加-Wl,前缀 需要修改-enable-stdcall-fixup为-Wl,-enable-stdcall-fixup: 否则-enable-stdcall-fixup的-e会被理解成windows上可执行文件的入口指令，这应该是编译器的一个bug。 谢谢 steking1 同学的提醒 --- D:/cifs/lab/tarballs/Makefile.mingw 周二 四月 19 04:05:38 2011 +++ D:/cifs/lab/tarballs/Makefile.mingw.fixed 周二 二月 25 10:44:20 2014 @@ -8,6 +8,7 @@ CC = gcc &nbsp;#CFLAGS = -Wall -g -DDEBUG -D_WIN32_WINNT=0X501 &nbsp;CFLAGS = -Wall -Os -DNDEBUG -D_WIN32_WINNT=0X501 &nbsp;LDLIBS = -lws2_32 -liphlpapi +DEL &nbsp; &nbsp;= rm -rf &nbsp;# -lwsock32 &nbsp;# -liphlpapi is used for GetBestRoute() &nbsp;PYTHON=\utils\python25\python @@ -23,11 +24,11 @@ init: &nbsp; echo init &gt; init &nbsp; &nbsp;clean: - del upnpc testminixml *.o - del dll\*.o - del *.exe - del miniupnpc.dll - del libminiupnpc.a + $(DEL) upnpc testminixml *.o + $(DEL) dll\*.o + $(DEL) *.exe + $(DEL) miniupnpc.dll + $(DEL) libminiupnpc.a &nbsp; &nbsp;libminiupnpc.a: $(OBJS) &nbsp; $(AR) cr $@ $? @@ -58,10 +59,10 @@ upnpc.o: &nbsp; $(CC) $(CFLAGS) -c -o dll/$@ $&lt; &nbsp; &nbsp;upnpc-static: upnpc.o libminiupnpc.a - $(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS) + $(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS) &nbsp; &nbsp;upnpc-shared: dll/upnpc.o miniupnpc.lib - $(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS) + $(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS) &nbsp; &nbsp;wingenminiupnpcstrings: wingenminiupnpcstrings.o 2) 从DLL生成导入lib库的时候出错 dllwrap -k --driver-name gcc \ &nbsp; &nbsp; &nbsp; &nbsp; --def miniupnpc.def \ &nbsp; &nbsp; &nbsp; &nbsp; --output-def miniupnpc.dll.def \ &nbsp; &nbsp; &nbsp; &nbsp; --implib miniupnpc.lib -o miniupnpc.dll \ &nbsp; &nbsp; &nbsp; &nbsp; dll/miniwget.o dll/minixml.o dll/igd_desc_parse.o dll/minisoap.o dll/min iupnpc.o dll/upnpreplyparse.o dll/upnpcommands.o dll/upnperrors.o dll/connecthos tport.o dll/portlistingparse.o dll/receivedata.o -lws2_32 -liphlpapi D:\cifs\mingw32\bin\dlltool: Syntax error in def file miniupnpc.def:5 D:\cifs\mingw32\bin\dlltool: Syntax error in def file miniupnpc.def:5 看看def文件的前面5行，dlltool工具不允许空的library指令，修改一下，在第一行LIBRARY指令后面添加一下库的名字miniupnpc: LIBRARY miniupnpc ; miniupnpc library EXPORTS ; miniupnpc 3) BerkeleyDB 可以考虑直接禁用repmgr模块 --disable-replication,因为这个模块依赖依赖posix的一些系统api，mingw支持不好。 # Replication can be disabled. if test &quot;$db_cv_build_replication&quot; = &quot;yes&quot;; then AC_DEFINE(HAVE_REPLICATION) AH_TEMPLATE(HAVE_REPLICATION, &nbsp; &nbsp;[Define to 1 if building replication support.]) ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS \$(REP_OBJS)&quot; # If we&#39;re building replication and detected POSIX threads, build the # replication manager. AH_TEMPLATE(HAVE_REPLICATION_THREADS, &nbsp; &nbsp;[Define to 1 if building the Berkeley DB replication framework.]) if test &quot;$ac_cv_header_pthread_h&quot; = yes; then AC_DEFINE(HAVE_REPLICATION_THREADS) # Solaris requires the socket and nsl libraries to build the # replication manager. &nbsp;Don&#39;t add nsl regardless of the OS, # it causes RPC to fail on AIX 4.3.3. case &quot;$host_os&quot; in solaris*) AC_HAVE_LIBRARY(nsl, LIBSO_LIBS=&quot;$LIBSO_LIBS -lnsl&quot;) AC_HAVE_LIBRARY(socket, &nbsp; &nbsp;LIBSO_LIBS=&quot;$LIBSO_LIBS -lsocket&quot;);; esac ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS \$(REPMGR_OBJS)&quot; else ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS repmgr_stub${o}&quot; fi else ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS rep_stub${o} repmgr_stub${o}&quot; fi 4) mingw32在linux交叉编译openssl http://www.blogcompiler.com/2011/12/21/openssl-for-windows/ http://www.wagner.pp.ru/~vitus/articles/openssl-mingw.html 5) 自动脚本 for windows native building with mingw64, with GUI, used for client # 1) zlib make install -f win32/Makefile.gcc \ DESTDIR=/usr/local/zlib-1.2.8/ \ INCLUDE_PATH=include \ LIBRARY_PATH=lib \ BINARY_PATH=bin # 2) libpng ./configure --prefix=/usr/local/libpng-1.6.9 \ --enable-shared=no \ --enable-static=yes # 3) qrencode&nbsp; ./configure --prefix=/usr/local/qrencode-3.4.3 \ --enable-shared=no \ --enable-static=yes \ png_CFLAGS=&quot;-I/usr/local/libpng-1.6.9/include&quot; \ png_LIBS=&quot;-L/usr/local/libpng-1.6.9/lib -lpng16&quot; # 4) protobuf ./configure --prefix=/usr/local/protobuf-2.5.0 \ --enable-static=yes \ --enable-shared=no # 5) BerkeleyDB cd build_unix &amp;&amp; sh ../dist/configure \ --enable-mingw \ --enable-cxx \ --disable-replication # 6) miniupnpc make -f Makefile.mingw &amp;&amp; mkdir miniupnpc &amp;&amp; cp *.h miniupnpc&nbsp; # 7) OpenSSL ./config \ no-shared \ no-threads \ no-asm \ no-zlib \ --prefix=/usr/local/ssl \ &amp;&amp; make &amp;&amp; make install # 8) Boost b2 install --prefix=/usr/local/boost-1.53 \ toolset=gcc \ link=shared \ variant=release \ runtime-link=shared \ threading=multi \ --without-mpi \ --without-python \ --without-wave \ --without-graph \ --without-graph_parallel&nbsp; # 9) qt4 configure.exe \ &nbsp; &nbsp; -I &quot;/usr/local/ssl/include&quot; \ &nbsp; &nbsp; -L &quot;/usr/local/ssl/lib&quot; \ &nbsp; &nbsp; -l ssl \ &nbsp; &nbsp; -l crypto \ &nbsp; &nbsp; -release \ &nbsp; &nbsp; -opensource \ &nbsp; &nbsp; -confirm-license \ &nbsp; &nbsp; -static \ &nbsp; &nbsp; -no-ltcg \ &nbsp; &nbsp; -no-fast \ &nbsp; &nbsp; -exceptions \ &nbsp; &nbsp; -accessibility \ &nbsp; &nbsp; -stl \ &nbsp; &nbsp; -no-sql-sqlite \ &nbsp; &nbsp; -no-qt3support \ &nbsp; &nbsp; -no-opengl \ &nbsp; &nbsp; -no-openvg \ &nbsp; &nbsp; -platform win32-g++ \ &nbsp; &nbsp; -no-system-proxies \ &nbsp; &nbsp; -qt-zlib \ &nbsp; &nbsp; -no-gif \ &nbsp; &nbsp; -qt-libpng \ &nbsp; &nbsp; -no-libmng \ &nbsp; &nbsp; -no-libtiff \ &nbsp; &nbsp; -qt-libjpeg \ &nbsp; &nbsp; -no-dsp \ &nbsp; &nbsp; -no-vcproj \ &nbsp; &nbsp; -no-incredibuild-xge \ &nbsp; &nbsp; -plugin-manifests \ &nbsp; &nbsp; -qmake \ &nbsp; &nbsp; -process -nomake demos -nomake examples -nomake tools \ &nbsp; &nbsp; -no-rtti \ &nbsp; &nbsp; -no-mmx \ &nbsp; &nbsp; -no-3dnow \ &nbsp; &nbsp; -no-sse \ &nbsp; &nbsp; -no-sse2 \ &nbsp; &nbsp; -openssl \ &nbsp; &nbsp; -no-dbus \ &nbsp; &nbsp; -no-phonon -no-phonon-backend \ &nbsp; &nbsp; -no-multimedia -no-audio-backend \ &nbsp; &nbsp; -no-webkit \ &nbsp; &nbsp; -no-script -no-scripttools -no-declarative \ &nbsp; &nbsp; -arch windows \ &nbsp; &nbsp; -no-style-plastique \ &nbsp; &nbsp; -no-style-windowsxp -no-style-windowsvista \ &nbsp; &nbsp; -no-style-cleanlooks -no-style-cde \ &nbsp; &nbsp; -no-style-motif \ &nbsp; &nbsp; -no-native-gestures \ &nbsp; &nbsp; -saveconfig csdnbuild &nbsp; &nbsp; # 10) export DEPEND_HOME=/usr/local export MAKENSIS_HOME=${DEPEND_HOME}/nsis-2.46 export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/include export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/lib export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.55 export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.55/include/boost-1_55 export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.55/lib export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.9/include export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.9/lib export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib export QT_BIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/bin export QT_INC_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/include export QT_LIB_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/lib export QT_PLUGIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins export QT_CODECS_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins/codecs export SSL_INC_HOME=${DEPEND_HOME}/ssl/include export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib export PATH=${PATH}:${MAKENSIS_HOME} ./configure \ &nbsp; &nbsp; --enable-wallet \ &nbsp; &nbsp; --disable-tests \ &nbsp; &nbsp; --disable-ipv6 \ &nbsp; &nbsp; --disable-ccache \ &nbsp; &nbsp; --with-boost=&quot;${BOOST_TOP_HOME}&quot; \ &nbsp; &nbsp; --with-qrencode=yes \ &nbsp; &nbsp; --with-miniupnpc=yes \ &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \ &nbsp; &nbsp; --with-cli=yes \ &nbsp; &nbsp; --with-daemon=yes \ &nbsp; &nbsp; --with-gui=qt4 \ &nbsp; &nbsp; --with-qt-incdir=${QT_INC_HOME} \ &nbsp; &nbsp; --with-qt-libdir=${QT_LIB_HOME} \ &nbsp; &nbsp; --with-qt-bindir=${QT_BIN_HOME} \ &nbsp; &nbsp; --with-qt-plugindir=${QT_PLUGIN_HOME} \ &nbsp; &nbsp; CPPFLAGS=&quot;-w -g -O0 -I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}&quot; \ &nbsp; &nbsp; LDFLAGS=&quot;-L${QR_LIB_HOME} -L${QT_CODECS_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}&quot; for linux native building with gcc, without gui, used for mining and service. # 1) Boost ./b2 install --prefix=/root/harrywu/build/3rd/boost toolset=gcc variant=release link=static threading=multi runtime-link=static --without-graph --without-graph_parallel --without-mpi --without-python --without-regex --without-wave # 2) BerkeleyDB cd build_unix &amp;&amp; ../dist/configure --prefix=/root/harrywu/build/3rd/bdb48 --enable-static=yes --enable-shared=no --enable-cxx --disable-replication --disable-debug # 3) miniupnpc make DESTDIR=/root/harrywu/build/3rd/miniupnpc-1.9.0 INSTALLPREFIX= install # 4) protobuf ./configure --prefix=/root/harrywu/build/3rd/protobuf-2.5.0 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz # 5) qrencode ./configure --prefix=/root/harrywu/build/3rd/qrencode-3.4.3 --enable-shared=no --enable-static=yes png_CFLAGS=-I/root/harrywu/build/3rd/libpng-1.6.10/ png_LIBS=-L/root/harrywu/build/3rd/libpng-1.6.10/lib/ -lpng16 # 6) ssl ./config no-threads no-shared no-zlib no-asm --prefix=/root/harrywu/build/3rd/ssl # 7) zlib ./configure --prefix=/root/harrywu/build/3rd/zlib-1.2.8 --static # 8) libpng ./configure --prefix=/root/harrywu/build/3rd/libpng-1.6.10 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz # 9) qt missing # 10) Bitcoin export DEPEND_HOME=/root/harrywu/build/3rd export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/include export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/lib export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.53 export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.53/include/boost-1_55 export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.53/lib export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.10/include export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.10/lib export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib export SSL_INC_HOME=${DEPEND_HOME}/ssl/include export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib ./configure \ &nbsp; &nbsp; --enable-wallet \ &nbsp; &nbsp; --disable-tests \ &nbsp; &nbsp; --disable-ipv6 \ &nbsp; &nbsp; --disable-ccache \ &nbsp; &nbsp; --with-boost=&quot;${BOOST_TOP_HOME}&quot; \ &nbsp; &nbsp; --with-qrencode=yes \ &nbsp; &nbsp; --with-miniupnpc=yes \ &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \ &nbsp; &nbsp; --with-cli=yes \ &nbsp; &nbsp; --with-daemon=yes \ &nbsp; &nbsp; --with-gui=no \ &nbsp; &nbsp; CPPFLAGS=&quot;-I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}&quot; \ &nbsp; &nbsp; LDFLAGS=&quot;-L${QR_LIB_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}&quot; \ LIBS=&quot;-lrt -ldl&quot; 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-07-12T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"本帖只谈技术实现，首先我们自己来编译一个比特币客户端吧， 技术讨论QQ群，306888500，欢迎大家入伙(注明：csdn)。 2014.7.18更新: 静态编译的第三方依赖和MINGW64工具链以及v0.9.1的官方源代码在github上： https://github.com/imharrywu/betcoin 本文遇到的问题大部分是使用动态库构建的时候遇到的，仅仅作为一个备份，大家可以直接迁出上面的代码或者直接跳到本文的最后看《自动脚本》 不带任何qt-style风格的qt界面库构建出来的比特币satoshi客户端 ======================================================================================================================= 先看一下最后编出来的带qt前端的客户端版本截图，会有测试版本提示 (使用tag的源代码编译正式版本) (建议：备份您之前安装的%APPDATA%bitcoin目录)。 参考github上的描述文件 https://github.com/bitcoin/bitcoin/blob/master/doc/build-msw.md 1) 签出代码 GitHub上的官方源代码 git clonehttps://github.com/bitcoin/bitcoin.git[/code]&nbsp; 也可以从csdn的code上签出本文的整个项目组 git clone git://code.csdn.net/wuzh1230/bitcoin.git 提示： &lt;1&gt;已经包含了预编译的依赖库在3rd目录下； &lt;2&gt;已经包含了ming32工具链，请修改msys/1.0/etc/fstab。 &lt;3&gt;文章遇到的问题大多是使用动态库构造的时候遇到的，建议大家用--enable-static构造所有的依赖，直接跳到最后一节《自动脚本》。 2) 下载依赖包 Libraries you need to download separately and build: name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default path &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; download ---------------------------------------------------- OpenSSL &nbsp; &nbsp; &nbsp; &nbsp; \\openssl-1.0.1c-mgw &nbsp; &nbsp; &nbsp; http://www.openssl.org/source/ Berkeley DB &nbsp; &nbsp; \\db-4.8.30.NC-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.oracle.com/technology/software/products/berkeley-db/index.html Boost &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\boost-1.50.0-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.boost.org/users/download/ miniupnpc &nbsp; &nbsp; &nbsp; \\miniupnpc-1.6-mgw &nbsp; &nbsp; &nbsp; &nbsp;http://miniupnp.tuxfamily.org/files/[/code]&nbsp; 3) 编译依赖包 3.1) OpenSSL cd /c/openssl-1.0.1c-mgw ./config make 未发现问题，如有任何问题，欢迎讨论。 3.2) Berkeley DB cd /c/db-4.8.30.NC-mgw/build_unix sh ../dist/configure --enable-mingw --enable-cxx --disable-replication make 注意：卸载mingw安装包中pthread组件，否则，BDB会尝试构建repmgr模块（repmgr_posix.c需要posix支持，mingw32不支持）。 注意：2014.4.19更新，在用i686-w64-ming32编译的时候发现，repmgr模块还依赖iostream标准头文件，可以考虑直接--disable-replication，而不必删除编译器的pthread组件。sh ../dist/configure --enable-mingw --enable-cxx --disable-replication 3.3) &nbsp;Boost downloaded boost jam 3.1.18 cd \\boost-1.50.0-mgw (0) 修改一个类的dll导出修饰 boost\\program_options\\detail\\config_file.hpp, 参考最好的注意事项 (1) 准备bjam.exe，考虑到boost对mingw的支持不是很好，折中的办法是用vc++的命令行构建一个bjam（比如：bootstrap.bat vc9）；然后用这个b2.exe构建mingw版本的boost。 (2）执行 b2 --prefix=/d/workspace/temp install toolset=gcc link=shared variant=release runtime-link=shared threading=multi --without-mpi --without-python --without-wave --without-graph --without-graph_parallel 3.4) &nbsp;MiniUPnPc cd /c/miniupnpc-1.6-mgw make -f Makefile.mingw mkdir miniupnpc cp *.h miniupnpc/ （1）修改一个miniupnpc.def里面的LIBRARY指定的库名称为空的问题； （2）修改一个Makefile.mingw的del命令； （3）添加-Wl,前缀给-enable-stdcall-fixup选项 （4）可以考虑使用最新的版本，1.9.20140401版本，已经修复了上面提到的3个问题 3.5) libpng 编译png编码库(libpng下载地址)支持二维码生成 ./configure --prefix=/usr/local/libpng-1.6.10 &amp;&amp; make &amp;&amp; make install 3.6) qrencode 二维码编码库( 下载QREncode地址)，需要png和pkg-config支持，下载一个lite版本解压到mingw目录下 ./configure --prefix=/usr/local/qrencode-3.4.3 png_CFLAGS=&quot;-I/usr/local/libpng-1.6.10/include&quot; png_LIBS=&quot;-L/usr/local/libpng-1.6.10/lib -lpng16&quot; &amp;&amp; make &amp;&amp; make install 3.7) zlib $ make -f win32/Makefile.gcc install \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SHARED_MODE=1 \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESTDIR=/usr/local/zlib-1.2.8/ \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BINARY_PATH=bin \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INCLUDE_PATH=include \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBRARY_PATH=lib 3.8) protobuf $ ./configure --prefix=/usr/local/protobuf-2.5.0 \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CPPFLAGS=-I/usr/local/zlib-1.2.8/include\\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LDFLAGS=-L/usr/local/zlib-1.2.8/lib \\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBS=-lz 4) 编译bitcoin客户端 编译脚本samplebuild.sh的代码，请修改DEPEND_HOME变量 export DEPEND_HOME=/d/cifs/try/buildbtc/csdn/bitcoin/3rd ./configure \\ --disable-tests \\ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \\ --with-miniupnpc=yes \\ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \\ LDFLAGS=&quot;-L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot;&nbsp; 4.1) 解决::UnRegisterSleepEx()错误 添加 -D_WIN32_WINNT=0x0601 -DWINVER=0x0601&nbsp; 4.2) 解决WSAPOLLFD未定义 参考：http://sourceforge.net/p/mingw/bugs/1980/&nbsp; 在mingw的winsock2.h里面的第912行附近添加 typedef struct pollfd { &nbsp; SOCKET fd; &nbsp; short &nbsp;events; &nbsp; short &nbsp;revents; } WSAPOLLFD, *PWSAPOLLFD, *LPWSAPOLLFD; 4.3) 解决boost连接问题 参考这个comment 4.3.1) boost_program_options 查看src/m4/ax_boost_program_options.m4的第74行附近： for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_program_options.*\\)\\.so.*$;\\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_program_options.*\\)\\.dylib.*$;\\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_program_options.*\\)\\.a.*$;\\1;&#39;` ; do 修改为： for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_program_options.*\\)\\.so.*$;\\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_program_options.*\\)\\.dylib.*$;\\1;&#39;` `ls $BOOSTLIBDIR/libboost_program_options*.dll.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_program_options.*\\)\\.dll\\.a.*$;\\1;&#39;` ; do 4.3.2) boost_chrono 查看src/m4/ax_boost_chrono.m4的第81行附近： for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_chrono.*\\)\\.so.*$;\\1;&#39; -e &#39;s;^lib\\(boost_chrono.*\\)\\.dylib.*$;\\1;&#39; -e &#39;s;^lib\\(boost_chrono.*\\)\\.a.*$;\\1;&#39;` ; do 修改为： for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.dll.a* 2&gt;/dev/null | sed &#39;s,.*/,,&#39; | sed -e &#39;s;^lib\\(boost_chrono.*\\)\\.so.*$;\\1;&#39; -e &#39;s;^lib\\(boost_chrono.*\\)\\.dylib.*$;\\1;&#39; -e &#39;s;^lib\\(boost_chrono.*\\)\\.dll\\.a.*$;\\1;&#39;` ; do 4.4) 修复bitcoin构建时的库依赖顺序 libbitcoin_wallet.a依赖于boost的filesystem,但是在src/Makefile.am里面boost_libs设置在libbitcoin_wallet.a之前，但是如果--disable-wallet编译不发现问题。 参考：https://github.com/bitcoin/bitcoin/commit/d696820b45d9b6be1c21a65f2c8ed3b260938cb7 5) 编译核心模块bitcoind sh autogen.sh &amp;&amp; sh samplebuild.sh &amp;&amp; make $ make &nbsp; &nbsp; ...//很多输出 &nbsp; CXXLD &nbsp;bitcoind.exe &nbsp; CXX &nbsp; &nbsp;bitcoin-cli.o &nbsp; CXXLD &nbsp;bitcoin-cli.exe make[3]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[2]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src&#39; make[1]: Entering directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master&#39; make[1]: Nothing to be done for `all-am&#39;. make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master&#39; 运行命令行版本的bitcoin的client，看看帮助提示: $ ./bitcoin-cli.exe --help Bitcoin RPC client version v0.8.2-820-gf65dc44-dirty-beta Usage: &nbsp; bitcoin-cli [options] &lt;command&gt; [params] &nbsp;Send command to Bitcoin server &nbsp; bitcoin-cli [options] help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List commands &nbsp; bitcoin-cli [options] help &lt;command&gt; &nbsp; &nbsp; &nbsp;Get help for a command Options: &nbsp; -? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This help message &nbsp; -conf=&lt;file&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specify configuration file (default: bitcoin.conf) &nbsp; -datadir=&lt;dir&gt; &nbsp; &nbsp; &nbsp; &nbsp; Specify data directory &nbsp; -testnet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use the test network &nbsp; -rpcconnect=&lt;ip&gt; &nbsp; &nbsp; &nbsp; Send commands to node running on &lt;ip&gt; (default: 127.0.0 .1) &nbsp; -rpcwait &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wait for RPC server to start &nbsp; -rpcuser=&lt;user&gt; &nbsp; &nbsp; &nbsp; &nbsp;Username for JSON-RPC connections &nbsp; -rpcpassword=&lt;pw&gt; &nbsp; &nbsp; &nbsp;Password for JSON-RPC connections &nbsp; -rpcport=&lt;port&gt; &nbsp; &nbsp; &nbsp; &nbsp;Connect to JSON-RPC on &lt;port&gt; (default: 8332 or testnet : 18332) SSL options: (see the Bitcoin Wiki for SSL setup instructions) &nbsp; -rpcssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use OpenSSL (https) for JSON-RPC conn ections 6) 编译qt前端 如何使用Ming32构建Qt，参考这个文章。 构建好以后放到3rd目录下备用。 另外下载google的protocbuf工具编译后，放到3rd目录下。 楼主会在git上push所有的需要的lib和工具到3rd目录，包括打包用的makensis工具。 好了吧，开始配置带qt前端的bticoin。 示例脚本：samplebuild.sh export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46 export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd export PATH=$PATH:$MAKENSIS_HOME ./configure \\ --disable-tests \\ --disable-ipv6 \\ --disable-ccache \\ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \\ --with-miniupnpc=yes \\ --with-qt-incdir=${QT_INC_HOME} \\ --with-qt-libdir=${QT_LIB_HOME} \\ --with-qt-bindir=${QT_BIN_HOME} \\ --with-qt-plugindir=${QT_PLUGIN_HOME} \\ --with-protoc-bindir=${PROTOC_BIN_HOME} \\ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \\ LDFLAGS=&quot;-L${PROTOC_LIB_HOME}-L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot;&nbsp; 楼主没有打算使用pkg_config。有兴趣的同学可以试试。 如果需要二维码支持，请使用这个sh samplebuild.sh export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46 export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins export QR_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/include export QR_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/lib export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd export PATH=$PATH:$MAKENSIS_HOME ./configure \\ --disable-tests \\ --disable-ipv6 \\ --disable-ccache \\ --with-boost=&quot;${DEPEND_HOME}/boost-1.50.0-mgw&quot; \\ --with-miniupnpc=yes \\ --with-qt-incdir=${QT_INC_HOME} \\ --with-qt-libdir=${QT_LIB_HOME} \\ --with-qt-bindir=${QT_BIN_HOME} \\ --with-qt-plugindir=${QT_PLUGIN_HOME} \\ --with-protoc-bindir=${PROTOC_BIN_HOME} \\ QR_LIBS=&quot;-lqrencode&quot; \\ CPPFLAGS=&quot;-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${QR_INC_HOME} -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50&quot; \\ LDFLAGS=&quot;-L${QR_LIB_HOME} -L${PROTOC_LIB_HOME} -L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib&quot; 然后再来一个make吧(mingw32-make可能会有CreateProcess失败的提示，linux和windows的路径的问题） 耐心的等待吧，时间还好，比qt4的构建时间短多了。&nbsp; 运行make deploy可以生成一个安装包，前提是你配置了了makensis打包软件。 并且需要修改一下share/setup.nsi里面的几个linux路径为windows路径, 主要是File指令后面的参数。 安装吧，安装完成以后需要添加几个依赖的dll到安装目录，boost, miniupnpc, berkeley db, protocbuf， 以及mingw的crt等。 Done! 7) 注意事项 1) boost 1) GCC 4.8 warns of ignored attribute in declaration &nbsp; &nbsp; &nbsp; &nbsp; Ticket #8725 (closed &nbsp;Bugs: fixed) 2)MINGW构建boost失败 &nbsp; &nbsp; &nbsp; &nbsp; Ticket #6350: mingw.jam &nbsp; &nbsp; &nbsp; &nbsp; boost官方网站表示cygwin和mingw的支持程度是不一样的 3) 导出common_config_file_iterator &nbsp; &nbsp; &nbsp; &nbsp; https://github.com/boostorg/program_options/commit/4ae33ce15e5b6345e6eefa19466fdf7cd28a7bbd 2) MiniUPNPc 建议使用最新的1.9版本以上，已经修复以下几个1.6版本的问题： 1) 修改Makefile.mingw 这个是patch文件, 添加del 命令定义，添加-Wl,前缀 需要修改-enable-stdcall-fixup为-Wl,-enable-stdcall-fixup: 否则-enable-stdcall-fixup的-e会被理解成windows上可执行文件的入口指令，这应该是编译器的一个bug。 谢谢 steking1 同学的提醒 --- D:/cifs/lab/tarballs/Makefile.mingw 周二 四月 19 04:05:38 2011 +++ D:/cifs/lab/tarballs/Makefile.mingw.fixed 周二 二月 25 10:44:20 2014 @@ -8,6 +8,7 @@ CC = gcc &nbsp;#CFLAGS = -Wall -g -DDEBUG -D_WIN32_WINNT=0X501 &nbsp;CFLAGS = -Wall -Os -DNDEBUG -D_WIN32_WINNT=0X501 &nbsp;LDLIBS = -lws2_32 -liphlpapi +DEL &nbsp; &nbsp;= rm -rf &nbsp;# -lwsock32 &nbsp;# -liphlpapi is used for GetBestRoute() &nbsp;PYTHON=\\utils\\python25\\python @@ -23,11 +24,11 @@ init: &nbsp; echo init &gt; init &nbsp; &nbsp;clean: - del upnpc testminixml *.o - del dll\\*.o - del *.exe - del miniupnpc.dll - del libminiupnpc.a + $(DEL) upnpc testminixml *.o + $(DEL) dll\\*.o + $(DEL) *.exe + $(DEL) miniupnpc.dll + $(DEL) libminiupnpc.a &nbsp; &nbsp;libminiupnpc.a: $(OBJS) &nbsp; $(AR) cr $@ $? @@ -58,10 +59,10 @@ upnpc.o: &nbsp; $(CC) $(CFLAGS) -c -o dll/$@ $&lt; &nbsp; &nbsp;upnpc-static: upnpc.o libminiupnpc.a - $(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS) + $(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS) &nbsp; &nbsp;upnpc-shared: dll/upnpc.o miniupnpc.lib - $(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS) + $(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS) &nbsp; &nbsp;wingenminiupnpcstrings: wingenminiupnpcstrings.o 2) 从DLL生成导入lib库的时候出错 dllwrap -k --driver-name gcc \\ &nbsp; &nbsp; &nbsp; &nbsp; --def miniupnpc.def \\ &nbsp; &nbsp; &nbsp; &nbsp; --output-def miniupnpc.dll.def \\ &nbsp; &nbsp; &nbsp; &nbsp; --implib miniupnpc.lib -o miniupnpc.dll \\ &nbsp; &nbsp; &nbsp; &nbsp; dll/miniwget.o dll/minixml.o dll/igd_desc_parse.o dll/minisoap.o dll/min iupnpc.o dll/upnpreplyparse.o dll/upnpcommands.o dll/upnperrors.o dll/connecthos tport.o dll/portlistingparse.o dll/receivedata.o -lws2_32 -liphlpapi D:\\cifs\\mingw32\\bin\\dlltool: Syntax error in def file miniupnpc.def:5 D:\\cifs\\mingw32\\bin\\dlltool: Syntax error in def file miniupnpc.def:5 看看def文件的前面5行，dlltool工具不允许空的library指令，修改一下，在第一行LIBRARY指令后面添加一下库的名字miniupnpc: LIBRARY miniupnpc ; miniupnpc library EXPORTS ; miniupnpc 3) BerkeleyDB 可以考虑直接禁用repmgr模块 --disable-replication,因为这个模块依赖依赖posix的一些系统api，mingw支持不好。 # Replication can be disabled. if test &quot;$db_cv_build_replication&quot; = &quot;yes&quot;; then AC_DEFINE(HAVE_REPLICATION) AH_TEMPLATE(HAVE_REPLICATION, &nbsp; &nbsp;[Define to 1 if building replication support.]) ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS \\$(REP_OBJS)&quot; # If we&#39;re building replication and detected POSIX threads, build the # replication manager. AH_TEMPLATE(HAVE_REPLICATION_THREADS, &nbsp; &nbsp;[Define to 1 if building the Berkeley DB replication framework.]) if test &quot;$ac_cv_header_pthread_h&quot; = yes; then AC_DEFINE(HAVE_REPLICATION_THREADS) # Solaris requires the socket and nsl libraries to build the # replication manager. &nbsp;Don&#39;t add nsl regardless of the OS, # it causes RPC to fail on AIX 4.3.3. case &quot;$host_os&quot; in solaris*) AC_HAVE_LIBRARY(nsl, LIBSO_LIBS=&quot;$LIBSO_LIBS -lnsl&quot;) AC_HAVE_LIBRARY(socket, &nbsp; &nbsp;LIBSO_LIBS=&quot;$LIBSO_LIBS -lsocket&quot;);; esac ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS \\$(REPMGR_OBJS)&quot; else ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS repmgr_stub${o}&quot; fi else ADDITIONAL_OBJS=&quot;$ADDITIONAL_OBJS rep_stub${o} repmgr_stub${o}&quot; fi 4) mingw32在linux交叉编译openssl http://www.blogcompiler.com/2011/12/21/openssl-for-windows/ http://www.wagner.pp.ru/~vitus/articles/openssl-mingw.html 5) 自动脚本 for windows native building with mingw64, with GUI, used for client # 1) zlib make install -f win32/Makefile.gcc \\ DESTDIR=/usr/local/zlib-1.2.8/ \\ INCLUDE_PATH=include \\ LIBRARY_PATH=lib \\ BINARY_PATH=bin # 2) libpng ./configure --prefix=/usr/local/libpng-1.6.9 \\ --enable-shared=no \\ --enable-static=yes # 3) qrencode&nbsp; ./configure --prefix=/usr/local/qrencode-3.4.3 \\ --enable-shared=no \\ --enable-static=yes \\ png_CFLAGS=&quot;-I/usr/local/libpng-1.6.9/include&quot; \\ png_LIBS=&quot;-L/usr/local/libpng-1.6.9/lib -lpng16&quot; # 4) protobuf ./configure --prefix=/usr/local/protobuf-2.5.0 \\ --enable-static=yes \\ --enable-shared=no # 5) BerkeleyDB cd build_unix &amp;&amp; sh ../dist/configure \\ --enable-mingw \\ --enable-cxx \\ --disable-replication # 6) miniupnpc make -f Makefile.mingw &amp;&amp; mkdir miniupnpc &amp;&amp; cp *.h miniupnpc&nbsp; # 7) OpenSSL ./config \\ no-shared \\ no-threads \\ no-asm \\ no-zlib \\ --prefix=/usr/local/ssl \\ &amp;&amp; make &amp;&amp; make install # 8) Boost b2 install --prefix=/usr/local/boost-1.53 \\ toolset=gcc \\ link=shared \\ variant=release \\ runtime-link=shared \\ threading=multi \\ --without-mpi \\ --without-python \\ --without-wave \\ --without-graph \\ --without-graph_parallel&nbsp; # 9) qt4 configure.exe \\ &nbsp; &nbsp; -I &quot;/usr/local/ssl/include&quot; \\ &nbsp; &nbsp; -L &quot;/usr/local/ssl/lib&quot; \\ &nbsp; &nbsp; -l ssl \\ &nbsp; &nbsp; -l crypto \\ &nbsp; &nbsp; -release \\ &nbsp; &nbsp; -opensource \\ &nbsp; &nbsp; -confirm-license \\ &nbsp; &nbsp; -static \\ &nbsp; &nbsp; -no-ltcg \\ &nbsp; &nbsp; -no-fast \\ &nbsp; &nbsp; -exceptions \\ &nbsp; &nbsp; -accessibility \\ &nbsp; &nbsp; -stl \\ &nbsp; &nbsp; -no-sql-sqlite \\ &nbsp; &nbsp; -no-qt3support \\ &nbsp; &nbsp; -no-opengl \\ &nbsp; &nbsp; -no-openvg \\ &nbsp; &nbsp; -platform win32-g++ \\ &nbsp; &nbsp; -no-system-proxies \\ &nbsp; &nbsp; -qt-zlib \\ &nbsp; &nbsp; -no-gif \\ &nbsp; &nbsp; -qt-libpng \\ &nbsp; &nbsp; -no-libmng \\ &nbsp; &nbsp; -no-libtiff \\ &nbsp; &nbsp; -qt-libjpeg \\ &nbsp; &nbsp; -no-dsp \\ &nbsp; &nbsp; -no-vcproj \\ &nbsp; &nbsp; -no-incredibuild-xge \\ &nbsp; &nbsp; -plugin-manifests \\ &nbsp; &nbsp; -qmake \\ &nbsp; &nbsp; -process -nomake demos -nomake examples -nomake tools \\ &nbsp; &nbsp; -no-rtti \\ &nbsp; &nbsp; -no-mmx \\ &nbsp; &nbsp; -no-3dnow \\ &nbsp; &nbsp; -no-sse \\ &nbsp; &nbsp; -no-sse2 \\ &nbsp; &nbsp; -openssl \\ &nbsp; &nbsp; -no-dbus \\ &nbsp; &nbsp; -no-phonon -no-phonon-backend \\ &nbsp; &nbsp; -no-multimedia -no-audio-backend \\ &nbsp; &nbsp; -no-webkit \\ &nbsp; &nbsp; -no-script -no-scripttools -no-declarative \\ &nbsp; &nbsp; -arch windows \\ &nbsp; &nbsp; -no-style-plastique \\ &nbsp; &nbsp; -no-style-windowsxp -no-style-windowsvista \\ &nbsp; &nbsp; -no-style-cleanlooks -no-style-cde \\ &nbsp; &nbsp; -no-style-motif \\ &nbsp; &nbsp; -no-native-gestures \\ &nbsp; &nbsp; -saveconfig csdnbuild &nbsp; &nbsp; # 10) export DEPEND_HOME=/usr/local export MAKENSIS_HOME=${DEPEND_HOME}/nsis-2.46 export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/include export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/lib export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.55 export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.55/include/boost-1_55 export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.55/lib export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.9/include export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.9/lib export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib export QT_BIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/bin export QT_INC_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/include export QT_LIB_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/lib export QT_PLUGIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins export QT_CODECS_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins/codecs export SSL_INC_HOME=${DEPEND_HOME}/ssl/include export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib export PATH=${PATH}:${MAKENSIS_HOME} ./configure \\ &nbsp; &nbsp; --enable-wallet \\ &nbsp; &nbsp; --disable-tests \\ &nbsp; &nbsp; --disable-ipv6 \\ &nbsp; &nbsp; --disable-ccache \\ &nbsp; &nbsp; --with-boost=&quot;${BOOST_TOP_HOME}&quot; \\ &nbsp; &nbsp; --with-qrencode=yes \\ &nbsp; &nbsp; --with-miniupnpc=yes \\ &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \\ &nbsp; &nbsp; --with-cli=yes \\ &nbsp; &nbsp; --with-daemon=yes \\ &nbsp; &nbsp; --with-gui=qt4 \\ &nbsp; &nbsp; --with-qt-incdir=${QT_INC_HOME} \\ &nbsp; &nbsp; --with-qt-libdir=${QT_LIB_HOME} \\ &nbsp; &nbsp; --with-qt-bindir=${QT_BIN_HOME} \\ &nbsp; &nbsp; --with-qt-plugindir=${QT_PLUGIN_HOME} \\ &nbsp; &nbsp; CPPFLAGS=&quot;-w -g -O0 -I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}&quot; \\ &nbsp; &nbsp; LDFLAGS=&quot;-L${QR_LIB_HOME} -L${QT_CODECS_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}&quot; for linux native building with gcc, without gui, used for mining and service. # 1) Boost ./b2 install --prefix=/root/harrywu/build/3rd/boost toolset=gcc variant=release link=static threading=multi runtime-link=static --without-graph --without-graph_parallel --without-mpi --without-python --without-regex --without-wave # 2) BerkeleyDB cd build_unix &amp;&amp; ../dist/configure --prefix=/root/harrywu/build/3rd/bdb48 --enable-static=yes --enable-shared=no --enable-cxx --disable-replication --disable-debug # 3) miniupnpc make DESTDIR=/root/harrywu/build/3rd/miniupnpc-1.9.0 INSTALLPREFIX= install # 4) protobuf ./configure --prefix=/root/harrywu/build/3rd/protobuf-2.5.0 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz # 5) qrencode ./configure --prefix=/root/harrywu/build/3rd/qrencode-3.4.3 --enable-shared=no --enable-static=yes png_CFLAGS=-I/root/harrywu/build/3rd/libpng-1.6.10/ png_LIBS=-L/root/harrywu/build/3rd/libpng-1.6.10/lib/ -lpng16 # 6) ssl ./config no-threads no-shared no-zlib no-asm --prefix=/root/harrywu/build/3rd/ssl # 7) zlib ./configure --prefix=/root/harrywu/build/3rd/zlib-1.2.8 --static # 8) libpng ./configure --prefix=/root/harrywu/build/3rd/libpng-1.6.10 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz # 9) qt missing # 10) Bitcoin export DEPEND_HOME=/root/harrywu/build/3rd export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/include export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/lib export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.53 export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.53/include/boost-1_55 export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.53/lib export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.10/include export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.10/lib export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib export SSL_INC_HOME=${DEPEND_HOME}/ssl/include export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib ./configure \\ &nbsp; &nbsp; --enable-wallet \\ &nbsp; &nbsp; --disable-tests \\ &nbsp; &nbsp; --disable-ipv6 \\ &nbsp; &nbsp; --disable-ccache \\ &nbsp; &nbsp; --with-boost=&quot;${BOOST_TOP_HOME}&quot; \\ &nbsp; &nbsp; --with-qrencode=yes \\ &nbsp; &nbsp; --with-miniupnpc=yes \\ &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \\ &nbsp; &nbsp; --with-cli=yes \\ &nbsp; &nbsp; --with-daemon=yes \\ &nbsp; &nbsp; --with-gui=no \\ &nbsp; &nbsp; CPPFLAGS=&quot;-I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}&quot; \\ &nbsp; &nbsp; LDFLAGS=&quot;-L${QR_LIB_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}&quot; \\ LIBS=&quot;-lrt -ldl&quot; 阅读更多","@type":"BlogPosting","url":"/2017/07/12/cc898a5d6306dd5617993548bb946292.html","headline":"【比特币】虚拟币教程自己动手编译比特币客户端","dateModified":"2017-07-12T00:00:00+08:00","datePublished":"2017-07-12T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2017/07/12/cc898a5d6306dd5617993548bb946292.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>【比特币】虚拟币教程自己动手编译比特币客户端</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views">
   本帖只谈技术实现，首先我们自己来编译一个比特币客户端吧， 技术讨论QQ群，306888500，欢迎大家入伙(注明：csdn)。
  <br>
  <br>
  <br> 2014.7.18更新:
  <br> 静态编译的第三方依赖和MINGW64工具链以及v0.9.1的官方源代码在github上：
  <br> https://github.com/imharrywu/betcoin
  <br>
  <br>
  <br> 本文遇到的问题大部分是使用动态库构建的时候遇到的，仅仅作为一个备份，大家可以直接迁出上面的代码或者直接跳到本文的最后看《自动脚本》
  <br> 不带任何qt-style风格的qt界面库构建出来的比特币satoshi客户端
  <br>
  <br>
  <br> =======================================================================================================================
  <br> 先看一下最后编出来的带qt前端的客户端版本截图，会有测试版本提示 (使用tag的源代码编译正式版本)
  <br> (建议：备份您之前安装的%APPDATA%bitcoin目录)。
  <br>
  <br>
  <br> 参考github上的描述文件
  <br> https://github.com/bitcoin/bitcoin/blob/master/doc/build-msw.md
  <br> 1) 签出代码
  <br>
  <br>
  <br> GitHub上的官方源代码
  <br> git clonehttps://github.com/bitcoin/bitcoin.git[/code]&nbsp;
  <br> 也可以从csdn的code上签出本文的整个项目组
  <br> git clone git://code.csdn.net/wuzh1230/bitcoin.git
  <br>
  <br>
  <br> 提示：
  <br> &lt;1&gt;已经包含了预编译的依赖库在3rd目录下；
  <br> &lt;2&gt;已经包含了ming32工具链，请修改msys/1.0/etc/fstab。
  <br> &lt;3&gt;文章遇到的问题大多是使用动态库构造的时候遇到的，建议大家用--enable-static构造所有的依赖，直接跳到最后一节《自动脚本》。
  <br> 2) 下载依赖包
  <br>
  <br>
  <br> Libraries you need to download separately and build:
  <br> name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default path &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; download
  <br> ----------------------------------------------------
  <br> OpenSSL &nbsp; &nbsp; &nbsp; &nbsp; \openssl-1.0.1c-mgw &nbsp; &nbsp; &nbsp; http://www.openssl.org/source/ Berkeley DB &nbsp; &nbsp; \db-4.8.30.NC-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.oracle.com/technology/software/products/berkeley-db/index.html Boost &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \boost-1.50.0-mgw &nbsp; &nbsp; &nbsp; &nbsp; http://www.boost.org/users/download/ miniupnpc &nbsp; &nbsp; &nbsp; \miniupnpc-1.6-mgw &nbsp; &nbsp; &nbsp; &nbsp;http://miniupnp.tuxfamily.org/files/[/code]&nbsp;
  <br> 3) 编译依赖包
  <br>
  <br>
  <br>
  <br>
  <br> 3.1) OpenSSL
  <br>
  <br>
  <br> cd /c/openssl-1.0.1c-mgw
  <br> ./config
  <br> make
  <br>
  <br>
  <br> 未发现问题，如有任何问题，欢迎讨论。
  <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <br> 3.2) Berkeley DB
  <br>
  <br>
  <br> cd /c/db-4.8.30.NC-mgw/build_unix
  <br> sh ../dist/configure --enable-mingw --enable-cxx --disable-replication
  <br> make
  <br>
  <br>
  <br> 注意：卸载mingw安装包中pthread组件，否则，BDB会尝试构建repmgr模块（repmgr_posix.c需要posix支持，mingw32不支持）。
  <br>
  <br>
  <br> 注意：2014.4.19更新，在用i686-w64-ming32编译的时候发现，repmgr模块还依赖iostream标准头文件，可以考虑直接--disable-replication，而不必删除编译器的pthread组件。sh ../dist/configure --enable-mingw --enable-cxx --disable-replication
  <br>
  <br>
  <br>
  <br>
  <br> 3.3)
  <br> &nbsp;Boost
  <br>
  <br>
  <br> downloaded boost jam 3.1.18
  <br> cd \boost-1.50.0-mgw
  <br>
  <br>
  <br> (0) 修改一个类的dll导出修饰 boost\program_options\detail\config_file.hpp, 参考最好的注意事项
  <br>
  <br>
  <br> (1) 准备bjam.exe，考虑到boost对mingw的支持不是很好，折中的办法是用vc++的命令行构建一个bjam（比如：bootstrap.bat vc9）；然后用这个b2.exe构建mingw版本的boost。
  <br>
  <br>
  <br> (2）执行 b2 --prefix=/d/workspace/temp install toolset=gcc link=shared variant=release runtime-link=shared threading=multi --without-mpi --without-python --without-wave --without-graph --without-graph_parallel
  <br>
  <br>
  <br>
  <br>
  <br> 3.4)
  <br> &nbsp;MiniUPnPc
  <br>
  <br>
  <br> cd /c/miniupnpc-1.6-mgw
  <br> make -f Makefile.mingw
  <br> mkdir miniupnpc
  <br> cp *.h miniupnpc/
  <br>
  <br>
  <br> （1）修改一个miniupnpc.def里面的LIBRARY指定的库名称为空的问题；
  <br>
  <br>
  <br> （2）修改一个Makefile.mingw的del命令；
  <br>
  <br>
  <br> （3）添加-Wl,前缀给-enable-stdcall-fixup选项
  <br>
  <br>
  <br> （4）可以考虑使用最新的版本，1.9.20140401版本，已经修复了上面提到的3个问题
  <br>
  <br>
  <br> 3.5) libpng
  <br>
  <br>
  <br> 编译png编码库(libpng下载地址)支持二维码生成
  <br> ./configure --prefix=/usr/local/libpng-1.6.10 &amp;&amp; make &amp;&amp; make install
  <br>
  <br>
  <br> 3.6) qrencode
  <br>
  <br>
  <br> 二维码编码库( 下载QREncode地址)，需要png和pkg-config支持，下载一个lite版本解压到mingw目录下
  <br> ./configure --prefix=/usr/local/qrencode-3.4.3 png_CFLAGS="-I/usr/local/libpng-1.6.10/include" png_LIBS="-L/usr/local/libpng-1.6.10/lib -lpng16" &amp;&amp; make &amp;&amp; make install
  <br>
  <br>
  <br> 3.7) zlib
  <br>
  <br>
  <br> $ make -f win32/Makefile.gcc install \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SHARED_MODE=1 \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESTDIR=/usr/local/zlib-1.2.8/ \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BINARY_PATH=bin \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INCLUDE_PATH=include \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBRARY_PATH=lib
  <br>
  <br>
  <br> 3.8) protobuf
  <br>
  <br>
  <br> $ ./configure --prefix=/usr/local/protobuf-2.5.0 \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CPPFLAGS=-I/usr/local/zlib-1.2.8/include\
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LDFLAGS=-L/usr/local/zlib-1.2.8/lib \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LIBS=-lz
  <br>
  <br>
  <br> 4) 编译bitcoin客户端
  <br>
  <br>
  <br> 编译脚本samplebuild.sh的代码，请修改DEPEND_HOME变量
  <br> export DEPEND_HOME=/d/cifs/try/buildbtc/csdn/bitcoin/3rd
  <br> ./configure \
  <br> --disable-tests \
  <br> --with-boost="${DEPEND_HOME}/boost-1.50.0-mgw" \
  <br> --with-miniupnpc=yes \
  <br> CPPFLAGS="-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50" \
  <br> LDFLAGS="-L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib"&nbsp;
  <br>
  <br>
  <br> 4.1) 解决::UnRegisterSleepEx()错误
  <br>
  <br>
  <br> 添加 -D_WIN32_WINNT=0x0601 -DWINVER=0x0601&nbsp;
  <br> 4.2) 解决WSAPOLLFD未定义
  <br>
  <br>
  <br> 参考：http://sourceforge.net/p/mingw/bugs/1980/&nbsp;
  <br> 在mingw的winsock2.h里面的第912行附近添加
  <br> typedef struct pollfd {
  <br> &nbsp; SOCKET fd;
  <br> &nbsp; short &nbsp;events;
  <br> &nbsp; short &nbsp;revents;
  <br> } WSAPOLLFD, *PWSAPOLLFD, *LPWSAPOLLFD;
  <br>
  <br>
  <br> 4.3) 解决boost连接问题
  <br>
  <br>
  <br> 参考这个comment
  <br> 4.3.1) boost_program_options
  <br> 查看src/m4/ax_boost_program_options.m4的第74行附近：
  <br> for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_program_options.*\)\.so.*$;\1;'` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_program_options.*\)\.dylib.*$;\1;'` `ls $BOOSTLIBDIR/libboost_program_options*.a* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_program_options.*\)\.a.*$;\1;'` ; do
  <br> 修改为：
  <br> for libextension in `ls $BOOSTLIBDIR/libboost_program_options*.so* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_program_options.*\)\.so.*$;\1;'` `ls $BOOSTLIBDIR/libboost_program_options*.dylib* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_program_options.*\)\.dylib.*$;\1;'` `ls $BOOSTLIBDIR/libboost_program_options*.dll.a* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_program_options.*\)\.dll\.a.*$;\1;'` ; do
  <br>
  <br>
  <br> 4.3.2) boost_chrono
  <br> 查看src/m4/ax_boost_chrono.m4的第81行附近：
  <br> for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.a* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_chrono.*\)\.so.*$;\1;' -e 's;^lib\(boost_chrono.*\)\.dylib.*$;\1;' -e 's;^lib\(boost_chrono.*\)\.a.*$;\1;'` ; do
  <br> 修改为：
  <br> for libextension in `ls $BOOSTLIBDIR/libboost_chrono*.so* $BOOSTLIBDIR/libboost_chrono*.dylib* $BOOSTLIBDIR/libboost_chrono*.dll.a* 2&gt;/dev/null | sed 's,.*/,,' | sed -e 's;^lib\(boost_chrono.*\)\.so.*$;\1;' -e 's;^lib\(boost_chrono.*\)\.dylib.*$;\1;' -e 's;^lib\(boost_chrono.*\)\.dll\.a.*$;\1;'` ; do
  <br>
  <br>
  <br> 4.4) 修复bitcoin构建时的库依赖顺序
  <br>
  <br>
  <br> libbitcoin_wallet.a依赖于boost的filesystem,但是在src/Makefile.am里面boost_libs设置在libbitcoin_wallet.a之前，但是如果--disable-wallet编译不发现问题。
  <br> 参考：https://github.com/bitcoin/bitcoin/commit/d696820b45d9b6be1c21a65f2c8ed3b260938cb7
  <br> 5) 编译核心模块bitcoind
  <br>
  <br>
  <br> sh autogen.sh &amp;&amp; sh samplebuild.sh &amp;&amp; make
  <br> $ make &nbsp;
  <br> &nbsp; ...//很多输出
  <br> &nbsp; CXXLD &nbsp;bitcoind.exe
  <br> &nbsp; CXX &nbsp; &nbsp;bitcoin-cli.o
  <br> &nbsp; CXXLD &nbsp;bitcoin-cli.exe
  <br> make[3]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src'
  <br> make[2]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src'
  <br> make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master/src'
  <br> make[1]: Entering directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master'
  <br> make[1]: Nothing to be done for `all-am'.
  <br> make[1]: Leaving directory `/d/cifs/try/buildbtc/csdn/bitcoin/bitcoin-master'
  <br>
  <br>
  <br> 运行命令行版本的bitcoin的client，看看帮助提示:
  <br> $ ./bitcoin-cli.exe --help
  <br> Bitcoin RPC client version v0.8.2-820-gf65dc44-dirty-beta
  <br>
  <br>
  <br> Usage:
  <br> &nbsp; bitcoin-cli [options] &lt;command&gt; [params] &nbsp;Send command to Bitcoin server
  <br> &nbsp; bitcoin-cli [options] help &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;List commands
  <br> &nbsp; bitcoin-cli [options] help &lt;command&gt; &nbsp; &nbsp; &nbsp;Get help for a command
  <br>
  <br>
  <br> Options:
  <br> &nbsp; -? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; This help message
  <br> &nbsp; -conf=&lt;file&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Specify configuration file (default: bitcoin.conf)
  <br> &nbsp; -datadir=&lt;dir&gt; &nbsp; &nbsp; &nbsp; &nbsp; Specify data directory
  <br> &nbsp; -testnet &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use the test network
  <br> &nbsp; -rpcconnect=&lt;ip&gt; &nbsp; &nbsp; &nbsp; Send commands to node running on &lt;ip&gt; (default: 127.0.0
  <br> .1)
  <br> &nbsp; -rpcwait &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Wait for RPC server to start
  <br> &nbsp; -rpcuser=&lt;user&gt; &nbsp; &nbsp; &nbsp; &nbsp;Username for JSON-RPC connections
  <br> &nbsp; -rpcpassword=&lt;pw&gt; &nbsp; &nbsp; &nbsp;Password for JSON-RPC connections
  <br> &nbsp; -rpcport=&lt;port&gt; &nbsp; &nbsp; &nbsp; &nbsp;Connect to JSON-RPC on &lt;port&gt; (default: 8332 or testnet
  <br> : 18332)
  <br>
  <br>
  <br> SSL options: (see the Bitcoin Wiki for SSL setup instructions)
  <br> &nbsp; -rpcssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Use OpenSSL (https) for JSON-RPC conn
  <br> ections
  <br>
  <br>
  <br> 6) 编译qt前端
  <br>
  <br>
  <br> 如何使用Ming32构建Qt，参考这个文章。
  <br> 构建好以后放到3rd目录下备用。
  <br> 另外下载google的protocbuf工具编译后，放到3rd目录下。
  <br> 楼主会在git上push所有的需要的lib和工具到3rd目录，包括打包用的makensis工具。
  <br> 好了吧，开始配置带qt前端的bticoin。
  <br> 示例脚本：samplebuild.sh
  <br> export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46
  <br>
  <br>
  <br> export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin
  <br> export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include
  <br> export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib
  <br>
  <br>
  <br> export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin
  <br> export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib
  <br> export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include
  <br> export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins
  <br>
  <br>
  <br> export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs
  <br>
  <br>
  <br> export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd
  <br>
  <br>
  <br> export PATH=$PATH:$MAKENSIS_HOME
  <br>
  <br>
  <br> ./configure \
  <br> --disable-tests \
  <br> --disable-ipv6 \
  <br> --disable-ccache \
  <br> --with-boost="${DEPEND_HOME}/boost-1.50.0-mgw" \
  <br> --with-miniupnpc=yes \
  <br> --with-qt-incdir=${QT_INC_HOME} \
  <br> --with-qt-libdir=${QT_LIB_HOME} \
  <br> --with-qt-bindir=${QT_BIN_HOME} \
  <br> --with-qt-plugindir=${QT_PLUGIN_HOME} \
  <br> --with-protoc-bindir=${PROTOC_BIN_HOME} \
  <br> CPPFLAGS="-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50" \
  <br> LDFLAGS="-L${PROTOC_LIB_HOME}-L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib"&nbsp;
  <br>
  <br>
  <br> 楼主没有打算使用pkg_config。有兴趣的同学可以试试。
  <br> 如果需要二维码支持，请使用这个sh samplebuild.sh
  <br> export MAKENSIS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/nsis-2.46
  <br>
  <br>
  <br> export PROTOC_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/bin
  <br> export PROTOC_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/include
  <br> export PROTOC_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/google-protoc-2.5-mgw/lib
  <br>
  <br>
  <br> export QT_BIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/bin
  <br> export QT_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/lib
  <br> export QT_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/include
  <br> export QT_PLUGIN_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins
  <br>
  <br>
  <br> export QR_INC_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/include
  <br> export QR_LIB_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qrencode-3.4.3/lib
  <br>
  <br>
  <br> export LANG_CODECS_HOME=/d/cifs/lab/csdn/bitcoin/3rd/qt-4.8.5-mingw32-4.8.1/plugins/codecs
  <br>
  <br>
  <br> export DEPEND_HOME=/d/cifs/lab/csdn/bitcoin/3rd
  <br>
  <br>
  <br> export PATH=$PATH:$MAKENSIS_HOME
  <br>
  <br>
  <br> ./configure \
  <br> --disable-tests \
  <br> --disable-ipv6 \
  <br> --disable-ccache \
  <br> --with-boost="${DEPEND_HOME}/boost-1.50.0-mgw" \
  <br> --with-miniupnpc=yes \
  <br> --with-qt-incdir=${QT_INC_HOME} \
  <br> --with-qt-libdir=${QT_LIB_HOME} \
  <br> --with-qt-bindir=${QT_BIN_HOME} \
  <br> --with-qt-plugindir=${QT_PLUGIN_HOME} \
  <br> --with-protoc-bindir=${PROTOC_BIN_HOME} \
  <br> QR_LIBS="-lqrencode" \
  <br> CPPFLAGS="-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -w -g -O0 -I${QR_INC_HOME} -I${PROTOC_INC_HOME} -I${DEPEND_HOME}/db-4.8.30.NC-mgw/include -I${DEPEND_HOME}/miniupnpc-1.6-mgw/include -I${DEPEND_HOME}/openssl-1.0.1c-mgw/include -I${DEPEND_HOME}/boost-1.50.0-mgw/include/boost-1_50" \
  <br> LDFLAGS="-L${QR_LIB_HOME} -L${PROTOC_LIB_HOME} -L${LANG_CODECS_HOME} -L${DEPEND_HOME}/db-4.8.30.NC-mgw/lib -L${DEPEND_HOME}/miniupnpc-1.6-mgw/lib -L${DEPEND_HOME}/openssl-1.0.1c-mgw/lib"
  <br>
  <br>
  <br> 然后再来一个make吧(mingw32-make可能会有CreateProcess失败的提示，linux和windows的路径的问题）
  <br> 耐心的等待吧，时间还好，比qt4的构建时间短多了。&nbsp;
  <br> 运行make deploy可以生成一个安装包，前提是你配置了了makensis打包软件。
  <br> 并且需要修改一下share/setup.nsi里面的几个linux路径为windows路径, 主要是File指令后面的参数。
  <br>
  <br>
  <br> 安装吧，安装完成以后需要添加几个依赖的dll到安装目录，boost, miniupnpc, berkeley db, protocbuf， 以及mingw的crt等。
  <br>
  <br>
  <br> Done!
  <br> 7) 注意事项
  <br>
  <br>
  <br> 1) boost
  <br>
  <br>
  <br> 1) GCC 4.8 warns of ignored attribute in declaration
  <br> &nbsp; &nbsp; &nbsp; &nbsp; Ticket #8725 (closed
  <br> &nbsp;Bugs: fixed)
  <br> 2)MINGW构建boost失败
  <br> &nbsp; &nbsp; &nbsp; &nbsp; Ticket #6350: mingw.jam
  <br> &nbsp; &nbsp; &nbsp; &nbsp; boost官方网站表示cygwin和mingw的支持程度是不一样的
  <br> 3) 导出common_config_file_iterator
  <br> &nbsp; &nbsp; &nbsp; &nbsp; https://github.com/boostorg/program_options/commit/4ae33ce15e5b6345e6eefa19466fdf7cd28a7bbd
  <br> 2) MiniUPNPc
  <br>
  <br>
  <br> 建议使用最新的1.9版本以上，已经修复以下几个1.6版本的问题：
  <br> 1) 修改Makefile.mingw
  <br> 这个是patch文件, 添加del 命令定义，添加-Wl,前缀
  <br> 需要修改-enable-stdcall-fixup为-Wl,-enable-stdcall-fixup:
  <br> 否则-enable-stdcall-fixup的-e会被理解成windows上可执行文件的入口指令，这应该是编译器的一个bug。
  <br> 谢谢 steking1 同学的提醒
  <br> --- D:/cifs/lab/tarballs/Makefile.mingw
  <span> </span>周二 四月 19 04:05:38 2011
  <br> +++ D:/cifs/lab/tarballs/Makefile.mingw.fixed
  <span> </span> 周二 二月 25 10:44:20 2014
  <br> @@ -8,6 +8,7 @@ CC = gcc
  <br> &nbsp;#CFLAGS = -Wall -g -DDEBUG -D_WIN32_WINNT=0X501
  <br> &nbsp;CFLAGS = -Wall -Os -DNDEBUG -D_WIN32_WINNT=0X501
  <br> &nbsp;LDLIBS = -lws2_32 -liphlpapi
  <br> +DEL &nbsp; &nbsp;= rm -rf
  <br> &nbsp;# -lwsock32
  <br> &nbsp;# -liphlpapi is used for GetBestRoute()
  <br> &nbsp;PYTHON=\utils\python25\python
  <br> @@ -23,11 +24,11 @@ init:
  <br> &nbsp;
  <span> </span>echo init &gt; init
  <br> &nbsp;
  <br> &nbsp;clean:
  <br> -
  <span> </span>del upnpc testminixml *.o
  <br> -
  <span> </span>del dll\*.o
  <br> -
  <span> </span>del *.exe
  <br> -
  <span> </span>del miniupnpc.dll
  <br> -
  <span> </span>del libminiupnpc.a
  <br> +
  <span> </span>$(DEL) upnpc testminixml *.o
  <br> +
  <span> </span>$(DEL) dll\*.o
  <br> +
  <span> </span>$(DEL) *.exe
  <br> +
  <span> </span>$(DEL) miniupnpc.dll
  <br> +
  <span> </span>$(DEL) libminiupnpc.a
  <br> &nbsp;
  <br> &nbsp;libminiupnpc.a:
  <span> </span>$(OBJS)
  <br> &nbsp;
  <span> </span>$(AR) cr $@ $?
  <br> @@ -58,10 +59,10 @@ upnpc.o:
  <br> &nbsp;
  <span> </span>$(CC) $(CFLAGS) -c -o dll/$@ $&lt;
  <br> &nbsp;
  <br> &nbsp;upnpc-static:
  <span> </span>upnpc.o libminiupnpc.a
  <br> -
  <span> </span>$(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS)
  <br> +
  <span> </span>$(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS)
  <br> &nbsp;
  <br> &nbsp;upnpc-shared:
  <span> </span>dll/upnpc.o miniupnpc.lib
  <br> -
  <span> </span>$(CC) -enable-stdcall-fixup -o $@ $^ $(LDLIBS)
  <br> +
  <span> </span>$(CC) -Wl,-enable-stdcall-fixup -o $@ $^ $(LDLIBS)
  <br> &nbsp;
  <br> &nbsp;wingenminiupnpcstrings:
  <span> </span>wingenminiupnpcstrings.o
  <br>
  <br>
  <br> 2) 从DLL生成导入lib库的时候出错
  <br> dllwrap -k --driver-name gcc \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; --def miniupnpc.def \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; --output-def miniupnpc.dll.def \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; --implib miniupnpc.lib -o miniupnpc.dll \
  <br> &nbsp; &nbsp; &nbsp; &nbsp; dll/miniwget.o dll/minixml.o dll/igd_desc_parse.o dll/minisoap.o dll/min
  <br> iupnpc.o dll/upnpreplyparse.o dll/upnpcommands.o dll/upnperrors.o dll/connecthos
  <br> tport.o dll/portlistingparse.o dll/receivedata.o -lws2_32 -liphlpapi
  <br> D:\cifs\mingw32\bin\dlltool: Syntax error in def file miniupnpc.def:5
  <br> D:\cifs\mingw32\bin\dlltool: Syntax error in def file miniupnpc.def:5
  <br> 看看def文件的前面5行，dlltool工具不允许空的library指令，修改一下，在第一行LIBRARY指令后面添加一下库的名字miniupnpc:
  <br> LIBRARY miniupnpc
  <br> ; miniupnpc library
  <br>
  <br>
  <br> EXPORTS
  <br> ; miniupnpc
  <br>
  <br>
  <br> 3) BerkeleyDB
  <br>
  <br>
  <br> 可以考虑直接禁用repmgr模块 --disable-replication,因为这个模块依赖依赖posix的一些系统api，mingw支持不好。
  <br> # Replication can be disabled.
  <br> if test "$db_cv_build_replication" = "yes"; then
  <br>
  <span></span>AC_DEFINE(HAVE_REPLICATION)
  <br>
  <span></span>AH_TEMPLATE(HAVE_REPLICATION,
  <br>
  <span></span>&nbsp; &nbsp;[Define to 1 if building replication support.])
  <br>
  <span></span>ADDITIONAL_OBJS="$ADDITIONAL_OBJS \$(REP_OBJS)"
  <br>
  <br>
  <br>
  <span></span># If we're building replication and detected POSIX threads, build the
  <br>
  <span></span># replication manager.
  <br>
  <span></span>AH_TEMPLATE(HAVE_REPLICATION_THREADS,
  <br>
  <span></span>&nbsp; &nbsp;[Define to 1 if building the Berkeley DB replication framework.])
  <br>
  <br>
  <br>
  <span></span>if test "$ac_cv_header_pthread_h" = yes; then
  <br>
  <span></span>AC_DEFINE(HAVE_REPLICATION_THREADS)
  <br>
  <br>
  <br>
  <span></span># Solaris requires the socket and nsl libraries to build the
  <br>
  <span></span># replication manager. &nbsp;Don't add nsl regardless of the OS,
  <br>
  <span></span># it causes RPC to fail on AIX 4.3.3.
  <br>
  <span></span>case "$host_os" in
  <br>
  <span></span>solaris*)
  <br>
  <span></span>AC_HAVE_LIBRARY(nsl, LIBSO_LIBS="$LIBSO_LIBS -lnsl")
  <br>
  <span></span>AC_HAVE_LIBRARY(socket,
  <br>
  <span></span>&nbsp; &nbsp;LIBSO_LIBS="$LIBSO_LIBS -lsocket");;
  <br>
  <span></span>esac
  <br>
  <span></span>ADDITIONAL_OBJS="$ADDITIONAL_OBJS \$(REPMGR_OBJS)"
  <br>
  <span></span>else
  <br>
  <span></span>ADDITIONAL_OBJS="$ADDITIONAL_OBJS repmgr_stub${o}"
  <br>
  <span></span>fi
  <br> else
  <br>
  <span></span>ADDITIONAL_OBJS="$ADDITIONAL_OBJS rep_stub${o} repmgr_stub${o}"
  <br> fi
  <br>
  <br>
  <br> 4) mingw32在linux交叉编译openssl
  <br>
  <br>
  <br> http://www.blogcompiler.com/2011/12/21/openssl-for-windows/
  <br> http://www.wagner.pp.ru/~vitus/articles/openssl-mingw.html
  <br> 5) 自动脚本
  <br>
  <br>
  <br> for windows native building with mingw64, with GUI, used for client
  <br> # 1) zlib
  <br> make install -f win32/Makefile.gcc \
  <br> DESTDIR=/usr/local/zlib-1.2.8/ \
  <br> INCLUDE_PATH=include \
  <br> LIBRARY_PATH=lib \
  <br> BINARY_PATH=bin
  <br>
  <br>
  <br> # 2) libpng
  <br> ./configure --prefix=/usr/local/libpng-1.6.9 \
  <br> --enable-shared=no \
  <br> --enable-static=yes
  <br>
  <br>
  <br> # 3) qrencode&nbsp;
  <br> ./configure --prefix=/usr/local/qrencode-3.4.3 \
  <br> --enable-shared=no \
  <br> --enable-static=yes \
  <br> png_CFLAGS="-I/usr/local/libpng-1.6.9/include" \
  <br> png_LIBS="-L/usr/local/libpng-1.6.9/lib -lpng16"
  <br>
  <br>
  <br> # 4) protobuf
  <br> ./configure --prefix=/usr/local/protobuf-2.5.0 \
  <br> --enable-static=yes \
  <br> --enable-shared=no
  <br>
  <br>
  <br> # 5) BerkeleyDB
  <br> cd build_unix &amp;&amp; sh ../dist/configure \
  <br> --enable-mingw \
  <br> --enable-cxx \
  <br> --disable-replication
  <br>
  <br>
  <br> # 6) miniupnpc
  <br> make -f Makefile.mingw &amp;&amp; mkdir miniupnpc &amp;&amp; cp *.h miniupnpc&nbsp;
  <br>
  <br>
  <br> # 7) OpenSSL
  <br> ./config \
  <br> no-shared \
  <br> no-threads \
  <br> no-asm \
  <br> no-zlib \
  <br> --prefix=/usr/local/ssl \
  <br> &amp;&amp; make &amp;&amp; make install
  <br>
  <br>
  <br> # 8) Boost
  <br> b2 install --prefix=/usr/local/boost-1.53 \
  <br> toolset=gcc \
  <br> link=shared \
  <br> variant=release \
  <br> runtime-link=shared \
  <br> threading=multi \
  <br> --without-mpi \
  <br> --without-python \
  <br> --without-wave \
  <br> --without-graph \
  <br> --without-graph_parallel&nbsp;
  <br>
  <br>
  <br> # 9) qt4
  <br> configure.exe \
  <br> &nbsp; &nbsp; -I "/usr/local/ssl/include" \
  <br> &nbsp; &nbsp; -L "/usr/local/ssl/lib" \
  <br> &nbsp; &nbsp; -l ssl \
  <br> &nbsp; &nbsp; -l crypto \
  <br> &nbsp; &nbsp; -release \
  <br> &nbsp; &nbsp; -opensource \
  <br> &nbsp; &nbsp; -confirm-license \
  <br> &nbsp; &nbsp; -static \
  <br> &nbsp; &nbsp; -no-ltcg \
  <br> &nbsp; &nbsp; -no-fast \
  <br> &nbsp; &nbsp; -exceptions \
  <br> &nbsp; &nbsp; -accessibility \
  <br> &nbsp; &nbsp; -stl \
  <br> &nbsp; &nbsp; -no-sql-sqlite \
  <br> &nbsp; &nbsp; -no-qt3support \
  <br> &nbsp; &nbsp; -no-opengl \
  <br> &nbsp; &nbsp; -no-openvg \
  <br> &nbsp; &nbsp; -platform win32-g++ \
  <br> &nbsp; &nbsp; -no-system-proxies \
  <br> &nbsp; &nbsp; -qt-zlib \
  <br> &nbsp; &nbsp; -no-gif \
  <br> &nbsp; &nbsp; -qt-libpng \
  <br> &nbsp; &nbsp; -no-libmng \
  <br> &nbsp; &nbsp; -no-libtiff \
  <br> &nbsp; &nbsp; -qt-libjpeg \
  <br> &nbsp; &nbsp; -no-dsp \
  <br> &nbsp; &nbsp; -no-vcproj \
  <br> &nbsp; &nbsp; -no-incredibuild-xge \
  <br> &nbsp; &nbsp; -plugin-manifests \
  <br> &nbsp; &nbsp; -qmake \
  <br> &nbsp; &nbsp; -process -nomake demos -nomake examples -nomake tools \
  <br> &nbsp; &nbsp; -no-rtti \
  <br> &nbsp; &nbsp; -no-mmx \
  <br> &nbsp; &nbsp; -no-3dnow \
  <br> &nbsp; &nbsp; -no-sse \
  <br> &nbsp; &nbsp; -no-sse2 \
  <br> &nbsp; &nbsp; -openssl \
  <br> &nbsp; &nbsp; -no-dbus \
  <br> &nbsp; &nbsp; -no-phonon -no-phonon-backend \
  <br> &nbsp; &nbsp; -no-multimedia -no-audio-backend \
  <br> &nbsp; &nbsp; -no-webkit \
  <br> &nbsp; &nbsp; -no-script -no-scripttools -no-declarative \
  <br> &nbsp; &nbsp; -arch windows \
  <br> &nbsp; &nbsp; -no-style-plastique \
  <br> &nbsp; &nbsp; -no-style-windowsxp -no-style-windowsvista \
  <br> &nbsp; &nbsp; -no-style-cleanlooks -no-style-cde \
  <br> &nbsp; &nbsp; -no-style-motif \
  <br> &nbsp; &nbsp; -no-native-gestures \
  <br> &nbsp; &nbsp; -saveconfig csdnbuild &nbsp; &nbsp;
  <br>
  <br>
  <br> # 10)
  <br> export DEPEND_HOME=/usr/local
  <br> export MAKENSIS_HOME=${DEPEND_HOME}/nsis-2.46
  <br> export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/include
  <br> export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB.4.8/lib
  <br> export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.55
  <br> export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.55/include/boost-1_55
  <br> export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.55/lib
  <br> export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.9/include
  <br> export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.9/lib
  <br> export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include
  <br> export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib
  <br> export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin
  <br> export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include
  <br> export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib
  <br> export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include
  <br> export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib
  <br> export QT_BIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/bin
  <br> export QT_INC_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/include
  <br> export QT_LIB_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/lib
  <br> export QT_PLUGIN_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins
  <br> export QT_CODECS_HOME=${DEPEND_HOME}/qt-4.8.5-mingw32-4.8.1/plugins/codecs
  <br> export SSL_INC_HOME=${DEPEND_HOME}/ssl/include
  <br> export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib
  <br> export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include
  <br> export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib
  <br> export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include
  <br> export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib
  <br> export PATH=${PATH}:${MAKENSIS_HOME}
  <br> ./configure \
  <br> &nbsp; &nbsp; --enable-wallet \
  <br> &nbsp; &nbsp; --disable-tests \
  <br> &nbsp; &nbsp; --disable-ipv6 \
  <br> &nbsp; &nbsp; --disable-ccache \
  <br> &nbsp; &nbsp; --with-boost="${BOOST_TOP_HOME}" \
  <br> &nbsp; &nbsp; --with-qrencode=yes \
  <br> &nbsp; &nbsp; --with-miniupnpc=yes \
  <br> &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \
  <br> &nbsp; &nbsp; --with-cli=yes \
  <br> &nbsp; &nbsp; --with-daemon=yes \
  <br> &nbsp; &nbsp; --with-gui=qt4 \
  <br> &nbsp; &nbsp; --with-qt-incdir=${QT_INC_HOME} \
  <br> &nbsp; &nbsp; --with-qt-libdir=${QT_LIB_HOME} \
  <br> &nbsp; &nbsp; --with-qt-bindir=${QT_BIN_HOME} \
  <br> &nbsp; &nbsp; --with-qt-plugindir=${QT_PLUGIN_HOME} \
  <br> &nbsp; &nbsp; CPPFLAGS="-w -g -O0 -I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}" \
  <br> &nbsp; &nbsp; LDFLAGS="-L${QR_LIB_HOME} -L${QT_CODECS_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}"
  <br>
  <br>
  <br> for linux native building with gcc, without gui, used for mining and service.
  <br> # 1) Boost
  <br> ./b2 install --prefix=/root/harrywu/build/3rd/boost toolset=gcc variant=release link=static threading=multi runtime-link=static --without-graph --without-graph_parallel --without-mpi --without-python --without-regex --without-wave
  <br>
  <br>
  <br> # 2) BerkeleyDB
  <br> cd build_unix &amp;&amp; ../dist/configure --prefix=/root/harrywu/build/3rd/bdb48 --enable-static=yes --enable-shared=no --enable-cxx --disable-replication --disable-debug
  <br>
  <br>
  <br> # 3) miniupnpc
  <br> make DESTDIR=/root/harrywu/build/3rd/miniupnpc-1.9.0 INSTALLPREFIX= install
  <br>
  <br>
  <br> # 4) protobuf
  <br> ./configure --prefix=/root/harrywu/build/3rd/protobuf-2.5.0 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz
  <br>
  <br>
  <br> # 5) qrencode
  <br> ./configure --prefix=/root/harrywu/build/3rd/qrencode-3.4.3 --enable-shared=no --enable-static=yes png_CFLAGS=-I/root/harrywu/build/3rd/libpng-1.6.10/ png_LIBS=-L/root/harrywu/build/3rd/libpng-1.6.10/lib/ -lpng16
  <br>
  <br>
  <br> # 6) ssl
  <br> ./config no-threads no-shared no-zlib no-asm --prefix=/root/harrywu/build/3rd/ssl
  <br>
  <br>
  <br> # 7) zlib
  <br> ./configure --prefix=/root/harrywu/build/3rd/zlib-1.2.8 --static
  <br>
  <br>
  <br> # 8) libpng
  <br> ./configure --prefix=/root/harrywu/build/3rd/libpng-1.6.10 --enable-shared=no --enable-static=yes CPPFLAGS=-I/root/harrywu/build/3rd/zlib-1.2.8/include/ LDFLAGS=-L/root/harrywu/build/3rd/zlib-1.2.8/lib LIBS=-lz
  <br>
  <br>
  <br> # 9) qt missing
  <br>
  <br>
  <br> # 10) Bitcoin
  <br> export DEPEND_HOME=/root/harrywu/build/3rd
  <br> export BDB_INC_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/include
  <br> export BDB_LIB_HOME=${DEPEND_HOME}/BerkeleyDB-4.8.0/lib
  <br> export BOOST_TOP_HOME=${DEPEND_HOME}/boost-1.53
  <br> export BOOST_INC_HOME=${DEPEND_HOME}/boost-1.53/include/boost-1_55
  <br> export BOOST_LIB_HOME=${DEPEND_HOME}/boost-1.53/lib
  <br> export PNG_INC_HOME=${DEPEND_HOME}/libpng-1.6.10/include
  <br> export PNG_LIB_HOME=${DEPEND_HOME}/libpng-1.6.10/lib
  <br> export MINIUPNPC_INC_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/include
  <br> export MINIUPNPC_LIB_HOME=${DEPEND_HOME}/miniupnpc-1.9.0/lib
  <br> export PROTOC_BIN_HOME=${DEPEND_HOME}/protobuf-2.5.0/bin
  <br> export PROTOC_INC_HOME=${DEPEND_HOME}/protobuf-2.5.0/include
  <br> export PROTOC_LIB_HOME=${DEPEND_HOME}/protobuf-2.5.0/lib
  <br> export QR_INC_HOME=${DEPEND_HOME}/qrencode-3.4.3/include
  <br> export QR_LIB_HOME=${DEPEND_HOME}/qrencode-3.4.3/lib
  <br> export SSL_INC_HOME=${DEPEND_HOME}/ssl/include
  <br> export SSL_LIB_HOME=${DEPEND_HOME}/ssl/lib
  <br> export CRYPTO_INC_HOME=${DEPEND_HOME}/ssl/include
  <br> export CRYPTO_LIB_HOME=${DEPEND_HOME}/ssl/lib
  <br> export ZLIB_INC_HOME=${DEPEND_HOME}/zlib-1.2.8/include
  <br> export ZLIB_LIB_HOME=${DEPEND_HOME}/zlib-1.2.8/lib
  <br> ./configure \
  <br> &nbsp; &nbsp; --enable-wallet \
  <br> &nbsp; &nbsp; --disable-tests \
  <br> &nbsp; &nbsp; --disable-ipv6 \
  <br> &nbsp; &nbsp; --disable-ccache \
  <br> &nbsp; &nbsp; --with-boost="${BOOST_TOP_HOME}" \
  <br> &nbsp; &nbsp; --with-qrencode=yes \
  <br> &nbsp; &nbsp; --with-miniupnpc=yes \
  <br> &nbsp; &nbsp; --with-protoc-bindir=${PROTOC_BIN_HOME} \
  <br> &nbsp; &nbsp; --with-cli=yes \
  <br> &nbsp; &nbsp; --with-daemon=yes \
  <br> &nbsp; &nbsp; --with-gui=no \
  <br> &nbsp; &nbsp; CPPFLAGS="-I${QR_INC_HOME} -I${PNG_INC_HOME} -I${PROTOC_INC_HOME} -I${SSL_INC_HOME} -I${CRYPTO_INC_HOME} -I${BDB_INC_HOME} -I${MINIUPNPC_INC_HOME} -I${BOOST_INC_HOME} -I${ZLIB_INC_HOME}" \
  <br> &nbsp; &nbsp; LDFLAGS="-L${QR_LIB_HOME} -L${PNG_LIB_HOME} -L${PROTOC_LIB_HOME} -L${SSL_LIB_HOME} -L${CRYPTO_LIB_HOME} -L${BDB_LIB_HOME} -L${MINIUPNPC_LIB_HOME} -L${ZLIB_LIB_HOME}" \
  <br> LIBS="-lrt -ldl" 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/jQQ53016353/article/details/75006166,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/jQQ53016353/article/details/75006166,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
