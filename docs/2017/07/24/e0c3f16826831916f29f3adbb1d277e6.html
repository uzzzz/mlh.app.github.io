<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>利用MACD指标进阶使用技巧计算交易信号 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="利用MACD指标进阶使用技巧计算交易信号" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="&nbsp; １．MACD策略简述与评价标准 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原始策略解释与评价： 是指利用MACD指标的数值，主要是MACD值来决定股票的买入和卖出。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算依赖于用EMA_long_window,EMA_Short_window, DIFF_window 3个参数计算收盘价的移动平均。此策略的问题是3个指标的选择是开放的，没有针对所有股票都适用的一般标准。所以一般情况下难以判断到底哪种指标组合最适合所持有的股票。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原有的买卖指标为DEA和DIFF指标的交叉。 DIFF指标上穿DEA指标为金叉，是买入信号。DIFF指标下穿DEA为死叉，是卖出信号。这两种信号概念上正确，且明确易捕捉。但缺点是敏感度比较差，延迟较高。尤其是卖出信号，通常股价已经跌的很多了，移动平均才会出现死叉。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进阶策略是指利用MACD的概念计算交易信号，但在两个方面做出改进： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算参数的选择： 穷举计算参数组合，并计算所有组合所能最终产生的利润。选择利润最高的组合作为该股票的MACD指标计算参数。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从两方面改进MACD原有的买卖信号： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提高信号的识别率，由原有的金叉死叉信号，改为MACD值变化策略，即监视MACD的阶段极值和现值，一旦极值与现值的差达到阈值，即判断为买入或卖出信号，此策略比金叉死叉敏感很多。 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;降低信号敏感性：为了防止上述策略过于敏感，导致交易信号过于频繁出现，设置信号有效性指标，以过滤变化微小的信号，降低交易频率。 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可看出，敏感度是双刃剑，敏感度高会对微小变化产生反应，降低对有效信号的判断标准。敏感度低会忽略一些有效信号，降低收益率。上述两种指标也需要循环测试，最终找到最优的组合。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易规则： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易的一些初始量的设定： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;初始参与资金量 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单次买入股数 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在持股上限：买入后的在持股数不得超过上限。可以通过在持股上限限制买入的次数，如设定上限在两倍单次买入数与三倍单次买入数之间，就只允许发生两次的连续买入。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易方法的设定：分次买入，全部卖出。 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入：在满足现值的条件下，买入单次买入股数。 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有足够的资金 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入后的总在持股数&lt;在持股上限 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出：一次卖出所有股票 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如此设定交易规则的目的是要最大化避免股价下跌带来的损失，尽量争取在股价进入下跌通道前，让股票都变为现金。 &nbsp; d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;策略评价标准我选择用总资产比率：最后一次交易后总资产与取第一个股价数据时的总资产的比率。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参与策略的初始资金量会对这个比率有一定的影响，但由于我希望的是通过对比选择最佳策略，所以所有策略使用的初始资金量是一致的，因此对策略的选择没有影响。但如果希望考虑的是收益率，这个指标就还需要斟酌，尤其当与大盘指标进行比较的时候。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另外，还是觉得这个指标只关注的最终的目标，对于过程没有体现，应该让以下指标也参与到策略的优秀度评价里： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;资产比率曲线 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线是否平滑 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线的一阶导数是否一直为正，数值是多少（收益率是持续增加的），此项将作为下一步的策略判断依据，重点围绕。 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易频率-&gt;指标的敏感度 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易次数-&gt;交易费用 4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;平均收益率 5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;是否经常触及T+1策略的限制 &nbsp; ２．股票的选择标准 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应选择股价有一定的波幅和波动频率的股票，应避免大盘蓝筹股，因为大盘股体量太大，一般情况下股价的波动都不明显，在MACD值有效性指标的过滤下，很难找到合适的交易指标以生成交易信号。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应避免经常性出现剧烈波动的股票，如涨跌停，因为剧烈波动会导致指标的计算跟不上股价的变化，且即便计算出交易信号，也有可能因为超大量的买卖导致我们无法实现交易。 &nbsp; ３．分析周期与样本量的选择 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;股票的分析周期我选择的是30分钟数据，即从9：30（不包括）开始每30分钟计算一次open, high, low, close prices . 30分钟数据的选择处于两方面考虑。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一是要让交易信号的计算的频率能跟上股价变化，选择30分钟数据，一个交易日会出现8个数据，其中可以参与计算的有7个，3：00 PM的数据产生信号后也无法实施。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;二是避免计算过于频繁，因为国内股市有T+1的政策，如果计算过于频繁，会经常出现一天内先买后卖的情况，这种信号是无意义的。虽然可以通过处理计算第二个交易日一早的补卖信号，但是第二个交易日的MACD值已经变化，补卖信号和MACD信号计算策略是不一致的。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;样本数据量方面，我选择使用最近3个月的m30交易数据，大约550条记录左右。再远的历史数据可能不能正确代表目前的股价变化趋势。 &nbsp; ４．MACD指标的选择 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在合理的范围内对EMA_long, EMA_short, 和DIF_window 的组合穷举，共穷举了3689种组合。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注意事项： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long &gt; EMA_short &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long != EMA_short &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&lt; EMA_long &lt; 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&lt; EMA_short &lt; 15 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 &lt; DIF &lt; 9 &nbsp; ５．MACD买入信号计算 买入信号分为3种： a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入：异号买入也就是传统的MACD金叉，只是变为单纯的依靠MACD值计算，异号买入关注的是MACD &gt;0 阶段的涨幅利益。当t-1时刻的MACD(t-1) &lt;0，t时刻的MACD(t) &gt;0 时, 即为异号, 视为有买入机会。但为了过滤MACD值过于微小的变化，为MACD值加了均值过滤器MACD_AVG（详见MACD信号有效性部分），规定只有MACD &gt; MACD_AVG才是有效信号，释放买入信号，否则进入待考察模式。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号补买：当异号但是进入待考察模式时，我们判断，大多数情况下，如果股价确实进入上升通道，则t+1日的MACD值会高于t日MACD值，且上涨幅度大于一个阈值。所以，如果MACD(t+1) &gt; MACD(t), 就释放买入信号，否则认为只是小幅震荡，放弃买入，为一定的比率以确定阈值（详见信号有效性）。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;激进买入：这是比异号买入激进的买入方式，目的是获取MACD &lt;0 阶段的利益，存在一定的风险。当股价在下降通道时，如果MACD(t) &gt; MACD(t-1)， 则股价有可能从下降通道转入上升通道。为一定的比率以确定有多大概率转入上升通道（详见信号有效性）。激进买入是在MACD&lt;0时的判断，要注意符号。 d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入是最基本的买入方式，在实现异号买入的基础上，实施异号补买和激进买入。异号买入和激进买入联合可能会在一个上升通道内连续释放两次买入信号，要在买入交易方法中有所调整，以支持连续买入的可能。 e)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入信号释放后，系统将记录本上升通道内的MACD最大值，以用于计算卖出信号。 ６．MACD卖出信号的计算 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号的计算方式彻底放弃的原配的死叉模式，因为死叉模式反应相对迟缓，在实际股价下跌到出现死叉的过程中，会随时大部分利润。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;收缩卖出: 收缩卖出的模式监控上升通道内的MACD_MAX最大值和t时刻的MACD(t)值，当 MACD(t) &lt; &nbsp;MACD_MAX时， 即认为上升通道已经结束，可以释放卖出信号，确定阈值。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号有可能会和股市的T+1策略冲突，需要进一步处理。 &nbsp; ７．MACD信号有效性 信号有效性主要有四个部分： a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD的均值MACD_AVG： 此处均值不是简单的MACD值的算术平均。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为MACD_AVG只在MACD&gt;0时的买入阶段涉及，因此基本值的计算是MACD绝对值的算术平均。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用绝对值的算术平均值过于死板，不具有调节的能力，因此为该值扩展一下定义。扩展为使得X%的数据都有效的值，X （0-100）。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;即 X% MACD &gt; MACD_AVG, 如此， 可根据X调节MACD_AVG的值，以过滤数据。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于异号补买，可调节为n倍的MACD(t)的值，&nbsp;我认为比较合理。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于激进买入，其实际作用和一致，用于限定MACD(t)和MACD(t+1)的比值，只有比值大于某个特定值，才认为是进入上升通道，处理MACD值&lt; 0时的情况。 d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于收缩卖出，和前两个变量一致，用于限定MACD(t)和MACD(t+1)的比率，只有小于某个特定值时，才认为是进入下将通道。 &nbsp; 8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略对交易信号的影响与应对 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略会导致当天的买入股票无法在当天卖出。 策略一旦遇到这种情况将标记一个t日的补卖信号。并在t+1天的第一个计算点10：00 AM重点关注，如果在tri 的补卖信号和t+1日第一个计算点之间没有其它的买入或卖出信号，就释放一个t+1日 10:00AM的卖出信号。以最大限度的避免损失。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t+1的处理会受到周末和节假日的影响，要加以留意。 &nbsp; 9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进一步的思考 下一步的想法是用机器学习的方法寻找最佳的策略： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以多项式回归或人工神经网络为工具。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以总资产比率曲线的一阶导数持续最大化增加为目标。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以一阶导数&gt; 0 为条件以限制平滑性。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以MACD策略为方法根据上述目标和限制设计拟合一个函数。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以股价为输入 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vi.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;计算函数的各个参数，以确定最佳的买卖时机。 阅读更多" />
<meta property="og:description" content="&nbsp; １．MACD策略简述与评价标准 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原始策略解释与评价： 是指利用MACD指标的数值，主要是MACD值来决定股票的买入和卖出。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算依赖于用EMA_long_window,EMA_Short_window, DIFF_window 3个参数计算收盘价的移动平均。此策略的问题是3个指标的选择是开放的，没有针对所有股票都适用的一般标准。所以一般情况下难以判断到底哪种指标组合最适合所持有的股票。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原有的买卖指标为DEA和DIFF指标的交叉。 DIFF指标上穿DEA指标为金叉，是买入信号。DIFF指标下穿DEA为死叉，是卖出信号。这两种信号概念上正确，且明确易捕捉。但缺点是敏感度比较差，延迟较高。尤其是卖出信号，通常股价已经跌的很多了，移动平均才会出现死叉。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进阶策略是指利用MACD的概念计算交易信号，但在两个方面做出改进： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算参数的选择： 穷举计算参数组合，并计算所有组合所能最终产生的利润。选择利润最高的组合作为该股票的MACD指标计算参数。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从两方面改进MACD原有的买卖信号： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提高信号的识别率，由原有的金叉死叉信号，改为MACD值变化策略，即监视MACD的阶段极值和现值，一旦极值与现值的差达到阈值，即判断为买入或卖出信号，此策略比金叉死叉敏感很多。 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;降低信号敏感性：为了防止上述策略过于敏感，导致交易信号过于频繁出现，设置信号有效性指标，以过滤变化微小的信号，降低交易频率。 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可看出，敏感度是双刃剑，敏感度高会对微小变化产生反应，降低对有效信号的判断标准。敏感度低会忽略一些有效信号，降低收益率。上述两种指标也需要循环测试，最终找到最优的组合。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易规则： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易的一些初始量的设定： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;初始参与资金量 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单次买入股数 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在持股上限：买入后的在持股数不得超过上限。可以通过在持股上限限制买入的次数，如设定上限在两倍单次买入数与三倍单次买入数之间，就只允许发生两次的连续买入。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易方法的设定：分次买入，全部卖出。 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入：在满足现值的条件下，买入单次买入股数。 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有足够的资金 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入后的总在持股数&lt;在持股上限 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出：一次卖出所有股票 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如此设定交易规则的目的是要最大化避免股价下跌带来的损失，尽量争取在股价进入下跌通道前，让股票都变为现金。 &nbsp; d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;策略评价标准我选择用总资产比率：最后一次交易后总资产与取第一个股价数据时的总资产的比率。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参与策略的初始资金量会对这个比率有一定的影响，但由于我希望的是通过对比选择最佳策略，所以所有策略使用的初始资金量是一致的，因此对策略的选择没有影响。但如果希望考虑的是收益率，这个指标就还需要斟酌，尤其当与大盘指标进行比较的时候。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另外，还是觉得这个指标只关注的最终的目标，对于过程没有体现，应该让以下指标也参与到策略的优秀度评价里： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;资产比率曲线 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线是否平滑 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线的一阶导数是否一直为正，数值是多少（收益率是持续增加的），此项将作为下一步的策略判断依据，重点围绕。 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易频率-&gt;指标的敏感度 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易次数-&gt;交易费用 4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;平均收益率 5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;是否经常触及T+1策略的限制 &nbsp; ２．股票的选择标准 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应选择股价有一定的波幅和波动频率的股票，应避免大盘蓝筹股，因为大盘股体量太大，一般情况下股价的波动都不明显，在MACD值有效性指标的过滤下，很难找到合适的交易指标以生成交易信号。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应避免经常性出现剧烈波动的股票，如涨跌停，因为剧烈波动会导致指标的计算跟不上股价的变化，且即便计算出交易信号，也有可能因为超大量的买卖导致我们无法实现交易。 &nbsp; ３．分析周期与样本量的选择 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;股票的分析周期我选择的是30分钟数据，即从9：30（不包括）开始每30分钟计算一次open, high, low, close prices . 30分钟数据的选择处于两方面考虑。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一是要让交易信号的计算的频率能跟上股价变化，选择30分钟数据，一个交易日会出现8个数据，其中可以参与计算的有7个，3：00 PM的数据产生信号后也无法实施。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;二是避免计算过于频繁，因为国内股市有T+1的政策，如果计算过于频繁，会经常出现一天内先买后卖的情况，这种信号是无意义的。虽然可以通过处理计算第二个交易日一早的补卖信号，但是第二个交易日的MACD值已经变化，补卖信号和MACD信号计算策略是不一致的。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;样本数据量方面，我选择使用最近3个月的m30交易数据，大约550条记录左右。再远的历史数据可能不能正确代表目前的股价变化趋势。 &nbsp; ４．MACD指标的选择 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在合理的范围内对EMA_long, EMA_short, 和DIF_window 的组合穷举，共穷举了3689种组合。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注意事项： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long &gt; EMA_short &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long != EMA_short &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&lt; EMA_long &lt; 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&lt; EMA_short &lt; 15 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 &lt; DIF &lt; 9 &nbsp; ５．MACD买入信号计算 买入信号分为3种： a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入：异号买入也就是传统的MACD金叉，只是变为单纯的依靠MACD值计算，异号买入关注的是MACD &gt;0 阶段的涨幅利益。当t-1时刻的MACD(t-1) &lt;0，t时刻的MACD(t) &gt;0 时, 即为异号, 视为有买入机会。但为了过滤MACD值过于微小的变化，为MACD值加了均值过滤器MACD_AVG（详见MACD信号有效性部分），规定只有MACD &gt; MACD_AVG才是有效信号，释放买入信号，否则进入待考察模式。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号补买：当异号但是进入待考察模式时，我们判断，大多数情况下，如果股价确实进入上升通道，则t+1日的MACD值会高于t日MACD值，且上涨幅度大于一个阈值。所以，如果MACD(t+1) &gt; MACD(t), 就释放买入信号，否则认为只是小幅震荡，放弃买入，为一定的比率以确定阈值（详见信号有效性）。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;激进买入：这是比异号买入激进的买入方式，目的是获取MACD &lt;0 阶段的利益，存在一定的风险。当股价在下降通道时，如果MACD(t) &gt; MACD(t-1)， 则股价有可能从下降通道转入上升通道。为一定的比率以确定有多大概率转入上升通道（详见信号有效性）。激进买入是在MACD&lt;0时的判断，要注意符号。 d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入是最基本的买入方式，在实现异号买入的基础上，实施异号补买和激进买入。异号买入和激进买入联合可能会在一个上升通道内连续释放两次买入信号，要在买入交易方法中有所调整，以支持连续买入的可能。 e)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入信号释放后，系统将记录本上升通道内的MACD最大值，以用于计算卖出信号。 ６．MACD卖出信号的计算 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号的计算方式彻底放弃的原配的死叉模式，因为死叉模式反应相对迟缓，在实际股价下跌到出现死叉的过程中，会随时大部分利润。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;收缩卖出: 收缩卖出的模式监控上升通道内的MACD_MAX最大值和t时刻的MACD(t)值，当 MACD(t) &lt; &nbsp;MACD_MAX时， 即认为上升通道已经结束，可以释放卖出信号，确定阈值。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号有可能会和股市的T+1策略冲突，需要进一步处理。 &nbsp; ７．MACD信号有效性 信号有效性主要有四个部分： a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD的均值MACD_AVG： 此处均值不是简单的MACD值的算术平均。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为MACD_AVG只在MACD&gt;0时的买入阶段涉及，因此基本值的计算是MACD绝对值的算术平均。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用绝对值的算术平均值过于死板，不具有调节的能力，因此为该值扩展一下定义。扩展为使得X%的数据都有效的值，X （0-100）。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;即 X% MACD &gt; MACD_AVG, 如此， 可根据X调节MACD_AVG的值，以过滤数据。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于异号补买，可调节为n倍的MACD(t)的值，&nbsp;我认为比较合理。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于激进买入，其实际作用和一致，用于限定MACD(t)和MACD(t+1)的比值，只有比值大于某个特定值，才认为是进入上升通道，处理MACD值&lt; 0时的情况。 d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于收缩卖出，和前两个变量一致，用于限定MACD(t)和MACD(t+1)的比率，只有小于某个特定值时，才认为是进入下将通道。 &nbsp; 8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略对交易信号的影响与应对 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略会导致当天的买入股票无法在当天卖出。 策略一旦遇到这种情况将标记一个t日的补卖信号。并在t+1天的第一个计算点10：00 AM重点关注，如果在tri 的补卖信号和t+1日第一个计算点之间没有其它的买入或卖出信号，就释放一个t+1日 10:00AM的卖出信号。以最大限度的避免损失。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t+1的处理会受到周末和节假日的影响，要加以留意。 &nbsp; 9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进一步的思考 下一步的想法是用机器学习的方法寻找最佳的策略： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以多项式回归或人工神经网络为工具。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以总资产比率曲线的一阶导数持续最大化增加为目标。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以一阶导数&gt; 0 为条件以限制平滑性。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以MACD策略为方法根据上述目标和限制设计拟合一个函数。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以股价为输入 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vi.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;计算函数的各个参数，以确定最佳的买卖时机。 阅读更多" />
<link rel="canonical" href="https://mlh.app/2017/07/24/e0c3f16826831916f29f3adbb1d277e6.html" />
<meta property="og:url" content="https://mlh.app/2017/07/24/e0c3f16826831916f29f3adbb1d277e6.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-07-24T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"&nbsp; １．MACD策略简述与评价标准 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原始策略解释与评价： 是指利用MACD指标的数值，主要是MACD值来决定股票的买入和卖出。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算依赖于用EMA_long_window,EMA_Short_window, DIFF_window 3个参数计算收盘价的移动平均。此策略的问题是3个指标的选择是开放的，没有针对所有股票都适用的一般标准。所以一般情况下难以判断到底哪种指标组合最适合所持有的股票。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原有的买卖指标为DEA和DIFF指标的交叉。 DIFF指标上穿DEA指标为金叉，是买入信号。DIFF指标下穿DEA为死叉，是卖出信号。这两种信号概念上正确，且明确易捕捉。但缺点是敏感度比较差，延迟较高。尤其是卖出信号，通常股价已经跌的很多了，移动平均才会出现死叉。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进阶策略是指利用MACD的概念计算交易信号，但在两个方面做出改进： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算参数的选择： 穷举计算参数组合，并计算所有组合所能最终产生的利润。选择利润最高的组合作为该股票的MACD指标计算参数。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从两方面改进MACD原有的买卖信号： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提高信号的识别率，由原有的金叉死叉信号，改为MACD值变化策略，即监视MACD的阶段极值和现值，一旦极值与现值的差达到阈值，即判断为买入或卖出信号，此策略比金叉死叉敏感很多。 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;降低信号敏感性：为了防止上述策略过于敏感，导致交易信号过于频繁出现，设置信号有效性指标，以过滤变化微小的信号，降低交易频率。 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可看出，敏感度是双刃剑，敏感度高会对微小变化产生反应，降低对有效信号的判断标准。敏感度低会忽略一些有效信号，降低收益率。上述两种指标也需要循环测试，最终找到最优的组合。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易规则： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易的一些初始量的设定： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;初始参与资金量 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单次买入股数 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在持股上限：买入后的在持股数不得超过上限。可以通过在持股上限限制买入的次数，如设定上限在两倍单次买入数与三倍单次买入数之间，就只允许发生两次的连续买入。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易方法的设定：分次买入，全部卖出。 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入：在满足现值的条件下，买入单次买入股数。 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有足够的资金 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入后的总在持股数&lt;在持股上限 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出：一次卖出所有股票 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如此设定交易规则的目的是要最大化避免股价下跌带来的损失，尽量争取在股价进入下跌通道前，让股票都变为现金。 &nbsp; d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;策略评价标准我选择用总资产比率：最后一次交易后总资产与取第一个股价数据时的总资产的比率。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参与策略的初始资金量会对这个比率有一定的影响，但由于我希望的是通过对比选择最佳策略，所以所有策略使用的初始资金量是一致的，因此对策略的选择没有影响。但如果希望考虑的是收益率，这个指标就还需要斟酌，尤其当与大盘指标进行比较的时候。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另外，还是觉得这个指标只关注的最终的目标，对于过程没有体现，应该让以下指标也参与到策略的优秀度评价里： 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;资产比率曲线 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线是否平滑 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线的一阶导数是否一直为正，数值是多少（收益率是持续增加的），此项将作为下一步的策略判断依据，重点围绕。 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易频率-&gt;指标的敏感度 3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易次数-&gt;交易费用 4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;平均收益率 5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;是否经常触及T+1策略的限制 &nbsp; ２．股票的选择标准 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应选择股价有一定的波幅和波动频率的股票，应避免大盘蓝筹股，因为大盘股体量太大，一般情况下股价的波动都不明显，在MACD值有效性指标的过滤下，很难找到合适的交易指标以生成交易信号。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应避免经常性出现剧烈波动的股票，如涨跌停，因为剧烈波动会导致指标的计算跟不上股价的变化，且即便计算出交易信号，也有可能因为超大量的买卖导致我们无法实现交易。 &nbsp; ３．分析周期与样本量的选择 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;股票的分析周期我选择的是30分钟数据，即从9：30（不包括）开始每30分钟计算一次open, high, low, close prices . 30分钟数据的选择处于两方面考虑。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一是要让交易信号的计算的频率能跟上股价变化，选择30分钟数据，一个交易日会出现8个数据，其中可以参与计算的有7个，3：00 PM的数据产生信号后也无法实施。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;二是避免计算过于频繁，因为国内股市有T+1的政策，如果计算过于频繁，会经常出现一天内先买后卖的情况，这种信号是无意义的。虽然可以通过处理计算第二个交易日一早的补卖信号，但是第二个交易日的MACD值已经变化，补卖信号和MACD信号计算策略是不一致的。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;样本数据量方面，我选择使用最近3个月的m30交易数据，大约550条记录左右。再远的历史数据可能不能正确代表目前的股价变化趋势。 &nbsp; ４．MACD指标的选择 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在合理的范围内对EMA_long, EMA_short, 和DIF_window 的组合穷举，共穷举了3689种组合。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注意事项： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long &gt; EMA_short &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long != EMA_short &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&lt; EMA_long &lt; 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&lt; EMA_short &lt; 15 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 &lt; DIF &lt; 9 &nbsp; ５．MACD买入信号计算 买入信号分为3种： a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入：异号买入也就是传统的MACD金叉，只是变为单纯的依靠MACD值计算，异号买入关注的是MACD &gt;0 阶段的涨幅利益。当t-1时刻的MACD(t-1) &lt;0，t时刻的MACD(t) &gt;0 时, 即为异号, 视为有买入机会。但为了过滤MACD值过于微小的变化，为MACD值加了均值过滤器MACD_AVG（详见MACD信号有效性部分），规定只有MACD &gt; MACD_AVG才是有效信号，释放买入信号，否则进入待考察模式。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号补买：当异号但是进入待考察模式时，我们判断，大多数情况下，如果股价确实进入上升通道，则t+1日的MACD值会高于t日MACD值，且上涨幅度大于一个阈值。所以，如果MACD(t+1) &gt; MACD(t), 就释放买入信号，否则认为只是小幅震荡，放弃买入，为一定的比率以确定阈值（详见信号有效性）。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;激进买入：这是比异号买入激进的买入方式，目的是获取MACD &lt;0 阶段的利益，存在一定的风险。当股价在下降通道时，如果MACD(t) &gt; MACD(t-1)， 则股价有可能从下降通道转入上升通道。为一定的比率以确定有多大概率转入上升通道（详见信号有效性）。激进买入是在MACD&lt;0时的判断，要注意符号。 d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入是最基本的买入方式，在实现异号买入的基础上，实施异号补买和激进买入。异号买入和激进买入联合可能会在一个上升通道内连续释放两次买入信号，要在买入交易方法中有所调整，以支持连续买入的可能。 e)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入信号释放后，系统将记录本上升通道内的MACD最大值，以用于计算卖出信号。 ６．MACD卖出信号的计算 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号的计算方式彻底放弃的原配的死叉模式，因为死叉模式反应相对迟缓，在实际股价下跌到出现死叉的过程中，会随时大部分利润。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;收缩卖出: 收缩卖出的模式监控上升通道内的MACD_MAX最大值和t时刻的MACD(t)值，当 MACD(t) &lt; &nbsp;MACD_MAX时， 即认为上升通道已经结束，可以释放卖出信号，确定阈值。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号有可能会和股市的T+1策略冲突，需要进一步处理。 &nbsp; ７．MACD信号有效性 信号有效性主要有四个部分： a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD的均值MACD_AVG： 此处均值不是简单的MACD值的算术平均。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为MACD_AVG只在MACD&gt;0时的买入阶段涉及，因此基本值的计算是MACD绝对值的算术平均。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用绝对值的算术平均值过于死板，不具有调节的能力，因此为该值扩展一下定义。扩展为使得X%的数据都有效的值，X （0-100）。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;即 X% MACD &gt; MACD_AVG, 如此， 可根据X调节MACD_AVG的值，以过滤数据。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于异号补买，可调节为n倍的MACD(t)的值，&nbsp;我认为比较合理。 c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于激进买入，其实际作用和一致，用于限定MACD(t)和MACD(t+1)的比值，只有比值大于某个特定值，才认为是进入上升通道，处理MACD值&lt; 0时的情况。 d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用于收缩卖出，和前两个变量一致，用于限定MACD(t)和MACD(t+1)的比率，只有小于某个特定值时，才认为是进入下将通道。 &nbsp; 8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略对交易信号的影响与应对 a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略会导致当天的买入股票无法在当天卖出。 策略一旦遇到这种情况将标记一个t日的补卖信号。并在t+1天的第一个计算点10：00 AM重点关注，如果在tri 的补卖信号和t+1日第一个计算点之间没有其它的买入或卖出信号，就释放一个t+1日 10:00AM的卖出信号。以最大限度的避免损失。 b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t+1的处理会受到周末和节假日的影响，要加以留意。 &nbsp; 9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进一步的思考 下一步的想法是用机器学习的方法寻找最佳的策略： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以多项式回归或人工神经网络为工具。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以总资产比率曲线的一阶导数持续最大化增加为目标。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以一阶导数&gt; 0 为条件以限制平滑性。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以MACD策略为方法根据上述目标和限制设计拟合一个函数。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以股价为输入 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vi.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;计算函数的各个参数，以确定最佳的买卖时机。 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2017/07/24/e0c3f16826831916f29f3adbb1d277e6.html","headline":"利用MACD指标进阶使用技巧计算交易信号","dateModified":"2017-07-24T00:00:00+08:00","datePublished":"2017-07-24T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2017/07/24/e0c3f16826831916f29f3adbb1d277e6.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>利用MACD指标进阶使用技巧计算交易信号</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>&nbsp;</p> 
  <p>１．MACD策略简述与评价标准</p> 
  <blockquote> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原始策略解释与评价： 是指利用MACD指标的数值，主要是MACD值来决定股票的买入和卖出。</p> 
   <blockquote> 
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算依赖于用EMA_long_window,EMA_Short_window, DIFF_window 3个参数计算收盘价的移动平均。此策略的问题是3个指标的选择是开放的，没有针对所有股票都适用的一般标准。所以一般情况下难以判断到底哪种指标组合最适合所持有的股票。</p> 
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD原有的买卖指标为DEA和DIFF指标的交叉。 DIFF指标上穿DEA指标为金叉，是买入信号。DIFF指标下穿DEA为死叉，是卖出信号。这两种信号概念上正确，且明确易捕捉。但缺点是敏感度比较差，延迟较高。尤其是卖出信号，通常股价已经跌的很多了，移动平均才会出现死叉。</p> 
   </blockquote> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进阶策略是指利用MACD的概念计算交易信号，但在两个方面做出改进：</p> 
   <blockquote> 
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD指标计算参数的选择： 穷举计算参数组合，并计算所有组合所能最终产生的利润。选择利润最高的组合作为该股票的MACD指标计算参数。</p> 
    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;从两方面改进MACD原有的买卖信号：</p> 
    <blockquote> 
     <blockquote> 
      <blockquote> 
       <p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提高信号的识别率，由原有的金叉死叉信号，改为MACD值变化策略，即监视MACD的阶段极值和现值，一旦极值与现值的差达到阈值，即判断为买入或卖出信号，此策略比金叉死叉敏感很多。</p> 
       <p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;降低信号敏感性：为了防止上述策略过于敏感，导致交易信号过于频繁出现，设置信号有效性指标，以过滤变化微小的信号，降低交易频率。</p> 
       <p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可看出，敏感度是双刃剑，敏感度高会对微小变化产生反应，降低对有效信号的判断标准。敏感度低会忽略一些有效信号，降低收益率。上述两种指标也需要循环测试，最终找到最优的组合。</p> 
      </blockquote> 
     </blockquote> 
    </blockquote> 
   </blockquote> 
   <p>c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易规则：</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易的一些初始量的设定：</p> 
   <blockquote> 
    <blockquote> 
     <blockquote> 
      <p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;初始参与资金量</p> 
      <p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单次买入股数</p> 
      <p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在持股上限：买入后的在持股数不得超过上限。可以通过在持股上限限制买入的次数，如设定上限在两倍单次买入数与三倍单次买入数之间，就只允许发生两次的连续买入。</p> 
     </blockquote> 
    </blockquote> 
   </blockquote> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易方法的设定：分次买入，全部卖出。</p> 
   <blockquote> 
    <blockquote> 
     <blockquote> 
      <p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入：在满足现值的条件下，买入单次买入股数。</p> 
      <blockquote> 
       <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有足够的资金</p> 
       <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;买入后的总在持股数&lt;在持股上限</p> 
      </blockquote> 
      <p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出：一次卖出所有股票</p> 
      <p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如此设定交易规则的目的是要最大化避免股价下跌带来的损失，尽量争取在股价进入下跌通道前，让股票都变为现金。</p> 
      <p>&nbsp;</p> 
     </blockquote> 
    </blockquote> 
   </blockquote> 
   <p>d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;策略评价标准我选择用总资产比率：最后一次交易后总资产与取第一个股价数据时的总资产的比率。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;参与策略的初始资金量会对这个比率有一定的影响，但由于我希望的是通过对比选择最佳策略，所以所有策略使用的初始资金量是一致的，因此对策略的选择没有影响。但如果希望考虑的是收益率，这个指标就还需要斟酌，尤其当与大盘指标进行比较的时候。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另外，还是觉得这个指标只关注的最终的目标，对于过程没有体现，应该让以下指标也参与到策略的优秀度评价里：</p> 
   <blockquote> 
    <blockquote> 
     <blockquote> 
      <p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;资产比率曲线</p> 
      <blockquote> 
       <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线是否平滑</p> 
       <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;曲线的一阶导数是否一直为正，数值是多少（收益率是持续增加的），此项将作为下一步的策略判断依据，重点围绕。</p> 
      </blockquote> 
      <p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易频率-&gt;指标的敏感度</p> 
      <p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;交易次数-&gt;交易费用</p> 
      <p>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;平均收益率</p> 
      <p>5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;是否经常触及T+1策略的限制</p> 
     </blockquote> 
    </blockquote> 
   </blockquote> 
  </blockquote> 
  <p>&nbsp;</p> 
  <p>２．股票的选择标准</p> 
  <blockquote> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应选择股价有一定的波幅和波动频率的股票，应避免大盘蓝筹股，因为大盘股体量太大，一般情况下股价的波动都不明显，在MACD值有效性指标的过滤下，很难找到合适的交易指标以生成交易信号。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应避免经常性出现剧烈波动的股票，如涨跌停，因为剧烈波动会导致指标的计算跟不上股价的变化，且即便计算出交易信号，也有可能因为超大量的买卖导致我们无法实现交易。</p> 
  </blockquote> 
  <p>&nbsp;</p> 
  <p>３．分析周期与样本量的选择</p> 
  <blockquote> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;股票的分析周期我选择的是30分钟数据，即从9：30（不包括）开始每30分钟计算一次open, high, low, close prices . 30分钟数据的选择处于两方面考虑。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一是要让交易信号的计算的频率能跟上股价变化，选择30分钟数据，一个交易日会出现8个数据，其中可以参与计算的有7个，3：00 PM的数据产生信号后也无法实施。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;二是避免计算过于频繁，因为国内股市有T+1的政策，如果计算过于频繁，会经常出现一天内先买后卖的情况，这种信号是无意义的。虽然可以通过处理计算第二个交易日一早的补卖信号，但是第二个交易日的MACD值已经变化，补卖信号和MACD信号计算策略是不一致的。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;样本数据量方面，我选择使用最近3个月的m30交易数据，大约550条记录左右。再远的历史数据可能不能正确代表目前的股价变化趋势。</p> 
   <p>&nbsp;</p> 
  </blockquote> 
  <p>４．MACD指标的选择</p> 
  <blockquote> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在合理的范围内对EMA_long, EMA_short, 和DIF_window 的组合穷举，共穷举了3689种组合。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注意事项：</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long &gt; EMA_short</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMA_long != EMA_short</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&lt; EMA_long &lt; 50</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&lt; EMA_short &lt; 15</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 &lt; DIF &lt; 9</p> 
  </blockquote> 
  <p>&nbsp;</p> 
  <p>５．MACD买入信号计算</p> 
  <blockquote> 
   <p>买入信号分为3种：</p> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号买入：异号买入也就是传统的MACD金叉，只是变为单纯的依靠MACD值计算，异号买入关注的是MACD &gt;0 阶段的涨幅利益。当t-1时刻的MACD(t-1) &lt;0，t时刻的MACD(t) &gt;0 时, 即为异号, 视为有买入机会。但为了过滤MACD值过于微小的变化，为MACD值加了均值过滤器MACD_AVG（详见MACD信号有效性部分），规定只有MACD &gt; MACD_AVG才是有效信号，释放买入信号，否则进入待考察模式。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;异号补买：当异号但是进入待考察模式时，我们判断，大多数情况下，如果股价确实进入上升通道，则t+1日的MACD值会高于t日MACD值，且上涨幅度大于一个阈值。所以，如果MACD(t+1) &gt; MACD(t), 就释放买入信号，否则认为只是小幅震荡，放弃买入，<span style="color:#000000;">为一定的比率以确定阈值</span>（详见信号有效性）。</p> 
   <p>c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;激进买入：这是比异号买入激进的买入方式，目的是获取MACD &lt;0 阶段的利益，存在一定的风险。当股价在下降通道时，如果MACD(t) &gt; MACD(t-1)， 则股价有可能从下降通道转入上升通道。<span style="color:#000000;">为一定的比率以确定有多大概率转入上升通道</span>（详见信号有效性）<span style="color:#000000;">。激进买入是在</span><span style="color:#000000;">MACD&lt;0</span><span style="color:#000000;">时的判断，要注意符号。</span></p> 
   <p>d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#000000;">异号买入是最基本的买入方式，在实现异号买入的基础上，实施异号补买和激进买入。</span><span style="color:#000000;">异号买入和激进买入联合可能会在一个上升通道内连续释放两次买入信号，</span><span style="color:#000000;">要在买入交易方法中有所调整，以支持连续买入的可能。</span></p> 
   <p>e)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#000000;">买入信号释放后，系统将记录本上升通道内的</span><span style="color:#000000;">MACD</span><span style="color:#000000;">最大值，以用于计算卖出信号。</span></p> 
  </blockquote> 
  <p>６．MACD卖出信号的计算</p> 
  <blockquote> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号的计算方式彻底放弃的原配的死叉模式，因为死叉模式反应相对迟缓，在实际股价下跌到出现死叉的过程中，会随时大部分利润。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;收缩卖出: 收缩卖出的模式监控上升通道内的MACD_MAX最大值和t时刻的MACD(t)值，当 MACD(t) &lt; &nbsp;MACD_MAX时， 即认为上升通道已经结束，可以释放卖出信号，确定阈值。</p> 
   <p>c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;卖出信号有可能会和股市的T+1策略冲突，需要进一步处理。</p> 
  </blockquote> 
  <br clear="all">
  <p align="left">&nbsp;</p> 
  <p>７．MACD信号有效性</p> 
  <blockquote> 
   <p>信号有效性主要有四个部分：</p> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MACD的均值MACD_AVG： 此处均值不是简单的MACD值的算术平均。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为MACD_AVG只在MACD&gt;0时的买入阶段涉及，因此基本值的计算是MACD绝对值的算术平均。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用绝对值的算术平均值过于死板，不具有调节的能力，因此为该值扩展一下定义。扩展为使得X%的数据都有效的值，X （0-100）。</p> 
   <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;即 X% MACD &gt; MACD_AVG, 如此， 可根据X调节MACD_AVG的值，以过滤数据。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#000000;">用于异号补买，</span><span style="color:#000000;">可调节为</span><span style="color:#000000;">n</span><span style="color:#000000;">倍的</span><span style="color:#000000;">MACD(t)</span><span style="color:#000000;">的值，</span><span style="color:#000000;">&nbsp;</span><span style="color:#000000;">我认为比较合理。</span></p> 
   <p>c)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#000000;">用于激进买入，其实际作用和</span><span style="color:#000000;">一致，用于限定</span><span style="color:#000000;">MACD(t)</span><span style="color:#000000;">和</span><span style="color:#000000;">MACD(t+1)</span><span style="color:#000000;">的比值，只有比值大于某个特定值，才认为是进入上升通道，</span><span style="color:#000000;">处理</span><span style="color:#000000;">MACD</span><span style="color:#000000;">值</span><span style="color:#000000;">&lt; 0</span><span style="color:#000000;">时的情况</span><span style="color:#000000;">。</span></p> 
   <p>d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#000000;">用于收缩卖出，和前两个变量一致，</span><span style="color:#000000;">用于限定</span><span style="color:#000000;">MACD(t)</span><span style="color:#000000;">和</span><span style="color:#000000;">MACD(t+1)</span><span style="color:#000000;">的比率，</span><span style="color:#000000;">只有小于某个特定值时，才认为是进入下将通道。</span></p> 
  </blockquote> 
  <p>&nbsp;</p> 
  <p align="left">8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略对交易信号的影响与应对</p> 
  <blockquote> 
   <p>a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T+1策略会导致当天的买入股票无法在当天卖出。 策略一旦遇到这种情况将标记一个t日的补卖信号。并在t+1天的第一个计算点10：00 AM重点关注，如果在tri 的补卖信号和t+1日第一个计算点之间没有其它的买入或卖出信号，就释放一个t+1日 10:00AM的卖出信号。以最大限度的避免损失。</p> 
   <p>b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t+1的处理会受到周末和节假日的影响，要加以留意。</p> 
  </blockquote> 
  <p align="left">&nbsp;</p> 
  <p align="left">9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进一步的思考</p> 
  <p align="left">下一步的想法是用机器学习的方法寻找最佳的策略：</p> 
  <p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以多项式回归或人工神经网络为工具。</p> 
  <p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以总资产比率曲线的一阶导数持续最大化增加为目标。</p> 
  <p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iii.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以一阶导数&gt; 0 为条件以限制平滑性。</p> 
  <p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iv.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以MACD策略为方法根据上述目标和限制设计拟合一个函数。</p> 
  <p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以股价为输入</p> 
  <p align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vi.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;计算函数的各个参数，以确定最佳的买卖时机。</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/marshao/article/details/76021192,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/marshao/article/details/76021192,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
