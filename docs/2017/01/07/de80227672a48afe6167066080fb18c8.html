<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>以太坊学习（4）开发编译部署调用智能合约 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="以太坊学习（4）开发编译部署调用智能合约" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="本文根据汪晓明的视频资料整理，ubuntu16.04测试正确。 1.打开geth控制台 ~$ geth --datadir ~/pengfan/eth --dev 在另一个终端输入 ~$ geth --dev console 2&gt;&gt;file_to_log_output 2.查看、设置编译器 &gt; eth.getCompilers() [] 设置solc为编译器 &gt; admin.setSolc(&quot;/usr/local/bin/solc&quot;) Error: exit status 1 at web3.js:3119:20 at web3.js:6023:15 at web3.js:4995:36 at &lt;anonymous&gt;:1:1 提示错误，更改路径成“/usr/bin/solc” ~$ whereis solc solc: /usr/bin/solc /usr/local/bin/solc &gt; admin.setSolc(&quot;/usr/bin/solc&quot;) &quot;solc, the solidity compiler commandline interface\nVersion: 0.4.7+commit.822622cf.Linux.g++\n&quot; 再次查看 &gt;eth.getCompilers() [&quot;Solidity&quot;] 3.编写智能合约 &gt;source=&quot;contract test { function multiply(uint a) returns(uint d) { return a * 7; }}&quot; 4.编译智能合约 &gt; contract = eth.compile.solidity(source).test code——编译后的EVM字节码 info——编译器返回的原数据 abiDefinition——应用程序二进制接口定义 compilerOptions——编译参数 5.准备工作：创建账户并激活 在以太坊上创建智能合约就是使用一个外部账户（EOA）向区块链中发送一个交易。 &gt; personal.newAccount(&quot;123456&quot;) &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; &gt; personal.listAccounts [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;] &gt; eth.getBalance(personal.listAccounts[0]) 0 &gt; miner.start() true &gt; eth.blockNumber 2 &gt; eth.getBalance(personal.listAccounts[0]) 15000000000000000000 &gt; address=eth.accounts[0] &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; &gt; personal.unlockAccount(address,&quot;123456&quot;,10000) true 6.指定创建合约的账户 &gt; address=eth.accounts[0] &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; 7.部署合约 部署合约就是将编译好的合约字节码以外部账号发送交易到一个空地址的形式部署到以太坊区块链上 &gt; abi=contract.info.abiDefinition 8. web3.eth.contract可以创建一个合约对象，这个对象可以在指定地址上初始化一个合约： &gt; MyContract=eth.contract(abi) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], eth: { accounts: [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;], blockNumber: 14, coinbase: &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;, compile: { lll: function(), serpent: function(), solidity: function() }, defaultAccount: undefined, defaultBlock: &quot;latest&quot;, gasPrice: 20000000000, hashrate: 41253, mining: true, pendingTransactions: [], syncing: false, call: function(), contract: function(abi), estimateGas: function(), filter: function(fil, callback), getAccounts: function(callback), getBalance: function(), getBlock: function(), getBlockNumber: function(callback), getBlockTransactionCount: function(), getBlockUncleCount: function(), getCode: function(), getCoinbase: function(callback), getCompilers: function(), getGasPrice: function(callback), getHashrate: function(callback), getMining: function(callback), getNatSpec: function(), getPendingTransactions: function(callback), getRawTransaction: function(), getRawTransactionFromBlock: function(), getStorageAt: function(), getSyncing: function(callback), getTransaction: function(), getTransactionCount: function(), getTransactionFromBlock: function(), getTransactionReceipt: function(), getUncle: function(), getWork: function(), iban: function(iban), icapNamereg: function(), isSyncing: function(callback), namereg: function(), resend: function(), sendIBANTransaction: function(), sendRawTransaction: function(), sendTransaction: function(), sign: function(), signTransaction: function(), submitTransaction: function(), submitWork: function() }, at: function(address, callback), getData: function(), new: function() } 9.将合约部署到区块链上 &gt;myContract=MyContract.new({from:address,data:contract.code}) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], address: undefined, transactionHash: &quot;0xc99efdc9ffb6f8283556b5de80c76f9bb3b37faf62bb8374ddf79480257866ac&quot; } 10.检查交易池，有一个待处理事项，要通过挖矿让交易生效，红色框中说明交易已经发送到区块链中了，等待矿工确认。 &gt; txpool.status { pending: 1, queued: 0 } &gt; txpool.status { pending: 0, queued: 0 } &gt; miner.stop() true 11.合约写进区块链之后就可以调用了（合约交互），以下为合约调用代码，通过abi取合约对象 使用eth.contract来定义一个合约类，定义的合约类遵从ABI定义 &gt; Multiply7=eth.contract(contract.info.abiDefinition) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], eth: { accounts: [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;], blockNumber: 24, coinbase: &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;, compile: { lll: function(), serpent: function(), solidity: function() }, defaultAccount: undefined, defaultBlock: &quot;latest&quot;, gasPrice: 20000000000, hashrate: 0, mining: false, pendingTransactions: [], syncing: false, call: function(), contract: function(abi), estimateGas: function(), filter: function(fil, callback), getAccounts: function(callback), getBalance: function(), getBlock: function(), getBlockNumber: function(callback), getBlockTransactionCount: function(), getBlockUncleCount: function(), getCode: function(), getCoinbase: function(callback), getCompilers: function(), getGasPrice: function(callback), getHashrate: function(callback), getMining: function(callback), getNatSpec: function(), getPendingTransactions: function(callback), getRawTransaction: function(), getRawTransactionFromBlock: function(), getStorageAt: function(), getSyncing: function(callback), getTransaction: function(), getTransactionCount: function(), getTransactionFromBlock: function(), getTransactionReceipt: function(), getUncle: function(), getWork: function(), iban: function(iban), icapNamereg: function(), isSyncing: function(callback), namereg: function(), resend: function(), sendIBANTransaction: function(), sendRawTransaction: function(), sendTransaction: function(), sign: function(), signTransaction: function(), submitTransaction: function(), submitWork: function() }, at: function(address, callback), getData: function(), new: function() } 12.指定特定地址，得到该地址上的合约实例 &gt; myMultiply7=Multiply7.at(myContract.address) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], address: &quot;0x8bd328e25b6846e01dd855123374fb285454cf0a&quot;, transactionHash: null, allEvents: function(), multiply: function() } 在实例中能够调用的函数有两个：allEvents和multiply。multiply显然是一开始我们定义合约的时候写的函数。我们可以使用两种方法来调用multiply函数：sendTransaction(3, {from: address})和call(3)。 &gt; myMultiply7.multiply.sendTransaction(3, {from:address}) &quot;0x71eed110365e80fb4d9436c30f5480fb5522afa629f629be816d4b07ef8d7c83&quot; &gt; myMultiply7.multiply.call(3) 21 &gt; myMultiply7.multiply.call(8) 56 使用sendTransaction(3, {from: address})返回的值为一个字符串，这个字符串代表的是发送的交易的hash值。使用这个方法调用合约将会使调用的结果成为全局共识的一部分 使用call(3)这个方法调用合约只会在本地上运行 要改变合约状态，只能用第一种方法。 阅读更多" />
<meta property="og:description" content="本文根据汪晓明的视频资料整理，ubuntu16.04测试正确。 1.打开geth控制台 ~$ geth --datadir ~/pengfan/eth --dev 在另一个终端输入 ~$ geth --dev console 2&gt;&gt;file_to_log_output 2.查看、设置编译器 &gt; eth.getCompilers() [] 设置solc为编译器 &gt; admin.setSolc(&quot;/usr/local/bin/solc&quot;) Error: exit status 1 at web3.js:3119:20 at web3.js:6023:15 at web3.js:4995:36 at &lt;anonymous&gt;:1:1 提示错误，更改路径成“/usr/bin/solc” ~$ whereis solc solc: /usr/bin/solc /usr/local/bin/solc &gt; admin.setSolc(&quot;/usr/bin/solc&quot;) &quot;solc, the solidity compiler commandline interface\nVersion: 0.4.7+commit.822622cf.Linux.g++\n&quot; 再次查看 &gt;eth.getCompilers() [&quot;Solidity&quot;] 3.编写智能合约 &gt;source=&quot;contract test { function multiply(uint a) returns(uint d) { return a * 7; }}&quot; 4.编译智能合约 &gt; contract = eth.compile.solidity(source).test code——编译后的EVM字节码 info——编译器返回的原数据 abiDefinition——应用程序二进制接口定义 compilerOptions——编译参数 5.准备工作：创建账户并激活 在以太坊上创建智能合约就是使用一个外部账户（EOA）向区块链中发送一个交易。 &gt; personal.newAccount(&quot;123456&quot;) &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; &gt; personal.listAccounts [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;] &gt; eth.getBalance(personal.listAccounts[0]) 0 &gt; miner.start() true &gt; eth.blockNumber 2 &gt; eth.getBalance(personal.listAccounts[0]) 15000000000000000000 &gt; address=eth.accounts[0] &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; &gt; personal.unlockAccount(address,&quot;123456&quot;,10000) true 6.指定创建合约的账户 &gt; address=eth.accounts[0] &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; 7.部署合约 部署合约就是将编译好的合约字节码以外部账号发送交易到一个空地址的形式部署到以太坊区块链上 &gt; abi=contract.info.abiDefinition 8. web3.eth.contract可以创建一个合约对象，这个对象可以在指定地址上初始化一个合约： &gt; MyContract=eth.contract(abi) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], eth: { accounts: [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;], blockNumber: 14, coinbase: &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;, compile: { lll: function(), serpent: function(), solidity: function() }, defaultAccount: undefined, defaultBlock: &quot;latest&quot;, gasPrice: 20000000000, hashrate: 41253, mining: true, pendingTransactions: [], syncing: false, call: function(), contract: function(abi), estimateGas: function(), filter: function(fil, callback), getAccounts: function(callback), getBalance: function(), getBlock: function(), getBlockNumber: function(callback), getBlockTransactionCount: function(), getBlockUncleCount: function(), getCode: function(), getCoinbase: function(callback), getCompilers: function(), getGasPrice: function(callback), getHashrate: function(callback), getMining: function(callback), getNatSpec: function(), getPendingTransactions: function(callback), getRawTransaction: function(), getRawTransactionFromBlock: function(), getStorageAt: function(), getSyncing: function(callback), getTransaction: function(), getTransactionCount: function(), getTransactionFromBlock: function(), getTransactionReceipt: function(), getUncle: function(), getWork: function(), iban: function(iban), icapNamereg: function(), isSyncing: function(callback), namereg: function(), resend: function(), sendIBANTransaction: function(), sendRawTransaction: function(), sendTransaction: function(), sign: function(), signTransaction: function(), submitTransaction: function(), submitWork: function() }, at: function(address, callback), getData: function(), new: function() } 9.将合约部署到区块链上 &gt;myContract=MyContract.new({from:address,data:contract.code}) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], address: undefined, transactionHash: &quot;0xc99efdc9ffb6f8283556b5de80c76f9bb3b37faf62bb8374ddf79480257866ac&quot; } 10.检查交易池，有一个待处理事项，要通过挖矿让交易生效，红色框中说明交易已经发送到区块链中了，等待矿工确认。 &gt; txpool.status { pending: 1, queued: 0 } &gt; txpool.status { pending: 0, queued: 0 } &gt; miner.stop() true 11.合约写进区块链之后就可以调用了（合约交互），以下为合约调用代码，通过abi取合约对象 使用eth.contract来定义一个合约类，定义的合约类遵从ABI定义 &gt; Multiply7=eth.contract(contract.info.abiDefinition) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], eth: { accounts: [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;], blockNumber: 24, coinbase: &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;, compile: { lll: function(), serpent: function(), solidity: function() }, defaultAccount: undefined, defaultBlock: &quot;latest&quot;, gasPrice: 20000000000, hashrate: 0, mining: false, pendingTransactions: [], syncing: false, call: function(), contract: function(abi), estimateGas: function(), filter: function(fil, callback), getAccounts: function(callback), getBalance: function(), getBlock: function(), getBlockNumber: function(callback), getBlockTransactionCount: function(), getBlockUncleCount: function(), getCode: function(), getCoinbase: function(callback), getCompilers: function(), getGasPrice: function(callback), getHashrate: function(callback), getMining: function(callback), getNatSpec: function(), getPendingTransactions: function(callback), getRawTransaction: function(), getRawTransactionFromBlock: function(), getStorageAt: function(), getSyncing: function(callback), getTransaction: function(), getTransactionCount: function(), getTransactionFromBlock: function(), getTransactionReceipt: function(), getUncle: function(), getWork: function(), iban: function(iban), icapNamereg: function(), isSyncing: function(callback), namereg: function(), resend: function(), sendIBANTransaction: function(), sendRawTransaction: function(), sendTransaction: function(), sign: function(), signTransaction: function(), submitTransaction: function(), submitWork: function() }, at: function(address, callback), getData: function(), new: function() } 12.指定特定地址，得到该地址上的合约实例 &gt; myMultiply7=Multiply7.at(myContract.address) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], address: &quot;0x8bd328e25b6846e01dd855123374fb285454cf0a&quot;, transactionHash: null, allEvents: function(), multiply: function() } 在实例中能够调用的函数有两个：allEvents和multiply。multiply显然是一开始我们定义合约的时候写的函数。我们可以使用两种方法来调用multiply函数：sendTransaction(3, {from: address})和call(3)。 &gt; myMultiply7.multiply.sendTransaction(3, {from:address}) &quot;0x71eed110365e80fb4d9436c30f5480fb5522afa629f629be816d4b07ef8d7c83&quot; &gt; myMultiply7.multiply.call(3) 21 &gt; myMultiply7.multiply.call(8) 56 使用sendTransaction(3, {from: address})返回的值为一个字符串，这个字符串代表的是发送的交易的hash值。使用这个方法调用合约将会使调用的结果成为全局共识的一部分 使用call(3)这个方法调用合约只会在本地上运行 要改变合约状态，只能用第一种方法。 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-07T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"本文根据汪晓明的视频资料整理，ubuntu16.04测试正确。 1.打开geth控制台 ~$ geth --datadir ~/pengfan/eth --dev 在另一个终端输入 ~$ geth --dev console 2&gt;&gt;file_to_log_output 2.查看、设置编译器 &gt; eth.getCompilers() [] 设置solc为编译器 &gt; admin.setSolc(&quot;/usr/local/bin/solc&quot;) Error: exit status 1 at web3.js:3119:20 at web3.js:6023:15 at web3.js:4995:36 at &lt;anonymous&gt;:1:1 提示错误，更改路径成“/usr/bin/solc” ~$ whereis solc solc: /usr/bin/solc /usr/local/bin/solc &gt; admin.setSolc(&quot;/usr/bin/solc&quot;) &quot;solc, the solidity compiler commandline interface\\nVersion: 0.4.7+commit.822622cf.Linux.g++\\n&quot; 再次查看 &gt;eth.getCompilers() [&quot;Solidity&quot;] 3.编写智能合约 &gt;source=&quot;contract test { function multiply(uint a) returns(uint d) { return a * 7; }}&quot; 4.编译智能合约 &gt; contract = eth.compile.solidity(source).test code——编译后的EVM字节码 info——编译器返回的原数据 abiDefinition——应用程序二进制接口定义 compilerOptions——编译参数 5.准备工作：创建账户并激活 在以太坊上创建智能合约就是使用一个外部账户（EOA）向区块链中发送一个交易。 &gt; personal.newAccount(&quot;123456&quot;) &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; &gt; personal.listAccounts [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;] &gt; eth.getBalance(personal.listAccounts[0]) 0 &gt; miner.start() true &gt; eth.blockNumber 2 &gt; eth.getBalance(personal.listAccounts[0]) 15000000000000000000 &gt; address=eth.accounts[0] &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; &gt; personal.unlockAccount(address,&quot;123456&quot;,10000) true 6.指定创建合约的账户 &gt; address=eth.accounts[0] &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot; 7.部署合约 部署合约就是将编译好的合约字节码以外部账号发送交易到一个空地址的形式部署到以太坊区块链上 &gt; abi=contract.info.abiDefinition 8. web3.eth.contract可以创建一个合约对象，这个对象可以在指定地址上初始化一个合约： &gt; MyContract=eth.contract(abi) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], eth: { accounts: [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;], blockNumber: 14, coinbase: &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;, compile: { lll: function(), serpent: function(), solidity: function() }, defaultAccount: undefined, defaultBlock: &quot;latest&quot;, gasPrice: 20000000000, hashrate: 41253, mining: true, pendingTransactions: [], syncing: false, call: function(), contract: function(abi), estimateGas: function(), filter: function(fil, callback), getAccounts: function(callback), getBalance: function(), getBlock: function(), getBlockNumber: function(callback), getBlockTransactionCount: function(), getBlockUncleCount: function(), getCode: function(), getCoinbase: function(callback), getCompilers: function(), getGasPrice: function(callback), getHashrate: function(callback), getMining: function(callback), getNatSpec: function(), getPendingTransactions: function(callback), getRawTransaction: function(), getRawTransactionFromBlock: function(), getStorageAt: function(), getSyncing: function(callback), getTransaction: function(), getTransactionCount: function(), getTransactionFromBlock: function(), getTransactionReceipt: function(), getUncle: function(), getWork: function(), iban: function(iban), icapNamereg: function(), isSyncing: function(callback), namereg: function(), resend: function(), sendIBANTransaction: function(), sendRawTransaction: function(), sendTransaction: function(), sign: function(), signTransaction: function(), submitTransaction: function(), submitWork: function() }, at: function(address, callback), getData: function(), new: function() } 9.将合约部署到区块链上 &gt;myContract=MyContract.new({from:address,data:contract.code}) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], address: undefined, transactionHash: &quot;0xc99efdc9ffb6f8283556b5de80c76f9bb3b37faf62bb8374ddf79480257866ac&quot; } 10.检查交易池，有一个待处理事项，要通过挖矿让交易生效，红色框中说明交易已经发送到区块链中了，等待矿工确认。 &gt; txpool.status { pending: 1, queued: 0 } &gt; txpool.status { pending: 0, queued: 0 } &gt; miner.stop() true 11.合约写进区块链之后就可以调用了（合约交互），以下为合约调用代码，通过abi取合约对象 使用eth.contract来定义一个合约类，定义的合约类遵从ABI定义 &gt; Multiply7=eth.contract(contract.info.abiDefinition) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], eth: { accounts: [&quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;], blockNumber: 24, coinbase: &quot;0x733bf98c0e218b430db0fe1d4c9ef04341444a82&quot;, compile: { lll: function(), serpent: function(), solidity: function() }, defaultAccount: undefined, defaultBlock: &quot;latest&quot;, gasPrice: 20000000000, hashrate: 0, mining: false, pendingTransactions: [], syncing: false, call: function(), contract: function(abi), estimateGas: function(), filter: function(fil, callback), getAccounts: function(callback), getBalance: function(), getBlock: function(), getBlockNumber: function(callback), getBlockTransactionCount: function(), getBlockUncleCount: function(), getCode: function(), getCoinbase: function(callback), getCompilers: function(), getGasPrice: function(callback), getHashrate: function(callback), getMining: function(callback), getNatSpec: function(), getPendingTransactions: function(callback), getRawTransaction: function(), getRawTransactionFromBlock: function(), getStorageAt: function(), getSyncing: function(callback), getTransaction: function(), getTransactionCount: function(), getTransactionFromBlock: function(), getTransactionReceipt: function(), getUncle: function(), getWork: function(), iban: function(iban), icapNamereg: function(), isSyncing: function(callback), namereg: function(), resend: function(), sendIBANTransaction: function(), sendRawTransaction: function(), sendTransaction: function(), sign: function(), signTransaction: function(), submitTransaction: function(), submitWork: function() }, at: function(address, callback), getData: function(), new: function() } 12.指定特定地址，得到该地址上的合约实例 &gt; myMultiply7=Multiply7.at(myContract.address) { abi: [{ constant: false, inputs: [{...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, type: &quot;function&quot; }], address: &quot;0x8bd328e25b6846e01dd855123374fb285454cf0a&quot;, transactionHash: null, allEvents: function(), multiply: function() } 在实例中能够调用的函数有两个：allEvents和multiply。multiply显然是一开始我们定义合约的时候写的函数。我们可以使用两种方法来调用multiply函数：sendTransaction(3, {from: address})和call(3)。 &gt; myMultiply7.multiply.sendTransaction(3, {from:address}) &quot;0x71eed110365e80fb4d9436c30f5480fb5522afa629f629be816d4b07ef8d7c83&quot; &gt; myMultiply7.multiply.call(3) 21 &gt; myMultiply7.multiply.call(8) 56 使用sendTransaction(3, {from: address})返回的值为一个字符串，这个字符串代表的是发送的交易的hash值。使用这个方法调用合约将会使调用的结果成为全局共识的一部分 使用call(3)这个方法调用合约只会在本地上运行 要改变合约状态，只能用第一种方法。 阅读更多","@type":"BlogPosting","url":"/2017/01/07/de80227672a48afe6167066080fb18c8.html","headline":"以太坊学习（4）开发编译部署调用智能合约","dateModified":"2017-01-07T00:00:00+08:00","datePublished":"2017-01-07T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2017/01/07/de80227672a48afe6167066080fb18c8.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>以太坊学习（4）开发编译部署调用智能合约</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <p>本文根据汪晓明的视频资料整理，ubuntu16.04测试正确。 <br> 1.打开geth控制台</p> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">~$</span> <span class="hljs-comment">geth</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">datadir</span> <span class="hljs-comment">~/pengfan/eth</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">dev</span></code></pre> 
  <p>在另一个终端输入</p> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">~$</span> <span class="hljs-comment">geth</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">dev</span> <span class="hljs-comment">console</span> <span class="hljs-comment">2</span>&gt;&gt;<span class="hljs-comment">file_to_log_output</span></code></pre> 
  <p>2.查看、设置编译器</p> 
  <pre class="prettyprint"><code class=" hljs markdown"><span class="hljs-blockquote">&gt; eth.getCompilers()</span>
[]</code></pre> 
  <p>设置solc为编译器</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; admin<span class="hljs-preprocessor">.setSolc</span>(<span class="hljs-string">"/usr/local/bin/solc"</span>)
<span class="hljs-label">Error:</span> exit status <span class="hljs-number">1</span>
    at web3<span class="hljs-preprocessor">.js</span>:<span class="hljs-number">3119</span>:<span class="hljs-number">20</span>
    at web3<span class="hljs-preprocessor">.js</span>:<span class="hljs-number">6023</span>:<span class="hljs-number">15</span>
    at web3<span class="hljs-preprocessor">.js</span>:<span class="hljs-number">4995</span>:<span class="hljs-number">36</span>
    at &lt;anonymous&gt;:<span class="hljs-number">1</span>:<span class="hljs-number">1</span></code></pre> 
  <p>提示错误，更改路径成“/usr/bin/solc”</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">~$ whereis solc
<span class="hljs-label">solc:</span> /usr/bin/solc /usr/local/bin/solc
&gt; admin<span class="hljs-preprocessor">.setSolc</span>(<span class="hljs-string">"/usr/bin/solc"</span>)
<span class="hljs-string">"solc, the solidity compiler commandline interface\nVersion: 0.4.7+commit.822622cf.Linux.g++\n"</span></code></pre> 
  <p>再次查看</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt;eth<span class="hljs-preprocessor">.getCompilers</span>()
[<span class="hljs-string">"Solidity"</span>]</code></pre> 
  <p>3.编写智能合约</p> 
  <pre class="prettyprint"><code class=" hljs bash">&gt;<span class="hljs-built_in">source</span>=<span class="hljs-string">"contract test { function multiply(uint a) returns(uint d) { return a * 7; }}"</span></code></pre> 
  <p>4.编译智能合约</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; contract = eth<span class="hljs-preprocessor">.compile</span><span class="hljs-preprocessor">.solidity</span>(source)<span class="hljs-preprocessor">.test</span></code></pre> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170107161434931?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcDAzNzIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""></p> 
  <p>code——编译后的EVM字节码 <br> info——编译器返回的原数据 <br> abiDefinition——应用程序二进制接口定义 <br> compilerOptions——编译参数</p> 
  <p>5.准备工作：创建账户并激活</p> 
  <blockquote> 
   <p>在以太坊上创建智能合约就是使用一个外部账户（EOA）向区块链中发送一个交易。</p> 
  </blockquote> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; personal<span class="hljs-preprocessor">.newAccount</span>(<span class="hljs-string">"123456"</span>)
<span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>
&gt; personal<span class="hljs-preprocessor">.listAccounts</span>
[<span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>]
&gt; eth<span class="hljs-preprocessor">.getBalance</span>(personal<span class="hljs-preprocessor">.listAccounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">0</span>
&gt; miner<span class="hljs-preprocessor">.start</span>()
true
&gt; eth<span class="hljs-preprocessor">.blockNumber</span>
<span class="hljs-number">2</span>
&gt; eth<span class="hljs-preprocessor">.getBalance</span>(personal<span class="hljs-preprocessor">.listAccounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">15000000000000000000</span>
&gt; address=eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]
<span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>
&gt; personal<span class="hljs-preprocessor">.unlockAccount</span>(address,<span class="hljs-string">"123456"</span>,<span class="hljs-number">10000</span>)
true</code></pre> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170107162503951?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcDAzNzIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br> 6.指定创建合约的账户</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; address=eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]
<span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span></code></pre> 
  <p>7.部署合约</p> 
  <blockquote> 
   <p>部署合约就是将编译好的合约字节码以外部账号发送交易到一个空地址的形式部署到以太坊区块链上</p> 
  </blockquote> 
  <pre class="prettyprint"><code class=" hljs avrasm">
&gt; abi=contract<span class="hljs-preprocessor">.info</span><span class="hljs-preprocessor">.abiDefinition</span></code></pre> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170107163059578?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcDAzNzIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""> <br> 8.</p> 
  <blockquote> 
   <p>web3.eth.contract可以创建一个合约对象，这个对象可以在指定地址上初始化一个合约：</p> 
  </blockquote> 
  <pre class="prettyprint"><code class=" hljs lua">&gt; MyContract=eth.contract(abi)
{
  abi: [{
      constant: <span class="hljs-keyword">false</span>,
      inputs: [{...}],
      name: <span class="hljs-string">"multiply"</span>,
      outputs: [{...}],
      payable: <span class="hljs-keyword">false</span>,
      <span class="hljs-built_in">type</span>: <span class="hljs-string">"function"</span>
  }],
  eth: {
    accounts: [<span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>],
    blockNumber: <span class="hljs-number">14</span>,
    coinbase: <span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>,
    compile: {
      lll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
      serpent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
      solidity: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    },
    defaultAccount: undefined,
    defaultBlock: <span class="hljs-string">"latest"</span>,
    gasPrice: <span class="hljs-number">20000000000</span>,
    hashrate: <span class="hljs-number">41253</span>,
    mining: <span class="hljs-keyword">true</span>,
    pendingTransactions: [],
    syncing: <span class="hljs-keyword">false</span>,
    call: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    contract: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(abi)</span></span>,
    estimateGas: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    filter: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(fil, callback)</span></span>,
    getAccounts: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getBalance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getBlock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getBlockNumber: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getBlockTransactionCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getBlockUncleCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getCode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getCoinbase: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getCompilers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getGasPrice: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getHashrate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getMining: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getNatSpec: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getPendingTransactions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getRawTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getRawTransactionFromBlock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getStorageAt: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getSyncing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getTransactionCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getTransactionFromBlock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getTransactionReceipt: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getUncle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getWork: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    iban: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(iban)</span></span>,
    icapNamereg: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    isSyncing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    namereg: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    resend: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sendIBANTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sendRawTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sendTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sign: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    signTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    submitTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    submitWork: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
  },
  at: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(address, callback)</span></span>,
  getData: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
  new: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
}
</code></pre> 
  <p>9.将合约部署到区块链上</p> 
  <pre class="prettyprint"><code class=" hljs r">&gt;myContract=MyContract.new({from:address,data:contract.code})
{
  abi: [{
      constant: false,
      inputs: [{<span class="hljs-keyword">...</span>}],
      name: <span class="hljs-string">"multiply"</span>,
      outputs: [{<span class="hljs-keyword">...</span>}],
      payable: false,
      type: <span class="hljs-string">"function"</span>
  }],
  address: undefined,
  transactionHash: <span class="hljs-string">"0xc99efdc9ffb6f8283556b5de80c76f9bb3b37faf62bb8374ddf79480257866ac"</span>
}
</code></pre> 
  <p>10.检查交易池，有一个待处理事项，要通过挖矿让交易生效，红色框中说明交易已经发送到区块链中了，等待矿工确认。</p> 
  <pre class="prettyprint"><code class=" hljs css">&gt; <span class="hljs-tag">txpool</span><span class="hljs-class">.status</span>
<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">pending</span>:<span class="hljs-value"> <span class="hljs-number">1</span>, queued: <span class="hljs-number">0</span> </span></span></span>}</code></pre> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20170107164028161?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcDAzNzIx/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""></p> 
  <pre class="prettyprint"><code class=" hljs css">&gt; <span class="hljs-tag">txpool</span><span class="hljs-class">.status</span>
<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">pending</span>:<span class="hljs-value"> <span class="hljs-number">0</span>, queued: <span class="hljs-number">0</span> </span></span></span>}
&gt; <span class="hljs-tag">miner</span><span class="hljs-class">.stop</span>()
<span class="hljs-tag">true</span>
</code></pre> 
  <p>11.合约写进区块链之后就可以调用了（合约交互），以下为合约调用代码，通过abi取合约对象</p> 
  <blockquote> 
   <p>使用eth.contract来定义一个合约类，定义的合约类遵从ABI定义</p> 
  </blockquote> 
  <pre class="prettyprint"><code class=" hljs lua">&gt; Multiply7=eth.contract(contract.info.abiDefinition)
{
  abi: [{
      constant: <span class="hljs-keyword">false</span>,
      inputs: [{...}],
      name: <span class="hljs-string">"multiply"</span>,
      outputs: [{...}],
      payable: <span class="hljs-keyword">false</span>,
      <span class="hljs-built_in">type</span>: <span class="hljs-string">"function"</span>
  }],
  eth: {
    accounts: [<span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>],
    blockNumber: <span class="hljs-number">24</span>,
    coinbase: <span class="hljs-string">"0x733bf98c0e218b430db0fe1d4c9ef04341444a82"</span>,
    compile: {
      lll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
      serpent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
      solidity: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    },
    defaultAccount: undefined,
    defaultBlock: <span class="hljs-string">"latest"</span>,
    gasPrice: <span class="hljs-number">20000000000</span>,
    hashrate: <span class="hljs-number">0</span>,
    mining: <span class="hljs-keyword">false</span>,
    pendingTransactions: [],
    syncing: <span class="hljs-keyword">false</span>,
    call: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    contract: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(abi)</span></span>,
    estimateGas: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    filter: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(fil, callback)</span></span>,
    getAccounts: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getBalance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getBlock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getBlockNumber: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getBlockTransactionCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getBlockUncleCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getCode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getCoinbase: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getCompilers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getGasPrice: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getHashrate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getMining: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getNatSpec: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getPendingTransactions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getRawTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getRawTransactionFromBlock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getStorageAt: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getSyncing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    getTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getTransactionCount: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getTransactionFromBlock: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getTransactionReceipt: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getUncle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    getWork: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    iban: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(iban)</span></span>,
    icapNamereg: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    isSyncing: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span></span>,
    namereg: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    resend: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sendIBANTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sendRawTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sendTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    sign: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    signTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    submitTransaction: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
    submitWork: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
  },
  at: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(address, callback)</span></span>,
  getData: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>,
  new: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
}
</code></pre> 
  <p>12.指定特定地址，得到该地址上的合约实例</p> 
  <pre class="prettyprint"><code class=" hljs r">&gt; myMultiply7=Multiply7.at(myContract.address)
{
  abi: [{
      constant: false,
      inputs: [{<span class="hljs-keyword">...</span>}],
      name: <span class="hljs-string">"multiply"</span>,
      outputs: [{<span class="hljs-keyword">...</span>}],
      payable: false,
      type: <span class="hljs-string">"function"</span>
  }],
  address: <span class="hljs-string">"0x8bd328e25b6846e01dd855123374fb285454cf0a"</span>,
  transactionHash: null,
  allEvents: <span class="hljs-keyword">function</span>(),
  multiply: <span class="hljs-keyword">function</span>()
}
</code></pre> 
  <blockquote> 
   <p>在实例中能够调用的函数有两个：allEvents和multiply。multiply显然是一开始我们定义合约的时候写的函数。我们可以使用两种方法来调用multiply函数：sendTransaction(3, {from: address})和call(3)。</p> 
  </blockquote> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; myMultiply7<span class="hljs-preprocessor">.multiply</span><span class="hljs-preprocessor">.sendTransaction</span>(<span class="hljs-number">3</span>, {from:address})
<span class="hljs-string">"0x71eed110365e80fb4d9436c30f5480fb5522afa629f629be816d4b07ef8d7c83"</span>
&gt; myMultiply7<span class="hljs-preprocessor">.multiply</span><span class="hljs-preprocessor">.call</span>(<span class="hljs-number">3</span>)
<span class="hljs-number">21</span>
&gt; myMultiply7<span class="hljs-preprocessor">.multiply</span><span class="hljs-preprocessor">.call</span>(<span class="hljs-number">8</span>)
<span class="hljs-number">56</span></code></pre> 
  <blockquote> 
   <p>使用sendTransaction(3, {from: address})返回的值为一个字符串，这个字符串代表的是发送的交易的hash值。使用这个方法调用合约将会使调用的结果成为全局共识的一部分 <br> 使用call(3)这个方法调用合约只会在本地上运行</p> 
  </blockquote> 
  <p>要改变合约状态，只能用第一种方法。</p> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/p03721/article/details/54176353,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/p03721/article/details/54176353,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
