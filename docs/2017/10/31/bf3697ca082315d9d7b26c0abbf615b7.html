<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>docker-dev 镜像生成 踩过得坑 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="docker-dev 镜像生成 踩过得坑" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="1、环境要求 a GitHub account git make docker 1、git 版本 大于 2.2.2 vito@caas:~$ git --version git version 2.7.4 2、make版本 大于3.8.1 vito@caas:~$ make -v GNU Make 4.1 Built for x86_64-pc-linux-gnu Copyright (C) 1988-2014 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. 3、docker 版本 vito@caas:~$ sudo docker --version Docker version 17.09.0-ce, build afdb6d4 linux 用户小提示： 如果你的用户没有加入docker组，每次执行docker命令笔记加上sudo，执行下面的命令查看是否加入docker组，下面的命令表示没有加入。所以执行命令的时候必须加入sudo： vito@caas:~$ getent group docker docker:x:999: vito@caas:~$ sudo docker --version Docker version 17.09.0-ce, build afdb6d4 我们可以执行以下命令把当前用户加入到docker组： （注意：执行命令后重新启动） vito@caas:~$ sudo usermod -aG docker username 2、创建docker编译环境 首先下载docker源代码：https://github.com/docker/distribution.git git clone https://github.com/docker/distribution.git 切换到源码根目录，发现根目录有一个Dockerfile，用这个Dockerfile创建docker的编译环境，执行创建docker 镜像的命令： vito@caas:~/docker/moby$ sudo make BIND_DIR=. shell Makefile:115: The docker client CLI has moved to github.com/docker/cli. For a dev-test cycle involving the CLI, run: DOCKER_CLI_PATH=/host/path/to/cli/binary make shell then change the cli and compile into a binary at the same location. docker build -t &quot;docker-dev:master&quot; -f &quot;&quot; . Sending build context to Docker daemon 38.42MB Step 1/39 : FROM debian:stretch ---&gt; 874e27b628fd Step 2/39 : ARG APT_MIRROR=deb.debian.org ---&gt; Using cache ---&gt; 2189fccf5c85 Step 3/39 : RUN sed -ri &quot;s/(httpredir|deb).debian.org/$APT_MIRROR/g&quot; /etc/apt/sources.list ---&gt; Using cache ---&gt; 183f018c0759 Step 4/39 : RUN apt-get update &amp;&amp; apt-get install -y apparmor apt-utils aufs-tools automake bash-completion binutils-mingw-w64 bsdmainutils btrfs-tools build-essential cmake createrepo curl dpkg-sig gcc-mingw-w64 git iptables jq less libapparmor-dev libcap-dev libdevmapper-dev libnl-3-dev libprotobuf-c0-dev libprotobuf-dev libseccomp-dev libsystemd-dev libtool libudev-dev mercurial net-tools pkg-config protobuf-compiler protobuf-c-compiler python-backports.ssl-match-hostname python-dev python-mock python-pip python-requests python-setuptools python-websocket python-wheel tar thin-provisioning-tools vim vim-common xfsprogs zip --no-install-recommends &amp;&amp; pip install awscli==1.10.15 ---&gt; Using cache ---&gt; 65e6b480b2aa Step 5/39 : ENV GO_VERSION 1.8.4 ---&gt; Using cache ---&gt; fd97af8ee1ba Step 6/39 : RUN curl -fsSL &quot;https://studygolang.com/dl/golang/go${GO_VERSION}.linux-amd64.tar.gz&quot; | tar -xzC /usr/local ---&gt; Running in e405bfebb65e 踩过的坑 由于有些下载地址可能被屏蔽，中途的错误可以手动修改，改为国内下载地址，例如：golang的下载地址，各种版本都可以在这个地址找到：https://studygolang.com/dl，我们替换Dockerfile中的地址为国内地址： 再次执行 ：sudo make BIND_DIR=. shell,执行到第30步的时候报错： Step 30/39 : RUN ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7 ---&gt; Running in 73210ada3c34 /usr/bin/env: &#39;bash1\r&#39;: No such file or directory The command &#39;/bin/sh -c ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7&#39; returned a non-zero code: 127 Makefile:115: recipe for target &#39;build&#39; failed make: *** [build] Error 127 经过分析是因为脚本中存在windows的换行符，使用命令替换掉换行符： sed -i &#39;s/\r$//&#39; contrib/download-frozen-image-v2.sh 会把 .sh 中的\r 替换成空白,再次编译，pass 执行过程中，如果发现脚本中用到的有些文件夹不存在，可能是因为权限不够，造成创建的某些文件夹失败，解决方案是切换到root用户下执行：make BIND_DIR=. shell 镜像下载慢问题：由于sh脚本中定义的镜像仓库都是国外的仓库，下载镜像比较慢，甚至终端，可以把镜像仓库替换为国内的镜像仓库，例如：download-frozen-image-v2.sh文件中的registryBase registryBase=&#39;https://registry-1.docker.io&#39; authBase=&#39;https://auth.docker.io&#39; authService=&#39;registry.docker.io&#39; 替换为： registryBase=&#39;https://5162s31v.mirror.aliyuncs.com&#39; authBase=&#39;https://auth.docker.io&#39; authService=&#39;registry.docker.io&#39; 第33步错误： Step 33/39 : RUN /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter ---&gt; Running in 8f981ec52383 ++ dirname /tmp/install-binaries.sh + . /tmp/binaries-commits ++ $&#39;\r&#39; /tmp/binaries-commits: line 2: $&#39;\r&#39;: command not found The command &#39;/bin/sh -c /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter&#39; returned a non-zero code: 127 Makefile:115: recipe for target &#39;build&#39; failed make: *** [build] Error 127 解决办法1，修改/hack/dockerfile/install-binaries.sh文件 url=https://download.docker.com/linux/static curl -Ls $url/$DOCKERCLI_CHANNEL/$arch/docker-$DOCKERCLI_VERSION.tgz | \ tar -xz docker/docker mv docker/docker /usr/local/bin/ rmdir docker 改为： url=https://download.docker.com/linux/static curl -o docker-$DOCKERCLI_VERSION.tgz $url/$DOCKERCLI_CHANNEL/$arch/docker-$DOCKERCLI_VERSION.tgz | \ tar -xzf docker-$DOCKERCLI_VERSION.tgz mv docker/docker /usr/local/bin/ rmdir docker 上马的方法如该不行，有个稍微麻烦的办法，自己下载docker-17.06.0-ce.tgz文件：https://download.docker.com/linux/static/edge/x86_64/docker-17.06.0-ce.tgz，解压缩，然后放在自己的github上，在github上自己的账户下创建public项目docker，把解压缩的文件上传到githua中。然后修改里面的语句为git clone，具体修改后内容如下： url=https://download.docker.com/linux/static git clone https://github.com/liujb0319/docker.git mv docker/docker /usr/local/bin/ rm -rf docker 阅读更多" />
<meta property="og:description" content="1、环境要求 a GitHub account git make docker 1、git 版本 大于 2.2.2 vito@caas:~$ git --version git version 2.7.4 2、make版本 大于3.8.1 vito@caas:~$ make -v GNU Make 4.1 Built for x86_64-pc-linux-gnu Copyright (C) 1988-2014 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. 3、docker 版本 vito@caas:~$ sudo docker --version Docker version 17.09.0-ce, build afdb6d4 linux 用户小提示： 如果你的用户没有加入docker组，每次执行docker命令笔记加上sudo，执行下面的命令查看是否加入docker组，下面的命令表示没有加入。所以执行命令的时候必须加入sudo： vito@caas:~$ getent group docker docker:x:999: vito@caas:~$ sudo docker --version Docker version 17.09.0-ce, build afdb6d4 我们可以执行以下命令把当前用户加入到docker组： （注意：执行命令后重新启动） vito@caas:~$ sudo usermod -aG docker username 2、创建docker编译环境 首先下载docker源代码：https://github.com/docker/distribution.git git clone https://github.com/docker/distribution.git 切换到源码根目录，发现根目录有一个Dockerfile，用这个Dockerfile创建docker的编译环境，执行创建docker 镜像的命令： vito@caas:~/docker/moby$ sudo make BIND_DIR=. shell Makefile:115: The docker client CLI has moved to github.com/docker/cli. For a dev-test cycle involving the CLI, run: DOCKER_CLI_PATH=/host/path/to/cli/binary make shell then change the cli and compile into a binary at the same location. docker build -t &quot;docker-dev:master&quot; -f &quot;&quot; . Sending build context to Docker daemon 38.42MB Step 1/39 : FROM debian:stretch ---&gt; 874e27b628fd Step 2/39 : ARG APT_MIRROR=deb.debian.org ---&gt; Using cache ---&gt; 2189fccf5c85 Step 3/39 : RUN sed -ri &quot;s/(httpredir|deb).debian.org/$APT_MIRROR/g&quot; /etc/apt/sources.list ---&gt; Using cache ---&gt; 183f018c0759 Step 4/39 : RUN apt-get update &amp;&amp; apt-get install -y apparmor apt-utils aufs-tools automake bash-completion binutils-mingw-w64 bsdmainutils btrfs-tools build-essential cmake createrepo curl dpkg-sig gcc-mingw-w64 git iptables jq less libapparmor-dev libcap-dev libdevmapper-dev libnl-3-dev libprotobuf-c0-dev libprotobuf-dev libseccomp-dev libsystemd-dev libtool libudev-dev mercurial net-tools pkg-config protobuf-compiler protobuf-c-compiler python-backports.ssl-match-hostname python-dev python-mock python-pip python-requests python-setuptools python-websocket python-wheel tar thin-provisioning-tools vim vim-common xfsprogs zip --no-install-recommends &amp;&amp; pip install awscli==1.10.15 ---&gt; Using cache ---&gt; 65e6b480b2aa Step 5/39 : ENV GO_VERSION 1.8.4 ---&gt; Using cache ---&gt; fd97af8ee1ba Step 6/39 : RUN curl -fsSL &quot;https://studygolang.com/dl/golang/go${GO_VERSION}.linux-amd64.tar.gz&quot; | tar -xzC /usr/local ---&gt; Running in e405bfebb65e 踩过的坑 由于有些下载地址可能被屏蔽，中途的错误可以手动修改，改为国内下载地址，例如：golang的下载地址，各种版本都可以在这个地址找到：https://studygolang.com/dl，我们替换Dockerfile中的地址为国内地址： 再次执行 ：sudo make BIND_DIR=. shell,执行到第30步的时候报错： Step 30/39 : RUN ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7 ---&gt; Running in 73210ada3c34 /usr/bin/env: &#39;bash1\r&#39;: No such file or directory The command &#39;/bin/sh -c ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7&#39; returned a non-zero code: 127 Makefile:115: recipe for target &#39;build&#39; failed make: *** [build] Error 127 经过分析是因为脚本中存在windows的换行符，使用命令替换掉换行符： sed -i &#39;s/\r$//&#39; contrib/download-frozen-image-v2.sh 会把 .sh 中的\r 替换成空白,再次编译，pass 执行过程中，如果发现脚本中用到的有些文件夹不存在，可能是因为权限不够，造成创建的某些文件夹失败，解决方案是切换到root用户下执行：make BIND_DIR=. shell 镜像下载慢问题：由于sh脚本中定义的镜像仓库都是国外的仓库，下载镜像比较慢，甚至终端，可以把镜像仓库替换为国内的镜像仓库，例如：download-frozen-image-v2.sh文件中的registryBase registryBase=&#39;https://registry-1.docker.io&#39; authBase=&#39;https://auth.docker.io&#39; authService=&#39;registry.docker.io&#39; 替换为： registryBase=&#39;https://5162s31v.mirror.aliyuncs.com&#39; authBase=&#39;https://auth.docker.io&#39; authService=&#39;registry.docker.io&#39; 第33步错误： Step 33/39 : RUN /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter ---&gt; Running in 8f981ec52383 ++ dirname /tmp/install-binaries.sh + . /tmp/binaries-commits ++ $&#39;\r&#39; /tmp/binaries-commits: line 2: $&#39;\r&#39;: command not found The command &#39;/bin/sh -c /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter&#39; returned a non-zero code: 127 Makefile:115: recipe for target &#39;build&#39; failed make: *** [build] Error 127 解决办法1，修改/hack/dockerfile/install-binaries.sh文件 url=https://download.docker.com/linux/static curl -Ls $url/$DOCKERCLI_CHANNEL/$arch/docker-$DOCKERCLI_VERSION.tgz | \ tar -xz docker/docker mv docker/docker /usr/local/bin/ rmdir docker 改为： url=https://download.docker.com/linux/static curl -o docker-$DOCKERCLI_VERSION.tgz $url/$DOCKERCLI_CHANNEL/$arch/docker-$DOCKERCLI_VERSION.tgz | \ tar -xzf docker-$DOCKERCLI_VERSION.tgz mv docker/docker /usr/local/bin/ rmdir docker 上马的方法如该不行，有个稍微麻烦的办法，自己下载docker-17.06.0-ce.tgz文件：https://download.docker.com/linux/static/edge/x86_64/docker-17.06.0-ce.tgz，解压缩，然后放在自己的github上，在github上自己的账户下创建public项目docker，把解压缩的文件上传到githua中。然后修改里面的语句为git clone，具体修改后内容如下： url=https://download.docker.com/linux/static git clone https://github.com/liujb0319/docker.git mv docker/docker /usr/local/bin/ rm -rf docker 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-10-31T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"1、环境要求 a GitHub account git make docker 1、git 版本 大于 2.2.2 vito@caas:~$ git --version git version 2.7.4 2、make版本 大于3.8.1 vito@caas:~$ make -v GNU Make 4.1 Built for x86_64-pc-linux-gnu Copyright (C) 1988-2014 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. 3、docker 版本 vito@caas:~$ sudo docker --version Docker version 17.09.0-ce, build afdb6d4 linux 用户小提示： 如果你的用户没有加入docker组，每次执行docker命令笔记加上sudo，执行下面的命令查看是否加入docker组，下面的命令表示没有加入。所以执行命令的时候必须加入sudo： vito@caas:~$ getent group docker docker:x:999: vito@caas:~$ sudo docker --version Docker version 17.09.0-ce, build afdb6d4 我们可以执行以下命令把当前用户加入到docker组： （注意：执行命令后重新启动） vito@caas:~$ sudo usermod -aG docker username 2、创建docker编译环境 首先下载docker源代码：https://github.com/docker/distribution.git git clone https://github.com/docker/distribution.git 切换到源码根目录，发现根目录有一个Dockerfile，用这个Dockerfile创建docker的编译环境，执行创建docker 镜像的命令： vito@caas:~/docker/moby$ sudo make BIND_DIR=. shell Makefile:115: The docker client CLI has moved to github.com/docker/cli. For a dev-test cycle involving the CLI, run: DOCKER_CLI_PATH=/host/path/to/cli/binary make shell then change the cli and compile into a binary at the same location. docker build -t &quot;docker-dev:master&quot; -f &quot;&quot; . Sending build context to Docker daemon 38.42MB Step 1/39 : FROM debian:stretch ---&gt; 874e27b628fd Step 2/39 : ARG APT_MIRROR=deb.debian.org ---&gt; Using cache ---&gt; 2189fccf5c85 Step 3/39 : RUN sed -ri &quot;s/(httpredir|deb).debian.org/$APT_MIRROR/g&quot; /etc/apt/sources.list ---&gt; Using cache ---&gt; 183f018c0759 Step 4/39 : RUN apt-get update &amp;&amp; apt-get install -y apparmor apt-utils aufs-tools automake bash-completion binutils-mingw-w64 bsdmainutils btrfs-tools build-essential cmake createrepo curl dpkg-sig gcc-mingw-w64 git iptables jq less libapparmor-dev libcap-dev libdevmapper-dev libnl-3-dev libprotobuf-c0-dev libprotobuf-dev libseccomp-dev libsystemd-dev libtool libudev-dev mercurial net-tools pkg-config protobuf-compiler protobuf-c-compiler python-backports.ssl-match-hostname python-dev python-mock python-pip python-requests python-setuptools python-websocket python-wheel tar thin-provisioning-tools vim vim-common xfsprogs zip --no-install-recommends &amp;&amp; pip install awscli==1.10.15 ---&gt; Using cache ---&gt; 65e6b480b2aa Step 5/39 : ENV GO_VERSION 1.8.4 ---&gt; Using cache ---&gt; fd97af8ee1ba Step 6/39 : RUN curl -fsSL &quot;https://studygolang.com/dl/golang/go${GO_VERSION}.linux-amd64.tar.gz&quot; | tar -xzC /usr/local ---&gt; Running in e405bfebb65e 踩过的坑 由于有些下载地址可能被屏蔽，中途的错误可以手动修改，改为国内下载地址，例如：golang的下载地址，各种版本都可以在这个地址找到：https://studygolang.com/dl，我们替换Dockerfile中的地址为国内地址： 再次执行 ：sudo make BIND_DIR=. shell,执行到第30步的时候报错： Step 30/39 : RUN ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7 ---&gt; Running in 73210ada3c34 /usr/bin/env: &#39;bash1\\r&#39;: No such file or directory The command &#39;/bin/sh -c ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7&#39; returned a non-zero code: 127 Makefile:115: recipe for target &#39;build&#39; failed make: *** [build] Error 127 经过分析是因为脚本中存在windows的换行符，使用命令替换掉换行符： sed -i &#39;s/\\r$//&#39; contrib/download-frozen-image-v2.sh 会把 .sh 中的\\r 替换成空白,再次编译，pass 执行过程中，如果发现脚本中用到的有些文件夹不存在，可能是因为权限不够，造成创建的某些文件夹失败，解决方案是切换到root用户下执行：make BIND_DIR=. shell 镜像下载慢问题：由于sh脚本中定义的镜像仓库都是国外的仓库，下载镜像比较慢，甚至终端，可以把镜像仓库替换为国内的镜像仓库，例如：download-frozen-image-v2.sh文件中的registryBase registryBase=&#39;https://registry-1.docker.io&#39; authBase=&#39;https://auth.docker.io&#39; authService=&#39;registry.docker.io&#39; 替换为： registryBase=&#39;https://5162s31v.mirror.aliyuncs.com&#39; authBase=&#39;https://auth.docker.io&#39; authService=&#39;registry.docker.io&#39; 第33步错误： Step 33/39 : RUN /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter ---&gt; Running in 8f981ec52383 ++ dirname /tmp/install-binaries.sh + . /tmp/binaries-commits ++ $&#39;\\r&#39; /tmp/binaries-commits: line 2: $&#39;\\r&#39;: command not found The command &#39;/bin/sh -c /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter&#39; returned a non-zero code: 127 Makefile:115: recipe for target &#39;build&#39; failed make: *** [build] Error 127 解决办法1，修改/hack/dockerfile/install-binaries.sh文件 url=https://download.docker.com/linux/static curl -Ls $url/$DOCKERCLI_CHANNEL/$arch/docker-$DOCKERCLI_VERSION.tgz | \\ tar -xz docker/docker mv docker/docker /usr/local/bin/ rmdir docker 改为： url=https://download.docker.com/linux/static curl -o docker-$DOCKERCLI_VERSION.tgz $url/$DOCKERCLI_CHANNEL/$arch/docker-$DOCKERCLI_VERSION.tgz | \\ tar -xzf docker-$DOCKERCLI_VERSION.tgz mv docker/docker /usr/local/bin/ rmdir docker 上马的方法如该不行，有个稍微麻烦的办法，自己下载docker-17.06.0-ce.tgz文件：https://download.docker.com/linux/static/edge/x86_64/docker-17.06.0-ce.tgz，解压缩，然后放在自己的github上，在github上自己的账户下创建public项目docker，把解压缩的文件上传到githua中。然后修改里面的语句为git clone，具体修改后内容如下： url=https://download.docker.com/linux/static git clone https://github.com/liujb0319/docker.git mv docker/docker /usr/local/bin/ rm -rf docker 阅读更多","@type":"BlogPosting","url":"/2017/10/31/bf3697ca082315d9d7b26c0abbf615b7.html","headline":"docker-dev 镜像生成 踩过得坑","dateModified":"2017-10-31T00:00:00+08:00","datePublished":"2017-10-31T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2017/10/31/bf3697ca082315d9d7b26c0abbf615b7.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>docker-dev 镜像生成 踩过得坑</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <h2 id="1环境要求"><strong>1、环境要求</strong></h2> 
  <pre><code>a GitHub account
git
make
docker
</code></pre> 
  <p>1、git 版本 大于 2.2.2</p> 
  <pre class="prettyprint"><code class=" hljs ruby">vito<span class="hljs-variable">@caas</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>git --version
git version <span class="hljs-number">2.7</span>.<span class="hljs-number">4</span></code></pre> 
  <p>2、make版本 大于3.8.1</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">vito@caas:~$ make -v
GNU Make <span class="hljs-number">4.1</span>
Built <span class="hljs-keyword">for</span> x86_64-pc-linux-gnu
Copyright (C) <span class="hljs-number">1988</span>-<span class="hljs-number">2014</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL <span class="hljs-built_in">version</span> <span class="hljs-number">3</span> <span class="hljs-operator">or</span> later &lt;<span class="hljs-keyword">http</span>://gnu.org/licenses/gpl.html&gt;
This is free software: you are free <span class="hljs-built_in">to</span> change <span class="hljs-operator">and</span> redistribute <span class="hljs-keyword">it</span>.
There is NO WARRANTY, <span class="hljs-built_in">to</span> <span class="hljs-operator">the</span> extent permitted <span class="hljs-keyword">by</span> law.
</code></pre> 
  <p>3、docker 版本</p> 
  <pre class="prettyprint"><code class=" hljs ruby">vito<span class="hljs-variable">@caas</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo docker --version
<span class="hljs-constant">Docker</span> version <span class="hljs-number">17.09</span>.<span class="hljs-number">0</span>-ce, build afdb6d4</code></pre> 
  <p><strong>linux 用户小提示：</strong> <br> 如果你的用户没有加入docker组，每次执行docker命令笔记加上sudo，执行下面的命令查看是否加入docker组，下面的命令表示没有加入。所以执行命令的时候必须加入sudo：</p> 
  <pre class="prettyprint"><code class=" hljs ruby">vito<span class="hljs-variable">@caas</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>getent group docker
<span class="hljs-symbol">docker:</span><span class="hljs-symbol">x:</span><span class="hljs-number">999</span><span class="hljs-symbol">:</span>
vito<span class="hljs-variable">@caas</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo docker --version
<span class="hljs-constant">Docker</span> version <span class="hljs-number">17.09</span>.<span class="hljs-number">0</span>-ce, build afdb6d4
</code></pre> 
  <p>我们可以执行以下命令把当前用户加入到docker组： <br> <em>（注意：执行命令后重新启动）</em></p> 
  <pre class="prettyprint"><code class=" hljs ruby">vito<span class="hljs-variable">@caas</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo usermod -aG docker username
</code></pre> 
  <h2 id="2创建docker编译环境"><strong>2、创建docker编译环境</strong></h2> 
  <ul> 
   <li>首先下载docker源代码：<a href="https://github.com/docker/distribution.git" rel="nofollow" target="_blank">https://github.com/docker/distribution.git</a></li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs php">git <span class="hljs-keyword">clone</span> https:<span class="hljs-comment">//github.com/docker/distribution.git</span></code></pre> 
  <ul> 
   <li><p>切换到源码根目录，发现根目录有一个Dockerfile，用这个Dockerfile创建docker的编译环境，执行创建docker</p> <p>镜像的命令：</p></li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs lasso">vito@caas:~/docker/moby$ sudo make BIND_DIR<span class="hljs-subst">=</span><span class="hljs-built_in">.</span> shell
Makefile:<span class="hljs-number">115</span>: The docker client CLI has moved <span class="hljs-keyword">to</span> github<span class="hljs-built_in">.</span>com/docker/cli<span class="hljs-built_in">.</span> For a dev<span class="hljs-attribute">-test</span> cycle involving the CLI, run:
 DOCKER_CLI_PATH<span class="hljs-subst">=</span>/host/path/<span class="hljs-keyword">to</span>/cli/binary make shell 
 then change the cli <span class="hljs-literal">and</span> compile <span class="hljs-keyword">into</span> a binary at the same location<span class="hljs-built_in">.</span>

docker build   <span class="hljs-attribute">-t</span> <span class="hljs-string">"docker-dev:master"</span> <span class="hljs-attribute">-f</span> <span class="hljs-string">""</span> <span class="hljs-built_in">.</span>
Sending build context <span class="hljs-keyword">to</span> Docker daemon  <span class="hljs-number">38.42</span>MB
Step <span class="hljs-number">1</span>/<span class="hljs-number">39</span> : FROM debian:stretch
 <span class="hljs-subst">---&gt;</span> <span class="hljs-number">874e27</span>b628fd
Step <span class="hljs-number">2</span>/<span class="hljs-number">39</span> : ARG APT_MIRROR<span class="hljs-subst">=</span>deb<span class="hljs-built_in">.</span>debian<span class="hljs-built_in">.</span>org
 <span class="hljs-subst">---&gt;</span> Using <span class="hljs-keyword">cache</span>
 <span class="hljs-subst">---&gt;</span> <span class="hljs-number">2189</span>fccf5c85
Step <span class="hljs-number">3</span>/<span class="hljs-number">39</span> : RUN sed <span class="hljs-attribute">-ri</span> <span class="hljs-string">"s/(httpredir|deb).debian.org/$APT_MIRROR/g"</span> /etc/apt/sources<span class="hljs-built_in">.</span><span class="hljs-built_in">list</span>
 <span class="hljs-subst">---&gt;</span> Using <span class="hljs-keyword">cache</span>
 <span class="hljs-subst">---&gt;</span> <span class="hljs-number">183</span>f018c0759
Step <span class="hljs-number">4</span>/<span class="hljs-number">39</span> : RUN apt<span class="hljs-attribute">-get</span> update <span class="hljs-subst">&amp;&amp;</span> apt<span class="hljs-attribute">-get</span> install <span class="hljs-attribute">-y</span>    apparmor    apt<span class="hljs-attribute">-utils</span>   aufs<span class="hljs-attribute">-tools</span>  automake    bash<span class="hljs-attribute">-completion</span>     binutils<span class="hljs-attribute">-mingw</span><span class="hljs-attribute">-w64</span>  bsdmainutils    btrfs<span class="hljs-attribute">-tools</span>     build<span class="hljs-attribute">-essential</span>     cmake   createrepo  curl    dpkg<span class="hljs-attribute">-sig</span>    gcc<span class="hljs-attribute">-mingw</span><span class="hljs-attribute">-w64</span>   git     iptables    jq  less    libapparmor<span class="hljs-attribute">-dev</span>     libcap<span class="hljs-attribute">-dev</span>  libdevmapper<span class="hljs-attribute">-dev</span>    libnl<span class="hljs-subst">-</span><span class="hljs-number">3</span><span class="hljs-attribute">-dev</span>     libprotobuf<span class="hljs-attribute">-c0</span><span class="hljs-attribute">-dev</span>  libprotobuf<span class="hljs-attribute">-dev</span>     libseccomp<span class="hljs-attribute">-dev</span>  libsystemd<span class="hljs-attribute">-dev</span>  libtool     libudev<span class="hljs-attribute">-dev</span>     mercurial   net<span class="hljs-attribute">-tools</span>   pkg<span class="hljs-attribute">-config</span>  protobuf<span class="hljs-attribute">-compiler</span>   protobuf<span class="hljs-attribute">-c</span><span class="hljs-attribute">-compiler</span>     python<span class="hljs-attribute">-backports</span><span class="hljs-built_in">.</span>ssl<span class="hljs-attribute">-match</span><span class="hljs-attribute">-hostname</span>     python<span class="hljs-attribute">-dev</span>  python<span class="hljs-attribute">-mock</span>     python<span class="hljs-attribute">-pip</span>  python<span class="hljs-attribute">-requests</span>     python<span class="hljs-attribute">-setuptools</span>   python<span class="hljs-attribute">-websocket</span>    python<span class="hljs-attribute">-wheel</span>    tar     thin<span class="hljs-attribute">-provisioning</span><span class="hljs-attribute">-tools</span>     vim     vim<span class="hljs-attribute">-common</span>  xfsprogs    zip     <span class="hljs-subst">--</span>no<span class="hljs-attribute">-install</span><span class="hljs-attribute">-recommends</span>     <span class="hljs-subst">&amp;&amp;</span> pip install awscli<span class="hljs-subst">==</span><span class="hljs-number">1.10</span><span class="hljs-number">.15</span>
 <span class="hljs-subst">---&gt;</span> Using <span class="hljs-keyword">cache</span>
 <span class="hljs-subst">---&gt;</span> <span class="hljs-number">65e6</span>b480b2aa
Step <span class="hljs-number">5</span>/<span class="hljs-number">39</span> : ENV GO_VERSION <span class="hljs-number">1.8</span><span class="hljs-number">.4</span>
 <span class="hljs-subst">---&gt;</span> Using <span class="hljs-keyword">cache</span>
 <span class="hljs-subst">---&gt;</span> fd97af8ee1ba
Step <span class="hljs-number">6</span>/<span class="hljs-number">39</span> : RUN curl <span class="hljs-attribute">-fsSL</span> <span class="hljs-string">"https://studygolang.com/dl/golang/go${GO_VERSION}.linux-amd64.tar.gz"</span>  <span class="hljs-subst">|</span> tar <span class="hljs-attribute">-xzC</span> /usr/<span class="hljs-built_in">local</span>
 <span class="hljs-subst">---&gt;</span> Running <span class="hljs-keyword">in</span> e405bfebb65e</code></pre> 
  <h2 id="踩过的坑"><strong>踩过的坑</strong></h2> 
  <ul> 
   <li>由于有些下载地址可能被屏蔽，中途的错误可以手动修改，改为国内下载地址，例如：golang的下载地址，各种版本都可以在这个地址找到：<a href="https://studygolang.com/dl" rel="nofollow" target="_blank">https://studygolang.com/dl</a>，我们替换Dockerfile中的地址为国内地址：</li> 
  </ul> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20171031104039950?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2Fycmlvcl8wMzE5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title=""></p> 
  <ul> 
   <li>再次执行 ：sudo make BIND_DIR=. shell,执行到第30步的时候报错：</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs lasso">Step <span class="hljs-number">30</span>/<span class="hljs-number">39</span> : RUN <span class="hljs-built_in">.</span>/contrib/download<span class="hljs-attribute">-frozen</span><span class="hljs-attribute">-image</span><span class="hljs-attribute">-v2</span><span class="hljs-built_in">.</span>sh /docker<span class="hljs-attribute">-frozen</span><span class="hljs-attribute">-images</span>    buildpack<span class="hljs-attribute">-deps</span>:jessie@sha256:<span class="hljs-number">85</span>b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6   busybox:latest@sha256:<span class="hljs-number">32</span>f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f  debian:jessie@sha256:<span class="hljs-number">72</span>f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793   hello<span class="hljs-attribute">-world</span>:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7
 <span class="hljs-subst">---&gt;</span> Running <span class="hljs-keyword">in</span> <span class="hljs-number">73210</span>ada3c34
/usr/bin/env: <span class="hljs-string">'bash1\r'</span>: No such file <span class="hljs-literal">or</span> directory
The command <span class="hljs-string">'/bin/sh -c ./contrib/download-frozen-image-v2.sh /docker-frozen-images buildpack-deps:jessie@sha256:85b379ec16065e4fe4127eb1c5fb1bcc03c559bd36dbb2e22ff496de55925fa6 busybox:latest@sha256:32f093055929dbc23dec4d03e09dfe971f5973a9ca5cf059cbfb644c206aa83f debian:jessie@sha256:72f784399fd2719b4cb4e16ef8e369a39dc67f53d978cd3e2e7bf4e502c7b793 hello-world:latest@sha256:c5515758d4c5e1e838e9cd307f6c6a0d620b5e07e6f927b07d05f6d12a1ac8d7'</span> returned a non<span class="hljs-attribute">-zero</span> code: <span class="hljs-number">127</span>
Makefile:<span class="hljs-number">115</span>: recipe for target <span class="hljs-string">'build'</span> failed
make: <span class="hljs-subst">***</span> <span class="hljs-preprocessor">[</span>build<span class="hljs-preprocessor">]</span><span class="hljs-markup"> Error 127 </span></code></pre> 
  <p>经过分析是因为脚本中存在windows的换行符，使用命令替换掉换行符：</p> 
  <pre class="prettyprint"><code class=" hljs lasso">sed <span class="hljs-attribute">-i</span> <span class="hljs-string">'s/\r$//'</span> contrib/download<span class="hljs-attribute">-frozen</span><span class="hljs-attribute">-image</span><span class="hljs-attribute">-v2</span><span class="hljs-built_in">.</span>sh</code></pre> 
  <p>会把 .sh 中的\r 替换成空白,再次编译，pass </p> 
  <ul> 
   <li>执行过程中，如果发现脚本中用到的有些文件夹不存在，可能是因为权限不够，造成创建的某些文件夹失败，解决方案是切换到root用户下执行：make BIND_DIR=. shell</li> 
   <li>镜像下载慢问题：由于sh脚本中定义的镜像仓库都是国外的仓库，下载镜像比较慢，甚至终端，可以把镜像仓库替换为国内的镜像仓库，例如：download-frozen-image-v2.sh文件中的registryBase</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs bash">registryBase=<span class="hljs-string">'https://registry-1.docker.io'</span>
authBase=<span class="hljs-string">'https://auth.docker.io'</span>
authService=<span class="hljs-string">'registry.docker.io'</span>

替换为：
registryBase=<span class="hljs-string">'https://5162s31v.mirror.aliyuncs.com'</span>
authBase=<span class="hljs-string">'https://auth.docker.io'</span>
authService=<span class="hljs-string">'registry.docker.io'</span>
</code></pre> 
  <p>第33步错误：</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">Step <span class="hljs-number">33</span>/<span class="hljs-number">39</span> : RUN /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter
 <span class="hljs-comment">---&gt; Running in 8f981ec52383</span>
++ dirname /tmp/install-binaries.sh
+ . /tmp/binaries-commits
++ $<span class="hljs-string">'\r'</span>
/tmp/binaries-commits: <span class="hljs-built_in">line</span> <span class="hljs-number">2</span>: $<span class="hljs-string">'\r'</span>: <span class="hljs-command"><span class="hljs-keyword">command</span> <span class="hljs-title">not</span> <span class="hljs-title">found</span></span>
The <span class="hljs-command"><span class="hljs-keyword">command</span> <span class="hljs-string">'/bin/sh -c /tmp/install-binaries.sh tomlv vndr runc containerd tini proxy dockercli gometalinter'</span> <span class="hljs-title">returned</span> <span class="hljs-title">a</span> <span class="hljs-title">non-zero</span> <span class="hljs-title">code</span>: <span class="hljs-title">127</span></span>
Makefile:<span class="hljs-number">115</span>: recipe <span class="hljs-keyword">for</span> target <span class="hljs-string">'build'</span> failed
make: *** [build] Error <span class="hljs-number">127</span>
</code></pre> 
  <p>解决办法1，修改/hack/dockerfile/install-binaries.sh文件</p> 
  <pre class="prettyprint"><code class=" hljs lasso">    url<span class="hljs-subst">=</span>https:<span class="hljs-comment">//download.docker.com/linux/static</span>
    curl <span class="hljs-attribute">-Ls</span> <span class="hljs-variable">$url</span><span class="hljs-subst">/</span><span class="hljs-variable">$DOCKERCLI_CHANNEL</span><span class="hljs-subst">/</span><span class="hljs-variable">$arch</span>/docker<span class="hljs-subst">-</span><span class="hljs-variable">$DOCKERCLI_VERSION.tgz</span> <span class="hljs-subst">|</span> <span class="hljs-subst">\</span>
    tar <span class="hljs-attribute">-xz</span> docker/docker
    mv docker/docker /usr/<span class="hljs-built_in">local</span>/bin<span class="hljs-subst">/</span>
    rmdir docker
改为：
    url<span class="hljs-subst">=</span>https:<span class="hljs-comment">//download.docker.com/linux/static</span>
    curl <span class="hljs-attribute">-o</span> docker<span class="hljs-subst">-</span><span class="hljs-variable">$DOCKERCLI_VERSION.tgz</span> <span class="hljs-variable">$url</span><span class="hljs-subst">/</span><span class="hljs-variable">$DOCKERCLI_CHANNEL</span><span class="hljs-subst">/</span><span class="hljs-variable">$arch</span>/docker<span class="hljs-subst">-</span><span class="hljs-variable">$DOCKERCLI_VERSION.tgz</span> <span class="hljs-subst">|</span> <span class="hljs-subst">\</span>
    tar <span class="hljs-attribute">-xzf</span> docker<span class="hljs-subst">-</span><span class="hljs-variable">$DOCKERCLI_VERSION.tgz</span>
    mv docker/docker /usr/<span class="hljs-built_in">local</span>/bin<span class="hljs-subst">/</span>
    rmdir docker</code></pre> 
  <p>上马的方法如该不行，有个稍微麻烦的办法，自己下载docker-17.06.0-ce.tgz文件：<a href="https://download.docker.com/linux/static/edge/x86_64/docker-17.06.0-ce.tgz" rel="nofollow" target="_blank">https://download.docker.com/linux/static/edge/x86_64/docker-17.06.0-ce.tgz</a>，解压缩，然后放在自己的github上，在github上自己的账户下创建public项目docker，把解压缩的文件上传到githua中。然后修改里面的语句为git clone，具体修改后内容如下：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">        url=https://download<span class="hljs-preprocessor">.docker</span><span class="hljs-preprocessor">.com</span>/linux/static
        git clone https://github<span class="hljs-preprocessor">.com</span>/liujb0319/docker<span class="hljs-preprocessor">.git</span>
        mv docker/docker /usr/local/bin/
        rm -rf docker
</code></pre> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/warrior_0319/article/details/78401948,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/warrior_0319/article/details/78401948,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
