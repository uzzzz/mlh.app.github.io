<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>自动化测试工具QTP：维护对象库、获取对象属性、智能识别、参数化若干问题 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="自动化测试工具QTP：维护对象库、获取对象属性、智能识别、参数化若干问题" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="最近有一个项目，需要批量生产测试数据。原本打算使用LR来自动生成，但是里面涉及到动态数据的获取，而开发不能及时过来说明该取哪些数据，于是放弃使用LR，而改用QTP进行UI操作的重放来生成数据。 在使用QTP的时候，遇到了诸多问题，类似： 1）在已经录制好的脚本中继续录制操作，存在对象识别的问题； 2）通过判断对象的运行时状态，来控制脚本运行； 3）参数化输入数据，及控制脚本运行次数，错误处理等。 下面归纳下解决上述问题的方法或步骤（下述方法都是针对以默认模式录制的脚本）： 1）在录制脚本时，假设某个URL已经关联了某个对象A，如果重新打开该URL并在该脚本中继续录制操作，则QTP则标识该URL对应的web页面为新的ID。 CTRL + R打开对象库，如下图： 可以看到有4个是同一个URL在录制多次时，每次都以新名字被识别，如【网上交易-大智慧股份投资有限公司 -_x】，x从1到4，当x为1时被省略了。 &nbsp; 而这时的脚本类似于如下代码： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;xxx&quot; 从上述代码中可以看到，脚本产生了两个Browser对象。 &nbsp; 运行上述代码，可以发现在行： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; 处产生了如下错误： &nbsp; 虽然错误信息显示“无法表示对象custId”，但归根结底，还是因为QTP没有在当前应用程序（IE浏览器）上发现相应的对象【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;)】的原因。也就是说，当前应用程序上只创建了【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;)】对象，并没有创建【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;)】对象。 解决方法： 设我们维护的QTP对象是a和b，a和b关联的实际上是同一URL页面（例如https://www.gw.com.cn）。对象a中已经录入控件对象1,2，尚未录入对象3和4，但对象b中已经录入控件对象3,4。现在我们就是要把b中录入的对象移入到对象a中。 遵循下述步骤完成对象库维护： 步骤1：找到b中需要移入到a中对象； 步骤2：直接拖入到对象a中。 步骤3：保存脚本，运行看是否已经识别出对象3,4（以不报错为标准）。 &nbsp; 2）web页面上在运行时，上面的一些内容（包括文字、连接、图片等）的状态可能会发生改变，这时可以通过判断某些内容的运行时状态来控制脚本的运行。 例如，一个用户在初次登陆&nbsp;https://fund.wg.com.cn/account/login.jsp后，打开其个人中心，如果该用户是大智慧交易网站的认证直销用户，则会显示一个【认证直销用户】链接： 在QTP脚本中，该对象为： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;) 但是如果用户不是认证直销用户，则在web页面上看不到该连接，也就是说该连接不存在的。在QTP中，就是说这个link的Exist状态为false。 我们可以通过判断该对象是否存在来控制脚本运行路径，代码如下： If not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;).Exist then Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).Click Else &#39; Dim MyVar3 &#39;myvar3 = MsgBox (&quot;Hello World!&quot;, 65, &quot;不可绑定&quot;) End If 上述脚本原理是正确的，但是在运行过程中发现，每次运行时，明明对象不存在该link，QTP仍然认为该link存在。 于是将智能识别先设定为disable，问题解决。 Dim App Set App = CreateObject(&quot;QuickTest.Application&quot;) App.Test.Settings.Run.DisableSmartIdentification = True &#39;先禁止智能识别 但是有时如果不对对象进行智能识别，则可能在运行时会报错“找不到对象”。此时把智能识别开启： App.Test.Settings.Run.DisableSmartIdentification = false &#39;启动智能识别 当然如果需要在整个脚本运行期间启动或禁止智能识别，一是点击菜单【文件】/【设置】打开【测试设置】对话框，在左侧树结构中点击【运行】，取消或勾选复选框【运行会话期间禁用智能标识】，二是像上文所说在脚本开头用脚本语句控制。 总结：何时启动或关闭智能识别，暂时没有找到规律，有知道的朋友知会下，非常感谢。我的个人经验是：通过调试，自己确定应该在合适开启或关闭智能识别。 &nbsp; 3）关于参数化、循环次数、错误控制等 我们录制一个QTP脚本，目的肯定不是只为了让脚本运行一次。我们可能想让脚本执行比较简单但步骤繁琐，足以让人觉得厌烦的操作，或者是让脚本自动运行以产生大批量数据。 那么就涉及到参数化了。 如果对QTP的脚本语言（VBS）不是很熟悉，那么就需要打开“关键字视图”，使脚本显示为一种操作序列形式，非常易于理解。点击菜单栏的【视图】/【关键字视图】即可。如下图所示： 图 关键字视图 &nbsp; 常量的参数化的操作是这样的： 在关键字视图中，点击值列表中的某个需要参数化的常量，在右键出现的“配置值”按钮（形如&lt;#&gt;）上点击，弹出“值配置选项”对话框，如下： 图 值配置选项 上图中将常量“李四”参数化了，它的参数值类型是Data Table，取当前操作工作表中的p_Text列的值（参数必须和表的列名一致）。 现在我们已经设置好了参数化的配置，接下来就是要将参数文件导入到QTP中。 在QTP的数据表中的数据可以通过在数据表的空白处点击右键，然后导入文件或数据表。选择【文件】-&gt;【从文件导入】则可以将数据从文件导入，或者选择【数据表】-&gt;【导入】-&gt;【从文件】选择参数文件。需要说明的是，在用数据表导入的时候，参数文件中列之间必须以tab分隔，不能使用csv。 其实，在VBS视图中，可以看得更清楚： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set DataTable(&quot;p_tel&quot;, dtLocalSheet) 即DataTable(&quot;p_tel&quot;, dtLocalSheet)替代了原来录制脚本时的常量。 &nbsp; 参数化完成后 ，QTP默认循环读取数据表中的数据。我们可以在测试设置中设置循环次数，或者控制运行错误期间发生的错误如何处理。 在上图中，数字2指示的【运行会话期间发生错误】下拉框中包含几个选项“弹出式消息框”、“继续下一操作循环”、“停止运行”、“继续下一步骤”等。我们如果希望脚本在发生错误时依然能执行下一循环，则选择“继续下一操作循环”即可。 另外，根据业务需求，可以修改“对象同步超时”时间，设置适当的话可以节省大量运行时间。 &nbsp; 至此，本次测试中的一些关键问题已经解决。脚本也能够正常工作，下面为完整脚本。 &#39;start step1、取参数---------------------------------------------------------- Dim mytel,myid,mybankid Dim oldtel,oldid,oldbankid oldtel = DataTable(&quot;p_tel&quot;, dtLocalSheet) oldid = DataTable(&quot;p_certid&quot;, dtLocalSheet) oldbankid = DataTable(&quot;p_bankno&quot;, dtLocalSheet) mytel = Replace(oldtel,&quot;&#39;&quot;,&quot;&quot;) myid = Replace(oldid,&quot;&#39;&quot;,&quot;&quot;) mybankid = Replace(oldbankid,&quot;&#39;&quot;,&quot;&quot;) &#39;end step1、取参数---------------------------------------------------------- &#39;start step2、---------------------------------------------------------- Dim App Set App = CreateObject(&quot;QuickTest.Application&quot;) App.Test.Settings.Run.DisableSmartIdentification = True &#39;先禁止智能识别 &#39;begin关闭所有打开窗口，并打开url：https://fund.wg.com.cn/account/login.jsp Set ie = Description.Create() ie(&quot;micclass&quot;).value = &quot;Browser&quot; For i = 0 to desktop.ChildObjects(ie).count - 1 desktop.ChildObjects(ie).item(0).close Next SystemUtil.Run&quot;C:\Program Files\Internet Explorer\IEXPLORE.EXE&quot;,&quot;https://fund.wg.com.cn/account/login.jsp&quot; &#39;end &#39;&#39;end step2、---------------------------------------------------------- &#39;start step3、---------------------------------------------------------- &#39;begin 如果有输入用户名密码框，则输入用户名密码，继续执行；否则用户退出。 If Not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Exist Then &#39;没有输入用户名编辑框 If Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;【安全退出】&quot;).Exist then Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;【安全退出】&quot;).Click else Dim MyVar myvar = MsgBox (&quot;Hello World!&quot;, 65, &quot;没有安全退出按钮&quot;) end if else &#39;有输入用户名编辑框：可登陆 &#39;Dim MyVar2 &#39;myvar2 = MsgBox (&quot;Hello World!&quot;, 65, &quot;有输入用户名编辑框&quot;) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set mytel&#39;DataTable(&quot;p_tel&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;525792d79d8ab2d816cc0261039e2cfc697f&quot; Set WshShell =createobject(&quot;WScript.shell&quot;) WshShell.Sendkeys &quot;{ENTER}&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;我的账户&quot;).Click &#39;已经进入我的账户 &#39;判断是否有【绑定新的银行卡】连接（link） &#39; If Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).GetROProperty(&quot;visible&quot;) Then &#39;可绑定 If not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;).Exist then &#39;Dim MyVar4 &#39;myvar4= MsgBox (&quot;Hello World!&quot;, 65, &quot;可绑定&quot;) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebElement(&quot;WebElement&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;userRealName&quot;).Set &quot;李四&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;gender&quot;).Select &quot;男&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;vocation&quot;).Select &quot;专业技术&nbsp;&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;identityType&quot;).Select &quot;身份证&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;identityNo&quot;).Set myid&#39;DataTable(&quot;p_certid&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;bankCardNo&quot;).Set mybankid&#39;DataTable(&quot;p_bankno&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).WebList(&quot;select&quot;).Select &quot;上海市&nbsp;&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;addAheadInfo&quot;).Set &quot;上海市&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;zipCode&quot;).Set &quot;200200&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;addEndInfo&quot;).Set &quot;杨高南路&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).WebCheckBox(&quot;WebCheckBox&quot;).Set &quot;ON&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;password&quot;).SetSecure &quot;52579712499e3140b576ee2c79e18cd6a8a0&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;WebEdit&quot;).SetSecure &quot;525797140404640472cc439e6dbee5623f16&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebCheckBox(&quot;WebCheckBox&quot;).Set &quot;ON&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebElement(&quot;WebElement_2&quot;).Click App.Test.Settings.Run.DisableSmartIdentification = false &#39;启动智能识别 Browser(&quot;交易模拟系统&quot;).Page(&quot;交易模拟系统&quot;).WebButton(&quot;成功&quot;).Click &#39;点击成功按钮 Browser(&quot;交易模拟系统&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;关闭本页&quot;).Click &#39;设置IE每次都打开新窗口解决窗口找不到的错误 Browser(&quot;交易模拟系统&quot;).Dialog(&quot;Windows Internet Explorer&quot;).WinButton(&quot;是(Y)&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_4&quot;).Link(&quot;返回首页&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_5&quot;).Link(&quot;【安全退出】&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_5&quot;).Link(&quot;5秒后跳转至系统登录界面如果系统没有响应，请点击此链接&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).Link(&quot;登录&quot;).Click &#39;else &#39; Dim MyVar3 &#39;myvar3 = MsgBox (&quot;Hello World!&quot;, 65, &quot;不可绑定&quot;) End If End If &#39;end &#39;endstep3、---------------------------------------------------------- &nbsp; &nbsp; &nbsp; 阅读更多" />
<meta property="og:description" content="最近有一个项目，需要批量生产测试数据。原本打算使用LR来自动生成，但是里面涉及到动态数据的获取，而开发不能及时过来说明该取哪些数据，于是放弃使用LR，而改用QTP进行UI操作的重放来生成数据。 在使用QTP的时候，遇到了诸多问题，类似： 1）在已经录制好的脚本中继续录制操作，存在对象识别的问题； 2）通过判断对象的运行时状态，来控制脚本运行； 3）参数化输入数据，及控制脚本运行次数，错误处理等。 下面归纳下解决上述问题的方法或步骤（下述方法都是针对以默认模式录制的脚本）： 1）在录制脚本时，假设某个URL已经关联了某个对象A，如果重新打开该URL并在该脚本中继续录制操作，则QTP则标识该URL对应的web页面为新的ID。 CTRL + R打开对象库，如下图： 可以看到有4个是同一个URL在录制多次时，每次都以新名字被识别，如【网上交易-大智慧股份投资有限公司 -_x】，x从1到4，当x为1时被省略了。 &nbsp; 而这时的脚本类似于如下代码： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;xxx&quot; 从上述代码中可以看到，脚本产生了两个Browser对象。 &nbsp; 运行上述代码，可以发现在行： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; 处产生了如下错误： &nbsp; 虽然错误信息显示“无法表示对象custId”，但归根结底，还是因为QTP没有在当前应用程序（IE浏览器）上发现相应的对象【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;)】的原因。也就是说，当前应用程序上只创建了【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;)】对象，并没有创建【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;)】对象。 解决方法： 设我们维护的QTP对象是a和b，a和b关联的实际上是同一URL页面（例如https://www.gw.com.cn）。对象a中已经录入控件对象1,2，尚未录入对象3和4，但对象b中已经录入控件对象3,4。现在我们就是要把b中录入的对象移入到对象a中。 遵循下述步骤完成对象库维护： 步骤1：找到b中需要移入到a中对象； 步骤2：直接拖入到对象a中。 步骤3：保存脚本，运行看是否已经识别出对象3,4（以不报错为标准）。 &nbsp; 2）web页面上在运行时，上面的一些内容（包括文字、连接、图片等）的状态可能会发生改变，这时可以通过判断某些内容的运行时状态来控制脚本的运行。 例如，一个用户在初次登陆&nbsp;https://fund.wg.com.cn/account/login.jsp后，打开其个人中心，如果该用户是大智慧交易网站的认证直销用户，则会显示一个【认证直销用户】链接： 在QTP脚本中，该对象为： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;) 但是如果用户不是认证直销用户，则在web页面上看不到该连接，也就是说该连接不存在的。在QTP中，就是说这个link的Exist状态为false。 我们可以通过判断该对象是否存在来控制脚本运行路径，代码如下： If not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;).Exist then Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).Click Else &#39; Dim MyVar3 &#39;myvar3 = MsgBox (&quot;Hello World!&quot;, 65, &quot;不可绑定&quot;) End If 上述脚本原理是正确的，但是在运行过程中发现，每次运行时，明明对象不存在该link，QTP仍然认为该link存在。 于是将智能识别先设定为disable，问题解决。 Dim App Set App = CreateObject(&quot;QuickTest.Application&quot;) App.Test.Settings.Run.DisableSmartIdentification = True &#39;先禁止智能识别 但是有时如果不对对象进行智能识别，则可能在运行时会报错“找不到对象”。此时把智能识别开启： App.Test.Settings.Run.DisableSmartIdentification = false &#39;启动智能识别 当然如果需要在整个脚本运行期间启动或禁止智能识别，一是点击菜单【文件】/【设置】打开【测试设置】对话框，在左侧树结构中点击【运行】，取消或勾选复选框【运行会话期间禁用智能标识】，二是像上文所说在脚本开头用脚本语句控制。 总结：何时启动或关闭智能识别，暂时没有找到规律，有知道的朋友知会下，非常感谢。我的个人经验是：通过调试，自己确定应该在合适开启或关闭智能识别。 &nbsp; 3）关于参数化、循环次数、错误控制等 我们录制一个QTP脚本，目的肯定不是只为了让脚本运行一次。我们可能想让脚本执行比较简单但步骤繁琐，足以让人觉得厌烦的操作，或者是让脚本自动运行以产生大批量数据。 那么就涉及到参数化了。 如果对QTP的脚本语言（VBS）不是很熟悉，那么就需要打开“关键字视图”，使脚本显示为一种操作序列形式，非常易于理解。点击菜单栏的【视图】/【关键字视图】即可。如下图所示： 图 关键字视图 &nbsp; 常量的参数化的操作是这样的： 在关键字视图中，点击值列表中的某个需要参数化的常量，在右键出现的“配置值”按钮（形如&lt;#&gt;）上点击，弹出“值配置选项”对话框，如下： 图 值配置选项 上图中将常量“李四”参数化了，它的参数值类型是Data Table，取当前操作工作表中的p_Text列的值（参数必须和表的列名一致）。 现在我们已经设置好了参数化的配置，接下来就是要将参数文件导入到QTP中。 在QTP的数据表中的数据可以通过在数据表的空白处点击右键，然后导入文件或数据表。选择【文件】-&gt;【从文件导入】则可以将数据从文件导入，或者选择【数据表】-&gt;【导入】-&gt;【从文件】选择参数文件。需要说明的是，在用数据表导入的时候，参数文件中列之间必须以tab分隔，不能使用csv。 其实，在VBS视图中，可以看得更清楚： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set DataTable(&quot;p_tel&quot;, dtLocalSheet) 即DataTable(&quot;p_tel&quot;, dtLocalSheet)替代了原来录制脚本时的常量。 &nbsp; 参数化完成后 ，QTP默认循环读取数据表中的数据。我们可以在测试设置中设置循环次数，或者控制运行错误期间发生的错误如何处理。 在上图中，数字2指示的【运行会话期间发生错误】下拉框中包含几个选项“弹出式消息框”、“继续下一操作循环”、“停止运行”、“继续下一步骤”等。我们如果希望脚本在发生错误时依然能执行下一循环，则选择“继续下一操作循环”即可。 另外，根据业务需求，可以修改“对象同步超时”时间，设置适当的话可以节省大量运行时间。 &nbsp; 至此，本次测试中的一些关键问题已经解决。脚本也能够正常工作，下面为完整脚本。 &#39;start step1、取参数---------------------------------------------------------- Dim mytel,myid,mybankid Dim oldtel,oldid,oldbankid oldtel = DataTable(&quot;p_tel&quot;, dtLocalSheet) oldid = DataTable(&quot;p_certid&quot;, dtLocalSheet) oldbankid = DataTable(&quot;p_bankno&quot;, dtLocalSheet) mytel = Replace(oldtel,&quot;&#39;&quot;,&quot;&quot;) myid = Replace(oldid,&quot;&#39;&quot;,&quot;&quot;) mybankid = Replace(oldbankid,&quot;&#39;&quot;,&quot;&quot;) &#39;end step1、取参数---------------------------------------------------------- &#39;start step2、---------------------------------------------------------- Dim App Set App = CreateObject(&quot;QuickTest.Application&quot;) App.Test.Settings.Run.DisableSmartIdentification = True &#39;先禁止智能识别 &#39;begin关闭所有打开窗口，并打开url：https://fund.wg.com.cn/account/login.jsp Set ie = Description.Create() ie(&quot;micclass&quot;).value = &quot;Browser&quot; For i = 0 to desktop.ChildObjects(ie).count - 1 desktop.ChildObjects(ie).item(0).close Next SystemUtil.Run&quot;C:\Program Files\Internet Explorer\IEXPLORE.EXE&quot;,&quot;https://fund.wg.com.cn/account/login.jsp&quot; &#39;end &#39;&#39;end step2、---------------------------------------------------------- &#39;start step3、---------------------------------------------------------- &#39;begin 如果有输入用户名密码框，则输入用户名密码，继续执行；否则用户退出。 If Not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Exist Then &#39;没有输入用户名编辑框 If Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;【安全退出】&quot;).Exist then Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;【安全退出】&quot;).Click else Dim MyVar myvar = MsgBox (&quot;Hello World!&quot;, 65, &quot;没有安全退出按钮&quot;) end if else &#39;有输入用户名编辑框：可登陆 &#39;Dim MyVar2 &#39;myvar2 = MsgBox (&quot;Hello World!&quot;, 65, &quot;有输入用户名编辑框&quot;) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set mytel&#39;DataTable(&quot;p_tel&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;525792d79d8ab2d816cc0261039e2cfc697f&quot; Set WshShell =createobject(&quot;WScript.shell&quot;) WshShell.Sendkeys &quot;{ENTER}&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;我的账户&quot;).Click &#39;已经进入我的账户 &#39;判断是否有【绑定新的银行卡】连接（link） &#39; If Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).GetROProperty(&quot;visible&quot;) Then &#39;可绑定 If not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;).Exist then &#39;Dim MyVar4 &#39;myvar4= MsgBox (&quot;Hello World!&quot;, 65, &quot;可绑定&quot;) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebElement(&quot;WebElement&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;userRealName&quot;).Set &quot;李四&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;gender&quot;).Select &quot;男&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;vocation&quot;).Select &quot;专业技术&nbsp;&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;identityType&quot;).Select &quot;身份证&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;identityNo&quot;).Set myid&#39;DataTable(&quot;p_certid&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;bankCardNo&quot;).Set mybankid&#39;DataTable(&quot;p_bankno&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).WebList(&quot;select&quot;).Select &quot;上海市&nbsp;&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;addAheadInfo&quot;).Set &quot;上海市&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;zipCode&quot;).Set &quot;200200&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;addEndInfo&quot;).Set &quot;杨高南路&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).WebCheckBox(&quot;WebCheckBox&quot;).Set &quot;ON&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;password&quot;).SetSecure &quot;52579712499e3140b576ee2c79e18cd6a8a0&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;WebEdit&quot;).SetSecure &quot;525797140404640472cc439e6dbee5623f16&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebCheckBox(&quot;WebCheckBox&quot;).Set &quot;ON&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebElement(&quot;WebElement_2&quot;).Click App.Test.Settings.Run.DisableSmartIdentification = false &#39;启动智能识别 Browser(&quot;交易模拟系统&quot;).Page(&quot;交易模拟系统&quot;).WebButton(&quot;成功&quot;).Click &#39;点击成功按钮 Browser(&quot;交易模拟系统&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;关闭本页&quot;).Click &#39;设置IE每次都打开新窗口解决窗口找不到的错误 Browser(&quot;交易模拟系统&quot;).Dialog(&quot;Windows Internet Explorer&quot;).WinButton(&quot;是(Y)&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_4&quot;).Link(&quot;返回首页&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_5&quot;).Link(&quot;【安全退出】&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_5&quot;).Link(&quot;5秒后跳转至系统登录界面如果系统没有响应，请点击此链接&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).Link(&quot;登录&quot;).Click &#39;else &#39; Dim MyVar3 &#39;myvar3 = MsgBox (&quot;Hello World!&quot;, 65, &quot;不可绑定&quot;) End If End If &#39;end &#39;endstep3、---------------------------------------------------------- &nbsp; &nbsp; &nbsp; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2013/10/14/f6609d8aaed30c57522a174eb62381a2.html" />
<meta property="og:url" content="https://mlh.app/2013/10/14/f6609d8aaed30c57522a174eb62381a2.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-10-14T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"最近有一个项目，需要批量生产测试数据。原本打算使用LR来自动生成，但是里面涉及到动态数据的获取，而开发不能及时过来说明该取哪些数据，于是放弃使用LR，而改用QTP进行UI操作的重放来生成数据。 在使用QTP的时候，遇到了诸多问题，类似： 1）在已经录制好的脚本中继续录制操作，存在对象识别的问题； 2）通过判断对象的运行时状态，来控制脚本运行； 3）参数化输入数据，及控制脚本运行次数，错误处理等。 下面归纳下解决上述问题的方法或步骤（下述方法都是针对以默认模式录制的脚本）： 1）在录制脚本时，假设某个URL已经关联了某个对象A，如果重新打开该URL并在该脚本中继续录制操作，则QTP则标识该URL对应的web页面为新的ID。 CTRL + R打开对象库，如下图： 可以看到有4个是同一个URL在录制多次时，每次都以新名字被识别，如【网上交易-大智慧股份投资有限公司 -_x】，x从1到4，当x为1时被省略了。 &nbsp; 而这时的脚本类似于如下代码： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;xxx&quot; 从上述代码中可以看到，脚本产生了两个Browser对象。 &nbsp; 运行上述代码，可以发现在行： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set &quot;xxx&quot; 处产生了如下错误： &nbsp; 虽然错误信息显示“无法表示对象custId”，但归根结底，还是因为QTP没有在当前应用程序（IE浏览器）上发现相应的对象【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;)】的原因。也就是说，当前应用程序上只创建了【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;)】对象，并没有创建【Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;)】对象。 解决方法： 设我们维护的QTP对象是a和b，a和b关联的实际上是同一URL页面（例如https://www.gw.com.cn）。对象a中已经录入控件对象1,2，尚未录入对象3和4，但对象b中已经录入控件对象3,4。现在我们就是要把b中录入的对象移入到对象a中。 遵循下述步骤完成对象库维护： 步骤1：找到b中需要移入到a中对象； 步骤2：直接拖入到对象a中。 步骤3：保存脚本，运行看是否已经识别出对象3,4（以不报错为标准）。 &nbsp; 2）web页面上在运行时，上面的一些内容（包括文字、连接、图片等）的状态可能会发生改变，这时可以通过判断某些内容的运行时状态来控制脚本的运行。 例如，一个用户在初次登陆&nbsp;https://fund.wg.com.cn/account/login.jsp后，打开其个人中心，如果该用户是大智慧交易网站的认证直销用户，则会显示一个【认证直销用户】链接： 在QTP脚本中，该对象为： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;) 但是如果用户不是认证直销用户，则在web页面上看不到该连接，也就是说该连接不存在的。在QTP中，就是说这个link的Exist状态为false。 我们可以通过判断该对象是否存在来控制脚本运行路径，代码如下： If not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;).Exist then Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).Click Else &#39; Dim MyVar3 &#39;myvar3 = MsgBox (&quot;Hello World!&quot;, 65, &quot;不可绑定&quot;) End If 上述脚本原理是正确的，但是在运行过程中发现，每次运行时，明明对象不存在该link，QTP仍然认为该link存在。 于是将智能识别先设定为disable，问题解决。 Dim App Set App = CreateObject(&quot;QuickTest.Application&quot;) App.Test.Settings.Run.DisableSmartIdentification = True &#39;先禁止智能识别 但是有时如果不对对象进行智能识别，则可能在运行时会报错“找不到对象”。此时把智能识别开启： App.Test.Settings.Run.DisableSmartIdentification = false &#39;启动智能识别 当然如果需要在整个脚本运行期间启动或禁止智能识别，一是点击菜单【文件】/【设置】打开【测试设置】对话框，在左侧树结构中点击【运行】，取消或勾选复选框【运行会话期间禁用智能标识】，二是像上文所说在脚本开头用脚本语句控制。 总结：何时启动或关闭智能识别，暂时没有找到规律，有知道的朋友知会下，非常感谢。我的个人经验是：通过调试，自己确定应该在合适开启或关闭智能识别。 &nbsp; 3）关于参数化、循环次数、错误控制等 我们录制一个QTP脚本，目的肯定不是只为了让脚本运行一次。我们可能想让脚本执行比较简单但步骤繁琐，足以让人觉得厌烦的操作，或者是让脚本自动运行以产生大批量数据。 那么就涉及到参数化了。 如果对QTP的脚本语言（VBS）不是很熟悉，那么就需要打开“关键字视图”，使脚本显示为一种操作序列形式，非常易于理解。点击菜单栏的【视图】/【关键字视图】即可。如下图所示： 图 关键字视图 &nbsp; 常量的参数化的操作是这样的： 在关键字视图中，点击值列表中的某个需要参数化的常量，在右键出现的“配置值”按钮（形如&lt;#&gt;）上点击，弹出“值配置选项”对话框，如下： 图 值配置选项 上图中将常量“李四”参数化了，它的参数值类型是Data Table，取当前操作工作表中的p_Text列的值（参数必须和表的列名一致）。 现在我们已经设置好了参数化的配置，接下来就是要将参数文件导入到QTP中。 在QTP的数据表中的数据可以通过在数据表的空白处点击右键，然后导入文件或数据表。选择【文件】-&gt;【从文件导入】则可以将数据从文件导入，或者选择【数据表】-&gt;【导入】-&gt;【从文件】选择参数文件。需要说明的是，在用数据表导入的时候，参数文件中列之间必须以tab分隔，不能使用csv。 其实，在VBS视图中，可以看得更清楚： Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set DataTable(&quot;p_tel&quot;, dtLocalSheet) 即DataTable(&quot;p_tel&quot;, dtLocalSheet)替代了原来录制脚本时的常量。 &nbsp; 参数化完成后 ，QTP默认循环读取数据表中的数据。我们可以在测试设置中设置循环次数，或者控制运行错误期间发生的错误如何处理。 在上图中，数字2指示的【运行会话期间发生错误】下拉框中包含几个选项“弹出式消息框”、“继续下一操作循环”、“停止运行”、“继续下一步骤”等。我们如果希望脚本在发生错误时依然能执行下一循环，则选择“继续下一操作循环”即可。 另外，根据业务需求，可以修改“对象同步超时”时间，设置适当的话可以节省大量运行时间。 &nbsp; 至此，本次测试中的一些关键问题已经解决。脚本也能够正常工作，下面为完整脚本。 &#39;start step1、取参数---------------------------------------------------------- Dim mytel,myid,mybankid Dim oldtel,oldid,oldbankid oldtel = DataTable(&quot;p_tel&quot;, dtLocalSheet) oldid = DataTable(&quot;p_certid&quot;, dtLocalSheet) oldbankid = DataTable(&quot;p_bankno&quot;, dtLocalSheet) mytel = Replace(oldtel,&quot;&#39;&quot;,&quot;&quot;) myid = Replace(oldid,&quot;&#39;&quot;,&quot;&quot;) mybankid = Replace(oldbankid,&quot;&#39;&quot;,&quot;&quot;) &#39;end step1、取参数---------------------------------------------------------- &#39;start step2、---------------------------------------------------------- Dim App Set App = CreateObject(&quot;QuickTest.Application&quot;) App.Test.Settings.Run.DisableSmartIdentification = True &#39;先禁止智能识别 &#39;begin关闭所有打开窗口，并打开url：https://fund.wg.com.cn/account/login.jsp Set ie = Description.Create() ie(&quot;micclass&quot;).value = &quot;Browser&quot; For i = 0 to desktop.ChildObjects(ie).count - 1 desktop.ChildObjects(ie).item(0).close Next SystemUtil.Run&quot;C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE&quot;,&quot;https://fund.wg.com.cn/account/login.jsp&quot; &#39;end &#39;&#39;end step2、---------------------------------------------------------- &#39;start step3、---------------------------------------------------------- &#39;begin 如果有输入用户名密码框，则输入用户名密码，继续执行；否则用户退出。 If Not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Exist Then &#39;没有输入用户名编辑框 If Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;【安全退出】&quot;).Exist then Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;【安全退出】&quot;).Click else Dim MyVar myvar = MsgBox (&quot;Hello World!&quot;, 65, &quot;没有安全退出按钮&quot;) end if else &#39;有输入用户名编辑框：可登陆 &#39;Dim MyVar2 &#39;myvar2 = MsgBox (&quot;Hello World!&quot;, 65, &quot;有输入用户名编辑框&quot;) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custId&quot;).Set mytel&#39;DataTable(&quot;p_tel&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).WebEdit(&quot;custPassword&quot;).SetSecure &quot;525792d79d8ab2d816cc0261039e2cfc697f&quot; Set WshShell =createobject(&quot;WScript.shell&quot;) WshShell.Sendkeys &quot;{ENTER}&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;我的账户&quot;).Click &#39;已经进入我的账户 &#39;判断是否有【绑定新的银行卡】连接（link） &#39; If Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).GetROProperty(&quot;visible&quot;) Then &#39;可绑定 If not Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;认证直销用户&quot;).Exist then &#39;Dim MyVar4 &#39;myvar4= MsgBox (&quot;Hello World!&quot;, 65, &quot;可绑定&quot;) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Link(&quot;绑定新的银行卡&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebElement(&quot;WebElement&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;userRealName&quot;).Set &quot;李四&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;gender&quot;).Select &quot;男&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;vocation&quot;).Select &quot;专业技术&nbsp;&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebList(&quot;identityType&quot;).Select &quot;身份证&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;identityNo&quot;).Set myid&#39;DataTable(&quot;p_certid&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;bankCardNo&quot;).Set mybankid&#39;DataTable(&quot;p_bankno&quot;, dtLocalSheet) Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).WebList(&quot;select&quot;).Select &quot;上海市&nbsp;&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;addAheadInfo&quot;).Set &quot;上海市&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;zipCode&quot;).Set &quot;200200&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;addEndInfo&quot;).Set &quot;杨高南路&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).WebCheckBox(&quot;WebCheckBox&quot;).Set &quot;ON&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;password&quot;).SetSecure &quot;52579712499e3140b576ee2c79e18cd6a8a0&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebEdit(&quot;WebEdit&quot;).SetSecure &quot;525797140404640472cc439e6dbee5623f16&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebCheckBox(&quot;WebCheckBox&quot;).Set &quot;ON&quot; Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).WebElement(&quot;WebElement_2&quot;).Click App.Test.Settings.Run.DisableSmartIdentification = false &#39;启动智能识别 Browser(&quot;交易模拟系统&quot;).Page(&quot;交易模拟系统&quot;).WebButton(&quot;成功&quot;).Click &#39;点击成功按钮 Browser(&quot;交易模拟系统&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Link(&quot;关闭本页&quot;).Click &#39;设置IE每次都打开新窗口解决窗口找不到的错误 Browser(&quot;交易模拟系统&quot;).Dialog(&quot;Windows Internet Explorer&quot;).WinButton(&quot;是(Y)&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_4&quot;).Link(&quot;返回首页&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_5&quot;).Link(&quot;【安全退出】&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_2&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_5&quot;).Link(&quot;5秒后跳转至系统登录界面如果系统没有响应，请点击此链接&quot;).Click Browser(&quot;网上交易 - 上海大智慧投资咨询有限公司 -&quot;).Page(&quot;网上交易 - 上海大智慧投资咨询有限公司 -_3&quot;).Link(&quot;登录&quot;).Click &#39;else &#39; Dim MyVar3 &#39;myvar3 = MsgBox (&quot;Hello World!&quot;, 65, &quot;不可绑定&quot;) End If End If &#39;end &#39;endstep3、---------------------------------------------------------- &nbsp; &nbsp; &nbsp; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2013/10/14/f6609d8aaed30c57522a174eb62381a2.html","headline":"自动化测试工具QTP：维护对象库、获取对象属性、智能识别、参数化若干问题","dateModified":"2013-10-14T00:00:00+08:00","datePublished":"2013-10-14T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2013/10/14/f6609d8aaed30c57522a174eb62381a2.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>自动化测试工具QTP：维护对象库、获取对象属性、智能识别、参数化若干问题</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>最近有一个项目，需要批量生产测试数据。原本打算使用LR来自动生成，但是里面涉及到动态数据的获取，而开发不能及时过来说明该取哪些数据，于是放弃使用LR，而改用QTP进行UI操作的重放来生成数据。</p> 
  <p>在使用QTP的时候，遇到了诸多问题，类似：</p> 
  <p>1）在已经录制好的脚本中继续录制操作，存在对象识别的问题；</p> 
  <p>2）通过判断对象的运行时状态，来控制脚本运行；</p> 
  <p>3）参数化输入数据，及控制脚本运行次数，错误处理等。</p> 
  <p>下面归纳下解决上述问题的方法或步骤（下述方法都是针对以默认模式录制的脚本）：</p> 
  <p>1）在录制脚本时，假设某个URL已经关联了某个对象A，如果重新打开该URL并在该脚本中继续录制操作，则QTP则标识该URL对应的web页面为新的ID。</p> 
  <p>CTRL + R打开对象库，如下图：</p> 
  <p><img alt="" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20131014153320515?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWp1cGl0ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"></p> 
  <p>可以看到有4个是同一个URL在录制多次时，每次都以新名字被识别，如【网上交易-大智慧股份投资有限公司 -_x】，x从1到4，当x为1时被省略了。</p> 
  <p>&nbsp;</p> 
  <p>而这时的脚本类似于如下代码：</p> 
  <pre><code class="language-vb">Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custId").Set "xxx"
Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custPassword").SetSecure "xxx"


Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custId").Set "xxx"
Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custPassword").SetSecure "xxx"

</code></pre> 
  <p>从上述代码中可以看到，脚本产生了两个Browser对象。</p> 
  <p>&nbsp;</p> 
  <p>运行上述代码，可以发现在行：</p> 
  <pre><code class="language-vb">Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custId").Set "xxx"

</code></pre> 
  <p>处产生了如下错误：<br> &nbsp;<img alt="" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20131014165347937?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWp1cGl0ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"></p> 
  <p>虽然错误信息显示“无法表示对象custId”，但归根结底，还是因为QTP没有在当前应用程序（IE浏览器）上发现相应的对象【Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2")】的原因。也就是说，当前应用程序上只创建了【Browser("网上交易 - 上海大智慧投资咨询有限公司 -")】对象，并没有创建【Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2")】对象。</p> 
  <p><br> 解决方法：</p> 
  <p>设我们维护的QTP对象是a和b，a和b关联的实际上是同一URL页面（例如<a href="https://fund.wg.com.cn/account/login.jsp" rel="nofollow">https://www.gw.com.cn</a>）。对象a中已经录入控件对象1,2，尚未录入对象3和4，但对象b中已经录入控件对象3,4。现在我们就是要把b中录入的对象移入到对象a中。</p> 
  <p>遵循下述步骤完成对象库维护：</p> 
  <p>步骤1：找到b中需要移入到a中对象；</p> 
  <p>步骤2：直接拖入到对象a中。</p> 
  <p>步骤3：保存脚本，运行看是否已经识别出对象3,4（以不报错为标准）。</p> 
  <p>&nbsp;</p> 
  <p>2）web页面上在运行时，上面的一些内容（包括文字、连接、图片等）的状态可能会发生改变，这时可以通过判断某些内容的运行时状态来控制脚本的运行。</p> 
  <p>例如，一个用户在初次登陆&nbsp;<a href="https://fund.wg.com.cn/account/login.jsp" rel="nofollow">https://fund.wg.com.cn/account/login.jsp</a>后，打开其个人中心，如果该用户是大智慧交易网站的认证直销用户，则会显示一个【认证直销用户】链接：</p> 
  <p><img alt="" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20131014172643000?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWp1cGl0ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"></p> 
  <p>在QTP脚本中，该对象为：</p> 
  <pre><code class="language-vb">Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").Link("认证直销用户")</code></pre> 
  <p>但是如果用户不是认证直销用户，则在web页面上看不到该连接，也就是说该连接不存在的。在QTP中，就是说这个link的Exist状态为false。</p> 
  <p>我们可以通过判断该对象是否存在来控制脚本运行路径，代码如下：</p> 
  <pre><code class="language-vb">If  not Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").Link("认证直销用户").Exist then    
Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").Link("绑定新的银行卡").Click  
Else  ' Dim MyVar3  'myvar3 = MsgBox ("Hello World!", 65, "不可绑定")    
End If </code></pre> 
  <p>上述脚本原理是正确的，但是在运行过程中发现，每次运行时，明明对象不存在该link，QTP仍然认为该link存在。</p> 
  <p>于是将智能识别先设定为disable，问题解决。</p> 
  <pre><code class="language-vb">Dim App
Set App = CreateObject("QuickTest.Application")
App.Test.Settings.Run.DisableSmartIdentification = True  '先禁止智能识别</code></pre> 
  <p>但是有时如果不对对象进行智能识别，则可能在运行时会报错“找不到对象”。此时把智能识别开启：</p> 
  <pre><code class="language-vb">App.Test.Settings.Run.DisableSmartIdentification = false   '启动智能识别</code></pre> 
  <p>当然如果需要在整个脚本运行期间启动或禁止智能识别，一是点击菜单【文件】/【设置】打开【测试设置】对话框，在左侧树结构中点击【运行】，取消或勾选复选框【运行会话期间禁用智能标识】，二是像上文所说在脚本开头用脚本语句控制。</p> 
  <p>总结：何时启动或关闭智能识别，暂时没有找到规律，有知道的朋友知会下，非常感谢。我的个人经验是：通过调试，自己确定应该在合适开启或关闭智能识别。</p> 
  <p>&nbsp;</p> 
  <p>3）关于参数化、循环次数、错误控制等</p> 
  <p>我们录制一个QTP脚本，目的肯定不是只为了让脚本运行一次。我们可能想让脚本执行比较简单但步骤繁琐，足以让人觉得厌烦的操作，或者是让脚本自动运行以产生大批量数据。</p> 
  <p>那么就涉及到参数化了。</p> 
  <p>如果对QTP的脚本语言（VBS）不是很熟悉，那么就需要打开“关键字视图”，使脚本显示为一种操作序列形式，非常易于理解。点击菜单栏的【视图】/【关键字视图】即可。如下图所示：</p> 
  <p><img alt="" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20131015094052265?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWp1cGl0ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"></p> 
  <p>图 关键字视图</p> 
  <p>&nbsp;</p> 
  <p>常量的参数化的操作是这样的：</p> 
  <p>在关键字视图中，点击值列表中的某个需要参数化的常量，在右键出现的“配置值”按钮（形如&lt;#&gt;）上点击，弹出“值配置选项”对话框，如下：</p> 
  <p><img alt="" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20131015101110453?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWp1cGl0ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"></p> 
  <p>图 值配置选项</p> 
  <p>上图中将常量“李四”参数化了，它的参数值类型是Data Table，取当前操作工作表中的p_Text列的值（参数必须和表的列名一致）。</p> 
  <p>现在我们已经设置好了参数化的配置，接下来就是要将参数文件导入到QTP中。</p> 
  <p>在QTP的数据表中的数据可以通过在数据表的空白处点击右键，然后导入文件或数据表。选择【文件】-&gt;【从文件导入】则可以将数据从文件导入，或者选择【数据表】-&gt;【导入】-&gt;【从文件】选择参数文件。需要说明的是，在用数据表导入的时候，参数文件中列之间必须以tab分隔，不能使用csv。</p> 
  <p><br> 其实，在VBS视图中，可以看得更清楚：</p> 
  <pre><code class="language-vb">Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custId").Set DataTable("p_tel", dtLocalSheet)</code></pre> 
  <p>即DataTable("p_tel", dtLocalSheet)替代了原来录制脚本时的常量。</p> 
  <p>&nbsp;</p> 
  <p>参数化完成后 ，QTP默认循环读取数据表中的数据。我们可以在测试设置中设置循环次数，或者控制运行错误期间发生的错误如何处理。</p> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20131015102718875?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYWp1cGl0ZXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p> 
  <p>在上图中，数字2指示的【运行会话期间发生错误】下拉框中包含几个选项“弹出式消息框”、“继续下一操作循环”、“停止运行”、“继续下一步骤”等。我们如果希望脚本在发生错误时依然能执行下一循环，则选择“继续下一操作循环”即可。</p> 
  <p>另外，根据业务需求，可以修改“对象同步超时”时间，设置适当的话可以节省大量运行时间。</p> 
  <p>&nbsp;</p> 
  <p>至此，本次测试中的一些关键问题已经解决。脚本也能够正常工作，下面为完整脚本。</p> 
  <pre><code class="language-vb">'start step1、取参数----------------------------------------------------------
Dim mytel,myid,mybankid
Dim oldtel,oldid,oldbankid
oldtel = DataTable("p_tel", dtLocalSheet)
oldid = DataTable("p_certid", dtLocalSheet)
oldbankid = DataTable("p_bankno", dtLocalSheet)
mytel = Replace(oldtel,"'","")
myid = Replace(oldid,"'","")
mybankid = Replace(oldbankid,"'","")
'end step1、取参数----------------------------------------------------------

'start step2、----------------------------------------------------------
Dim App
Set App = CreateObject("QuickTest.Application")
App.Test.Settings.Run.DisableSmartIdentification = True  '先禁止智能识别
'begin关闭所有打开窗口，并打开url：https://fund.wg.com.cn/account/login.jsp
Set ie = Description.Create()
ie("micclass").value  = "Browser"
For i = 0 to desktop.ChildObjects(ie).count - 1
        desktop.ChildObjects(ie).item(0).close
Next

SystemUtil.Run"C:\Program Files\Internet Explorer\IEXPLORE.EXE","https://fund.wg.com.cn/account/login.jsp"

'end 
''end step2、----------------------------------------------------------

'start step3、----------------------------------------------------------
'begin 如果有输入用户名密码框，则输入用户名密码，继续执行；否则用户退出。
If Not Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custId").Exist Then   '没有输入用户名编辑框
	If Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").Link("【安全退出】").Exist then
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").Link("【安全退出】").Click
	else
		Dim MyVar
		myvar = MsgBox ("Hello World!", 65, "没有安全退出按钮")	
	end if
else      '有输入用户名编辑框：可登陆
		'Dim MyVar2
		'myvar2 = MsgBox ("Hello World!", 65, "有输入用户名编辑框")		 

	Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custId").Set mytel'DataTable("p_tel", dtLocalSheet)
	Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -").WebEdit("custPassword").SetSecure "525792d79d8ab2d816cc0261039e2cfc697f"
	Set WshShell =createobject("WScript.shell")
	WshShell.Sendkeys "{ENTER}"
	
	Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -").Link("我的账户").Click
	'已经进入我的账户
	'判断是否有【绑定新的银行卡】连接（link）
'	If  Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").Link("绑定新的银行卡").GetROProperty("visible")  Then   '可绑定
	If  not Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").Link("认证直销用户").Exist then
		'Dim MyVar4
		'myvar4= MsgBox ("Hello World!", 65, "可绑定")	

		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").Link("绑定新的银行卡").Click
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebElement("WebElement").Click
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("userRealName").Set "李四"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebList("gender").Select "男"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebList("vocation").Select "专业技术&nbsp;"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebList("identityType").Select "身份证"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("identityNo").Set myid'DataTable("p_certid", dtLocalSheet)
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("bankCardNo").Set mybankid'DataTable("p_bankno", dtLocalSheet)
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").WebList("select").Select "上海市&nbsp;"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("addAheadInfo").Set "上海市"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("zipCode").Set "200200"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("addEndInfo").Set "杨高南路"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -_2").WebCheckBox("WebCheckBox").Set "ON"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("password").SetSecure "52579712499e3140b576ee2c79e18cd6a8a0"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebEdit("WebEdit").SetSecure "525797140404640472cc439e6dbee5623f16"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebCheckBox("WebCheckBox").Set "ON"
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").WebElement("WebElement_2").Click
		App.Test.Settings.Run.DisableSmartIdentification = false   '启动智能识别
		Browser("交易模拟系统").Page("交易模拟系统").WebButton("成功").Click   '点击成功按钮	
		Browser("交易模拟系统").Page("网上交易 - 上海大智慧投资咨询有限公司 -").Link("关闭本页").Click     '设置IE每次都打开新窗口解决窗口找不到的错误
		Browser("交易模拟系统").Dialog("Windows Internet Explorer").WinButton("是(Y)").Click
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_4").Link("返回首页").Click
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_5").Link("【安全退出】").Click
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -_2").Page("网上交易 - 上海大智慧投资咨询有限公司 -_5").Link("5秒后跳转至系统登录界面如果系统没有响应，请点击此链接").Click
		Browser("网上交易 - 上海大智慧投资咨询有限公司 -").Page("网上交易 - 上海大智慧投资咨询有限公司 -_3").Link("登录").Click
	'else
		'	Dim MyVar3
		'myvar3 = MsgBox ("Hello World!", 65, "不可绑定")	
	End If
End If  
'end 
'endstep3、----------------------------------------------------------
</code></pre> 
  <p><br><br><br><br><br> &nbsp;</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ceo158/article/details/12709099,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ceo158/article/details/12709099,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
