<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>分组密码SM4算法的代码实现 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="分组密码SM4算法的代码实现" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SM4分组密码算法，原名SMS4，国家密码管理局于2012年3月21日发布。该算法的分组长度为128比特，密钥长度为128比特。加密算法与密钥扩展算法都采用32轮非线性迭代结构。解密算法与加密算法的结构相同，只是轮密钥的使用顺序相反，解密轮密钥是加密轮密钥的逆序。 算法中采用的三种种基本运算： ⊕: 32比特异； &lt;&lt;&lt;i : 特循环左移i位； 反序变换R(A0, A1, A2, A3) = (A3, A2, A1, A0)；#define Reverse(_x, _y) (((_x) &lt;&lt; (_y)) | ((_x) &gt;&gt; (32 - (_y)))) 密钥相关变量的定义： 1：轮密钥：表示为(rk0,rk1 … rk31)，每4个字节一组，共32组，由加密密钥计算； 2：加密密钥：长度128比特，表示为MK=(MK0，MK1， MK2，MK3)，每4个字节一组； 3：FK=(FK0,FK1,FK2,FK3)为系统固定参数， FK0=(A3B1BAC6)，FKj=(56AA3350)，FK2=(677D9197)，FK3=(B27022DC)； 4：CK=(CK0,CK1...CK31)为系统固定参数。 /*CK为固定参数*/ const unsigned int CK[32] = { 0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249, 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299, 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279 }; 5：S盒置换：计算过程为查表过程，Sbox(69) = 22，即S表中第六行第九列的值为22； const unsigned char Sbox[256] = { 0xd6,0x90,0xe9,0xfe,0xcc,0xe1,0x3d,0xb7,0x16,0xb6,0x14,0xc2,0x28,0xfb,0x2c,0x05, 0x2b,0x67,0x9a,0x76,0x2a,0xbe,0x04,0xc3,0xaa,0x44,0x13,0x26,0x49,0x86,0x06,0x99, 0x9c,0x42,0x50,0xf4,0x91,0xef,0x98,0x7a,0x33,0x54,0x0b,0x43,0xed,0xcf,0xac,0x62, 0xe4,0xb3,0x1c,0xa9,0xc9,0x08,0xe8,0x95,0x80,0xdf,0x94,0xfa,0x75,0x8f,0x3f,0xa6, 0x47,0x07,0xa7,0xfc,0xf3,0x73,0x17,0xba,0x83,0x59,0x3c,0x19,0xe6,0x85,0x4f,0xa8, 0x68,0x6b,0x81,0xb2,0x71,0x64,0xda,0x8b,0xf8,0xeb,0x0f,0x4b,0x70,0x56,0x9d,0x35, 0x1e,0x24,0x0e,0x5e,0x63,0x58,0xd1,0xa2,0x25,0x22,0x7c,0x3b,0x01,0x21,0x78,0x87, 0xd4,0x00,0x46,0x57,0x9f,0xd3,0x27,0x52,0x4c,0x36,0x02,0xe7,0xa0,0xc4,0xc8,0x9e, 0xea,0xbf,0x8a,0xd2,0x40,0xc7,0x38,0xb5,0xa3,0xf7,0xf2,0xce,0xf9,0x61,0x15,0xa1, 0xe0,0xae,0x5d,0xa4,0x9b,0x34,0x1a,0x55,0xad,0x93,0x32,0x30,0xf5,0x8c,0xb1,0xe3, 0x1d,0xf6,0xe2,0x2e,0x82,0x66,0xca,0x60,0xc0,0x29,0x23,0xab,0x0d,0x53,0x4e,0x6f, 0xd5,0xdb,0x37,0x45,0xde,0xfd,0x8e,0x2f,0x03,0xff,0x6a,0x72,0x6d,0x6c,0x5b,0x51, 0x8d,0x1b,0xaf,0x92,0xbb,0xdd,0xbc,0x7f,0x11,0xd9,0x5c,0x41,0x1f,0x10,0x5a,0xd8, 0x0a,0xc1,0x31,0x88,0xa5,0xcd,0x7b,0xbd,0x2d,0x74,0xd0,0x12,0xb8,0xe5,0xb4,0xb0, 0x89,0x69,0x97,0x4a,0x0c,0x96,0x77,0x7e,0x65,0xb9,0xf1,0x09,0xc5,0x6e,0xc6,0x84, 0x18,0xf0,0x7d,0xec,0x3a,0xdc,0x4d,0x20,0x79,0xee,0x5f,0x3e,0xd7,0xcb,0x39,0x48 }; 算法中使用的置换运算： 1.非线性变换t：t由4个并行的S盒构成，设输入为 A = (a0,a1,a2,a3)，输出为 B = (b0,b1,b2,b3)，t变换计算公式如下： (b0,b1,b2,b3） = t(a0,a1,a2,a3) = (Sbox (a0), Sbox (a1), Sbox (a2), Sbox (a3)) #define SboxTrans(_A) (Sbox[(_A) &gt;&gt; 24 &amp; 0xFF] &lt;&lt; 24 ^ Sbox[(_A) &gt;&gt; 16 &amp; 0xFF] &lt;&lt; 16 ^ Sbox[(_A) &gt;&gt; 8 &amp; 0xFF] &lt;&lt; 8 ^ Sbox[(_A) &amp; 0xFF]) 2.线性变换L：非线性变换t的输出是线性变换L的输入，本算法中使用的L变换计算公式有两处： 加密算法：&nbsp;L1(B) = B ⊕ (B &lt;&lt;&lt; 2) ⊕ ( B &lt;&lt;&lt; 10) ⊕ (B &lt;&lt;&lt; 18) ⊕ (B &lt;&lt;&lt; 24)； 密钥扩展算法：L2(B) = B⊕(B&nbsp;&lt;&lt;&lt; 13)⊕(B&nbsp;&lt;&lt;&lt; 23)；&nbsp; #define L1(_B) ((_B) ^ Rotl(_B, 2) ^ Rotl(_B, 10) ^ Rotl(_B, 18) ^ Rotl(_B, 24)) #define L2(_B) ((_B) ^ Rotl(_B, 13) ^ Rotl(_B, 23)) 密钥扩展算法 本算法中加密算法的轮密钥由加密密钥通过密钥扩展算法生成，扩展密钥生成公式： (K0, K1, K2,K3) =(MK0⊕FK0,MK1⊕FK1,MK2⊕FK2,MK3⊕FK3); rk i = K 4 = K i ⊕ T(K i+1⊕ K i+2⊕ K i+3⊕CK i); void SM4KeyExt(unsigned char *key, unsigned int *rk, unsigned int CryptFlag) { unsigned int r, tmp, k0, k1, k2, k3; /*(k0,k1,k2,k3) = (key0 xor FK0, key1 xor FK1, key2 xor FK2, key3 xor FK3)*/ /*系统参数FK0 = 0xa3b1bac6、FK1 = 0x56aa3350、FK2 = 0x677d9197、FK3 = 0xb27022dc; */ k0 = key[0] ^ 0xa3b1bac6; k1 = key[1] ^ 0x56aa3350; k2 = key[2] ^ 0x677d9197; k3 = key[3] ^ 0xb27022dc; for (r = 0; r &lt; 32; r += 4) { /*rk(i) = k(4+i) = k(i) xor T[k(i+1) xor k(i+2) xor k(i+3) xor CK(i)]*/ /*合成置换T的过程包括非线性变换（ByteSub函数，从SBox中查找）和线性变换（L2函数，移位和异或运算）*/ tmp = k1 ^ k2 ^ k3 ^ CK[r + 0]; tmp = SboxTrans(tmp); k0 = k0 ^ L2(tmp); rk[r + 0] = k0; tmp = k2 ^ k3 ^ k0 ^ CK[r + 1]; tmp = SboxTrans(tmp); k1 = k1 ^ L2(tmp); rk[r + 1] = k1; tmp = k3 ^ k0 ^ k1 ^ CK[r + 2]; tmp = SboxTrans(tmp); k2 = k2 ^ L2(tmp); rk[r + 2] = k2; tmp = k0 ^ k1 ^ k2 ^ CK[r + 3]; tmp = SboxTrans(tmp); k3 = k3 ^ L2(tmp); rk[r + 3] = k3; } if (CryptFlag == 1) { for (r = 0; r &lt; 16; r++) tmp = rk[r], rk[r] = rk[31 - r], rk[31 - r] = tmp; } } 加密算法 加密变换公式为： Xi+4= F(Xi, Xi+1, Xi+2,Xi+3, rki)= Xi ⊕ T(Xi+1⊕Xi+2⊕Xi+3⊕rki); (Y0, Y1, Y2,Y3) = R(X32, X33, X34，X35) =(X35,X34,X33,X32); 本算法的解密变换与加密变换结构相同，不同的仅是轮密钥的使用顺序。 加密时轮密钥的使用顺序为： (rk0,rk1 … rk31) , &nbsp; 解密时轮密钥的使用顺序为： (rk 31,rk30 … rk0 )。 void SM4Crypt(unsigned char *Input, unsigned char *Output, unsigned int *rk) { unsigned int r, tmp, x0, x1, x2, x3, *y; y = (unsigned int *)Input; x0 = y[0]; x1 = y[1]; x2 = y[2]; x3 = y[3]; for (r = 0; r &lt; 32; r += 4) { /*x4 = x0 ^ T(x1 ^ x2 ^ x3 ^ rk[0])*/ tmp = x1 ^ x2 ^ x3 ^ rk[r + 0]; tmp = SboxTrans(tmp); x0 ^= L1(tmp); tmp = x2 ^ x3 ^ x0 ^ rk[r + 1]; tmp = SboxTrans(tmp); x1 ^= L1(tmp); tmp = x3 ^ x0 ^ x1 ^ rk[r + 2]; tmp = SboxTrans(tmp); x2 ^= L1(tmp); tmp = x0 ^ x1 ^ x2 ^ rk[r + 3]; tmp = SboxTrans(tmp); x3 ^= L1(tmp); } y = (unsigned int *)Output; /*(y0,y1,y2,y3) = (x35,x34,x33,x32)*/ y[0] = x3; y[1] = x2; y[2] = x1; y[3] = x0; } 加密实例 明文:01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10&nbsp; 加密密钥: 01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10 轮密钥与每轮输出状态：&nbsp; rk[ 0] = f12186f9 &nbsp; &nbsp;rk[ 1] = 41662b61 &nbsp; &nbsp;rk[ 2] = 5a6ab19a &nbsp; &nbsp; &nbsp;rk[ 3] = 7ba92077 &nbsp; &nbsp; &nbsp; rk[ 4] = 367360f4 &nbsp; &nbsp;rk[ 5] = 776a0c61 &nbsp; &nbsp;&nbsp;rk[ 6] = b6bb89b3 &nbsp; &nbsp;rk[ 7] = 24763151 &nbsp; &nbsp;&nbsp; rk[ 8] = a520307c &nbsp; &nbsp;&nbsp;rk[ 9] = b7584dbd &nbsp; &nbsp;&nbsp;rk[10] = c30753ed &nbsp; &nbsp; &nbsp;rk[11] = 7ee55b57 &nbsp; &nbsp; &nbsp; rk[12] = 6988608c &nbsp; &nbsp;rk[13] = 30d895b7 &nbsp;&nbsp;rk[14] = 44ba14af &nbsp; &nbsp;rk[15] = 104495a1 &nbsp; &nbsp;&nbsp; rk[16] = d120b428 &nbsp; &nbsp;rk[17] = 73b55fa3 &nbsp; &nbsp;&nbsp;rk[18] = cc874966 &nbsp; &nbsp;&nbsp;rk[19] = 92244439 &nbsp; &nbsp;&nbsp; rk[20] = e89e641f &nbsp; &nbsp; &nbsp;rk[21] = 98ca015a &nbsp; &nbsp; &nbsp;rk[22] = c7159060 &nbsp; &nbsp;&nbsp;rk[23] = 99e1fd2e &nbsp; &nbsp;&nbsp; rk[24] = b79bd80c &nbsp; &nbsp;&nbsp;rk[25] = 1d2115b0 &nbsp; &nbsp;&nbsp;rk[26] = 0e228aeb &nbsp; &nbsp; &nbsp;rk[27] = f1780c81 &nbsp; &nbsp;&nbsp; rk[28] = 428d3654 &nbsp; &nbsp;&nbsp;rk[29] = 62293496 &nbsp; &nbsp;rk[30] = 01cf72e5 &nbsp; &nbsp;&nbsp;rk[31] = 9124a012 &nbsp; &nbsp; X[0] = 27fad345,&nbsp;X[1] = a18b4cb2,&nbsp;X[2] = 11c1e22a,&nbsp;X[3] = cc13e2ee,&nbsp; X[4] = f87c5bd5, &nbsp;X[5] = 33220757,&nbsp;X[6] = 77f4c297,&nbsp;X[7] = 7a96f2eb,&nbsp; X[8] = 27dac07f, X[9] = 42dd0f19,&nbsp;X[10] = b8a5da02,&nbsp;&nbsp;X[11] = 907127fa,&nbsp; X[12] = 8b952b83,&nbsp;&nbsp;X[13] = d42b7c59,&nbsp;X[14] = 2ffc5831,X[15] = f69e6888, X[16] = af2432c4,&nbsp;&nbsp;X[17] = ed1ec85e,&nbsp;X[18] = 55a3ba22,&nbsp;X[19] = 124b18aa,&nbsp; X[20] = 6ae7725f,&nbsp;X[21] = f4cba1f9,&nbsp;X[22] = 1dcdfa10,&nbsp;X[23] = 2ff60603, X[24] = eff24fdc,&nbsp;X[25] = 6fe46b75,&nbsp;X[26] = 893450ad,&nbsp;X[27] = 7b938f4c ,&nbsp; X[28] = 536e4246,&nbsp;X[29] = 86b3e94f,&nbsp;X[30] = d206965e,&nbsp;X[31] = 681edf34. 轮密钥计算方法： 密文: 68 1e df 34 d2 06 96 5e 86 b3 e9 4f 53 6e 42 46 阅读更多" />
<meta property="og:description" content="SM4分组密码算法，原名SMS4，国家密码管理局于2012年3月21日发布。该算法的分组长度为128比特，密钥长度为128比特。加密算法与密钥扩展算法都采用32轮非线性迭代结构。解密算法与加密算法的结构相同，只是轮密钥的使用顺序相反，解密轮密钥是加密轮密钥的逆序。 算法中采用的三种种基本运算： ⊕: 32比特异； &lt;&lt;&lt;i : 特循环左移i位； 反序变换R(A0, A1, A2, A3) = (A3, A2, A1, A0)；#define Reverse(_x, _y) (((_x) &lt;&lt; (_y)) | ((_x) &gt;&gt; (32 - (_y)))) 密钥相关变量的定义： 1：轮密钥：表示为(rk0,rk1 … rk31)，每4个字节一组，共32组，由加密密钥计算； 2：加密密钥：长度128比特，表示为MK=(MK0，MK1， MK2，MK3)，每4个字节一组； 3：FK=(FK0,FK1,FK2,FK3)为系统固定参数， FK0=(A3B1BAC6)，FKj=(56AA3350)，FK2=(677D9197)，FK3=(B27022DC)； 4：CK=(CK0,CK1...CK31)为系统固定参数。 /*CK为固定参数*/ const unsigned int CK[32] = { 0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249, 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299, 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279 }; 5：S盒置换：计算过程为查表过程，Sbox(69) = 22，即S表中第六行第九列的值为22； const unsigned char Sbox[256] = { 0xd6,0x90,0xe9,0xfe,0xcc,0xe1,0x3d,0xb7,0x16,0xb6,0x14,0xc2,0x28,0xfb,0x2c,0x05, 0x2b,0x67,0x9a,0x76,0x2a,0xbe,0x04,0xc3,0xaa,0x44,0x13,0x26,0x49,0x86,0x06,0x99, 0x9c,0x42,0x50,0xf4,0x91,0xef,0x98,0x7a,0x33,0x54,0x0b,0x43,0xed,0xcf,0xac,0x62, 0xe4,0xb3,0x1c,0xa9,0xc9,0x08,0xe8,0x95,0x80,0xdf,0x94,0xfa,0x75,0x8f,0x3f,0xa6, 0x47,0x07,0xa7,0xfc,0xf3,0x73,0x17,0xba,0x83,0x59,0x3c,0x19,0xe6,0x85,0x4f,0xa8, 0x68,0x6b,0x81,0xb2,0x71,0x64,0xda,0x8b,0xf8,0xeb,0x0f,0x4b,0x70,0x56,0x9d,0x35, 0x1e,0x24,0x0e,0x5e,0x63,0x58,0xd1,0xa2,0x25,0x22,0x7c,0x3b,0x01,0x21,0x78,0x87, 0xd4,0x00,0x46,0x57,0x9f,0xd3,0x27,0x52,0x4c,0x36,0x02,0xe7,0xa0,0xc4,0xc8,0x9e, 0xea,0xbf,0x8a,0xd2,0x40,0xc7,0x38,0xb5,0xa3,0xf7,0xf2,0xce,0xf9,0x61,0x15,0xa1, 0xe0,0xae,0x5d,0xa4,0x9b,0x34,0x1a,0x55,0xad,0x93,0x32,0x30,0xf5,0x8c,0xb1,0xe3, 0x1d,0xf6,0xe2,0x2e,0x82,0x66,0xca,0x60,0xc0,0x29,0x23,0xab,0x0d,0x53,0x4e,0x6f, 0xd5,0xdb,0x37,0x45,0xde,0xfd,0x8e,0x2f,0x03,0xff,0x6a,0x72,0x6d,0x6c,0x5b,0x51, 0x8d,0x1b,0xaf,0x92,0xbb,0xdd,0xbc,0x7f,0x11,0xd9,0x5c,0x41,0x1f,0x10,0x5a,0xd8, 0x0a,0xc1,0x31,0x88,0xa5,0xcd,0x7b,0xbd,0x2d,0x74,0xd0,0x12,0xb8,0xe5,0xb4,0xb0, 0x89,0x69,0x97,0x4a,0x0c,0x96,0x77,0x7e,0x65,0xb9,0xf1,0x09,0xc5,0x6e,0xc6,0x84, 0x18,0xf0,0x7d,0xec,0x3a,0xdc,0x4d,0x20,0x79,0xee,0x5f,0x3e,0xd7,0xcb,0x39,0x48 }; 算法中使用的置换运算： 1.非线性变换t：t由4个并行的S盒构成，设输入为 A = (a0,a1,a2,a3)，输出为 B = (b0,b1,b2,b3)，t变换计算公式如下： (b0,b1,b2,b3） = t(a0,a1,a2,a3) = (Sbox (a0), Sbox (a1), Sbox (a2), Sbox (a3)) #define SboxTrans(_A) (Sbox[(_A) &gt;&gt; 24 &amp; 0xFF] &lt;&lt; 24 ^ Sbox[(_A) &gt;&gt; 16 &amp; 0xFF] &lt;&lt; 16 ^ Sbox[(_A) &gt;&gt; 8 &amp; 0xFF] &lt;&lt; 8 ^ Sbox[(_A) &amp; 0xFF]) 2.线性变换L：非线性变换t的输出是线性变换L的输入，本算法中使用的L变换计算公式有两处： 加密算法：&nbsp;L1(B) = B ⊕ (B &lt;&lt;&lt; 2) ⊕ ( B &lt;&lt;&lt; 10) ⊕ (B &lt;&lt;&lt; 18) ⊕ (B &lt;&lt;&lt; 24)； 密钥扩展算法：L2(B) = B⊕(B&nbsp;&lt;&lt;&lt; 13)⊕(B&nbsp;&lt;&lt;&lt; 23)；&nbsp; #define L1(_B) ((_B) ^ Rotl(_B, 2) ^ Rotl(_B, 10) ^ Rotl(_B, 18) ^ Rotl(_B, 24)) #define L2(_B) ((_B) ^ Rotl(_B, 13) ^ Rotl(_B, 23)) 密钥扩展算法 本算法中加密算法的轮密钥由加密密钥通过密钥扩展算法生成，扩展密钥生成公式： (K0, K1, K2,K3) =(MK0⊕FK0,MK1⊕FK1,MK2⊕FK2,MK3⊕FK3); rk i = K 4 = K i ⊕ T(K i+1⊕ K i+2⊕ K i+3⊕CK i); void SM4KeyExt(unsigned char *key, unsigned int *rk, unsigned int CryptFlag) { unsigned int r, tmp, k0, k1, k2, k3; /*(k0,k1,k2,k3) = (key0 xor FK0, key1 xor FK1, key2 xor FK2, key3 xor FK3)*/ /*系统参数FK0 = 0xa3b1bac6、FK1 = 0x56aa3350、FK2 = 0x677d9197、FK3 = 0xb27022dc; */ k0 = key[0] ^ 0xa3b1bac6; k1 = key[1] ^ 0x56aa3350; k2 = key[2] ^ 0x677d9197; k3 = key[3] ^ 0xb27022dc; for (r = 0; r &lt; 32; r += 4) { /*rk(i) = k(4+i) = k(i) xor T[k(i+1) xor k(i+2) xor k(i+3) xor CK(i)]*/ /*合成置换T的过程包括非线性变换（ByteSub函数，从SBox中查找）和线性变换（L2函数，移位和异或运算）*/ tmp = k1 ^ k2 ^ k3 ^ CK[r + 0]; tmp = SboxTrans(tmp); k0 = k0 ^ L2(tmp); rk[r + 0] = k0; tmp = k2 ^ k3 ^ k0 ^ CK[r + 1]; tmp = SboxTrans(tmp); k1 = k1 ^ L2(tmp); rk[r + 1] = k1; tmp = k3 ^ k0 ^ k1 ^ CK[r + 2]; tmp = SboxTrans(tmp); k2 = k2 ^ L2(tmp); rk[r + 2] = k2; tmp = k0 ^ k1 ^ k2 ^ CK[r + 3]; tmp = SboxTrans(tmp); k3 = k3 ^ L2(tmp); rk[r + 3] = k3; } if (CryptFlag == 1) { for (r = 0; r &lt; 16; r++) tmp = rk[r], rk[r] = rk[31 - r], rk[31 - r] = tmp; } } 加密算法 加密变换公式为： Xi+4= F(Xi, Xi+1, Xi+2,Xi+3, rki)= Xi ⊕ T(Xi+1⊕Xi+2⊕Xi+3⊕rki); (Y0, Y1, Y2,Y3) = R(X32, X33, X34，X35) =(X35,X34,X33,X32); 本算法的解密变换与加密变换结构相同，不同的仅是轮密钥的使用顺序。 加密时轮密钥的使用顺序为： (rk0,rk1 … rk31) , &nbsp; 解密时轮密钥的使用顺序为： (rk 31,rk30 … rk0 )。 void SM4Crypt(unsigned char *Input, unsigned char *Output, unsigned int *rk) { unsigned int r, tmp, x0, x1, x2, x3, *y; y = (unsigned int *)Input; x0 = y[0]; x1 = y[1]; x2 = y[2]; x3 = y[3]; for (r = 0; r &lt; 32; r += 4) { /*x4 = x0 ^ T(x1 ^ x2 ^ x3 ^ rk[0])*/ tmp = x1 ^ x2 ^ x3 ^ rk[r + 0]; tmp = SboxTrans(tmp); x0 ^= L1(tmp); tmp = x2 ^ x3 ^ x0 ^ rk[r + 1]; tmp = SboxTrans(tmp); x1 ^= L1(tmp); tmp = x3 ^ x0 ^ x1 ^ rk[r + 2]; tmp = SboxTrans(tmp); x2 ^= L1(tmp); tmp = x0 ^ x1 ^ x2 ^ rk[r + 3]; tmp = SboxTrans(tmp); x3 ^= L1(tmp); } y = (unsigned int *)Output; /*(y0,y1,y2,y3) = (x35,x34,x33,x32)*/ y[0] = x3; y[1] = x2; y[2] = x1; y[3] = x0; } 加密实例 明文:01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10&nbsp; 加密密钥: 01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10 轮密钥与每轮输出状态：&nbsp; rk[ 0] = f12186f9 &nbsp; &nbsp;rk[ 1] = 41662b61 &nbsp; &nbsp;rk[ 2] = 5a6ab19a &nbsp; &nbsp; &nbsp;rk[ 3] = 7ba92077 &nbsp; &nbsp; &nbsp; rk[ 4] = 367360f4 &nbsp; &nbsp;rk[ 5] = 776a0c61 &nbsp; &nbsp;&nbsp;rk[ 6] = b6bb89b3 &nbsp; &nbsp;rk[ 7] = 24763151 &nbsp; &nbsp;&nbsp; rk[ 8] = a520307c &nbsp; &nbsp;&nbsp;rk[ 9] = b7584dbd &nbsp; &nbsp;&nbsp;rk[10] = c30753ed &nbsp; &nbsp; &nbsp;rk[11] = 7ee55b57 &nbsp; &nbsp; &nbsp; rk[12] = 6988608c &nbsp; &nbsp;rk[13] = 30d895b7 &nbsp;&nbsp;rk[14] = 44ba14af &nbsp; &nbsp;rk[15] = 104495a1 &nbsp; &nbsp;&nbsp; rk[16] = d120b428 &nbsp; &nbsp;rk[17] = 73b55fa3 &nbsp; &nbsp;&nbsp;rk[18] = cc874966 &nbsp; &nbsp;&nbsp;rk[19] = 92244439 &nbsp; &nbsp;&nbsp; rk[20] = e89e641f &nbsp; &nbsp; &nbsp;rk[21] = 98ca015a &nbsp; &nbsp; &nbsp;rk[22] = c7159060 &nbsp; &nbsp;&nbsp;rk[23] = 99e1fd2e &nbsp; &nbsp;&nbsp; rk[24] = b79bd80c &nbsp; &nbsp;&nbsp;rk[25] = 1d2115b0 &nbsp; &nbsp;&nbsp;rk[26] = 0e228aeb &nbsp; &nbsp; &nbsp;rk[27] = f1780c81 &nbsp; &nbsp;&nbsp; rk[28] = 428d3654 &nbsp; &nbsp;&nbsp;rk[29] = 62293496 &nbsp; &nbsp;rk[30] = 01cf72e5 &nbsp; &nbsp;&nbsp;rk[31] = 9124a012 &nbsp; &nbsp; X[0] = 27fad345,&nbsp;X[1] = a18b4cb2,&nbsp;X[2] = 11c1e22a,&nbsp;X[3] = cc13e2ee,&nbsp; X[4] = f87c5bd5, &nbsp;X[5] = 33220757,&nbsp;X[6] = 77f4c297,&nbsp;X[7] = 7a96f2eb,&nbsp; X[8] = 27dac07f, X[9] = 42dd0f19,&nbsp;X[10] = b8a5da02,&nbsp;&nbsp;X[11] = 907127fa,&nbsp; X[12] = 8b952b83,&nbsp;&nbsp;X[13] = d42b7c59,&nbsp;X[14] = 2ffc5831,X[15] = f69e6888, X[16] = af2432c4,&nbsp;&nbsp;X[17] = ed1ec85e,&nbsp;X[18] = 55a3ba22,&nbsp;X[19] = 124b18aa,&nbsp; X[20] = 6ae7725f,&nbsp;X[21] = f4cba1f9,&nbsp;X[22] = 1dcdfa10,&nbsp;X[23] = 2ff60603, X[24] = eff24fdc,&nbsp;X[25] = 6fe46b75,&nbsp;X[26] = 893450ad,&nbsp;X[27] = 7b938f4c ,&nbsp; X[28] = 536e4246,&nbsp;X[29] = 86b3e94f,&nbsp;X[30] = d206965e,&nbsp;X[31] = 681edf34. 轮密钥计算方法： 密文: 68 1e df 34 d2 06 96 5e 86 b3 e9 4f 53 6e 42 46 阅读更多" />
<link rel="canonical" href="https://mlh.app/2015/08/26/82b4ee963700af00694dfebf87e931e5.html" />
<meta property="og:url" content="https://mlh.app/2015/08/26/82b4ee963700af00694dfebf87e931e5.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-08-26T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"SM4分组密码算法，原名SMS4，国家密码管理局于2012年3月21日发布。该算法的分组长度为128比特，密钥长度为128比特。加密算法与密钥扩展算法都采用32轮非线性迭代结构。解密算法与加密算法的结构相同，只是轮密钥的使用顺序相反，解密轮密钥是加密轮密钥的逆序。 算法中采用的三种种基本运算： ⊕: 32比特异； &lt;&lt;&lt;i : 特循环左移i位； 反序变换R(A0, A1, A2, A3) = (A3, A2, A1, A0)；#define Reverse(_x, _y) (((_x) &lt;&lt; (_y)) | ((_x) &gt;&gt; (32 - (_y)))) 密钥相关变量的定义： 1：轮密钥：表示为(rk0,rk1 … rk31)，每4个字节一组，共32组，由加密密钥计算； 2：加密密钥：长度128比特，表示为MK=(MK0，MK1， MK2，MK3)，每4个字节一组； 3：FK=(FK0,FK1,FK2,FK3)为系统固定参数， FK0=(A3B1BAC6)，FKj=(56AA3350)，FK2=(677D9197)，FK3=(B27022DC)； 4：CK=(CK0,CK1...CK31)为系统固定参数。 /*CK为固定参数*/ const unsigned int CK[32] = { 0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269, 0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9, 0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249, 0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9, 0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229, 0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299, 0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209, 0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279 }; 5：S盒置换：计算过程为查表过程，Sbox(69) = 22，即S表中第六行第九列的值为22； const unsigned char Sbox[256] = { 0xd6,0x90,0xe9,0xfe,0xcc,0xe1,0x3d,0xb7,0x16,0xb6,0x14,0xc2,0x28,0xfb,0x2c,0x05, 0x2b,0x67,0x9a,0x76,0x2a,0xbe,0x04,0xc3,0xaa,0x44,0x13,0x26,0x49,0x86,0x06,0x99, 0x9c,0x42,0x50,0xf4,0x91,0xef,0x98,0x7a,0x33,0x54,0x0b,0x43,0xed,0xcf,0xac,0x62, 0xe4,0xb3,0x1c,0xa9,0xc9,0x08,0xe8,0x95,0x80,0xdf,0x94,0xfa,0x75,0x8f,0x3f,0xa6, 0x47,0x07,0xa7,0xfc,0xf3,0x73,0x17,0xba,0x83,0x59,0x3c,0x19,0xe6,0x85,0x4f,0xa8, 0x68,0x6b,0x81,0xb2,0x71,0x64,0xda,0x8b,0xf8,0xeb,0x0f,0x4b,0x70,0x56,0x9d,0x35, 0x1e,0x24,0x0e,0x5e,0x63,0x58,0xd1,0xa2,0x25,0x22,0x7c,0x3b,0x01,0x21,0x78,0x87, 0xd4,0x00,0x46,0x57,0x9f,0xd3,0x27,0x52,0x4c,0x36,0x02,0xe7,0xa0,0xc4,0xc8,0x9e, 0xea,0xbf,0x8a,0xd2,0x40,0xc7,0x38,0xb5,0xa3,0xf7,0xf2,0xce,0xf9,0x61,0x15,0xa1, 0xe0,0xae,0x5d,0xa4,0x9b,0x34,0x1a,0x55,0xad,0x93,0x32,0x30,0xf5,0x8c,0xb1,0xe3, 0x1d,0xf6,0xe2,0x2e,0x82,0x66,0xca,0x60,0xc0,0x29,0x23,0xab,0x0d,0x53,0x4e,0x6f, 0xd5,0xdb,0x37,0x45,0xde,0xfd,0x8e,0x2f,0x03,0xff,0x6a,0x72,0x6d,0x6c,0x5b,0x51, 0x8d,0x1b,0xaf,0x92,0xbb,0xdd,0xbc,0x7f,0x11,0xd9,0x5c,0x41,0x1f,0x10,0x5a,0xd8, 0x0a,0xc1,0x31,0x88,0xa5,0xcd,0x7b,0xbd,0x2d,0x74,0xd0,0x12,0xb8,0xe5,0xb4,0xb0, 0x89,0x69,0x97,0x4a,0x0c,0x96,0x77,0x7e,0x65,0xb9,0xf1,0x09,0xc5,0x6e,0xc6,0x84, 0x18,0xf0,0x7d,0xec,0x3a,0xdc,0x4d,0x20,0x79,0xee,0x5f,0x3e,0xd7,0xcb,0x39,0x48 }; 算法中使用的置换运算： 1.非线性变换t：t由4个并行的S盒构成，设输入为 A = (a0,a1,a2,a3)，输出为 B = (b0,b1,b2,b3)，t变换计算公式如下： (b0,b1,b2,b3） = t(a0,a1,a2,a3) = (Sbox (a0), Sbox (a1), Sbox (a2), Sbox (a3)) #define SboxTrans(_A) (Sbox[(_A) &gt;&gt; 24 &amp; 0xFF] &lt;&lt; 24 ^ Sbox[(_A) &gt;&gt; 16 &amp; 0xFF] &lt;&lt; 16 ^ Sbox[(_A) &gt;&gt; 8 &amp; 0xFF] &lt;&lt; 8 ^ Sbox[(_A) &amp; 0xFF]) 2.线性变换L：非线性变换t的输出是线性变换L的输入，本算法中使用的L变换计算公式有两处： 加密算法：&nbsp;L1(B) = B ⊕ (B &lt;&lt;&lt; 2) ⊕ ( B &lt;&lt;&lt; 10) ⊕ (B &lt;&lt;&lt; 18) ⊕ (B &lt;&lt;&lt; 24)； 密钥扩展算法：L2(B) = B⊕(B&nbsp;&lt;&lt;&lt; 13)⊕(B&nbsp;&lt;&lt;&lt; 23)；&nbsp; #define L1(_B) ((_B) ^ Rotl(_B, 2) ^ Rotl(_B, 10) ^ Rotl(_B, 18) ^ Rotl(_B, 24)) #define L2(_B) ((_B) ^ Rotl(_B, 13) ^ Rotl(_B, 23)) 密钥扩展算法 本算法中加密算法的轮密钥由加密密钥通过密钥扩展算法生成，扩展密钥生成公式： (K0, K1, K2,K3) =(MK0⊕FK0,MK1⊕FK1,MK2⊕FK2,MK3⊕FK3); rk i = K 4 = K i ⊕ T(K i+1⊕ K i+2⊕ K i+3⊕CK i); void SM4KeyExt(unsigned char *key, unsigned int *rk, unsigned int CryptFlag) { unsigned int r, tmp, k0, k1, k2, k3; /*(k0,k1,k2,k3) = (key0 xor FK0, key1 xor FK1, key2 xor FK2, key3 xor FK3)*/ /*系统参数FK0 = 0xa3b1bac6、FK1 = 0x56aa3350、FK2 = 0x677d9197、FK3 = 0xb27022dc; */ k0 = key[0] ^ 0xa3b1bac6; k1 = key[1] ^ 0x56aa3350; k2 = key[2] ^ 0x677d9197; k3 = key[3] ^ 0xb27022dc; for (r = 0; r &lt; 32; r += 4) { /*rk(i) = k(4+i) = k(i) xor T[k(i+1) xor k(i+2) xor k(i+3) xor CK(i)]*/ /*合成置换T的过程包括非线性变换（ByteSub函数，从SBox中查找）和线性变换（L2函数，移位和异或运算）*/ tmp = k1 ^ k2 ^ k3 ^ CK[r + 0]; tmp = SboxTrans(tmp); k0 = k0 ^ L2(tmp); rk[r + 0] = k0; tmp = k2 ^ k3 ^ k0 ^ CK[r + 1]; tmp = SboxTrans(tmp); k1 = k1 ^ L2(tmp); rk[r + 1] = k1; tmp = k3 ^ k0 ^ k1 ^ CK[r + 2]; tmp = SboxTrans(tmp); k2 = k2 ^ L2(tmp); rk[r + 2] = k2; tmp = k0 ^ k1 ^ k2 ^ CK[r + 3]; tmp = SboxTrans(tmp); k3 = k3 ^ L2(tmp); rk[r + 3] = k3; } if (CryptFlag == 1) { for (r = 0; r &lt; 16; r++) tmp = rk[r], rk[r] = rk[31 - r], rk[31 - r] = tmp; } } 加密算法 加密变换公式为： Xi+4= F(Xi, Xi+1, Xi+2,Xi+3, rki)= Xi ⊕ T(Xi+1⊕Xi+2⊕Xi+3⊕rki); (Y0, Y1, Y2,Y3) = R(X32, X33, X34，X35) =(X35,X34,X33,X32); 本算法的解密变换与加密变换结构相同，不同的仅是轮密钥的使用顺序。 加密时轮密钥的使用顺序为： (rk0,rk1 … rk31) , &nbsp; 解密时轮密钥的使用顺序为： (rk 31,rk30 … rk0 )。 void SM4Crypt(unsigned char *Input, unsigned char *Output, unsigned int *rk) { unsigned int r, tmp, x0, x1, x2, x3, *y; y = (unsigned int *)Input; x0 = y[0]; x1 = y[1]; x2 = y[2]; x3 = y[3]; for (r = 0; r &lt; 32; r += 4) { /*x4 = x0 ^ T(x1 ^ x2 ^ x3 ^ rk[0])*/ tmp = x1 ^ x2 ^ x3 ^ rk[r + 0]; tmp = SboxTrans(tmp); x0 ^= L1(tmp); tmp = x2 ^ x3 ^ x0 ^ rk[r + 1]; tmp = SboxTrans(tmp); x1 ^= L1(tmp); tmp = x3 ^ x0 ^ x1 ^ rk[r + 2]; tmp = SboxTrans(tmp); x2 ^= L1(tmp); tmp = x0 ^ x1 ^ x2 ^ rk[r + 3]; tmp = SboxTrans(tmp); x3 ^= L1(tmp); } y = (unsigned int *)Output; /*(y0,y1,y2,y3) = (x35,x34,x33,x32)*/ y[0] = x3; y[1] = x2; y[2] = x1; y[3] = x0; } 加密实例 明文:01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10&nbsp; 加密密钥: 01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10 轮密钥与每轮输出状态：&nbsp; rk[ 0] = f12186f9 &nbsp; &nbsp;rk[ 1] = 41662b61 &nbsp; &nbsp;rk[ 2] = 5a6ab19a &nbsp; &nbsp; &nbsp;rk[ 3] = 7ba92077 &nbsp; &nbsp; &nbsp; rk[ 4] = 367360f4 &nbsp; &nbsp;rk[ 5] = 776a0c61 &nbsp; &nbsp;&nbsp;rk[ 6] = b6bb89b3 &nbsp; &nbsp;rk[ 7] = 24763151 &nbsp; &nbsp;&nbsp; rk[ 8] = a520307c &nbsp; &nbsp;&nbsp;rk[ 9] = b7584dbd &nbsp; &nbsp;&nbsp;rk[10] = c30753ed &nbsp; &nbsp; &nbsp;rk[11] = 7ee55b57 &nbsp; &nbsp; &nbsp; rk[12] = 6988608c &nbsp; &nbsp;rk[13] = 30d895b7 &nbsp;&nbsp;rk[14] = 44ba14af &nbsp; &nbsp;rk[15] = 104495a1 &nbsp; &nbsp;&nbsp; rk[16] = d120b428 &nbsp; &nbsp;rk[17] = 73b55fa3 &nbsp; &nbsp;&nbsp;rk[18] = cc874966 &nbsp; &nbsp;&nbsp;rk[19] = 92244439 &nbsp; &nbsp;&nbsp; rk[20] = e89e641f &nbsp; &nbsp; &nbsp;rk[21] = 98ca015a &nbsp; &nbsp; &nbsp;rk[22] = c7159060 &nbsp; &nbsp;&nbsp;rk[23] = 99e1fd2e &nbsp; &nbsp;&nbsp; rk[24] = b79bd80c &nbsp; &nbsp;&nbsp;rk[25] = 1d2115b0 &nbsp; &nbsp;&nbsp;rk[26] = 0e228aeb &nbsp; &nbsp; &nbsp;rk[27] = f1780c81 &nbsp; &nbsp;&nbsp; rk[28] = 428d3654 &nbsp; &nbsp;&nbsp;rk[29] = 62293496 &nbsp; &nbsp;rk[30] = 01cf72e5 &nbsp; &nbsp;&nbsp;rk[31] = 9124a012 &nbsp; &nbsp; X[0] = 27fad345,&nbsp;X[1] = a18b4cb2,&nbsp;X[2] = 11c1e22a,&nbsp;X[3] = cc13e2ee,&nbsp; X[4] = f87c5bd5, &nbsp;X[5] = 33220757,&nbsp;X[6] = 77f4c297,&nbsp;X[7] = 7a96f2eb,&nbsp; X[8] = 27dac07f, X[9] = 42dd0f19,&nbsp;X[10] = b8a5da02,&nbsp;&nbsp;X[11] = 907127fa,&nbsp; X[12] = 8b952b83,&nbsp;&nbsp;X[13] = d42b7c59,&nbsp;X[14] = 2ffc5831,X[15] = f69e6888, X[16] = af2432c4,&nbsp;&nbsp;X[17] = ed1ec85e,&nbsp;X[18] = 55a3ba22,&nbsp;X[19] = 124b18aa,&nbsp; X[20] = 6ae7725f,&nbsp;X[21] = f4cba1f9,&nbsp;X[22] = 1dcdfa10,&nbsp;X[23] = 2ff60603, X[24] = eff24fdc,&nbsp;X[25] = 6fe46b75,&nbsp;X[26] = 893450ad,&nbsp;X[27] = 7b938f4c ,&nbsp; X[28] = 536e4246,&nbsp;X[29] = 86b3e94f,&nbsp;X[30] = d206965e,&nbsp;X[31] = 681edf34. 轮密钥计算方法： 密文: 68 1e df 34 d2 06 96 5e 86 b3 e9 4f 53 6e 42 46 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2015/08/26/82b4ee963700af00694dfebf87e931e5.html","headline":"分组密码SM4算法的代码实现","dateModified":"2015-08-26T00:00:00+08:00","datePublished":"2015-08-26T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2015/08/26/82b4ee963700af00694dfebf87e931e5.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>分组密码SM4算法的代码实现</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT21" style="margin-left:1pt;text-align:justify;text-indent:21pt;line-height:150%;background:transparent;"> <span style="font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;color:rgb(63,62,62);">SM4</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'宋体';color:rgb(63,62,62);background-color:transparent;">分组密码算法，原名</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;color:rgb(63,62,62);background-color:transparent;">SMS4</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'宋体';color:rgb(63,62,62);background-color:transparent;">，国家密码管理局于</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;color:rgb(63,62,62);background-color:transparent;">2012</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'宋体';color:rgb(63,62,62);background-color:transparent;">年</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;color:rgb(63,62,62);background-color:transparent;">3</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'宋体';color:rgb(63,62,62);background-color:transparent;">月</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;color:rgb(63,62,62);background-color:transparent;">21</span><span style="text-indent:21pt;font-size:10.5pt;line-height:150%;font-family:'宋体';color:rgb(63,62,62);background-color:transparent;">日发布</span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'宋体';">。该算法的分组长度为</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2MSGENFONTSTYLEMODIFERSIZE9" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;">128</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'宋体';">比特，密钥长度为</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2MSGENFONTSTYLEMODIFERSIZE9" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;">128</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'宋体';">比特。加密算</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'宋体';">法与密钥扩展算法都采用</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2MSGENFONTSTYLEMODIFERSIZE912" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;">32</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'宋体';">轮非线性迭代结构。解密算法与加密算法的结构相同，只是轮</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'Times New Roman', serif;"></span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2" style="line-height:150%;text-indent:21pt;background-color:transparent;"><span style="font-size:10.5pt;line-height:150%;font-family:'宋体';">密钥的使用顺序相反，解密轮密钥是加密轮密钥的逆序。</span></span></p> 
  <p><span lang="en-us" xml:lang="en-us"></span></p> 
  <p style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;background-color:transparent;"> </p> 
  <ul>
   <li><span style="font-size:10.5pt;background-color:transparent;">算法中采用的三种种基本运算：</span></li>
  </ul>
  <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="font-size:10.5pt;background-color:transparent;"></span> 
  <ol>
   <li><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="font-size:10.5pt;background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span><span style="font-size:10.5pt;background-color:transparent;">: 32比特异；</span></li>
   <li><span style="font-size:10.5pt;background-color:transparent;">&lt;&lt;&lt;i : 特循环左移i位；</span></li>
   <li><span style="font-size:10.5pt;background-color:transparent;">反序变换R(A</span><sub style="background-color:transparent;">0</sub><span style="font-size:10.5pt;background-color:transparent;">, A</span><sub style="background-color:transparent;">1</sub><span style="font-size:10.5pt;background-color:transparent;">, A</span><sub style="background-color:transparent;">2</sub><span style="font-size:10.5pt;background-color:transparent;">, A</span><sub style="background-color:transparent;">3</sub><span style="font-size:10.5pt;background-color:transparent;">) = (A</span><sub style="background-color:transparent;">3</sub><span style="font-size:10.5pt;background-color:transparent;">, A</span><sub style="background-color:transparent;">2</sub><span style="font-size:10.5pt;background-color:transparent;">, A</span><sub style="background-color:transparent;">1</sub><span style="font-size:10.5pt;background-color:transparent;">, A</span><sub style="background-color:transparent;">0</sub><span style="font-size:10.5pt;background-color:transparent;">)；</span><pre><code class="language-cpp">#define Reverse(_x, _y) (((_x) &lt;&lt; (_y)) | ((_x) &gt;&gt; (32 - (_y))))
</code></pre><br></li>
  </ol>
  <p></p> 
  <p style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;background-color:transparent;"> </p> 
  <ul>
   <li><span style="font-size:10.5pt;background-color:transparent;">密钥相关变量的定义：</span></li>
  </ul>
  <p></p> 
  <span style="font-size:10.5pt;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">1：轮密钥：表示为(rk0,rk1 … rk31)，每4个字节一组，共32组，由加密密钥计算；</span>
  <br>
  <span style="color:rgb(63,62,62);font-family:'宋体';font-size:14px;">2：加密密钥：长度128比特，表示为MK=(MK0，MK1， MK2，MK3)，每4个字节一组；</span>
  <br>
  <span style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;">3：FK=(FK0,FK1,FK2,FK3)为系统固定参数，</span>
  <span style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;"><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">FK<sub>0</sub>=(</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT32"><span style="font-size:10.5pt;">A</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">3B1BAC6)</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE953"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">，</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">FK</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE41"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">j</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">=(</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT32"><span style="font-size:10.5pt;">5</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">6AA3350)</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE953"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">，</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">FK<sub>2</sub>=(677D9197)</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE953"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">，</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">FK<sub>3</sub>=(B27022DC)；</span></span></span>
  <br>
  <p><span style="font-size:10.5pt;color:rgb(63,62,62);font-family:'宋体';">4：CK=(CK0,CK1...CK31)为系统固定参数。</span></p> 
  <p><span style="font-size:10.5pt;color:rgb(63,62,62);font-family:'宋体';"></span></p> 
  <pre><code class="language-cpp">/*CK为固定参数*/
const unsigned int CK[32] = {
	0x00070e15, 0x1c232a31, 0x383f464d, 0x545b6269,
	0x70777e85, 0x8c939aa1, 0xa8afb6bd, 0xc4cbd2d9,
	0xe0e7eef5, 0xfc030a11, 0x181f262d, 0x343b4249,
	0x50575e65, 0x6c737a81, 0x888f969d, 0xa4abb2b9,
	0xc0c7ced5, 0xdce3eaf1, 0xf8ff060d, 0x141b2229,
	0x30373e45, 0x4c535a61, 0x686f767d, 0x848b9299,
	0xa0a7aeb5, 0xbcc3cad1, 0xd8dfe6ed, 0xf4fb0209,
	0x10171e25, 0x2c333a41, 0x484f565d, 0x646b7279 };
</code></pre> 
  <p><br></p> 
  <p><span style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;"><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2MSGENFONTSTYLEMODIFERSIZE9"><span style="font-size:10.5pt;">5：S<span lang="en-us" xml:lang="en-us">盒置换：计算过程为查表过程，Sbox(69) = 22，即S表中第六行第九列的值为22</span></span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLEMSGENFONTSTYLENAMEBYROLETABLECAPTIONMSGENFONTSTYLEMODIFERSIZE95"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">；</span></span></span></span></span></p> 
  <p><span style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;"><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"><span class="MSGENFONTSTYLENAMETEMPLATEROLEMSGENFONTSTYLENAMEBYROLETABLECAPTIONMSGENFONTSTYLEMODIFERSIZE95"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"><br></span></span></span></span></span></p> 
  <pre><code class="language-cpp">const unsigned char Sbox[256] = {
	0xd6,0x90,0xe9,0xfe,0xcc,0xe1,0x3d,0xb7,0x16,0xb6,0x14,0xc2,0x28,0xfb,0x2c,0x05,
	0x2b,0x67,0x9a,0x76,0x2a,0xbe,0x04,0xc3,0xaa,0x44,0x13,0x26,0x49,0x86,0x06,0x99,
	0x9c,0x42,0x50,0xf4,0x91,0xef,0x98,0x7a,0x33,0x54,0x0b,0x43,0xed,0xcf,0xac,0x62,
	0xe4,0xb3,0x1c,0xa9,0xc9,0x08,0xe8,0x95,0x80,0xdf,0x94,0xfa,0x75,0x8f,0x3f,0xa6,
	0x47,0x07,0xa7,0xfc,0xf3,0x73,0x17,0xba,0x83,0x59,0x3c,0x19,0xe6,0x85,0x4f,0xa8,
	0x68,0x6b,0x81,0xb2,0x71,0x64,0xda,0x8b,0xf8,0xeb,0x0f,0x4b,0x70,0x56,0x9d,0x35,
	0x1e,0x24,0x0e,0x5e,0x63,0x58,0xd1,0xa2,0x25,0x22,0x7c,0x3b,0x01,0x21,0x78,0x87,
	0xd4,0x00,0x46,0x57,0x9f,0xd3,0x27,0x52,0x4c,0x36,0x02,0xe7,0xa0,0xc4,0xc8,0x9e,
	0xea,0xbf,0x8a,0xd2,0x40,0xc7,0x38,0xb5,0xa3,0xf7,0xf2,0xce,0xf9,0x61,0x15,0xa1,
	0xe0,0xae,0x5d,0xa4,0x9b,0x34,0x1a,0x55,0xad,0x93,0x32,0x30,0xf5,0x8c,0xb1,0xe3,
	0x1d,0xf6,0xe2,0x2e,0x82,0x66,0xca,0x60,0xc0,0x29,0x23,0xab,0x0d,0x53,0x4e,0x6f,
	0xd5,0xdb,0x37,0x45,0xde,0xfd,0x8e,0x2f,0x03,0xff,0x6a,0x72,0x6d,0x6c,0x5b,0x51,
	0x8d,0x1b,0xaf,0x92,0xbb,0xdd,0xbc,0x7f,0x11,0xd9,0x5c,0x41,0x1f,0x10,0x5a,0xd8,
	0x0a,0xc1,0x31,0x88,0xa5,0xcd,0x7b,0xbd,0x2d,0x74,0xd0,0x12,0xb8,0xe5,0xb4,0xb0,
	0x89,0x69,0x97,0x4a,0x0c,0x96,0x77,0x7e,0x65,0xb9,0xf1,0x09,0xc5,0x6e,0xc6,0x84,
	0x18,0xf0,0x7d,0xec,0x3a,0xdc,0x4d,0x20,0x79,0xee,0x5f,0x3e,0xd7,0xcb,0x39,0x48
};</code></pre> 
  <p align="left" style="background-color:transparent;"></p> 
  <ul>
   <li><span style="color:rgb(63,62,62);font-family:'宋体';font-size:10.5pt;background-color:transparent;">算法中使用的置换运算：</span></li>
  </ul>
  <p><span style="font-size:14px;font-family:'宋体';color:rgb(63,62,62);">1.非线性变换t：</span><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">t由4个并行的S盒构成，设输入为 A = (</span><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';">a</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">0</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">,</span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT6" style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">a<sub>1</sub></span></span><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">,a</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">2</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">,a</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">3</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">)，输出为 B = (</span><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">b</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">0</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">,b</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">1</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">,b</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">2</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">,b</span><sub style="color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">3</sub><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;">)，t变换计算公式如下：</span></p> 
  <p><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;"><span style="font-size:14px;">(b</span><sub style="background-color:transparent;">0</sub><span style="font-size:14px;background-color:transparent;">,b</span><sub style="background-color:transparent;">1</sub><span style="font-size:14px;background-color:transparent;">,b</span><sub style="background-color:transparent;">2</sub><span style="font-size:14px;background-color:transparent;">,b</span><sub style="background-color:transparent;">3</sub><span style="font-size:14px;background-color:transparent;">） = t(a</span><sub style="background-color:transparent;">0</sub><span style="font-size:14px;background-color:transparent;">,</span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT6" style="font-size:14px;background-color:transparent;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">a<sub>1</sub></span></span><span style="font-size:14px;background-color:transparent;">,a</span><sub style="background-color:transparent;">2</sub><span style="font-size:14px;background-color:transparent;">,a</span><sub style="background-color:transparent;">3</sub><span style="font-size:14px;background-color:transparent;">) = (Sbox (a</span><sub style="background-color:transparent;">0</sub><span style="font-size:14px;background-color:transparent;">), Sbox (a</span><sub style="background-color:transparent;">1</sub><span style="font-size:14px;background-color:transparent;">), Sbox (a</span><sub style="background-color:transparent;">2</sub><span style="font-size:14px;background-color:transparent;">), Sbox (a</span><sub style="background-color:transparent;">3</sub><span style="font-size:14px;background-color:transparent;">))</span><br></span></p> 
  <div style="text-align:left;">
   <span style="font-family:'宋体';color:#3f3e3e;"></span> 
   <div style="text-align:left;">
    <span style="font-size:14px;"><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';"></span></span>
    <pre><code class="language-cpp">#define SboxTrans(_A) (Sbox[(_A) &gt;&gt; 24 &amp; 0xFF] &lt;&lt; 24 ^ Sbox[(_A) &gt;&gt; 16 &amp; 0xFF] &lt;&lt; 16 ^ Sbox[(_A) &gt;&gt;  8 &amp; 0xFF] &lt;&lt;  8 ^ Sbox[(_A) &amp; 0xFF])</code></pre>
    <br>
    <br>
   </div> 
   <div style="text-align:left;">
    <span style="font-size:14px;"><span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';">2.线性变换L：</span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERSIZE95" style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';"><span style="font-size:10.5pt;">非线性变换</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERSIZE55" style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';"><span style="font-size:10.5pt;">t</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERSIZE95" style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';"><span style="font-size:10.5pt;">的输出是线性变换</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';"><span style="font-size:10.5pt;">L</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERSIZE95" style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';"><span style="font-size:10.5pt;">的输入，本算法中使用的L变换计算公式有两处：</span></span><br></span>
   </div> 
  </div> 
  <div style="text-align:left;"> 
   <div style="text-align:center;">
    <span style="font-family:'宋体';color:#3f3e3e;"><span style="font-size:14px;"><br></span></span>
   </div> 
   <span style="font-size:14px;color:rgb(63,62,62);font-family:'宋体';background-color:transparent;"></span> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">加密算法：&nbsp;L1(B) = B</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">(B</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"> &lt;&lt;&lt; 2)</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;">(</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">B</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"> &lt;&lt;&lt; 10)</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">(B</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"> &lt;&lt;&lt; 18)</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">(B</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"> &lt;&lt;&lt; 24)<span lang="en-us" xml:lang="en-us">；</span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"><span lang="en-us" xml:lang="en-us">密钥扩展算法：<span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">L2(B) = B</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">(B</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;">&nbsp;&lt;&lt;&lt; 13)</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE8" style="background-color:transparent;"><span style="font-size:10.5pt;font-family:'MS Mincho';">⊕</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;">(</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7MSGENFONTSTYLEMODIFERITALIC3" style="background-color:transparent;"><span style="font-size:10.5pt;">B</span></span><span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;">&nbsp;&lt;&lt;&lt; 23)；</span></span>&nbsp;</span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"><span lang="en-us" xml:lang="en-us"><br></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT7" style="background-color:transparent;"><span style="font-size:10.5pt;"><span lang="en-us" xml:lang="en-us"></span></span></span>
    <pre><code class="language-cpp">#define L1(_B) ((_B) ^ Rotl(_B, 2) ^ Rotl(_B, 10) ^ Rotl(_B, 18) ^ Rotl(_B, 24))
#define L2(_B) ((_B) ^ Rotl(_B, 13) ^ Rotl(_B, 23))</code></pre>
    <br>
    <br>
   </div> 
   <div style="text-align:left;"> 
    <ul>
     <li><span style="font-size:14px;">密钥扩展算法</span></li>
    </ul>
    <span style="font-size:14px;"></span> 
    <p align="left" style="background:transparent;">本算法中加密算法的轮密钥由加密密钥通过密钥扩展算法生成，扩展密钥生成公式：</p> 
    <p align="left" style="background:transparent;">(K<sub>0, </sub>K<sub>1, </sub>K<sub>2,</sub>K<sub>3</sub>) =(MK<sub>0</sub>⊕FK<sub>0</sub>,MK<sub>1</sub>⊕FK<sub>1</sub>,MK<sub>2</sub>⊕FK<sub>2</sub>,MK<sub>3</sub>⊕FK<sub>3</sub>);</p> rk
    <sub>i</sub> = K
    <sub>4</sub> = K
    <sub>i</sub> ⊕ T(K
    <sub>i+1</sub>⊕
    <sub></sub>K
    <sub>i+2</sub>⊕
    <sub></sub>K
    <sub>i+3</sub>⊕CK
    <sub>i</sub>);
    <br>
   </div> 
   <div style="text-align:left;">
    <pre><code class="language-cpp">void SM4KeyExt(unsigned char *key, unsigned int *rk, unsigned int CryptFlag)
{
	unsigned int r, tmp, k0, k1, k2, k3;
	/*(k0,k1,k2,k3) = (key0 xor FK0, key1 xor FK1, key2 xor FK2, key3 xor FK3)*/
	/*系统参数FK0 = 0xa3b1bac6、FK1 = 0x56aa3350、FK2 = 0x677d9197、FK3 = 0xb27022dc; */
	k0 = key[0] ^ 0xa3b1bac6;
	k1 = key[1] ^ 0x56aa3350;
	k2 = key[2] ^ 0x677d9197;
	k3 = key[3] ^ 0xb27022dc;
	for (r = 0; r &lt; 32; r += 4)
	{
		/*rk(i) = k(4+i) = k(i) xor T[k(i+1) xor k(i+2) xor k(i+3) xor CK(i)]*/
		/*合成置换T的过程包括非线性变换（ByteSub函数，从SBox中查找）和线性变换（L2函数，移位和异或运算）*/
		tmp = k1 ^ k2 ^ k3 ^ CK[r + 0];
		tmp = SboxTrans(tmp);
		k0 = k0 ^ L2(tmp);
		rk[r + 0] = k0;

		tmp = k2 ^ k3 ^ k0 ^ CK[r + 1];
		tmp = SboxTrans(tmp);
		k1 = k1 ^ L2(tmp);
		rk[r + 1] = k1;
		
		tmp = k3 ^ k0 ^ k1 ^ CK[r + 2];
		tmp = SboxTrans(tmp);
		k2 = k2 ^ L2(tmp);
		rk[r + 2] = k2;

		tmp = k0 ^ k1 ^ k2 ^ CK[r + 3];
		tmp = SboxTrans(tmp);
		k3 = k3 ^ L2(tmp);
		rk[r + 3] = k3;
	}
	if (CryptFlag == 1)
	{
		for (r = 0; r &lt; 16; r++)
			tmp = rk[r], rk[r] = rk[31 - r], rk[31 - r] = tmp;
	}
}</code></pre> 
    <ul style="font-size:14px;">
     <li>加密算法</li>
    </ul>
    <span style="font-size:14px;"></span> 
    <p align="left" style="background:transparent;">加密变换公式为：</p> 
    <p align="left" style="background:transparent;">X<sub>i+4</sub>= F(X<sub>i, </sub> X<sub>i+1, </sub>X<sub>i+2,</sub>X<sub>i+3, </sub>rk<sub>i</sub>)= X<sub>i</sub> ⊕ T(X<sub>i+1</sub>⊕<sub></sub>X<sub>i+2</sub>⊕<sub></sub>X<sub>i+3</sub>⊕<sub></sub>rk<sub>i</sub>);</p> 
    <p style="background:transparent;">(Y<sub>0,</sub> Y<sub>1,</sub> Y<sub>2,</sub>Y<sub>3</sub>) = R(X<sub>32,</sub> X<sub>33,</sub> X<sub>34</sub><sub>，</sub><sub></sub>X<sub>35</sub>) =(X<sub>35,</sub>X<sub>34,</sub>X<sub>33,</sub>X<sub>32</sub>);</p> 
    <br>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2"><span lang="en-us" style="font-size:10.5pt;font-family:'宋体';" xml:lang="en-us">本算法的解密变换与加密变换结构相同，不同的仅是轮密钥的使用顺序。</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"></span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT22"><span lang="en-us" style="font-size:10.5pt;font-family:'宋体';" xml:lang="en-us">加密时轮密钥的使用顺序为：</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'Times New Roman', serif;">(rk0,rk1</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'宋体';">…</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'Times New Roman', serif;">rk31)</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;">,</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;">&nbsp;</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT2MSGENFONTSTYLEMODIFERSPACING0"><span lang="en-us" style="font-size:10.5pt;font-family:'宋体';" xml:lang="en-us">解密时轮密钥的使用顺序为：</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'Times New Roman', serif;">(rk</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;">31,rk30</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'Times New Roman', serif;"></span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'宋体';">…</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'Times New Roman', serif;"></span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;">rk0</span></span>
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-size:10.5pt;font-family:'Times New Roman', serif;">)。</span></span>
    <br>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"></span>
    <pre><code class="language-cpp">void SM4Crypt(unsigned char *Input, unsigned char *Output, unsigned int *rk)
{
	unsigned int r, tmp, x0, x1, x2, x3, *y;
	y = (unsigned int *)Input;
	x0 = y[0];
	x1 = y[1];
	x2 = y[2];
	x3 = y[3];
	for (r = 0; r &lt; 32; r += 4)
	{
		/*x4 = x0 ^ T(x1 ^ x2 ^ x3 ^ rk[0])*/
		tmp = x1 ^ x2 ^ x3 ^ rk[r + 0];
		tmp = SboxTrans(tmp);
		x0 ^= L1(tmp);

		tmp = x2 ^ x3 ^ x0 ^ rk[r + 1];
		tmp = SboxTrans(tmp);
		x1 ^= L1(tmp);

		tmp = x3 ^ x0 ^ x1 ^ rk[r + 2];
		tmp = SboxTrans(tmp);
		x2 ^= L1(tmp);

		tmp = x0 ^ x1 ^ x2 ^ rk[r + 3];
		tmp = SboxTrans(tmp);
		x3 ^= L1(tmp);
	}
	y = (unsigned int *)Output;
	/*(y0,y1,y2,y3) = (x35,x34,x33,x32)*/
	y[0] = x3;
	y[1] = x2;
	y[2] = x1;
	y[3] = x0;
}</code></pre>
    <br>
    <ul style="font-family:'Times New Roman', serif;font-size:10.5pt;">
     <li><span style="font-size:10.5pt;">加密实例</span></li>
    </ul>
    <span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;">明文:01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10&nbsp;<br> 加密密钥: 01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10<br></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;">轮密钥与每轮输出状态：&nbsp;<br> rk[ 0] = f12186f9 &nbsp; &nbsp;rk[ 1] = 41662b61 &nbsp; &nbsp;rk[ 2] = 5a6ab19a &nbsp; &nbsp; &nbsp;rk[ 3] = 7ba92077 &nbsp; &nbsp; &nbsp;<br> rk[ 4] = 367360f4 &nbsp; &nbsp;rk[ 5] = 776a0c61 &nbsp; &nbsp;&nbsp;rk[ 6] = b6bb89b3 &nbsp; &nbsp;rk[ 7] = 24763151 &nbsp; &nbsp;&nbsp;<br> rk[ 8] = a520307c &nbsp; &nbsp;&nbsp;rk[ 9] = b7584dbd &nbsp; &nbsp;&nbsp;rk[10] = c30753ed &nbsp; &nbsp; &nbsp;rk[11] = 7ee55b57 &nbsp; &nbsp; &nbsp;<br> rk[12] = 6988608c &nbsp; &nbsp;rk[13] = 30d895b7 &nbsp;&nbsp;rk[14] = 44ba14af &nbsp; &nbsp;rk[15] = 104495a1 &nbsp; &nbsp;&nbsp;<br> rk[16] = d120b428 &nbsp; &nbsp;rk[17] = 73b55fa3 &nbsp; &nbsp;&nbsp;rk[18] = cc874966 &nbsp; &nbsp;&nbsp;rk[19] = 92244439 &nbsp; &nbsp;&nbsp;<br> rk[20] = e89e641f &nbsp; &nbsp; &nbsp;rk[21] = 98ca015a &nbsp; &nbsp; &nbsp;rk[22] = c7159060 &nbsp; &nbsp;&nbsp;rk[23] = 99e1fd2e &nbsp; &nbsp;&nbsp;<br> rk[24] = b79bd80c &nbsp; &nbsp;&nbsp;rk[25] = 1d2115b0 &nbsp; &nbsp;&nbsp;rk[26] = 0e228aeb &nbsp; &nbsp; &nbsp;rk[27] = f1780c81 &nbsp; &nbsp;&nbsp;<br> rk[28] = 428d3654 &nbsp; &nbsp;&nbsp;rk[29] = 62293496 &nbsp; &nbsp;rk[30] = 01cf72e5 &nbsp; &nbsp;&nbsp;rk[31] = 9124a012 &nbsp; &nbsp;</span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><br></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[0] = 27fad345,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[1] = a18b4cb2,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[2] = 11c1e22a,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[3] = cc13e2ee,<span style="font-family:'Times New Roman', serif;font-size:14px;">&nbsp;</span></span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[4] = f87c5bd5, &nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[5] = 33220757,<span style="font-family:'Times New Roman', serif;font-size:14px;">&nbsp;X[6] = 77f4c297,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[7] = 7a96f2eb,&nbsp;</span></span></span></span></span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[8] = 27dac07f, <span style="font-family:'Times New Roman', serif;font-size:14px;">X[9] = 42dd0f19,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[10] = b8a5da02,&nbsp;</span></span>&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[11] = 907127fa,&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[12] = 8b952b83,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">&nbsp;X[13] = d42b7c59,<span style="font-family:'Times New Roman', serif;font-size:14px;">&nbsp;X[14] = 2ffc5831,<span style="font-family:'Times New Roman', serif;font-size:14px;">X[15] = f69e6888,</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[16] = af2432c4,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">&nbsp;X[17] = ed1ec85e,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[18] = 55a3ba22,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[19] = 124b18aa,&nbsp;</span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[20] = 6ae7725f,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[21] = f4cba1f9,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[22] = 1dcdfa10,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[23] = 2ff60603,</span></span></span></span></span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[24] = eff24fdc,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[25] = 6fe46b75,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[26] = 893450ad,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[27] = 7b938f4c ,&nbsp;</span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;"><span style="font-family:'Times New Roman', serif;font-size:14px;">X[28] = 536e4246,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[29] = 86b3e94f,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[30] = d206965e,&nbsp;<span style="font-family:'Times New Roman', serif;font-size:14px;">X[31] = 681edf34.</span></span></span></span></span></span></span></span></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;">轮密钥计算方法：</span></span></span>
   </div> 
   <div style="text-align:left;">
    <span class="MSGENFONTSTYLENAMETEMPLATEROLENUMBERMSGENFONTSTYLENAMEBYROLETEXT3MSGENFONTSTYLEMODIFERSIZE95"><span style="font-family:'Times New Roman', serif;"><span style="font-size:14px;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20150826115222545?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> 密文: 68 1e df 34 d2 06 96 5e 86 b3 e9 4f 53 6e 42 46<br></span></span></span>
   </div> 
   <div style="text-align:left;">
    <span style="font-size:14px;"><br></span>
   </div> 
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u013992766/article/details/48000167,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u013992766/article/details/48000167,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
