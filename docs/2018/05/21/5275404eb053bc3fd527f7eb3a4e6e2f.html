<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>攻克银联QPBOC L2认证的最后两个不过的案例（POS与卡片的数据交互分析） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="攻克银联QPBOC L2认证的最后两个不过的案例（POS与卡片的数据交互分析）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="前几天去北京银联卡检测中心过检QPBOC的 L2测试。一开始挺顺利的，感觉蛮简单的。也不过如此。 但是后续有两个案例，死活不过。让我一度怀疑难道我的RSA算法有问题？还是说移植的RSA算法在我的机器上因字节长度和其他原因导致的？但是不应该啊，脱机认证，要么都过，要么都不过。怎么会唯独这两个案例不过呢？最后仔细读规范，分析透SDA和DDA认证的原理，总算解决啦。至此，L2的所有案例通过。总结下无论是SDA认证还是DDA认证，没什么难的，RSA计算和哈希校验的数据源搞清楚搞正确。字符串拼接来拼接去的，别拼接错了。比如有的公钥模数和公钥余项，两个拼起来才是完整的公钥。公钥模数可能在上一步的RSA计算的输出结果中，公钥余数存在于IC卡上，比如9F48标签。 其次是哈希校验。这部分，看规范中有详细的说明。每一步的哈希校验数据源不一样。中国银联IC卡规范 基础规范的第四部分（表9 由发卡行签名的 IC 卡公钥数据（即哈希算法的输入））和第二部分。Q/CUP 045.2的7.3.1 总结下过程： 动态数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然后用这个公钥来验证IC卡的动态签名。 第一步，用根CA公钥去解密发卡行证书。 卡上的标签90(发卡行公钥证书) 9F32(发卡行公钥模数) 92（发卡行公钥余数） 调用RSA算法，输入源为90的发卡行公钥证书，算法输出结果为：6A 02开头，BC结尾的格式。 这里面有解密出来的发卡行公钥。但是不完整，需要拼接，加上卡上的92标签中的数据，才是完整的发卡行公钥。 接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。02 62 ... +还原出的发卡行公钥+发卡行公钥余项+公钥指数。最后的一项为公钥指数。 第二步，用发卡行公钥还原IC卡证书。 卡上的9F46（IC卡公钥证书） 9F47（IC卡公钥指数）&nbsp; 9F48（IC卡公钥余数） 调用RSA算法，输入源为9F46的IC公钥证书，算法输出结果为：6A 04开头，BC结尾的格式。 这里面有解密出来的IC公钥。但是不完整，需要拼接，加上卡上的9F48标签中的数据，才是完整的IC卡公钥。 接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。04 62 ... +。。。。 第三步，DDA验证，用IC卡公钥去解密9F4B(签名的动态应用数据)， 调用RSA算法，解密成功后的格式为6A 05 ... BC的格式。 接下来验证哈希签名。（注，每步中的验证签名的数据源不一样，具体参照规范Q/CUP 045.2） 第三步验证哈希的数据源为 05 62 ... +IC卡公钥+ PDOL+9F69 需要说明的是： PBOC3.0规范中QPBOC部分，增加了fDDA01算法, 简单来讲，相比较00算法，加了几个tag用于签名，相对安全一些. 下面站在终端的角度详细说说. 首先，在9f66原来缺省的第四个字节的bit8, 要指明终端支持哪个算法, 1表示fDDA01, 0表示fDDA00算法.这个值很关键，因为在PDOL中要送给卡片，卡片要把这个值作为用哪个算法的其中一个决定因素. 如果卡片本身支持fDDA01算法, 且决定了用这个算法, 它会把内部的tag9f69(卡片认证相关数据)置为1，表明自己用这个算法，这个tag会在读数据阶段送给终端. 同时在计算签名时，卡片会把不可预知数（终端, tag 9f37）、授权金额、交易货币代码，连接上卡片ATC和卡片认证相关数据(tag 9f69)作为输入数据. fDDA00算法时，DDA阶段, 终端计算hash值时，输入数据是: 从签名中恢复的部分数据(其中有ATC)+ 不可预知数 当终端从获取的9f69中确认卡片用的是fDDA01算法时，计算hash值时，输入数据是: 从签名中恢复的部分数据(其中有ATC)+ 不可预知数 +授权金额 +交易货币代码 + 卡片认证相关数据 后面的步骤都和PBOC2.0一样了. 如果第三步的哈希也验证通过，至此，DDA脱机验证完成。 这两个案例是： 案例1，CA公钥是1984长度，要能否正确处理卡上数据为1976长度的IC卡证书。 案例2，SFI在11-30文件中的，要能够脱机认证成功。 结果呢，我的测试结果是，案例1中，第二步用CA公钥还原出的发卡行公钥，证书格式应该为 6A 04 .....BC 才对。 但是还原出来的死活不对。郁闷了，跟正常的比，有啥区别呢，把参与RSA计算的DATA打印出来看了下，是 247字节（1976长度）。而正常的都是为偶数。 案例2，我这第二步能否正确还原出证书格式6A 04 ....BC ,但是 哈希校验时，不对。跟卡上的哈希对应不上。 不过，经过进一步分析，这两个问题总算解决了。案例二不过的原因是，对于SFI从11-30的文件，记录的TAG（70）和记录长度，都要用于脱机数据认证。 日志如下： request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:00000000 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A800001283101633555000000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 GPO:交易的开始，GPO需要把PDOL指令填充好，发送给卡片。发给卡片包括金额，时间，国家代码和货币代码等。 可以看到卡片返回： 82 : AIP应用交互特征； 94 ：应用文件定位器； 9F10 : 发卡行应用数据； 9F36 : ATC应用交易计数器； 9F26 : 应用密文； 9F4B : 签名的动态应用数据； 9F6C : 卡片交易属性；（表明啊卡片要求哪一个CVM） 注意：要查看本次交易卡片是拒绝/批准/请求联机的信息，从9F10中看到。如果没有9F10，则需要走借贷记流程。 如果卡片是支持国密算法，则9F38中会请求DF69，而且终端也支持国密算法，则返回DF69的值为01，同时9F66的值最后一个字节为80. 至此，卡片进入预扣款状态，根据卡片响应，得知卡片已经返回脱机成功的状态，终端需要把GPO返回的AFL读完，交易便完成。 4. 第四步，读记录。 下面会有多个指令来回，因为GPO返回的AFL需要读取多个记录。 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223 EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B81900FAEA53E1C52662DAC79CF3C69D9AFFD39DCD558491E29790E530E4AF7DFC73B6EE348B8D44775DCBBD636B2F5CBBC460C5A7045E4E1FCB6AC9601AD6D8AA088D5838484DEE3C1957EC6D9C46376676B690630289A8D0587AE6AA603391A1CD5D114A49189E019FE611E4B40E77A0EC79BE9F1C137D8C05EA286B70F46DE5EB00F040819D3E22C5510F188D2F9B1B2AB9000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F7 2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 7015 5A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=248 6a026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 2cfc8216f35ec7fa84eba562db23c0d1fd618b00bc 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592 rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=248 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799ca75a776e63f22a4b51d3d3890ce32d7effae3e064ae36a6a78605a7a7faa7c01d73e041f296fed4cae41fe3c76337b05ff7779076660c0d46cd362096e1e1160b6c7f6e7c14ad139458cf0c29f69de3f93869eadccaa4dfce7f99c48e5b8cd0359f77df6298d04b685d9bd804dabc44a557b7d144d2095ab38515121b6bd4c021d94f33241defd95157b1f24e3d259d5e9aad7b39ad9f24bc9f7579fe3963f1f9283c300bad79a37a45cbf965b1c0c15ca28591631e88f9b6cb 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 voiceresult [../res/audio/Please Insert Coin.wav] //=================================================== request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A80000128310A21A132B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000 9408 08010500 100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223 EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB 9081F8 14606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F7 2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 70155A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518 rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 6a 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1 e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592 rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] getVoiceList [156] voicelist [9], [Please Insert Coin] voiceresult [../res/audio/Please Insert Coin.wav] //=========================================== request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A80000128310A21A132B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F72AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 70155A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 6a026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] getVoiceList [156] voicelist [9], [Please Insert Coin] voiceresult [../res/audio/Please Insert Coin.wav] ==========begin sha calc:=============== sha in data,len= 046228000100001117ffff1220100010010190018444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb 93e8435c6a3bb1097bc435c2eef7bc7f9378fc7ebc sha in data,len=: 046228000100001117ffff12201000100101 90 01 8444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&nbsp; sha check data is: 93e8435c6a3bb1097bc435c2eef7bc7f9378fc7e sha sum is: ...... //========================================================================= sak=20 request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A800001283106E1F3B1B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[234] 7781E7820230009410080102001001010058010101100202009F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009F4B818047827D3AD7C4D69A013B729B1A63C4C1B4F1CBBACB1028B05C3B7C11618F18F1FFE91B2E91D17561D16BE3CA04E495007D45D1229F75704AA207183CF94A007FBA0FB0DFFCA5E558A98164979A401885CFA0A6588902B3BE68F0F38B4BA8953A45A3CDE6A9A049450F4E71DA552F8F54E102256857397C60817A5E7A7016EFF19000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[179] 7081B08F0161908180 253C3C1FD9928D882111A6AC4CA207DF9310642395EA097B3CB16D517653353803C2C1033E4AACB9735D2E69CA498FEB4CC0AEE1FFC7F54483093A30CCBF6B2011D609E52FD78776B66B6D8695CBC046216BF81C52D5C2F947DEE3ADD7209AB327F29C106BFA0E291D9DAB009106F489BA59436DA94675DF9D31DCAFBD6ABE209224 5C2BFD27CD7F49B1170FC793EF7E11A94FC3C77261CBC39B3679DD7994CC36852E9A19019F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[188] 7081B99F468180 1AC8004382DC40EDC9E761872C7C9B0F1CC0C27B578CC733F927B75A59A67A6FFA590631F723ED648A29488EBD8F598AEA99F12F2ECC120C7649F8C0962D749F5903877C6FB076AA717B4BDD83941D5B3C02AA3E164D441C0A92E8C0DAB60B92432709A2AD83ADC8D0DF2F36B9C92597A2071FFE705E6D4FF5F8B3E9402E45219F482A AA1E6C89EFDA053B78C7D7E665F2FD04835D01166C52092294F2A050DE5E4F24A54E59111678EBB2C6B99F4701039F4A01829000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 7015 5A0862280001000011175F24032012319F080200309000 00B2015C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[6] 70049E0211229000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:97 RID: a000000333010101RID 1.============rsa in data:,len=128 ======================= 253c3c1fd9928d882111a6ac4ca207df9310642395ea097b3cb16d517653353803c2c1033e4aacb9735d2e69ca498feb4cc0aee1ffc7f54483093a30ccbf6b2011d609e52fd78776b66b6d8695cbc046216bf81c52d5c2f947dee3add7209ab327f29c106bfa0e291d9dab009106f489ba59436da94675df9d31dcafbd6abe20 rsa key:,len=128 834d2a387c5a5f176ef3e66caaf83f194b15aad2470c78c77d6eb38edae3a2f9ba1623f6a58c892cc925632dff48ce954b21a53e1f1e4366be403c279b90027cbc72605db6c79049b8992cb4912efa270becab3a7cefe05bfa46e4c7bbcf7c7a173bd988d989b32cb79fac8e35fbe1860e7ea9f238a92a3593552d03d1e38601 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a0262280001122010000101018001 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882abc 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=143: 0262280001122010000101018001 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a190103 sha check data is: 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a sha sum is: 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:128 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=128 ======================= 1ac8004382dc40edc9e761872c7c9b0f1cc0c27b578cc733f927b75a59a67a6ffa590631f723ed648a29488ebd8f598aea99f12f2ecc120c7649f8c0962d749f5903877c6fb076aa717b4bdd83941d5b3c02aa3e164d441c0a92e8c0dab60b92432709a2ad83adc8d0df2f36b9c92597a2071ffe705e6d4ff5f8b3e9402e4521 rsa key:,len=128 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a1901 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a 046228000100001117ffff122010001001018001 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d fd79106dc5c2d4137310021bc62b55ee8224da29 bc 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=159: 046228000100001117ffff122010001001018001 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b90370049e02112290003000 sha check data is: fd79106dc5c2d4137310021bc62b55ee8224da29 sha sum is: 650cdf44c418effe33b859a4ee7547a18574836e sha cmp over! sha cmp not equal! ===========sha clac failed!=============== THIRD_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=128 ======================= 47827d3ad7c4d69a013b729b1a63c4c1b4f1cbbacb1028b05c3b7c11618f18f1ffe91b2e91d17561d16be3ca04e495007d45d1229f75704aa207183cf94a007fba0fb0dffca5e558a98164979a401885cfa0a6588902b3be68f0f38b4ba8953a45a3cde6a9a049450f4e71da552f8f54e102256857397c60817a5e7a7016eff1 rsa key:,len=128 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b9 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf82c5a1b3cebfce4512afd77a27ab41b25fb850dbc 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=126: 05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb6e1f3b1b00000000000101560111223344200000 sha check data is: f82c5a1b3cebfce4512afd77a27ab41b25fb850d sha sum is: f82c5a1b3cebfce4512afd77a27ab41b25fb850d sha cmp over! ==========sha calc sucess!=============== len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 save OthCfg: save OthCfg ok! APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] voiceresult [../res/audio/.wav] open file failed: 阅读更多" />
<meta property="og:description" content="前几天去北京银联卡检测中心过检QPBOC的 L2测试。一开始挺顺利的，感觉蛮简单的。也不过如此。 但是后续有两个案例，死活不过。让我一度怀疑难道我的RSA算法有问题？还是说移植的RSA算法在我的机器上因字节长度和其他原因导致的？但是不应该啊，脱机认证，要么都过，要么都不过。怎么会唯独这两个案例不过呢？最后仔细读规范，分析透SDA和DDA认证的原理，总算解决啦。至此，L2的所有案例通过。总结下无论是SDA认证还是DDA认证，没什么难的，RSA计算和哈希校验的数据源搞清楚搞正确。字符串拼接来拼接去的，别拼接错了。比如有的公钥模数和公钥余项，两个拼起来才是完整的公钥。公钥模数可能在上一步的RSA计算的输出结果中，公钥余数存在于IC卡上，比如9F48标签。 其次是哈希校验。这部分，看规范中有详细的说明。每一步的哈希校验数据源不一样。中国银联IC卡规范 基础规范的第四部分（表9 由发卡行签名的 IC 卡公钥数据（即哈希算法的输入））和第二部分。Q/CUP 045.2的7.3.1 总结下过程： 动态数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然后用这个公钥来验证IC卡的动态签名。 第一步，用根CA公钥去解密发卡行证书。 卡上的标签90(发卡行公钥证书) 9F32(发卡行公钥模数) 92（发卡行公钥余数） 调用RSA算法，输入源为90的发卡行公钥证书，算法输出结果为：6A 02开头，BC结尾的格式。 这里面有解密出来的发卡行公钥。但是不完整，需要拼接，加上卡上的92标签中的数据，才是完整的发卡行公钥。 接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。02 62 ... +还原出的发卡行公钥+发卡行公钥余项+公钥指数。最后的一项为公钥指数。 第二步，用发卡行公钥还原IC卡证书。 卡上的9F46（IC卡公钥证书） 9F47（IC卡公钥指数）&nbsp; 9F48（IC卡公钥余数） 调用RSA算法，输入源为9F46的IC公钥证书，算法输出结果为：6A 04开头，BC结尾的格式。 这里面有解密出来的IC公钥。但是不完整，需要拼接，加上卡上的9F48标签中的数据，才是完整的IC卡公钥。 接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。04 62 ... +。。。。 第三步，DDA验证，用IC卡公钥去解密9F4B(签名的动态应用数据)， 调用RSA算法，解密成功后的格式为6A 05 ... BC的格式。 接下来验证哈希签名。（注，每步中的验证签名的数据源不一样，具体参照规范Q/CUP 045.2） 第三步验证哈希的数据源为 05 62 ... +IC卡公钥+ PDOL+9F69 需要说明的是： PBOC3.0规范中QPBOC部分，增加了fDDA01算法, 简单来讲，相比较00算法，加了几个tag用于签名，相对安全一些. 下面站在终端的角度详细说说. 首先，在9f66原来缺省的第四个字节的bit8, 要指明终端支持哪个算法, 1表示fDDA01, 0表示fDDA00算法.这个值很关键，因为在PDOL中要送给卡片，卡片要把这个值作为用哪个算法的其中一个决定因素. 如果卡片本身支持fDDA01算法, 且决定了用这个算法, 它会把内部的tag9f69(卡片认证相关数据)置为1，表明自己用这个算法，这个tag会在读数据阶段送给终端. 同时在计算签名时，卡片会把不可预知数（终端, tag 9f37）、授权金额、交易货币代码，连接上卡片ATC和卡片认证相关数据(tag 9f69)作为输入数据. fDDA00算法时，DDA阶段, 终端计算hash值时，输入数据是: 从签名中恢复的部分数据(其中有ATC)+ 不可预知数 当终端从获取的9f69中确认卡片用的是fDDA01算法时，计算hash值时，输入数据是: 从签名中恢复的部分数据(其中有ATC)+ 不可预知数 +授权金额 +交易货币代码 + 卡片认证相关数据 后面的步骤都和PBOC2.0一样了. 如果第三步的哈希也验证通过，至此，DDA脱机验证完成。 这两个案例是： 案例1，CA公钥是1984长度，要能否正确处理卡上数据为1976长度的IC卡证书。 案例2，SFI在11-30文件中的，要能够脱机认证成功。 结果呢，我的测试结果是，案例1中，第二步用CA公钥还原出的发卡行公钥，证书格式应该为 6A 04 .....BC 才对。 但是还原出来的死活不对。郁闷了，跟正常的比，有啥区别呢，把参与RSA计算的DATA打印出来看了下，是 247字节（1976长度）。而正常的都是为偶数。 案例2，我这第二步能否正确还原出证书格式6A 04 ....BC ,但是 哈希校验时，不对。跟卡上的哈希对应不上。 不过，经过进一步分析，这两个问题总算解决了。案例二不过的原因是，对于SFI从11-30的文件，记录的TAG（70）和记录长度，都要用于脱机数据认证。 日志如下： request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:00000000 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A800001283101633555000000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 GPO:交易的开始，GPO需要把PDOL指令填充好，发送给卡片。发给卡片包括金额，时间，国家代码和货币代码等。 可以看到卡片返回： 82 : AIP应用交互特征； 94 ：应用文件定位器； 9F10 : 发卡行应用数据； 9F36 : ATC应用交易计数器； 9F26 : 应用密文； 9F4B : 签名的动态应用数据； 9F6C : 卡片交易属性；（表明啊卡片要求哪一个CVM） 注意：要查看本次交易卡片是拒绝/批准/请求联机的信息，从9F10中看到。如果没有9F10，则需要走借贷记流程。 如果卡片是支持国密算法，则9F38中会请求DF69，而且终端也支持国密算法，则返回DF69的值为01，同时9F66的值最后一个字节为80. 至此，卡片进入预扣款状态，根据卡片响应，得知卡片已经返回脱机成功的状态，终端需要把GPO返回的AFL读完，交易便完成。 4. 第四步，读记录。 下面会有多个指令来回，因为GPO返回的AFL需要读取多个记录。 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223 EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B81900FAEA53E1C52662DAC79CF3C69D9AFFD39DCD558491E29790E530E4AF7DFC73B6EE348B8D44775DCBBD636B2F5CBBC460C5A7045E4E1FCB6AC9601AD6D8AA088D5838484DEE3C1957EC6D9C46376676B690630289A8D0587AE6AA603391A1CD5D114A49189E019FE611E4B40E77A0EC79BE9F1C137D8C05EA286B70F46DE5EB00F040819D3E22C5510F188D2F9B1B2AB9000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F7 2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 7015 5A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=248 6a026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 2cfc8216f35ec7fa84eba562db23c0d1fd618b00bc 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592 rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=248 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799ca75a776e63f22a4b51d3d3890ce32d7effae3e064ae36a6a78605a7a7faa7c01d73e041f296fed4cae41fe3c76337b05ff7779076660c0d46cd362096e1e1160b6c7f6e7c14ad139458cf0c29f69de3f93869eadccaa4dfce7f99c48e5b8cd0359f77df6298d04b685d9bd804dabc44a557b7d144d2095ab38515121b6bd4c021d94f33241defd95157b1f24e3d259d5e9aad7b39ad9f24bc9f7579fe3963f1f9283c300bad79a37a45cbf965b1c0c15ca28591631e88f9b6cb 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 voiceresult [../res/audio/Please Insert Coin.wav] //=================================================== request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A80000128310A21A132B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000 9408 08010500 100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223 EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB 9081F8 14606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F7 2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 70155A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518 rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 6a 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1 e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592 rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] getVoiceList [156] voicelist [9], [Please Insert Coin] voiceresult [../res/audio/Please Insert Coin.wav] //=========================================== request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A80000128310A21A132B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F72AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 70155A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 6a026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] getVoiceList [156] voicelist [9], [Please Insert Coin] voiceresult [../res/audio/Please Insert Coin.wav] ==========begin sha calc:=============== sha in data,len= 046228000100001117ffff1220100010010190018444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb 93e8435c6a3bb1097bc435c2eef7bc7f9378fc7ebc sha in data,len=: 046228000100001117ffff12201000100101 90 01 8444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&nbsp; sha check data is: 93e8435c6a3bb1097bc435c2eef7bc7f9378fc7e sha sum is: ...... //========================================================================= sak=20 request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A800001283106E1F3B1B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[234] 7781E7820230009410080102001001010058010101100202009F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009F4B818047827D3AD7C4D69A013B729B1A63C4C1B4F1CBBACB1028B05C3B7C11618F18F1FFE91B2E91D17561D16BE3CA04E495007D45D1229F75704AA207183CF94A007FBA0FB0DFFCA5E558A98164979A401885CFA0A6588902B3BE68F0F38B4BA8953A45A3CDE6A9A049450F4E71DA552F8F54E102256857397C60817A5E7A7016EFF19000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[179] 7081B08F0161908180 253C3C1FD9928D882111A6AC4CA207DF9310642395EA097B3CB16D517653353803C2C1033E4AACB9735D2E69CA498FEB4CC0AEE1FFC7F54483093A30CCBF6B2011D609E52FD78776B66B6D8695CBC046216BF81C52D5C2F947DEE3ADD7209AB327F29C106BFA0E291D9DAB009106F489BA59436DA94675DF9D31DCAFBD6ABE209224 5C2BFD27CD7F49B1170FC793EF7E11A94FC3C77261CBC39B3679DD7994CC36852E9A19019F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[188] 7081B99F468180 1AC8004382DC40EDC9E761872C7C9B0F1CC0C27B578CC733F927B75A59A67A6FFA590631F723ED648A29488EBD8F598AEA99F12F2ECC120C7649F8C0962D749F5903877C6FB076AA717B4BDD83941D5B3C02AA3E164D441C0A92E8C0DAB60B92432709A2AD83ADC8D0DF2F36B9C92597A2071FFE705E6D4FF5F8B3E9402E45219F482A AA1E6C89EFDA053B78C7D7E665F2FD04835D01166C52092294F2A050DE5E4F24A54E59111678EBB2C6B99F4701039F4A01829000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 7015 5A0862280001000011175F24032012319F080200309000 00B2015C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[6] 70049E0211229000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:97 RID: a000000333010101RID 1.============rsa in data:,len=128 ======================= 253c3c1fd9928d882111a6ac4ca207df9310642395ea097b3cb16d517653353803c2c1033e4aacb9735d2e69ca498feb4cc0aee1ffc7f54483093a30ccbf6b2011d609e52fd78776b66b6d8695cbc046216bf81c52d5c2f947dee3add7209ab327f29c106bfa0e291d9dab009106f489ba59436da94675df9d31dcafbd6abe20 rsa key:,len=128 834d2a387c5a5f176ef3e66caaf83f194b15aad2470c78c77d6eb38edae3a2f9ba1623f6a58c892cc925632dff48ce954b21a53e1f1e4366be403c279b90027cbc72605db6c79049b8992cb4912efa270becab3a7cefe05bfa46e4c7bbcf7c7a173bd988d989b32cb79fac8e35fbe1860e7ea9f238a92a3593552d03d1e38601 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a0262280001122010000101018001 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882abc 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=143: 0262280001122010000101018001 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a190103 sha check data is: 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a sha sum is: 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:128 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=128 ======================= 1ac8004382dc40edc9e761872c7c9b0f1cc0c27b578cc733f927b75a59a67a6ffa590631f723ed648a29488ebd8f598aea99f12f2ecc120c7649f8c0962d749f5903877c6fb076aa717b4bdd83941d5b3c02aa3e164d441c0a92e8c0dab60b92432709a2ad83adc8d0df2f36b9c92597a2071ffe705e6d4ff5f8b3e9402e4521 rsa key:,len=128 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a1901 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a 046228000100001117ffff122010001001018001 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d fd79106dc5c2d4137310021bc62b55ee8224da29 bc 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=159: 046228000100001117ffff122010001001018001 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b90370049e02112290003000 sha check data is: fd79106dc5c2d4137310021bc62b55ee8224da29 sha sum is: 650cdf44c418effe33b859a4ee7547a18574836e sha cmp over! sha cmp not equal! ===========sha clac failed!=============== THIRD_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=128 ======================= 47827d3ad7c4d69a013b729b1a63c4c1b4f1cbbacb1028b05c3b7c11618f18f1ffe91b2e91d17561d16be3ca04e495007d45d1229f75704aa207183cf94a007fba0fb0dffca5e558a98164979a401885cfa0a6588902b3be68f0f38b4ba8953a45a3cde6a9a049450f4e71da552f8f54e102256857397c60817a5e7a7016eff1 rsa key:,len=128 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b9 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf82c5a1b3cebfce4512afd77a27ab41b25fb850dbc 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=126: 05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb6e1f3b1b00000000000101560111223344200000 sha check data is: f82c5a1b3cebfce4512afd77a27ab41b25fb850d sha sum is: f82c5a1b3cebfce4512afd77a27ab41b25fb850d sha cmp over! ==========sha calc sucess!=============== len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 save OthCfg: save OthCfg ok! APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] voiceresult [../res/audio/.wav] open file failed: 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/05/21/5275404eb053bc3fd527f7eb3a4e6e2f.html" />
<meta property="og:url" content="https://mlh.app/2018/05/21/5275404eb053bc3fd527f7eb3a4e6e2f.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-05-21T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"前几天去北京银联卡检测中心过检QPBOC的 L2测试。一开始挺顺利的，感觉蛮简单的。也不过如此。 但是后续有两个案例，死活不过。让我一度怀疑难道我的RSA算法有问题？还是说移植的RSA算法在我的机器上因字节长度和其他原因导致的？但是不应该啊，脱机认证，要么都过，要么都不过。怎么会唯独这两个案例不过呢？最后仔细读规范，分析透SDA和DDA认证的原理，总算解决啦。至此，L2的所有案例通过。总结下无论是SDA认证还是DDA认证，没什么难的，RSA计算和哈希校验的数据源搞清楚搞正确。字符串拼接来拼接去的，别拼接错了。比如有的公钥模数和公钥余项，两个拼起来才是完整的公钥。公钥模数可能在上一步的RSA计算的输出结果中，公钥余数存在于IC卡上，比如9F48标签。 其次是哈希校验。这部分，看规范中有详细的说明。每一步的哈希校验数据源不一样。中国银联IC卡规范 基础规范的第四部分（表9 由发卡行签名的 IC 卡公钥数据（即哈希算法的输入））和第二部分。Q/CUP 045.2的7.3.1 总结下过程： 动态数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然后用这个公钥来验证IC卡的动态签名。 第一步，用根CA公钥去解密发卡行证书。 卡上的标签90(发卡行公钥证书) 9F32(发卡行公钥模数) 92（发卡行公钥余数） 调用RSA算法，输入源为90的发卡行公钥证书，算法输出结果为：6A 02开头，BC结尾的格式。 这里面有解密出来的发卡行公钥。但是不完整，需要拼接，加上卡上的92标签中的数据，才是完整的发卡行公钥。 接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。02 62 ... +还原出的发卡行公钥+发卡行公钥余项+公钥指数。最后的一项为公钥指数。 第二步，用发卡行公钥还原IC卡证书。 卡上的9F46（IC卡公钥证书） 9F47（IC卡公钥指数）&nbsp; 9F48（IC卡公钥余数） 调用RSA算法，输入源为9F46的IC公钥证书，算法输出结果为：6A 04开头，BC结尾的格式。 这里面有解密出来的IC公钥。但是不完整，需要拼接，加上卡上的9F48标签中的数据，才是完整的IC卡公钥。 接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。04 62 ... +。。。。 第三步，DDA验证，用IC卡公钥去解密9F4B(签名的动态应用数据)， 调用RSA算法，解密成功后的格式为6A 05 ... BC的格式。 接下来验证哈希签名。（注，每步中的验证签名的数据源不一样，具体参照规范Q/CUP 045.2） 第三步验证哈希的数据源为 05 62 ... +IC卡公钥+ PDOL+9F69 需要说明的是： PBOC3.0规范中QPBOC部分，增加了fDDA01算法, 简单来讲，相比较00算法，加了几个tag用于签名，相对安全一些. 下面站在终端的角度详细说说. 首先，在9f66原来缺省的第四个字节的bit8, 要指明终端支持哪个算法, 1表示fDDA01, 0表示fDDA00算法.这个值很关键，因为在PDOL中要送给卡片，卡片要把这个值作为用哪个算法的其中一个决定因素. 如果卡片本身支持fDDA01算法, 且决定了用这个算法, 它会把内部的tag9f69(卡片认证相关数据)置为1，表明自己用这个算法，这个tag会在读数据阶段送给终端. 同时在计算签名时，卡片会把不可预知数（终端, tag 9f37）、授权金额、交易货币代码，连接上卡片ATC和卡片认证相关数据(tag 9f69)作为输入数据. fDDA00算法时，DDA阶段, 终端计算hash值时，输入数据是: 从签名中恢复的部分数据(其中有ATC)+ 不可预知数 当终端从获取的9f69中确认卡片用的是fDDA01算法时，计算hash值时，输入数据是: 从签名中恢复的部分数据(其中有ATC)+ 不可预知数 +授权金额 +交易货币代码 + 卡片认证相关数据 后面的步骤都和PBOC2.0一样了. 如果第三步的哈希也验证通过，至此，DDA脱机验证完成。 这两个案例是： 案例1，CA公钥是1984长度，要能否正确处理卡上数据为1976长度的IC卡证书。 案例2，SFI在11-30文件中的，要能够脱机认证成功。 结果呢，我的测试结果是，案例1中，第二步用CA公钥还原出的发卡行公钥，证书格式应该为 6A 04 .....BC 才对。 但是还原出来的死活不对。郁闷了，跟正常的比，有啥区别呢，把参与RSA计算的DATA打印出来看了下，是 247字节（1976长度）。而正常的都是为偶数。 案例2，我这第二步能否正确还原出证书格式6A 04 ....BC ,但是 哈希校验时，不对。跟卡上的哈希对应不上。 不过，经过进一步分析，这两个问题总算解决了。案例二不过的原因是，对于SFI从11-30的文件，记录的TAG（70）和记录长度，都要用于脱机数据认证。 日志如下： request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:00000000 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A800001283101633555000000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 GPO:交易的开始，GPO需要把PDOL指令填充好，发送给卡片。发给卡片包括金额，时间，国家代码和货币代码等。 可以看到卡片返回： 82 : AIP应用交互特征； 94 ：应用文件定位器； 9F10 : 发卡行应用数据； 9F36 : ATC应用交易计数器； 9F26 : 应用密文； 9F4B : 签名的动态应用数据； 9F6C : 卡片交易属性；（表明啊卡片要求哪一个CVM） 注意：要查看本次交易卡片是拒绝/批准/请求联机的信息，从9F10中看到。如果没有9F10，则需要走借贷记流程。 如果卡片是支持国密算法，则9F38中会请求DF69，而且终端也支持国密算法，则返回DF69的值为01，同时9F66的值最后一个字节为80. 至此，卡片进入预扣款状态，根据卡片响应，得知卡片已经返回脱机成功的状态，终端需要把GPO返回的AFL读完，交易便完成。 4. 第四步，读记录。 下面会有多个指令来回，因为GPO返回的AFL需要读取多个记录。 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223 EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B81900FAEA53E1C52662DAC79CF3C69D9AFFD39DCD558491E29790E530E4AF7DFC73B6EE348B8D44775DCBBD636B2F5CBBC460C5A7045E4E1FCB6AC9601AD6D8AA088D5838484DEE3C1957EC6D9C46376676B690630289A8D0587AE6AA603391A1CD5D114A49189E019FE611E4B40E77A0EC79BE9F1C137D8C05EA286B70F46DE5EB00F040819D3E22C5510F188D2F9B1B2AB9000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F7 2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 7015 5A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=248 6a026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 2cfc8216f35ec7fa84eba562db23c0d1fd618b00bc 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592 rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=248 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799ca75a776e63f22a4b51d3d3890ce32d7effae3e064ae36a6a78605a7a7faa7c01d73e041f296fed4cae41fe3c76337b05ff7779076660c0d46cd362096e1e1160b6c7f6e7c14ad139458cf0c29f69de3f93869eadccaa4dfce7f99c48e5b8cd0359f77df6298d04b685d9bd804dabc44a557b7d144d2095ab38515121b6bd4c021d94f33241defd95157b1f24e3d259d5e9aad7b39ad9f24bc9f7579fe3963f1f9283c300bad79a37a45cbf965b1c0c15ca28591631e88f9b6cb 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 voiceresult [../res/audio/Please Insert Coin.wav] //=================================================== request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A80000128310A21A132B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000 9408 08010500 100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223 EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB 9081F8 14606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F7 2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 70155A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518 rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 6a 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1 e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592 rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60 ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] getVoiceList [156] voicelist [9], [Please Insert Coin] voiceresult [../res/audio/Please Insert Coin.wav] //=========================================== request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A80000128310A21A132B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93] 775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46] 702C8F01059223EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13] 700B9F48009F4701039F4A01829000 00B2030C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000 00B2040C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151] 7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000 00B2050C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254] 7081FB9F4681F72AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 70155A0862280001000011175F24032012319F080200309000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:5 RID: a000000333010101RID 1.============rsa in data:,len=248 ======================= 14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248 97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 6a026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=262: 026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103 sha check data is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha sum is: 2cfc8216f35ec7fa84eba562db23c0d1fd618b00 sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=247 ======================= 2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592rsa key:,len=247 dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=62 000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: dda_check err,rcdoe:1 len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] getVoiceList [156] voicelist [9], [Please Insert Coin] voiceresult [../res/audio/Please Insert Coin.wav] ==========begin sha calc:=============== sha in data,len= 046228000100001117ffff1220100010010190018444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb 93e8435c6a3bb1097bc435c2eef7bc7f9378fc7ebc sha in data,len=: 046228000100001117ffff12201000100101 90 01 8444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&nbsp; sha check data is: 93e8435c6a3bb1097bc435c2eef7bc7f9378fc7e sha sum is: ...... //========================================================================= sak=20 request card ok sem_post(gSem_EVT_CARD_OK) CardPhyType = CPU CardPhySn:27E93B11 00A404000E325041592E5359532E4444463031 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52] 6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000 00A4040008A000000333010101 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72] 6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000 TVLA5FCI.Len=1 80A800001283106E1F3B1B00000000000101562800008000 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[234] 7781E7820230009410080102001001010058010101100202009F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009F4B818047827D3AD7C4D69A013B729B1A63C4C1B4F1CBBACB1028B05C3B7C11618F18F1FFE91B2E91D17561D16BE3CA04E495007D45D1229F75704AA207183CF94A007FBA0FB0DFFCA5E558A98164979A401885CFA0A6588902B3BE68F0F38B4BA8953A45A3CDE6A9A049450F4E71DA552F8F54E102256857397C60817A5E7A7016EFF19000 UP_TlvRecDataReading 00B2010C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[179] 7081B08F0161908180 253C3C1FD9928D882111A6AC4CA207DF9310642395EA097B3CB16D517653353803C2C1033E4AACB9735D2E69CA498FEB4CC0AEE1FFC7F54483093A30CCBF6B2011D609E52FD78776B66B6D8695CBC046216BF81C52D5C2F947DEE3ADD7209AB327F29C106BFA0E291D9DAB009106F489BA59436DA94675DF9D31DCAFBD6ABE209224 5C2BFD27CD7F49B1170FC793EF7E11A94FC3C77261CBC39B3679DD7994CC36852E9A19019F3201039000 00B2020C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[188] 7081B99F468180 1AC8004382DC40EDC9E761872C7C9B0F1CC0C27B578CC733F927B75A59A67A6FFA590631F723ED648A29488EBD8F598AEA99F12F2ECC120C7649F8C0962D749F5903877C6FB076AA717B4BDD83941D5B3C02AA3E164D441C0A92E8C0DAB60B92432709A2AD83ADC8D0DF2F36B9C92597A2071FFE705E6D4FF5F8B3E9402E45219F482A AA1E6C89EFDA053B78C7D7E665F2FD04835D01166C52092294F2A050DE5E4F24A54E59111678EBB2C6B99F4701039F4A01829000 00B2011400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23] 7015 5A0862280001000011175F24032012319F080200309000 00B2015C00 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[6] 70049E0211229000 00B2021400 &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22] 70149F690801112233442000009F74064543433131319000 BalanceDisStat:1 UP_RSA_First: RID Index:97 RID: a000000333010101RID 1.============rsa in data:,len=128 ======================= 253c3c1fd9928d882111a6ac4ca207df9310642395ea097b3cb16d517653353803c2c1033e4aacb9735d2e69ca498feb4cc0aee1ffc7f54483093a30ccbf6b2011d609e52fd78776b66b6d8695cbc046216bf81c52d5c2f947dee3add7209ab327f29c106bfa0e291d9dab009106f489ba59436da94675df9d31dcafbd6abe20 rsa key:,len=128 834d2a387c5a5f176ef3e66caaf83f194b15aad2470c78c77d6eb38edae3a2f9ba1623f6a58c892cc925632dff48ce954b21a53e1f1e4366be403c279b90027cbc72605db6c79049b8992cb4912efa270becab3a7cefe05bfa46e4c7bbcf7c7a173bd988d989b32cb79fac8e35fbe1860e7ea9f238a92a3593552d03d1e38601 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a0262280001122010000101018001 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882abc 2.=================rsa proc end ========================= UP_RSA_First ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=143: 0262280001122010000101018001 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a190103 sha check data is: 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a sha sum is: 5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a sha cmp over! ==========sha calc sucess!=============== CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:128 SECOND_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=128 ======================= 1ac8004382dc40edc9e761872c7c9b0f1cc0c27b578cc733f927b75a59a67a6ffa590631f723ed648a29488ebd8f598aea99f12f2ecc120c7649f8c0962d749f5903877c6fb076aa717b4bdd83941d5b3c02aa3e164d441c0a92e8c0dab60b92432709a2ad83adc8d0df2f36b9c92597a2071ffe705e6d4ff5f8b3e9402e4521 rsa key:,len=128 e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1 5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a1901 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a 046228000100001117ffff122010001001018001 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d fd79106dc5c2d4137310021bc62b55ee8224da29 bc 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=159: 046228000100001117ffff122010001001018001 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b90370049e02112290003000 sha check data is: fd79106dc5c2d4137310021bc62b55ee8224da29 sha sum is: 650cdf44c418effe33b859a4ee7547a18574836e sha cmp over! sha cmp not equal! ===========sha clac failed!=============== THIRD_FORMAT: UP_RSA_SecondOrThird begin: 1.============rsa in data:,len=128 ======================= 47827d3ad7c4d69a013b729b1a63c4c1b4f1cbbacb1028b05c3b7c11618f18f1ffe91b2e91d17561d16be3ca04e495007d45d1229f75704aa207183cf94a007fba0fb0dffca5e558a98164979a401885cfa0a6588902b3be68f0f38b4ba8953a45a3cde6a9a049450f4e71da552f8f54e102256857397c60817a5e7a7016eff1 rsa key:,len=128 870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b9 begin rsa calc: rsa calc,E is3 begin rsa calc... rsa out data:,len=128 6a05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf82c5a1b3cebfce4512afd77a27ab41b25fb850dbc 2.=================rsa proc end ========================= UP_RSA_SecondOrThird ok! begin dda_check: ==========begin sha calc:=============== sha in data,len=126: 05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb6e1f3b1b00000000000101560111223344200000 sha check data is: f82c5a1b3cebfce4512afd77a27ab41b25fb850d sha sum is: f82c5a1b3cebfce4512afd77a27ab41b25fb850d sha cmp over! ==========sha calc sucess!=============== len0=163 len1=187 len2=207 TVL5F20NAME.Len=0 len3=234 TVL9F5D.Len=6 save OthCfg: save OthCfg ok! APP_VoiceDisplay [213] volume:5 getVoicePlayName [180] voiceresult [../res/audio/.wav] open file failed: 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/05/21/5275404eb053bc3fd527f7eb3a4e6e2f.html","headline":"攻克银联QPBOC L2认证的最后两个不过的案例（POS与卡片的数据交互分析）","dateModified":"2018-05-21T00:00:00+08:00","datePublished":"2018-05-21T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/05/21/5275404eb053bc3fd527f7eb3a4e6e2f.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>攻克银联QPBOC L2认证的最后两个不过的案例（POS与卡片的数据交互分析）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="background-color:rgb(255,255,255);">前几天去北京银联卡检测中心过检QPBOC的 L2测试。一开始挺顺利的，感觉蛮简单的。也不过如此。</p>
  <p style="background-color:rgb(255,255,255);">但是后续有两个案例，死活不过。让我一度怀疑难道我的RSA算法有问题？还是说移植的RSA算法在我的机器上因字节长度和其他原因导致的？但是不应该啊，脱机认证，要么都过，要么都不过。怎么会唯独这两个案例不过呢？最后仔细读规范，分析透SDA和DDA认证的原理，总算解决啦。至此，L2的所有案例通过。总结下无论是SDA认证还是DDA认证，没什么难的，RSA计算和哈希校验的数据源搞清楚搞正确。字符串拼接来拼接去的，别拼接错了。比如有的公钥模数和公钥余项，两个拼起来才是完整的公钥。公钥模数可能在上一步的RSA计算的输出结果中，公钥余数存在于IC卡上，比如9F48标签。</p>
  <p style="background-color:rgb(255,255,255);">其次是哈希校验。这部分，看规范中有详细的说明。每一步的哈希校验数据源不一样。中国银联IC卡规范 基础规范的第四部分（表9 由发卡行签名的 IC 卡公钥数据（即哈希算法的输入））和第二部分。Q/CUP 045.2的7.3.1</p>
  <p style="background-color:rgb(255,255,255);">总结下过程：</p>
  <p style="background-color:rgb(255,255,255);">动态数据认证采用了一个三层的公钥证书方案。每一个IC卡公钥由它的发卡行认证，而认证中心认<br>证发卡行公钥。这表明为了验证IC卡的签名，终端需要先通过验证两个证书来恢复和验证IC卡公钥，然<br>后用这个公钥来验证IC卡的动态签名。<br></p>
  <p style="background-color:rgb(255,255,255);">第一步，用根CA公钥去解密发卡行证书。</p>
  <p style="background-color:rgb(255,255,255);">卡上的标签90(发卡行公钥证书) 9F32(发卡行公钥模数) 92（发卡行公钥余数）</p>
  <p style="background-color:rgb(255,255,255);">调用RSA算法，输入源为90的发卡行公钥证书，算法输出结果为：6A 02开头，BC结尾的格式。</p>
  <p style="background-color:rgb(255,255,255);">这里面有解密出来的发卡行公钥。但是不完整，需要拼接，加上卡上的92标签中的数据，才是完整的发卡行公钥。</p>
  <p style="background-color:rgb(255,255,255);">接下来验证哈希签名是否一致。哈希的数据源参照规范<span style="background-color:rgb(255,255,255);">Q/CUP 045.2</span>。02 62 ... +还原出的发卡行公钥+发卡行公钥余项+公钥指数。最后的一项为公钥指数。</p>
  <p style="background-color:rgb(255,255,255);">第二步，用发卡行公钥还原IC卡证书。</p>
  <p style="background-color:rgb(255,255,255);">卡上的9F46（IC卡公钥证书） 9F47（IC卡公钥指数）&nbsp; 9F48（IC卡公钥余数）</p>
  <p style="background-color:rgb(255,255,255);"><span style="background-color:rgb(255,255,255);">调用RSA算法，输入源为9F46的IC公钥证书，算法输出结果为：6A 04开头，BC结尾的格式。</span></p>
  <p style="background-color:rgb(255,255,255);">这里面有解密出来的IC公钥。但是不完整，需要拼接，加上卡上的9F48标签中的数据，才是完整的IC卡公钥。</p>
  <p style="background-color:rgb(255,255,255);">接下来验证哈希签名是否一致。哈希的数据源参照规范Q/CUP 045.2。04 62 ... +。。。。</p>
  <p><span style="background-color:rgb(255,255,255);">第三步，DDA验证，用IC卡公钥去解密9F4B(签名的动态应用数据)，</span></p>
  <p><span style="background-color:rgb(255,255,255);">调用RSA算法，解密成功后的格式为6A 05 ... BC的格式。</span></p>
  <p><span style="background-color:rgb(255,255,255);">接下来验证哈希签名。（注，每步中的验证签名的数据源不一样，具体参照规范<span style="background-color:rgb(255,255,255);">Q/CUP 045.2</span>）</span></p>
  <p><span style="background-color:rgb(255,255,255);">第三步验证哈希的数据源为 05 62 ... +IC卡公钥+ PDOL+9F69</span></p>
  <p><span style="background-color:rgb(255,255,255);">需要说明的是：</span></p>
  <p style="background-color:rgb(255,255,255);">PBOC3.0规范中QPBOC部分，增加了fDDA01算法, 简单来讲，相比较00算法，加了几个tag用于签名，相对安全一些. 下面站在终端的角度详细说说.</p>
  <p style="background-color:rgb(255,255,255);">首先，在9f66原来缺省的第四个字节的bit8, 要指明终端支持哪个算法, 1表示fDDA01, 0表示fDDA00算法.这个值很关键，因为在PDOL中要送给卡片，卡片要把这个值作为用哪个算法的其中一个决定因素.</p>
  <p align="left" style="background-color:rgb(255,255,255);">如果卡片本身支持fDDA01算法, 且决定了用这个算法, 它会把内部的tag9f69(卡片认证相关数据)置为1，表明自己用这个算法，这个tag会在读数据阶段送给终端. 同时在计算签名时，卡片会把不可预知数（终端, tag 9f37）、授权金额、交易货币代码，连接上卡片ATC和卡片认证相关数据(tag 9f69)作为输入数据.</p>
  <p align="left" style="background-color:rgb(255,255,255);">fDDA00算法时，DDA阶段, 终端计算hash值时，输入数据是:</p>
  <p align="left" style="background-color:rgb(255,255,255);">从签名中恢复的部分数据(其中有ATC)+ 不可预知数</p>
  <p align="left" style="background-color:rgb(255,255,255);">当终端从获取的9f69中确认卡片用的是fDDA01算法时，计算hash值时，输入数据是:</p>
  <p align="left" style="background-color:rgb(255,255,255);">从签名中恢复的部分数据(其中有ATC)+ 不可预知数 +授权金额 +交易货币代码 + 卡片认证相关数据</p>
  <p align="left" style="background-color:rgb(255,255,255);">后面的步骤都和PBOC2.0一样了.</p>
  <p>如果第三步的哈希也验证通过，至此，DDA脱机验证完成。</p>
  <p style="background-color:rgb(255,255,255);">这两个案例是：</p>
  <p style="background-color:rgb(255,255,255);">案例1，CA公钥是1984长度，要能否正确处理卡上数据为1976长度的IC卡证书。</p>
  <p style="background-color:rgb(255,255,255);">案例2，SFI在11-30文件中的，要能够脱机认证成功。</p>
  <p style="background-color:rgb(255,255,255);">结果呢，我的测试结果是，案例1中，第二步用CA公钥还原出的发卡行公钥，证书格式应该为 6A 04 .....BC 才对。</p>
  <p style="background-color:rgb(255,255,255);">但是还原出来的死活不对。郁闷了，跟正常的比，有啥区别呢，把参与RSA计算的DATA打印出来看了下，是 247字节（1976长度）。而正常的都是为偶数。</p>
  <p style="background-color:rgb(255,255,255);">案例2，我这第二步能否正确还原出证书格式6A 04 ....BC ,但是 哈希校验时，不对。跟卡上的哈希对应不上。</p>
  <p style="background-color:rgb(255,255,255);">不过，经过进一步分析，这两个问题总算解决了。案例二不过的原因是，对于SFI从11-30的文件，记录的TAG（70）和记录长度，都要用于脱机数据认证。</p>
  <p style="background-color:rgb(255,255,255);">日志如下：</p>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   request card ok
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sem_post(gSem_EVT_CARD_OK)
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhyType = CPU
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhySn:00000000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A404000E325041592E5359532E4444463031
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A4040008A000000333010101
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVLA5FCI.Len=1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   80A800001283101633555000000000000101562800008000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000
  </div>
  <p align="left" style="background-color:rgb(255,255,255);">GPO:交易的开始，GPO需要把PDOL指令填充好，发送给卡片。发给卡片包括金额，时间，国家代码和货币代码等。</p>
  <p align="left" style="background-color:rgb(255,255,255);">可以看到卡片返回：</p>
  <p align="left" style="background-color:rgb(255,255,255);">82 : AIP应用交互特征；</p>
  <p align="left" style="background-color:rgb(255,255,255);">94 ：应用文件定位器；</p>
  <p align="left" style="background-color:rgb(255,255,255);">9F10 : 发卡行应用数据；</p>
  <p align="left" style="background-color:rgb(255,255,255);">9F36 : ATC应用交易计数器；</p>
  <p align="left" style="background-color:rgb(255,255,255);">9F26 : 应用密文；</p>
  <p align="left" style="background-color:rgb(255,255,255);">9F4B : 签名的动态应用数据；</p>
  <p align="left" style="background-color:rgb(255,255,255);">9F6C : 卡片交易属性；（表明啊卡片要求哪一个CVM）</p>
  <p align="left" style="background-color:rgb(255,255,255);">注意：要查看本次交易卡片是拒绝/批准/请求联机的信息，从9F10中看到。如果没有9F10，则需要走借贷记流程。</p>
  <p align="left" style="background-color:rgb(255,255,255);">如果卡片是支持国密算法，则9F38中会请求DF69，而且终端也支持国密算法，则返回DF69的值为01，同时9F66的值最后一个字节为80.</p>
  <p align="left" style="background-color:rgb(255,255,255);">至此，卡片进入预扣款状态，根据卡片响应，得知卡片已经返回脱机成功的状态，终端需要把GPO返回的AFL读完，交易便完成。</p>
  <p style="background-color:rgb(255,255,255);">4. 第四步，读记录。</p>
  <p style="background-color:rgb(255,255,255);">下面会有多个指令来回，因为GPO返回的AFL需要读取多个记录。</p>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_TlvRecDataReading
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2010C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   702C8F01059223
   <span style="color:rgb(147,150,0);">EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA1</span>9F3201039000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2020C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   700B9F48009F4701039F4A01829000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2030C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2040C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081949F4B81900FAEA53E1C52662DAC79CF3C69D9AFFD39DCD558491E29790E530E4AF7DFC73B6EE348B8D44775DCBBD636B2F5CBBC460C5A7045E4E1FCB6AC9601AD6D8AA088D5838484DEE3C1957EC6D9C46376676B690630289A8D0587AE6AA603391A1CD5D114A49189E019FE611E4B40E77A0EC79BE9F1C137D8C05EA286B70F46DE5EB00F040819D3E22C5510F188D2F9B1B2AB9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2050C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081FB9F4681F7
   <span style="color:rgb(50,135,18);">2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC7592</span>9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2011400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7015
   <span style="font-weight:bold;">5A0862280001000011175F24032012319F08020030</span>9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2021400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   70149F690801112233442000009F74064543433131319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   BalanceDisStat:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID Index:5
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   a000000333010101RID
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=248 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=248
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6a026228000112201000010101f701
   <span style="color:rgb(227,0,0);">dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60</span>
   <span style="color:rgb(222,87,0);">2cfc8216f35ec7fa84eba562db23c0d1fd618b00</span>bc
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=262:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   026228000112201000010101f701
   <span style="color:rgb(227,0,0);">dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60</span>
   <span style="color:rgb(147,150,0);">ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1</span>03
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(222,87,0);">2cfc8216f35ec7fa84eba562db23c0d1fd618b00</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2cfc8216f35ec7fa84eba562db23c0d1fd618b00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha cmp over!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========sha calc sucess!===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   SECOND_FORMAT:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird begin:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=247 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(50,135,18);">2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa key:,len=247
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(227,0,0);">dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60</span>
   <span style="color:rgb(147,150,0);">ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=248
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799ca75a776e63f22a4b51d3d3890ce32d7effae3e064ae36a6a78605a7a7faa7c01d73e041f296fed4cae41fe3c76337b05ff7779076660c0d46cd362096e1e1160b6c7f6e7c14ad139458cf0c29f69de3f93869eadccaa4dfce7f99c48e5b8cd0359f77df6298d04b685d9bd804dabc44a557b7d144d2095ab38515121b6bd4c021d94f33241defd95157b1f24e3d259d5e9aad7b39ad9f24bc9f7579fe3963f1f9283c300bad79a37a45cbf965b1c0c15ca28591631e88f9b6cb
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   dda_check err,rcdoe:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len0=163
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len1=187
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len2=207
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL5F20NAME.Len=0
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len3=234
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL9F5D.Len=6
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   voiceresult [../res/audio/Please Insert Coin.wav]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   //===================================================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   request card ok
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sem_post(gSem_EVT_CARD_OK)
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhyType = CPU
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhySn:27E93B11
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A404000E325041592E5359532E4444463031
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A4040008A000000333010101
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVLA5FCI.Len=1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   80A80000128310A21A132B00000000000101562800008000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   775B82023000
   <span style="color:rgb(79,0,154);">9408</span>
   <span style="color:rgb(255,70,53);">08010500</span>
   <span style="color:rgb(79,0,154);">10010201</span>9F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_TlvRecDataReading
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2010C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   702C8F01059223
   <span style="color:rgb(147,150,0);">EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA1</span>9F3201039000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2020C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   700B9F48009F4701039F4A01829000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2030C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081FB
   <span style="color:rgb(255,0,0);">9081F8</span>
   <span style="color:rgb(50,135,18);">14606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A518</span>9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2040C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2050C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081FB9F4681F7
   <span style="color:rgb(255,175,0);">2AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC7592</span>9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2011400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   70155A0862280001000011175F24032012319F080200309000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2021400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   70149F690801112233442000009F74064543433131319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   BalanceDisStat:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID Index:5
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   a000000333010101RID
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=248 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(50,135,18);">14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa key:,len=248
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(186,0,255);">97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=62
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6a
   <span style="color:rgb(241,79,154);">026228000112201000010101f701</span>
   <span style="color:rgb(227,0,0);">dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=262:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(241,79,154);">026228000112201000010101f701</span>
   <span style="color:rgb(227,0,0);">dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b</span>
   <span style="color:rgb(28,51,135);">b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60</span>
   <span style="color:rgb(147,150,0);">ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1</span>
   <span style="color:rgb(147,150,0);">e4633c31cb3c4cba1</span>03
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2cfc8216f35ec7fa84eba562db23c0d1fd618b00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2cfc8216f35ec7fa84eba562db23c0d1fd618b00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha cmp over!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========sha calc sucess!===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   SECOND_FORMAT:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird begin:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=247 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(255,175,0);">2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa key:,len=247
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(255,0,0);">dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b</span>
   <span style="color:rgb(28,51,135);">b89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60</span>
   <span style="color:rgb(147,150,0);">ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=62
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   dda_check err,rcdoe:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len0=163
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len1=187
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len2=207
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL5F20NAME.Len=0
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len3=234
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL9F5D.Len=6
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   APP_VoiceDisplay [213]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   volume:5
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   getVoicePlayName [180]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   getVoiceList [156]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   voicelist [9], [Please Insert Coin]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   voiceresult [../res/audio/Please Insert Coin.wav]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   //===========================================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   request card ok
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sem_post(gSem_EVT_CARD_OK)
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhyType = CPU
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhySn:27E93B11
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A404000E325041592E5359532E4444463031
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A4040008A000000333010101
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVLA5FCI.Len=1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   80A80000128310A21A132B00000000000101562800008000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[93]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   775B82023000940808010500100102019F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_TlvRecDataReading
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2010C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[46]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   702C8F01059223EBE2F3231922F41565F16868E846509D61FE3C1E55E8FCD3F21A1E4633C31CB3C4CBA19F3201039000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2020C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[13]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   700B9F48009F4701039F4A01829000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2030C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081FB9081F814606159377C97789C0775C7E8D3DE671292AC8BFBE1131650A4AC7FAE0FBD319CE023488A76A05DEB95EBBCC089D8EBED8476F138F5B403ADB86135931FA2583C03E4FB624E32F8A0D42097DEDFB2E102D77AC9EA0D3735B669BF9485ABEC5AA4757F23813D0E1F5AED3521B2C7005AE7DACA45C0370DA9FBA306723F81E7EC120EB74624EBF1989ECE512BF5D177E4A9D8EA7DBC318AD9C2E4F4FFC40C8F4872A96945EA319C2F0FACDBE6C14FF00D05F31B33ACE14ED918C78C14A0185B1AF116984C6D08973BCFC9DF25534389D3E7BBE93DCD4EEAFC10132E66DB1A649CA7C077B29E41712E6075764103F13B5EA386B54B7384A5189000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2040C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[151]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081949F4B819035D155499387438A3E546CA9691CE9E4652531DFA8D9E9F0AF8FD1273E9107BEE16722E8AE7BAE3E016141902AAAC70CEB61AE9B549F4F31AFFEF76543D2539043A1D89F343C7B58ED6FFB94DB50D7BD604120A7B7E045CAE2BA004C0B1B6D0FA4D6329DCF2DBF62AEBDE97C1C0B7479ACC00EFF3174F514A023F565CA456F24C43286031621ED38934D7FBC2D9DF8D49000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2050C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[254]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081FB9F4681F72AC555B2CFD75B76204C0FD55560EE33682368B84E5A6F5C7F86BDF7802F9EAFBB9E98BB3A371D5C8F198013953E9EBD0DED9120CDF0B34A58B35DBD5AD40E3F99282B37B978347631B8DD789FCA03C4356FFB5789B9F179FB5B648701FB9C5D3A613FA4A81059E54D9D798DACA068C3A3C03703A88AE13E0389B680060C90CFB6C62BD3D4BA9248D64C2C9CA405A58D3ABE6F1B7708FFB914B75AFDB3AE4D81BD4F1718DCF62CF4EE3F70607FAC308F7C65CBBDADF302FFE4F6C6A12459558AB96654C1C704014FCAC47D4F96C52D1647F366DD91A3C1E198676EB296E39C994B738A32561828874420AD38A99106D3944FD61AFC75929000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2011400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   70155A0862280001000011175F24032012319F080200309000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2021400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   70149F690801112233442000009F74064543433131319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   BalanceDisStat:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID Index:5
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   a000000333010101RID
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=248 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   14606159377c97789c0775c7e8d3de671292ac8bfbe1131650a4ac7fae0fbd319ce023488a76a05deb95ebbcc089d8ebed8476f138f5b403adb86135931fa2583c03e4fb624e32f8a0d42097dedfb2e102d77ac9ea0d3735b669bf9485abec5aa4757f23813d0e1f5aed3521b2c7005ae7daca45c0370da9fba306723f81e7ec120eb74624ebf1989ece512bf5d177e4a9d8ea7dbc318ad9c2e4f4ffc40c8f4872a96945ea319c2f0facdbe6c14ff00d05f31b33ace14ed918c78c14a0185b1af116984c6d08973bcfc9df25534389d3e7bbe93dcd4eeafc10132e66db1a649ca7c077b29e41712e6075764103f13b5ea386b54b7384a518rsa key:,len=248
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   97cf8bad30cae0f9a89285454ddde967aafbcd4bc0b78f29ecb1005286f15f6d7532a9c476607c73ff7424316dfc741894aa52edbaf909719c7b53448343b45cf2f00a8abfb78ceebe848933aaed97dbe84f0730f34fb1aa1528d3d6ec75b73252a30d0c717518be36458add0fbf854c65497f3f54084154b60f51561361ee8e85f742a54005524cb00febc334276e0e63dad86c079a9a3df5dd32becade1ab2b71f5f0a0e95a4000d01f1044a578aad92e9fde92e3c6aa3dcd4913dfa5552537e7de75e241faed455d76cb8fcafeed3fd6dab24d7a9c32852f866c751d7710f494a0df11b67faecdd87a9a4e2cc44f6f27e46e3c0cccd0f
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=62
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6a026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9b
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=262:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   026228000112201000010101f701dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba103
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2cfc8216f35ec7fa84eba562db23c0d1fd618b00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2cfc8216f35ec7fa84eba562db23c0d1fd618b00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha cmp over!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========sha calc sucess!===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:247
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   SECOND_FORMAT:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird begin:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=247 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2ac555b2cfd75b76204c0fd55560ee33682368b84e5a6f5c7f86bdf7802f9eafbb9e98bb3a371d5c8f198013953e9ebd0ded9120cdf0b34a58b35dbd5ad40e3f99282b37b978347631b8dd789fca03c4356ffb5789b9f179fb5b648701fb9c5d3a613fa4a81059e54d9d798daca068c3a3c03703a88ae13e0389b680060c90cfb6c62bd3d4ba9248d64c2c9ca405a58d3abe6f1b7708ffb914b75afdb3ae4d81bd4f1718dcf62cf4ee3f70607fac308f7c65cbbdadf302ffe4f6c6a12459558ab96654c1c704014fcac47d4f96c52d1647f366dd91a3c1e198676eb296e39c994b738a32561828874420ad38a99106d3944fd61afc7592rsa key:,len=247
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   dbb54494e09e5d8af4c6efb129147c2618ccaf5f52e1fc88d16d0409ed05ae6fb0542823712e6765ac555eebd0dc9bb89369f4b8c454e185a109c7a0153ddaf006f53a1848acd7d152cbe3cf32a7588b81d3c1ddfbc8b384d060d95024ae74bb18243bfc36efd21708011b945798493b1e9ffe868f6a0094411a190fe52f31786bbd1c94daf05183e7552555d57246d23c1baf830f0a888c0b227e892406495a284e8d79e3f836b0fdcab48bf7388a9f63008e5b2004b3ba9a72ea6f9c6a2e1b693a6d4e297eb31e844f641253e57d47e3933f60ebe2f3231922f41565f16868e846509d61fe3c1e55e8fcd3f21a1e4633c31cb3c4cba1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=62
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   000043001881d94060a1749969a2464c729c90ba4edf51ca820d8f8556d37c294d8df8bc58b00a359f10b3c9e1c0480946e402697e0d49921af714335799
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   dda_check err,rcdoe:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len0=163
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len1=187
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len2=207
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL5F20NAME.Len=0
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len3=234
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL9F5D.Len=6
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   APP_VoiceDisplay [213]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   volume:5
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   getVoicePlayName [180]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   getVoiceList [156]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   voicelist [9], [Please Insert Coin]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   voiceresult [../res/audio/Please Insert Coin.wav]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(229,0,255);">046228000100001117ffff122010001001019001</span>8444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
   <span style="color:rgb(106,0,129);">93e8435c6a3bb1097bc435c2eef7bc7f9378fc7e</span>bc
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(229,0,255);">046228000100001117ffff12201000100101</span>
   <span style="color:rgb(229,0,255);"><span style="font-weight:700;">90</span></span>
   <span style="color:rgb(229,0,255);">01</span>
   <span style="color:rgb(173,0,0);">8444174c3dcc2a7eb21c1ed0e92019dd0620e3dcc6861a40f1fc9c9110e65f367195d2ad7f8ab4ae8534874d5e82015ba1c39a0bb8d047b0b8a231bbcbdb98910da48011b7f0bf210493812bbd67552c2edac38c56b4b6b01f932958c0bde57c78ff0b58406e9307347f02adabbe7b519f0de5844184ae4f306b3efff184a9e7c7fe392b1de96c070dfcf909bb3795f1</span>bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&nbsp;
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(106,0,129);">93e8435c6a3bb1097bc435c2eef7bc7f9378fc7e</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <p style="background-color:rgb(255,255,255);">......</p>
  <p style="background-color:rgb(255,255,255);">//=========================================================================</p>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sak=20
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   request card ok
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sem_post(gSem_EVT_CARD_OK)
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhyType = CPU
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardPhySn:27E93B11
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A404000E325041592E5359532E4444463031
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[52]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F32840E325041592E5359532E4444463031A520BF0C1D611B4F08A000000333010101500C50424F4320544553542030318701019000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00A4040008A000000333010101
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[72]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6F468408A000000333010101A53A500C50424F4320544553542030318701019F380C9F37049F02065F2A029F66045F2D047A68656E9F1101019F120C50726566204E616D652030319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVLA5FCI.Len=1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   80A800001283106E1F3B1B00000000000101562800008000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[234]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7781E7820230009410080102001001010058010101100202009F3602000357136228000100001117D20121200012339900031F9F101307010103900000010A010000020000AABBCCDD9F2608AABBCCDDEEFF11225F3401019F6C0220009F5D060000000100009F4B818047827D3AD7C4D69A013B729B1A63C4C1B4F1CBBACB1028B05C3B7C11618F18F1FFE91B2E91D17561D16BE3CA04E495007D45D1229F75704AA207183CF94A007FBA0FB0DFFCA5E558A98164979A401885CFA0A6588902B3BE68F0F38B4BA8953A45A3CDE6A9A049450F4E71DA552F8F54E102256857397C60817A5E7A7016EFF19000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_TlvRecDataReading
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2010C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[179]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081B08F0161908180
   <span style="color:rgb(50,135,18);">253C3C1FD9928D882111A6AC4CA207DF9310642395EA097B3CB16D517653353803C2C1033E4AACB9735D2E69CA498FEB4CC0AEE1FFC7F54483093A30CCBF6B2011D609E52FD78776B66B6D8695CBC046216BF81C52D5C2F947DEE3ADD7209AB327F29C106BFA0E291D9DAB009106F489BA59436DA94675DF9D31DCAFBD6ABE20</span>9224
   <span style="color:rgb(255,0,0);">5C2BFD27CD7F49B1170FC793EF7E11A94FC3C77261CBC39B3679DD7994CC36852E9A1901</span>9F3201039000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2020C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[188]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7081B99F468180
   <span style="color:rgb(107,231,72);">1AC8004382DC40EDC9E761872C7C9B0F1CC0C27B578CC733F927B75A59A67A6FFA590631F723ED648A29488EBD8F598AEA99F12F2ECC120C7649F8C0962D749F5903877C6FB076AA717B4BDD83941D5B3C02AA3E164D441C0A92E8C0DAB60B92432709A2AD83ADC8D0DF2F36B9C92597A2071FFE705E6D4FF5F8B3E9402E4521</span>9F482A
   <span style="color:rgb(227,0,0);">AA1E6C89EFDA053B78C7D7E665F2FD04835D01166C52092294F2A050DE5E4F24A54E59111678EBB2C6B9</span>9F4701039F4A01829000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);"></div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2011400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[23]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   7015
   <span style="font-weight:bold;">5A0862280001000011175F24032012319F08020030</span>9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2015C00
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[6]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="font-weight:700;">70049E021122</span>9000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   00B2021400
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;SWA[90]SWB[00] LEN[22]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   70149F690801112233442000009F74064543433131319000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   BalanceDisStat:1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID Index:97
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   RID:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   a000000333010101RID
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=128 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(50,135,18);">253c3c1fd9928d882111a6ac4ca207df9310642395ea097b3cb16d517653353803c2c1033e4aacb9735d2e69ca498feb4cc0aee1ffc7f54483093a30ccbf6b2011d609e52fd78776b66b6d8695cbc046216bf81c52d5c2f947dee3add7209ab327f29c106bfa0e291d9dab009106f489ba59436da94675df9d31dcafbd6abe20</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa key:,len=128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   834d2a387c5a5f176ef3e66caaf83f194b15aad2470c78c77d6eb38edae3a2f9ba1623f6a58c892cc925632dff48ce954b21a53e1f1e4366be403c279b90027cbc72605db6c79049b8992cb4912efa270becab3a7cefe05bfa46e4c7bbcf7c7a173bd988d989b32cb79fac8e35fbe1860e7ea9f238a92a3593552d03d1e38601
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6a0262280001122010000101018001
   <span style="font-weight:bold;">e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1</span>
   <span style="color:rgb(106,0,129);">5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a</span>bc
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_First ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=143:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   0262280001122010000101018001
   <span style="font-weight:bold;">e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1</span>
   <span style="color:rgb(227,0,0);">5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a1901</span>03
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(65,0,125);">5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   5004b3801bc472fa1ac0cb3c78fbdfa0c9b7882a
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha cmp over!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========sha calc sucess!===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   CardTLVSet-&gt;TVL9F46ICPUBKEYA.Len:128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   SECOND_FORMAT:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird begin:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=128 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(107,231,72);">1ac8004382dc40edc9e761872c7c9b0f1cc0c27b578cc733f927b75a59a67a6ffa590631f723ed648a29488ebd8f598aea99f12f2ecc120c7649f8c0962d749f5903877c6fb076aa717b4bdd83941d5b3c02aa3e164d441c0a92e8c0dab60b92432709a2ad83adc8d0df2f36b9c92597a2071ffe705e6d4ff5f8b3e9402e4521</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa key:,len=128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="font-weight:bold;">e8250271e81cc7bb3a47e7adfb73b777cd87167a7a48ec794e5a6fd8d268726071a2320b63478cc14a013c01c3620d2edd82adb42a310114922c1bb9e141a7b3c77f59deeee7ba3d51d9b6dd8adaa9d29c2473c28094b80a14ea37a1</span>
   <span style="color:rgb(255,0,0);">5c2bfd27cd7f49b1170fc793ef7e11a94fc3c77261cbc39b3679dd7994cc36852e9a1901</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6a
   <span style="color:rgb(241,79,154);">046228000100001117ffff122010001001018001</span>
   <span style="color:rgb(173,0,0);"><span style="font-weight:700;">870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d</span></span>
   <span style="color:rgb(45,79,201);">fd79106dc5c2d4137310021bc62b55ee8224da29</span>
   <span style="color:rgb(45,79,201);">bc</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=159:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(241,79,154);">046228000100001117ffff122010001001018001</span>
   <span style="color:rgb(173,0,0);"><span style="font-weight:700;">870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d</span></span>
   <span style="color:rgb(227,0,0);">aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b9</span>0370049e02112290003000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(45,79,201);">fd79106dc5c2d4137310021bc62b55ee8224da29</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   650cdf44c418effe33b859a4ee7547a18574836e
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha cmp over!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(255,0,0);">sha cmp not equal!</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ===========sha clac failed!===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   THIRD_FORMAT:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird begin:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   1.============rsa in data:,len=128 =======================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   47827d3ad7c4d69a013b729b1a63c4c1b4f1cbbacb1028b05c3b7c11618f18f1ffe91b2e91d17561d16be3ca04e495007d45d1229f75704aa207183cf94a007fba0fb0dffca5e558a98164979a401885cfa0a6588902b3be68f0f38b4ba8953a45a3cde6a9a049450f4e71da552f8f54e102256857397c60817a5e7a7016eff1
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa key:,len=128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <span style="color:rgb(173,0,0);"><span style="font-weight:700;">870e82ebd153604a5eb9e4ae542d3b1760d4f97e23cc89b6317d040e1ba576d227bec49e95d6600bb8ccabe9666fe2d3a2ef01ca98f30b53d0a482f7d328521a1d1d95355f2279fcb9b2735dce5e2a0a7e8356a10e7d</span></span>
   <span style="color:rgb(227,0,0);">aa1e6c89efda053b78c7d7e665f2fd04835d01166c52092294f2a050de5e4f24a54e59111678ebb2c6b9</span>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa calc,E is3
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin rsa calc...
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   rsa out data:,len=128
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   6a05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf82c5a1b3cebfce4512afd77a27ab41b25fb850dbc
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   2.=================rsa proc end =========================
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   UP_RSA_SecondOrThird ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   begin dda_check:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========begin sha calc:===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha in data,len=126:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   05010706112233445566bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb6e1f3b1b00000000000101560111223344200000
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha check data is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   f82c5a1b3cebfce4512afd77a27ab41b25fb850d
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha sum is:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   f82c5a1b3cebfce4512afd77a27ab41b25fb850d
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   sha cmp over!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   <br>
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   ==========sha calc sucess!===============
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len0=163
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len1=187
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len2=207
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL5F20NAME.Len=0
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   len3=234
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   TVL9F5D.Len=6
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   save OthCfg:
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   save OthCfg ok!
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   APP_VoiceDisplay [213]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   volume:5
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   getVoicePlayName [180]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   voiceresult [../res/audio/.wav]
  </div>
  <div style="color:rgb(51,51,51);font-size:14px;background-color:rgb(255,255,255);">
   open file failed:
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yyz_1987/article/details/80390565,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yyz_1987/article/details/80390565,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
