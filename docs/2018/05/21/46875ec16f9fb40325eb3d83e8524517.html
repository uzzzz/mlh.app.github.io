<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>以太坊源码分析(9)CMD实际操作分析 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="以太坊源码分析(9)CMD实际操作分析" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="### cmd包分析 #### cmd下面总共有13个子包，除了util包之外，每个子包都有一个主函数,每个主函数的init方法中都定义了该主函数支持的命令，如 ##### geth包下面的： ``` func init() { &nbsp;&nbsp;&nbsp;&nbsp;// Initialize the CLI app and start Geth &nbsp;&nbsp;&nbsp;&nbsp;app.Action = geth &nbsp;&nbsp;&nbsp;&nbsp;app.HideVersion = true // we have a command to print the version &nbsp;&nbsp;&nbsp;&nbsp;app.Copyright = &quot;Copyright 2013-2017 The go-ethereum Authors&quot; &nbsp;&nbsp;&nbsp;&nbsp;app.Commands = []cli.Command{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See chaincmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exportCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copydbCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removedbCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See monitorcmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;monitorCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See accountcmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;walletCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See consolecmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consoleCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attachCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javascriptCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See misccmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makecacheCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makedagCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bugCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;licenseCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See config.go &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpConfigCommand, &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;sort.Sort(cli.CommandsByName(app.Commands)) } ``` ###### 再单独分析initCommand: ``` initCommand = cli.Command{ Action: utils.MigrateFlags(initGenesis), Name: &quot;init&quot;, Usage: &quot;Bootstrap and initialize a new genesis block&quot;, ArgsUsage: &quot;&lt;genesisPath&gt;&quot;, Flags: []cli.Flag{ utils.DataDirFlag, utils.LightModeFlag, }, Category: &quot;BLOCKCHAIN COMMANDS&quot;, Description: ` The init command initializes a new genesis block and definition for the network. This is a destructive action and changes the network in which you will be participating. ``` ###### 其中Name是对应命令的指令，action是调用该指令去完成的动作，usage表示用途,arguUsage显示该命令后面跟的参数个数以及每个参数的意义, ###### 该init方法其实就是去初始化创世块,flags代表的是这个子命令额外可以执行的命令,如改init命令可以携带两个参数，点进去utils.DataDirFlag可以看到： ``` // General settings DataDirFlag = DirectoryFlag{ Name: &quot;datadir&quot;, Usage: &quot;Data directory for the databases and keystore&quot;, Value: DirectoryString{node.DefaultDataDir()}, } ``` * __可以用 --datadir [dir]来指定数据库的路径，如果没有指定由于该参数有value所以会启用默认的路径，也是home目录下面的.ethereum.__ * __/cmd/wnode/main.go　通过连接其他节点启动__ * __/cmd/geth /cmd/swarm　都是定义了很多命令__ ### eth下cmd的rlpdump子包,该包的主要作用从给定文件中转储RLP数据以可读的形式．如果文件名被省略，数据将从stdin中读取 　 /rlpdump ##### 解码rlp的数据 ###### rlpdump的command的help ``` Usage: /tmp/___cmd_rlpdump_test [-noascii] [-hex &lt;data&gt;] [filename] -hex string &nbsp;&nbsp;dump given hex data -noascii &nbsp;&nbsp;don&#39;t print ASCII strings readably -single &nbsp;&nbsp;print only the first element, discard the rest Dumps RLP data from the given file in readable form. If the filename is omitted, data is read from stdin. ``` ###### example1: ``` demo command: --hex f872f870845609a1ba64c0b8660480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee8580 success_result_demo: [ [ 5609a1ba, &quot;d&quot;, [], 0480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee85, &quot;&quot;, ], ] ``` ###### example2: ``` demo command: --noascii --hex CE0183FFFFFFC4C304050583616263 success_result_demo: [ 01, ffffff, [ [ 04, 05, 05, ], ], 616263, ] ``` ### cmd包下的p2psim子包的分析, p2psim is a command line client for the HTTP API ##### 首先我们启动对应的main函数,对应的启动参数是 `--help` ,来查看该包下所有命令的使用,结果如下: ``` NAME: ___go_build_main_go__1_ - devp2p simulation command-line client USAGE: ___go_build_main_go__1_ [global options] command [command options] [arguments...] VERSION: 0.0.0 COMMANDS: show show network information events stream network events snapshot create a network snapshot to stdout load load a network snapshot from stdin node manage simulation nodes help, h Shows a list of commands or help for one command GLOBAL OPTIONS: --api value simulation API URL (default: &quot;http://localhost:8888&quot;) [$P2PSIM_API_URL] --help, -h show help --version, -v print the version ``` ##### 该子包提供如何下的命令: ``` p2psim show p2psim events [--current] [--filter=FILTER] p2psim snapshot p2psim load p2psim node create [--name=NAME] [--services=SERVICES] [--key=KEY] p2psim node list p2psim node show &lt;node&gt; p2psim node start &lt;node&gt; p2psim node stop &lt;node&gt; p2psim node connect &lt;node&gt; &lt;peer&gt; p2psim node disconnect &lt;node&gt; &lt;peer&gt; p2psim node rpc &lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe] ``` ##### 要正常使用该子包下的命令，我们需要运行 `/p2p/simulations/examples/ping-pong.go` 的主函数来启动一个包含运行简单的节点的仿真网络. 正常启动后,你将看到: ``` INFO [01-23|11:17:10] using sim adapter INFO [01-23|11:17:10] starting simulation server on 0.0.0.0:8888... ``` ##### 该服务启动后,提供如下的API,其作用等同于上面的命令,命令调用的实现其实就是调用API,访问的路径前缀就是 `0.0.0.0:8888` : ``` GET / Get network information POST /start Start all nodes in the network POST /stop Stop all nodes in the network GET /events Stream network events GET /snapshot Take a network snapshot POST /snapshot Load a network snapshot POST /nodes Create a node GET /nodes Get all nodes in the network GET /nodes/:nodeid Get node information POST /nodes/:nodeid/start Start a node POST /nodes/:nodeid/stop Stop a node POST /nodes/:nodeid/conn/:peerid Connect two nodes DELETE /nodes/:nodeid/conn/:peerid Disconnect two nodes GET /nodes/:nodeid/rpc Make RPC requests to a node via WebSocket ``` ##### 此处不深究API,仿真网络的服务已经起来了,下面开始p2psim包下命令的使用: __/p2psim__ * show ``` function:显示当前仿真网络的状态 args:&quot;&quot; demo: show notice: success_result_demo: NODES 0 CONNS 0 ``` * snapshot ``` function:导出当前仿真网络的节点信息 args:&quot;&quot; demo: shapshot notice: success_result_demo: {&quot;nodes&quot;:[{&quot;node&quot;:{&quot;config&quot;:{&quot;id&quot;:&quot;085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d&quot;,&quot;private_key&quot;:&quot;3480d230f453e7c207bbd3b770bf774dc8a17e599394f9283147a35c3ead561c&quot;,&quot;name&quot;:&quot;node1&quot;,&quot;services&quot;:[&quot;ping-pong&quot;]},&quot;up&quot;:true}},{&quot;node&quot;:{&quot;config&quot;:{&quot;id&quot;:&quot;cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b&quot;,&quot;private_key&quot;:&quot;b7592cdeee6195c4486fcdd8007e1aedfd3a49e6c9f53e0845bf977d4ad043cc&quot;,&quot;name&quot;:&quot;node2&quot;,&quot;services&quot;:[&quot;ping-pong&quot;]},&quot;up&quot;:false}}],&quot;conns&quot;:[{&quot;one&quot;:&quot;cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b&quot;,&quot;other&quot;:&quot;085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d&quot;,&quot;up&quot;:false}]} ``` * node &gt; * create ``` function:创建一个节点 args:[--name=NAME] [--services=SERVICES] [--key=KEY] demo: node create --name node1 notice: success_result_demo: Created node1 ``` &gt; * list ``` function:列出当前仿真网络的节点信息 args:&quot;&quot; demo: node list notice: success_result_demo: NAME PROTOCOLS ID node1 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d node2 cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b ``` &gt; * show ``` function:查看仿真网络中某个节点的具体信息 args:&lt;node&gt; demo: node show node1 notice: success_result_demo: NAME node1 PROTOCOLS ID 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d ENODE enode://085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d@127.0.0.1:30303 ``` &gt; * start ``` function:启动一个节点 args:&lt;node&gt; demo: node start node1 notice: success_result_demo: Started node1 ``` &gt; * connect ``` function:将一个节点连接到另外一个节点 args:&lt;node&gt; &lt;peer&gt; demo: node connect node2 node1 notice: success_result_demo: Connected node2 to node1 ``` &gt; * disconnect ``` function:节点断开连接 args:&lt;node&gt; &lt;peer&gt; demo: node disconnect node2 node1 notice: success_result_demo: Disconnected node2 from node1 ``` &gt; * stop ``` function:停止一个节点 args:&lt;node&gt; demo: node stop node2 notice: success_result_demo: Stopped node2 ``` &gt; * rpc ``` function:调用rpc接口 args:&lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe] demo: node rpc node1 admin notice: success_result_demo: 　// TODO ``` ### cmd包下的geth子包主函数启动的各个子命令解析 #### /geth * __init__ ``` function:导入创世块的json,以指定的json作为创世块 args:&lt;genesisPath&gt; demo: init /home/yujian/eth-go/genesis.json notice:ethereum默认创建路径为home目录的.ethereum,如果该目录下已经写入过创世快，会执行失败 success_result_demo: WARN [01-16|10:25:12] No etherbase set and no accounts found as default INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=16 handles=16 INFO [01-16|10:25:12] Writing custom genesis block INFO [01-16|10:25:12] Successfully wrote genesis state database=chaindata hash=bf2891…ad1419 INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/lightchaindata cache=16 handles=16 INFO [01-16|10:25:12] Writing custom genesis block INFO [01-16|10:25:12] Successfully wrote genesis state database=lightchaindata hash=bf2891…ad1419 ``` * __import__ ``` function:导入区块数据到当前运行的链中 args:&lt;filename&gt; (&lt;filename 2&gt; ... &lt;filename N&gt;) demo: import /home/yujian/eth-block.txt notice:如果导入的文件只要一个是错误的，那么会失败，如果有多个文件错误，那么程序会继续执行忽略错误的． success_result_demo: WARN [01-16|11:00:32] No etherbase set and no accounts found as default INFO [01-16|11:00:32] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 Import done in 306.866µs. INFO [01-16|11:00:32] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 Compactions INFO [01-16|11:00:32] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB) -------+------------+---------------+---------------+---------------+--------------- INFO [01-16|11:00:32] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 0 | 3 | 0.00094 | 0.00000 | 0.00000 | 0.00000 INFO [01-16|11:00:32] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 Trie cache misses: 0 INFO [01-16|11:00:32] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 Trie cache unloads: 0 INFO [01-16|11:00:32] Importing blockchain file=/home/yujian/eth-block.txt Object memory: 34.677 MB current, 34.670 MB peak System memory: 74.100 MB current, 73.850 MB peak Allocations: 0.015 million GC pause: 10.454997ms Compacting entire database... INFO [01-16|11:00:33] Database closed database=/home/yujian/.ethereum/geth/chaindata Compaction done in 64.422235ms. Compactions Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB) -------+------------+---------------+---------------+---------------+--------------- 0 | 0 | 0.00000 | 0.00451 | 0.00000 | 0.00021 1 | 1 | 0.00053 | 0.00435 | 0.00114 | 0.00053 ``` * __export__ ``` function:导出区块数据到指定的文件 args:&lt;filename&gt; [&lt;blockNumFirst&gt; &lt;blockNumLast&gt;] demo: export /home/yujian/eth-block.txt notice: success_result_demo: WARN [01-16|10:51:36] No etherbase set and no accounts found as default INFO [01-16|10:51:36] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|10:51:36] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|10:51:36] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 Export done in 628.951µsINFO [01-16|10:51:36] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Exporting blockchain file=/home/yujian/eth-block.txt INFO [01-16|10:51:36] Exporting batch of blocks count=1 INFO [01-16|10:51:36] Exported blockchain file=/home/yujian/eth-block.txt ``` * __copydb__ ``` function:从存在的链数据文件夹中创建一条本地链 args:&lt;sourceChaindataDir&gt; demo: copydb /home/yujian/eth-block.txt notice: success_result_demo: WARN [01-16|11:35:55] No etherbase set and no accounts found as default INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|11:35:55] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|11:35:55] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 INFO [01-16|11:35:55] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/eth-go/geth/chaindata cache=128 handles=256 INFO [01-16|11:35:55] Block synchronisation started INFO [01-16|11:35:55] Imported new state entries count=1 elapsed=33.277µs processed=1 pending=0 retry=0 duplicate=0 unexpected=0 INFO [01-16|11:35:56] Imported new block headers count=11 elapsed=1.276s number=11 hash=ec3374…59a2ba ignored=0 Database copy done in 1.280940454s Compacting entire database... INFO [01-16|11:35:56] Imported new chain segment blocks=11 txs=0 mgas=0.000 elapsed=1.961ms mgasps=0.000 number=11 hash=ec3374…59a2ba Compaction done in 11.130389ms. ``` * __removedb__ ``` function:移除当前链的数据库 args:&quot;&quot; demo: removedb notice:默认当前链的数据在home目录下的.ethereum目录下 success_result_demo: WARN [01-16|11:48:09] No etherbase set and no accounts found as default /home/yujian/.ethereum/geth/chaindata Remove this database? [y/N] y /home/yujian/.ethereum/geth/lightchaindata INFO [01-16|11:48:19] Database successfully deleted database=chaindata elapsed=7.832ms Remove this database? [y/N] y INFO [01-16|11:48:27] Database successfully deleted database=lightchaindata elapsed=481.229µs ``` * __dump__ ``` function:转存指定的块 args:[&lt;blockHash&gt; | &lt;blockNum&gt;]... demo: dump 0 notice: success_result_demo: &quot;storage&quot;: {} }, &quot;af3cb5965933e7dad883693b9c3e15beb68a4873&quot;: { &quot;balance&quot;: &quot;2000000000000000000000&quot;, &quot;nonce&quot;: 0, &quot;root&quot;: &quot;56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, &quot;codeHash&quot;: &quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;, &quot;code&quot;: &quot;&quot;, &quot;storage&quot;: {} }, &quot;af4493e8521ca89d95f5267c1ab63f9f45411e1b&quot;: { &quot;balance&quot;: &quot;200000000000000000000&quot;, &quot;nonce&quot;: 0, &quot;root&quot;: &quot;56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, &quot;codeHash&quot;: &quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;, &quot;code&quot;: &quot;&quot;, &quot;storage&quot;: {} }, } } INFO [01-16|14:02:06] Database closed database=/home/yujian/.ethereum/geth/chaindata ``` * __monitor__ ``` function:监视和可视化节点指标 args:&quot;&quot; demo: monitor notice:该命令本地未调通,需要先启链，才能调用该命令去看监控的状态 success_result_demo: // TODO ``` * __account__ ``` function:管理账户 args:&quot;[new|list|update|import]&quot; demo: account new notice:“帐户导入”选项只能用于导入通用密钥文件 success_result_demo: WARN [01-16|14:44:44] No etherbase set and no accounts found as default Your new account is locked with a password. Please give a password. Do not forget this password. !! Unsupported terminal, password will be echoed. Passphrase: 123456 Repeat passphrase: 123456 Address: {2a23e9223d7af9c56f5abd0c8226021b51c98cbc} Process finished with exit code 0 ``` * __wallet__ ``` function:导入预付款钱包(一般用不到，用的是account功能) args:&quot;&quot; demo: wallet import notice:&quot;钱包导入&quot;选项只能用于导入预售钱包 success_result_demo: ``` 　　 * __console__ ``` function:开启一条私有链,并打开一个可视化的js钱包控制台 args:&quot;&quot; demo: console notice: success_result_demo: INFO [01-16|15:26:13] Starting peer-to-peer node instance=Geth/v1.7.3-unstable/linux-amd64/go1.9.2 INFO [01-16|15:26:13] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|15:26:14] Initialised chain configuration config=&quot;{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Engine: ethash}&quot; INFO [01-16|15:26:14] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|15:26:14] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 INFO [01-16|15:26:14] Initialising Ethereum protocol versions=&quot;[63 62]&quot; network=1 INFO [01-16|15:26:14] Loaded most recent local header number=1127484 hash=ae7ee2…52ae4c td=8985161313979839462 INFO [01-16|15:26:14] Loaded most recent local full block number=0 hash=d4e567…cb8fa3 td=17179869184 INFO [01-16|15:26:14] Loaded most recent local fast block number=1092806 hash=6e839a…2eb127 td=8395031237882431385 INFO [01-16|15:26:14] Upgrading chain index type=bloombits percentage=80 INFO [01-16|15:26:14] Loaded local transaction journal transactions=0 dropped=0 INFO [01-16|15:26:14] Regenerated local transaction journal transactions=0 accounts=0 INFO [01-16|15:26:14] Starting P2P networking INFO [01-16|15:26:16] UDP listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303 INFO [01-16|15:26:16] RLPx listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303 INFO [01-16|15:26:16] IPC endpoint opened: /home/yujian/.ethereum/geth.ipc Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2 coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc at block: 0 (Thu, 01 Jan 1970 08:00:00 CST) datadir: /home/yujian/.ethereum modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 ``` * __attach__ ``` function:打开一个可视化的js钱包控制台(连接到一个指定的链) args: --jspath loadScript JavaScript root path for loadScript (default: &quot;.&quot;) --exec value Execute JavaScript statement --preload value Comma separated list of JavaScript files to preload into the console --datadir &quot;/root/.ethereum&quot; Data directory for the databases and keystore demo:attach --datadir=&quot;/home/yujian/.ethereum/geth.ipc&quot; notice:必须启动一条本地链，这样才能连接过去 success_result_demo: Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2 coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc at block: 0 (Thu, 01 Jan 1970 08:00:00 CST) datadir: /home/yujian/.ethereum modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 ``` * __js__ ``` 　function:执行指定的js文件 args:&lt;jsfile&gt; [jsfile...] demo:js notice: success_result_demo: ``` * __makecache__ ``` function:生成ethhash验证缓存(测试使用) args:&lt;blockNum&gt; &lt;outputDir&gt; demo:makecache 0 /home/yujian/ notice: success_result_demo: 在对应的输出目录，将会生成一个cache文件,如 cache-R23-0000000000000000 ``` * __makedag__ ``` function:生成ethhash mining dag(测试使用) args:&lt;blockNum&gt; &lt;outputDir&gt; demo:makedag 0 /home/yujian/ notice: success_result_demo: INFO [01-16|17:50:36] Generating DAG in progress epoch=0 percentage=92 elapsed=3m2.525s INFO [01-16|17:50:38] Generating DAG in progress epoch=0 percentage=93 elapsed=3m4.338s INFO [01-16|17:50:40] Generating DAG in progress epoch=0 percentage=94 elapsed=3m6.058s INFO [01-16|17:50:41] Generating DAG in progress epoch=0 percentage=95 elapsed=3m7.795s INFO [01-16|17:50:43] Generating DAG in progress epoch=0 percentage=96 elapsed=3m9.542s INFO [01-16|17:50:45] Generating DAG in progress epoch=0 percentage=97 elapsed=3m11.380s INFO [01-16|17:50:47] Generating DAG in progress epoch=0 percentage=98 elapsed=3m13.129s INFO [01-16|17:50:49] Generating DAG in progress epoch=0 percentage=99 elapsed=3m15.303s INFO [01-16|17:50:49] Generated ethash verification cache epoch=0 elapsed=3m15.306s Process finished with exit code 0 在对应的输出目录,将会生成一个full文件,如 full-R23-0000000000000000 ``` * __version__ ``` function:打印版本数据 args:&quot;&quot; demo:version notice: success_result_demo: Geth Version: 1.7.3-unstable Architecture: amd64 Protocol Versions: [63 62] Network Id: 1 Go Version: go1.9.2 Operating System: linux GOPATH=/home/yujian/blockchain-workspace/go-project GOROOT=/usr/local/go 　　 ``` * __bug__ ``` function:打开一个窗口,直接跳转到ethereum的github仓库的issue args:&quot;&quot; demo:bug notice: success_result_demo: 　　运行后会自动打开浏览器，跳转到ethereum的issue编辑页面　 ``` * __license__ ``` function:显示geth的license信息 args:&quot;&quot; demo:license notice: success_result_demo: Geth is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. Geth is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with geth. If not, see &lt;http://www.gnu.org/licenses/&gt;. ``` * __dumpconfig__ ``` function:显示配置信息 args:&quot;&quot; demo:dumpconfig notice: success_result_demo: 　[Eth] NetworkId = 1 SyncMode = &quot;fast&quot; LightPeers = 20 DatabaseCache = 128 Etherbase = &quot;0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc&quot; GasPrice = 18000000000 EthashCacheDir = &quot;ethash&quot; EthashCachesInMem = 2 EthashCachesOnDisk = 3 EthashDatasetDir = &quot;/home/yujian/.ethash&quot; EthashDatasetsInMem = 1 EthashDatasetsOnDisk = 2 EnablePreimageRecording = false [Eth.TxPool] NoLocals = false Journal = &quot;transactions.rlp&quot; Rejournal = 3600000000000 PriceLimit = 1 PriceBump = 10 AccountSlots = 16 GlobalSlots = 4096 AccountQueue = 64 GlobalQueue = 1024 Lifetime = 10800000000000 [Eth.GPO] Blocks = 10 Percentile = 50 [Shh] MaxMessageSize = 1048576 MinimumAcceptedPOW = 2e-01 [Node] DataDir = &quot;/home/yujian/.ethereum&quot; IPCPath = &quot;geth.ipc&quot; HTTPPort = 8545 HTTPModules = [&quot;net&quot;, &quot;web3&quot;, &quot;eth&quot;, &quot;shh&quot;] WSPort = 8546 WSModules = [&quot;net&quot;, &quot;web3&quot;, &quot;eth&quot;, &quot;shh&quot;] [Node.P2P] MaxPeers = 25 NoDiscovery = false DiscoveryV5Addr = &quot;:30304&quot; BootstrapNodes = [&quot;enode://a979fb575495b8d6db44f750317d0f4622bf4c2aa3365d6af7c284339968eef29b69ad0dce72a4d8db5ebb4968de0e3bec910127f134779fbcb0cb6d3331163c@52.16.188.185:30303&quot;, &quot;enode://3f1d12044546b76342d59d4a05532c14b85aa669704bfe1f864fe079415aa2c02d743e03218e57a33fb94523adb54032871a6c51b2cc5514cb7c7e35b3ed0a99@13.93.211.84:30303&quot;, &quot;enode://78de8a0916848093c73790ead81d1928bec737d565119932b98c6b100d944b7a95e94f847f689fc723399d2e31129d182f7ef3863f2b4c820abbf3ab2722344d@191.235.84.50:30303&quot;, &quot;enode://158f8aab45f6d19c6cbf4a089c2670541a8da11978a2f90dbf6a502a4a3bab80d288afdbeb7ec0ef6d92de563767f3b1ea9e8e334ca711e9f8e2df5a0385e8e6@13.75.154.138:30303&quot;, &quot;enode://1118980bf48b0a3640bdba04e0fe78b1add18e1cd99bf22d53daac1fd9972ad650df52176e7c7d89d1114cfef2bc23a2959aa54998a46afcf7d91809f0855082@52.74.57.123:30303&quot;, &quot;enode://979b7fa28feeb35a4741660a16076f1943202cb72b6af70d327f053e248bab9ba81760f39d0701ef1d8f89cc1fbd2cacba0710a12cd5314d5e0c9021aa3637f9@5.1.83.226:30303&quot;] BootstrapNodesV5 = [&quot;enode://0cc5f5ffb5d9098c8b8c62325f3797f56509bff942704687b6530992ac706e2cb946b90a34f1f19548cd3c7baccbcaea354531e5983c7d1bc0dee16ce4b6440b@40.118.3.223:30305&quot;, &quot;enode://1c7a64d76c0334b0418c004af2f67c50e36a3be60b5e4790bdac0439d21603469a85fad36f2473c9a80eb043ae60936df905fa28f1ff614c3e5dc34f15dcd2dc@40.118.3.223:30308&quot;, &quot;enode://85c85d7143ae8bb96924f2b54f1b3e70d8c4d367af305325d30a61385a432f247d2c75c45c6b4a60335060d072d7f5b35dd1d4c45f76941f62a4f83b6e75daaf@40.118.3.223:30309&quot;] StaticNodes = [] TrustedNodes = [] ListenAddr = &quot;:30303&quot; EnableMsgEvents = false [Dashboard] Host = &quot;localhost&quot; Port = 8080 Refresh = 3000000000　 ``` ##### 参考资料 * [ eth钱包创建]( https://www.myetherwallet.com/#generate-wallet) * [ eth命令使用解释]( http://www.blockcode.org/archives/185) 网址：http://www.qukuailianxueyuan.io/ 欲领取造币技术与全套虚拟机资料 区块链技术交流QQ群：756146052&nbsp;&nbsp;备注：CSDN 尹成学院微信：备注：CSDN 阅读更多" />
<meta property="og:description" content="### cmd包分析 #### cmd下面总共有13个子包，除了util包之外，每个子包都有一个主函数,每个主函数的init方法中都定义了该主函数支持的命令，如 ##### geth包下面的： ``` func init() { &nbsp;&nbsp;&nbsp;&nbsp;// Initialize the CLI app and start Geth &nbsp;&nbsp;&nbsp;&nbsp;app.Action = geth &nbsp;&nbsp;&nbsp;&nbsp;app.HideVersion = true // we have a command to print the version &nbsp;&nbsp;&nbsp;&nbsp;app.Copyright = &quot;Copyright 2013-2017 The go-ethereum Authors&quot; &nbsp;&nbsp;&nbsp;&nbsp;app.Commands = []cli.Command{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See chaincmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exportCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copydbCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removedbCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See monitorcmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;monitorCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See accountcmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;walletCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See consolecmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consoleCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attachCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javascriptCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See misccmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makecacheCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makedagCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bugCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;licenseCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See config.go &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpConfigCommand, &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;sort.Sort(cli.CommandsByName(app.Commands)) } ``` ###### 再单独分析initCommand: ``` initCommand = cli.Command{ Action: utils.MigrateFlags(initGenesis), Name: &quot;init&quot;, Usage: &quot;Bootstrap and initialize a new genesis block&quot;, ArgsUsage: &quot;&lt;genesisPath&gt;&quot;, Flags: []cli.Flag{ utils.DataDirFlag, utils.LightModeFlag, }, Category: &quot;BLOCKCHAIN COMMANDS&quot;, Description: ` The init command initializes a new genesis block and definition for the network. This is a destructive action and changes the network in which you will be participating. ``` ###### 其中Name是对应命令的指令，action是调用该指令去完成的动作，usage表示用途,arguUsage显示该命令后面跟的参数个数以及每个参数的意义, ###### 该init方法其实就是去初始化创世块,flags代表的是这个子命令额外可以执行的命令,如改init命令可以携带两个参数，点进去utils.DataDirFlag可以看到： ``` // General settings DataDirFlag = DirectoryFlag{ Name: &quot;datadir&quot;, Usage: &quot;Data directory for the databases and keystore&quot;, Value: DirectoryString{node.DefaultDataDir()}, } ``` * __可以用 --datadir [dir]来指定数据库的路径，如果没有指定由于该参数有value所以会启用默认的路径，也是home目录下面的.ethereum.__ * __/cmd/wnode/main.go　通过连接其他节点启动__ * __/cmd/geth /cmd/swarm　都是定义了很多命令__ ### eth下cmd的rlpdump子包,该包的主要作用从给定文件中转储RLP数据以可读的形式．如果文件名被省略，数据将从stdin中读取 　 /rlpdump ##### 解码rlp的数据 ###### rlpdump的command的help ``` Usage: /tmp/___cmd_rlpdump_test [-noascii] [-hex &lt;data&gt;] [filename] -hex string &nbsp;&nbsp;dump given hex data -noascii &nbsp;&nbsp;don&#39;t print ASCII strings readably -single &nbsp;&nbsp;print only the first element, discard the rest Dumps RLP data from the given file in readable form. If the filename is omitted, data is read from stdin. ``` ###### example1: ``` demo command: --hex f872f870845609a1ba64c0b8660480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee8580 success_result_demo: [ [ 5609a1ba, &quot;d&quot;, [], 0480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee85, &quot;&quot;, ], ] ``` ###### example2: ``` demo command: --noascii --hex CE0183FFFFFFC4C304050583616263 success_result_demo: [ 01, ffffff, [ [ 04, 05, 05, ], ], 616263, ] ``` ### cmd包下的p2psim子包的分析, p2psim is a command line client for the HTTP API ##### 首先我们启动对应的main函数,对应的启动参数是 `--help` ,来查看该包下所有命令的使用,结果如下: ``` NAME: ___go_build_main_go__1_ - devp2p simulation command-line client USAGE: ___go_build_main_go__1_ [global options] command [command options] [arguments...] VERSION: 0.0.0 COMMANDS: show show network information events stream network events snapshot create a network snapshot to stdout load load a network snapshot from stdin node manage simulation nodes help, h Shows a list of commands or help for one command GLOBAL OPTIONS: --api value simulation API URL (default: &quot;http://localhost:8888&quot;) [$P2PSIM_API_URL] --help, -h show help --version, -v print the version ``` ##### 该子包提供如何下的命令: ``` p2psim show p2psim events [--current] [--filter=FILTER] p2psim snapshot p2psim load p2psim node create [--name=NAME] [--services=SERVICES] [--key=KEY] p2psim node list p2psim node show &lt;node&gt; p2psim node start &lt;node&gt; p2psim node stop &lt;node&gt; p2psim node connect &lt;node&gt; &lt;peer&gt; p2psim node disconnect &lt;node&gt; &lt;peer&gt; p2psim node rpc &lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe] ``` ##### 要正常使用该子包下的命令，我们需要运行 `/p2p/simulations/examples/ping-pong.go` 的主函数来启动一个包含运行简单的节点的仿真网络. 正常启动后,你将看到: ``` INFO [01-23|11:17:10] using sim adapter INFO [01-23|11:17:10] starting simulation server on 0.0.0.0:8888... ``` ##### 该服务启动后,提供如下的API,其作用等同于上面的命令,命令调用的实现其实就是调用API,访问的路径前缀就是 `0.0.0.0:8888` : ``` GET / Get network information POST /start Start all nodes in the network POST /stop Stop all nodes in the network GET /events Stream network events GET /snapshot Take a network snapshot POST /snapshot Load a network snapshot POST /nodes Create a node GET /nodes Get all nodes in the network GET /nodes/:nodeid Get node information POST /nodes/:nodeid/start Start a node POST /nodes/:nodeid/stop Stop a node POST /nodes/:nodeid/conn/:peerid Connect two nodes DELETE /nodes/:nodeid/conn/:peerid Disconnect two nodes GET /nodes/:nodeid/rpc Make RPC requests to a node via WebSocket ``` ##### 此处不深究API,仿真网络的服务已经起来了,下面开始p2psim包下命令的使用: __/p2psim__ * show ``` function:显示当前仿真网络的状态 args:&quot;&quot; demo: show notice: success_result_demo: NODES 0 CONNS 0 ``` * snapshot ``` function:导出当前仿真网络的节点信息 args:&quot;&quot; demo: shapshot notice: success_result_demo: {&quot;nodes&quot;:[{&quot;node&quot;:{&quot;config&quot;:{&quot;id&quot;:&quot;085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d&quot;,&quot;private_key&quot;:&quot;3480d230f453e7c207bbd3b770bf774dc8a17e599394f9283147a35c3ead561c&quot;,&quot;name&quot;:&quot;node1&quot;,&quot;services&quot;:[&quot;ping-pong&quot;]},&quot;up&quot;:true}},{&quot;node&quot;:{&quot;config&quot;:{&quot;id&quot;:&quot;cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b&quot;,&quot;private_key&quot;:&quot;b7592cdeee6195c4486fcdd8007e1aedfd3a49e6c9f53e0845bf977d4ad043cc&quot;,&quot;name&quot;:&quot;node2&quot;,&quot;services&quot;:[&quot;ping-pong&quot;]},&quot;up&quot;:false}}],&quot;conns&quot;:[{&quot;one&quot;:&quot;cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b&quot;,&quot;other&quot;:&quot;085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d&quot;,&quot;up&quot;:false}]} ``` * node &gt; * create ``` function:创建一个节点 args:[--name=NAME] [--services=SERVICES] [--key=KEY] demo: node create --name node1 notice: success_result_demo: Created node1 ``` &gt; * list ``` function:列出当前仿真网络的节点信息 args:&quot;&quot; demo: node list notice: success_result_demo: NAME PROTOCOLS ID node1 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d node2 cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b ``` &gt; * show ``` function:查看仿真网络中某个节点的具体信息 args:&lt;node&gt; demo: node show node1 notice: success_result_demo: NAME node1 PROTOCOLS ID 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d ENODE enode://085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d@127.0.0.1:30303 ``` &gt; * start ``` function:启动一个节点 args:&lt;node&gt; demo: node start node1 notice: success_result_demo: Started node1 ``` &gt; * connect ``` function:将一个节点连接到另外一个节点 args:&lt;node&gt; &lt;peer&gt; demo: node connect node2 node1 notice: success_result_demo: Connected node2 to node1 ``` &gt; * disconnect ``` function:节点断开连接 args:&lt;node&gt; &lt;peer&gt; demo: node disconnect node2 node1 notice: success_result_demo: Disconnected node2 from node1 ``` &gt; * stop ``` function:停止一个节点 args:&lt;node&gt; demo: node stop node2 notice: success_result_demo: Stopped node2 ``` &gt; * rpc ``` function:调用rpc接口 args:&lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe] demo: node rpc node1 admin notice: success_result_demo: 　// TODO ``` ### cmd包下的geth子包主函数启动的各个子命令解析 #### /geth * __init__ ``` function:导入创世块的json,以指定的json作为创世块 args:&lt;genesisPath&gt; demo: init /home/yujian/eth-go/genesis.json notice:ethereum默认创建路径为home目录的.ethereum,如果该目录下已经写入过创世快，会执行失败 success_result_demo: WARN [01-16|10:25:12] No etherbase set and no accounts found as default INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=16 handles=16 INFO [01-16|10:25:12] Writing custom genesis block INFO [01-16|10:25:12] Successfully wrote genesis state database=chaindata hash=bf2891…ad1419 INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/lightchaindata cache=16 handles=16 INFO [01-16|10:25:12] Writing custom genesis block INFO [01-16|10:25:12] Successfully wrote genesis state database=lightchaindata hash=bf2891…ad1419 ``` * __import__ ``` function:导入区块数据到当前运行的链中 args:&lt;filename&gt; (&lt;filename 2&gt; ... &lt;filename N&gt;) demo: import /home/yujian/eth-block.txt notice:如果导入的文件只要一个是错误的，那么会失败，如果有多个文件错误，那么程序会继续执行忽略错误的． success_result_demo: WARN [01-16|11:00:32] No etherbase set and no accounts found as default INFO [01-16|11:00:32] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 Import done in 306.866µs. INFO [01-16|11:00:32] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 Compactions INFO [01-16|11:00:32] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB) -------+------------+---------------+---------------+---------------+--------------- INFO [01-16|11:00:32] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 0 | 3 | 0.00094 | 0.00000 | 0.00000 | 0.00000 INFO [01-16|11:00:32] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 Trie cache misses: 0 INFO [01-16|11:00:32] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 Trie cache unloads: 0 INFO [01-16|11:00:32] Importing blockchain file=/home/yujian/eth-block.txt Object memory: 34.677 MB current, 34.670 MB peak System memory: 74.100 MB current, 73.850 MB peak Allocations: 0.015 million GC pause: 10.454997ms Compacting entire database... INFO [01-16|11:00:33] Database closed database=/home/yujian/.ethereum/geth/chaindata Compaction done in 64.422235ms. Compactions Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB) -------+------------+---------------+---------------+---------------+--------------- 0 | 0 | 0.00000 | 0.00451 | 0.00000 | 0.00021 1 | 1 | 0.00053 | 0.00435 | 0.00114 | 0.00053 ``` * __export__ ``` function:导出区块数据到指定的文件 args:&lt;filename&gt; [&lt;blockNumFirst&gt; &lt;blockNumLast&gt;] demo: export /home/yujian/eth-block.txt notice: success_result_demo: WARN [01-16|10:51:36] No etherbase set and no accounts found as default INFO [01-16|10:51:36] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|10:51:36] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|10:51:36] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 Export done in 628.951µsINFO [01-16|10:51:36] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Exporting blockchain file=/home/yujian/eth-block.txt INFO [01-16|10:51:36] Exporting batch of blocks count=1 INFO [01-16|10:51:36] Exported blockchain file=/home/yujian/eth-block.txt ``` * __copydb__ ``` function:从存在的链数据文件夹中创建一条本地链 args:&lt;sourceChaindataDir&gt; demo: copydb /home/yujian/eth-block.txt notice: success_result_demo: WARN [01-16|11:35:55] No etherbase set and no accounts found as default INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|11:35:55] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|11:35:55] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 INFO [01-16|11:35:55] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/eth-go/geth/chaindata cache=128 handles=256 INFO [01-16|11:35:55] Block synchronisation started INFO [01-16|11:35:55] Imported new state entries count=1 elapsed=33.277µs processed=1 pending=0 retry=0 duplicate=0 unexpected=0 INFO [01-16|11:35:56] Imported new block headers count=11 elapsed=1.276s number=11 hash=ec3374…59a2ba ignored=0 Database copy done in 1.280940454s Compacting entire database... INFO [01-16|11:35:56] Imported new chain segment blocks=11 txs=0 mgas=0.000 elapsed=1.961ms mgasps=0.000 number=11 hash=ec3374…59a2ba Compaction done in 11.130389ms. ``` * __removedb__ ``` function:移除当前链的数据库 args:&quot;&quot; demo: removedb notice:默认当前链的数据在home目录下的.ethereum目录下 success_result_demo: WARN [01-16|11:48:09] No etherbase set and no accounts found as default /home/yujian/.ethereum/geth/chaindata Remove this database? [y/N] y /home/yujian/.ethereum/geth/lightchaindata INFO [01-16|11:48:19] Database successfully deleted database=chaindata elapsed=7.832ms Remove this database? [y/N] y INFO [01-16|11:48:27] Database successfully deleted database=lightchaindata elapsed=481.229µs ``` * __dump__ ``` function:转存指定的块 args:[&lt;blockHash&gt; | &lt;blockNum&gt;]... demo: dump 0 notice: success_result_demo: &quot;storage&quot;: {} }, &quot;af3cb5965933e7dad883693b9c3e15beb68a4873&quot;: { &quot;balance&quot;: &quot;2000000000000000000000&quot;, &quot;nonce&quot;: 0, &quot;root&quot;: &quot;56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, &quot;codeHash&quot;: &quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;, &quot;code&quot;: &quot;&quot;, &quot;storage&quot;: {} }, &quot;af4493e8521ca89d95f5267c1ab63f9f45411e1b&quot;: { &quot;balance&quot;: &quot;200000000000000000000&quot;, &quot;nonce&quot;: 0, &quot;root&quot;: &quot;56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, &quot;codeHash&quot;: &quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;, &quot;code&quot;: &quot;&quot;, &quot;storage&quot;: {} }, } } INFO [01-16|14:02:06] Database closed database=/home/yujian/.ethereum/geth/chaindata ``` * __monitor__ ``` function:监视和可视化节点指标 args:&quot;&quot; demo: monitor notice:该命令本地未调通,需要先启链，才能调用该命令去看监控的状态 success_result_demo: // TODO ``` * __account__ ``` function:管理账户 args:&quot;[new|list|update|import]&quot; demo: account new notice:“帐户导入”选项只能用于导入通用密钥文件 success_result_demo: WARN [01-16|14:44:44] No etherbase set and no accounts found as default Your new account is locked with a password. Please give a password. Do not forget this password. !! Unsupported terminal, password will be echoed. Passphrase: 123456 Repeat passphrase: 123456 Address: {2a23e9223d7af9c56f5abd0c8226021b51c98cbc} Process finished with exit code 0 ``` * __wallet__ ``` function:导入预付款钱包(一般用不到，用的是account功能) args:&quot;&quot; demo: wallet import notice:&quot;钱包导入&quot;选项只能用于导入预售钱包 success_result_demo: ``` 　　 * __console__ ``` function:开启一条私有链,并打开一个可视化的js钱包控制台 args:&quot;&quot; demo: console notice: success_result_demo: INFO [01-16|15:26:13] Starting peer-to-peer node instance=Geth/v1.7.3-unstable/linux-amd64/go1.9.2 INFO [01-16|15:26:13] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|15:26:14] Initialised chain configuration config=&quot;{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Engine: ethash}&quot; INFO [01-16|15:26:14] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|15:26:14] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 INFO [01-16|15:26:14] Initialising Ethereum protocol versions=&quot;[63 62]&quot; network=1 INFO [01-16|15:26:14] Loaded most recent local header number=1127484 hash=ae7ee2…52ae4c td=8985161313979839462 INFO [01-16|15:26:14] Loaded most recent local full block number=0 hash=d4e567…cb8fa3 td=17179869184 INFO [01-16|15:26:14] Loaded most recent local fast block number=1092806 hash=6e839a…2eb127 td=8395031237882431385 INFO [01-16|15:26:14] Upgrading chain index type=bloombits percentage=80 INFO [01-16|15:26:14] Loaded local transaction journal transactions=0 dropped=0 INFO [01-16|15:26:14] Regenerated local transaction journal transactions=0 accounts=0 INFO [01-16|15:26:14] Starting P2P networking INFO [01-16|15:26:16] UDP listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303 INFO [01-16|15:26:16] RLPx listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303 INFO [01-16|15:26:16] IPC endpoint opened: /home/yujian/.ethereum/geth.ipc Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2 coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc at block: 0 (Thu, 01 Jan 1970 08:00:00 CST) datadir: /home/yujian/.ethereum modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 ``` * __attach__ ``` function:打开一个可视化的js钱包控制台(连接到一个指定的链) args: --jspath loadScript JavaScript root path for loadScript (default: &quot;.&quot;) --exec value Execute JavaScript statement --preload value Comma separated list of JavaScript files to preload into the console --datadir &quot;/root/.ethereum&quot; Data directory for the databases and keystore demo:attach --datadir=&quot;/home/yujian/.ethereum/geth.ipc&quot; notice:必须启动一条本地链，这样才能连接过去 success_result_demo: Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2 coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc at block: 0 (Thu, 01 Jan 1970 08:00:00 CST) datadir: /home/yujian/.ethereum modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 ``` * __js__ ``` 　function:执行指定的js文件 args:&lt;jsfile&gt; [jsfile...] demo:js notice: success_result_demo: ``` * __makecache__ ``` function:生成ethhash验证缓存(测试使用) args:&lt;blockNum&gt; &lt;outputDir&gt; demo:makecache 0 /home/yujian/ notice: success_result_demo: 在对应的输出目录，将会生成一个cache文件,如 cache-R23-0000000000000000 ``` * __makedag__ ``` function:生成ethhash mining dag(测试使用) args:&lt;blockNum&gt; &lt;outputDir&gt; demo:makedag 0 /home/yujian/ notice: success_result_demo: INFO [01-16|17:50:36] Generating DAG in progress epoch=0 percentage=92 elapsed=3m2.525s INFO [01-16|17:50:38] Generating DAG in progress epoch=0 percentage=93 elapsed=3m4.338s INFO [01-16|17:50:40] Generating DAG in progress epoch=0 percentage=94 elapsed=3m6.058s INFO [01-16|17:50:41] Generating DAG in progress epoch=0 percentage=95 elapsed=3m7.795s INFO [01-16|17:50:43] Generating DAG in progress epoch=0 percentage=96 elapsed=3m9.542s INFO [01-16|17:50:45] Generating DAG in progress epoch=0 percentage=97 elapsed=3m11.380s INFO [01-16|17:50:47] Generating DAG in progress epoch=0 percentage=98 elapsed=3m13.129s INFO [01-16|17:50:49] Generating DAG in progress epoch=0 percentage=99 elapsed=3m15.303s INFO [01-16|17:50:49] Generated ethash verification cache epoch=0 elapsed=3m15.306s Process finished with exit code 0 在对应的输出目录,将会生成一个full文件,如 full-R23-0000000000000000 ``` * __version__ ``` function:打印版本数据 args:&quot;&quot; demo:version notice: success_result_demo: Geth Version: 1.7.3-unstable Architecture: amd64 Protocol Versions: [63 62] Network Id: 1 Go Version: go1.9.2 Operating System: linux GOPATH=/home/yujian/blockchain-workspace/go-project GOROOT=/usr/local/go 　　 ``` * __bug__ ``` function:打开一个窗口,直接跳转到ethereum的github仓库的issue args:&quot;&quot; demo:bug notice: success_result_demo: 　　运行后会自动打开浏览器，跳转到ethereum的issue编辑页面　 ``` * __license__ ``` function:显示geth的license信息 args:&quot;&quot; demo:license notice: success_result_demo: Geth is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. Geth is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with geth. If not, see &lt;http://www.gnu.org/licenses/&gt;. ``` * __dumpconfig__ ``` function:显示配置信息 args:&quot;&quot; demo:dumpconfig notice: success_result_demo: 　[Eth] NetworkId = 1 SyncMode = &quot;fast&quot; LightPeers = 20 DatabaseCache = 128 Etherbase = &quot;0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc&quot; GasPrice = 18000000000 EthashCacheDir = &quot;ethash&quot; EthashCachesInMem = 2 EthashCachesOnDisk = 3 EthashDatasetDir = &quot;/home/yujian/.ethash&quot; EthashDatasetsInMem = 1 EthashDatasetsOnDisk = 2 EnablePreimageRecording = false [Eth.TxPool] NoLocals = false Journal = &quot;transactions.rlp&quot; Rejournal = 3600000000000 PriceLimit = 1 PriceBump = 10 AccountSlots = 16 GlobalSlots = 4096 AccountQueue = 64 GlobalQueue = 1024 Lifetime = 10800000000000 [Eth.GPO] Blocks = 10 Percentile = 50 [Shh] MaxMessageSize = 1048576 MinimumAcceptedPOW = 2e-01 [Node] DataDir = &quot;/home/yujian/.ethereum&quot; IPCPath = &quot;geth.ipc&quot; HTTPPort = 8545 HTTPModules = [&quot;net&quot;, &quot;web3&quot;, &quot;eth&quot;, &quot;shh&quot;] WSPort = 8546 WSModules = [&quot;net&quot;, &quot;web3&quot;, &quot;eth&quot;, &quot;shh&quot;] [Node.P2P] MaxPeers = 25 NoDiscovery = false DiscoveryV5Addr = &quot;:30304&quot; BootstrapNodes = [&quot;enode://a979fb575495b8d6db44f750317d0f4622bf4c2aa3365d6af7c284339968eef29b69ad0dce72a4d8db5ebb4968de0e3bec910127f134779fbcb0cb6d3331163c@52.16.188.185:30303&quot;, &quot;enode://3f1d12044546b76342d59d4a05532c14b85aa669704bfe1f864fe079415aa2c02d743e03218e57a33fb94523adb54032871a6c51b2cc5514cb7c7e35b3ed0a99@13.93.211.84:30303&quot;, &quot;enode://78de8a0916848093c73790ead81d1928bec737d565119932b98c6b100d944b7a95e94f847f689fc723399d2e31129d182f7ef3863f2b4c820abbf3ab2722344d@191.235.84.50:30303&quot;, &quot;enode://158f8aab45f6d19c6cbf4a089c2670541a8da11978a2f90dbf6a502a4a3bab80d288afdbeb7ec0ef6d92de563767f3b1ea9e8e334ca711e9f8e2df5a0385e8e6@13.75.154.138:30303&quot;, &quot;enode://1118980bf48b0a3640bdba04e0fe78b1add18e1cd99bf22d53daac1fd9972ad650df52176e7c7d89d1114cfef2bc23a2959aa54998a46afcf7d91809f0855082@52.74.57.123:30303&quot;, &quot;enode://979b7fa28feeb35a4741660a16076f1943202cb72b6af70d327f053e248bab9ba81760f39d0701ef1d8f89cc1fbd2cacba0710a12cd5314d5e0c9021aa3637f9@5.1.83.226:30303&quot;] BootstrapNodesV5 = [&quot;enode://0cc5f5ffb5d9098c8b8c62325f3797f56509bff942704687b6530992ac706e2cb946b90a34f1f19548cd3c7baccbcaea354531e5983c7d1bc0dee16ce4b6440b@40.118.3.223:30305&quot;, &quot;enode://1c7a64d76c0334b0418c004af2f67c50e36a3be60b5e4790bdac0439d21603469a85fad36f2473c9a80eb043ae60936df905fa28f1ff614c3e5dc34f15dcd2dc@40.118.3.223:30308&quot;, &quot;enode://85c85d7143ae8bb96924f2b54f1b3e70d8c4d367af305325d30a61385a432f247d2c75c45c6b4a60335060d072d7f5b35dd1d4c45f76941f62a4f83b6e75daaf@40.118.3.223:30309&quot;] StaticNodes = [] TrustedNodes = [] ListenAddr = &quot;:30303&quot; EnableMsgEvents = false [Dashboard] Host = &quot;localhost&quot; Port = 8080 Refresh = 3000000000　 ``` ##### 参考资料 * [ eth钱包创建]( https://www.myetherwallet.com/#generate-wallet) * [ eth命令使用解释]( http://www.blockcode.org/archives/185) 网址：http://www.qukuailianxueyuan.io/ 欲领取造币技术与全套虚拟机资料 区块链技术交流QQ群：756146052&nbsp;&nbsp;备注：CSDN 尹成学院微信：备注：CSDN 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/05/21/46875ec16f9fb40325eb3d83e8524517.html" />
<meta property="og:url" content="https://mlh.app/2018/05/21/46875ec16f9fb40325eb3d83e8524517.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-05-21T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"### cmd包分析 #### cmd下面总共有13个子包，除了util包之外，每个子包都有一个主函数,每个主函数的init方法中都定义了该主函数支持的命令，如 ##### geth包下面的： ``` func init() { &nbsp;&nbsp;&nbsp;&nbsp;// Initialize the CLI app and start Geth &nbsp;&nbsp;&nbsp;&nbsp;app.Action = geth &nbsp;&nbsp;&nbsp;&nbsp;app.HideVersion = true // we have a command to print the version &nbsp;&nbsp;&nbsp;&nbsp;app.Copyright = &quot;Copyright 2013-2017 The go-ethereum Authors&quot; &nbsp;&nbsp;&nbsp;&nbsp;app.Commands = []cli.Command{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See chaincmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exportCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copydbCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removedbCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See monitorcmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;monitorCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See accountcmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;walletCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See consolecmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consoleCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attachCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javascriptCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See misccmd.go: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makecacheCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makedagCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bugCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;licenseCommand, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See config.go &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpConfigCommand, &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;sort.Sort(cli.CommandsByName(app.Commands)) } ``` ###### 再单独分析initCommand: ``` initCommand = cli.Command{ Action: utils.MigrateFlags(initGenesis), Name: &quot;init&quot;, Usage: &quot;Bootstrap and initialize a new genesis block&quot;, ArgsUsage: &quot;&lt;genesisPath&gt;&quot;, Flags: []cli.Flag{ utils.DataDirFlag, utils.LightModeFlag, }, Category: &quot;BLOCKCHAIN COMMANDS&quot;, Description: ` The init command initializes a new genesis block and definition for the network. This is a destructive action and changes the network in which you will be participating. ``` ###### 其中Name是对应命令的指令，action是调用该指令去完成的动作，usage表示用途,arguUsage显示该命令后面跟的参数个数以及每个参数的意义, ###### 该init方法其实就是去初始化创世块,flags代表的是这个子命令额外可以执行的命令,如改init命令可以携带两个参数，点进去utils.DataDirFlag可以看到： ``` // General settings DataDirFlag = DirectoryFlag{ Name: &quot;datadir&quot;, Usage: &quot;Data directory for the databases and keystore&quot;, Value: DirectoryString{node.DefaultDataDir()}, } ``` * __可以用 --datadir [dir]来指定数据库的路径，如果没有指定由于该参数有value所以会启用默认的路径，也是home目录下面的.ethereum.__ * __/cmd/wnode/main.go　通过连接其他节点启动__ * __/cmd/geth /cmd/swarm　都是定义了很多命令__ ### eth下cmd的rlpdump子包,该包的主要作用从给定文件中转储RLP数据以可读的形式．如果文件名被省略，数据将从stdin中读取 　 /rlpdump ##### 解码rlp的数据 ###### rlpdump的command的help ``` Usage: /tmp/___cmd_rlpdump_test [-noascii] [-hex &lt;data&gt;] [filename] -hex string &nbsp;&nbsp;dump given hex data -noascii &nbsp;&nbsp;don&#39;t print ASCII strings readably -single &nbsp;&nbsp;print only the first element, discard the rest Dumps RLP data from the given file in readable form. If the filename is omitted, data is read from stdin. ``` ###### example1: ``` demo command: --hex f872f870845609a1ba64c0b8660480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee8580 success_result_demo: [ [ 5609a1ba, &quot;d&quot;, [], 0480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee85, &quot;&quot;, ], ] ``` ###### example2: ``` demo command: --noascii --hex CE0183FFFFFFC4C304050583616263 success_result_demo: [ 01, ffffff, [ [ 04, 05, 05, ], ], 616263, ] ``` ### cmd包下的p2psim子包的分析, p2psim is a command line client for the HTTP API ##### 首先我们启动对应的main函数,对应的启动参数是 `--help` ,来查看该包下所有命令的使用,结果如下: ``` NAME: ___go_build_main_go__1_ - devp2p simulation command-line client USAGE: ___go_build_main_go__1_ [global options] command [command options] [arguments...] VERSION: 0.0.0 COMMANDS: show show network information events stream network events snapshot create a network snapshot to stdout load load a network snapshot from stdin node manage simulation nodes help, h Shows a list of commands or help for one command GLOBAL OPTIONS: --api value simulation API URL (default: &quot;http://localhost:8888&quot;) [$P2PSIM_API_URL] --help, -h show help --version, -v print the version ``` ##### 该子包提供如何下的命令: ``` p2psim show p2psim events [--current] [--filter=FILTER] p2psim snapshot p2psim load p2psim node create [--name=NAME] [--services=SERVICES] [--key=KEY] p2psim node list p2psim node show &lt;node&gt; p2psim node start &lt;node&gt; p2psim node stop &lt;node&gt; p2psim node connect &lt;node&gt; &lt;peer&gt; p2psim node disconnect &lt;node&gt; &lt;peer&gt; p2psim node rpc &lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe] ``` ##### 要正常使用该子包下的命令，我们需要运行 `/p2p/simulations/examples/ping-pong.go` 的主函数来启动一个包含运行简单的节点的仿真网络. 正常启动后,你将看到: ``` INFO [01-23|11:17:10] using sim adapter INFO [01-23|11:17:10] starting simulation server on 0.0.0.0:8888... ``` ##### 该服务启动后,提供如下的API,其作用等同于上面的命令,命令调用的实现其实就是调用API,访问的路径前缀就是 `0.0.0.0:8888` : ``` GET / Get network information POST /start Start all nodes in the network POST /stop Stop all nodes in the network GET /events Stream network events GET /snapshot Take a network snapshot POST /snapshot Load a network snapshot POST /nodes Create a node GET /nodes Get all nodes in the network GET /nodes/:nodeid Get node information POST /nodes/:nodeid/start Start a node POST /nodes/:nodeid/stop Stop a node POST /nodes/:nodeid/conn/:peerid Connect two nodes DELETE /nodes/:nodeid/conn/:peerid Disconnect two nodes GET /nodes/:nodeid/rpc Make RPC requests to a node via WebSocket ``` ##### 此处不深究API,仿真网络的服务已经起来了,下面开始p2psim包下命令的使用: __/p2psim__ * show ``` function:显示当前仿真网络的状态 args:&quot;&quot; demo: show notice: success_result_demo: NODES 0 CONNS 0 ``` * snapshot ``` function:导出当前仿真网络的节点信息 args:&quot;&quot; demo: shapshot notice: success_result_demo: {&quot;nodes&quot;:[{&quot;node&quot;:{&quot;config&quot;:{&quot;id&quot;:&quot;085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d&quot;,&quot;private_key&quot;:&quot;3480d230f453e7c207bbd3b770bf774dc8a17e599394f9283147a35c3ead561c&quot;,&quot;name&quot;:&quot;node1&quot;,&quot;services&quot;:[&quot;ping-pong&quot;]},&quot;up&quot;:true}},{&quot;node&quot;:{&quot;config&quot;:{&quot;id&quot;:&quot;cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b&quot;,&quot;private_key&quot;:&quot;b7592cdeee6195c4486fcdd8007e1aedfd3a49e6c9f53e0845bf977d4ad043cc&quot;,&quot;name&quot;:&quot;node2&quot;,&quot;services&quot;:[&quot;ping-pong&quot;]},&quot;up&quot;:false}}],&quot;conns&quot;:[{&quot;one&quot;:&quot;cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b&quot;,&quot;other&quot;:&quot;085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d&quot;,&quot;up&quot;:false}]} ``` * node &gt; * create ``` function:创建一个节点 args:[--name=NAME] [--services=SERVICES] [--key=KEY] demo: node create --name node1 notice: success_result_demo: Created node1 ``` &gt; * list ``` function:列出当前仿真网络的节点信息 args:&quot;&quot; demo: node list notice: success_result_demo: NAME PROTOCOLS ID node1 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d node2 cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b ``` &gt; * show ``` function:查看仿真网络中某个节点的具体信息 args:&lt;node&gt; demo: node show node1 notice: success_result_demo: NAME node1 PROTOCOLS ID 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d ENODE enode://085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d@127.0.0.1:30303 ``` &gt; * start ``` function:启动一个节点 args:&lt;node&gt; demo: node start node1 notice: success_result_demo: Started node1 ``` &gt; * connect ``` function:将一个节点连接到另外一个节点 args:&lt;node&gt; &lt;peer&gt; demo: node connect node2 node1 notice: success_result_demo: Connected node2 to node1 ``` &gt; * disconnect ``` function:节点断开连接 args:&lt;node&gt; &lt;peer&gt; demo: node disconnect node2 node1 notice: success_result_demo: Disconnected node2 from node1 ``` &gt; * stop ``` function:停止一个节点 args:&lt;node&gt; demo: node stop node2 notice: success_result_demo: Stopped node2 ``` &gt; * rpc ``` function:调用rpc接口 args:&lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe] demo: node rpc node1 admin notice: success_result_demo: 　// TODO ``` ### cmd包下的geth子包主函数启动的各个子命令解析 #### /geth * __init__ ``` function:导入创世块的json,以指定的json作为创世块 args:&lt;genesisPath&gt; demo: init /home/yujian/eth-go/genesis.json notice:ethereum默认创建路径为home目录的.ethereum,如果该目录下已经写入过创世快，会执行失败 success_result_demo: WARN [01-16|10:25:12] No etherbase set and no accounts found as default INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=16 handles=16 INFO [01-16|10:25:12] Writing custom genesis block INFO [01-16|10:25:12] Successfully wrote genesis state database=chaindata hash=bf2891…ad1419 INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/lightchaindata cache=16 handles=16 INFO [01-16|10:25:12] Writing custom genesis block INFO [01-16|10:25:12] Successfully wrote genesis state database=lightchaindata hash=bf2891…ad1419 ``` * __import__ ``` function:导入区块数据到当前运行的链中 args:&lt;filename&gt; (&lt;filename 2&gt; ... &lt;filename N&gt;) demo: import /home/yujian/eth-block.txt notice:如果导入的文件只要一个是错误的，那么会失败，如果有多个文件错误，那么程序会继续执行忽略错误的． success_result_demo: WARN [01-16|11:00:32] No etherbase set and no accounts found as default INFO [01-16|11:00:32] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 Import done in 306.866µs. INFO [01-16|11:00:32] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 Compactions INFO [01-16|11:00:32] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB) -------+------------+---------------+---------------+---------------+--------------- INFO [01-16|11:00:32] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 0 | 3 | 0.00094 | 0.00000 | 0.00000 | 0.00000 INFO [01-16|11:00:32] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 Trie cache misses: 0 INFO [01-16|11:00:32] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 Trie cache unloads: 0 INFO [01-16|11:00:32] Importing blockchain file=/home/yujian/eth-block.txt Object memory: 34.677 MB current, 34.670 MB peak System memory: 74.100 MB current, 73.850 MB peak Allocations: 0.015 million GC pause: 10.454997ms Compacting entire database... INFO [01-16|11:00:33] Database closed database=/home/yujian/.ethereum/geth/chaindata Compaction done in 64.422235ms. Compactions Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB) -------+------------+---------------+---------------+---------------+--------------- 0 | 0 | 0.00000 | 0.00451 | 0.00000 | 0.00021 1 | 1 | 0.00053 | 0.00435 | 0.00114 | 0.00053 ``` * __export__ ``` function:导出区块数据到指定的文件 args:&lt;filename&gt; [&lt;blockNumFirst&gt; &lt;blockNumLast&gt;] demo: export /home/yujian/eth-block.txt notice: success_result_demo: WARN [01-16|10:51:36] No etherbase set and no accounts found as default INFO [01-16|10:51:36] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|10:51:36] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|10:51:36] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 Export done in 628.951µsINFO [01-16|10:51:36] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|10:51:36] Exporting blockchain file=/home/yujian/eth-block.txt INFO [01-16|10:51:36] Exporting batch of blocks count=1 INFO [01-16|10:51:36] Exported blockchain file=/home/yujian/eth-block.txt ``` * __copydb__ ``` function:从存在的链数据文件夹中创建一条本地链 args:&lt;sourceChaindataDir&gt; demo: copydb /home/yujian/eth-block.txt notice: success_result_demo: WARN [01-16|11:35:55] No etherbase set and no accounts found as default INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|11:35:55] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|11:35:55] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 INFO [01-16|11:35:55] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432 INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/eth-go/geth/chaindata cache=128 handles=256 INFO [01-16|11:35:55] Block synchronisation started INFO [01-16|11:35:55] Imported new state entries count=1 elapsed=33.277µs processed=1 pending=0 retry=0 duplicate=0 unexpected=0 INFO [01-16|11:35:56] Imported new block headers count=11 elapsed=1.276s number=11 hash=ec3374…59a2ba ignored=0 Database copy done in 1.280940454s Compacting entire database... INFO [01-16|11:35:56] Imported new chain segment blocks=11 txs=0 mgas=0.000 elapsed=1.961ms mgasps=0.000 number=11 hash=ec3374…59a2ba Compaction done in 11.130389ms. ``` * __removedb__ ``` function:移除当前链的数据库 args:&quot;&quot; demo: removedb notice:默认当前链的数据在home目录下的.ethereum目录下 success_result_demo: WARN [01-16|11:48:09] No etherbase set and no accounts found as default /home/yujian/.ethereum/geth/chaindata Remove this database? [y/N] y /home/yujian/.ethereum/geth/lightchaindata INFO [01-16|11:48:19] Database successfully deleted database=chaindata elapsed=7.832ms Remove this database? [y/N] y INFO [01-16|11:48:27] Database successfully deleted database=lightchaindata elapsed=481.229µs ``` * __dump__ ``` function:转存指定的块 args:[&lt;blockHash&gt; | &lt;blockNum&gt;]... demo: dump 0 notice: success_result_demo: &quot;storage&quot;: {} }, &quot;af3cb5965933e7dad883693b9c3e15beb68a4873&quot;: { &quot;balance&quot;: &quot;2000000000000000000000&quot;, &quot;nonce&quot;: 0, &quot;root&quot;: &quot;56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, &quot;codeHash&quot;: &quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;, &quot;code&quot;: &quot;&quot;, &quot;storage&quot;: {} }, &quot;af4493e8521ca89d95f5267c1ab63f9f45411e1b&quot;: { &quot;balance&quot;: &quot;200000000000000000000&quot;, &quot;nonce&quot;: 0, &quot;root&quot;: &quot;56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, &quot;codeHash&quot;: &quot;c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470&quot;, &quot;code&quot;: &quot;&quot;, &quot;storage&quot;: {} }, } } INFO [01-16|14:02:06] Database closed database=/home/yujian/.ethereum/geth/chaindata ``` * __monitor__ ``` function:监视和可视化节点指标 args:&quot;&quot; demo: monitor notice:该命令本地未调通,需要先启链，才能调用该命令去看监控的状态 success_result_demo: // TODO ``` * __account__ ``` function:管理账户 args:&quot;[new|list|update|import]&quot; demo: account new notice:“帐户导入”选项只能用于导入通用密钥文件 success_result_demo: WARN [01-16|14:44:44] No etherbase set and no accounts found as default Your new account is locked with a password. Please give a password. Do not forget this password. !! Unsupported terminal, password will be echoed. Passphrase: 123456 Repeat passphrase: 123456 Address: {2a23e9223d7af9c56f5abd0c8226021b51c98cbc} Process finished with exit code 0 ``` * __wallet__ ``` function:导入预付款钱包(一般用不到，用的是account功能) args:&quot;&quot; demo: wallet import notice:&quot;钱包导入&quot;选项只能用于导入预售钱包 success_result_demo: ``` 　　 * __console__ ``` function:开启一条私有链,并打开一个可视化的js钱包控制台 args:&quot;&quot; demo: console notice: success_result_demo: INFO [01-16|15:26:13] Starting peer-to-peer node instance=Geth/v1.7.3-unstable/linux-amd64/go1.9.2 INFO [01-16|15:26:13] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024 INFO [01-16|15:26:14] Initialised chain configuration config=&quot;{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Engine: ethash}&quot; INFO [01-16|15:26:14] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3 INFO [01-16|15:26:14] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2 INFO [01-16|15:26:14] Initialising Ethereum protocol versions=&quot;[63 62]&quot; network=1 INFO [01-16|15:26:14] Loaded most recent local header number=1127484 hash=ae7ee2…52ae4c td=8985161313979839462 INFO [01-16|15:26:14] Loaded most recent local full block number=0 hash=d4e567…cb8fa3 td=17179869184 INFO [01-16|15:26:14] Loaded most recent local fast block number=1092806 hash=6e839a…2eb127 td=8395031237882431385 INFO [01-16|15:26:14] Upgrading chain index type=bloombits percentage=80 INFO [01-16|15:26:14] Loaded local transaction journal transactions=0 dropped=0 INFO [01-16|15:26:14] Regenerated local transaction journal transactions=0 accounts=0 INFO [01-16|15:26:14] Starting P2P networking INFO [01-16|15:26:16] UDP listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303 INFO [01-16|15:26:16] RLPx listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303 INFO [01-16|15:26:16] IPC endpoint opened: /home/yujian/.ethereum/geth.ipc Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2 coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc at block: 0 (Thu, 01 Jan 1970 08:00:00 CST) datadir: /home/yujian/.ethereum modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 ``` * __attach__ ``` function:打开一个可视化的js钱包控制台(连接到一个指定的链) args: --jspath loadScript JavaScript root path for loadScript (default: &quot;.&quot;) --exec value Execute JavaScript statement --preload value Comma separated list of JavaScript files to preload into the console --datadir &quot;/root/.ethereum&quot; Data directory for the databases and keystore demo:attach --datadir=&quot;/home/yujian/.ethereum/geth.ipc&quot; notice:必须启动一条本地链，这样才能连接过去 success_result_demo: Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2 coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc at block: 0 (Thu, 01 Jan 1970 08:00:00 CST) datadir: /home/yujian/.ethereum modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 ``` * __js__ ``` 　function:执行指定的js文件 args:&lt;jsfile&gt; [jsfile...] demo:js notice: success_result_demo: ``` * __makecache__ ``` function:生成ethhash验证缓存(测试使用) args:&lt;blockNum&gt; &lt;outputDir&gt; demo:makecache 0 /home/yujian/ notice: success_result_demo: 在对应的输出目录，将会生成一个cache文件,如 cache-R23-0000000000000000 ``` * __makedag__ ``` function:生成ethhash mining dag(测试使用) args:&lt;blockNum&gt; &lt;outputDir&gt; demo:makedag 0 /home/yujian/ notice: success_result_demo: INFO [01-16|17:50:36] Generating DAG in progress epoch=0 percentage=92 elapsed=3m2.525s INFO [01-16|17:50:38] Generating DAG in progress epoch=0 percentage=93 elapsed=3m4.338s INFO [01-16|17:50:40] Generating DAG in progress epoch=0 percentage=94 elapsed=3m6.058s INFO [01-16|17:50:41] Generating DAG in progress epoch=0 percentage=95 elapsed=3m7.795s INFO [01-16|17:50:43] Generating DAG in progress epoch=0 percentage=96 elapsed=3m9.542s INFO [01-16|17:50:45] Generating DAG in progress epoch=0 percentage=97 elapsed=3m11.380s INFO [01-16|17:50:47] Generating DAG in progress epoch=0 percentage=98 elapsed=3m13.129s INFO [01-16|17:50:49] Generating DAG in progress epoch=0 percentage=99 elapsed=3m15.303s INFO [01-16|17:50:49] Generated ethash verification cache epoch=0 elapsed=3m15.306s Process finished with exit code 0 在对应的输出目录,将会生成一个full文件,如 full-R23-0000000000000000 ``` * __version__ ``` function:打印版本数据 args:&quot;&quot; demo:version notice: success_result_demo: Geth Version: 1.7.3-unstable Architecture: amd64 Protocol Versions: [63 62] Network Id: 1 Go Version: go1.9.2 Operating System: linux GOPATH=/home/yujian/blockchain-workspace/go-project GOROOT=/usr/local/go 　　 ``` * __bug__ ``` function:打开一个窗口,直接跳转到ethereum的github仓库的issue args:&quot;&quot; demo:bug notice: success_result_demo: 　　运行后会自动打开浏览器，跳转到ethereum的issue编辑页面　 ``` * __license__ ``` function:显示geth的license信息 args:&quot;&quot; demo:license notice: success_result_demo: Geth is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. Geth is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with geth. If not, see &lt;http://www.gnu.org/licenses/&gt;. ``` * __dumpconfig__ ``` function:显示配置信息 args:&quot;&quot; demo:dumpconfig notice: success_result_demo: 　[Eth] NetworkId = 1 SyncMode = &quot;fast&quot; LightPeers = 20 DatabaseCache = 128 Etherbase = &quot;0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc&quot; GasPrice = 18000000000 EthashCacheDir = &quot;ethash&quot; EthashCachesInMem = 2 EthashCachesOnDisk = 3 EthashDatasetDir = &quot;/home/yujian/.ethash&quot; EthashDatasetsInMem = 1 EthashDatasetsOnDisk = 2 EnablePreimageRecording = false [Eth.TxPool] NoLocals = false Journal = &quot;transactions.rlp&quot; Rejournal = 3600000000000 PriceLimit = 1 PriceBump = 10 AccountSlots = 16 GlobalSlots = 4096 AccountQueue = 64 GlobalQueue = 1024 Lifetime = 10800000000000 [Eth.GPO] Blocks = 10 Percentile = 50 [Shh] MaxMessageSize = 1048576 MinimumAcceptedPOW = 2e-01 [Node] DataDir = &quot;/home/yujian/.ethereum&quot; IPCPath = &quot;geth.ipc&quot; HTTPPort = 8545 HTTPModules = [&quot;net&quot;, &quot;web3&quot;, &quot;eth&quot;, &quot;shh&quot;] WSPort = 8546 WSModules = [&quot;net&quot;, &quot;web3&quot;, &quot;eth&quot;, &quot;shh&quot;] [Node.P2P] MaxPeers = 25 NoDiscovery = false DiscoveryV5Addr = &quot;:30304&quot; BootstrapNodes = [&quot;enode://a979fb575495b8d6db44f750317d0f4622bf4c2aa3365d6af7c284339968eef29b69ad0dce72a4d8db5ebb4968de0e3bec910127f134779fbcb0cb6d3331163c@52.16.188.185:30303&quot;, &quot;enode://3f1d12044546b76342d59d4a05532c14b85aa669704bfe1f864fe079415aa2c02d743e03218e57a33fb94523adb54032871a6c51b2cc5514cb7c7e35b3ed0a99@13.93.211.84:30303&quot;, &quot;enode://78de8a0916848093c73790ead81d1928bec737d565119932b98c6b100d944b7a95e94f847f689fc723399d2e31129d182f7ef3863f2b4c820abbf3ab2722344d@191.235.84.50:30303&quot;, &quot;enode://158f8aab45f6d19c6cbf4a089c2670541a8da11978a2f90dbf6a502a4a3bab80d288afdbeb7ec0ef6d92de563767f3b1ea9e8e334ca711e9f8e2df5a0385e8e6@13.75.154.138:30303&quot;, &quot;enode://1118980bf48b0a3640bdba04e0fe78b1add18e1cd99bf22d53daac1fd9972ad650df52176e7c7d89d1114cfef2bc23a2959aa54998a46afcf7d91809f0855082@52.74.57.123:30303&quot;, &quot;enode://979b7fa28feeb35a4741660a16076f1943202cb72b6af70d327f053e248bab9ba81760f39d0701ef1d8f89cc1fbd2cacba0710a12cd5314d5e0c9021aa3637f9@5.1.83.226:30303&quot;] BootstrapNodesV5 = [&quot;enode://0cc5f5ffb5d9098c8b8c62325f3797f56509bff942704687b6530992ac706e2cb946b90a34f1f19548cd3c7baccbcaea354531e5983c7d1bc0dee16ce4b6440b@40.118.3.223:30305&quot;, &quot;enode://1c7a64d76c0334b0418c004af2f67c50e36a3be60b5e4790bdac0439d21603469a85fad36f2473c9a80eb043ae60936df905fa28f1ff614c3e5dc34f15dcd2dc@40.118.3.223:30308&quot;, &quot;enode://85c85d7143ae8bb96924f2b54f1b3e70d8c4d367af305325d30a61385a432f247d2c75c45c6b4a60335060d072d7f5b35dd1d4c45f76941f62a4f83b6e75daaf@40.118.3.223:30309&quot;] StaticNodes = [] TrustedNodes = [] ListenAddr = &quot;:30303&quot; EnableMsgEvents = false [Dashboard] Host = &quot;localhost&quot; Port = 8080 Refresh = 3000000000　 ``` ##### 参考资料 * [ eth钱包创建]( https://www.myetherwallet.com/#generate-wallet) * [ eth命令使用解释]( http://www.blockcode.org/archives/185) 网址：http://www.qukuailianxueyuan.io/ 欲领取造币技术与全套虚拟机资料 区块链技术交流QQ群：756146052&nbsp;&nbsp;备注：CSDN 尹成学院微信：备注：CSDN 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/05/21/46875ec16f9fb40325eb3d83e8524517.html","headline":"以太坊源码分析(9)CMD实际操作分析","dateModified":"2018-05-21T00:00:00+08:00","datePublished":"2018-05-21T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/05/21/46875ec16f9fb40325eb3d83e8524517.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>以太坊源码分析(9)CMD实际操作分析</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <div style="color:rgb(212,212,212);background-color:rgb(30,30,30);font-family:Consolas, 'Courier New', monospace;font-size:14px;line-height:19px;">
   <div>
    <span style="color:#569cd6;"><strong></strong></span>
    <div style="color:rgb(212,212,212);background-color:rgb(30,30,30);font-family:Consolas, 'Courier New', monospace;font-size:14px;line-height:19px;">
     <div>
      <span style="color:#569cd6;"><strong>### cmd包分析</strong></span>
     </div>
     <div>
      <span style="color:#569cd6;"><strong>#### cmd下面总共有13个子包，除了util包之外，每个子包都有一个主函数,每个主函数的init方法中都定义了该主函数支持的命令，如</strong></span>
     </div>
     <br>
     <div>
      <span style="color:#569cd6;"><strong>##### geth包下面的：</strong></span>
     </div>
     <br>
     <div>
      ```
     </div>
     <div>
      func init() {
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;// Initialize the CLI app and start Geth
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;app.Action = geth
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;app.HideVersion = true // we have a command to print the version
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;app.Copyright = "Copyright 2013-2017 The go-ethereum Authors"
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;app.Commands = []cli.Command{
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See chaincmd.go:
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exportCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copydbCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removedbCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See monitorcmd.go:
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;monitorCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See accountcmd.go:
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accountCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;walletCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See consolecmd.go:
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consoleCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attachCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javascriptCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See misccmd.go:
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makecacheCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;makedagCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bugCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;licenseCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// See config.go
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dumpConfigCommand,
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;}
     </div>
     <div>
      &nbsp;&nbsp;&nbsp;&nbsp;sort.Sort(cli.CommandsByName(app.Commands))
     </div>
     <div>
      }
     </div>
     <div>
      ```
     </div>
     <br>
     <br>
     <div>
      <span style="color:#569cd6;"><strong>###### 再单独分析initCommand:</strong></span>
     </div>
     <br>
     <div>
      ```
     </div>
     <div>
      initCommand = cli.Command{
     </div>
     <div>
       Action: utils.MigrateFlags(initGenesis),
     </div>
     <div>
       Name: "init",
     </div>
     <div>
       Usage: "Bootstrap and initialize a new genesis block",
     </div>
     <div>
       ArgsUsage: "&lt;genesisPath&gt;",
     </div>
     <div>
       Flags: []cli.Flag{
     </div>
     <div>
       utils.DataDirFlag,
     </div>
     <div>
       utils.LightModeFlag,
     </div>
     <div>
       },
     </div>
     <div>
       Category: "BLOCKCHAIN COMMANDS",
     </div>
     <div>
       Description: `
     </div>
     <div>
      The init command initializes a new genesis block and definition for the network.
     </div>
     <div>
      This is a destructive action and changes the network in which you will be
     </div>
     <div>
      participating.
     </div>
     <br>
     <div>
      ```
     </div>
     <br>
     <div>
      <span style="color:#569cd6;"><strong>###### 其中Name是对应命令的指令，action是调用该指令去完成的动作，usage表示用途,arguUsage显示该命令后面跟的参数个数以及每个参数的意义,</strong></span>
     </div>
     <div>
      <span style="color:#569cd6;"><strong>###### 该init方法其实就是去初始化创世块,flags代表的是这个子命令额外可以执行的命令,如改init命令可以携带两个参数，点进去utils.DataDirFlag可以看到：</strong></span>
     </div>
     <br>
     <div>
      ```
     </div>
     <div>
      // General settings
     </div>
     <div>
      DataDirFlag = DirectoryFlag{
     </div>
     <div>
       Name: "datadir",
     </div>
     <div>
       Usage: "Data directory for the databases and keystore",
     </div>
     <div>
       Value: DirectoryString{node.DefaultDataDir()},
     </div>
     <div>
      }
     </div>
     <div>
      ```
     </div>
     <br>
     <br>
     <div>
      <span style="color:#6796e6;">*</span> 
      <span style="color:#569cd6;"><strong>__可以用 --datadir [dir]来指定数据库的路径，如果没有指定由于该参数有value所以会启用默认的路径，也是home目录下面的.ethereum.__</strong></span>
     </div>
     <br>
     <div>
      <span style="color:#6796e6;">*</span> 
      <span style="color:#569cd6;"><strong>__/cmd/wnode/main.go　通过连接其他节点启动__</strong></span>
     </div>
     <br>
     <br>
     <div>
      <span style="color:#6796e6;">*</span> 
      <span style="color:#569cd6;"><strong>__/cmd/geth /cmd/swarm　都是定义了很多命令__</strong></span>
     </div>
    </div>
    <br>
   </div>
   <div>
    <span style="color:#569cd6;"><strong><br></strong></span>
   </div>
   <div>
    <span style="color:#569cd6;"><strong><br></strong></span>
   </div>
   <div>
    <span style="color:#569cd6;"><strong><br></strong></span>
   </div>
   <div>
    <span style="color:#569cd6;"><strong><br></strong></span>
   </div>
   <div>
    <span style="color:#569cd6;"><strong>### eth下cmd的rlpdump子包,该包的主要作用从给定文件中转储RLP数据以可读的形式．如果文件名被省略，数据将从stdin中读取</strong></span>
   </div>
   <br>
   <div>
    　 /rlpdump
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 解码rlp的数据</strong></span>
   </div>
   <br>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>###### rlpdump的command的help</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
    Usage: /tmp/___cmd_rlpdump_test [-noascii] [-hex &lt;data&gt;] [filename]
   </div>
   <div>
     -hex string
   </div>
   <div>
     &nbsp;&nbsp;dump given hex data
   </div>
   <div>
     -noascii
   </div>
   <div>
     &nbsp;&nbsp;don't print ASCII strings readably
   </div>
   <div>
     -single
   </div>
   <div>
     &nbsp;&nbsp;print only the first element, discard the rest
   </div>
   <br>
   <div>
    Dumps RLP data from the given file in readable form.
   </div>
   <div>
    If the filename is omitted, data is read from stdin.
   </div>
   <br>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>###### example1:</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     demo command: --hex f872f870845609a1ba64c0b8660480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee8580
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     [
   </div>
   <div>
     [
   </div>
   <div>
     5609a1ba,
   </div>
   <div>
     "d",
   </div>
   <div>
     [],
   </div>
   <div>
     0480136e573eb81ac4a664f8f76e4887ba927f791a053ec5ff580b1037a8633320ca70f8ec0cdea59167acaa1debc07bc0a0b3a5b41bdf0cb4346c18ddbbd2cf222f54fed795dde94417d2e57f85a580d87238efc75394ca4a92cfe6eb9debcc3583c26fee85,
   </div>
   <div>
     "",
   </div>
   <div>
     ],
   </div>
   <div>
     ]
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>###### example2:</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     demo command: --noascii --hex CE0183FFFFFFC4C304050583616263
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     [
   </div>
   <div>
     01,
   </div>
   <div>
     ffffff,
   </div>
   <div>
     [
   </div>
   <div>
     [
   </div>
   <div>
     04,
   </div>
   <div>
     05,
   </div>
   <div>
     05,
   </div>
   <div>
     ],
   </div>
   <div>
     ],
   </div>
   <div>
     616263,
   </div>
   <div>
     ]
   </div>
   <br>
   <br>
   <br>
   <div>
    ```
   </div>
   <div>
    <span style="color:rgb(86,156,214);"><strong>### cmd包下的p2psim子包的分析, p2psim is a command line client for the HTTP API</strong></span>
   </div>
  </div>
  <div style="color:rgb(212,212,212);background-color:rgb(30,30,30);font-family:Consolas, 'Courier New', monospace;font-size:14px;line-height:19px;">
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 首先我们启动对应的main函数,对应的启动参数是</strong></span>
    <span style="color:#ce9178;"><strong>`--help`</strong></span>
    <span style="color:#569cd6;"><strong>,来查看该包下所有命令的使用,结果如下:</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
    NAME:
   </div>
   <div>
     ___go_build_main_go__1_ - devp2p simulation command-line client
   </div>
   <br>
   <div>
    USAGE:
   </div>
   <div>
     ___go_build_main_go__1_ [global options] command [command options] [arguments...]
   </div>
   <br>
   <div>
    VERSION:
   </div>
   <div>
     0.0.0
   </div>
   <br>
   <div>
    COMMANDS:
   </div>
   <div>
     show show network information
   </div>
   <div>
     events stream network events
   </div>
   <div>
     snapshot create a network snapshot to stdout
   </div>
   <div>
     load load a network snapshot from stdin
   </div>
   <div>
     node manage simulation nodes
   </div>
   <div>
     help, h Shows a list of commands or help for one command
   </div>
   <br>
   <div>
    GLOBAL OPTIONS:
   </div>
   <div>
     --api value simulation API URL (default: "http://localhost:8888") [$P2PSIM_API_URL]
   </div>
   <div>
     --help, -h show help
   </div>
   <div>
     --version, -v print the version
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 该子包提供如何下的命令:</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
    p2psim show
   </div>
   <div>
    p2psim events [--current] [--filter=FILTER]
   </div>
   <div>
    p2psim snapshot
   </div>
   <div>
    p2psim load
   </div>
   <div>
    p2psim node create [--name=NAME] [--services=SERVICES] [--key=KEY]
   </div>
   <div>
    p2psim node list
   </div>
   <div>
    p2psim node show &lt;node&gt;
   </div>
   <div>
    p2psim node start &lt;node&gt;
   </div>
   <div>
    p2psim node stop &lt;node&gt;
   </div>
   <div>
    p2psim node connect &lt;node&gt; &lt;peer&gt;
   </div>
   <div>
    p2psim node disconnect &lt;node&gt; &lt;peer&gt;
   </div>
   <div>
    p2psim node rpc &lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe]
   </div>
   <br>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 要正常使用该子包下的命令，我们需要运行</strong></span>
    <span style="color:#ce9178;"><strong>`/p2p/simulations/examples/ping-pong.go`</strong></span>
    <span style="color:#569cd6;"><strong>的主函数来启动一个包含运行简单的节点的仿真网络.</strong></span>
   </div>
   <div>
    正常启动后,你将看到:
   </div>
   <div>
    ```
   </div>
   <div>
    INFO [01-23|11:17:10] using sim adapter
   </div>
   <div>
    INFO [01-23|11:17:10] starting simulation server on 0.0.0.0:8888...
   </div>
   <br>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 该服务启动后,提供如下的API,其作用等同于上面的命令,命令调用的实现其实就是调用API,访问的路径前缀就是</strong></span>
    <span style="color:#ce9178;"><strong>`0.0.0.0:8888`</strong></span>
    <span style="color:#569cd6;"><strong>:</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
    GET / Get network information
   </div>
   <div>
    POST /start Start all nodes in the network
   </div>
   <div>
    POST /stop Stop all nodes in the network
   </div>
   <div>
    GET /events Stream network events
   </div>
   <div>
    GET /snapshot Take a network snapshot
   </div>
   <div>
    POST /snapshot Load a network snapshot
   </div>
   <div>
    POST /nodes Create a node
   </div>
   <div>
    GET /nodes Get all nodes in the network
   </div>
   <div>
    GET /nodes/:nodeid Get node information
   </div>
   <div>
    POST /nodes/:nodeid/start Start a node
   </div>
   <div>
    POST /nodes/:nodeid/stop Stop a node
   </div>
   <div>
    POST /nodes/:nodeid/conn/:peerid Connect two nodes
   </div>
   <div>
    DELETE /nodes/:nodeid/conn/:peerid Disconnect two nodes
   </div>
   <div>
    GET /nodes/:nodeid/rpc Make RPC requests to a node via WebSocket
   </div>
   <br>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 此处不深究API,仿真网络的服务已经起来了,下面开始p2psim包下命令的使用:</strong></span>
   </div>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>__/p2psim__</strong></span>
   </div>
   <br>
   <div> 
    <span style="color:#6796e6;">*</span> show
   </div>
   <div>
     ```
   </div>
   <div>
     function:显示当前仿真网络的状态
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: show
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     NODES 0
   </div>
   <div>
     CONNS 0
   </div>
   <br>
   <div>
     ```
   </div>
   <br>
   <div> 
    <span style="color:#6796e6;">*</span> snapshot
   </div>
   <div>
     ```
   </div>
   <div>
     function:导出当前仿真网络的节点信息
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: shapshot
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     {"nodes":[{"node":{"config":{"id":"085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d","private_key":"3480d230f453e7c207bbd3b770bf774dc8a17e599394f9283147a35c3ead561c","name":"node1","services":["ping-pong"]},"up":true}},{"node":{"config":{"id":"cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b","private_key":"b7592cdeee6195c4486fcdd8007e1aedfd3a49e6c9f53e0845bf977d4ad043cc","name":"node2","services":["ping-pong"]},"up":false}}],"conns":[{"one":"cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b","other":"085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d","up":false}]}
   </div>
   <br>
   <br>
   <div>
     ```
   </div>
   <br>
   <div> 
    <span style="color:#6796e6;">*</span> node
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> create
   </div>
   <div>
     ```
   </div>
   <div>
     function:创建一个节点
   </div>
   <div>
     args:[--name=NAME] [--services=SERVICES] [--key=KEY]
   </div>
   <div>
     demo: node create --name node1
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Created node1
   </div>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> list
   </div>
   <div>
     ```
   </div>
   <div>
     function:列出当前仿真网络的节点信息
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: node list
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     NAME PROTOCOLS ID
   </div>
   <div>
     node1 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d
   </div>
   <div>
     node2 cedbaecccfe42d04b742d1be6e924e0654a7eb1aa584d497f98d24951b156ada84bcfc6455ff37ba1fc81179d0a7c3da1ba34945be19d1fe5cd4c8a32a659a7b
   </div>
   <br>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> show
   </div>
   <div>
     ```
   </div>
   <div>
     function:查看仿真网络中某个节点的具体信息
   </div>
   <div>
     args:&lt;node&gt;
   </div>
   <div>
     demo: node show node1
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     NAME node1
   </div>
   <div>
     PROTOCOLS
   </div>
   <div>
     ID 085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d
   </div>
   <div>
     ENODE enode://085416957c3a0afef6aabe6c0d6b27b7cf8a61f28a3a5439010fcc9e49945a1818ea38946dda8c82004b231ab771450ee0d87886163b65eaa48ecfbcb85e871d@127.0.0.1:30303
   </div>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> start
   </div>
   <div>
     ```
   </div>
   <div>
     function:启动一个节点
   </div>
   <div>
     args:&lt;node&gt;
   </div>
   <div>
     demo: node start node1
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Started node1
   </div>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> connect
   </div>
   <div>
     ```
   </div>
   <div>
     function:将一个节点连接到另外一个节点
   </div>
   <div>
     args:&lt;node&gt; &lt;peer&gt;
   </div>
   <div>
     demo: node connect node2 node1
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Connected node2 to node1
   </div>
   <br>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> disconnect
   </div>
   <br>
   <div>
     ```
   </div>
   <div>
     function:节点断开连接
   </div>
   <div>
     args:&lt;node&gt; &lt;peer&gt;
   </div>
   <div>
     demo: node disconnect node2 node1
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Disconnected node2 from node1
   </div>
   <br>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> stop
   </div>
   <br>
   <div>
     ```
   </div>
   <div>
     function:停止一个节点
   </div>
   <div>
     args:&lt;node&gt;
   </div>
   <div>
     demo: node stop node2
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Stopped node2
   </div>
   <br>
   <div>
     ```
   </div>
   <div> 
    <span style="color:#608b4e;">&gt;</span> 
    <span style="color:#6796e6;">*</span> rpc
   </div>
   <br>
   <div>
     ```
   </div>
   <div>
     function:调用rpc接口
   </div>
   <div>
     args:&lt;node&gt; &lt;method&gt; [&lt;args&gt;] [--subscribe]
   </div>
   <div>
     demo: node rpc node1 admin
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     　// TODO
   </div>
   <br>
   <div>
     ```
   </div>
   <div>
    <span style="color:rgb(86,156,214);"><strong>### cmd包下的geth子包主函数启动的各个子命令解析</strong></span>
   </div>
  </div>
  <p></p>
  <div style="color:rgb(212,212,212);background-color:rgb(30,30,30);font-family:Consolas, 'Courier New', monospace;font-size:14px;line-height:19px;">
   <br>
   <div>
    <span style="color:#569cd6;"><strong>#### /geth</strong></span>
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__init__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:导入创世块的json,以指定的json作为创世块
   </div>
   <div>
     args:&lt;genesisPath&gt;
   </div>
   <div>
     demo: init /home/yujian/eth-go/genesis.json
   </div>
   <div>
     notice:ethereum默认创建路径为home目录的.ethereum,如果该目录下已经写入过创世快，会执行失败
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     WARN [01-16|10:25:12] No etherbase set and no accounts found as default
   </div>
   <div>
     INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=16 handles=16
   </div>
   <div>
     INFO [01-16|10:25:12] Writing custom genesis block
   </div>
   <div>
     INFO [01-16|10:25:12] Successfully wrote genesis state database=chaindata hash=bf2891…ad1419
   </div>
   <div>
     INFO [01-16|10:25:12] Allocated cache and file handles database=/home/yujian/.ethereum/geth/lightchaindata cache=16 handles=16
   </div>
   <div>
     INFO [01-16|10:25:12] Writing custom genesis block
   </div>
   <div>
     INFO [01-16|10:25:12] Successfully wrote genesis state database=lightchaindata hash=bf2891…ad1419
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__import__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:导入区块数据到当前运行的链中
   </div>
   <div>
     args:&lt;filename&gt; (&lt;filename 2&gt; ... &lt;filename N&gt;)
   </div>
   <div>
     demo: import /home/yujian/eth-block.txt
   </div>
   <div>
     notice:如果导入的文件只要一个是错误的，那么会失败，如果有多个文件错误，那么程序会继续执行忽略错误的．
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     WARN [01-16|11:00:32] No etherbase set and no accounts found as default
   </div>
   <div>
     INFO [01-16|11:00:32] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024
   </div>
   <div>
     Import done in 306.866µs.
   </div>
   <br>
   <div>
     INFO [01-16|11:00:32] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3
   </div>
   <div>
     Compactions
   </div>
   <div>
     INFO [01-16|11:00:32] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2
   </div>
   <div>
     Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB)
   </div>
   <div>
     -------+------------+---------------+---------------+---------------+---------------
   </div>
   <div>
     INFO [01-16|11:00:32] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     0 | 3 | 0.00094 | 0.00000 | 0.00000 | 0.00000
   </div>
   <div>
     INFO [01-16|11:00:32] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <br>
   <div>
     Trie cache misses: 0
   </div>
   <div>
     INFO [01-16|11:00:32] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     Trie cache unloads: 0
   </div>
   <br>
   <div>
     INFO [01-16|11:00:32] Importing blockchain file=/home/yujian/eth-block.txt
   </div>
   <div>
     Object memory: 34.677 MB current, 34.670 MB peak
   </div>
   <div>
     System memory: 74.100 MB current, 73.850 MB peak
   </div>
   <div>
     Allocations: 0.015 million
   </div>
   <div>
     GC pause: 10.454997ms
   </div>
   <br>
   <div>
     Compacting entire database...
   </div>
   <div>
     INFO [01-16|11:00:33] Database closed database=/home/yujian/.ethereum/geth/chaindata
   </div>
   <div>
     Compaction done in 64.422235ms.
   </div>
   <br>
   <div>
     Compactions
   </div>
   <div>
     Level | Tables | Size(MB) | Time(sec) | Read(MB) | Write(MB)
   </div>
   <div>
     -------+------------+---------------+---------------+---------------+---------------
   </div>
   <div>
     0 | 0 | 0.00000 | 0.00451 | 0.00000 | 0.00021
   </div>
   <div>
     1 | 1 | 0.00053 | 0.00435 | 0.00114 | 0.00053
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__export__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:导出区块数据到指定的文件
   </div>
   <div>
     args:&lt;filename&gt; [&lt;blockNumFirst&gt; &lt;blockNumLast&gt;]
   </div>
   <div>
     demo: export /home/yujian/eth-block.txt
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     WARN [01-16|10:51:36] No etherbase set and no accounts found as default
   </div>
   <div>
     INFO [01-16|10:51:36] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024
   </div>
   <div>
     INFO [01-16|10:51:36] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3
   </div>
   <div>
     INFO [01-16|10:51:36] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2
   </div>
   <div>
     Export done in 628.951µsINFO [01-16|10:51:36] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     INFO [01-16|10:51:36] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     INFO [01-16|10:51:36] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     INFO [01-16|10:51:36] Exporting blockchain file=/home/yujian/eth-block.txt
   </div>
   <div>
     INFO [01-16|10:51:36] Exporting batch of blocks count=1
   </div>
   <div>
     INFO [01-16|10:51:36] Exported blockchain file=/home/yujian/eth-block.txt
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__copydb__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:从存在的链数据文件夹中创建一条本地链
   </div>
   <div>
     args:&lt;sourceChaindataDir&gt;
   </div>
   <div>
     demo: copydb /home/yujian/eth-block.txt
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     WARN [01-16|11:35:55] No etherbase set and no accounts found as default
   </div>
   <div>
     INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024
   </div>
   <div>
     INFO [01-16|11:35:55] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3
   </div>
   <div>
     INFO [01-16|11:35:55] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2
   </div>
   <div>
     INFO [01-16|11:35:55] Loaded most recent local header number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     INFO [01-16|11:35:55] Loaded most recent local full block number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     INFO [01-16|11:35:55] Loaded most recent local fast block number=0 hash=bf2891…ad1419 td=33554432
   </div>
   <div>
     INFO [01-16|11:35:55] Allocated cache and file handles database=/home/yujian/eth-go/geth/chaindata cache=128 handles=256
   </div>
   <div>
     INFO [01-16|11:35:55] Block synchronisation started
   </div>
   <div>
     INFO [01-16|11:35:55] Imported new state entries count=1 elapsed=33.277µs processed=1 pending=0 retry=0 duplicate=0 unexpected=0
   </div>
   <div>
     INFO [01-16|11:35:56] Imported new block headers count=11 elapsed=1.276s number=11 hash=ec3374…59a2ba ignored=0
   </div>
   <div>
     Database copy done in 1.280940454s
   </div>
   <div>
     Compacting entire database...
   </div>
   <div>
     INFO [01-16|11:35:56] Imported new chain segment blocks=11 txs=0 mgas=0.000 elapsed=1.961ms mgasps=0.000 number=11 hash=ec3374…59a2ba
   </div>
   <div>
     Compaction done in 11.130389ms.
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__removedb__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:移除当前链的数据库
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: removedb
   </div>
   <div>
     notice:默认当前链的数据在home目录下的.ethereum目录下
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     WARN [01-16|11:48:09] No etherbase set and no accounts found as default
   </div>
   <div>
     /home/yujian/.ethereum/geth/chaindata
   </div>
   <div>
     Remove this database? [y/N] y
   </div>
   <div>
     /home/yujian/.ethereum/geth/lightchaindata
   </div>
   <div>
     INFO [01-16|11:48:19] Database successfully deleted database=chaindata elapsed=7.832ms
   </div>
   <div>
     Remove this database? [y/N] y
   </div>
   <div>
     INFO [01-16|11:48:27] Database successfully deleted database=lightchaindata elapsed=481.229µs
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__dump__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:转存指定的块
   </div>
   <div>
     args:[&lt;blockHash&gt; | &lt;blockNum&gt;]...
   </div>
   <div>
     demo: dump 0
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     "storage": {}
   </div>
   <div>
     },
   </div>
   <div>
     "af3cb5965933e7dad883693b9c3e15beb68a4873": {
   </div>
   <div>
     "balance": "2000000000000000000000",
   </div>
   <div>
     "nonce": 0,
   </div>
   <div>
     "root": "56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
   </div>
   <div>
     "codeHash": "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",
   </div>
   <div>
     "code": "",
   </div>
   <div>
     "storage": {}
   </div>
   <div>
     },
   </div>
   <div>
     "af4493e8521ca89d95f5267c1ab63f9f45411e1b": {
   </div>
   <div>
     "balance": "200000000000000000000",
   </div>
   <div>
     "nonce": 0,
   </div>
   <div>
     "root": "56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
   </div>
   <div>
     "codeHash": "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",
   </div>
   <div>
     "code": "",
   </div>
   <div>
     "storage": {}
   </div>
   <div>
     },
   </div>
   <div>
     }
   </div>
   <div>
     }
   </div>
   <div>
     INFO [01-16|14:02:06] Database closed database=/home/yujian/.ethereum/geth/chaindata
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__monitor__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:监视和可视化节点指标
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: monitor
   </div>
   <div>
     notice:该命令本地未调通,需要先启链，才能调用该命令去看监控的状态
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     // TODO
   </div>
   <br>
   <br>
   <br>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__account__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:管理账户
   </div>
   <div>
     args:"[new|list|update|import]"
   </div>
   <div>
     demo: account new
   </div>
   <div>
     notice:“帐户导入”选项只能用于导入通用密钥文件
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     WARN [01-16|14:44:44] No etherbase set and no accounts found as default
   </div>
   <div>
     Your new account is locked with a password. Please give a password. Do not forget this password.
   </div>
   <div>
     !! Unsupported terminal, password will be echoed.
   </div>
   <div>
     Passphrase: 123456
   </div>
   <br>
   <div>
     Repeat passphrase: 123456
   </div>
   <br>
   <div>
     Address: {2a23e9223d7af9c56f5abd0c8226021b51c98cbc}
   </div>
   <br>
   <div>
     Process finished with exit code 0
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__wallet__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:导入预付款钱包(一般用不到，用的是account功能)
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: wallet import
   </div>
   <div>
     notice:"钱包导入"选项只能用于导入预售钱包
   </div>
   <div>
     success_result_demo:
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
    　　
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__console__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:开启一条私有链,并打开一个可视化的js钱包控制台
   </div>
   <div>
     args:""
   </div>
   <div>
     demo: console
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     INFO [01-16|15:26:13] Starting peer-to-peer node instance=Geth/v1.7.3-unstable/linux-amd64/go1.9.2
   </div>
   <div>
     INFO [01-16|15:26:13] Allocated cache and file handles database=/home/yujian/.ethereum/geth/chaindata cache=128 handles=1024
   </div>
   <div>
     INFO [01-16|15:26:14] Initialised chain configuration config="{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Engine: ethash}"
   </div>
   <div>
     INFO [01-16|15:26:14] Disk storage enabled for ethash caches dir=/home/yujian/.ethereum/geth/ethash count=3
   </div>
   <div>
     INFO [01-16|15:26:14] Disk storage enabled for ethash DAGs dir=/home/yujian/.ethash count=2
   </div>
   <div>
     INFO [01-16|15:26:14] Initialising Ethereum protocol versions="[63 62]" network=1
   </div>
   <div>
     INFO [01-16|15:26:14] Loaded most recent local header number=1127484 hash=ae7ee2…52ae4c td=8985161313979839462
   </div>
   <div>
     INFO [01-16|15:26:14] Loaded most recent local full block number=0 hash=d4e567…cb8fa3 td=17179869184
   </div>
   <div>
     INFO [01-16|15:26:14] Loaded most recent local fast block number=1092806 hash=6e839a…2eb127 td=8395031237882431385
   </div>
   <div>
     INFO [01-16|15:26:14] Upgrading chain index type=bloombits percentage=80
   </div>
   <div>
     INFO [01-16|15:26:14] Loaded local transaction journal transactions=0 dropped=0
   </div>
   <div>
     INFO [01-16|15:26:14] Regenerated local transaction journal transactions=0 accounts=0
   </div>
   <div>
     INFO [01-16|15:26:14] Starting P2P networking
   </div>
   <div>
     INFO [01-16|15:26:16] UDP listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303
   </div>
   <div>
     INFO [01-16|15:26:16] RLPx listener up self=enode://bef014afb2b63c749d1e3917a25dc9e508cb67e6010965f11695beef50c29f40a5949fc2082487fadb262c30ff2fb626ce86d4a7cf994d025f5dfee7231051e6@[::]:30303
   </div>
   <div>
     INFO [01-16|15:26:16] IPC endpoint opened: /home/yujian/.ethereum/geth.ipc
   </div>
   <div>
     Welcome to the Geth JavaScript console!
   </div>
   <br>
   <div>
     instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2
   </div>
   <div>
     coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc
   </div>
   <div>
     at block: 0 (Thu, 01 Jan 1970 08:00:00 CST)
   </div>
   <div>
     datadir: /home/yujian/.ethereum
   </div>
   <div>
     modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__attach__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     function:打开一个可视化的js钱包控制台(连接到一个指定的链)
   </div>
   <div>
     args:
   </div>
   <div>
     --jspath loadScript JavaScript root path for loadScript (default: ".")
   </div>
   <div>
     --exec value Execute JavaScript statement
   </div>
   <div>
     --preload value Comma separated list of JavaScript files to preload into the console
   </div>
   <div>
     --datadir "/root/.ethereum" Data directory for the databases and keystore
   </div>
   <div>
     demo:attach --datadir="/home/yujian/.ethereum/geth.ipc"
   </div>
   <div>
     notice:必须启动一条本地链，这样才能连接过去
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Welcome to the Geth JavaScript console!
   </div>
   <br>
   <div>
     instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2
   </div>
   <div>
     coinbase: 0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc
   </div>
   <div>
     at block: 0 (Thu, 01 Jan 1970 08:00:00 CST)
   </div>
   <div>
     datadir: /home/yujian/.ethereum
   </div>
   <div>
     modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__js__</strong></span>
   </div>
   <div>
    ```
   </div>
   <div>
     　function:执行指定的js文件
   </div>
   <div>
     args:&lt;jsfile&gt; [jsfile...]
   </div>
   <div>
     demo:js
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <br>
   <br>
   <br>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__makecache__</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     function:生成ethhash验证缓存(测试使用)
   </div>
   <div>
     args:&lt;blockNum&gt; &lt;outputDir&gt;
   </div>
   <div>
     demo:makecache 0 /home/yujian/
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     在对应的输出目录，将会生成一个cache文件,如 cache-R23-0000000000000000
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__makedag__</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     function:生成ethhash mining dag(测试使用)
   </div>
   <div>
     args:&lt;blockNum&gt; &lt;outputDir&gt;
   </div>
   <div>
     demo:makedag 0 /home/yujian/
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     INFO [01-16|17:50:36] Generating DAG in progress epoch=0 percentage=92 elapsed=3m2.525s
   </div>
   <div>
     INFO [01-16|17:50:38] Generating DAG in progress epoch=0 percentage=93 elapsed=3m4.338s
   </div>
   <div>
     INFO [01-16|17:50:40] Generating DAG in progress epoch=0 percentage=94 elapsed=3m6.058s
   </div>
   <div>
     INFO [01-16|17:50:41] Generating DAG in progress epoch=0 percentage=95 elapsed=3m7.795s
   </div>
   <div>
     INFO [01-16|17:50:43] Generating DAG in progress epoch=0 percentage=96 elapsed=3m9.542s
   </div>
   <div>
     INFO [01-16|17:50:45] Generating DAG in progress epoch=0 percentage=97 elapsed=3m11.380s
   </div>
   <div>
     INFO [01-16|17:50:47] Generating DAG in progress epoch=0 percentage=98 elapsed=3m13.129s
   </div>
   <div>
     INFO [01-16|17:50:49] Generating DAG in progress epoch=0 percentage=99 elapsed=3m15.303s
   </div>
   <div>
     INFO [01-16|17:50:49] Generated ethash verification cache epoch=0 elapsed=3m15.306s
   </div>
   <br>
   <div>
     Process finished with exit code 0
   </div>
   <br>
   <div>
     在对应的输出目录,将会生成一个full文件,如 full-R23-0000000000000000
   </div>
   <br>
   <br>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__version__</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     function:打印版本数据
   </div>
   <div>
     args:""
   </div>
   <div>
     demo:version
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Geth
   </div>
   <div>
     Version: 1.7.3-unstable
   </div>
   <div>
     Architecture: amd64
   </div>
   <div>
     Protocol Versions: [63 62]
   </div>
   <div>
     Network Id: 1
   </div>
   <div>
     Go Version: go1.9.2
   </div>
   <div>
     Operating System: linux
   </div>
   <div>
     GOPATH=/home/yujian/blockchain-workspace/go-project
   </div>
   <div>
     GOROOT=/usr/local/go
   </div>
   <div>
     　　
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__bug__</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     function:打开一个窗口,直接跳转到ethereum的github仓库的issue
   </div>
   <div>
     args:""
   </div>
   <div>
     demo:bug
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     　　运行后会自动打开浏览器，跳转到ethereum的issue编辑页面　
   </div>
   <br>
   <br>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__license__</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     function:显示geth的license信息
   </div>
   <div>
     args:""
   </div>
   <div>
     demo:license
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     Geth is free software: you can redistribute it and/or modify
   </div>
   <div>
     it under the terms of the GNU General Public License as published by
   </div>
   <div>
     the Free Software Foundation, either version 3 of the License, or
   </div>
   <div>
     (at your option) any later version.
   </div>
   <br>
   <div>
     Geth is distributed in the hope that it will be useful,
   </div>
   <div>
     but WITHOUT ANY WARRANTY; without even the implied warranty of
   </div>
   <div>
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
   </div>
   <div>
     GNU General Public License for more details.
   </div>
   <br>
   <div>
     You should have received a copy of the GNU General Public License
   </div>
   <div>
     along with geth. If not, see &lt;http://www.gnu.org/licenses/&gt;.
   </div>
   <div>
    ```
   </div>
   <br>
   <div>
    <span style="color:#6796e6;">*</span> 
    <span style="color:#569cd6;"><strong>__dumpconfig__</strong></span>
   </div>
   <br>
   <div>
    ```
   </div>
   <div>
     function:显示配置信息
   </div>
   <div>
     args:""
   </div>
   <div>
     demo:dumpconfig
   </div>
   <div>
     notice:
   </div>
   <div>
     success_result_demo:
   </div>
   <div>
     　[Eth]
   </div>
   <div>
     NetworkId = 1
   </div>
   <div>
     SyncMode = "fast"
   </div>
   <div>
     LightPeers = 20
   </div>
   <div>
     DatabaseCache = 128
   </div>
   <div>
     Etherbase = "0x2a23e9223d7af9c56f5abd0c8226021b51c98cbc"
   </div>
   <div>
     GasPrice = 18000000000
   </div>
   <div>
     EthashCacheDir = "ethash"
   </div>
   <div>
     EthashCachesInMem = 2
   </div>
   <div>
     EthashCachesOnDisk = 3
   </div>
   <div>
     EthashDatasetDir = "/home/yujian/.ethash"
   </div>
   <div>
     EthashDatasetsInMem = 1
   </div>
   <div>
     EthashDatasetsOnDisk = 2
   </div>
   <div>
     EnablePreimageRecording = false
   </div>
   <br>
   <div>
     [Eth.TxPool]
   </div>
   <div>
     NoLocals = false
   </div>
   <div>
     Journal = "transactions.rlp"
   </div>
   <div>
     Rejournal = 3600000000000
   </div>
   <div>
     PriceLimit = 1
   </div>
   <div>
     PriceBump = 10
   </div>
   <div>
     AccountSlots = 16
   </div>
   <div>
     GlobalSlots = 4096
   </div>
   <div>
     AccountQueue = 64
   </div>
   <div>
     GlobalQueue = 1024
   </div>
   <div>
     Lifetime = 10800000000000
   </div>
   <br>
   <div>
     [Eth.GPO]
   </div>
   <div>
     Blocks = 10
   </div>
   <div>
     Percentile = 50
   </div>
   <br>
   <div>
     [Shh]
   </div>
   <div>
     MaxMessageSize = 1048576
   </div>
   <div>
     MinimumAcceptedPOW = 2e-01
   </div>
   <br>
   <div>
     [Node]
   </div>
   <div>
     DataDir = "/home/yujian/.ethereum"
   </div>
   <div>
     IPCPath = "geth.ipc"
   </div>
   <div>
     HTTPPort = 8545
   </div>
   <div>
     HTTPModules = ["net", "web3", "eth", "shh"]
   </div>
   <div>
     WSPort = 8546
   </div>
   <div>
     WSModules = ["net", "web3", "eth", "shh"]
   </div>
   <br>
   <div>
     [Node.P2P]
   </div>
   <div>
     MaxPeers = 25
   </div>
   <div>
     NoDiscovery = false
   </div>
   <div>
     DiscoveryV5Addr = ":30304"
   </div>
   <div>
     BootstrapNodes = ["enode://a979fb575495b8d6db44f750317d0f4622bf4c2aa3365d6af7c284339968eef29b69ad0dce72a4d8db5ebb4968de0e3bec910127f134779fbcb0cb6d3331163c@52.16.188.185:30303", "enode://3f1d12044546b76342d59d4a05532c14b85aa669704bfe1f864fe079415aa2c02d743e03218e57a33fb94523adb54032871a6c51b2cc5514cb7c7e35b3ed0a99@13.93.211.84:30303", "enode://78de8a0916848093c73790ead81d1928bec737d565119932b98c6b100d944b7a95e94f847f689fc723399d2e31129d182f7ef3863f2b4c820abbf3ab2722344d@191.235.84.50:30303", "enode://158f8aab45f6d19c6cbf4a089c2670541a8da11978a2f90dbf6a502a4a3bab80d288afdbeb7ec0ef6d92de563767f3b1ea9e8e334ca711e9f8e2df5a0385e8e6@13.75.154.138:30303", "enode://1118980bf48b0a3640bdba04e0fe78b1add18e1cd99bf22d53daac1fd9972ad650df52176e7c7d89d1114cfef2bc23a2959aa54998a46afcf7d91809f0855082@52.74.57.123:30303", "enode://979b7fa28feeb35a4741660a16076f1943202cb72b6af70d327f053e248bab9ba81760f39d0701ef1d8f89cc1fbd2cacba0710a12cd5314d5e0c9021aa3637f9@5.1.83.226:30303"]
   </div>
   <div>
     BootstrapNodesV5 = ["enode://0cc5f5ffb5d9098c8b8c62325f3797f56509bff942704687b6530992ac706e2cb946b90a34f1f19548cd3c7baccbcaea354531e5983c7d1bc0dee16ce4b6440b@40.118.3.223:30305", "enode://1c7a64d76c0334b0418c004af2f67c50e36a3be60b5e4790bdac0439d21603469a85fad36f2473c9a80eb043ae60936df905fa28f1ff614c3e5dc34f15dcd2dc@40.118.3.223:30308", "enode://85c85d7143ae8bb96924f2b54f1b3e70d8c4d367af305325d30a61385a432f247d2c75c45c6b4a60335060d072d7f5b35dd1d4c45f76941f62a4f83b6e75daaf@40.118.3.223:30309"]
   </div>
   <div>
     StaticNodes = []
   </div>
   <div>
     TrustedNodes = []
   </div>
   <div>
     ListenAddr = ":30303"
   </div>
   <div>
     EnableMsgEvents = false
   </div>
   <br>
   <div>
     [Dashboard]
   </div>
   <div>
     Host = "localhost"
   </div>
   <div>
     Port = 8080
   </div>
   <div>
     Refresh = 3000000000　
   </div>
   <div>
    ```
   </div>
   <br>
   <br>
   <div>
    <span style="color:#569cd6;"><strong>##### 参考资料</strong></span>
   </div>
   <div> 
    <span style="color:#6796e6;">*</span> [
    <span style="color:#ce9178;">eth钱包创建</span>](
    <span>https://www.myetherwallet.com/#generate-wallet</span>)
   </div>
   <div> 
    <span style="color:#6796e6;">*</span> [
    <span style="color:#ce9178;">eth命令使用解释</span>](
    <span>http://www.blockcode.org/archives/185</span>)
   </div>
   <br>
   <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180430235043561?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
   <p><br><br></p>
   <h2><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180430224554793?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br><br></h2>
   <p style="color:rgb(25,25,25);"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180425001235188?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180425001144107?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
   <p style="color:rgb(25,25,25);">网址：http://www.qukuailianxueyuan.io/<br></p>
   <p style="color:rgb(25,25,25);"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180426145827720?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
   <p style="color:rgb(25,25,25);"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/2018042614570887?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
   <p style="color:rgb(25,25,25);">欲领取造币技术与全套虚拟机资料</p>
   <p><span style="color:rgb(25,25,25);">区块链技术交流QQ群：</span><span style="color:rgb(255,0,0);background-color:rgb(255,255,255);">756146052&nbsp;&nbsp;</span><span style="color:rgb(25,25,25);">备注：CSDN</span></p>
   <p style="color:rgb(25,25,25);">尹成学院微信：备注：CSDN</p>
   <p style="color:rgb(25,25,25);text-align:center;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180425000635656?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></p>
   <div>
    <br>
   </div>
   <br>
   <br>
  </div>
  <br> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/itcastcpp/article/details/80304314,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/itcastcpp/article/details/80304314,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
