<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>如何编写智能合约之一：智能合约编写、编译以及部署 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="如何编写智能合约之一：智能合约编写、编译以及部署" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="开发环境配置 安装truffle. 在命令行下执行(已经有npm环境) MacBook-Pro:~ zhi$ npm install -g truffle /usr/local/bin/truffle -&gt; /usr/local/lib/node_modules/truffle/build/cli.bundled.js /usr/local/lib └── truffle@4.0.4 使用truffle命令查看版本信息 MacBook-Pro:~ zhi$ truffle version Truffle v4.0.4 (core: 4.0.4) Solidity v0.4.18 (solc-js) 使用truffle初始化一个测试项目 MacBook-Pro:~ zhi$ mkdir -p ~/Ethereum/demo1 MacBook-Pro:~ zhi$ cd ~/Ethereum/demo1 MacBook-Pro:~ zhi$ truffle init Downloading... Unpacking... Setting up... Unbox successful. Sweet! Commands: Compile: truffle compile Migrate: truffle migrate Test contracts: truffle test 初始化之后，所在文件夹下会创建一些文件夹以及文件： |—contracts 用于存放合约的文件夹，我们添加的合约都放在这里 |—migrations 指导合约编译的文件 |————-1_initial_migration.js |————-2_initial_hello.js |—test 测试目录 |—truffle-config.js 配置文件 |—truffle.js 创建Hello.sol合约文件，并保存在truffle初始化后的contracts文件夹中。文件内容： pragma solidity ^0.4.18; contract Hello{ function test() pure public returns (string){ return &quot;It is test!&quot;; } function test1() pure public returns (string){ return &quot;test1!&quot;; } function echo(string s) pure public returns (string){ return s; } } 进入命令行编译以及部署操作 进入truffle命令行，执行truffle develop命令 MacBook-Pro:~ zhi$ truffle develop Truffle Develop started at http://localhost:9545/ Accounts: (0) 0x627306090abab3a6e1400e9345bc60c78a8bef57 (1) 0xf17f52151ebef6c7334fad080c5704d77216b732 (2) 0xc5fdf4076b8f3a5357c5e395ab970b5b54098fef (3) 0x821aea9a577a9b44299b9c15c88cf3087f3b5544 (4) 0x0d1d4e623d10f9fba5db95830f7d3839406c6af2 (5) 0x2932b7a2355d6fecc4b5c0b6bd44cc31df247a2e (6) 0x2191ef87e392377ec08e7c08eb105ef5448eced5 (7) 0x0f4f2ac550a1b4e2280d04c21cea7ebd822934b5 (8) 0x6330a553fc93768f612722bb8c2ec78ac90b3bbc (9) 0x5aeda56215b167893e80b4fe645ba6d5bab767de Private Keys: (0) c87509a1c067bbde78beb793e6fa76530b6382a4c0241e5e4a9ec0a0f44dc0d3 (1) ae6ae8e5ccbfb04590405997ee2d52d2b330726137b875053c36d94e974d162f (2) 0dbbe8e4ae425a6d2687f1a7e3ba17bc98c673636790f1b8ad91193c05875ef1 (3) c88b703fb08cbea894b6aeff5a544fb92e78a18e19814cd85da83b71f772aa6c (4) 388c684f0ba1ef5017716adb5d21a053ea8e90277d0868337519f97bede61418 (5) 659cbb0e2411a44db63778987b1e22153c086a95eb6b18bdf89de078917abc63 (6) 82d052c865f5763aad42add438569276c00d3d88a2d062d36b2bae914d58b8c8 (7) aa3680d5d48a8283413f7a108367c7299ca73f553735860a87b08f39395618b7 (8) 0f62d96d6675f32685bbdb8ac13cda7c23436f63efbb9d07700d8669ff12b7c4 (9) 8d5366123cb560bb606379f90a0bfd4769eecc0557f1b362dcae9012b548b1e5 Mnemonic: candy maple cake sugar pudding cream honey rich smooth crumble sweet treat 编译，执行命令compile： truffle(develop)&gt; compile Compiling ./contracts/Hello.sol... Compiling ./contracts/Migrations.sol... Writing artifacts to ./build/contracts 部署，执行命令migrate truffle(develop)&gt; migrate Using network &#39;develop&#39;. Running migration: 1_initial_migration.js Deploying Migrations... ... 0x058f644af8801388e6a6116ea00c163645dfc1c8636e096e6ed11cdd0d2e8c54 Migrations: 0x8cdaf0cd259887258bc13a92c0a6da92698644c0 Saving successful migration to network... ... 0xd7bc86d31bee32fa3988f1c1eabce403a1b5d570340a3a9cdba53a472ee8c956 Saving artifacts... Running migration: 2_initial_migration.js Deploying Hello... ... 0x93b1578047b7db49016168b1d0e480218d552fa7e5b53f1d81cc0e00f567239b Hello: 0x345ca3e014aaf5dca488057592ee47305d9b3e10 Saving successful migration to network... ... 0xf36163615f41ef7ed8f4a8f192149a0bf633fe1a2398ce001bf44c43dc7bdda0 Saving artifacts... 如果之前部署过，在执行命令后，可能不是出现上面的信息，而是出现 Using network &#39;develop&#39;. Network up to date. 表示的是，合约没有过期，这次部署没有成功。此时需要在部署命令后添加一个reset参数即可部署成功。完整命令migrate --reset 获取合约实例。将合约实例赋值给contract变量，执行命令Hello.deployed().then(instance =&gt; contract = instance) truffle(develop)&gt; let contract; undefined truffle(develop)&gt; Hello.deployed().then(instance =&gt; contract = instance) TruffleContract { constructor: { [Function: TruffleContract] _static_methods: { setProvider: [Function: setProvider], new: [Function: new], at: [Function: at], deployed: [Function: deployed], defaults: [Function: defaults], hasNetwork: [Function: hasNetwork], isDeployed: [Function: isDeployed], detectNetwork: [Function: detectNetwork], setNetwork: [Function: setNetwork], resetAddress: [Function: resetAddress], link: [Function: link], clone: [Function: clone], addProp: [Function: addProp], toJSON: [Function: toJSON] }, _properties: { contract_name: [Object], contractName: [Object], abi: [Object], network: [Function: network], networks: [Function: networks], address: [Object], links: [Function: links], events: [Function: events], binary: [Function: binary], deployedBinary: [Function: deployedBinary], unlinked_binary: [Object], bytecode: [Object], deployedBytecode: [Object], sourceMap: [Object], deployedSourceMap: [Object], source: [Object], sourcePath: [Object], ast: [Object], compiler: [Object], schema_version: [Function: schema_version], schemaVersion: [Function: schemaVersion], updated_at: [Function: updated_at], updatedAt: [Function: updatedAt] }, _property_values: {}, _json: { contractName: &#39;Hello&#39;, abi: [Object], bytecode: &#39;0x6060604052341561000f57600080fd5b6103248061001e6000396000f300606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029&#39;, deployedBytecode: &#39;0x606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029&#39;, sourceMap: &#39;26:249:0:-;;;;;;;;;;;;;;;;;&#39;, deployedSourceMap: &#39;26:249:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;201:71:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;45:75:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73:0;162:6;;:::i;:::-;175:17;;;;;;;;;;;;;;;;;;;;124:73;:::o;201:71::-;246:6;;:::i;:::-;266:1;259:8;;201:71;;;:::o;45:75::-;82:6;;:::i;:::-;95:20;;;;;;;;;;;;;;;;;;;;45:75;:::o;26:249::-;;;;;;;;;;;;;;;:::o&#39;, source: &#39;pragma solidity ^0.4.18;\n\ncontract Hello{\n\n function test() pure public returns (string){\n return &quot;It is test!&quot;;\n }\n\n function test1() pure public returns (string){\n return &quot;No pure!&quot;;\n }\n\n function echo(string s) pure public returns (string){\n return s;\n }\n\n}\n&#39;, sourcePath: &#39;/Users/ zhi/Ethereum/demo1/contracts/Hello.sol&#39;, ast: [Object], compiler: [Object], networks: [Object], schemaVersion: &#39;1.0.1&#39;, updatedAt: &#39;2018-01-11T08:33:44.367Z&#39; }, setProvider: [Function: bound setProvider], new: [Function: bound new], at: [Function: bound at], deployed: [Function: bound deployed], defaults: [Function: bound defaults], hasNetwork: [Function: bound hasNetwork], isDeployed: [Function: bound isDeployed], detectNetwork: [Function: bound detectNetwork], setNetwork: [Function: bound setNetwork], resetAddress: [Function: bound resetAddress], link: [Function: bound link], clone: [Function: bound clone], addProp: [Function: bound addProp], toJSON: [Function: bound toJSON], web3: Web3 { _requestManager: [Object], currentProvider: [Object], eth: [Object], db: [Object], shh: [Object], net: [Object], personal: [Object], bzz: [Object], settings: [Object], version: [Object], providers: [Object], _extend: [Object] }, class_defaults: { from: &#39;0x627306090abab3a6e1400e9345bc60c78a8bef57&#39;, gas: 6721975, gasPrice: 100000000000 }, currentProvider: HttpProvider { host: &#39;http://localhost:9545/&#39;, timeout: 0, user: undefined, password: undefined, send: [Function], sendAsync: [Function], _alreadyWrapped: true }, network_id: &#39;4447&#39; }, abi: [ { constant: true, inputs: [], name: &#39;test1&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; }, { constant: true, inputs: [Object], name: &#39;echo&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; }, { constant: true, inputs: [], name: &#39;test&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; } ], contract: Contract { _eth: Eth { _requestManager: [Object], getBalance: [Object], getStorageAt: [Object], getCode: [Object], getBlock: [Object], getUncle: [Object], getCompilers: [Object], getBlockTransactionCount: [Object], getBlockUncleCount: [Object], getTransaction: [Object], getTransactionFromBlock: [Object], getTransactionReceipt: [Object], getTransactionCount: [Object], call: [Object], estimateGas: [Object], sendRawTransaction: [Object], signTransaction: [Object], sendTransaction: [Object], sign: [Object], compile: [Object], submitWork: [Object], getWork: [Object], coinbase: [Getter], getCoinbase: [Object], mining: [Getter], getMining: [Object], hashrate: [Getter], getHashrate: [Object], syncing: [Getter], getSyncing: [Object], gasPrice: [Getter], getGasPrice: [Object], accounts: [Getter], getAccounts: [Object], blockNumber: [Getter], getBlockNumber: [Object], protocolVersion: [Getter], getProtocolVersion: [Object], iban: [Object], sendIBANTransaction: [Function: bound transfer] }, transactionHash: null, address: &#39;0x345ca3e014aaf5dca488057592ee47305d9b3e10&#39;, abi: [ [Object], [Object], [Object] ], test1: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], &#39;&#39;: [Circular] }, echo: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], string: [Circular] }, test: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], &#39;&#39;: [Circular] }, allEvents: [Function: bound ] }, test1: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, echo: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, test: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, sendTransaction: [Function], send: [Function], allEvents: [Function: bound ], address: &#39;0x345ca3e014aaf5dca488057592ee47305d9b3e10&#39;, transactionHash: null } 执行了上面命令后，就可以通过contract变量来调用合约。要调用合约中的方法只需要contract.method()，比如要调用Hello合约中的test方法,执行： truffle(develop)&gt; contract.test(); &#39;It is test!&#39; PS：这里调用的test方法使用pure进行了修饰，所以可以直接调用。如果没有使用pure进行修饰，那么调用这个test方法，就只能通过call来调用：contract.test.call() 到这里，这个只能合约就编写、编译并部署完成了！ 参考： 黎跃春 —— 如何编写智能合约(Smart Contract) 阅读更多" />
<meta property="og:description" content="开发环境配置 安装truffle. 在命令行下执行(已经有npm环境) MacBook-Pro:~ zhi$ npm install -g truffle /usr/local/bin/truffle -&gt; /usr/local/lib/node_modules/truffle/build/cli.bundled.js /usr/local/lib └── truffle@4.0.4 使用truffle命令查看版本信息 MacBook-Pro:~ zhi$ truffle version Truffle v4.0.4 (core: 4.0.4) Solidity v0.4.18 (solc-js) 使用truffle初始化一个测试项目 MacBook-Pro:~ zhi$ mkdir -p ~/Ethereum/demo1 MacBook-Pro:~ zhi$ cd ~/Ethereum/demo1 MacBook-Pro:~ zhi$ truffle init Downloading... Unpacking... Setting up... Unbox successful. Sweet! Commands: Compile: truffle compile Migrate: truffle migrate Test contracts: truffle test 初始化之后，所在文件夹下会创建一些文件夹以及文件： |—contracts 用于存放合约的文件夹，我们添加的合约都放在这里 |—migrations 指导合约编译的文件 |————-1_initial_migration.js |————-2_initial_hello.js |—test 测试目录 |—truffle-config.js 配置文件 |—truffle.js 创建Hello.sol合约文件，并保存在truffle初始化后的contracts文件夹中。文件内容： pragma solidity ^0.4.18; contract Hello{ function test() pure public returns (string){ return &quot;It is test!&quot;; } function test1() pure public returns (string){ return &quot;test1!&quot;; } function echo(string s) pure public returns (string){ return s; } } 进入命令行编译以及部署操作 进入truffle命令行，执行truffle develop命令 MacBook-Pro:~ zhi$ truffle develop Truffle Develop started at http://localhost:9545/ Accounts: (0) 0x627306090abab3a6e1400e9345bc60c78a8bef57 (1) 0xf17f52151ebef6c7334fad080c5704d77216b732 (2) 0xc5fdf4076b8f3a5357c5e395ab970b5b54098fef (3) 0x821aea9a577a9b44299b9c15c88cf3087f3b5544 (4) 0x0d1d4e623d10f9fba5db95830f7d3839406c6af2 (5) 0x2932b7a2355d6fecc4b5c0b6bd44cc31df247a2e (6) 0x2191ef87e392377ec08e7c08eb105ef5448eced5 (7) 0x0f4f2ac550a1b4e2280d04c21cea7ebd822934b5 (8) 0x6330a553fc93768f612722bb8c2ec78ac90b3bbc (9) 0x5aeda56215b167893e80b4fe645ba6d5bab767de Private Keys: (0) c87509a1c067bbde78beb793e6fa76530b6382a4c0241e5e4a9ec0a0f44dc0d3 (1) ae6ae8e5ccbfb04590405997ee2d52d2b330726137b875053c36d94e974d162f (2) 0dbbe8e4ae425a6d2687f1a7e3ba17bc98c673636790f1b8ad91193c05875ef1 (3) c88b703fb08cbea894b6aeff5a544fb92e78a18e19814cd85da83b71f772aa6c (4) 388c684f0ba1ef5017716adb5d21a053ea8e90277d0868337519f97bede61418 (5) 659cbb0e2411a44db63778987b1e22153c086a95eb6b18bdf89de078917abc63 (6) 82d052c865f5763aad42add438569276c00d3d88a2d062d36b2bae914d58b8c8 (7) aa3680d5d48a8283413f7a108367c7299ca73f553735860a87b08f39395618b7 (8) 0f62d96d6675f32685bbdb8ac13cda7c23436f63efbb9d07700d8669ff12b7c4 (9) 8d5366123cb560bb606379f90a0bfd4769eecc0557f1b362dcae9012b548b1e5 Mnemonic: candy maple cake sugar pudding cream honey rich smooth crumble sweet treat 编译，执行命令compile： truffle(develop)&gt; compile Compiling ./contracts/Hello.sol... Compiling ./contracts/Migrations.sol... Writing artifacts to ./build/contracts 部署，执行命令migrate truffle(develop)&gt; migrate Using network &#39;develop&#39;. Running migration: 1_initial_migration.js Deploying Migrations... ... 0x058f644af8801388e6a6116ea00c163645dfc1c8636e096e6ed11cdd0d2e8c54 Migrations: 0x8cdaf0cd259887258bc13a92c0a6da92698644c0 Saving successful migration to network... ... 0xd7bc86d31bee32fa3988f1c1eabce403a1b5d570340a3a9cdba53a472ee8c956 Saving artifacts... Running migration: 2_initial_migration.js Deploying Hello... ... 0x93b1578047b7db49016168b1d0e480218d552fa7e5b53f1d81cc0e00f567239b Hello: 0x345ca3e014aaf5dca488057592ee47305d9b3e10 Saving successful migration to network... ... 0xf36163615f41ef7ed8f4a8f192149a0bf633fe1a2398ce001bf44c43dc7bdda0 Saving artifacts... 如果之前部署过，在执行命令后，可能不是出现上面的信息，而是出现 Using network &#39;develop&#39;. Network up to date. 表示的是，合约没有过期，这次部署没有成功。此时需要在部署命令后添加一个reset参数即可部署成功。完整命令migrate --reset 获取合约实例。将合约实例赋值给contract变量，执行命令Hello.deployed().then(instance =&gt; contract = instance) truffle(develop)&gt; let contract; undefined truffle(develop)&gt; Hello.deployed().then(instance =&gt; contract = instance) TruffleContract { constructor: { [Function: TruffleContract] _static_methods: { setProvider: [Function: setProvider], new: [Function: new], at: [Function: at], deployed: [Function: deployed], defaults: [Function: defaults], hasNetwork: [Function: hasNetwork], isDeployed: [Function: isDeployed], detectNetwork: [Function: detectNetwork], setNetwork: [Function: setNetwork], resetAddress: [Function: resetAddress], link: [Function: link], clone: [Function: clone], addProp: [Function: addProp], toJSON: [Function: toJSON] }, _properties: { contract_name: [Object], contractName: [Object], abi: [Object], network: [Function: network], networks: [Function: networks], address: [Object], links: [Function: links], events: [Function: events], binary: [Function: binary], deployedBinary: [Function: deployedBinary], unlinked_binary: [Object], bytecode: [Object], deployedBytecode: [Object], sourceMap: [Object], deployedSourceMap: [Object], source: [Object], sourcePath: [Object], ast: [Object], compiler: [Object], schema_version: [Function: schema_version], schemaVersion: [Function: schemaVersion], updated_at: [Function: updated_at], updatedAt: [Function: updatedAt] }, _property_values: {}, _json: { contractName: &#39;Hello&#39;, abi: [Object], bytecode: &#39;0x6060604052341561000f57600080fd5b6103248061001e6000396000f300606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029&#39;, deployedBytecode: &#39;0x606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029&#39;, sourceMap: &#39;26:249:0:-;;;;;;;;;;;;;;;;;&#39;, deployedSourceMap: &#39;26:249:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;201:71:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;45:75:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73:0;162:6;;:::i;:::-;175:17;;;;;;;;;;;;;;;;;;;;124:73;:::o;201:71::-;246:6;;:::i;:::-;266:1;259:8;;201:71;;;:::o;45:75::-;82:6;;:::i;:::-;95:20;;;;;;;;;;;;;;;;;;;;45:75;:::o;26:249::-;;;;;;;;;;;;;;;:::o&#39;, source: &#39;pragma solidity ^0.4.18;\n\ncontract Hello{\n\n function test() pure public returns (string){\n return &quot;It is test!&quot;;\n }\n\n function test1() pure public returns (string){\n return &quot;No pure!&quot;;\n }\n\n function echo(string s) pure public returns (string){\n return s;\n }\n\n}\n&#39;, sourcePath: &#39;/Users/ zhi/Ethereum/demo1/contracts/Hello.sol&#39;, ast: [Object], compiler: [Object], networks: [Object], schemaVersion: &#39;1.0.1&#39;, updatedAt: &#39;2018-01-11T08:33:44.367Z&#39; }, setProvider: [Function: bound setProvider], new: [Function: bound new], at: [Function: bound at], deployed: [Function: bound deployed], defaults: [Function: bound defaults], hasNetwork: [Function: bound hasNetwork], isDeployed: [Function: bound isDeployed], detectNetwork: [Function: bound detectNetwork], setNetwork: [Function: bound setNetwork], resetAddress: [Function: bound resetAddress], link: [Function: bound link], clone: [Function: bound clone], addProp: [Function: bound addProp], toJSON: [Function: bound toJSON], web3: Web3 { _requestManager: [Object], currentProvider: [Object], eth: [Object], db: [Object], shh: [Object], net: [Object], personal: [Object], bzz: [Object], settings: [Object], version: [Object], providers: [Object], _extend: [Object] }, class_defaults: { from: &#39;0x627306090abab3a6e1400e9345bc60c78a8bef57&#39;, gas: 6721975, gasPrice: 100000000000 }, currentProvider: HttpProvider { host: &#39;http://localhost:9545/&#39;, timeout: 0, user: undefined, password: undefined, send: [Function], sendAsync: [Function], _alreadyWrapped: true }, network_id: &#39;4447&#39; }, abi: [ { constant: true, inputs: [], name: &#39;test1&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; }, { constant: true, inputs: [Object], name: &#39;echo&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; }, { constant: true, inputs: [], name: &#39;test&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; } ], contract: Contract { _eth: Eth { _requestManager: [Object], getBalance: [Object], getStorageAt: [Object], getCode: [Object], getBlock: [Object], getUncle: [Object], getCompilers: [Object], getBlockTransactionCount: [Object], getBlockUncleCount: [Object], getTransaction: [Object], getTransactionFromBlock: [Object], getTransactionReceipt: [Object], getTransactionCount: [Object], call: [Object], estimateGas: [Object], sendRawTransaction: [Object], signTransaction: [Object], sendTransaction: [Object], sign: [Object], compile: [Object], submitWork: [Object], getWork: [Object], coinbase: [Getter], getCoinbase: [Object], mining: [Getter], getMining: [Object], hashrate: [Getter], getHashrate: [Object], syncing: [Getter], getSyncing: [Object], gasPrice: [Getter], getGasPrice: [Object], accounts: [Getter], getAccounts: [Object], blockNumber: [Getter], getBlockNumber: [Object], protocolVersion: [Getter], getProtocolVersion: [Object], iban: [Object], sendIBANTransaction: [Function: bound transfer] }, transactionHash: null, address: &#39;0x345ca3e014aaf5dca488057592ee47305d9b3e10&#39;, abi: [ [Object], [Object], [Object] ], test1: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], &#39;&#39;: [Circular] }, echo: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], string: [Circular] }, test: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], &#39;&#39;: [Circular] }, allEvents: [Function: bound ] }, test1: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, echo: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, test: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, sendTransaction: [Function], send: [Function], allEvents: [Function: bound ], address: &#39;0x345ca3e014aaf5dca488057592ee47305d9b3e10&#39;, transactionHash: null } 执行了上面命令后，就可以通过contract变量来调用合约。要调用合约中的方法只需要contract.method()，比如要调用Hello合约中的test方法,执行： truffle(develop)&gt; contract.test(); &#39;It is test!&#39; PS：这里调用的test方法使用pure进行了修饰，所以可以直接调用。如果没有使用pure进行修饰，那么调用这个test方法，就只能通过call来调用：contract.test.call() 到这里，这个只能合约就编写、编译并部署完成了！ 参考： 黎跃春 —— 如何编写智能合约(Smart Contract) 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-13T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"开发环境配置 安装truffle. 在命令行下执行(已经有npm环境) MacBook-Pro:~ zhi$ npm install -g truffle /usr/local/bin/truffle -&gt; /usr/local/lib/node_modules/truffle/build/cli.bundled.js /usr/local/lib └── truffle@4.0.4 使用truffle命令查看版本信息 MacBook-Pro:~ zhi$ truffle version Truffle v4.0.4 (core: 4.0.4) Solidity v0.4.18 (solc-js) 使用truffle初始化一个测试项目 MacBook-Pro:~ zhi$ mkdir -p ~/Ethereum/demo1 MacBook-Pro:~ zhi$ cd ~/Ethereum/demo1 MacBook-Pro:~ zhi$ truffle init Downloading... Unpacking... Setting up... Unbox successful. Sweet! Commands: Compile: truffle compile Migrate: truffle migrate Test contracts: truffle test 初始化之后，所在文件夹下会创建一些文件夹以及文件： |—contracts 用于存放合约的文件夹，我们添加的合约都放在这里 |—migrations 指导合约编译的文件 |————-1_initial_migration.js |————-2_initial_hello.js |—test 测试目录 |—truffle-config.js 配置文件 |—truffle.js 创建Hello.sol合约文件，并保存在truffle初始化后的contracts文件夹中。文件内容： pragma solidity ^0.4.18; contract Hello{ function test() pure public returns (string){ return &quot;It is test!&quot;; } function test1() pure public returns (string){ return &quot;test1!&quot;; } function echo(string s) pure public returns (string){ return s; } } 进入命令行编译以及部署操作 进入truffle命令行，执行truffle develop命令 MacBook-Pro:~ zhi$ truffle develop Truffle Develop started at http://localhost:9545/ Accounts: (0) 0x627306090abab3a6e1400e9345bc60c78a8bef57 (1) 0xf17f52151ebef6c7334fad080c5704d77216b732 (2) 0xc5fdf4076b8f3a5357c5e395ab970b5b54098fef (3) 0x821aea9a577a9b44299b9c15c88cf3087f3b5544 (4) 0x0d1d4e623d10f9fba5db95830f7d3839406c6af2 (5) 0x2932b7a2355d6fecc4b5c0b6bd44cc31df247a2e (6) 0x2191ef87e392377ec08e7c08eb105ef5448eced5 (7) 0x0f4f2ac550a1b4e2280d04c21cea7ebd822934b5 (8) 0x6330a553fc93768f612722bb8c2ec78ac90b3bbc (9) 0x5aeda56215b167893e80b4fe645ba6d5bab767de Private Keys: (0) c87509a1c067bbde78beb793e6fa76530b6382a4c0241e5e4a9ec0a0f44dc0d3 (1) ae6ae8e5ccbfb04590405997ee2d52d2b330726137b875053c36d94e974d162f (2) 0dbbe8e4ae425a6d2687f1a7e3ba17bc98c673636790f1b8ad91193c05875ef1 (3) c88b703fb08cbea894b6aeff5a544fb92e78a18e19814cd85da83b71f772aa6c (4) 388c684f0ba1ef5017716adb5d21a053ea8e90277d0868337519f97bede61418 (5) 659cbb0e2411a44db63778987b1e22153c086a95eb6b18bdf89de078917abc63 (6) 82d052c865f5763aad42add438569276c00d3d88a2d062d36b2bae914d58b8c8 (7) aa3680d5d48a8283413f7a108367c7299ca73f553735860a87b08f39395618b7 (8) 0f62d96d6675f32685bbdb8ac13cda7c23436f63efbb9d07700d8669ff12b7c4 (9) 8d5366123cb560bb606379f90a0bfd4769eecc0557f1b362dcae9012b548b1e5 Mnemonic: candy maple cake sugar pudding cream honey rich smooth crumble sweet treat 编译，执行命令compile： truffle(develop)&gt; compile Compiling ./contracts/Hello.sol... Compiling ./contracts/Migrations.sol... Writing artifacts to ./build/contracts 部署，执行命令migrate truffle(develop)&gt; migrate Using network &#39;develop&#39;. Running migration: 1_initial_migration.js Deploying Migrations... ... 0x058f644af8801388e6a6116ea00c163645dfc1c8636e096e6ed11cdd0d2e8c54 Migrations: 0x8cdaf0cd259887258bc13a92c0a6da92698644c0 Saving successful migration to network... ... 0xd7bc86d31bee32fa3988f1c1eabce403a1b5d570340a3a9cdba53a472ee8c956 Saving artifacts... Running migration: 2_initial_migration.js Deploying Hello... ... 0x93b1578047b7db49016168b1d0e480218d552fa7e5b53f1d81cc0e00f567239b Hello: 0x345ca3e014aaf5dca488057592ee47305d9b3e10 Saving successful migration to network... ... 0xf36163615f41ef7ed8f4a8f192149a0bf633fe1a2398ce001bf44c43dc7bdda0 Saving artifacts... 如果之前部署过，在执行命令后，可能不是出现上面的信息，而是出现 Using network &#39;develop&#39;. Network up to date. 表示的是，合约没有过期，这次部署没有成功。此时需要在部署命令后添加一个reset参数即可部署成功。完整命令migrate --reset 获取合约实例。将合约实例赋值给contract变量，执行命令Hello.deployed().then(instance =&gt; contract = instance) truffle(develop)&gt; let contract; undefined truffle(develop)&gt; Hello.deployed().then(instance =&gt; contract = instance) TruffleContract { constructor: { [Function: TruffleContract] _static_methods: { setProvider: [Function: setProvider], new: [Function: new], at: [Function: at], deployed: [Function: deployed], defaults: [Function: defaults], hasNetwork: [Function: hasNetwork], isDeployed: [Function: isDeployed], detectNetwork: [Function: detectNetwork], setNetwork: [Function: setNetwork], resetAddress: [Function: resetAddress], link: [Function: link], clone: [Function: clone], addProp: [Function: addProp], toJSON: [Function: toJSON] }, _properties: { contract_name: [Object], contractName: [Object], abi: [Object], network: [Function: network], networks: [Function: networks], address: [Object], links: [Function: links], events: [Function: events], binary: [Function: binary], deployedBinary: [Function: deployedBinary], unlinked_binary: [Object], bytecode: [Object], deployedBytecode: [Object], sourceMap: [Object], deployedSourceMap: [Object], source: [Object], sourcePath: [Object], ast: [Object], compiler: [Object], schema_version: [Function: schema_version], schemaVersion: [Function: schemaVersion], updated_at: [Function: updated_at], updatedAt: [Function: updatedAt] }, _property_values: {}, _json: { contractName: &#39;Hello&#39;, abi: [Object], bytecode: &#39;0x6060604052341561000f57600080fd5b6103248061001e6000396000f300606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029&#39;, deployedBytecode: &#39;0x606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029&#39;, sourceMap: &#39;26:249:0:-;;;;;;;;;;;;;;;;;&#39;, deployedSourceMap: &#39;26:249:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;201:71:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;45:75:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73:0;162:6;;:::i;:::-;175:17;;;;;;;;;;;;;;;;;;;;124:73;:::o;201:71::-;246:6;;:::i;:::-;266:1;259:8;;201:71;;;:::o;45:75::-;82:6;;:::i;:::-;95:20;;;;;;;;;;;;;;;;;;;;45:75;:::o;26:249::-;;;;;;;;;;;;;;;:::o&#39;, source: &#39;pragma solidity ^0.4.18;\\n\\ncontract Hello{\\n\\n function test() pure public returns (string){\\n return &quot;It is test!&quot;;\\n }\\n\\n function test1() pure public returns (string){\\n return &quot;No pure!&quot;;\\n }\\n\\n function echo(string s) pure public returns (string){\\n return s;\\n }\\n\\n}\\n&#39;, sourcePath: &#39;/Users/ zhi/Ethereum/demo1/contracts/Hello.sol&#39;, ast: [Object], compiler: [Object], networks: [Object], schemaVersion: &#39;1.0.1&#39;, updatedAt: &#39;2018-01-11T08:33:44.367Z&#39; }, setProvider: [Function: bound setProvider], new: [Function: bound new], at: [Function: bound at], deployed: [Function: bound deployed], defaults: [Function: bound defaults], hasNetwork: [Function: bound hasNetwork], isDeployed: [Function: bound isDeployed], detectNetwork: [Function: bound detectNetwork], setNetwork: [Function: bound setNetwork], resetAddress: [Function: bound resetAddress], link: [Function: bound link], clone: [Function: bound clone], addProp: [Function: bound addProp], toJSON: [Function: bound toJSON], web3: Web3 { _requestManager: [Object], currentProvider: [Object], eth: [Object], db: [Object], shh: [Object], net: [Object], personal: [Object], bzz: [Object], settings: [Object], version: [Object], providers: [Object], _extend: [Object] }, class_defaults: { from: &#39;0x627306090abab3a6e1400e9345bc60c78a8bef57&#39;, gas: 6721975, gasPrice: 100000000000 }, currentProvider: HttpProvider { host: &#39;http://localhost:9545/&#39;, timeout: 0, user: undefined, password: undefined, send: [Function], sendAsync: [Function], _alreadyWrapped: true }, network_id: &#39;4447&#39; }, abi: [ { constant: true, inputs: [], name: &#39;test1&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; }, { constant: true, inputs: [Object], name: &#39;echo&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; }, { constant: true, inputs: [], name: &#39;test&#39;, outputs: [Object], payable: false, stateMutability: &#39;pure&#39;, type: &#39;function&#39; } ], contract: Contract { _eth: Eth { _requestManager: [Object], getBalance: [Object], getStorageAt: [Object], getCode: [Object], getBlock: [Object], getUncle: [Object], getCompilers: [Object], getBlockTransactionCount: [Object], getBlockUncleCount: [Object], getTransaction: [Object], getTransactionFromBlock: [Object], getTransactionReceipt: [Object], getTransactionCount: [Object], call: [Object], estimateGas: [Object], sendRawTransaction: [Object], signTransaction: [Object], sendTransaction: [Object], sign: [Object], compile: [Object], submitWork: [Object], getWork: [Object], coinbase: [Getter], getCoinbase: [Object], mining: [Getter], getMining: [Object], hashrate: [Getter], getHashrate: [Object], syncing: [Getter], getSyncing: [Object], gasPrice: [Getter], getGasPrice: [Object], accounts: [Getter], getAccounts: [Object], blockNumber: [Getter], getBlockNumber: [Object], protocolVersion: [Getter], getProtocolVersion: [Object], iban: [Object], sendIBANTransaction: [Function: bound transfer] }, transactionHash: null, address: &#39;0x345ca3e014aaf5dca488057592ee47305d9b3e10&#39;, abi: [ [Object], [Object], [Object] ], test1: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], &#39;&#39;: [Circular] }, echo: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], string: [Circular] }, test: { [Function: bound ] request: [Function: bound ], call: [Function: bound ], sendTransaction: [Function: bound ], estimateGas: [Function: bound ], getData: [Function: bound ], &#39;&#39;: [Circular] }, allEvents: [Function: bound ] }, test1: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, echo: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, test: { [Function] call: [Function], sendTransaction: [Function], request: [Function: bound ], estimateGas: [Function] }, sendTransaction: [Function], send: [Function], allEvents: [Function: bound ], address: &#39;0x345ca3e014aaf5dca488057592ee47305d9b3e10&#39;, transactionHash: null } 执行了上面命令后，就可以通过contract变量来调用合约。要调用合约中的方法只需要contract.method()，比如要调用Hello合约中的test方法,执行： truffle(develop)&gt; contract.test(); &#39;It is test!&#39; PS：这里调用的test方法使用pure进行了修饰，所以可以直接调用。如果没有使用pure进行修饰，那么调用这个test方法，就只能通过call来调用：contract.test.call() 到这里，这个只能合约就编写、编译并部署完成了！ 参考： 黎跃春 —— 如何编写智能合约(Smart Contract) 阅读更多","@type":"BlogPosting","url":"/2018/01/13/3a0a683b3963a14383b6e82b257f869a.html","headline":"如何编写智能合约之一：智能合约编写、编译以及部署","dateModified":"2018-01-13T00:00:00+08:00","datePublished":"2018-01-13T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/01/13/3a0a683b3963a14383b6e82b257f869a.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>如何编写智能合约之一：智能合约编写、编译以及部署</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <h3 id="开发环境配置">开发环境配置</h3> 
  <ol> 
   <li>安装<code>truffle</code>. 在命令行下执行(已经有npm环境)</li> 
  </ol> 
  <pre class="prettyprint"><code class=" hljs lasso">MacBook<span class="hljs-attribute">-Pro</span>:~  zhi$ npm install <span class="hljs-attribute">-g</span> truffle
/usr/<span class="hljs-built_in">local</span>/bin/truffle <span class="hljs-subst">-&gt; </span>/usr/<span class="hljs-built_in">local</span>/lib/node_modules/truffle/build/cli<span class="hljs-built_in">.</span>bundled<span class="hljs-built_in">.</span>js
/usr/<span class="hljs-built_in">local</span>/lib
└── truffle@<span class="hljs-number">4.0</span><span class="hljs-number">.4</span> </code></pre> 
  <p>使用<code>truffle</code>命令查看版本信息</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-constant">MacBook</span>-<span class="hljs-constant">Pro</span><span class="hljs-symbol">:~</span>  zhi<span class="hljs-variable">$ </span>truffle version
<span class="hljs-constant">Truffle</span> v4.<span class="hljs-number">0</span>.<span class="hljs-number">4</span> (<span class="hljs-symbol">core:</span> <span class="hljs-number">4.0</span>.<span class="hljs-number">4</span>)
<span class="hljs-constant">Solidity</span> v<span class="hljs-number">0</span>.<span class="hljs-number">4.18</span> (solc-js)</code></pre> 
  <p>使用<code>truffle</code>初始化一个测试项目</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-constant">MacBook</span>-<span class="hljs-constant">Pro</span><span class="hljs-symbol">:~</span>  zhi<span class="hljs-variable">$ </span>mkdir -p ~<span class="hljs-regexp">/Ethereum/demo</span>1
<span class="hljs-constant">MacBook</span>-<span class="hljs-constant">Pro</span><span class="hljs-symbol">:~</span>  zhi<span class="hljs-variable">$ </span>cd ~<span class="hljs-regexp">/Ethereum/demo</span>1
<span class="hljs-constant">MacBook</span>-<span class="hljs-constant">Pro</span><span class="hljs-symbol">:~</span>  zhi<span class="hljs-variable">$ </span>truffle init
<span class="hljs-constant">Downloading</span>...
<span class="hljs-constant">Unpacking</span>...
<span class="hljs-constant">Setting</span> up...
<span class="hljs-constant">Unbox</span> successful. <span class="hljs-constant">Sweet</span>!

<span class="hljs-constant">Commands</span><span class="hljs-symbol">:</span>

  <span class="hljs-constant">Compile</span><span class="hljs-symbol">:</span>        truffle compile
  <span class="hljs-constant">Migrate</span><span class="hljs-symbol">:</span>        truffle migrate
  <span class="hljs-constant">Test</span> <span class="hljs-symbol">contracts:</span> truffle test</code></pre> 
  <p>初始化之后，所在文件夹下会创建一些文件夹以及文件： <br> |—contracts 用于存放合约的文件夹，我们添加的合约都放在这里 <br> |—migrations 指导合约编译的文件 <br> |————-1_initial_migration.js <br> |————-2_initial_hello.js <br> |—test 测试目录 <br> |—truffle-config.js 配置文件 <br> |—truffle.js</p> 
  <ol> 
   <li>创建<code>Hello.sol</code>合约文件，并保存在<code>truffle</code>初始化后的<code>contracts</code>文件夹中。文件内容：</li> 
  </ol> 
  <pre class="prettyprint"><code class=" hljs d"><span class="hljs-keyword">pragma</span> solidity ^<span class="hljs-number">0.4</span>.18;

contract Hello{

  <span class="hljs-built_in">function</span> test() <span class="hljs-keyword">pure</span> <span class="hljs-keyword">public</span> returns (<span class="hljs-built_in">string</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">"It is test!"</span>;
  }

  <span class="hljs-built_in">function</span> test1() <span class="hljs-keyword">pure</span> <span class="hljs-keyword">public</span> returns (<span class="hljs-built_in">string</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">"test1!"</span>;
  }

  <span class="hljs-built_in">function</span> echo(<span class="hljs-built_in">string</span> s) <span class="hljs-keyword">pure</span> <span class="hljs-keyword">public</span> returns (<span class="hljs-built_in">string</span>){
    <span class="hljs-keyword">return</span> s;
  }

}</code></pre> 
  <ol> 
   <li>进入命令行编译以及部署操作 <br> 进入truffle命令行，执行<code>truffle develop</code>命令</li> 
  </ol> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-constant">MacBook</span>-<span class="hljs-constant">Pro</span><span class="hljs-symbol">:~</span>  zhi<span class="hljs-variable">$ </span>truffle develop
<span class="hljs-constant">Truffle</span> <span class="hljs-constant">Develop</span> started at <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/localhost:9545/</span>

<span class="hljs-constant">Accounts</span><span class="hljs-symbol">:</span>
(<span class="hljs-number">0</span>) <span class="hljs-number">0x627306090abab3a6e1400e9345bc60c78a8bef57</span>
(<span class="hljs-number">1</span>) <span class="hljs-number">0xf17f52151ebef6c7334fad080c5704d77216b732</span>
(<span class="hljs-number">2</span>) <span class="hljs-number">0xc5fdf4076b8f3a5357c5e395ab970b5b54098fef</span>
(<span class="hljs-number">3</span>) <span class="hljs-number">0x821aea9a577a9b44299b9c15c88cf3087f3b5544</span>
(<span class="hljs-number">4</span>) <span class="hljs-number">0x0d1d4e623d10f9fba5db95830f7d3839406c6af2</span>
(<span class="hljs-number">5</span>) <span class="hljs-number">0x2932b7a2355d6fecc4b5c0b6bd44cc31df247a2e</span>
(<span class="hljs-number">6</span>) <span class="hljs-number">0x2191ef87e392377ec08e7c08eb105ef5448eced5</span>
(<span class="hljs-number">7</span>) <span class="hljs-number">0x0f4f2ac550a1b4e2280d04c21cea7ebd822934b5</span>
(<span class="hljs-number">8</span>) <span class="hljs-number">0x6330a553fc93768f612722bb8c2ec78ac90b3bbc</span>
(<span class="hljs-number">9</span>) <span class="hljs-number">0x5aeda56215b167893e80b4fe645ba6d5bab767de</span>

<span class="hljs-constant">Private</span> <span class="hljs-constant">Keys</span><span class="hljs-symbol">:</span>
(<span class="hljs-number">0</span>) c87509a1c067bbde78beb793e6fa76530b6382a4c0241e5e4a9ec0a0f44dc0d3
(<span class="hljs-number">1</span>) ae6ae8e5ccbfb04590405997ee2d52d2b330726137b875053c36d94e974d162f
(<span class="hljs-number">2</span>) 0dbbe8e4ae425a6d2687f1a7e3ba17bc98c673636790f1b8ad91193c05875ef1
(<span class="hljs-number">3</span>) c88b703fb08cbea894b6aeff5a544fb92e78a18e19814cd85da83b71f772aa6c
(<span class="hljs-number">4</span>) <span class="hljs-number">388</span>c684f0ba1ef5017716adb5d21a053ea8e90277d0868337519f97bede61418
(<span class="hljs-number">5</span>) <span class="hljs-number">659</span>cbb0e2411a44db63778987b1e22153c086a95eb6b18bdf89de078917abc63
(<span class="hljs-number">6</span>) <span class="hljs-number">82</span>d052c865f5763aad42add438569276c00d3d88a2d062d36b2bae914d58b8c8
(<span class="hljs-number">7</span>) aa3680d5d48a8283413f7a108367c7299ca73f553735860a87b08f39395618b7
(<span class="hljs-number">8</span>) 0f62d96d6675f32685bbdb8ac13cda7c23436f63efbb9d07700d8669ff12b7c4
(<span class="hljs-number">9</span>) <span class="hljs-number">8</span>d5366123cb560bb606379f90a0bfd4769eecc0557f1b362dcae9012b548b1e5

<span class="hljs-constant">Mnemonic</span><span class="hljs-symbol">:</span> candy maple cake sugar pudding cream honey rich smooth crumble sweet treat</code></pre> 
  <p>编译，执行命令<code>compile</code>：</p> 
  <pre class="prettyprint"><code class=" hljs lasso">truffle(develop)<span class="hljs-subst">&gt;</span> compile
Compiling <span class="hljs-built_in">.</span>/contracts/Hello<span class="hljs-built_in">.</span>sol<span class="hljs-attribute">...</span>
Compiling <span class="hljs-built_in">.</span>/contracts/Migrations<span class="hljs-built_in">.</span>sol<span class="hljs-attribute">...</span>
Writing artifacts <span class="hljs-keyword">to</span> <span class="hljs-built_in">.</span>/build/contracts</code></pre> 
  <p>部署，执行命令<code>migrate</code></p> 
  <pre class="prettyprint"><code class=" hljs r">truffle(develop)&gt; migrate
Using network <span class="hljs-string">'develop'</span>.

Running migration: 1_initial_migration.js
  Deploying Migrations...
  <span class="hljs-keyword">...</span> <span class="hljs-number">0x058f644af8801388e6a6116ea00c163645dfc1c8636e096e6ed11cdd0d2e8c54</span>
  Migrations: <span class="hljs-number">0x8cdaf0cd259887258bc13a92c0a6da92698644c0</span>
Saving successful migration to network...
  <span class="hljs-keyword">...</span> <span class="hljs-number">0xd7bc86d31bee32fa3988f1c1eabce403a1b5d570340a3a9cdba53a472ee8c956</span>
Saving artifacts...
Running migration: 2_initial_migration.js
  Deploying Hello...
  <span class="hljs-keyword">...</span> <span class="hljs-number">0x93b1578047b7db49016168b1d0e480218d552fa7e5b53f1d81cc0e00f567239b</span>
  Hello: <span class="hljs-number">0x345ca3e014aaf5dca488057592ee47305d9b3e10</span>
Saving successful migration to network...
  <span class="hljs-keyword">...</span> <span class="hljs-number">0xf36163615f41ef7ed8f4a8f192149a0bf633fe1a2398ce001bf44c43dc7bdda0</span>
Saving artifacts...</code></pre> 
  <p>如果之前部署过，在执行命令后，可能不是出现上面的信息，而是出现</p> 
  <pre class="prettyprint"><code class=" hljs vbnet"><span class="hljs-keyword">Using</span> network <span class="hljs-comment">'develop'.</span>

Network up <span class="hljs-keyword">to</span> <span class="hljs-built_in">date</span>.</code></pre> 
  <p>表示的是，合约没有过期，这次部署没有成功。此时需要在部署命令后添加一个<code>reset</code>参数即可部署成功。完整命令<code>migrate --reset</code></p> 
  <ol> 
   <li>获取合约实例。将合约实例赋值给<code>contract</code>变量，执行命令<code>Hello.deployed().then(instance =&gt; contract = instance)</code></li> 
  </ol> 
  <pre class="prettyprint"><code class=" hljs javascript">truffle(develop)&gt; <span class="hljs-keyword">let</span> contract;
<span class="hljs-literal">undefined</span>
truffle(develop)&gt; Hello.deployed().then(instance =&gt; contract = instance)
TruffleContract {
  constructor: 
   { [<span class="hljs-built_in">Function</span>: TruffleContract]
     _static_methods: 
      { setProvider: [<span class="hljs-built_in">Function</span>: setProvider],
        <span class="hljs-keyword">new</span>: [<span class="hljs-built_in">Function</span>: <span class="hljs-keyword">new</span>],
        at: [<span class="hljs-built_in">Function</span>: at],
        deployed: [<span class="hljs-built_in">Function</span>: deployed],
        defaults: [<span class="hljs-built_in">Function</span>: defaults],
        hasNetwork: [<span class="hljs-built_in">Function</span>: hasNetwork],
        isDeployed: [<span class="hljs-built_in">Function</span>: isDeployed],
        detectNetwork: [<span class="hljs-built_in">Function</span>: detectNetwork],
        setNetwork: [<span class="hljs-built_in">Function</span>: setNetwork],
        resetAddress: [<span class="hljs-built_in">Function</span>: resetAddress],
        link: [<span class="hljs-built_in">Function</span>: link],
        clone: [<span class="hljs-built_in">Function</span>: clone],
        addProp: [<span class="hljs-built_in">Function</span>: addProp],
        toJSON: [<span class="hljs-built_in">Function</span>: toJSON] },
     _properties: 
      { contract_name: [<span class="hljs-built_in">Object</span>],
        contractName: [<span class="hljs-built_in">Object</span>],
        abi: [<span class="hljs-built_in">Object</span>],
        network: [<span class="hljs-built_in">Function</span>: network],
        networks: [<span class="hljs-built_in">Function</span>: networks],
        address: [<span class="hljs-built_in">Object</span>],
        links: [<span class="hljs-built_in">Function</span>: links],
        events: [<span class="hljs-built_in">Function</span>: events],
        binary: [<span class="hljs-built_in">Function</span>: binary],
        deployedBinary: [<span class="hljs-built_in">Function</span>: deployedBinary],
        unlinked_binary: [<span class="hljs-built_in">Object</span>],
        bytecode: [<span class="hljs-built_in">Object</span>],
        deployedBytecode: [<span class="hljs-built_in">Object</span>],
        sourceMap: [<span class="hljs-built_in">Object</span>],
        deployedSourceMap: [<span class="hljs-built_in">Object</span>],
        source: [<span class="hljs-built_in">Object</span>],
        sourcePath: [<span class="hljs-built_in">Object</span>],
        ast: [<span class="hljs-built_in">Object</span>],
        compiler: [<span class="hljs-built_in">Object</span>],
        schema_version: [<span class="hljs-built_in">Function</span>: schema_version],
        schemaVersion: [<span class="hljs-built_in">Function</span>: schemaVersion],
        updated_at: [<span class="hljs-built_in">Function</span>: updated_at],
        updatedAt: [<span class="hljs-built_in">Function</span>: updatedAt] },
     _property_values: {},
     _json: 
      { contractName: <span class="hljs-string">'Hello'</span>,
        abi: [<span class="hljs-built_in">Object</span>],
        bytecode: <span class="hljs-string">'0x6060604052341561000f57600080fd5b6103248061001e6000396000f300606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029'</span>,
        deployedBytecode: <span class="hljs-string">'0x606060405260043610610057576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680636b59084d1461005c578063f15da729146100ea578063f8a8fd6d146101c0575b600080fd5b341561006757600080fd5b61006f61024e565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100af578082015181840152602081019050610094565b50505050905090810190601f1680156100dc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156100f557600080fd5b610145600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610291565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561018557808201518184015260208101905061016a565b50505050905090810190601f1680156101b25780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101cb57600080fd5b6101d36102a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102135780820151818401526020810190506101f8565b50505050905090810190601f1680156102405780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6102566102e4565b6040805190810160405280600881526020017f4e6f207075726521000000000000000000000000000000000000000000000000815250905090565b6102996102e4565b819050919050565b6102a96102e4565b6040805190810160405280600b81526020017f4974206973207465737421000000000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a72305820f8b8cb5819d0882b82e8e56db58138459357c31c23dbb9760f17111a8011b9490029'</span>,
        sourceMap: <span class="hljs-string">'26:249:0:-;;;;;;;;;;;;;;;;;'</span>,
        deployedSourceMap: <span class="hljs-string">'26:249:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;201:71:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;45:75:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;124:73:0;162:6;;:::i;:::-;175:17;;;;;;;;;;;;;;;;;;;;124:73;:::o;201:71::-;246:6;;:::i;:::-;266:1;259:8;;201:71;;;:::o;45:75::-;82:6;;:::i;:::-;95:20;;;;;;;;;;;;;;;;;;;;45:75;:::o;26:249::-;;;;;;;;;;;;;;;:::o'</span>,
        source: <span class="hljs-string">'pragma solidity ^0.4.18;\n\ncontract Hello{\n\n function test() pure public returns (string){\n return "It is test!";\n }\n\n function test1() pure public returns (string){\n return "No pure!";\n }\n\n function echo(string s) pure public returns (string){\n return s;\n }\n\n}\n'</span>,
        sourcePath: <span class="hljs-string">'/Users/ zhi/Ethereum/demo1/contracts/Hello.sol'</span>,
        ast: [<span class="hljs-built_in">Object</span>],
        compiler: [<span class="hljs-built_in">Object</span>],
        networks: [<span class="hljs-built_in">Object</span>],
        schemaVersion: <span class="hljs-string">'1.0.1'</span>,
        updatedAt: <span class="hljs-string">'2018-01-11T08:33:44.367Z'</span> },
     setProvider: [<span class="hljs-built_in">Function</span>: bound setProvider],
     <span class="hljs-keyword">new</span>: [<span class="hljs-built_in">Function</span>: bound <span class="hljs-keyword">new</span>],
     at: [<span class="hljs-built_in">Function</span>: bound at],
     deployed: [<span class="hljs-built_in">Function</span>: bound deployed],
     defaults: [<span class="hljs-built_in">Function</span>: bound defaults],
     hasNetwork: [<span class="hljs-built_in">Function</span>: bound hasNetwork],
     isDeployed: [<span class="hljs-built_in">Function</span>: bound isDeployed],
     detectNetwork: [<span class="hljs-built_in">Function</span>: bound detectNetwork],
     setNetwork: [<span class="hljs-built_in">Function</span>: bound setNetwork],
     resetAddress: [<span class="hljs-built_in">Function</span>: bound resetAddress],
     link: [<span class="hljs-built_in">Function</span>: bound link],
     clone: [<span class="hljs-built_in">Function</span>: bound clone],
     addProp: [<span class="hljs-built_in">Function</span>: bound addProp],
     toJSON: [<span class="hljs-built_in">Function</span>: bound toJSON],
     web3: 
      Web3 {
        _requestManager: [<span class="hljs-built_in">Object</span>],
        currentProvider: [<span class="hljs-built_in">Object</span>],
        eth: [<span class="hljs-built_in">Object</span>],
        db: [<span class="hljs-built_in">Object</span>],
        shh: [<span class="hljs-built_in">Object</span>],
        net: [<span class="hljs-built_in">Object</span>],
        personal: [<span class="hljs-built_in">Object</span>],
        bzz: [<span class="hljs-built_in">Object</span>],
        settings: [<span class="hljs-built_in">Object</span>],
        version: [<span class="hljs-built_in">Object</span>],
        providers: [<span class="hljs-built_in">Object</span>],
        _extend: [<span class="hljs-built_in">Object</span>] },
     class_defaults: 
      { from: <span class="hljs-string">'0x627306090abab3a6e1400e9345bc60c78a8bef57'</span>,
        gas: <span class="hljs-number">6721975</span>,
        gasPrice: <span class="hljs-number">100000000000</span> },
     currentProvider: 
      HttpProvider {
        host: <span class="hljs-string">'http://localhost:9545/'</span>,
        timeout: <span class="hljs-number">0</span>,
        user: <span class="hljs-literal">undefined</span>,
        password: <span class="hljs-literal">undefined</span>,
        send: [<span class="hljs-built_in">Function</span>],
        sendAsync: [<span class="hljs-built_in">Function</span>],
        _alreadyWrapped: <span class="hljs-literal">true</span> },
     network_id: <span class="hljs-string">'4447'</span> },
  abi: 
   [ { constant: <span class="hljs-literal">true</span>,
       inputs: [],
       name: <span class="hljs-string">'test1'</span>,
       outputs: [<span class="hljs-built_in">Object</span>],
       payable: <span class="hljs-literal">false</span>,
       stateMutability: <span class="hljs-string">'pure'</span>,
       type: <span class="hljs-string">'function'</span> },
     { constant: <span class="hljs-literal">true</span>,
       inputs: [<span class="hljs-built_in">Object</span>],
       name: <span class="hljs-string">'echo'</span>,
       outputs: [<span class="hljs-built_in">Object</span>],
       payable: <span class="hljs-literal">false</span>,
       stateMutability: <span class="hljs-string">'pure'</span>,
       type: <span class="hljs-string">'function'</span> },
     { constant: <span class="hljs-literal">true</span>,
       inputs: [],
       name: <span class="hljs-string">'test'</span>,
       outputs: [<span class="hljs-built_in">Object</span>],
       payable: <span class="hljs-literal">false</span>,
       stateMutability: <span class="hljs-string">'pure'</span>,
       type: <span class="hljs-string">'function'</span> } ],
  contract: 
   Contract {
     _eth: 
      Eth {
        _requestManager: [<span class="hljs-built_in">Object</span>],
        getBalance: [<span class="hljs-built_in">Object</span>],
        getStorageAt: [<span class="hljs-built_in">Object</span>],
        getCode: [<span class="hljs-built_in">Object</span>],
        getBlock: [<span class="hljs-built_in">Object</span>],
        getUncle: [<span class="hljs-built_in">Object</span>],
        getCompilers: [<span class="hljs-built_in">Object</span>],
        getBlockTransactionCount: [<span class="hljs-built_in">Object</span>],
        getBlockUncleCount: [<span class="hljs-built_in">Object</span>],
        getTransaction: [<span class="hljs-built_in">Object</span>],
        getTransactionFromBlock: [<span class="hljs-built_in">Object</span>],
        getTransactionReceipt: [<span class="hljs-built_in">Object</span>],
        getTransactionCount: [<span class="hljs-built_in">Object</span>],
        call: [<span class="hljs-built_in">Object</span>],
        estimateGas: [<span class="hljs-built_in">Object</span>],
        sendRawTransaction: [<span class="hljs-built_in">Object</span>],
        signTransaction: [<span class="hljs-built_in">Object</span>],
        sendTransaction: [<span class="hljs-built_in">Object</span>],
        sign: [<span class="hljs-built_in">Object</span>],
        compile: [<span class="hljs-built_in">Object</span>],
        submitWork: [<span class="hljs-built_in">Object</span>],
        getWork: [<span class="hljs-built_in">Object</span>],
        coinbase: [Getter],
        getCoinbase: [<span class="hljs-built_in">Object</span>],
        mining: [Getter],
        getMining: [<span class="hljs-built_in">Object</span>],
        hashrate: [Getter],
        getHashrate: [<span class="hljs-built_in">Object</span>],
        syncing: [Getter],
        getSyncing: [<span class="hljs-built_in">Object</span>],
        gasPrice: [Getter],
        getGasPrice: [<span class="hljs-built_in">Object</span>],
        accounts: [Getter],
        getAccounts: [<span class="hljs-built_in">Object</span>],
        blockNumber: [Getter],
        getBlockNumber: [<span class="hljs-built_in">Object</span>],
        protocolVersion: [Getter],
        getProtocolVersion: [<span class="hljs-built_in">Object</span>],
        iban: [<span class="hljs-built_in">Object</span>],
        sendIBANTransaction: [<span class="hljs-built_in">Function</span>: bound transfer] },
     transactionHash: <span class="hljs-literal">null</span>,
     address: <span class="hljs-string">'0x345ca3e014aaf5dca488057592ee47305d9b3e10'</span>,
     abi: [ [<span class="hljs-built_in">Object</span>], [<span class="hljs-built_in">Object</span>], [<span class="hljs-built_in">Object</span>] ],
     test1: 
      { [<span class="hljs-built_in">Function</span>: bound ]
        request: [<span class="hljs-built_in">Function</span>: bound ],
        call: [<span class="hljs-built_in">Function</span>: bound ],
        sendTransaction: [<span class="hljs-built_in">Function</span>: bound ],
        estimateGas: [<span class="hljs-built_in">Function</span>: bound ],
        getData: [<span class="hljs-built_in">Function</span>: bound ],
        <span class="hljs-string">''</span>: [Circular] },
     echo: 
      { [<span class="hljs-built_in">Function</span>: bound ]
        request: [<span class="hljs-built_in">Function</span>: bound ],
        call: [<span class="hljs-built_in">Function</span>: bound ],
        sendTransaction: [<span class="hljs-built_in">Function</span>: bound ],
        estimateGas: [<span class="hljs-built_in">Function</span>: bound ],
        getData: [<span class="hljs-built_in">Function</span>: bound ],
        string: [Circular] },
     test: 
      { [<span class="hljs-built_in">Function</span>: bound ]
        request: [<span class="hljs-built_in">Function</span>: bound ],
        call: [<span class="hljs-built_in">Function</span>: bound ],
        sendTransaction: [<span class="hljs-built_in">Function</span>: bound ],
        estimateGas: [<span class="hljs-built_in">Function</span>: bound ],
        getData: [<span class="hljs-built_in">Function</span>: bound ],
        <span class="hljs-string">''</span>: [Circular] },
     allEvents: [<span class="hljs-built_in">Function</span>: bound ] },
  test1: 
   { [<span class="hljs-built_in">Function</span>]
     call: [<span class="hljs-built_in">Function</span>],
     sendTransaction: [<span class="hljs-built_in">Function</span>],
     request: [<span class="hljs-built_in">Function</span>: bound ],
     estimateGas: [<span class="hljs-built_in">Function</span>] },
  echo: 
   { [<span class="hljs-built_in">Function</span>]
     call: [<span class="hljs-built_in">Function</span>],
     sendTransaction: [<span class="hljs-built_in">Function</span>],
     request: [<span class="hljs-built_in">Function</span>: bound ],
     estimateGas: [<span class="hljs-built_in">Function</span>] },
  test: 
   { [<span class="hljs-built_in">Function</span>]
     call: [<span class="hljs-built_in">Function</span>],
     sendTransaction: [<span class="hljs-built_in">Function</span>],
     request: [<span class="hljs-built_in">Function</span>: bound ],
     estimateGas: [<span class="hljs-built_in">Function</span>] },
  sendTransaction: [<span class="hljs-built_in">Function</span>],
  send: [<span class="hljs-built_in">Function</span>],
  allEvents: [<span class="hljs-built_in">Function</span>: bound ],
  address: <span class="hljs-string">'0x345ca3e014aaf5dca488057592ee47305d9b3e10'</span>,
  transactionHash: <span class="hljs-literal">null</span> }</code></pre> 
  <p>执行了上面命令后，就可以通过<code>contract</code>变量来调用合约。要调用合约中的方法只需要<code>contract.method()</code>，比如要调用<code>Hello</code>合约中的<code>test</code>方法,执行：</p> 
  <pre class="prettyprint"><code class=" hljs vhdl">truffle(develop)&gt; contract.test();
<span class="hljs-attribute">'It</span> <span class="hljs-keyword">is</span> test!'</code></pre> 
  <p>PS：这里调用的<code>test</code>方法使用<code>pure</code>进行了修饰，所以可以直接调用。如果没有使用<code>pure</code>进行修饰，那么调用这个<code>test</code>方法，就只能通过<code>call</code>来调用：<code>contract.test.call()</code></p> 
  <p>到这里，这个只能合约就编写、编译并部署完成了！</p> 
  <p>参考： <br> <a href="http://liyuechun.org/2017/09/19/how-to-code-smart-contract/" rel="nofollow" target="_blank">黎跃春 —— 如何编写智能合约(Smart Contract)</a></p> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yz_yangzhi/article/details/79053824,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yz_yangzhi/article/details/79053824,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
