<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>区块链开发（四）web3j和web3.js对以太坊钱包功能的实现 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="区块链开发（四）web3j和web3.js对以太坊钱包功能的实现" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/cuiran/article/details/81045701 经过前面的环境搭建，现在开始通过web3j和web3.js来简单调用以太坊的api web3j的使用 首先是新建一个maven工程 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.cayden.ethereum&lt;/groupId&gt; &lt;artifactId&gt;ethsample&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.web3j&lt;/groupId&gt; &lt;artifactId&gt;core&lt;/artifactId&gt; &lt;version&gt;2.2.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/project&gt; 然后新建Web3JClient.java package com.cayden.ethereum.client; import org.web3j.protocol.Web3j; import org.web3j.protocol.http.HttpService; /** * Created by cuiran on 18/7/6. */ public class Web3JClient { private static String ip = &quot;http://127.0.0.1:8545/&quot;; private Web3JClient(){} private volatile static Web3j web3j; public static Web3j getClient(){ if(web3j==null){ synchronized (Web3JClient.class){ if(web3j==null){ web3j = Web3j.build(new HttpService(ip)); } } } return web3j; } } 在新建ParityClient.java package com.cayden.ethereum.client; import org.web3j.protocol.http.HttpService; import org.web3j.protocol.parity.Parity; /** * Created by cuiran on 18/7/6. */ public class ParityClient { private static String ip = &quot;http://127.0.0.1:8545/&quot;; private ParityClient(){} private static class ClientHolder{ private static final Parity parity = Parity.build(new HttpService(ip)); } public static final Parity getParity(){ return ClientHolder.parity; } } 然后创建一个AccountInfo类 package com.cayden.ethereum.pojo; /** * Created by cuiran on 18/7/6. */ public class AccountInfo { private String userName; private String phone; private String address; private String school; public String getUserName() { return userName; } public void setUserName(String userName) { this.userName = userName; } public String getPhone() { return phone; } public void setPhone(String phone) { this.phone = phone; } public String getAddress() { return address; } public void setAddress(String address) { this.address = address; } public String getSchool() { return school; } public void setSchool(String school) { this.school = school; } } 新建一个账户类Account package com.cayden.ethereum; import com.cayden.ethereum.client.ParityClient; import com.cayden.ethereum.client.Web3JClient; import com.cayden.ethereum.pojo.AccountInfo; import org.web3j.protocol.Web3j; import org.web3j.protocol.core.DefaultBlockParameter; import org.web3j.protocol.core.DefaultBlockParameterNumber; import org.web3j.protocol.core.methods.response.EthGetBalance; import org.web3j.protocol.parity.Parity; import org.web3j.protocol.parity.methods.response.NewAccountIdentifier; import org.web3j.protocol.parity.methods.response.PersonalAccountsInfo; import java.math.BigInteger; import java.util.HashMap; import java.util.List; import java.util.Map; /** * Created by cuiran on 18/7/6. */ public class Account { private static Parity parity = ParityClient.getParity(); private static Web3j web3j = Web3JClient.getClient(); /** * Life * Like this * Like that * Also * It&#39;s not the same with you think * @Author cuiran * */ public List&lt;String&gt; getAccountlist(){ try{ return parity.personalListAccounts().send().getAccountIds(); }catch (Exception e){ e.printStackTrace(); } return null; } public String createAccount(String accountName,String password,AccountInfo accountInfo){ try { NewAccountIdentifier newAccountIdentifier = parity.personalNewAccount(password).send(); if(newAccountIdentifier!=null){ String accountId = newAccountIdentifier.getAccountId(); parity.personalSetAccountName(accountId,accountName); Map&lt;String,Object&gt; account = new HashMap&lt;String,Object&gt;(); account.put(accountId,accountInfo); parity.personalSetAccountMeta(accountId,account); return accountId; } } catch (Exception e) { e.printStackTrace(); } return null; } public PersonalAccountsInfo.AccountsInfo getAccountInfo(String accountId){ try{ PersonalAccountsInfo personalAccountsInfo = parity.personalAccountsInfo().send(); return personalAccountsInfo.getAccountsInfo().get(accountId); }catch (Exception e){ e.printStackTrace(); } return null; } public BigInteger getBalance(String accountId){ try { DefaultBlockParameter defaultBlockParameter = new DefaultBlockParameterNumber(58); EthGetBalance ethGetBalance = parity.ethGetBalance(accountId,defaultBlockParameter).send(); if(ethGetBalance!=null){ return ethGetBalance.getBalance(); } }catch (Exception e){ e.printStackTrace(); } return null; } } 新建一个交易转账类 package com.cayden.ethereum; import com.cayden.ethereum.client.ParityClient; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.web3j.protocol.core.methods.request.Transaction; import org.web3j.protocol.core.methods.response.EthSendTransaction; import org.web3j.protocol.parity.Parity; import java.math.BigDecimal; import java.math.BigInteger; /** * Created by cuiran on 18/7/6. */ public class Trade { private static final Logger logger = LoggerFactory.getLogger(Trade.class); private static BigInteger nonce = new BigInteger(&quot;0&quot;); private static BigInteger gasPrice = new BigInteger(&quot;1&quot;); private static BigInteger gasLimit = new BigInteger(&quot;50&quot;); private Parity parity = ParityClient.getParity(); public boolean trasfer(String accountId,String passsword,String toAccountId, BigDecimal amount) { Transaction transaction = Transaction.createEtherTransaction(accountId,null,null,null,toAccountId,amount.toBigInteger()); try{ EthSendTransaction ethSendTransaction =parity.personalSignAndSendTransaction(transaction,passsword).send(); if(ethSendTransaction!=null){ String tradeHash = ethSendTransaction.getTransactionHash(); logger.info(&quot;账户:[{}]转账到账户:[{}],交易hash:[{}]&quot;,accountId,toAccountId,tradeHash); } }catch (Exception e){ logger.error(&quot;账户:[{}]交易失败!&quot;,accountId,e); } return false; } } 最后测试类如下 package com.cayden.ethereum; import com.cayden.ethereum.pojo.AccountInfo; import org.web3j.protocol.parity.methods.response.PersonalAccountsInfo; import java.math.BigDecimal; import java.math.BigInteger; import java.util.List; /** * Created by cuiran on 18/7/6. */ public class AccountTest { public static void main(String args[]) { // createAccount(); getBalance(); // queryAccount(); // trade(); // getAccountInfo(); } public static void getBalance(){ Account account = new Account(); BigInteger ba = account.getBalance(&quot;0xb258e5b1b30215b112881c13f22ab5a47a624b81&quot;); System.out.print(ba); } public static void getAccountInfo(){ Account account = new Account(); PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(&quot;0x5bd2328251e8abd5bc39393a9549586634785938&quot;); System.out.println(accountsInfo.toString()); } public static void queryAccount(){ Account account = new Account(); List&lt;String&gt; accounts = account.getAccountlist(); for(String accountId:accounts){ System.out.println(accountId); } } public static void trade(){ Trade trade = new Trade(); boolean result=trade.trasfer(&quot;0x1a95f4df6dbf7511b8ec820833df628ea743c458&quot;,&quot;123456&quot;,&quot;0x91140c3170f4aa959f09aff9b5393e9d0cd2a54c&quot;,new BigDecimal(5)); System.out.println(&quot;trade:&quot;+result); } public static void createAccount(){ Account account = new Account(); AccountInfo accountInfo = new AccountInfo(); accountInfo.setPhone(&quot;12345678901&quot;); accountInfo.setAddress(&quot;北街家园&quot;); accountInfo.setSchool(&quot;清华大学&quot;); accountInfo.setUserName(&quot;cayden&quot;); String accountId = account.createAccount(&quot;cayden&quot;,&quot;123456&quot;,accountInfo); System.out.println(&quot;注册账户成功:&quot;+accountId); // PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(&quot;0xad7bbca86e02e503076b06931e05938e51e49fb9&quot;); // System.out.println(accountsInfo.toString()); } } web3.js的使用 先引入web3.js文件 然后新建index.html &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;js/web3.js&quot;&gt;&lt;/script&gt; &lt;input type=&quot;button&quot; value=&quot;获取账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;创建账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;解锁账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;获取余额&quot;&gt; &lt;script&gt; var web3 = new Web3(new Web3.providers.HttpProvider(&quot;http://127.0.0.1:8545&quot;)); document.querySelectorAll(&quot;input&quot;)[0].onclick=function(){ //使用web3 的api 去操作节点。jsonrpc web3.eth.getAccounts(function(error,result){ console.log(result); var res=&quot;查询账号信息:&lt;br&gt;&quot;; for (var i=0;i&lt;result.length;i++){ res+=&quot;账号&quot;+(i+1)+&quot;:&quot;+result[i]+&quot;&lt;br&gt;&quot;; } document.getElementById(&quot;result&quot;).innerHTML=res; }); } document.querySelectorAll(&quot;input&quot;)[1].onclick=function(){ console.log(&quot;www&quot;); web3.personal.newAccount(&quot;123456&quot;,function(error,result){ console.log(result); }); } document.querySelectorAll(&quot;input&quot;)[2].onclick=function(){ web3.personal.unlockAccount(&quot;0x89ed26fe35814f839b8b62e5de09521280247cfd&quot;,&quot;123456&quot;,function(error,result){ console.log(result); console.log(&quot;解绑成功&quot;); }); } document.querySelectorAll(&quot;input&quot;)[3].onclick=function(){ web3.eth.getBalance(&quot;0xb258e5b1b30215b112881c13f22ab5a47a624b81&quot;,function(error,result){ console.log(result); document.getElementById(&quot;result&quot;).innerHTML=&quot;余额：&quot;+result.c[0]; console.log(&quot;获取余额成功&quot;); }); } &lt;/script&gt; &lt;div id=&quot;result&quot;&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 阅读更多" />
<meta property="og:description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/cuiran/article/details/81045701 经过前面的环境搭建，现在开始通过web3j和web3.js来简单调用以太坊的api web3j的使用 首先是新建一个maven工程 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.cayden.ethereum&lt;/groupId&gt; &lt;artifactId&gt;ethsample&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.web3j&lt;/groupId&gt; &lt;artifactId&gt;core&lt;/artifactId&gt; &lt;version&gt;2.2.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/project&gt; 然后新建Web3JClient.java package com.cayden.ethereum.client; import org.web3j.protocol.Web3j; import org.web3j.protocol.http.HttpService; /** * Created by cuiran on 18/7/6. */ public class Web3JClient { private static String ip = &quot;http://127.0.0.1:8545/&quot;; private Web3JClient(){} private volatile static Web3j web3j; public static Web3j getClient(){ if(web3j==null){ synchronized (Web3JClient.class){ if(web3j==null){ web3j = Web3j.build(new HttpService(ip)); } } } return web3j; } } 在新建ParityClient.java package com.cayden.ethereum.client; import org.web3j.protocol.http.HttpService; import org.web3j.protocol.parity.Parity; /** * Created by cuiran on 18/7/6. */ public class ParityClient { private static String ip = &quot;http://127.0.0.1:8545/&quot;; private ParityClient(){} private static class ClientHolder{ private static final Parity parity = Parity.build(new HttpService(ip)); } public static final Parity getParity(){ return ClientHolder.parity; } } 然后创建一个AccountInfo类 package com.cayden.ethereum.pojo; /** * Created by cuiran on 18/7/6. */ public class AccountInfo { private String userName; private String phone; private String address; private String school; public String getUserName() { return userName; } public void setUserName(String userName) { this.userName = userName; } public String getPhone() { return phone; } public void setPhone(String phone) { this.phone = phone; } public String getAddress() { return address; } public void setAddress(String address) { this.address = address; } public String getSchool() { return school; } public void setSchool(String school) { this.school = school; } } 新建一个账户类Account package com.cayden.ethereum; import com.cayden.ethereum.client.ParityClient; import com.cayden.ethereum.client.Web3JClient; import com.cayden.ethereum.pojo.AccountInfo; import org.web3j.protocol.Web3j; import org.web3j.protocol.core.DefaultBlockParameter; import org.web3j.protocol.core.DefaultBlockParameterNumber; import org.web3j.protocol.core.methods.response.EthGetBalance; import org.web3j.protocol.parity.Parity; import org.web3j.protocol.parity.methods.response.NewAccountIdentifier; import org.web3j.protocol.parity.methods.response.PersonalAccountsInfo; import java.math.BigInteger; import java.util.HashMap; import java.util.List; import java.util.Map; /** * Created by cuiran on 18/7/6. */ public class Account { private static Parity parity = ParityClient.getParity(); private static Web3j web3j = Web3JClient.getClient(); /** * Life * Like this * Like that * Also * It&#39;s not the same with you think * @Author cuiran * */ public List&lt;String&gt; getAccountlist(){ try{ return parity.personalListAccounts().send().getAccountIds(); }catch (Exception e){ e.printStackTrace(); } return null; } public String createAccount(String accountName,String password,AccountInfo accountInfo){ try { NewAccountIdentifier newAccountIdentifier = parity.personalNewAccount(password).send(); if(newAccountIdentifier!=null){ String accountId = newAccountIdentifier.getAccountId(); parity.personalSetAccountName(accountId,accountName); Map&lt;String,Object&gt; account = new HashMap&lt;String,Object&gt;(); account.put(accountId,accountInfo); parity.personalSetAccountMeta(accountId,account); return accountId; } } catch (Exception e) { e.printStackTrace(); } return null; } public PersonalAccountsInfo.AccountsInfo getAccountInfo(String accountId){ try{ PersonalAccountsInfo personalAccountsInfo = parity.personalAccountsInfo().send(); return personalAccountsInfo.getAccountsInfo().get(accountId); }catch (Exception e){ e.printStackTrace(); } return null; } public BigInteger getBalance(String accountId){ try { DefaultBlockParameter defaultBlockParameter = new DefaultBlockParameterNumber(58); EthGetBalance ethGetBalance = parity.ethGetBalance(accountId,defaultBlockParameter).send(); if(ethGetBalance!=null){ return ethGetBalance.getBalance(); } }catch (Exception e){ e.printStackTrace(); } return null; } } 新建一个交易转账类 package com.cayden.ethereum; import com.cayden.ethereum.client.ParityClient; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.web3j.protocol.core.methods.request.Transaction; import org.web3j.protocol.core.methods.response.EthSendTransaction; import org.web3j.protocol.parity.Parity; import java.math.BigDecimal; import java.math.BigInteger; /** * Created by cuiran on 18/7/6. */ public class Trade { private static final Logger logger = LoggerFactory.getLogger(Trade.class); private static BigInteger nonce = new BigInteger(&quot;0&quot;); private static BigInteger gasPrice = new BigInteger(&quot;1&quot;); private static BigInteger gasLimit = new BigInteger(&quot;50&quot;); private Parity parity = ParityClient.getParity(); public boolean trasfer(String accountId,String passsword,String toAccountId, BigDecimal amount) { Transaction transaction = Transaction.createEtherTransaction(accountId,null,null,null,toAccountId,amount.toBigInteger()); try{ EthSendTransaction ethSendTransaction =parity.personalSignAndSendTransaction(transaction,passsword).send(); if(ethSendTransaction!=null){ String tradeHash = ethSendTransaction.getTransactionHash(); logger.info(&quot;账户:[{}]转账到账户:[{}],交易hash:[{}]&quot;,accountId,toAccountId,tradeHash); } }catch (Exception e){ logger.error(&quot;账户:[{}]交易失败!&quot;,accountId,e); } return false; } } 最后测试类如下 package com.cayden.ethereum; import com.cayden.ethereum.pojo.AccountInfo; import org.web3j.protocol.parity.methods.response.PersonalAccountsInfo; import java.math.BigDecimal; import java.math.BigInteger; import java.util.List; /** * Created by cuiran on 18/7/6. */ public class AccountTest { public static void main(String args[]) { // createAccount(); getBalance(); // queryAccount(); // trade(); // getAccountInfo(); } public static void getBalance(){ Account account = new Account(); BigInteger ba = account.getBalance(&quot;0xb258e5b1b30215b112881c13f22ab5a47a624b81&quot;); System.out.print(ba); } public static void getAccountInfo(){ Account account = new Account(); PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(&quot;0x5bd2328251e8abd5bc39393a9549586634785938&quot;); System.out.println(accountsInfo.toString()); } public static void queryAccount(){ Account account = new Account(); List&lt;String&gt; accounts = account.getAccountlist(); for(String accountId:accounts){ System.out.println(accountId); } } public static void trade(){ Trade trade = new Trade(); boolean result=trade.trasfer(&quot;0x1a95f4df6dbf7511b8ec820833df628ea743c458&quot;,&quot;123456&quot;,&quot;0x91140c3170f4aa959f09aff9b5393e9d0cd2a54c&quot;,new BigDecimal(5)); System.out.println(&quot;trade:&quot;+result); } public static void createAccount(){ Account account = new Account(); AccountInfo accountInfo = new AccountInfo(); accountInfo.setPhone(&quot;12345678901&quot;); accountInfo.setAddress(&quot;北街家园&quot;); accountInfo.setSchool(&quot;清华大学&quot;); accountInfo.setUserName(&quot;cayden&quot;); String accountId = account.createAccount(&quot;cayden&quot;,&quot;123456&quot;,accountInfo); System.out.println(&quot;注册账户成功:&quot;+accountId); // PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(&quot;0xad7bbca86e02e503076b06931e05938e51e49fb9&quot;); // System.out.println(accountsInfo.toString()); } } web3.js的使用 先引入web3.js文件 然后新建index.html &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;js/web3.js&quot;&gt;&lt;/script&gt; &lt;input type=&quot;button&quot; value=&quot;获取账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;创建账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;解锁账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;获取余额&quot;&gt; &lt;script&gt; var web3 = new Web3(new Web3.providers.HttpProvider(&quot;http://127.0.0.1:8545&quot;)); document.querySelectorAll(&quot;input&quot;)[0].onclick=function(){ //使用web3 的api 去操作节点。jsonrpc web3.eth.getAccounts(function(error,result){ console.log(result); var res=&quot;查询账号信息:&lt;br&gt;&quot;; for (var i=0;i&lt;result.length;i++){ res+=&quot;账号&quot;+(i+1)+&quot;:&quot;+result[i]+&quot;&lt;br&gt;&quot;; } document.getElementById(&quot;result&quot;).innerHTML=res; }); } document.querySelectorAll(&quot;input&quot;)[1].onclick=function(){ console.log(&quot;www&quot;); web3.personal.newAccount(&quot;123456&quot;,function(error,result){ console.log(result); }); } document.querySelectorAll(&quot;input&quot;)[2].onclick=function(){ web3.personal.unlockAccount(&quot;0x89ed26fe35814f839b8b62e5de09521280247cfd&quot;,&quot;123456&quot;,function(error,result){ console.log(result); console.log(&quot;解绑成功&quot;); }); } document.querySelectorAll(&quot;input&quot;)[3].onclick=function(){ web3.eth.getBalance(&quot;0xb258e5b1b30215b112881c13f22ab5a47a624b81&quot;,function(error,result){ console.log(result); document.getElementById(&quot;result&quot;).innerHTML=&quot;余额：&quot;+result.c[0]; console.log(&quot;获取余额成功&quot;); }); } &lt;/script&gt; &lt;div id=&quot;result&quot;&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/07/14/fe74b9b91e1c722d85eccfbc0a0aad6b.html" />
<meta property="og:url" content="https://mlh.app/2018/07/14/fe74b9b91e1c722d85eccfbc0a0aad6b.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-14T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/cuiran/article/details/81045701 经过前面的环境搭建，现在开始通过web3j和web3.js来简单调用以太坊的api web3j的使用 首先是新建一个maven工程 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.cayden.ethereum&lt;/groupId&gt; &lt;artifactId&gt;ethsample&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.web3j&lt;/groupId&gt; &lt;artifactId&gt;core&lt;/artifactId&gt; &lt;version&gt;2.2.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/project&gt; 然后新建Web3JClient.java package com.cayden.ethereum.client; import org.web3j.protocol.Web3j; import org.web3j.protocol.http.HttpService; /** * Created by cuiran on 18/7/6. */ public class Web3JClient { private static String ip = &quot;http://127.0.0.1:8545/&quot;; private Web3JClient(){} private volatile static Web3j web3j; public static Web3j getClient(){ if(web3j==null){ synchronized (Web3JClient.class){ if(web3j==null){ web3j = Web3j.build(new HttpService(ip)); } } } return web3j; } } 在新建ParityClient.java package com.cayden.ethereum.client; import org.web3j.protocol.http.HttpService; import org.web3j.protocol.parity.Parity; /** * Created by cuiran on 18/7/6. */ public class ParityClient { private static String ip = &quot;http://127.0.0.1:8545/&quot;; private ParityClient(){} private static class ClientHolder{ private static final Parity parity = Parity.build(new HttpService(ip)); } public static final Parity getParity(){ return ClientHolder.parity; } } 然后创建一个AccountInfo类 package com.cayden.ethereum.pojo; /** * Created by cuiran on 18/7/6. */ public class AccountInfo { private String userName; private String phone; private String address; private String school; public String getUserName() { return userName; } public void setUserName(String userName) { this.userName = userName; } public String getPhone() { return phone; } public void setPhone(String phone) { this.phone = phone; } public String getAddress() { return address; } public void setAddress(String address) { this.address = address; } public String getSchool() { return school; } public void setSchool(String school) { this.school = school; } } 新建一个账户类Account package com.cayden.ethereum; import com.cayden.ethereum.client.ParityClient; import com.cayden.ethereum.client.Web3JClient; import com.cayden.ethereum.pojo.AccountInfo; import org.web3j.protocol.Web3j; import org.web3j.protocol.core.DefaultBlockParameter; import org.web3j.protocol.core.DefaultBlockParameterNumber; import org.web3j.protocol.core.methods.response.EthGetBalance; import org.web3j.protocol.parity.Parity; import org.web3j.protocol.parity.methods.response.NewAccountIdentifier; import org.web3j.protocol.parity.methods.response.PersonalAccountsInfo; import java.math.BigInteger; import java.util.HashMap; import java.util.List; import java.util.Map; /** * Created by cuiran on 18/7/6. */ public class Account { private static Parity parity = ParityClient.getParity(); private static Web3j web3j = Web3JClient.getClient(); /** * Life * Like this * Like that * Also * It&#39;s not the same with you think * @Author cuiran * */ public List&lt;String&gt; getAccountlist(){ try{ return parity.personalListAccounts().send().getAccountIds(); }catch (Exception e){ e.printStackTrace(); } return null; } public String createAccount(String accountName,String password,AccountInfo accountInfo){ try { NewAccountIdentifier newAccountIdentifier = parity.personalNewAccount(password).send(); if(newAccountIdentifier!=null){ String accountId = newAccountIdentifier.getAccountId(); parity.personalSetAccountName(accountId,accountName); Map&lt;String,Object&gt; account = new HashMap&lt;String,Object&gt;(); account.put(accountId,accountInfo); parity.personalSetAccountMeta(accountId,account); return accountId; } } catch (Exception e) { e.printStackTrace(); } return null; } public PersonalAccountsInfo.AccountsInfo getAccountInfo(String accountId){ try{ PersonalAccountsInfo personalAccountsInfo = parity.personalAccountsInfo().send(); return personalAccountsInfo.getAccountsInfo().get(accountId); }catch (Exception e){ e.printStackTrace(); } return null; } public BigInteger getBalance(String accountId){ try { DefaultBlockParameter defaultBlockParameter = new DefaultBlockParameterNumber(58); EthGetBalance ethGetBalance = parity.ethGetBalance(accountId,defaultBlockParameter).send(); if(ethGetBalance!=null){ return ethGetBalance.getBalance(); } }catch (Exception e){ e.printStackTrace(); } return null; } } 新建一个交易转账类 package com.cayden.ethereum; import com.cayden.ethereum.client.ParityClient; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.web3j.protocol.core.methods.request.Transaction; import org.web3j.protocol.core.methods.response.EthSendTransaction; import org.web3j.protocol.parity.Parity; import java.math.BigDecimal; import java.math.BigInteger; /** * Created by cuiran on 18/7/6. */ public class Trade { private static final Logger logger = LoggerFactory.getLogger(Trade.class); private static BigInteger nonce = new BigInteger(&quot;0&quot;); private static BigInteger gasPrice = new BigInteger(&quot;1&quot;); private static BigInteger gasLimit = new BigInteger(&quot;50&quot;); private Parity parity = ParityClient.getParity(); public boolean trasfer(String accountId,String passsword,String toAccountId, BigDecimal amount) { Transaction transaction = Transaction.createEtherTransaction(accountId,null,null,null,toAccountId,amount.toBigInteger()); try{ EthSendTransaction ethSendTransaction =parity.personalSignAndSendTransaction(transaction,passsword).send(); if(ethSendTransaction!=null){ String tradeHash = ethSendTransaction.getTransactionHash(); logger.info(&quot;账户:[{}]转账到账户:[{}],交易hash:[{}]&quot;,accountId,toAccountId,tradeHash); } }catch (Exception e){ logger.error(&quot;账户:[{}]交易失败!&quot;,accountId,e); } return false; } } 最后测试类如下 package com.cayden.ethereum; import com.cayden.ethereum.pojo.AccountInfo; import org.web3j.protocol.parity.methods.response.PersonalAccountsInfo; import java.math.BigDecimal; import java.math.BigInteger; import java.util.List; /** * Created by cuiran on 18/7/6. */ public class AccountTest { public static void main(String args[]) { // createAccount(); getBalance(); // queryAccount(); // trade(); // getAccountInfo(); } public static void getBalance(){ Account account = new Account(); BigInteger ba = account.getBalance(&quot;0xb258e5b1b30215b112881c13f22ab5a47a624b81&quot;); System.out.print(ba); } public static void getAccountInfo(){ Account account = new Account(); PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(&quot;0x5bd2328251e8abd5bc39393a9549586634785938&quot;); System.out.println(accountsInfo.toString()); } public static void queryAccount(){ Account account = new Account(); List&lt;String&gt; accounts = account.getAccountlist(); for(String accountId:accounts){ System.out.println(accountId); } } public static void trade(){ Trade trade = new Trade(); boolean result=trade.trasfer(&quot;0x1a95f4df6dbf7511b8ec820833df628ea743c458&quot;,&quot;123456&quot;,&quot;0x91140c3170f4aa959f09aff9b5393e9d0cd2a54c&quot;,new BigDecimal(5)); System.out.println(&quot;trade:&quot;+result); } public static void createAccount(){ Account account = new Account(); AccountInfo accountInfo = new AccountInfo(); accountInfo.setPhone(&quot;12345678901&quot;); accountInfo.setAddress(&quot;北街家园&quot;); accountInfo.setSchool(&quot;清华大学&quot;); accountInfo.setUserName(&quot;cayden&quot;); String accountId = account.createAccount(&quot;cayden&quot;,&quot;123456&quot;,accountInfo); System.out.println(&quot;注册账户成功:&quot;+accountId); // PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(&quot;0xad7bbca86e02e503076b06931e05938e51e49fb9&quot;); // System.out.println(accountsInfo.toString()); } } web3.js的使用 先引入web3.js文件 然后新建index.html &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;js/web3.js&quot;&gt;&lt;/script&gt; &lt;input type=&quot;button&quot; value=&quot;获取账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;创建账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;解锁账号&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;获取余额&quot;&gt; &lt;script&gt; var web3 = new Web3(new Web3.providers.HttpProvider(&quot;http://127.0.0.1:8545&quot;)); document.querySelectorAll(&quot;input&quot;)[0].onclick=function(){ //使用web3 的api 去操作节点。jsonrpc web3.eth.getAccounts(function(error,result){ console.log(result); var res=&quot;查询账号信息:&lt;br&gt;&quot;; for (var i=0;i&lt;result.length;i++){ res+=&quot;账号&quot;+(i+1)+&quot;:&quot;+result[i]+&quot;&lt;br&gt;&quot;; } document.getElementById(&quot;result&quot;).innerHTML=res; }); } document.querySelectorAll(&quot;input&quot;)[1].onclick=function(){ console.log(&quot;www&quot;); web3.personal.newAccount(&quot;123456&quot;,function(error,result){ console.log(result); }); } document.querySelectorAll(&quot;input&quot;)[2].onclick=function(){ web3.personal.unlockAccount(&quot;0x89ed26fe35814f839b8b62e5de09521280247cfd&quot;,&quot;123456&quot;,function(error,result){ console.log(result); console.log(&quot;解绑成功&quot;); }); } document.querySelectorAll(&quot;input&quot;)[3].onclick=function(){ web3.eth.getBalance(&quot;0xb258e5b1b30215b112881c13f22ab5a47a624b81&quot;,function(error,result){ console.log(result); document.getElementById(&quot;result&quot;).innerHTML=&quot;余额：&quot;+result.c[0]; console.log(&quot;获取余额成功&quot;); }); } &lt;/script&gt; &lt;div id=&quot;result&quot;&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/07/14/fe74b9b91e1c722d85eccfbc0a0aad6b.html","headline":"区块链开发（四）web3j和web3.js对以太坊钱包功能的实现","dateModified":"2018-07-14T00:00:00+08:00","datePublished":"2018-07-14T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/07/14/fe74b9b91e1c722d85eccfbc0a0aad6b.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>区块链开发（四）web3j和web3.js对以太坊钱包功能的实现</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/cuiran/article/details/81045701 
 </div> 
 <div class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p>经过前面的环境搭建，现在开始通过web3j和web3.js来简单调用以太坊的api</p> 
  <h3 id="web3j的使用">web3j的使用</h3> 
  <p>首先是新建一个maven工程</p> 
  <pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">project</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-title">modelVersion</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.cayden.ethereum<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>ethsample<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.web3j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>core<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.2.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.7.2<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">dependencies</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">project</span>&gt;</span></code></pre> 
  <p>然后新建Web3JClient.java</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.cayden.ethereum.client;

<span class="hljs-keyword">import</span> org.web3j.protocol.Web3j;
<span class="hljs-keyword">import</span> org.web3j.protocol.http.HttpService;

<span class="hljs-javadoc">/** * Created by cuiran on 18/7/6. */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Web3JClient</span> {</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String ip = <span class="hljs-string">"http://127.0.0.1:8545/"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-title">Web3JClient</span>(){}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> Web3j web3j;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Web3j <span class="hljs-title">getClient</span>(){
        <span class="hljs-keyword">if</span>(web3j==<span class="hljs-keyword">null</span>){
            <span class="hljs-keyword">synchronized</span> (Web3JClient.class){
                <span class="hljs-keyword">if</span>(web3j==<span class="hljs-keyword">null</span>){
                    web3j = Web3j.build(<span class="hljs-keyword">new</span> HttpService(ip));
                }
            }
        }
        <span class="hljs-keyword">return</span> web3j;
    }
}
</code></pre> 
  <p>在新建ParityClient.java</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.cayden.ethereum.client;

<span class="hljs-keyword">import</span> org.web3j.protocol.http.HttpService;
<span class="hljs-keyword">import</span> org.web3j.protocol.parity.Parity;

<span class="hljs-javadoc">/** * Created by cuiran on 18/7/6. */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParityClient</span> {</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String ip = <span class="hljs-string">"http://127.0.0.1:8545/"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-title">ParityClient</span>(){}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientHolder</span>{</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Parity parity = Parity.build(<span class="hljs-keyword">new</span> HttpService(ip));
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Parity <span class="hljs-title">getParity</span>(){
        <span class="hljs-keyword">return</span> ClientHolder.parity;
    }
}
</code></pre> 
  <p>然后创建一个AccountInfo类</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.cayden.ethereum.pojo;

<span class="hljs-javadoc">/** * Created by cuiran on 18/7/6. */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountInfo</span> {</span>
    <span class="hljs-keyword">private</span> String userName;
    <span class="hljs-keyword">private</span> String phone;
    <span class="hljs-keyword">private</span> String address;
    <span class="hljs-keyword">private</span> String school;
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getUserName</span>() {
        <span class="hljs-keyword">return</span> userName;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserName</span>(String userName) {
        <span class="hljs-keyword">this</span>.userName = userName;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getPhone</span>() {
        <span class="hljs-keyword">return</span> phone;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPhone</span>(String phone) {
        <span class="hljs-keyword">this</span>.phone = phone;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getAddress</span>() {
        <span class="hljs-keyword">return</span> address;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAddress</span>(String address) {
        <span class="hljs-keyword">this</span>.address = address;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getSchool</span>() {
        <span class="hljs-keyword">return</span> school;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSchool</span>(String school) {
        <span class="hljs-keyword">this</span>.school = school;
    }
}
</code></pre> 
  <p>新建一个账户类Account</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.cayden.ethereum;

<span class="hljs-keyword">import</span> com.cayden.ethereum.client.ParityClient;
<span class="hljs-keyword">import</span> com.cayden.ethereum.client.Web3JClient;
<span class="hljs-keyword">import</span> com.cayden.ethereum.pojo.AccountInfo;
<span class="hljs-keyword">import</span> org.web3j.protocol.Web3j;
<span class="hljs-keyword">import</span> org.web3j.protocol.core.DefaultBlockParameter;
<span class="hljs-keyword">import</span> org.web3j.protocol.core.DefaultBlockParameterNumber;
<span class="hljs-keyword">import</span> org.web3j.protocol.core.methods.response.EthGetBalance;
<span class="hljs-keyword">import</span> org.web3j.protocol.parity.Parity;
<span class="hljs-keyword">import</span> org.web3j.protocol.parity.methods.response.NewAccountIdentifier;
<span class="hljs-keyword">import</span> org.web3j.protocol.parity.methods.response.PersonalAccountsInfo;

<span class="hljs-keyword">import</span> java.math.BigInteger;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-javadoc">/** * Created by cuiran on 18/7/6. */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span> {</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Parity parity = ParityClient.getParity();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Web3j web3j = Web3JClient.getClient();
    <span class="hljs-javadoc">/** * Life * Like this * Like that * Also * It's not the same with you think *<span class="hljs-javadoctag"> @Author</span> cuiran * */</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">getAccountlist</span>(){
        <span class="hljs-keyword">try</span>{
            <span class="hljs-keyword">return</span>  parity.personalListAccounts().send().getAccountIds();
        }<span class="hljs-keyword">catch</span> (Exception e){
            e.printStackTrace();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">createAccount</span>(String accountName,String password,AccountInfo accountInfo){
        <span class="hljs-keyword">try</span> {
            NewAccountIdentifier newAccountIdentifier = parity.personalNewAccount(password).send();
            <span class="hljs-keyword">if</span>(newAccountIdentifier!=<span class="hljs-keyword">null</span>){
                String accountId = newAccountIdentifier.getAccountId();
                parity.personalSetAccountName(accountId,accountName);
                Map&lt;String,Object&gt; account = <span class="hljs-keyword">new</span> HashMap&lt;String,Object&gt;();
                account.put(accountId,accountInfo);
                parity.personalSetAccountMeta(accountId,account);
                <span class="hljs-keyword">return</span>  accountId;
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
    <span class="hljs-keyword">public</span> PersonalAccountsInfo.AccountsInfo <span class="hljs-title">getAccountInfo</span>(String accountId){
        <span class="hljs-keyword">try</span>{
            PersonalAccountsInfo personalAccountsInfo = parity.personalAccountsInfo().send();
            <span class="hljs-keyword">return</span>  personalAccountsInfo.getAccountsInfo().get(accountId);
        }<span class="hljs-keyword">catch</span> (Exception e){
            e.printStackTrace();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
    <span class="hljs-keyword">public</span> BigInteger <span class="hljs-title">getBalance</span>(String accountId){
        <span class="hljs-keyword">try</span> {
            DefaultBlockParameter defaultBlockParameter = <span class="hljs-keyword">new</span> DefaultBlockParameterNumber(<span class="hljs-number">58</span>);
            EthGetBalance ethGetBalance =  parity.ethGetBalance(accountId,defaultBlockParameter).send();
            <span class="hljs-keyword">if</span>(ethGetBalance!=<span class="hljs-keyword">null</span>){
                <span class="hljs-keyword">return</span> ethGetBalance.getBalance();
            }
        }<span class="hljs-keyword">catch</span> (Exception e){
            e.printStackTrace();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
}
</code></pre> 
  <p>新建一个交易转账类</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.cayden.ethereum;

<span class="hljs-keyword">import</span> com.cayden.ethereum.client.ParityClient;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;
<span class="hljs-keyword">import</span> org.web3j.protocol.core.methods.request.Transaction;
<span class="hljs-keyword">import</span> org.web3j.protocol.core.methods.response.EthSendTransaction;
<span class="hljs-keyword">import</span> org.web3j.protocol.parity.Parity;

<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.math.BigInteger;


<span class="hljs-javadoc">/** * Created by cuiran on 18/7/6. */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Trade</span> {</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger logger = LoggerFactory.getLogger(Trade.class);
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> BigInteger nonce = <span class="hljs-keyword">new</span> BigInteger(<span class="hljs-string">"0"</span>);
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> BigInteger gasPrice = <span class="hljs-keyword">new</span> BigInteger(<span class="hljs-string">"1"</span>);
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> BigInteger gasLimit = <span class="hljs-keyword">new</span> BigInteger(<span class="hljs-string">"50"</span>);
    <span class="hljs-keyword">private</span> Parity parity = ParityClient.getParity();
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">trasfer</span>(String accountId,String passsword,String toAccountId, BigDecimal amount)  {
        Transaction transaction = Transaction.createEtherTransaction(accountId,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span>,toAccountId,amount.toBigInteger());
        <span class="hljs-keyword">try</span>{
            EthSendTransaction ethSendTransaction =parity.personalSignAndSendTransaction(transaction,passsword).send();
            <span class="hljs-keyword">if</span>(ethSendTransaction!=<span class="hljs-keyword">null</span>){
                String tradeHash = ethSendTransaction.getTransactionHash();
                logger.info(<span class="hljs-string">"账户:[{}]转账到账户:[{}],交易hash:[{}]"</span>,accountId,toAccountId,tradeHash);
            }
        }<span class="hljs-keyword">catch</span> (Exception e){
            logger.error(<span class="hljs-string">"账户:[{}]交易失败!"</span>,accountId,e);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }
}
</code></pre> 
  <p>最后测试类如下</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.cayden.ethereum;

<span class="hljs-keyword">import</span> com.cayden.ethereum.pojo.AccountInfo;
<span class="hljs-keyword">import</span> org.web3j.protocol.parity.methods.response.PersonalAccountsInfo;

<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.math.BigInteger;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-javadoc">/** * Created by cuiran on 18/7/6. */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountTest</span> {</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(String args[]) {
<span class="hljs-comment">// createAccount();</span>

        getBalance();

<span class="hljs-comment">// queryAccount();</span>
<span class="hljs-comment">// trade();</span>

<span class="hljs-comment">// getAccountInfo();</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getBalance</span>(){
        Account account = <span class="hljs-keyword">new</span> Account();
        BigInteger ba = account.getBalance(<span class="hljs-string">"0xb258e5b1b30215b112881c13f22ab5a47a624b81"</span>);
        System.out.print(ba);



    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getAccountInfo</span>(){
        Account account = <span class="hljs-keyword">new</span> Account();
        PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo(<span class="hljs-string">"0x5bd2328251e8abd5bc39393a9549586634785938"</span>);
        System.out.println(accountsInfo.toString());


    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>  <span class="hljs-keyword">void</span> <span class="hljs-title">queryAccount</span>(){
        Account account = <span class="hljs-keyword">new</span> Account();
        List&lt;String&gt; accounts = account.getAccountlist();
        <span class="hljs-keyword">for</span>(String accountId:accounts){
            System.out.println(accountId);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">trade</span>(){
        Trade trade = <span class="hljs-keyword">new</span> Trade();
        <span class="hljs-keyword">boolean</span> result=trade.trasfer(<span class="hljs-string">"0x1a95f4df6dbf7511b8ec820833df628ea743c458"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"0x91140c3170f4aa959f09aff9b5393e9d0cd2a54c"</span>,<span class="hljs-keyword">new</span> BigDecimal(<span class="hljs-number">5</span>));
        System.out.println(<span class="hljs-string">"trade:"</span>+result);

    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createAccount</span>(){
        Account account = <span class="hljs-keyword">new</span> Account();
        AccountInfo accountInfo = <span class="hljs-keyword">new</span> AccountInfo();
        accountInfo.setPhone(<span class="hljs-string">"12345678901"</span>);
        accountInfo.setAddress(<span class="hljs-string">"北街家园"</span>);
        accountInfo.setSchool(<span class="hljs-string">"清华大学"</span>);
        accountInfo.setUserName(<span class="hljs-string">"cayden"</span>);
        String accountId = account.createAccount(<span class="hljs-string">"cayden"</span>,<span class="hljs-string">"123456"</span>,accountInfo);
        System.out.println(<span class="hljs-string">"注册账户成功:"</span>+accountId);
<span class="hljs-comment">// PersonalAccountsInfo.AccountsInfo accountsInfo = account.getAccountInfo("0xad7bbca86e02e503076b06931e05938e51e49fb9");</span>
<span class="hljs-comment">// System.out.println(accountsInfo.toString());</span>
    }
}
</code></pre> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180714173715495?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aXJhbg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p> 
  <h3 id="web3js的使用">web3.js的使用</h3> 
  <p>先引入web3.js文件 <br> 然后新建index.html</p> 
  <pre class="prettyprint"><code class=" hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span> <span class="hljs-attribute">lang</span>=<span class="hljs-value">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"js/web3.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"获取账号"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"创建账号"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"解锁账号"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"获取余额"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">var</span> web3 = <span class="hljs-keyword">new</span> Web3(<span class="hljs-keyword">new</span> Web3.providers.HttpProvider(<span class="hljs-string">"http://127.0.0.1:8545"</span>)); document.querySelectorAll(<span class="hljs-string">"input"</span>)[<span class="hljs-number">0</span>].onclick=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span> <span class="hljs-comment">//使用web3 的api 去操作节点。jsonrpc</span> web3.eth.getAccounts(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error,result)</span>{</span> console.log(result); <span class="hljs-keyword">var</span> res=<span class="hljs-string">"查询账号信息:&lt;br&gt;"</span>; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;result.length;i++){ res+=<span class="hljs-string">"账号"</span>+(i+<span class="hljs-number">1</span>)+<span class="hljs-string">":"</span>+result[i]+<span class="hljs-string">"&lt;br&gt;"</span>; } document.getElementById(<span class="hljs-string">"result"</span>).innerHTML=res; }); } document.querySelectorAll(<span class="hljs-string">"input"</span>)[<span class="hljs-number">1</span>].onclick=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span> console.log(<span class="hljs-string">"www"</span>); web3.personal.newAccount(<span class="hljs-string">"123456"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error,result)</span>{</span> console.log(result); }); } document.querySelectorAll(<span class="hljs-string">"input"</span>)[<span class="hljs-number">2</span>].onclick=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span> web3.personal.unlockAccount(<span class="hljs-string">"0x89ed26fe35814f839b8b62e5de09521280247cfd"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error,result)</span>{</span> console.log(result); console.log(<span class="hljs-string">"解绑成功"</span>); }); } document.querySelectorAll(<span class="hljs-string">"input"</span>)[<span class="hljs-number">3</span>].onclick=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span> web3.eth.getBalance(<span class="hljs-string">"0xb258e5b1b30215b112881c13f22ab5a47a624b81"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error,result)</span>{</span> console.log(result); document.getElementById(<span class="hljs-string">"result"</span>).innerHTML=<span class="hljs-string">"余额："</span>+result.c[<span class="hljs-number">0</span>]; console.log(<span class="hljs-string">"获取余额成功"</span>); }); } </span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"result"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180714173727432?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N1aXJhbg==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述" title=""></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-778f64ae39.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/cuiran/article/details/81045701,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/cuiran/article/details/81045701,&quot;}">阅读更多</a> 
</div> 
<script>
						(function(){
							function setArticleH(btnReadmore,posi){
								var winH = $(window).height();
								var articleBox = $("div.article_content");
								var artH = articleBox.height();
								if(artH > winH*posi){
									articleBox.css({
										'height':winH*posi+'px',
										'overflow':'hidden'
									})
									btnReadmore.click(function(){
										articleBox.removeAttr("style");
										$(this).parent().remove();
									})
								}else{
									btnReadmore.parent().remove();
								}
							}
							var btnReadmore = $("#btn-readmore");
							if(btnReadmore.length>0){
								if(currentUserName){
									setArticleH(btnReadmore,3);
								}else{
									setArticleH(btnReadmore,1.2);
								}
							}
						})()
					</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
