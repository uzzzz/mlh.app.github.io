<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>EOS多节点环境配置(搭建自己的EOS主网) | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="EOS多节点环境配置(搭建自己的EOS主网)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="本文使用了四台同网段的主机，第一台做为eosio创世用户使用，另外三台做为出块者节点使用，最终实现了EOS多主机多节点的配置。最后EOSIO创世用户不再出块，由选举出来的各个节点轮流出块，下面将介绍具体的操作流程。 EOS versio: 1.0.8 system: ubuntu1804 四台服务器节点名称与对应IP： eosio &nbsp; &nbsp;192.168.154.157 zero &nbsp; &nbsp; &nbsp;192.168.154.190 two &nbsp; &nbsp; &nbsp; &nbsp;192.168.154.132 &nbsp; four &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;192.168.154.114 &nbsp; 一、安装EOS 1、获取源码：git clone https://github.com/EOSIO/eos --recursive 2、cd eos 3、sudo vi ./contracts/eosio.system/voting.cpp +80 将21改成3 top_producers.reserve(3); for ( auto it = idx.cbegin(); it != idx.cend() &amp;&amp; top_producers.size() &lt; 3 &amp;&amp; 0 &lt; it-&gt;total_votes &amp;&amp; it-&gt;active(); ++it ) { top_producers.emplace_back( std::pair&lt;eosio::producer_key,uint16_t&gt;({{it-&gt;owner, it-&gt;producer_key}, it-&gt;location}) ); } 4、编译源码&nbsp;./eosio_build.sh &nbsp; &nbsp; &nbsp; &nbsp;cd build &nbsp; &nbsp; &nbsp;sudo make install 二、修改配置文件 1、对四台主机都在命令行先运行nodeos与keosd，让其产生各自的配置文件。 &nbsp; &nbsp; &nbsp; 配置文件路径一般为：~/.local/share/eosio/nodeos/config/config.ini 2、为三个用户创建三组密钥对 cleos create key account zero: Private key: 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF Public key: EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj account two: Private key: 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF Public key: EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb account four: Private key: 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm Public key: EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe 3、修改创世节点配置文件 eosio sign的密钥对（被记录在./tutorials/bios-boot-tutorial/genesis.json的initial_key里面）: EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p eosio key的密钥对（被记录在默认的eosio配置文件的signature-provider里面）： EOS6MRyAjQq8ud7hVNYcfnVPJqcVpscN5So8BhtHuGYqET5GDW5CV 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3 注意：要改这俩秘钥的话需要同步更改配置文件和创世节点里对应的密钥对 p2p-server-address = 192.168.154.157:9876 p2p-peer-address = 192.168.154.114:9876 p2p-peer-address = 192.168.154.132:9876 p2p-peer-address = 192.168.154.190:9876 enable-stale-production = true producer-name = eosio unlock-timeout = 90000 plugin = eosio::producer_plugin plugin = eosio::wallet_api_plugin plugin = eosio::chain_api_plugin plugin = eosio::chain_plugin plugin = eosio::http_plugin plugin = eosio::http_client_plugin plugin = eosio::bnet_plugin plugin = eosio::net_plugin plugin = eosio::net_api_plugin plugin = eosio::history_api_plugin plugin = eosio::history_plugin &nbsp; 4、修改其他节点配置文件 p2p-server-address = 192.168.154.132:9876 p2p-peer-address = 192.168.154.114:9876 p2p-peer-address = 192.168.154.157:9876 p2p-peer-address = 192.168.154.190:9876 enable-stale-production = false producer-name = two signature-provider = EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb=KEY:5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF plugin = eosio::chain_api_plugin plugin = eosio::history_api_plugin plugin = eosio::chain_plugin plugin = eosio::history_plugin plugin = eosio::net_plugin plugin = eosio::net_api_plugin 注意：不同的节点p2p-server-address和signature-provider需要改动，对应不同用户的IP和秘钥 三、创建钱包，导入秘钥 1、创建并解锁钱包 bee2@ubuntu:~/eos$ cleos wallet create Creating wallet: default Save password to use in the future to unlock this wallet. Without password imported keys will not be retrievable. &quot;PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT&quot;&nbsp;&nbsp; &nbsp; bee2@ubuntu:~/eos$ cleos wallet unlock --password PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT &nbsp; &nbsp; 出现解锁成功或者Error 3120007: Already unlocked字样即可 2、导入三个普通用户和创世节点eosio（eosio key ,eosio sign）的秘钥： cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p 注意：最后两个秘钥必须导入，不然会提示各种权限不足的错误 四、创建九个系统账户 &nbsp; &nbsp; &nbsp;这九个系统用户的名称及其作用如下说明： &nbsp; &nbsp; &nbsp;eosio.bpay:矿工获取出块奖励的临时代管账户，增发EOS的1%的25%会先转到这个账户; &nbsp; &nbsp; &nbsp;eosio.msig:多重签名管理的账户; &nbsp; &nbsp; &nbsp;eosio.names:靓号账户拍卖管理的账户; &nbsp; &nbsp; &nbsp;eosio.ram:内存买卖管理的账户; &nbsp; &nbsp; &nbsp;eosio.ramfee:内存买卖收取手续费的账户，按照每笔交易千分之5的费率收取手续费; &nbsp; &nbsp; &nbsp;eosio.saving:增发EOS临时存放账户，增发总量 5%，其中80%放在此账户，另外 20%再分成25%和75%，分别给eosio.bpay和eosio.vpay; &nbsp; &nbsp; &nbsp;eosio.stake:管理EOS抵押的账户; &nbsp; &nbsp; &nbsp;eosio.token:发行和管理token的账户; &nbsp; &nbsp; &nbsp;eosio.vpay:矿工按照获得投票多少比例获取奖励的临时代管账户，增发EOS的1%的75%会先转到这个账户. cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.bpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.msig EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.names EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ram EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ramfee EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.saving EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.stake EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.token EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.vpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr 五、加载四大合约，发行代币 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.token ~/eos/build/contracts/eosio.token/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.msig ~/eos/build/contracts/eosio.msig/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token create &#39;[&quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;]&#39; -p eosio.token cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token issue &#39;[&quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;, &quot;memo&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio ~/eos/build/contracts/eosio.system/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio setpriv &#39;[&quot;eosio.msig&quot;, 1]&#39; -p eosio@active 六、创建普通用户 &nbsp; &nbsp;加载了eosio.system之后就不能使用create account命令了，只能用system newaccount创建账户 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio zero &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio two &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio four &quot;20000.0000 SYS&quot; 七、注册节点候选人 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe &nbsp; &nbsp; &nbsp; &nbsp; 可以用下列命令查看节点候选人： &nbsp; &nbsp; &nbsp; &nbsp; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system listproducers 八、给创建的账户转账 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;zero&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;two&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;four&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio 九、使用命令进行投票（自己给自己投票） cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods zero zero cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods two two cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods four four 十、结尾 过一段时间后就能看到节点轮流产块，创世节点只需同步块，如下所示 本文是在学习了q_776355102的博客后做的简单总结，有诸多详细命令请参考原文： https://blog.csdn.net/weixin_39842528/article/details/81034018 十一、更改节点出块数目 按上面的步骤可以让节点轮流出块了，但是每个节点出块个数是12，而不是像官网白皮书说的那样是6个，修改下相关代码就可以让节点出块个数变为6。 执行指令：vi libraries/chain/include/eosio/chain/config.hpp +99 //const static int producer_repetitions = 12; const static int producer_repetitions = 6; 保存退出之后编译下源码，在按照上面的步骤再来一遍就可以看到如下界面： &nbsp; &nbsp; &nbsp; &nbsp; 阅读更多" />
<meta property="og:description" content="本文使用了四台同网段的主机，第一台做为eosio创世用户使用，另外三台做为出块者节点使用，最终实现了EOS多主机多节点的配置。最后EOSIO创世用户不再出块，由选举出来的各个节点轮流出块，下面将介绍具体的操作流程。 EOS versio: 1.0.8 system: ubuntu1804 四台服务器节点名称与对应IP： eosio &nbsp; &nbsp;192.168.154.157 zero &nbsp; &nbsp; &nbsp;192.168.154.190 two &nbsp; &nbsp; &nbsp; &nbsp;192.168.154.132 &nbsp; four &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;192.168.154.114 &nbsp; 一、安装EOS 1、获取源码：git clone https://github.com/EOSIO/eos --recursive 2、cd eos 3、sudo vi ./contracts/eosio.system/voting.cpp +80 将21改成3 top_producers.reserve(3); for ( auto it = idx.cbegin(); it != idx.cend() &amp;&amp; top_producers.size() &lt; 3 &amp;&amp; 0 &lt; it-&gt;total_votes &amp;&amp; it-&gt;active(); ++it ) { top_producers.emplace_back( std::pair&lt;eosio::producer_key,uint16_t&gt;({{it-&gt;owner, it-&gt;producer_key}, it-&gt;location}) ); } 4、编译源码&nbsp;./eosio_build.sh &nbsp; &nbsp; &nbsp; &nbsp;cd build &nbsp; &nbsp; &nbsp;sudo make install 二、修改配置文件 1、对四台主机都在命令行先运行nodeos与keosd，让其产生各自的配置文件。 &nbsp; &nbsp; &nbsp; 配置文件路径一般为：~/.local/share/eosio/nodeos/config/config.ini 2、为三个用户创建三组密钥对 cleos create key account zero: Private key: 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF Public key: EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj account two: Private key: 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF Public key: EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb account four: Private key: 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm Public key: EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe 3、修改创世节点配置文件 eosio sign的密钥对（被记录在./tutorials/bios-boot-tutorial/genesis.json的initial_key里面）: EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p eosio key的密钥对（被记录在默认的eosio配置文件的signature-provider里面）： EOS6MRyAjQq8ud7hVNYcfnVPJqcVpscN5So8BhtHuGYqET5GDW5CV 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3 注意：要改这俩秘钥的话需要同步更改配置文件和创世节点里对应的密钥对 p2p-server-address = 192.168.154.157:9876 p2p-peer-address = 192.168.154.114:9876 p2p-peer-address = 192.168.154.132:9876 p2p-peer-address = 192.168.154.190:9876 enable-stale-production = true producer-name = eosio unlock-timeout = 90000 plugin = eosio::producer_plugin plugin = eosio::wallet_api_plugin plugin = eosio::chain_api_plugin plugin = eosio::chain_plugin plugin = eosio::http_plugin plugin = eosio::http_client_plugin plugin = eosio::bnet_plugin plugin = eosio::net_plugin plugin = eosio::net_api_plugin plugin = eosio::history_api_plugin plugin = eosio::history_plugin &nbsp; 4、修改其他节点配置文件 p2p-server-address = 192.168.154.132:9876 p2p-peer-address = 192.168.154.114:9876 p2p-peer-address = 192.168.154.157:9876 p2p-peer-address = 192.168.154.190:9876 enable-stale-production = false producer-name = two signature-provider = EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb=KEY:5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF plugin = eosio::chain_api_plugin plugin = eosio::history_api_plugin plugin = eosio::chain_plugin plugin = eosio::history_plugin plugin = eosio::net_plugin plugin = eosio::net_api_plugin 注意：不同的节点p2p-server-address和signature-provider需要改动，对应不同用户的IP和秘钥 三、创建钱包，导入秘钥 1、创建并解锁钱包 bee2@ubuntu:~/eos$ cleos wallet create Creating wallet: default Save password to use in the future to unlock this wallet. Without password imported keys will not be retrievable. &quot;PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT&quot;&nbsp;&nbsp; &nbsp; bee2@ubuntu:~/eos$ cleos wallet unlock --password PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT &nbsp; &nbsp; 出现解锁成功或者Error 3120007: Already unlocked字样即可 2、导入三个普通用户和创世节点eosio（eosio key ,eosio sign）的秘钥： cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p 注意：最后两个秘钥必须导入，不然会提示各种权限不足的错误 四、创建九个系统账户 &nbsp; &nbsp; &nbsp;这九个系统用户的名称及其作用如下说明： &nbsp; &nbsp; &nbsp;eosio.bpay:矿工获取出块奖励的临时代管账户，增发EOS的1%的25%会先转到这个账户; &nbsp; &nbsp; &nbsp;eosio.msig:多重签名管理的账户; &nbsp; &nbsp; &nbsp;eosio.names:靓号账户拍卖管理的账户; &nbsp; &nbsp; &nbsp;eosio.ram:内存买卖管理的账户; &nbsp; &nbsp; &nbsp;eosio.ramfee:内存买卖收取手续费的账户，按照每笔交易千分之5的费率收取手续费; &nbsp; &nbsp; &nbsp;eosio.saving:增发EOS临时存放账户，增发总量 5%，其中80%放在此账户，另外 20%再分成25%和75%，分别给eosio.bpay和eosio.vpay; &nbsp; &nbsp; &nbsp;eosio.stake:管理EOS抵押的账户; &nbsp; &nbsp; &nbsp;eosio.token:发行和管理token的账户; &nbsp; &nbsp; &nbsp;eosio.vpay:矿工按照获得投票多少比例获取奖励的临时代管账户，增发EOS的1%的75%会先转到这个账户. cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.bpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.msig EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.names EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ram EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ramfee EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.saving EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.stake EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.token EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.vpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr 五、加载四大合约，发行代币 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.token ~/eos/build/contracts/eosio.token/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.msig ~/eos/build/contracts/eosio.msig/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token create &#39;[&quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;]&#39; -p eosio.token cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token issue &#39;[&quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;, &quot;memo&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio ~/eos/build/contracts/eosio.system/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio setpriv &#39;[&quot;eosio.msig&quot;, 1]&#39; -p eosio@active 六、创建普通用户 &nbsp; &nbsp;加载了eosio.system之后就不能使用create account命令了，只能用system newaccount创建账户 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio zero &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio two &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio four &quot;20000.0000 SYS&quot; 七、注册节点候选人 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe &nbsp; &nbsp; &nbsp; &nbsp; 可以用下列命令查看节点候选人： &nbsp; &nbsp; &nbsp; &nbsp; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system listproducers 八、给创建的账户转账 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;zero&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;two&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;four&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio 九、使用命令进行投票（自己给自己投票） cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods zero zero cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods two two cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods four four 十、结尾 过一段时间后就能看到节点轮流产块，创世节点只需同步块，如下所示 本文是在学习了q_776355102的博客后做的简单总结，有诸多详细命令请参考原文： https://blog.csdn.net/weixin_39842528/article/details/81034018 十一、更改节点出块数目 按上面的步骤可以让节点轮流出块了，但是每个节点出块个数是12，而不是像官网白皮书说的那样是6个，修改下相关代码就可以让节点出块个数变为6。 执行指令：vi libraries/chain/include/eosio/chain/config.hpp +99 //const static int producer_repetitions = 12; const static int producer_repetitions = 6; 保存退出之后编译下源码，在按照上面的步骤再来一遍就可以看到如下界面： &nbsp; &nbsp; &nbsp; &nbsp; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/07/17/bec55022ffcde03914543ac5bde1109b.html" />
<meta property="og:url" content="https://mlh.app/2018/07/17/bec55022ffcde03914543ac5bde1109b.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"本文使用了四台同网段的主机，第一台做为eosio创世用户使用，另外三台做为出块者节点使用，最终实现了EOS多主机多节点的配置。最后EOSIO创世用户不再出块，由选举出来的各个节点轮流出块，下面将介绍具体的操作流程。 EOS versio: 1.0.8 system: ubuntu1804 四台服务器节点名称与对应IP： eosio &nbsp; &nbsp;192.168.154.157 zero &nbsp; &nbsp; &nbsp;192.168.154.190 two &nbsp; &nbsp; &nbsp; &nbsp;192.168.154.132 &nbsp; four &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;192.168.154.114 &nbsp; 一、安装EOS 1、获取源码：git clone https://github.com/EOSIO/eos --recursive 2、cd eos 3、sudo vi ./contracts/eosio.system/voting.cpp +80 将21改成3 top_producers.reserve(3); for ( auto it = idx.cbegin(); it != idx.cend() &amp;&amp; top_producers.size() &lt; 3 &amp;&amp; 0 &lt; it-&gt;total_votes &amp;&amp; it-&gt;active(); ++it ) { top_producers.emplace_back( std::pair&lt;eosio::producer_key,uint16_t&gt;({{it-&gt;owner, it-&gt;producer_key}, it-&gt;location}) ); } 4、编译源码&nbsp;./eosio_build.sh &nbsp; &nbsp; &nbsp; &nbsp;cd build &nbsp; &nbsp; &nbsp;sudo make install 二、修改配置文件 1、对四台主机都在命令行先运行nodeos与keosd，让其产生各自的配置文件。 &nbsp; &nbsp; &nbsp; 配置文件路径一般为：~/.local/share/eosio/nodeos/config/config.ini 2、为三个用户创建三组密钥对 cleos create key account zero: Private key: 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF Public key: EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj account two: Private key: 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF Public key: EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb account four: Private key: 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm Public key: EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe 3、修改创世节点配置文件 eosio sign的密钥对（被记录在./tutorials/bios-boot-tutorial/genesis.json的initial_key里面）: EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p eosio key的密钥对（被记录在默认的eosio配置文件的signature-provider里面）： EOS6MRyAjQq8ud7hVNYcfnVPJqcVpscN5So8BhtHuGYqET5GDW5CV 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3 注意：要改这俩秘钥的话需要同步更改配置文件和创世节点里对应的密钥对 p2p-server-address = 192.168.154.157:9876 p2p-peer-address = 192.168.154.114:9876 p2p-peer-address = 192.168.154.132:9876 p2p-peer-address = 192.168.154.190:9876 enable-stale-production = true producer-name = eosio unlock-timeout = 90000 plugin = eosio::producer_plugin plugin = eosio::wallet_api_plugin plugin = eosio::chain_api_plugin plugin = eosio::chain_plugin plugin = eosio::http_plugin plugin = eosio::http_client_plugin plugin = eosio::bnet_plugin plugin = eosio::net_plugin plugin = eosio::net_api_plugin plugin = eosio::history_api_plugin plugin = eosio::history_plugin &nbsp; 4、修改其他节点配置文件 p2p-server-address = 192.168.154.132:9876 p2p-peer-address = 192.168.154.114:9876 p2p-peer-address = 192.168.154.157:9876 p2p-peer-address = 192.168.154.190:9876 enable-stale-production = false producer-name = two signature-provider = EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb=KEY:5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF plugin = eosio::chain_api_plugin plugin = eosio::history_api_plugin plugin = eosio::chain_plugin plugin = eosio::history_plugin plugin = eosio::net_plugin plugin = eosio::net_api_plugin 注意：不同的节点p2p-server-address和signature-provider需要改动，对应不同用户的IP和秘钥 三、创建钱包，导入秘钥 1、创建并解锁钱包 bee2@ubuntu:~/eos$ cleos wallet create Creating wallet: default Save password to use in the future to unlock this wallet. Without password imported keys will not be retrievable. &quot;PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT&quot;&nbsp;&nbsp; &nbsp; bee2@ubuntu:~/eos$ cleos wallet unlock --password PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT &nbsp; &nbsp; 出现解锁成功或者Error 3120007: Already unlocked字样即可 2、导入三个普通用户和创世节点eosio（eosio key ,eosio sign）的秘钥： cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p 注意：最后两个秘钥必须导入，不然会提示各种权限不足的错误 四、创建九个系统账户 &nbsp; &nbsp; &nbsp;这九个系统用户的名称及其作用如下说明： &nbsp; &nbsp; &nbsp;eosio.bpay:矿工获取出块奖励的临时代管账户，增发EOS的1%的25%会先转到这个账户; &nbsp; &nbsp; &nbsp;eosio.msig:多重签名管理的账户; &nbsp; &nbsp; &nbsp;eosio.names:靓号账户拍卖管理的账户; &nbsp; &nbsp; &nbsp;eosio.ram:内存买卖管理的账户; &nbsp; &nbsp; &nbsp;eosio.ramfee:内存买卖收取手续费的账户，按照每笔交易千分之5的费率收取手续费; &nbsp; &nbsp; &nbsp;eosio.saving:增发EOS临时存放账户，增发总量 5%，其中80%放在此账户，另外 20%再分成25%和75%，分别给eosio.bpay和eosio.vpay; &nbsp; &nbsp; &nbsp;eosio.stake:管理EOS抵押的账户; &nbsp; &nbsp; &nbsp;eosio.token:发行和管理token的账户; &nbsp; &nbsp; &nbsp;eosio.vpay:矿工按照获得投票多少比例获取奖励的临时代管账户，增发EOS的1%的75%会先转到这个账户. cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.bpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.msig EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.names EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ram EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ramfee EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.saving EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.stake EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.token EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.vpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr 五、加载四大合约，发行代币 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.token ~/eos/build/contracts/eosio.token/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.msig ~/eos/build/contracts/eosio.msig/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token create &#39;[&quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;]&#39; -p eosio.token cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token issue &#39;[&quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;, &quot;memo&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio ~/eos/build/contracts/eosio.system/ cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio setpriv &#39;[&quot;eosio.msig&quot;, 1]&#39; -p eosio@active 六、创建普通用户 &nbsp; &nbsp;加载了eosio.system之后就不能使用create account命令了，只能用system newaccount创建账户 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio zero &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio two &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe --stake-net &quot;100000000.0000 SYS&quot; --stake-cpu &quot;100000000.0000 SYS&quot; --buy-ram &quot;20000.0000 SYS&quot; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio four &quot;20000.0000 SYS&quot; 七、注册节点候选人 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system regproducer four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe &nbsp; &nbsp; &nbsp; &nbsp; 可以用下列命令查看节点候选人： &nbsp; &nbsp; &nbsp; &nbsp; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system listproducers 八、给创建的账户转账 cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;zero&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;two&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer &#39;[&quot;eosio&quot;, &quot;four&quot;,&quot;1000.0000 SYS&quot;,&quot;vote&quot;]&#39; -p eosio 九、使用命令进行投票（自己给自己投票） cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods zero zero cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods two two cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods four four 十、结尾 过一段时间后就能看到节点轮流产块，创世节点只需同步块，如下所示 本文是在学习了q_776355102的博客后做的简单总结，有诸多详细命令请参考原文： https://blog.csdn.net/weixin_39842528/article/details/81034018 十一、更改节点出块数目 按上面的步骤可以让节点轮流出块了，但是每个节点出块个数是12，而不是像官网白皮书说的那样是6个，修改下相关代码就可以让节点出块个数变为6。 执行指令：vi libraries/chain/include/eosio/chain/config.hpp +99 //const static int producer_repetitions = 12; const static int producer_repetitions = 6; 保存退出之后编译下源码，在按照上面的步骤再来一遍就可以看到如下界面： &nbsp; &nbsp; &nbsp; &nbsp; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/07/17/bec55022ffcde03914543ac5bde1109b.html","headline":"EOS多节点环境配置(搭建自己的EOS主网)","dateModified":"2018-07-17T00:00:00+08:00","datePublished":"2018-07-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/07/17/bec55022ffcde03914543ac5bde1109b.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>EOS多节点环境配置(搭建自己的EOS主网)</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>本文使用了四台同网段的主机，第一台做为eosio创世用户使用，另外三台做为出块者节点使用，最终实现了EOS多主机多节点的配置。最后EOSIO创世用户不再出块，由选举出来的各个节点轮流出块，下面将介绍具体的操作流程。</p> 
  <p>EOS versio: 1.0.8</p> 
  <p>system: ubuntu1804</p> 
  <p>四台服务器节点名称与对应IP：</p> 
  <p>eosio &nbsp; &nbsp;192.168.154.157<br> zero &nbsp; &nbsp; &nbsp;192.168.154.190<br> two &nbsp; &nbsp; &nbsp; &nbsp;192.168.154.132 &nbsp;<br> four &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;192.168.154.114 &nbsp;</p> 
  <p><strong>一、安装EOS</strong></p> 
  <p>1、获取源码：git clone https://github.com/EOSIO/eos --recursive</p> 
  <p>2、cd eos</p> 
  <p>3、sudo vi ./contracts/eosio.system/voting.cpp +80 将21改成3</p> 
  <pre class="has">
<code>      top_producers.reserve(3);
	  
      for ( auto it = idx.cbegin(); it != idx.cend() &amp;&amp; top_producers.size() &lt; 3 &amp;&amp; 0 &lt; it-&gt;total_votes &amp;&amp; it-&gt;active(); ++it ) {
         top_producers.emplace_back( std::pair&lt;eosio::producer_key,uint16_t&gt;({{it-&gt;owner, it-&gt;producer_key}, it-&gt;location}) );
      }</code></pre> 
  <p>4、编译源码&nbsp;./eosio_build.sh &nbsp;</p> 
  <p>&nbsp; &nbsp; &nbsp;cd build</p> 
  <p>&nbsp; &nbsp; &nbsp;sudo make install</p> 
  <p><strong>二、修改配置文件</strong></p> 
  <p>1、对四台主机都在命令行先运行nodeos与keosd，让其产生各自的配置文件。</p> 
  <p>&nbsp; &nbsp; &nbsp; 配置文件路径一般为：~/.local/share/eosio/nodeos/config/config.ini</p> 
  <p>2、为三个用户创建三组密钥对 cleos create key</p> 
  <pre class="has">
<code>account zero:
Private key: 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF
Public key: EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj
account two: 
Private key: 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF
Public key: EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb
account four:
Private key: 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm
Public key: EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe</code></pre> 
  <p>3、修改创世节点配置文件</p> 
  <pre class="has">
<code>eosio sign的密钥对（被记录在./tutorials/bios-boot-tutorial/genesis.json的initial_key里面）:
EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p
eosio key的密钥对（被记录在默认的eosio配置文件的signature-provider里面）：
EOS6MRyAjQq8ud7hVNYcfnVPJqcVpscN5So8BhtHuGYqET5GDW5CV
5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3</code></pre> 
  <p><strong>注意：要改这俩秘钥的话需要同步更改配置文件和创世节点里对应的密钥对</strong></p> 
  <pre class="has">
<code>p2p-server-address = 192.168.154.157:9876
p2p-peer-address = 192.168.154.114:9876
p2p-peer-address = 192.168.154.132:9876
p2p-peer-address = 192.168.154.190:9876
enable-stale-production = true 
producer-name = eosio
unlock-timeout = 90000
plugin = eosio::producer_plugin
plugin = eosio::wallet_api_plugin
plugin = eosio::chain_api_plugin
plugin = eosio::chain_plugin
plugin = eosio::http_plugin
plugin = eosio::http_client_plugin
plugin = eosio::bnet_plugin
plugin = eosio::net_plugin
plugin = eosio::net_api_plugin
plugin = eosio::history_api_plugin
plugin = eosio::history_plugin </code></pre> 
  <p>&nbsp;</p> 
  <p>4、修改其他节点配置文件</p> 
  <pre class="has">
<code>p2p-server-address = 192.168.154.132:9876
p2p-peer-address = 192.168.154.114:9876
p2p-peer-address = 192.168.154.157:9876
p2p-peer-address = 192.168.154.190:9876
enable-stale-production = false
producer-name = two
signature-provider = EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb=KEY:5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF
plugin = eosio::chain_api_plugin
plugin = eosio::history_api_plugin
plugin = eosio::chain_plugin
plugin = eosio::history_plugin
plugin = eosio::net_plugin
plugin = eosio::net_api_plugin</code></pre> 
  <p><strong>注意：不同的节点p2p-server-address和signature-provider需要改动，对应不同用户的IP和秘钥</strong></p> 
  <p><strong>三、创建钱包，导入秘钥</strong></p> 
  <p>1、创建并解锁钱包</p> 
  <pre class="has">
<code>bee2@ubuntu:~/eos$ cleos wallet create
Creating wallet: default
Save password to use in the future to unlock this wallet.
Without password imported keys will not be retrievable.
"PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT"&nbsp;&nbsp; &nbsp;
bee2@ubuntu:~/eos$ cleos wallet unlock --password PW5HwJAUXcgD1veDewfEAJAj2MGmfYfCc19Pu5srsnMLhCvFpRQGT</code></pre> 
  <p>&nbsp; &nbsp; 出现解锁成功或者Error 3120007: Already unlocked字样即可</p> 
  <p>2、导入三个普通用户和创世节点eosio（eosio key ,eosio sign）的秘钥：</p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KXAsA1nizwEYAaWFA2uBUQqeHNhYA6hZ3dZ3tGb3X6aeW58UXF
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5JSxqFojAkd2HARaxN5rFniK6oEu8YEZ1EcabSoFMhqxTQphKvF
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KHmyWSp6dhEoGRxx1wxAK7kSvtAAy7WDmumMLK3UNg6cqTCWYm
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 wallet import 5K463ynhZoCDDa4RDcr63cUwWLTnKqmdcoTKTHBjqoKfv4u5V7p</code></pre> 
  <p><strong>注意：最后两个秘钥必须导入，不然会提示各种权限不足的错误</strong></p> 
  <p><strong>四、创建九个系统账户</strong></p> 
  <p>&nbsp; &nbsp; &nbsp;这九个系统用户的名称及其作用如下说明：</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.bpay:矿工获取出块奖励的临时代管账户，增发EOS的1%的25%会先转到这个账户;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.msig:多重签名管理的账户;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.names:靓号账户拍卖管理的账户;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.ram:内存买卖管理的账户;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.ramfee:内存买卖收取手续费的账户，按照每笔交易千分之5的费率收取手续费;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.saving:增发EOS临时存放账户，增发总量 5%，其中80%放在此账户，另外 20%再分成25%和75%，分别给eosio.bpay和eosio.vpay;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.stake:管理EOS抵押的账户;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.token:发行和管理token的账户;</p> 
  <p>&nbsp; &nbsp; &nbsp;eosio.vpay:矿工按照获得投票多少比例获取奖励的临时代管账户，增发EOS的1%的75%会先转到这个账户.</p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.bpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.msig EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.names EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ram  EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.ramfee EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.saving EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.stake EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.token EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 create account eosio eosio.vpay EOS8Znrtgwt8TfpmbVpTKvA2oB8Nqey625CLN8bCN3TEbgx86Dsvr</code></pre> 
  <p><strong>五、加载四大合约，发行代币</strong></p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.token ~/eos/build/contracts/eosio.token/
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio.msig ~/eos/build/contracts/eosio.msig/
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token create '["eosio", "1000000000.0000 SYS"]' -p eosio.token
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888  push action eosio.token issue '["eosio", "1000000000.0000 SYS", "memo"]' -p eosio
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 set contract eosio ~/eos/build/contracts/eosio.system/ 
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio setpriv '["eosio.msig", 1]' -p eosio@active</code></pre> 
  <p><strong>六、创建普通用户</strong></p> 
  <p>&nbsp; &nbsp;加载了eosio.system之后就不能使用create account命令了，只能用system newaccount创建账户</p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj --stake-net "100000000.0000 SYS" --stake-cpu "100000000.0000 SYS" --buy-ram "20000.0000 SYS"   
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio zero "20000.0000 SYS"
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb --stake-net "100000000.0000 SYS" --stake-cpu "100000000.0000 SYS" --buy-ram "20000.0000 SYS"   
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio two "20000.0000 SYS"
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system newaccount --transfer eosio four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe --stake-net "100000000.0000 SYS" --stake-cpu "100000000.0000 SYS" --buy-ram "20000.0000 SYS"   
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 transfer eosio four "20000.0000 SYS"</code></pre> 
  <p><strong>七、注册节点候选人</strong></p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888  system regproducer zero EOS5nquErGx97QiN6m5DspwLU8wNLmVAm78ccpzV6Ht4nfcJhepyj
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888  system regproducer two EOS5VmHFnwVyiFurmFLw387xRpgXEnyF1yxqZs6JLtVwU1hv9gaEb
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888  system regproducer four EOS8UXVwDadaS8pLDjQ2vRa6Jaqy5k1rqpMHUNCFqzeDF4KfoguJe</code></pre> 
  <p>&nbsp; &nbsp; &nbsp; &nbsp; 可以用下列命令查看节点候选人：</p> 
  <p>&nbsp; &nbsp; &nbsp; &nbsp; cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system listproducers</p> 
  <p><strong>八、给创建的账户转账</strong></p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer '["eosio", "zero","1000.0000 SYS","vote"]' -p eosio
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer '["eosio", "two","1000.0000 SYS","vote"]' -p eosio
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 push action eosio.token transfer '["eosio", "four","1000.0000 SYS","vote"]' -p eosio</code></pre> 
  <p><strong>九、使用命令进行投票（自己给自己投票）</strong></p> 
  <pre class="has">
<code>cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods zero zero
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods two two
cleos --wallet-url http://127.0.0.1:8900 --url http://192.168.154.157:8888 system voteproducer prods four four</code></pre> 
  <p><strong>十、结尾</strong></p> 
  <p>过一段时间后就能看到节点轮流产块，创世节点只需同步块，如下所示</p> 
  <p><img alt="" class="has" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180717150105375?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l3dDkyMzM0OTI3Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p> 
  <p>本文是在学习了<a href="https://blog.csdn.net/weixin_39842528" rel="nofollow">q_776355102的博客</a>后做的简单总结，有诸多详细命令请参考原文：</p> 
  <p><a href="https://blog.csdn.net/weixin_39842528/article/details/81034018" rel="nofollow">https://blog.csdn.net/weixin_39842528/article/details/81034018</a></p> 
  <p><strong>十一、更改节点出块数目</strong></p> 
  <p>按上面的步骤可以让节点轮流出块了，但是每个节点出块个数是12，而不是像官网白皮书说的那样是6个，修改下相关代码就可以让节点出块个数变为6。</p> 
  <p>执行指令：vi libraries/chain/include/eosio/chain/config.hpp +99</p> 
  <pre class="has">
<code>//const static int producer_repetitions = 12;
const static int producer_repetitions = 6;
</code></pre> 
  <p>保存退出之后编译下源码，在按照上面的步骤再来一遍就可以看到如下界面：</p> 
  <p>&nbsp;</p> 
  <p><img alt="" class="has" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180718201110794?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l3dDkyMzM0OTI3Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"></p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ywt923349273/article/details/81080100,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ywt923349273/article/details/81080100,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
