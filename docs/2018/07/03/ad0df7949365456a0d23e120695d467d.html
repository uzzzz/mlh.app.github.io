<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>SHA256算法原理详解 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="SHA256算法原理详解" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/u011583927/article/details/80905740 1. SHA256简介 SHA256是SHA-2下细分出的一种算法 SHA-2，名称来自于安全散列算法2（英语：Secure Hash Algorithm 2）的缩写，一种密码散列函数算法标准，由美国国家安全局研发，属于SHA算法之一，是SHA-1的后继者。 SHA-2下又可再分为六个不同的算法标准 包括了：SHA-224、SHA-256、SHA-384、SHA-512、SHA-512/224、SHA-512/256。 这些变体除了生成摘要的长度 、循环运行的次数等一些微小差异外，算法的基本结构是一致的。 回到SHA256上，说白了，它就是一个哈希函数。 哈希函数，又称散列算法，是一种从任何一种数据中创建小的数字“指纹”的方法。散列函数把消息或数据压缩成摘要，使得数据量变小，将数据的格式固定下来。该函数将数据打乱混合，重新创建一个叫做散列值（或哈希值）的指纹。散列值通常用一个短的随机字母和数字组成的字符串来代表。 对于任意长度的消息，SHA256都会产生一个256bit长的哈希值，称作消息摘要。 这个摘要相当于是个长度为32个字节的数组，通常用一个长度为64的十六进制字符串来表示 来看一个例子： 干他100天成为区块链程序员，红军大叔带领着我们，fighting! 这句话，经过哈希函数SHA256后得到的哈希值为： A7FCFC6B5269BDCCE571798D618EA219A68B96CB87A0E21080C2E758D23E4CE9 这里找到了一个SHA256在线验证工具，可以用来进行SHA256哈希结果的验证，后面也可以用来检验自己的SHA256代码是否正确。用起来很方便，不妨感受下。 2. SHA256原理详解 为了更好的理解SHA256的原理，这里首先将算法中可以单独抽出的模块，包括常量的初始化、信息预处理、使用到的逻辑运算分别进行介绍，甩开这些理解上的障碍后，一起来探索SHA256算法的主体部分，即消息摘要是如何计算的。 2.1 常量初始化 SHA256算法中用到了8个哈希初值以及64个哈希常量 其中，SHA256算法的8个哈希初值如下： h0 := 0x6a09e667 h1 := 0xbb67ae85 h2 := 0x3c6ef372 h3 := 0xa54ff53a h4 := 0x510e527f h5 := 0x9b05688c h6 := 0x1f83d9ab h7 := 0x5be0cd19 这些初值是对自然数中前8个质数（2,3,5,7,11,13,17,19）的平方根的小数部分取前32bit而来 举个例子来说， 2–√ 2 小数部分约为0.414213562373095048，而 0.414213562373095048≈6∗16−1+a∗16−2+0∗16−3+... 0.414213562373095048 ≈ 6 ∗ 16 − 1 + a ∗ 16 − 2 + 0 ∗ 16 − 3 + . . . 于是，质数2的平方根的小数部分取前32bit就对应出了 0x6a09e667 在SHA256算法中，用到的64个常量如下： 428a2f98 71374491 b5c0fbcf e9b5dba5 3956c25b 59f111f1 923f82a4 ab1c5ed5 d807aa98 12835b01 243185be 550c7dc3 72be5d74 80deb1fe 9bdc06a7 c19bf174 e49b69c1 efbe4786 0fc19dc6 240ca1cc 2de92c6f 4a7484aa 5cb0a9dc 76f988da 983e5152 a831c66d b00327c8 bf597fc7 c6e00bf3 d5a79147 06ca6351 14292967 27b70a85 2e1b2138 4d2c6dfc 53380d13 650a7354 766a0abb 81c2c92e 92722c85 a2bfe8a1 a81a664b c24b8b70 c76c51a3 d192e819 d6990624 f40e3585 106aa070 19a4c116 1e376c08 2748774c 34b0bcb5 391c0cb3 4ed8aa4a 5b9cca4f 682e6ff3 748f82ee 78a5636f 84c87814 8cc70208 90befffa a4506ceb bef9a3f7 c67178f2 和8个哈希初值类似，这些常量是对自然数中前64个质数(2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97…)的立方根的小数部分取前32bit而来。 2.2 信息预处理(pre-processing) SHA256算法中的预处理就是在想要Hash的消息后面补充需要的信息，使整个消息满足指定的结构。 信息的预处理分为两个步骤：附加填充比特和附加长度 STEP1：附加填充比特 在报文末尾进行填充，使报文长度在对512取模以后的余数是448 填充是这样进行的：先补第一个比特为1，然后都补0，直到长度满足对512取模后余数是448。 需要注意的是，信息必须进行填充，也就是说，即使长度已经满足对512取模后余数是448，补位也必须要进行，这时要填充512个比特。 因此，填充是至少补一位，最多补512位。 例：以信息“abc”为例显示补位的过程。 a,b,c对应的ASCII码分别是97,98,99 于是原始信息的二进制编码为：01100001 01100010 01100011 补位第一步，首先补一个“1” ： 0110000101100010 01100011 1 补位第二步,补423个“0”：01100001 01100010 01100011 10000000 00000000 … 00000000 补位完成后的数据如下（为了简介用16进制表示）： 61626380 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 为什么是448? 因为在第一步的预处理后，第二步会再附加上一个64bit的数据，用来表示原始报文的长度信息。而448+64=512，正好拼成了一个完整的结构。 STEP2：附加长度值 附加长度值就是将原始数据（第一步填充前的消息）的长度信息补到已经进行了填充操作的消息后面。 wiki百科中给出的原文是：append length of message (before pre-processing), in bits, as 64-bit big-endian integer SHA256用一个64位的数据来表示原始消息的长度。 因此，通过SHA256计算的消息长度必须要小于 264 2 6 4 ，当然绝大多数情况这足够大了。 长度信息的编码方式为64-bit big-endian integer 关于Big endian的含义，文末给出了补充 回到刚刚的例子，消息“abc”，3个字符，占用24个bit 因此，在进行了补长度的操作以后，整个消息就变成下面这样了（16进制格式） 61626380 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000018 2.3 逻辑运算 SHA256散列函数中涉及的操作全部是逻辑的位运算 包括如下的逻辑函数： Ch(x,y,z)=(x∧y)⊕(¬x∧z) C h ( x , y , z ) = ( x ∧ y ) ⊕ ( ¬ x ∧ z ) Ma(x,y,z)=(x∧y)⊕(x∧z)⊕(y∧z) M a ( x , y , z ) = ( x ∧ y ) ⊕ ( x ∧ z ) ⊕ ( y ∧ z ) Σ0(x)=S2(x)⊕S13(x)⊕S22(x) Σ 0 ( x ) = S 2 ( x ) ⊕ S 13 ( x ) ⊕ S 22 ( x ) Σ1(x)=S6(x)⊕S11(x)⊕S25(x) Σ 1 ( x ) = S 6 ( x ) ⊕ S 11 ( x ) ⊕ S 25 ( x ) σ0(x)=S7(x)⊕S18(x)⊕R3(x) σ 0 ( x ) = S 7 ( x ) ⊕ S 18 ( x ) ⊕ R 3 ( x ) σ1(x)=S17(x)⊕S19(x)⊕R10(x) σ 1 ( x ) = S 17 ( x ) ⊕ S 19 ( x ) ⊕ R 10 ( x ) 其中： 逻辑运算 含义 ∧ ∧ 按位“与” ¬ ¬ 按位“补” ⊕ ⊕ 按位“异或” Sn S n 右移n个bit Rn R n 循环右移n个bit 2.4 计算消息摘要 现在来介绍SHA256算法的主体部分，即消息摘要是如何计算的。 首先：将消息分解成512-bit大小的块 (break message into 512-bit chunks) 假设消息M可以被分解为n个块，于是整个算法需要做的就是完成n次迭代，n次迭代的结果就是最终的哈希值，即256bit的数字摘要。 一个256-bit的摘要的初始值H0，经过第一个数据块进行运算，得到H1，即完成了第一次迭代 H1经过第二个数据块得到H2，……，依次处理，最后得到Hn，Hn即为最终的256-bit消息摘要 将每次迭代进行的映射用 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 表示，于是迭代可以更形象的展示为： 图中256-bit的Hi被描述8个小块，这是因为SHA256算法中的最小运算单元称为“字”（Word），一个字是32位。 此外，第一次迭代中，映射的初值设置为前面介绍的8个哈希初值，如下图所示： 下面开始介绍每一次迭代的内容，即映射 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 的具体算法 STEP1：构造64个字（word） break chunk into sixteen 32-bit big-endian words w[0], …, w[15] 对于每一块，将块分解为16个32-bit的big-endian的字，记为w[0], …, w[15] 也就是说，前16个字直接由消息的第i个块分解得到 其余的字由如下迭代公式得到： Wt=σ1(Wt−2)+Wt−7+σ0(Wt−15)+Wt−16 W t = σ 1 ( W t − 2 ) + W t − 7 + σ 0 ( W t − 15 ) + W t − 16 STEP2：进行64次循环 映射 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 包含了64次加密循环 即进行64次加密循环即可完成一次迭代 每次加密循环可以由下图描述： 图中，ABCDEFGH这8个字（word）在按照一定的规则进行更新，其中 深蓝色方块是事先定义好的非线性逻辑函数，上文已经做过铺垫 红色田字方块代表 mod 232 2 32 addition，即将两个数字加在一起，如果结果大于 232 2 32 ，你必须除以 232 2 32 并找到余数。 ABCDEFGH一开始的初始值分别为 Hi−1(0),Hi−1(1),...,Hi−1(7) H i − 1 ( 0 ) , H i − 1 ( 1 ) , . . . , H i − 1 ( 7 ) Kt是第t个密钥，对应我们上文提到的64个常量 Wt是本区块产生第t个word。原消息被切成固定长度512-bit的区块，对每一个区块，产生64个word，通过重复运行循环n次对ABCDEFGH这八个字循环加密。 最后一次循环所产生的八个字合起来即是第i个块对应到的散列字符串 Hi H i 由此变完成了SHA256算法的所有介绍 3. SHA256算法伪代码 现在我们可以结合SHA256算法的伪代码,将上述的所有步骤进行梳理整合： Note: All variables are unsigned 32 bits and wrap modulo 232 when calculating Initialize variables (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19): h0 := 0x6a09e667 h1 := 0xbb67ae85 h2 := 0x3c6ef372 h3 := 0xa54ff53a h4 := 0x510e527f h5 := 0x9b05688c h6 := 0x1f83d9ab h7 := 0x5be0cd19 Initialize table of round constants (first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311): k[0..63] := 0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2 Pre-processing: append the bit &#39;1&#39; to the message append k bits &#39;0&#39;, where k is the minimum number &gt;= 0 such that the resulting message length (in bits) is congruent to 448(mod 512) append length of message (before pre-processing), in bits, as 64-bit big-endian integer Process the message in successive 512-bit chunks: break message into 512-bit chunks for each chunk break chunk into sixteen 32-bit big-endian words w[0..15] Extend the sixteen 32-bit words into sixty-four 32-bit words: for i from 16 to 63 s0 := (w[i-15] rightrotate 7) xor (w[i-15] rightrotate 18) xor(w[i-15] rightshift 3) s1 := (w[i-2] rightrotate 17) xor (w[i-2] rightrotate 19) xor(w[i-2] rightshift 10) w[i] := w[i-16] + s0 + w[i-7] + s1 Initialize hash value for this chunk: a := h0 b := h1 c := h2 d := h3 e := h4 f := h5 g := h6 h := h7 Main loop: for i from 0 to 63 s0 := (a rightrotate 2) xor (a rightrotate 13) xor(a rightrotate 22) maj := (a and b) xor (a and c) xor(b and c) t2 := s0 + maj s1 := (e rightrotate 6) xor (e rightrotate 11) xor(e rightrotate 25) ch := (e and f) xor ((not e) and g) t1 := h + s1 + ch + k[i] + w[i] h := g g := f f := e e := d + t1 d := c c := b b := a a := t1 + t2 Add this chunk&#39;s hash to result so far: h0 := h0 + a h1 := h1 + b h2 := h2 + c h3 := h3 + d h4 := h4 + e h5 := h5 + f h6 := h6 + g h7 := h7 + h Produce the final hash value (big-endian): digest = hash = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7 4. 参考文献 本篇笔记主要参考整合的资料如下： SHA-2 wiki 比特币算法——SHA256算法介绍 SHA-256算法实现 操作指南：验证SHA256 知识填补 大端和小端（Big endian and Little endian） 对于整型、长整型等数据类型，都存在字节排列的高低位顺序问题。 Big endian 认为第一个字节是最高位字节（按照从低地址到高地址的顺序存放数据的高位字节到低位字节） 而 Little endian 则相反，它认为第一个字节是最低位字节（按照从低地址到高地址的顺序存放据的低位字节到高位字节）。 例如，假设从内存地址 0x0000 开始有以下数据： 地址 数据 … … 0x0000 0x12 0x0001 0x34 0x0002 0xab 0x0003 0xcd … … 假设我们去读取一个地址为 0x0000 的四个字节变量 若字节序为big-endian，则读出结果为0x1234abcd； 若字节序为little-endian，则读出结果为0xcdab3412。 如果我们将0x1234abcd 写入到以 0x0000 开始的内存中，则Little endian 和 Big endian 模式的存放结果如下： 地址 0x0000 0x0001 0x0002 0x0003 big-Big_endian 0x12 0x34 0xab 0xcd little-endian 0xcd 0xab 0x34 0x12 参考文献 点击返回正文 阅读更多" />
<meta property="og:description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/u011583927/article/details/80905740 1. SHA256简介 SHA256是SHA-2下细分出的一种算法 SHA-2，名称来自于安全散列算法2（英语：Secure Hash Algorithm 2）的缩写，一种密码散列函数算法标准，由美国国家安全局研发，属于SHA算法之一，是SHA-1的后继者。 SHA-2下又可再分为六个不同的算法标准 包括了：SHA-224、SHA-256、SHA-384、SHA-512、SHA-512/224、SHA-512/256。 这些变体除了生成摘要的长度 、循环运行的次数等一些微小差异外，算法的基本结构是一致的。 回到SHA256上，说白了，它就是一个哈希函数。 哈希函数，又称散列算法，是一种从任何一种数据中创建小的数字“指纹”的方法。散列函数把消息或数据压缩成摘要，使得数据量变小，将数据的格式固定下来。该函数将数据打乱混合，重新创建一个叫做散列值（或哈希值）的指纹。散列值通常用一个短的随机字母和数字组成的字符串来代表。 对于任意长度的消息，SHA256都会产生一个256bit长的哈希值，称作消息摘要。 这个摘要相当于是个长度为32个字节的数组，通常用一个长度为64的十六进制字符串来表示 来看一个例子： 干他100天成为区块链程序员，红军大叔带领着我们，fighting! 这句话，经过哈希函数SHA256后得到的哈希值为： A7FCFC6B5269BDCCE571798D618EA219A68B96CB87A0E21080C2E758D23E4CE9 这里找到了一个SHA256在线验证工具，可以用来进行SHA256哈希结果的验证，后面也可以用来检验自己的SHA256代码是否正确。用起来很方便，不妨感受下。 2. SHA256原理详解 为了更好的理解SHA256的原理，这里首先将算法中可以单独抽出的模块，包括常量的初始化、信息预处理、使用到的逻辑运算分别进行介绍，甩开这些理解上的障碍后，一起来探索SHA256算法的主体部分，即消息摘要是如何计算的。 2.1 常量初始化 SHA256算法中用到了8个哈希初值以及64个哈希常量 其中，SHA256算法的8个哈希初值如下： h0 := 0x6a09e667 h1 := 0xbb67ae85 h2 := 0x3c6ef372 h3 := 0xa54ff53a h4 := 0x510e527f h5 := 0x9b05688c h6 := 0x1f83d9ab h7 := 0x5be0cd19 这些初值是对自然数中前8个质数（2,3,5,7,11,13,17,19）的平方根的小数部分取前32bit而来 举个例子来说， 2–√ 2 小数部分约为0.414213562373095048，而 0.414213562373095048≈6∗16−1+a∗16−2+0∗16−3+... 0.414213562373095048 ≈ 6 ∗ 16 − 1 + a ∗ 16 − 2 + 0 ∗ 16 − 3 + . . . 于是，质数2的平方根的小数部分取前32bit就对应出了 0x6a09e667 在SHA256算法中，用到的64个常量如下： 428a2f98 71374491 b5c0fbcf e9b5dba5 3956c25b 59f111f1 923f82a4 ab1c5ed5 d807aa98 12835b01 243185be 550c7dc3 72be5d74 80deb1fe 9bdc06a7 c19bf174 e49b69c1 efbe4786 0fc19dc6 240ca1cc 2de92c6f 4a7484aa 5cb0a9dc 76f988da 983e5152 a831c66d b00327c8 bf597fc7 c6e00bf3 d5a79147 06ca6351 14292967 27b70a85 2e1b2138 4d2c6dfc 53380d13 650a7354 766a0abb 81c2c92e 92722c85 a2bfe8a1 a81a664b c24b8b70 c76c51a3 d192e819 d6990624 f40e3585 106aa070 19a4c116 1e376c08 2748774c 34b0bcb5 391c0cb3 4ed8aa4a 5b9cca4f 682e6ff3 748f82ee 78a5636f 84c87814 8cc70208 90befffa a4506ceb bef9a3f7 c67178f2 和8个哈希初值类似，这些常量是对自然数中前64个质数(2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97…)的立方根的小数部分取前32bit而来。 2.2 信息预处理(pre-processing) SHA256算法中的预处理就是在想要Hash的消息后面补充需要的信息，使整个消息满足指定的结构。 信息的预处理分为两个步骤：附加填充比特和附加长度 STEP1：附加填充比特 在报文末尾进行填充，使报文长度在对512取模以后的余数是448 填充是这样进行的：先补第一个比特为1，然后都补0，直到长度满足对512取模后余数是448。 需要注意的是，信息必须进行填充，也就是说，即使长度已经满足对512取模后余数是448，补位也必须要进行，这时要填充512个比特。 因此，填充是至少补一位，最多补512位。 例：以信息“abc”为例显示补位的过程。 a,b,c对应的ASCII码分别是97,98,99 于是原始信息的二进制编码为：01100001 01100010 01100011 补位第一步，首先补一个“1” ： 0110000101100010 01100011 1 补位第二步,补423个“0”：01100001 01100010 01100011 10000000 00000000 … 00000000 补位完成后的数据如下（为了简介用16进制表示）： 61626380 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 为什么是448? 因为在第一步的预处理后，第二步会再附加上一个64bit的数据，用来表示原始报文的长度信息。而448+64=512，正好拼成了一个完整的结构。 STEP2：附加长度值 附加长度值就是将原始数据（第一步填充前的消息）的长度信息补到已经进行了填充操作的消息后面。 wiki百科中给出的原文是：append length of message (before pre-processing), in bits, as 64-bit big-endian integer SHA256用一个64位的数据来表示原始消息的长度。 因此，通过SHA256计算的消息长度必须要小于 264 2 6 4 ，当然绝大多数情况这足够大了。 长度信息的编码方式为64-bit big-endian integer 关于Big endian的含义，文末给出了补充 回到刚刚的例子，消息“abc”，3个字符，占用24个bit 因此，在进行了补长度的操作以后，整个消息就变成下面这样了（16进制格式） 61626380 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000018 2.3 逻辑运算 SHA256散列函数中涉及的操作全部是逻辑的位运算 包括如下的逻辑函数： Ch(x,y,z)=(x∧y)⊕(¬x∧z) C h ( x , y , z ) = ( x ∧ y ) ⊕ ( ¬ x ∧ z ) Ma(x,y,z)=(x∧y)⊕(x∧z)⊕(y∧z) M a ( x , y , z ) = ( x ∧ y ) ⊕ ( x ∧ z ) ⊕ ( y ∧ z ) Σ0(x)=S2(x)⊕S13(x)⊕S22(x) Σ 0 ( x ) = S 2 ( x ) ⊕ S 13 ( x ) ⊕ S 22 ( x ) Σ1(x)=S6(x)⊕S11(x)⊕S25(x) Σ 1 ( x ) = S 6 ( x ) ⊕ S 11 ( x ) ⊕ S 25 ( x ) σ0(x)=S7(x)⊕S18(x)⊕R3(x) σ 0 ( x ) = S 7 ( x ) ⊕ S 18 ( x ) ⊕ R 3 ( x ) σ1(x)=S17(x)⊕S19(x)⊕R10(x) σ 1 ( x ) = S 17 ( x ) ⊕ S 19 ( x ) ⊕ R 10 ( x ) 其中： 逻辑运算 含义 ∧ ∧ 按位“与” ¬ ¬ 按位“补” ⊕ ⊕ 按位“异或” Sn S n 右移n个bit Rn R n 循环右移n个bit 2.4 计算消息摘要 现在来介绍SHA256算法的主体部分，即消息摘要是如何计算的。 首先：将消息分解成512-bit大小的块 (break message into 512-bit chunks) 假设消息M可以被分解为n个块，于是整个算法需要做的就是完成n次迭代，n次迭代的结果就是最终的哈希值，即256bit的数字摘要。 一个256-bit的摘要的初始值H0，经过第一个数据块进行运算，得到H1，即完成了第一次迭代 H1经过第二个数据块得到H2，……，依次处理，最后得到Hn，Hn即为最终的256-bit消息摘要 将每次迭代进行的映射用 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 表示，于是迭代可以更形象的展示为： 图中256-bit的Hi被描述8个小块，这是因为SHA256算法中的最小运算单元称为“字”（Word），一个字是32位。 此外，第一次迭代中，映射的初值设置为前面介绍的8个哈希初值，如下图所示： 下面开始介绍每一次迭代的内容，即映射 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 的具体算法 STEP1：构造64个字（word） break chunk into sixteen 32-bit big-endian words w[0], …, w[15] 对于每一块，将块分解为16个32-bit的big-endian的字，记为w[0], …, w[15] 也就是说，前16个字直接由消息的第i个块分解得到 其余的字由如下迭代公式得到： Wt=σ1(Wt−2)+Wt−7+σ0(Wt−15)+Wt−16 W t = σ 1 ( W t − 2 ) + W t − 7 + σ 0 ( W t − 15 ) + W t − 16 STEP2：进行64次循环 映射 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 包含了64次加密循环 即进行64次加密循环即可完成一次迭代 每次加密循环可以由下图描述： 图中，ABCDEFGH这8个字（word）在按照一定的规则进行更新，其中 深蓝色方块是事先定义好的非线性逻辑函数，上文已经做过铺垫 红色田字方块代表 mod 232 2 32 addition，即将两个数字加在一起，如果结果大于 232 2 32 ，你必须除以 232 2 32 并找到余数。 ABCDEFGH一开始的初始值分别为 Hi−1(0),Hi−1(1),...,Hi−1(7) H i − 1 ( 0 ) , H i − 1 ( 1 ) , . . . , H i − 1 ( 7 ) Kt是第t个密钥，对应我们上文提到的64个常量 Wt是本区块产生第t个word。原消息被切成固定长度512-bit的区块，对每一个区块，产生64个word，通过重复运行循环n次对ABCDEFGH这八个字循环加密。 最后一次循环所产生的八个字合起来即是第i个块对应到的散列字符串 Hi H i 由此变完成了SHA256算法的所有介绍 3. SHA256算法伪代码 现在我们可以结合SHA256算法的伪代码,将上述的所有步骤进行梳理整合： Note: All variables are unsigned 32 bits and wrap modulo 232 when calculating Initialize variables (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19): h0 := 0x6a09e667 h1 := 0xbb67ae85 h2 := 0x3c6ef372 h3 := 0xa54ff53a h4 := 0x510e527f h5 := 0x9b05688c h6 := 0x1f83d9ab h7 := 0x5be0cd19 Initialize table of round constants (first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311): k[0..63] := 0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2 Pre-processing: append the bit &#39;1&#39; to the message append k bits &#39;0&#39;, where k is the minimum number &gt;= 0 such that the resulting message length (in bits) is congruent to 448(mod 512) append length of message (before pre-processing), in bits, as 64-bit big-endian integer Process the message in successive 512-bit chunks: break message into 512-bit chunks for each chunk break chunk into sixteen 32-bit big-endian words w[0..15] Extend the sixteen 32-bit words into sixty-four 32-bit words: for i from 16 to 63 s0 := (w[i-15] rightrotate 7) xor (w[i-15] rightrotate 18) xor(w[i-15] rightshift 3) s1 := (w[i-2] rightrotate 17) xor (w[i-2] rightrotate 19) xor(w[i-2] rightshift 10) w[i] := w[i-16] + s0 + w[i-7] + s1 Initialize hash value for this chunk: a := h0 b := h1 c := h2 d := h3 e := h4 f := h5 g := h6 h := h7 Main loop: for i from 0 to 63 s0 := (a rightrotate 2) xor (a rightrotate 13) xor(a rightrotate 22) maj := (a and b) xor (a and c) xor(b and c) t2 := s0 + maj s1 := (e rightrotate 6) xor (e rightrotate 11) xor(e rightrotate 25) ch := (e and f) xor ((not e) and g) t1 := h + s1 + ch + k[i] + w[i] h := g g := f f := e e := d + t1 d := c c := b b := a a := t1 + t2 Add this chunk&#39;s hash to result so far: h0 := h0 + a h1 := h1 + b h2 := h2 + c h3 := h3 + d h4 := h4 + e h5 := h5 + f h6 := h6 + g h7 := h7 + h Produce the final hash value (big-endian): digest = hash = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7 4. 参考文献 本篇笔记主要参考整合的资料如下： SHA-2 wiki 比特币算法——SHA256算法介绍 SHA-256算法实现 操作指南：验证SHA256 知识填补 大端和小端（Big endian and Little endian） 对于整型、长整型等数据类型，都存在字节排列的高低位顺序问题。 Big endian 认为第一个字节是最高位字节（按照从低地址到高地址的顺序存放数据的高位字节到低位字节） 而 Little endian 则相反，它认为第一个字节是最低位字节（按照从低地址到高地址的顺序存放据的低位字节到高位字节）。 例如，假设从内存地址 0x0000 开始有以下数据： 地址 数据 … … 0x0000 0x12 0x0001 0x34 0x0002 0xab 0x0003 0xcd … … 假设我们去读取一个地址为 0x0000 的四个字节变量 若字节序为big-endian，则读出结果为0x1234abcd； 若字节序为little-endian，则读出结果为0xcdab3412。 如果我们将0x1234abcd 写入到以 0x0000 开始的内存中，则Little endian 和 Big endian 模式的存放结果如下： 地址 0x0000 0x0001 0x0002 0x0003 big-Big_endian 0x12 0x34 0xab 0xcd little-endian 0xcd 0xab 0x34 0x12 参考文献 点击返回正文 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-03T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/u011583927/article/details/80905740 1. SHA256简介 SHA256是SHA-2下细分出的一种算法 SHA-2，名称来自于安全散列算法2（英语：Secure Hash Algorithm 2）的缩写，一种密码散列函数算法标准，由美国国家安全局研发，属于SHA算法之一，是SHA-1的后继者。 SHA-2下又可再分为六个不同的算法标准 包括了：SHA-224、SHA-256、SHA-384、SHA-512、SHA-512/224、SHA-512/256。 这些变体除了生成摘要的长度 、循环运行的次数等一些微小差异外，算法的基本结构是一致的。 回到SHA256上，说白了，它就是一个哈希函数。 哈希函数，又称散列算法，是一种从任何一种数据中创建小的数字“指纹”的方法。散列函数把消息或数据压缩成摘要，使得数据量变小，将数据的格式固定下来。该函数将数据打乱混合，重新创建一个叫做散列值（或哈希值）的指纹。散列值通常用一个短的随机字母和数字组成的字符串来代表。 对于任意长度的消息，SHA256都会产生一个256bit长的哈希值，称作消息摘要。 这个摘要相当于是个长度为32个字节的数组，通常用一个长度为64的十六进制字符串来表示 来看一个例子： 干他100天成为区块链程序员，红军大叔带领着我们，fighting! 这句话，经过哈希函数SHA256后得到的哈希值为： A7FCFC6B5269BDCCE571798D618EA219A68B96CB87A0E21080C2E758D23E4CE9 这里找到了一个SHA256在线验证工具，可以用来进行SHA256哈希结果的验证，后面也可以用来检验自己的SHA256代码是否正确。用起来很方便，不妨感受下。 2. SHA256原理详解 为了更好的理解SHA256的原理，这里首先将算法中可以单独抽出的模块，包括常量的初始化、信息预处理、使用到的逻辑运算分别进行介绍，甩开这些理解上的障碍后，一起来探索SHA256算法的主体部分，即消息摘要是如何计算的。 2.1 常量初始化 SHA256算法中用到了8个哈希初值以及64个哈希常量 其中，SHA256算法的8个哈希初值如下： h0 := 0x6a09e667 h1 := 0xbb67ae85 h2 := 0x3c6ef372 h3 := 0xa54ff53a h4 := 0x510e527f h5 := 0x9b05688c h6 := 0x1f83d9ab h7 := 0x5be0cd19 这些初值是对自然数中前8个质数（2,3,5,7,11,13,17,19）的平方根的小数部分取前32bit而来 举个例子来说， 2–√ 2 小数部分约为0.414213562373095048，而 0.414213562373095048≈6∗16−1+a∗16−2+0∗16−3+... 0.414213562373095048 ≈ 6 ∗ 16 − 1 + a ∗ 16 − 2 + 0 ∗ 16 − 3 + . . . 于是，质数2的平方根的小数部分取前32bit就对应出了 0x6a09e667 在SHA256算法中，用到的64个常量如下： 428a2f98 71374491 b5c0fbcf e9b5dba5 3956c25b 59f111f1 923f82a4 ab1c5ed5 d807aa98 12835b01 243185be 550c7dc3 72be5d74 80deb1fe 9bdc06a7 c19bf174 e49b69c1 efbe4786 0fc19dc6 240ca1cc 2de92c6f 4a7484aa 5cb0a9dc 76f988da 983e5152 a831c66d b00327c8 bf597fc7 c6e00bf3 d5a79147 06ca6351 14292967 27b70a85 2e1b2138 4d2c6dfc 53380d13 650a7354 766a0abb 81c2c92e 92722c85 a2bfe8a1 a81a664b c24b8b70 c76c51a3 d192e819 d6990624 f40e3585 106aa070 19a4c116 1e376c08 2748774c 34b0bcb5 391c0cb3 4ed8aa4a 5b9cca4f 682e6ff3 748f82ee 78a5636f 84c87814 8cc70208 90befffa a4506ceb bef9a3f7 c67178f2 和8个哈希初值类似，这些常量是对自然数中前64个质数(2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97…)的立方根的小数部分取前32bit而来。 2.2 信息预处理(pre-processing) SHA256算法中的预处理就是在想要Hash的消息后面补充需要的信息，使整个消息满足指定的结构。 信息的预处理分为两个步骤：附加填充比特和附加长度 STEP1：附加填充比特 在报文末尾进行填充，使报文长度在对512取模以后的余数是448 填充是这样进行的：先补第一个比特为1，然后都补0，直到长度满足对512取模后余数是448。 需要注意的是，信息必须进行填充，也就是说，即使长度已经满足对512取模后余数是448，补位也必须要进行，这时要填充512个比特。 因此，填充是至少补一位，最多补512位。 例：以信息“abc”为例显示补位的过程。 a,b,c对应的ASCII码分别是97,98,99 于是原始信息的二进制编码为：01100001 01100010 01100011 补位第一步，首先补一个“1” ： 0110000101100010 01100011 1 补位第二步,补423个“0”：01100001 01100010 01100011 10000000 00000000 … 00000000 补位完成后的数据如下（为了简介用16进制表示）： 61626380 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 为什么是448? 因为在第一步的预处理后，第二步会再附加上一个64bit的数据，用来表示原始报文的长度信息。而448+64=512，正好拼成了一个完整的结构。 STEP2：附加长度值 附加长度值就是将原始数据（第一步填充前的消息）的长度信息补到已经进行了填充操作的消息后面。 wiki百科中给出的原文是：append length of message (before pre-processing), in bits, as 64-bit big-endian integer SHA256用一个64位的数据来表示原始消息的长度。 因此，通过SHA256计算的消息长度必须要小于 264 2 6 4 ，当然绝大多数情况这足够大了。 长度信息的编码方式为64-bit big-endian integer 关于Big endian的含义，文末给出了补充 回到刚刚的例子，消息“abc”，3个字符，占用24个bit 因此，在进行了补长度的操作以后，整个消息就变成下面这样了（16进制格式） 61626380 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000018 2.3 逻辑运算 SHA256散列函数中涉及的操作全部是逻辑的位运算 包括如下的逻辑函数： Ch(x,y,z)=(x∧y)⊕(¬x∧z) C h ( x , y , z ) = ( x ∧ y ) ⊕ ( ¬ x ∧ z ) Ma(x,y,z)=(x∧y)⊕(x∧z)⊕(y∧z) M a ( x , y , z ) = ( x ∧ y ) ⊕ ( x ∧ z ) ⊕ ( y ∧ z ) Σ0(x)=S2(x)⊕S13(x)⊕S22(x) Σ 0 ( x ) = S 2 ( x ) ⊕ S 13 ( x ) ⊕ S 22 ( x ) Σ1(x)=S6(x)⊕S11(x)⊕S25(x) Σ 1 ( x ) = S 6 ( x ) ⊕ S 11 ( x ) ⊕ S 25 ( x ) σ0(x)=S7(x)⊕S18(x)⊕R3(x) σ 0 ( x ) = S 7 ( x ) ⊕ S 18 ( x ) ⊕ R 3 ( x ) σ1(x)=S17(x)⊕S19(x)⊕R10(x) σ 1 ( x ) = S 17 ( x ) ⊕ S 19 ( x ) ⊕ R 10 ( x ) 其中： 逻辑运算 含义 ∧ ∧ 按位“与” ¬ ¬ 按位“补” ⊕ ⊕ 按位“异或” Sn S n 右移n个bit Rn R n 循环右移n个bit 2.4 计算消息摘要 现在来介绍SHA256算法的主体部分，即消息摘要是如何计算的。 首先：将消息分解成512-bit大小的块 (break message into 512-bit chunks) 假设消息M可以被分解为n个块，于是整个算法需要做的就是完成n次迭代，n次迭代的结果就是最终的哈希值，即256bit的数字摘要。 一个256-bit的摘要的初始值H0，经过第一个数据块进行运算，得到H1，即完成了第一次迭代 H1经过第二个数据块得到H2，……，依次处理，最后得到Hn，Hn即为最终的256-bit消息摘要 将每次迭代进行的映射用 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 表示，于是迭代可以更形象的展示为： 图中256-bit的Hi被描述8个小块，这是因为SHA256算法中的最小运算单元称为“字”（Word），一个字是32位。 此外，第一次迭代中，映射的初值设置为前面介绍的8个哈希初值，如下图所示： 下面开始介绍每一次迭代的内容，即映射 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 的具体算法 STEP1：构造64个字（word） break chunk into sixteen 32-bit big-endian words w[0], …, w[15] 对于每一块，将块分解为16个32-bit的big-endian的字，记为w[0], …, w[15] 也就是说，前16个字直接由消息的第i个块分解得到 其余的字由如下迭代公式得到： Wt=σ1(Wt−2)+Wt−7+σ0(Wt−15)+Wt−16 W t = σ 1 ( W t − 2 ) + W t − 7 + σ 0 ( W t − 15 ) + W t − 16 STEP2：进行64次循环 映射 Map(Hi−1)=Hi M a p ( H i − 1 ) = H i 包含了64次加密循环 即进行64次加密循环即可完成一次迭代 每次加密循环可以由下图描述： 图中，ABCDEFGH这8个字（word）在按照一定的规则进行更新，其中 深蓝色方块是事先定义好的非线性逻辑函数，上文已经做过铺垫 红色田字方块代表 mod 232 2 32 addition，即将两个数字加在一起，如果结果大于 232 2 32 ，你必须除以 232 2 32 并找到余数。 ABCDEFGH一开始的初始值分别为 Hi−1(0),Hi−1(1),...,Hi−1(7) H i − 1 ( 0 ) , H i − 1 ( 1 ) , . . . , H i − 1 ( 7 ) Kt是第t个密钥，对应我们上文提到的64个常量 Wt是本区块产生第t个word。原消息被切成固定长度512-bit的区块，对每一个区块，产生64个word，通过重复运行循环n次对ABCDEFGH这八个字循环加密。 最后一次循环所产生的八个字合起来即是第i个块对应到的散列字符串 Hi H i 由此变完成了SHA256算法的所有介绍 3. SHA256算法伪代码 现在我们可以结合SHA256算法的伪代码,将上述的所有步骤进行梳理整合： Note: All variables are unsigned 32 bits and wrap modulo 232 when calculating Initialize variables (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19): h0 := 0x6a09e667 h1 := 0xbb67ae85 h2 := 0x3c6ef372 h3 := 0xa54ff53a h4 := 0x510e527f h5 := 0x9b05688c h6 := 0x1f83d9ab h7 := 0x5be0cd19 Initialize table of round constants (first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311): k[0..63] := 0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2 Pre-processing: append the bit &#39;1&#39; to the message append k bits &#39;0&#39;, where k is the minimum number &gt;= 0 such that the resulting message length (in bits) is congruent to 448(mod 512) append length of message (before pre-processing), in bits, as 64-bit big-endian integer Process the message in successive 512-bit chunks: break message into 512-bit chunks for each chunk break chunk into sixteen 32-bit big-endian words w[0..15] Extend the sixteen 32-bit words into sixty-four 32-bit words: for i from 16 to 63 s0 := (w[i-15] rightrotate 7) xor (w[i-15] rightrotate 18) xor(w[i-15] rightshift 3) s1 := (w[i-2] rightrotate 17) xor (w[i-2] rightrotate 19) xor(w[i-2] rightshift 10) w[i] := w[i-16] + s0 + w[i-7] + s1 Initialize hash value for this chunk: a := h0 b := h1 c := h2 d := h3 e := h4 f := h5 g := h6 h := h7 Main loop: for i from 0 to 63 s0 := (a rightrotate 2) xor (a rightrotate 13) xor(a rightrotate 22) maj := (a and b) xor (a and c) xor(b and c) t2 := s0 + maj s1 := (e rightrotate 6) xor (e rightrotate 11) xor(e rightrotate 25) ch := (e and f) xor ((not e) and g) t1 := h + s1 + ch + k[i] + w[i] h := g g := f f := e e := d + t1 d := c c := b b := a a := t1 + t2 Add this chunk&#39;s hash to result so far: h0 := h0 + a h1 := h1 + b h2 := h2 + c h3 := h3 + d h4 := h4 + e h5 := h5 + f h6 := h6 + g h7 := h7 + h Produce the final hash value (big-endian): digest = hash = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7 4. 参考文献 本篇笔记主要参考整合的资料如下： SHA-2 wiki 比特币算法——SHA256算法介绍 SHA-256算法实现 操作指南：验证SHA256 知识填补 大端和小端（Big endian and Little endian） 对于整型、长整型等数据类型，都存在字节排列的高低位顺序问题。 Big endian 认为第一个字节是最高位字节（按照从低地址到高地址的顺序存放数据的高位字节到低位字节） 而 Little endian 则相反，它认为第一个字节是最低位字节（按照从低地址到高地址的顺序存放据的低位字节到高位字节）。 例如，假设从内存地址 0x0000 开始有以下数据： 地址 数据 … … 0x0000 0x12 0x0001 0x34 0x0002 0xab 0x0003 0xcd … … 假设我们去读取一个地址为 0x0000 的四个字节变量 若字节序为big-endian，则读出结果为0x1234abcd； 若字节序为little-endian，则读出结果为0xcdab3412。 如果我们将0x1234abcd 写入到以 0x0000 开始的内存中，则Little endian 和 Big endian 模式的存放结果如下： 地址 0x0000 0x0001 0x0002 0x0003 big-Big_endian 0x12 0x34 0xab 0xcd little-endian 0xcd 0xab 0x34 0x12 参考文献 点击返回正文 阅读更多","@type":"BlogPosting","url":"/2018/07/03/ad0df7949365456a0d23e120695d467d.html","headline":"SHA256算法原理详解","dateModified":"2018-07-03T00:00:00+08:00","datePublished":"2018-07-03T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/07/03/ad0df7949365456a0d23e120695d467d.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>SHA256算法原理详解</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/u011583927/article/details/80905740 
 </div> 
 <div class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h2 id="1-sha256简介">1. SHA256简介</h2> 
  <p>SHA256是SHA-2下细分出的一种算法</p> 
  <p>SHA-2，名称来自于安全散列算法2（英语：Secure Hash Algorithm 2）的缩写，一种密码散列函数算法标准，由美国国家安全局研发，属于SHA算法之一，是SHA-1的后继者。</p> 
  <p>SHA-2下又可再分为六个不同的算法标准</p> 
  <p>包括了：SHA-224、SHA-256、SHA-384、SHA-512、SHA-512/224、SHA-512/256。</p> 
  <p>这些变体除了生成摘要的长度 、循环运行的次数等一些微小差异外，算法的基本结构是一致的。</p> 
  <p>回到SHA256上，说白了，它就是一个哈希函数。</p> 
  <p>哈希函数，又称散列算法，是一种从任何一种数据中创建小的数字“指纹”的方法。散列函数把消息或数据压缩成摘要，使得数据量变小，将数据的格式固定下来。该函数将数据打乱混合，重新创建一个叫做散列值（或哈希值）的指纹。散列值通常用一个短的随机字母和数字组成的字符串来代表。</p> 
  <p>对于任意长度的消息，SHA256都会产生一个256bit长的哈希值，称作消息摘要。</p> 
  <p>这个摘要相当于是个长度为32个字节的数组，通常用一个长度为64的十六进制字符串来表示</p> 
  <p>来看一个例子：</p> 
  <p><code>干他100天成为区块链程序员，红军大叔带领着我们，fighting!</code></p> 
  <p>这句话，经过哈希函数SHA256后得到的哈希值为：</p> 
  <p><code>A7FCFC6B5269BDCCE571798D618EA219A68B96CB87A0E21080C2E758D23E4CE9</code></p> 
  <p>这里找到了一个<a href="https://hash.online-convert.com/sha256-generator" rel="nofollow">SHA256在线验证工具</a>，可以用来进行SHA256哈希结果的验证，后面也可以用来检验自己的SHA256代码是否正确。用起来很方便，不妨感受下。</p> 
  <hr> 
  <h2 id="2-sha256原理详解">2. SHA256原理详解</h2> 
  <p>为了更好的理解SHA256的原理，这里首先将算法中可以单独抽出的模块，包括<code>常量的初始化</code>、<code>信息预处理</code>、<code>使用到的逻辑运算</code>分别进行介绍，甩开这些理解上的障碍后，一起来探索SHA256算法的主体部分，即消息摘要是如何计算的。</p> 
  <h3 id="21-常量初始化">2.1 常量初始化</h3> 
  <p>SHA256算法中用到了8个哈希初值以及64个哈希常量</p> 
  <p>其中，SHA256算法的<strong>8个哈希初值</strong>如下：</p> 
  <pre class="prettyprint"><code class=" hljs makefile"><span class="hljs-constant">h0</span> := 0x6a09e667
<span class="hljs-constant">h1</span> := 0xbb67ae85
<span class="hljs-constant">h2</span> := 0x3c6ef372
<span class="hljs-constant">h3</span> := 0xa54ff53a
<span class="hljs-constant">h4</span> := 0x510e527f
<span class="hljs-constant">h5</span> := 0x9b05688c
<span class="hljs-constant">h6</span> := 0x1f83d9ab
<span class="hljs-constant">h7</span> := 0x5be0cd19</code></pre> 
  <p>这些初值是对自然数中前8个质数（2,3,5,7,11,13,17,19）的平方根的小数部分取前32bit而来</p> 
  <p>举个例子来说，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msqrt><mn>2</mn></msqrt></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-1" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msqrt" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.357em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4"><span class="mn" id="MathJax-Span-5" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.596em, 1000.52em, 3.909em, -999.997em); top: -4.529em; left: 0.836em;"><span style="font-family: MathJax_Main;">–</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1000.84em, 4.378em, -999.997em); top: -4.06em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msqrt>
       <mn>
        2
       </mn>
      </msqrt>
     </math></span></span><script type="math/tex" id="MathJax-Element-1"> \sqrt{2} </script>小数部分约为0.414213562373095048，而 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span></p>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mn>0.414213562373095048</mn><mo>&amp;#x2248;</mo><mn>6</mn><mo>&amp;#x2217;</mo><msup><mn>16</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>a</mi><mo>&amp;#x2217;</mo><msup><mn>16</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msup><mo>+</mo><mn>0</mn><mo>&amp;#x2217;</mo><msup><mn>16</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>3</mn></mrow></msup><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-6" style="width: 30.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.628em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1025.52em, 2.398em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">0.414213562373095048</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.263em;">≈</span><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.263em;">6</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.211em;">∗</span><span class="msubsup" id="MathJax-Span-12" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.982em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.94em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main;">16</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.992em;"><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mo" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-17" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.211em;">∗</span><span class="msubsup" id="MathJax-Span-21" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.982em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.94em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main;">16</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.992em;"><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mo" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.211em;">0</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.211em;">∗</span><span class="msubsup" id="MathJax-Span-30" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.982em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.94em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main;">16</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.992em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mo" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.159em;">.</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.159em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <mn>
       0.414213562373095048
      </mn>
      <mo>
       ≈
      </mo>
      <mn>
       6
      </mn>
      <mo>
       ∗
      </mo>
      <msup>
       <mn>
        16
       </mn>
       <mrow class="MJX-TeXAtom-ORD">
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msup>
      <mo>
       +
      </mo>
      <mi>
       a
      </mi>
      <mo>
       ∗
      </mo>
      <msup>
       <mn>
        16
       </mn>
       <mrow class="MJX-TeXAtom-ORD">
        <mo>
         −
        </mo>
        <mn>
         2
        </mn>
       </mrow>
      </msup>
      <mo>
       +
      </mo>
      <mn>
       0
      </mn>
      <mo>
       ∗
      </mo>
      <msup>
       <mn>
        16
       </mn>
       <mrow class="MJX-TeXAtom-ORD">
        <mo>
         −
        </mo>
        <mn>
         3
        </mn>
       </mrow>
      </msup>
      <mo>
       +
      </mo>
      <mo>
       .
      </mo>
      <mo>
       .
      </mo>
      <mo>
       .
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-2"> 0.414213562373095048 \approx 6*16^{-1} + a*16^{-2} + 0*16^{-3} + ... </script> 
  <br> 于是，质数2的平方根的小数部分取前32bit就对应出了
  <code>0x6a09e667</code>
  <p></p> 
  <p>在SHA256算法中，用到的<strong>64个常量</strong>如下：</p> 
  <pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-number">428</span>a2f98 <span class="hljs-number">71374491</span> b5c0fbcf e9b5dba5
<span class="hljs-number">3956</span>c25b <span class="hljs-number">59f</span>111f1 <span class="hljs-number">923f</span>82a4 ab1c5ed5
d807aa98 <span class="hljs-number">12835</span>b01 <span class="hljs-number">243185</span>be <span class="hljs-number">550</span>c7dc3
<span class="hljs-number">72</span>be5d74 <span class="hljs-number">80</span>deb1fe <span class="hljs-number">9</span>bdc06a7 c19bf174
e49b69c1 efbe4786 <span class="hljs-number">0f</span>c19dc6 <span class="hljs-number">240</span>ca1cc
<span class="hljs-number">2</span>de92c6f <span class="hljs-number">4</span>a7484aa <span class="hljs-number">5</span>cb0a9dc <span class="hljs-number">76f</span>988da
<span class="hljs-number">983e5152</span> a831c66d b00327c8 bf597fc7
c6e00bf3 d5a79147 <span class="hljs-number">06</span>ca6351 <span class="hljs-number">14292967</span>
<span class="hljs-number">27</span>b70a85 <span class="hljs-number">2e1</span>b2138 <span class="hljs-number">4</span>d2c6dfc <span class="hljs-number">53380</span>d13
<span class="hljs-number">650</span>a7354 <span class="hljs-number">766</span>a0abb <span class="hljs-number">81</span>c2c92e <span class="hljs-number">92722</span>c85
a2bfe8a1 a81a664b c24b8b70 c76c51a3
d192e819 d6990624 f40e3585 <span class="hljs-number">106</span>aa070
<span class="hljs-number">19</span>a4c116 <span class="hljs-number">1e376</span>c08 <span class="hljs-number">2748774</span>c <span class="hljs-number">34</span>b0bcb5
<span class="hljs-number">391</span>c0cb3 <span class="hljs-number">4</span>ed8aa4a <span class="hljs-number">5</span>b9cca4f <span class="hljs-number">682e6</span>ff3
<span class="hljs-number">748f</span>82ee <span class="hljs-number">78</span>a5636f <span class="hljs-number">84</span>c87814 <span class="hljs-number">8</span>cc70208
<span class="hljs-number">90</span>befffa a4506ceb bef9a3f7 c67178f2</code></pre> 
  <p>和8个哈希初值类似，这些常量是对自然数中前64个质数(2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97…)的立方根的小数部分取前32bit而来。</p> 
  <h3 id="22-信息预处理pre-processing">2.2 信息预处理(pre-processing)</h3> 
  <p>SHA256算法中的预处理就是在想要Hash的消息后面补充需要的信息，使整个消息满足指定的结构。</p> 
  <p>信息的预处理分为两个步骤：<code>附加填充比特</code>和<code>附加长度</code></p> 
  <p><strong>STEP1：附加填充比特</strong></p> 
  <p>在报文末尾进行填充，使报文长度在对512取模以后的余数是448</p> 
  <p>填充是这样进行的：先补第一个比特为1，然后都补0，直到长度满足对512取模后余数是448。</p> 
  <p>需要注意的是，信息必须进行填充，也就是说，即使长度已经满足对512取模后余数是448，补位也必须要进行，这时要填充512个比特。</p> 
  <p>因此，填充是至少补一位，最多补512位。</p> 
  <p><strong>例</strong>：以信息“abc”为例显示补位的过程。</p> 
  <p>a,b,c对应的<a href="http://ascii.911cha.com/" rel="nofollow">ASCII码</a>分别是97,98,99</p> 
  <p>于是原始信息的二进制编码为：01100001 01100010 01100011</p> 
  <p>补位第一步，首先补一个“1” ： 0110000101100010 01100011 1</p> 
  <p>补位第二步,补423个“0”：01100001 01100010 01100011 10000000 00000000 … 00000000</p> 
  <p>补位完成后的数据如下（为了简介用16进制表示）：</p> 
  <pre class="prettyprint"><code class=" hljs ">61626380 00000000 00000000 00000000
00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000
00000000 00000000</code></pre> 
  <p>为什么是448?</p> 
  <p>因为在第一步的预处理后，第二步会再附加上一个64bit的数据，用来表示原始报文的长度信息。而448+64=512，正好拼成了一个完整的结构。</p> 
  <p><strong>STEP2：附加长度值</strong></p> 
  <p>附加长度值就是将原始数据（第一步填充前的消息）的长度信息补到已经进行了填充操作的消息后面。</p> 
  <p>wiki百科中给出的原文是：<em>append length of message (before pre-processing), in bits, as 64-bit big-endian integer</em></p> 
  <p>SHA256用一个64位的数据来表示原始消息的长度。</p> 
  <p>因此，通过SHA256计算的消息长度必须要小于<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mn>6</mn></msup><mn>4</mn></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-40" style="width: 1.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1001.41em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="msubsup" id="MathJax-Span-42"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-43" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.523em;"><span class="mn" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mn" id="MathJax-Span-45" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mn>
        2
       </mn>
       <mn>
        6
       </mn>
      </msup>
      <mn>
       4
      </mn>
     </math></span></span><script type="math/tex" id="MathJax-Element-3"> 2^64 </script>，当然绝大多数情况这足够大了。</p> 
  <p>长度信息的编码方式为64-bit big-endian integer</p> 
  <p>关于<a href="#Big_endian" rel="nofollow">Big endian</a>的含义，文末给出了补充 <br> <span id="Big_endian_return"></span></p> 
  <p>回到刚刚的例子，消息“abc”，3个字符，占用24个bit</p> 
  <p>因此，在进行了补长度的操作以后，整个消息就变成下面这样了（16进制格式）</p> 
  <pre class="prettyprint"><code class=" hljs ">61626380 00000000 00000000 00000000
00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000018</code></pre> 
  <h3 id="23-逻辑运算">2.3 逻辑运算</h3> 
  <p>SHA256散列函数中涉及的操作全部是逻辑的位运算</p> 
  <p>包括如下的逻辑函数：</p> 
  <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>C</mi><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2227;</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><mo stretchy=&quot;false&quot;>(</mo><mi mathvariant=&quot;normal&quot;>&amp;#x00AC;</mi><mi>x</mi><mo>&amp;#x2227;</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-46" style="width: 16.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.492em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1013.39em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic; padding-left: 0.159em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic; padding-left: 0.159em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.263em;">(</span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.211em;">∧</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.211em;">(</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Main;">¬</span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.211em;">∧</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <mi>
       C
      </mi>
      <mi>
       h
      </mi>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo>
       ,
      </mo>
      <mi>
       y
      </mi>
      <mo>
       ,
      </mo>
      <mi>
       z
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo>
       ∧
      </mo>
      <mi>
       y
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <mo stretchy="false">
       (
      </mo>
      <mi mathvariant="normal">
       ¬
      </mi>
      <mi>
       x
      </mi>
      <mo>
       ∧
      </mo>
      <mi>
       z
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-4"> Ch(x,y,z) = (x \land y) \oplus (\neg x \land z) </script> 
  <br> 
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>M</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2227;</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2227;</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2227;</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-70" style="width: 20.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.138em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1017.03em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic; padding-left: 0.159em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic; padding-left: 0.159em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.263em;">(</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.211em;">∧</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.211em;">(</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.211em;">∧</span><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.211em;">(</span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.211em;">∧</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <mi>
       M
      </mi>
      <mi>
       a
      </mi>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo>
       ,
      </mo>
      <mi>
       y
      </mi>
      <mo>
       ,
      </mo>
      <mi>
       z
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo>
       ∧
      </mo>
      <mi>
       y
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo>
       ∧
      </mo>
      <mi>
       z
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       y
      </mi>
      <mo>
       ∧
      </mo>
      <mi>
       z
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-5"> Ma(x,y,z) = (x \land y) \oplus (x \land z) \oplus (y \land z) </script> 
  <br> 
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>13</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>22</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-99" style="width: 17.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.43em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1014.33em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.732em;"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mn" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-110" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mn" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-119" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-121"><span class="mrow" id="MathJax-Span-122"><span class="mn" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Main;">13</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-128" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mn" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Main;">22</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msub>
       <mi mathvariant="normal">
        Σ
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         0
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         2
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         13
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         22
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-6"> \Sigma_{0}(x) = S^{2}(x) \oplus S^{13}(x) \oplus S^{22}(x) </script> 
  <br> 
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x03A3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>6</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>25</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-136" style="width: 17.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.43em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1014.33em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Main;">Σ</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.732em;"><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mn" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mn" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Main;">6</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-156" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mn" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main;">11</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-165" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mn" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Main;">25</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msub>
       <mi mathvariant="normal">
        Σ
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         6
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         11
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         25
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-7"> \Sigma_{1}(x) = S^{6}(x) \oplus S^{11}(x) \oplus S^{25}(x) </script> 
  <br> 
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>7</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>18</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-173" style="width: 16.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.961em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1013.86em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="texatom" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mn" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-184" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-186"><span class="mrow" id="MathJax-Span-187"><span class="mn" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Main;">7</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-193" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mn" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">18</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-202" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.784em;"><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="mn" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msub>
       <mi>
        σ
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         0
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         7
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         18
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        R
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         3
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-8"> \sigma_{0}(x) = S^{7}(x) \oplus S^{18}(x) \oplus R^{3}(x) </script> 
  <br> 
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>17</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>19</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2295;</mo><msup><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-210" style="width: 17.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.69em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1014.59em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mn" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-221" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mn" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Main;">17</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-230" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mn" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Main;">19</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.211em;">⊕</span><span class="msubsup" id="MathJax-Span-239" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.784em;"><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mn" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msub>
       <mi>
        σ
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         17
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        S
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         19
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ⊕
      </mo>
      <msup>
       <mi>
        R
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         10
        </mn>
       </mrow>
      </msup>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-9"> \sigma_{1}(x) = S^{17}(x) \oplus S^{19}(x) \oplus R^{10}(x) </script> 
  <br> 其中：
  <p></p> 
  <table> 
   <thead> 
    <tr> 
     <th>逻辑运算</th> 
     <th>含义</th> 
    </tr> 
   </thead> 
   <tbody>
    <tr> 
     <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2227;</mo></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-247" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em, 1000.6em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-248"><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">∧</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mo>
          ∧
         </mo>
        </math></span></span><script type="math/tex" id="MathJax-Element-10"> \land  </script></td> 
     <td>按位“与”</td> 
    </tr> 
    <tr> 
     <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x00AC;</mi></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-250" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.67em, 1000.6em, 2.324em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Main;">¬</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: 0.004em; border-left: 0px solid; width: 0px; height: 0.432em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi mathvariant="normal">
          ¬
         </mi>
        </math></span></span><script type="math/tex" id="MathJax-Element-11"> \neg  </script></td> 
     <td>按位“补”</td> 
    </tr> 
    <tr> 
     <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2295;</mo></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-253" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em, 1000.72em, 2.443em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-254"><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main;">⊕</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mo>
          ⊕
         </mo>
        </math></span></span><script type="math/tex" id="MathJax-Element-12"> \oplus </script></td> 
     <td>按位“异或”</td> 
    </tr> 
    <tr> 
     <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-256" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.19em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-257"><span class="msubsup" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.717em;"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup>
          <mi>
           S
          </mi>
          <mrow class="MJX-TeXAtom-ORD">
           <mi>
            n
           </mi>
          </mrow>
         </msup>
        </math></span></span><script type="math/tex" id="MathJax-Element-13"> S^{n} </script></td> 
     <td>右移n个bit</td> 
    </tr> 
    <tr> 
     <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup></math>" role="presentation" style="position: relative;">
       <nobr aria-hidden="true">
        <span class="math" id="MathJax-Span-263" style="width: 1.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1001.25em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-264"><span class="msubsup" id="MathJax-Span-265"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span>
       </nobr><span class="MJX_Assistive_MathML" role="presentation">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup>
          <mi>
           R
          </mi>
          <mrow class="MJX-TeXAtom-ORD">
           <mi>
            n
           </mi>
          </mrow>
         </msup>
        </math></span></span><script type="math/tex" id="MathJax-Element-14"> R^{n} </script></td> 
     <td>循环右移n个bit</td> 
    </tr> 
   </tbody>
  </table> 
  <h3 id="24-计算消息摘要">2.4 计算消息摘要</h3> 
  <p>现在来介绍SHA256算法的主体部分，即消息摘要是如何计算的。</p> 
  <p><strong>首先：将消息分解成512-bit大小的块</strong></p> 
  <p>(break message into 512-bit chunks)</p> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180703225842609?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTE1ODM5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="图：：消息分为n个块1" title=""></p> 
  <p>假设消息M可以被分解为n个块，于是整个算法需要做的就是完成n次迭代，n次迭代的结果就是最终的哈希值，即256bit的数字摘要。</p> 
  <p>一个256-bit的摘要的初始值H0，经过第一个数据块进行运算，得到H1，即完成了第一次迭代</p> 
  <p>H1经过第二个数据块得到H2，……，依次处理，最后得到Hn，Hn即为最终的256-bit消息摘要</p> 
  <p>将每次迭代进行的映射用<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>a</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-270" style="width: 8.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1007.35em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-271"><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-276"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-278"><span class="mrow" id="MathJax-Span-279"><span class="mi" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-285" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       M
      </mi>
      <mi>
       a
      </mi>
      <mi>
       p
      </mi>
      <mo stretchy="false">
       (
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
       </mrow>
      </msub>
     </math></span></span><script type="math/tex" id="MathJax-Element-15"> Map(H_{i-1}) = H_{i} </script>表示，于是迭代可以更形象的展示为：</p> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180703230030566?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTE1ODM5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="图：：迭代过程2" title=""></p> 
  <p>图中256-bit的<code>Hi</code>被描述8个小块，这是因为SHA256算法中的最小运算单元称为“字”（Word），一个字是32位。</p> 
  <p>此外，第一次迭代中，映射的初值设置为前面介绍的8个哈希初值，如下图所示：</p> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180703230146224?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTE1ODM5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="图：：哈希初值3" title=""></p> 
  <p>下面开始介绍每一次迭代的内容，即映射<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>a</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-290" style="width: 8.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1007.35em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-305" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       M
      </mi>
      <mi>
       a
      </mi>
      <mi>
       p
      </mi>
      <mo stretchy="false">
       (
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
       </mrow>
      </msub>
     </math></span></span><script type="math/tex" id="MathJax-Element-16"> Map(H_{i-1}) = H_{i} </script>的具体算法</p> 
  <p><strong>STEP1：构造64个字（word）</strong></p> 
  <p>break chunk into sixteen 32-bit big-endian words w[0], …, w[15]</p> 
  <p>对于每一块，将块分解为16个32-bit的big-endian的字，记为w[0], …, w[15]</p> 
  <p>也就是说，前16个字直接由消息的第i个块分解得到</p> 
  <p>其余的字由如下迭代公式得到：</p> 
  <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p>
  <div class="MathJax_Display" style="text-align: center;">
   <span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>7</mn></mrow></msub><mo>+</mo><msub><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>15</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>16</mn></mrow></msub></math>" role="presentation">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-310" style="width: 23.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.169em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1019.17em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-311"><span class="msubsup" id="MathJax-Span-312"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.04em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.94em;"><span class="texatom" id="MathJax-Span-314"><span class="mrow" id="MathJax-Span-315"><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-318" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="texatom" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mn" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 2.19em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.04em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.94em;"><span class="texatom" id="MathJax-Span-326"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="msubsup" id="MathJax-Span-333" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 2.19em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.04em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.94em;"><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-338" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-339" style="font-size: 70.7%; font-family: MathJax_Main;">7</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="msubsup" id="MathJax-Span-341" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="texatom" id="MathJax-Span-343"><span class="mrow" id="MathJax-Span-344"><span class="mn" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-347"><span style="display: inline-block; position: relative; width: 2.555em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.04em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.94em;"><span class="texatom" id="MathJax-Span-349"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">15</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="msubsup" id="MathJax-Span-356" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 2.555em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.04em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.94em;"><span class="texatom" id="MathJax-Span-358"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-362" style="font-size: 70.7%; font-family: MathJax_Main;">16</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <msub>
       <mi>
        W
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         t
        </mi>
       </mrow>
      </msub>
      <mo>
       =
      </mo>
      <msub>
       <mi>
        σ
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <msub>
       <mi>
        W
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         t
        </mi>
        <mo>
         −
        </mo>
        <mn>
         2
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       +
      </mo>
      <msub>
       <mi>
        W
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         t
        </mi>
        <mo>
         −
        </mo>
        <mn>
         7
        </mn>
       </mrow>
      </msub>
      <mo>
       +
      </mo>
      <msub>
       <mi>
        σ
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         0
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <msub>
       <mi>
        W
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         t
        </mi>
        <mo>
         −
        </mo>
        <mn>
         15
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       +
      </mo>
      <msub>
       <mi>
        W
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         t
        </mi>
        <mo>
         −
        </mo>
        <mn>
         16
        </mn>
       </mrow>
      </msub>
     </math></span></span>
  </div>
  <script type="math/tex; mode=display" id="MathJax-Element-17"> W_{t} = \sigma_{1}(W_{t-2}) + W_{t-7} + \sigma_{0}(W_{t-15}) + W_{t-16}</script>
  <p></p> 
  <p><strong>STEP2：进行64次循环</strong></p> 
  <p>映射 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>a</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-363" style="width: 8.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1007.35em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-371"><span class="mrow" id="MathJax-Span-372"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-378" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       M
      </mi>
      <mi>
       a
      </mi>
      <mi>
       p
      </mi>
      <mo stretchy="false">
       (
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       =
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
       </mrow>
      </msub>
     </math></span></span><script type="math/tex" id="MathJax-Element-18"> Map(H_{i-1}) = H_{i} </script> 包含了64次加密循环</p> 
  <p>即进行64次加密循环即可完成一次迭代</p> 
  <p>每次加密循环可以由下图描述：</p> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180703230317593?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTE1ODM5Mjc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="图：：加密循环4" title=""></p> 
  <p>图中，ABCDEFGH这8个字（word）在按照一定的规则进行更新，其中</p> 
  <p>深蓝色方块是事先定义好的非线性逻辑函数，上文已经做过铺垫</p> 
  <p>红色田字方块代表 mod <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>32</mn></mrow></msup></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-383" style="width: 1.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1001.3em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-384"><span class="msubsup" id="MathJax-Span-385"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-386" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.523em;"><span class="texatom" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="mn" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mn>
        2
       </mn>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         32
        </mn>
       </mrow>
      </msup>
     </math></span></span><script type="math/tex" id="MathJax-Element-19"> 2^{32} </script> addition，即将两个数字加在一起，如果结果大于<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>32</mn></mrow></msup></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-390" style="width: 1.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1001.3em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-391"><span class="msubsup" id="MathJax-Span-392"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-393" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.523em;"><span class="texatom" id="MathJax-Span-394"><span class="mrow" id="MathJax-Span-395"><span class="mn" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mn>
        2
       </mn>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         32
        </mn>
       </mrow>
      </msup>
     </math></span></span><script type="math/tex" id="MathJax-Element-20"> 2^{32} </script>，你必须除以<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>32</mn></mrow></msup></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-397" style="width: 1.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1001.3em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-398"><span class="msubsup" id="MathJax-Span-399"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-400" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.523em;"><span class="texatom" id="MathJax-Span-401"><span class="mrow" id="MathJax-Span-402"><span class="mn" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msup>
       <mn>
        2
       </mn>
       <mrow class="MJX-TeXAtom-ORD">
        <mn>
         32
        </mn>
       </mrow>
      </msup>
     </math></span></span><script type="math/tex" id="MathJax-Element-21"> 2^{32} </script>并找到余数。</p> 
  <p>ABCDEFGH一开始的初始值分别为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mn>7</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-404" style="width: 15.107em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.555em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1012.45em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="msubsup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-408"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-411" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-412" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-414" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-417" style="padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-425" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main; padding-left: 0.159em;">.</span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main; padding-left: 0.159em;">.</span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main; padding-left: 0.159em;">.</span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main; padding-left: 0.159em;">,</span><span class="msubsup" id="MathJax-Span-432" style="padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-440" style="font-family: MathJax_Main;">7</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mn>
       0
      </mn>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ,
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mn>
       1
      </mn>
      <mo stretchy="false">
       )
      </mo>
      <mo>
       ,
      </mo>
      <mo>
       .
      </mo>
      <mo>
       .
      </mo>
      <mo>
       .
      </mo>
      <mo>
       ,
      </mo>
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
        <mo>
         −
        </mo>
        <mn>
         1
        </mn>
       </mrow>
      </msub>
      <mo stretchy="false">
       (
      </mo>
      <mn>
       7
      </mn>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span><script type="math/tex" id="MathJax-Element-22"> H_{i-1}(0),H_{i-1}(1),...,H_{i-1}(7) </script></p> 
  <p>Kt是第t个密钥，对应我们上文提到的64个常量</p> 
  <p>Wt是本区块产生第t个word。原消息被切成固定长度512-bit的区块，对每一个区块，产生64个word，通过重复运行循环n次对ABCDEFGH这八个字循环加密。</p> 
  <p>最后一次循环所产生的八个字合起来即是第i个块对应到的散列字符串<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>H</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-442" style="width: 1.409em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1001.15em, 2.451em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="msubsup" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.89em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.836em;"><span class="texatom" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <msub>
       <mi>
        H
       </mi>
       <mrow class="MJX-TeXAtom-ORD">
        <mi>
         i
        </mi>
       </mrow>
      </msub>
     </math></span></span><script type="math/tex" id="MathJax-Element-23"> H_{i} </script></p> 
  <p>由此变完成了SHA256算法的所有介绍</p> 
  <hr> 
  <h2 id="3-sha256算法伪代码">3. SHA256算法伪代码</h2> 
  <p>现在我们可以结合SHA256算法的伪代码,将上述的所有步骤进行梳理整合：</p> 
  <pre class="prettyprint"><code class=" hljs http"><span class="hljs-attribute">Note</span>: <span class="hljs-string">All variables are unsigned 32 bits and wrap modulo 232 when calculating</span>

<span class="applescript"> Initialize variables (<span class="hljs-keyword">first</span> <span class="hljs-number">32</span> bits <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> fractional parts <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> square roots <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">first</span> <span class="hljs-number">8</span> primes <span class="hljs-number">2.</span><span class="hljs-number">.19</span>): h0 := <span class="hljs-number">0x6a09e667</span> h1 := <span class="hljs-number">0xbb67ae85</span> h2 := <span class="hljs-number">0x3c6ef372</span> h3 := <span class="hljs-number">0xa54ff53a</span> h4 := <span class="hljs-number">0x510e527f</span> h5 := <span class="hljs-number">0x9b05688c</span> h6 := <span class="hljs-number">0x1f83d9ab</span> h7 := <span class="hljs-number">0x5be0cd19</span> Initialize table <span class="hljs-keyword">of</span> <span class="hljs-command">round</span> constants (<span class="hljs-keyword">first</span> <span class="hljs-number">32</span> bits <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> fractional parts <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> cube roots <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">first</span> <span class="hljs-number">64</span> primes <span class="hljs-number">2.</span><span class="hljs-number">.311</span>): k[<span class="hljs-number">0.</span><span class="hljs-number">.63</span>] := <span class="hljs-number">0x428a2f98</span>, <span class="hljs-number">0x71374491</span>, <span class="hljs-number">0xb5c0fbcf</span>, <span class="hljs-number">0xe9b5dba5</span>, <span class="hljs-number">0x3956c25b</span>, <span class="hljs-number">0x59f111f1</span>, <span class="hljs-number">0x923f82a4</span>, <span class="hljs-number">0xab1c5ed5</span>, <span class="hljs-number">0xd807aa98</span>, <span class="hljs-number">0x12835b01</span>, <span class="hljs-number">0x243185be</span>, <span class="hljs-number">0x550c7dc3</span>, <span class="hljs-number">0x72be5d74</span>, <span class="hljs-number">0x80deb1fe</span>, <span class="hljs-number">0x9bdc06a7</span>, <span class="hljs-number">0xc19bf174</span>, <span class="hljs-number">0xe49b69c1</span>, <span class="hljs-number">0xefbe4786</span>, <span class="hljs-number">0x0fc19dc6</span>, <span class="hljs-number">0x240ca1cc</span>, <span class="hljs-number">0x2de92c6f</span>, <span class="hljs-number">0x4a7484aa</span>, <span class="hljs-number">0x5cb0a9dc</span>, <span class="hljs-number">0x76f988da</span>, <span class="hljs-number">0x983e5152</span>, <span class="hljs-number">0xa831c66d</span>, <span class="hljs-number">0xb00327c8</span>, <span class="hljs-number">0xbf597fc7</span>, <span class="hljs-number">0xc6e00bf3</span>, <span class="hljs-number">0xd5a79147</span>, <span class="hljs-number">0x06ca6351</span>, <span class="hljs-number">0x14292967</span>, <span class="hljs-number">0x27b70a85</span>, <span class="hljs-number">0x2e1b2138</span>, <span class="hljs-number">0x4d2c6dfc</span>, <span class="hljs-number">0x53380d13</span>, <span class="hljs-number">0x650a7354</span>, <span class="hljs-number">0x766a0abb</span>, <span class="hljs-number">0x81c2c92e</span>, <span class="hljs-number">0x92722c85</span>, <span class="hljs-number">0xa2bfe8a1</span>, <span class="hljs-number">0xa81a664b</span>, <span class="hljs-number">0xc24b8b70</span>, <span class="hljs-number">0xc76c51a3</span>, <span class="hljs-number">0xd192e819</span>, <span class="hljs-number">0xd6990624</span>, <span class="hljs-number">0xf40e3585</span>, <span class="hljs-number">0x106aa070</span>, <span class="hljs-number">0x19a4c116</span>, <span class="hljs-number">0x1e376c08</span>, <span class="hljs-number">0x2748774c</span>, <span class="hljs-number">0x34b0bcb5</span>, <span class="hljs-number">0x391c0cb3</span>, <span class="hljs-number">0x4ed8aa4a</span>, <span class="hljs-number">0x5b9cca4f</span>, <span class="hljs-number">0x682e6ff3</span>, <span class="hljs-number">0x748f82ee</span>, <span class="hljs-number">0x78a5636f</span>, <span class="hljs-number">0x84c87814</span>, <span class="hljs-number">0x8cc70208</span>, <span class="hljs-number">0x90befffa</span>, <span class="hljs-number">0xa4506ceb</span>, <span class="hljs-number">0xbef9a3f7</span>, <span class="hljs-number">0xc67178f2</span> Pre-processing: append <span class="hljs-keyword">the</span> bit '<span class="hljs-number">1</span>' <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> message append k bits '<span class="hljs-number">0</span>', <span class="hljs-keyword">where</span> k <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> minimum <span class="hljs-type">number</span> &gt;= <span class="hljs-number">0</span> such <span class="hljs-keyword">that</span> <span class="hljs-keyword">the</span> resulting message <span class="hljs-property">length</span> (<span class="hljs-keyword">in</span> bits) <span class="hljs-keyword">is</span> congruent <span class="hljs-keyword">to</span> <span class="hljs-number">448</span>(<span class="hljs-keyword">mod</span> <span class="hljs-number">512</span>) append <span class="hljs-property">length</span> <span class="hljs-keyword">of</span> message (<span class="hljs-keyword">before</span> pre-processing), <span class="hljs-keyword">in</span> bits, <span class="hljs-keyword">as</span> <span class="hljs-number">64</span>-bit big-endian <span class="hljs-type">integer</span> Process <span class="hljs-keyword">the</span> message <span class="hljs-keyword">in</span> successive <span class="hljs-number">512</span>-bit chunks: break message <span class="hljs-keyword">into</span> <span class="hljs-number">512</span>-bit chunks <span class="hljs-keyword">for</span> each chunk break chunk <span class="hljs-keyword">into</span> sixteen <span class="hljs-number">32</span>-bit big-endian <span class="hljs-property">words</span> w[<span class="hljs-number">0.</span><span class="hljs-number">.15</span>] Extend <span class="hljs-keyword">the</span> sixteen <span class="hljs-number">32</span>-bit <span class="hljs-property">words</span> <span class="hljs-keyword">into</span> sixty-four <span class="hljs-number">32</span>-bit <span class="hljs-property">words</span>: <span class="hljs-keyword">for</span> i <span class="hljs-keyword">from</span> <span class="hljs-number">16</span> <span class="hljs-keyword">to</span> <span class="hljs-number">63</span> s0 := (w[i-<span class="hljs-number">15</span>] rightrotate <span class="hljs-number">7</span>) xor (w[i-<span class="hljs-number">15</span>] rightrotate <span class="hljs-number">18</span>) xor(w[i-<span class="hljs-number">15</span>] rightshift <span class="hljs-number">3</span>) s1 := (w[i-<span class="hljs-number">2</span>] rightrotate <span class="hljs-number">17</span>) xor (w[i-<span class="hljs-number">2</span>] rightrotate <span class="hljs-number">19</span>) xor(w[i-<span class="hljs-number">2</span>] rightshift <span class="hljs-number">10</span>) w[i] := w[i-<span class="hljs-number">16</span>] + s0 + w[i-<span class="hljs-number">7</span>] + s1 Initialize hash value <span class="hljs-keyword">for</span> this chunk: a := h0 b := h1 c := h2 d := h3 e := h4 f := h5 g := h6 h := h7 Main loop: <span class="hljs-keyword">for</span> i <span class="hljs-keyword">from</span> <span class="hljs-number">0</span> <span class="hljs-keyword">to</span> <span class="hljs-number">63</span> s0 := (a rightrotate <span class="hljs-number">2</span>) xor (a rightrotate <span class="hljs-number">13</span>) xor(a rightrotate <span class="hljs-number">22</span>) maj := (a <span class="hljs-keyword">and</span> b) xor (a <span class="hljs-keyword">and</span> c) xor(b <span class="hljs-keyword">and</span> c) t2 := s0 + maj s1 := (e rightrotate <span class="hljs-number">6</span>) xor (e rightrotate <span class="hljs-number">11</span>) xor(e rightrotate <span class="hljs-number">25</span>) ch := (e <span class="hljs-keyword">and</span> f) xor ((<span class="hljs-keyword">not</span> e) <span class="hljs-keyword">and</span> g) t1 := h + s1 + ch + k[i] + w[i] h := g g := f f := e e := d + t1 d := c c := b b := a a := t1 + t2 Add this chunk's hash <span class="hljs-keyword">to</span> <span class="hljs-constant">result</span> so far: h0 := h0 + a h1 := h1 + b h2 := h2 + c h3 := h3 + d h4 := h4 + e h5 := h5 + f h6 := h6 + g h7 := h7 + h Produce <span class="hljs-keyword">the</span> final hash value (big-endian): digest = hash = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7</span></code></pre> 
  <hr> 
  <h2 id="4-参考文献">4. 参考文献</h2> 
  <p>本篇笔记主要参考整合的资料如下：</p> 
  <p><a href="https://zh.wikipedia.org/wiki/SHA-2" rel="nofollow">SHA-2 wiki</a></p> 
  <p><a href="https://blog.csdn.net/wowotuo/article/details/78907380" rel="nofollow">比特币算法——SHA256算法介绍</a></p> 
  <p><a href="https://blog.csdn.net/lwanttowin/article/details/53726450" rel="nofollow">SHA-256算法实现</a></p> 
  <p><a href="https://nxtwiki.org/mediawiki/index.php?title=How-To:VerifySHA256/zh&amp;variant=zh" rel="nofollow">操作指南：验证SHA256</a></p> 
  <hr> 
  <h1 id="知识填补">知识填补</h1> 
  <h2 id="大端和小端big-endian-and-little-endian">大端和小端（Big endian and Little endian）</h2> 
  <p><span id="Big_endian"></span></p> 
  <p>对于整型、长整型等数据类型，都存在字节排列的高低位顺序问题。</p> 
  <p>Big endian 认为第一个字节是最高位字节（按照从低地址到高地址的顺序存放数据的高位字节到低位字节）</p> 
  <p>而 Little endian 则相反，它认为第一个字节是最低位字节（按照从低地址到高地址的顺序存放据的低位字节到高位字节）。</p> 
  <p>例如，假设从内存地址 0x0000 开始有以下数据：</p> 
  <table> 
   <thead> 
    <tr> 
     <th>地址</th> 
     <th>数据</th> 
    </tr> 
   </thead> 
   <tbody>
    <tr> 
     <td>…</td> 
     <td>…</td> 
    </tr> 
    <tr> 
     <td>0x0000</td> 
     <td>0x12</td> 
    </tr> 
    <tr> 
     <td>0x0001</td> 
     <td>0x34</td> 
    </tr> 
    <tr> 
     <td>0x0002</td> 
     <td>0xab</td> 
    </tr> 
    <tr> 
     <td>0x0003</td> 
     <td>0xcd</td> 
    </tr> 
    <tr> 
     <td>…</td> 
     <td>…</td> 
    </tr> 
   </tbody>
  </table> 
  <p>假设我们去读取一个地址为 0x0000 的四个字节变量</p> 
  <p>若字节序为big-endian，则读出结果为0x1234abcd；</p> 
  <p>若字节序为little-endian，则读出结果为0xcdab3412。</p> 
  <p>如果我们将0x1234abcd 写入到以 0x0000 开始的内存中，则Little endian 和 Big endian 模式的存放结果如下：</p> 
  <table> 
   <thead> 
    <tr> 
     <th>地址</th> 
     <th>0x0000</th> 
     <th>0x0001</th> 
     <th>0x0002</th> 
     <th>0x0003</th> 
    </tr> 
   </thead> 
   <tbody>
    <tr> 
     <td>big-Big_endian</td> 
     <td>0x12</td> 
     <td>0x34</td> 
     <td>0xab</td> 
     <td>0xcd</td> 
    </tr> 
    <tr> 
     <td>little-endian</td> 
     <td>0xcd</td> 
     <td>0xab</td> 
     <td>0x34</td> 
     <td>0x12</td> 
    </tr> 
   </tbody>
  </table> 
  <p><a href="https://www.cnblogs.com/luxiaoxun/archive/2012/09/05/2671697.html" rel="nofollow">参考文献</a></p> 
  <p><a href="#Big_endian_return" rel="nofollow">点击返回正文</a></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7f770a53f2.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u011583927/article/details/80905740,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u011583927/article/details/80905740,&quot;}">阅读更多</a> 
</div> 
<script>
						(function(){
							function setArticleH(btnReadmore,posi){
								var winH = $(window).height();
								var articleBox = $("div.article_content");
								var artH = articleBox.height();
								if(artH > winH*posi){
									articleBox.css({
										'height':winH*posi+'px',
										'overflow':'hidden'
									})
									btnReadmore.click(function(){
										articleBox.removeAttr("style");
										$(this).parent().remove();
									})
								}else{
									btnReadmore.parent().remove();
								}
							}
							var btnReadmore = $("#btn-readmore");
							if(btnReadmore.length>0){
								if(currentUserName){
									setArticleH(btnReadmore,3);
								}else{
									setArticleH(btnReadmore,1.2);
								}
							}
						})()
					</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
