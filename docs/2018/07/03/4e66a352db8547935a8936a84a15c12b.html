<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>CentOS7环境下搭建Hyperledger超级账本 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="CentOS7环境下搭建Hyperledger超级账本" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="一、安装Docker &nbsp; &nbsp; &nbsp; &nbsp;目前开源社区Docker最新版本为 18.03.1，社区分为开源版本（docker-ce）和企业版本（docker-ee）。&nbsp;需要配置Docker官方源才可以安装最新版本，此处我们安装开源社区版本 docker-ce。 &nbsp; &nbsp; &nbsp; &nbsp;需要安装 Docker 及 Docker-compose，验证这两项安装成功即可。 二、安装Go语言运行环境 &nbsp; &nbsp; &nbsp; &nbsp; Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。Go语言于2009年11月由Google正式宣布推出，成为开放源代码项目，并在Linux及Mac OS X平台上进行了实现，后追加Windows系统下的实现。Go语言具有&nbsp;部署简单、并发性好、良好的语言设计、执行性能好 等特点。 三、安装NVM及Node.js &nbsp; &nbsp; &nbsp; &nbsp; nvm全称Node Version Manager ，是 Nodejs 版本管理器，它让我们能方便的对 Nodejs 的版 本进行切换。 nvm 的官方版本只支持 Linux 和 Mac。 Windows 用户，可以用 nvm-windows。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fabric暂时不支持7.x，需要安装6.9.x 或&nbsp; 6.x高的版本，通过&nbsp;&nbsp; &nbsp;nvm&nbsp;&nbsp; &nbsp;安装指定 版本的node。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 现安装Node.js 6.5.9 版本。 至此 Docker、Docker-compose、Go、Node.js&nbsp; 基础运行环境已经全部安装完成。 四、Fabric Samples 下载并安装 &nbsp; &nbsp; &nbsp; &nbsp; 运行Fabric最基础的运行环境为 Docker、Go、Node.js ，配置完基础运行环境后，在对Fabric网络进行配置，主要配置步骤如下： 准备网络内各项配置。包括网络成员的组织结构和身份证书（可使用crypyogen工具完成）；生成系统通道的初始化区块文件（创世区块配置文件），新建应用通道的配置更新交易文件以及可能需要的锚节点配置更新文件（使用configtxgen工具完成） 使用系统通道的初始化配置区块文件启动排序节点，排序节点启动后自动按照指定配置创建系统通道。 不同的组织按照配置角色分别启动 peer 节点。这个时候系统中不存在应用通道，peer节点并没有加入到网络中。 使用新建应用通道的配置更新交易文件，向系统通道发送交易，创建新的应用通道。 让对应的 Peer 节点加入所创建的应用通道中，此时Peer节点加入网络，可以进行交易了。 用户通过客户端向网络中安装链码，链码容器启动成功后用户即可对链码进行调用，将交易发送到网络中。 1、下载Fabric Samples &nbsp; &nbsp; &nbsp; &nbsp; Fabric Samples 的 Git 地址为：https://github.com/hyperledger/fabric-samples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 目前&nbsp;&nbsp;Fabric Samples&nbsp; 最新版本为 1.1 ，但是1.1 版本在安装过程中会遇到一些问题，暂时无法解决，所以现使用 1.0 版本。 在左侧版本选择处选择 1.0 版本，并下载： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; wget https://github.com/hyperledger/fabric-samples/archive/release-1.0.zip &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 解压后，在CentOS 中的路径为： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/dev/hyperledger/fabric-samples-release-1.0 2、下载镜像和要执行的二进制文件 &nbsp; &nbsp; &nbsp; &nbsp;(1) 如果可以翻墙，可以打开&nbsp;https://goo.gl/byy2Qj ，将内容保存init.sh文件，放置&nbsp;于fabric-samples-release-1.0根目录中。 &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; （2）如果访问不了外网，可以在fabric项目的scripts找到bootstrap.sh文件，并下载到fabric-samples-release-1.0根目录中。 下载地址： https://github.com/hyperledger/fabric/blob/release-1.0/scripts/bootstrap.sh 注意：根据项目的版本切换到对应版本下的scripts文件下载。 &nbsp; &nbsp; （3）为&nbsp;bootstrap.sh 授予可执行权限，并执行bootstrap.sh下载镜像（要等几分钟）： ./bootstrap.sh &nbsp; &nbsp; （4）执行完会在根目录生成bin文件夹 3、配置超级账本网络信息 进入first-network 目录，接下来所有的操作，都在此目录下进行。 cd first-network 打开&nbsp;docker-compose-cli.yaml 文件，注释掉&nbsp; command: /bin/bash -c &#39;./scripts/script.sh ${CHANNEL_NAME} ${DELAY}; sleep $TIMEOUT&#39; &nbsp; 这句代码，如下图： &nbsp;以下操作主要为网络配置操作，可以保存为sh文件，批量执行： # 配置网络基础数据 ./byfn.sh -m generate #生成创世区块 ../bin/cryptogen generate --config=./crypto-config.yaml export FABRIC_CFG_PATH=$PWD ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block #⽣成应⽤通道的配置信息 export CHANNEL_NAME=mychannel ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME #⽣成锚节点配置更新⽂件 ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org1MSP ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org2MSP #操作⽹络，编辑 docker-compose-cli.yaml ,注释掉 command 命令（注释步骤之前已经完成了） CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d &nbsp;&nbsp; 以下为Docker 操作，主要目标为 创建和加⼊通道 docker exec -it cli bash 在Docker容器中创建通道 export CHANNEL_NAME=mychannel peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem &nbsp; 加⼊通道 peer channel join -b mychannel.block 链上代码 （链码） 安装链码（此处安装的代码并非本地的代码） peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 &nbsp;实例化链码 peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR(&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; &nbsp;查询 peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; 可以看到返回结果如下： Query Result:100 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}&#39; &nbsp;现操作A转账给B 10 块钱，这个命令将会创建新的block同时更新state DB。 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}&#39; 查询 a 账户的金额 peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; 查询结果仅剩90块，如下 Query Result: 90 阅读更多" />
<meta property="og:description" content="一、安装Docker &nbsp; &nbsp; &nbsp; &nbsp;目前开源社区Docker最新版本为 18.03.1，社区分为开源版本（docker-ce）和企业版本（docker-ee）。&nbsp;需要配置Docker官方源才可以安装最新版本，此处我们安装开源社区版本 docker-ce。 &nbsp; &nbsp; &nbsp; &nbsp;需要安装 Docker 及 Docker-compose，验证这两项安装成功即可。 二、安装Go语言运行环境 &nbsp; &nbsp; &nbsp; &nbsp; Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。Go语言于2009年11月由Google正式宣布推出，成为开放源代码项目，并在Linux及Mac OS X平台上进行了实现，后追加Windows系统下的实现。Go语言具有&nbsp;部署简单、并发性好、良好的语言设计、执行性能好 等特点。 三、安装NVM及Node.js &nbsp; &nbsp; &nbsp; &nbsp; nvm全称Node Version Manager ，是 Nodejs 版本管理器，它让我们能方便的对 Nodejs 的版 本进行切换。 nvm 的官方版本只支持 Linux 和 Mac。 Windows 用户，可以用 nvm-windows。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fabric暂时不支持7.x，需要安装6.9.x 或&nbsp; 6.x高的版本，通过&nbsp;&nbsp; &nbsp;nvm&nbsp;&nbsp; &nbsp;安装指定 版本的node。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 现安装Node.js 6.5.9 版本。 至此 Docker、Docker-compose、Go、Node.js&nbsp; 基础运行环境已经全部安装完成。 四、Fabric Samples 下载并安装 &nbsp; &nbsp; &nbsp; &nbsp; 运行Fabric最基础的运行环境为 Docker、Go、Node.js ，配置完基础运行环境后，在对Fabric网络进行配置，主要配置步骤如下： 准备网络内各项配置。包括网络成员的组织结构和身份证书（可使用crypyogen工具完成）；生成系统通道的初始化区块文件（创世区块配置文件），新建应用通道的配置更新交易文件以及可能需要的锚节点配置更新文件（使用configtxgen工具完成） 使用系统通道的初始化配置区块文件启动排序节点，排序节点启动后自动按照指定配置创建系统通道。 不同的组织按照配置角色分别启动 peer 节点。这个时候系统中不存在应用通道，peer节点并没有加入到网络中。 使用新建应用通道的配置更新交易文件，向系统通道发送交易，创建新的应用通道。 让对应的 Peer 节点加入所创建的应用通道中，此时Peer节点加入网络，可以进行交易了。 用户通过客户端向网络中安装链码，链码容器启动成功后用户即可对链码进行调用，将交易发送到网络中。 1、下载Fabric Samples &nbsp; &nbsp; &nbsp; &nbsp; Fabric Samples 的 Git 地址为：https://github.com/hyperledger/fabric-samples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 目前&nbsp;&nbsp;Fabric Samples&nbsp; 最新版本为 1.1 ，但是1.1 版本在安装过程中会遇到一些问题，暂时无法解决，所以现使用 1.0 版本。 在左侧版本选择处选择 1.0 版本，并下载： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; wget https://github.com/hyperledger/fabric-samples/archive/release-1.0.zip &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 解压后，在CentOS 中的路径为： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/dev/hyperledger/fabric-samples-release-1.0 2、下载镜像和要执行的二进制文件 &nbsp; &nbsp; &nbsp; &nbsp;(1) 如果可以翻墙，可以打开&nbsp;https://goo.gl/byy2Qj ，将内容保存init.sh文件，放置&nbsp;于fabric-samples-release-1.0根目录中。 &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; （2）如果访问不了外网，可以在fabric项目的scripts找到bootstrap.sh文件，并下载到fabric-samples-release-1.0根目录中。 下载地址： https://github.com/hyperledger/fabric/blob/release-1.0/scripts/bootstrap.sh 注意：根据项目的版本切换到对应版本下的scripts文件下载。 &nbsp; &nbsp; （3）为&nbsp;bootstrap.sh 授予可执行权限，并执行bootstrap.sh下载镜像（要等几分钟）： ./bootstrap.sh &nbsp; &nbsp; （4）执行完会在根目录生成bin文件夹 3、配置超级账本网络信息 进入first-network 目录，接下来所有的操作，都在此目录下进行。 cd first-network 打开&nbsp;docker-compose-cli.yaml 文件，注释掉&nbsp; command: /bin/bash -c &#39;./scripts/script.sh ${CHANNEL_NAME} ${DELAY}; sleep $TIMEOUT&#39; &nbsp; 这句代码，如下图： &nbsp;以下操作主要为网络配置操作，可以保存为sh文件，批量执行： # 配置网络基础数据 ./byfn.sh -m generate #生成创世区块 ../bin/cryptogen generate --config=./crypto-config.yaml export FABRIC_CFG_PATH=$PWD ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block #⽣成应⽤通道的配置信息 export CHANNEL_NAME=mychannel ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME #⽣成锚节点配置更新⽂件 ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org1MSP ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org2MSP #操作⽹络，编辑 docker-compose-cli.yaml ,注释掉 command 命令（注释步骤之前已经完成了） CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d &nbsp;&nbsp; 以下为Docker 操作，主要目标为 创建和加⼊通道 docker exec -it cli bash 在Docker容器中创建通道 export CHANNEL_NAME=mychannel peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem &nbsp; 加⼊通道 peer channel join -b mychannel.block 链上代码 （链码） 安装链码（此处安装的代码并非本地的代码） peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 &nbsp;实例化链码 peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR(&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; &nbsp;查询 peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; 可以看到返回结果如下： Query Result:100 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}&#39; &nbsp;现操作A转账给B 10 块钱，这个命令将会创建新的block同时更新state DB。 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}&#39; 查询 a 账户的金额 peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; 查询结果仅剩90块，如下 Query Result: 90 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/07/03/4e66a352db8547935a8936a84a15c12b.html" />
<meta property="og:url" content="https://mlh.app/2018/07/03/4e66a352db8547935a8936a84a15c12b.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-03T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"一、安装Docker &nbsp; &nbsp; &nbsp; &nbsp;目前开源社区Docker最新版本为 18.03.1，社区分为开源版本（docker-ce）和企业版本（docker-ee）。&nbsp;需要配置Docker官方源才可以安装最新版本，此处我们安装开源社区版本 docker-ce。 &nbsp; &nbsp; &nbsp; &nbsp;需要安装 Docker 及 Docker-compose，验证这两项安装成功即可。 二、安装Go语言运行环境 &nbsp; &nbsp; &nbsp; &nbsp; Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。Go语言于2009年11月由Google正式宣布推出，成为开放源代码项目，并在Linux及Mac OS X平台上进行了实现，后追加Windows系统下的实现。Go语言具有&nbsp;部署简单、并发性好、良好的语言设计、执行性能好 等特点。 三、安装NVM及Node.js &nbsp; &nbsp; &nbsp; &nbsp; nvm全称Node Version Manager ，是 Nodejs 版本管理器，它让我们能方便的对 Nodejs 的版 本进行切换。 nvm 的官方版本只支持 Linux 和 Mac。 Windows 用户，可以用 nvm-windows。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fabric暂时不支持7.x，需要安装6.9.x 或&nbsp; 6.x高的版本，通过&nbsp;&nbsp; &nbsp;nvm&nbsp;&nbsp; &nbsp;安装指定 版本的node。 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 现安装Node.js 6.5.9 版本。 至此 Docker、Docker-compose、Go、Node.js&nbsp; 基础运行环境已经全部安装完成。 四、Fabric Samples 下载并安装 &nbsp; &nbsp; &nbsp; &nbsp; 运行Fabric最基础的运行环境为 Docker、Go、Node.js ，配置完基础运行环境后，在对Fabric网络进行配置，主要配置步骤如下： 准备网络内各项配置。包括网络成员的组织结构和身份证书（可使用crypyogen工具完成）；生成系统通道的初始化区块文件（创世区块配置文件），新建应用通道的配置更新交易文件以及可能需要的锚节点配置更新文件（使用configtxgen工具完成） 使用系统通道的初始化配置区块文件启动排序节点，排序节点启动后自动按照指定配置创建系统通道。 不同的组织按照配置角色分别启动 peer 节点。这个时候系统中不存在应用通道，peer节点并没有加入到网络中。 使用新建应用通道的配置更新交易文件，向系统通道发送交易，创建新的应用通道。 让对应的 Peer 节点加入所创建的应用通道中，此时Peer节点加入网络，可以进行交易了。 用户通过客户端向网络中安装链码，链码容器启动成功后用户即可对链码进行调用，将交易发送到网络中。 1、下载Fabric Samples &nbsp; &nbsp; &nbsp; &nbsp; Fabric Samples 的 Git 地址为：https://github.com/hyperledger/fabric-samples &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 目前&nbsp;&nbsp;Fabric Samples&nbsp; 最新版本为 1.1 ，但是1.1 版本在安装过程中会遇到一些问题，暂时无法解决，所以现使用 1.0 版本。 在左侧版本选择处选择 1.0 版本，并下载： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; wget https://github.com/hyperledger/fabric-samples/archive/release-1.0.zip &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 解压后，在CentOS 中的路径为： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/dev/hyperledger/fabric-samples-release-1.0 2、下载镜像和要执行的二进制文件 &nbsp; &nbsp; &nbsp; &nbsp;(1) 如果可以翻墙，可以打开&nbsp;https://goo.gl/byy2Qj ，将内容保存init.sh文件，放置&nbsp;于fabric-samples-release-1.0根目录中。 &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; （2）如果访问不了外网，可以在fabric项目的scripts找到bootstrap.sh文件，并下载到fabric-samples-release-1.0根目录中。 下载地址： https://github.com/hyperledger/fabric/blob/release-1.0/scripts/bootstrap.sh 注意：根据项目的版本切换到对应版本下的scripts文件下载。 &nbsp; &nbsp; （3）为&nbsp;bootstrap.sh 授予可执行权限，并执行bootstrap.sh下载镜像（要等几分钟）： ./bootstrap.sh &nbsp; &nbsp; （4）执行完会在根目录生成bin文件夹 3、配置超级账本网络信息 进入first-network 目录，接下来所有的操作，都在此目录下进行。 cd first-network 打开&nbsp;docker-compose-cli.yaml 文件，注释掉&nbsp; command: /bin/bash -c &#39;./scripts/script.sh ${CHANNEL_NAME} ${DELAY}; sleep $TIMEOUT&#39; &nbsp; 这句代码，如下图： &nbsp;以下操作主要为网络配置操作，可以保存为sh文件，批量执行： # 配置网络基础数据 ./byfn.sh -m generate #生成创世区块 ../bin/cryptogen generate --config=./crypto-config.yaml export FABRIC_CFG_PATH=$PWD ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block #⽣成应⽤通道的配置信息 export CHANNEL_NAME=mychannel ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME #⽣成锚节点配置更新⽂件 ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org1MSP ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org2MSP #操作⽹络，编辑 docker-compose-cli.yaml ,注释掉 command 命令（注释步骤之前已经完成了） CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d &nbsp;&nbsp; 以下为Docker 操作，主要目标为 创建和加⼊通道 docker exec -it cli bash 在Docker容器中创建通道 export CHANNEL_NAME=mychannel peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem &nbsp; 加⼊通道 peer channel join -b mychannel.block 链上代码 （链码） 安装链码（此处安装的代码并非本地的代码） peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 &nbsp;实例化链码 peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR(&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; &nbsp;查询 peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; 可以看到返回结果如下： Query Result:100 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}&#39; &nbsp;现操作A转账给B 10 块钱，这个命令将会创建新的block同时更新state DB。 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}&#39; 查询 a 账户的金额 peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; 查询结果仅剩90块，如下 Query Result: 90 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/07/03/4e66a352db8547935a8936a84a15c12b.html","headline":"CentOS7环境下搭建Hyperledger超级账本","dateModified":"2018-07-03T00:00:00+08:00","datePublished":"2018-07-03T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/07/03/4e66a352db8547935a8936a84a15c12b.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>CentOS7环境下搭建Hyperledger超级账本</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">一<span style="font-weight:700;">、安装Docker</span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><span>&nbsp; &nbsp; &nbsp; &nbsp;目前开源社区Docker最新版本为 18.03.1，社区分为开源版本（docker-ce）和企业版本（docker-ee）。&nbsp;需要配置Docker官方源才可以安装最新版本，此处我们安装开源社区版本 docker-ce。</span><br></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><span><span>&nbsp; &nbsp; &nbsp; &nbsp;需要安装 Docker 及 Docker-compose，验证这两项安装成功即可。</span><br></span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><span style="font-weight:700;">二、安装Go语言运行环境</span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><span>&nbsp; &nbsp; &nbsp; &nbsp; Go 是一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。Go语言于2009年11月由Google正式宣布推出，成为开放源代码项目，并在Linux及Mac OS X平台上进行了实现，后追加Windows系统下的实现。Go语言具有&nbsp;部署简单、并发性好、良好的语言设计、执行性能好 等特点。</span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><span style="font-weight:700;">三、安装NVM及Node.js</span></p>
  <p style="line-height:28px;font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp; &nbsp; &nbsp; &nbsp; nvm全称Node Version Manager ，是 Nodejs 版本管理器，它让我们能方便的对 Nodejs 的版 本进行切换。 nvm 的官方版本只支持 Linux 和 Mac。 Windows 用户，可以用 nvm-windows。</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fabric暂时不支持7.x，需要安装6.9.x 或&nbsp; 6.x高的版本，通过&nbsp;&nbsp; &nbsp;nvm&nbsp;&nbsp; &nbsp;安装指定 版本的node。</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 现安装Node.js 6.5.9 版本。</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><br></p>
  <p style="color:rgb(61,70,77);background-color:rgb(255,255,255);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"><span>至此 Docker、Docker-compose、Go、Node.js&nbsp; 基础运行环境已经全部安装完成。</span></p>
  <p style="color:rgb(61,70,77);background-color:rgb(255,255,255);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"><span style="font-weight:700;">四、Fabric Samples 下载并安装</span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp; &nbsp; &nbsp; &nbsp; 运行Fabric最基础的运行环境为 Docker、Go、Node.js ，配置完基础运行环境后，在对Fabric网络进行配置，主要配置步骤如下：</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"></p>
  <ul style="margin-left:30px;color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">
   <li>准备网络内各项配置。包括网络成员的组织结构和身份证书（可使用crypyogen工具完成）；生成系统通道的初始化区块文件（创世区块配置文件），新建应用通道的配置更新交易文件以及可能需要的锚节点配置更新文件（使用configtxgen工具完成）</li>
   <li>使用系统通道的初始化配置区块文件启动排序节点，排序节点启动后自动按照指定配置创建系统通道。</li>
   <li>不同的组织按照配置角色分别启动 peer 节点。这个时候系统中不存在应用通道，peer节点并没有加入到网络中。</li>
   <li>使用新建应用通道的配置更新交易文件，向系统通道发送交易，创建新的应用通道。</li>
   <li>让对应的 Peer 节点加入所创建的应用通道中，此时Peer节点加入网络，可以进行交易了。</li>
   <li>用户通过客户端向网络中安装链码，链码容器启动成功后用户即可对链码进行调用，将交易发送到网络中。</li>
  </ul>
  <blockquote style="border:none;"></blockquote>
  <p style="color:rgb(61,70,77);background-color:rgb(255,255,255);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"><span>1、下载Fabric Samples</span></p>
  <p style="color:rgb(61,70,77);background-color:rgb(255,255,255);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">&nbsp; &nbsp; &nbsp; &nbsp; Fabric Samples 的 Git 地址为：https://github.com/hyperledger/fabric-samples<span></span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 目前&nbsp;&nbsp;Fabric Samples&nbsp; 最新版本为 1.1 ，但是1.1 版本在安装过程中会遇到一些问题，暂时无法解决，所以现使用 1.0 版本。</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">在左侧版本选择处选择 1.0 版本，并下载：</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; wget https://github.com/hyperledger/fabric-samples/archive/release-1.0.zip</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 解压后，在CentOS 中的路径为：</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/dev/hyperledger/fabric-samples-release-1.0</p>
  <span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);">2、下载镜像和要执行的二进制文件</span>
  <p style="color:rgb(61,70,77);background-color:rgb(255,255,255);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">&nbsp; &nbsp; &nbsp; &nbsp;(1) 如果可以翻墙，可以打开<span>&nbsp;https://goo.gl/byy2Qj ，将内容保存init.sh文件，放置&nbsp;于fabric-samples-release-1.0根目录中。</span><br><img src="https://img-blog.csdn.net/20180703164638555?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjYwMDM2Nw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&nbsp; &nbsp;&nbsp;</p>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">&nbsp; &nbsp; （2）如果访问不了外网，可以在fabric项目的scripts找到bootstrap.sh文件，并下载到<span style="color:rgb(61,70,77);">fabric-samples-release-1.0根目录中。</span></p>
  <span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);">下载地址：</span>
  <span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);color:rgb(61,70,77);">https://github.com/hyperledger/fabric/blob/release-1.0/scripts/bootstrap.sh</span>
  <br style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);">
  <div style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);">
   注意：根据项目的版本切换到对应版本下的scripts文件下载。
  </div>
  <p style="color:rgb(61,70,77);background-color:rgb(255,255,255);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"><span>&nbsp; &nbsp; （3）<span>为&nbsp;<span>bootstrap</span>.sh 授予可执行权限，并执<span style="color:rgb(47,47,47);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;">行bootstrap.sh下载镜像（要等几分钟）</span>：</span></span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">./bootstrap.sh</code></pre>
  <span style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);">&nbsp; &nbsp; （4）执行完会在根目录生成bin文件夹</span>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-weight:700;">3、配置超级账本网络信息</span></p>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">进入first-network 目录，接下来所有的操作，都在此目录下进行。</span><br></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">cd first-network</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">打开&nbsp;docker-compose-cli.yaml 文件，注释掉&nbsp;</span></p>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"></span></p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">command: /bin/bash -c './scripts/script.sh ${CHANNEL_NAME} ${DELAY}; sleep $TIMEOUT'</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp; 这句代码，如下图：</p>
  <p style="color:rgb(61,70,77);line-height:28px;font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);"><img src="https://img-blog.csdn.net/2018070317092175?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjYwMDM2Nw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></p>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;"><span>&nbsp;以下操作主要为网络配置操作，可以保存为sh文件，批量执行：</span></span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain"># 配置网络基础数据
./byfn.sh -m generate

#生成创世区块
../bin/cryptogen generate --config=./crypto-config.yaml
export FABRIC_CFG_PATH=$PWD
 ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block

#⽣成应⽤通道的配置信息
export CHANNEL_NAME=mychannel
../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME

#⽣成锚节点配置更新⽂件
../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org1MSP

../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID $CHANNEL_NAME -asOrg Org2MSP

#操作⽹络，编辑 docker-compose-cli.yaml ,注释掉 command 命令（注释步骤之前已经完成了）
CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d</code></pre>
  <span style="font-size:14px;color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;background-color:rgb(255,255,255);">&nbsp;&nbsp; 以下为Docker 操作，主要目标为 创建和加⼊通道</span>
  <br style="color:rgb(51,51,51);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(255,255,255);">
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">docker exec -it cli bash</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">在Docker容器中创建通道</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">export CHANNEL_NAME=mychannel

peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">&nbsp; 加⼊通道</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer channel join -b mychannel.block</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">链上代码 （链码） 安装链码（此处安装的代码并非本地的代码）</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">&nbsp;实例化链码</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c '{"Args":["init","a", "100", "b","200"]}' -P "OR('Org1MSP.member','Org2MSP.member')"</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">&nbsp;查询</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}'</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">可以看到返回结果如下：</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">Query Result:100</code></pre>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c '{"Args":["invoke","a","b","10"]}'</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">&nbsp;现操作A转账给B 10 块钱，这个命令将会创建新的block同时更新state DB。</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c '{"Args":["invoke","a","b","10"]}'</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">查询 a 账户的金额</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}'</code></pre>
  <p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(61,70,77);font-family:'Pingfang SC', STHeiti, 'Lantinghei SC', 'Open Sans', Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, sans-serif;">查询结果仅剩90块，如下</span></p>
  <pre style="font-size:14px;line-height:22px;background-color:rgb(255,255,255);"><code class="language-plain">Query Result:	90</code></pre> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u013828353/article/details/80901833,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/u013828353/article/details/80901833,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
