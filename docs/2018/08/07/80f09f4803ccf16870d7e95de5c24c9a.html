<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>EOS开发扩展（一） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="EOS开发扩展（一）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="一、网络层 1.1 EOS网络视图： 1.2 核心网络层 1.3 访问网络层 1.4 消费网络层 二、系统自带合约 2.1 eosio.bios 2.2 eosio.token 2.3 eosio.msig 2.4 eosio.system 三、BIOS 启动顺序 3.1 配置初始的nodeos节点集 3.2 启动 “genesis” 节点 3.3 创建重要的系统账户 3.4 创建eosio.token合约 3.5 创建eosio.msig合约 3.6 创建和分配SYS货币 3.7 创建eosio.system 合约 3.8 从单一生产者过渡到多个生产者 3.9 放置token并扩展网络 3.10 创建赌注账户 3.11 选择生产者 3.12 销毁eosio账户 一、网络层 1.1 EOS网络视图： 1.2 核心网络层 EOSIO网络的核心是块生产者和其所在服务器。完整的EOSIO网络由21个生产节点组成，这些节点已由网络社区投票选出，通过网络连接在一起，生产这之间可以流畅地通信。 这一层网络的关键设计目标是使生产节点专注于生成块并在它们之间进行同步。每个服务器都配备了高处理能力和大的内存，大的磁盘（用于日志存储），通过高容量冗余链路连接，受防火墙保护。如果运行服务器出现问题，备份服务器可以接管。 1.3 访问网络层 在消费层和核心层的生产者之间进行过滤和缓冲，保证核心层的高效运转。 根据功能可分为： API 、 Seed 、 Proxy 节点。 （1）API节点处理来自cleos的请求以执行事务和查询状态，每个生产者节点应至少具有一个关联的API节点。 （2）seed节点：seed节点与其他节点节点通信，以便与生产者节点保持同步。 可能是生产者候选者，它们与生产者保持同步并为其他节点提供服务，并因此建立了他们作为生产者的能力，希望得到社区投票。也可以进行区块链间通信，提供对另一个区块链的访问。 可以隔离生产者和网络上的其他节点之间。 一种重要类型是验证节点，验证类型节点在Access或Consumer 网络中运行，并跟踪区块链。 seed节点通常仅使用EOSIO网络协议传送块（而不是事务），并且未配置为运行http协议（即不能通过cleos访问）。每个生产者节点应至少具有一个关联的seed节点。 （3）Proxy 代理节点：提供负载均衡和DDOS保护。 1.4 消费网络层 任何使用区块链的用户，包括直接通过cleos、间接使用与区块链接口的某些应用程序。 二、系统自带合约 2.1 eosio.bios 基本操作，设置帐户和全局操作限制、权限、生产者以及建立授权级别。 2.2 eosio.token 提供基本货币管理功能。包括创建货币、发行货币、转移货币。 2.3 eosio.msig 进行所需授权级别的多个签名。 2.4 eosio.system 让用户可以使用token，对生产者和工作人员进行配置和投票提案，可以经济且有效地建立和管理区块链。 三、BIOS 启动顺序 3.1 配置初始的nodeos节点集 将启动一些nodeos节点，将它们指向彼此，并最终对一组生产者进行投票。 所有nodeos节点都在同一服务器上运行。 （1） 为每个nodeos创建配置和数据目录 //在nodeos命令行上将这些目录与--config-dir和--data-dir参数一起使用。 $ mkdir ~/eosio_test $ for (( i = 1; i &lt;= 5; i++ )); do for (( j = 1 ; j &lt;=5 ; j++ )); do mkdir ~/eosio_test/accountnum$i$j; done; done （2）准备用于对等通信的IP地址 将生产者指向彼此，以便进行对等通信。确定每个nodeos节点之间的对等通信的IP地址和端口号集，可以通过在启动nodeos时在命令行上设置p2p-peer-address配置属性（每个对等体一个参数），或者通过在config.ini文件中为nodeos设置属性（每个对等体一行）来配置每个nodeos 。 //例如，假设我们为生产者使用端口号9011-9055（即分别为accountnum11-accountnum55），请在nodes命令行上为accountnum12包含以下参数： --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9013 --p2p-peer-address localhost:9014 ... //或者在config.mini里设置 p2p-peer-address = localhost:9011 p2p-peer-address = localhost:9013 p2p-peer-address = localhost:9014 ... 无论是使用命令行还是配置文件方法，都注意不要在生成器列表中包含生产者自己的地址。 3.2 启动 “genesis” 节点 “genesis”节点是开始的第一个节点，它将生成区块链。 所有其他节点将从genesis节点派生。 在genesis节点上执行以下操作。 （1）创建一个钱包wallet $ cleos wallet create （2）配制genesis.json 位置：eos/tutorials/bios-boot-tutorial 作用：genesis.json文件定义了初始链状态。所有节点必须从相同的初始状态开始。有以下两个重要属性： initial_timestamp：区块链的开始时间 initial_key ：将使用该密钥对启动genesis节点，并使用此密钥对创建eosio的所有帐户。与genesis nodeos的公钥相匹配. 密钥对可以通过nodeos命令行 –private-key 指定,或 config.ini 的 private-key属性。 （3）为eosio帐户创建密钥： $ cleos create key （4）启动genesis 节点 $ nodeos -e -p eosio --private-key &#39;[ &quot;${pub-key}&quot;,&quot;${private-key}&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --plugin eosio::history_api_plugin 3.3 创建重要的系统账户 //系统账户 eosio.bpay eosio.msig eosio.names eosio.ram eosio.ramfee eosio.saving eosio.stake eosio.token eosio.vpay 重复以下过程： $ cleos create key # for eosio.bpay $ cleos wallet import ${private-key} $ cleos create account eosio eosio.bpay ${owner-key} ${active-key} 3.4 创建eosio.token合约 此合约可以创建，发布，传输和获取有关token的信息。 $ cleos set contract eosio.token /eos/build/contracts/eosio.token 3.5 创建eosio.msig合约 作用：启用并简化了权限级别的定义和管理、执行多签名操作。 $ cleos set contract eosio.msig eos/build/contracts/eosio.msig 3.6 创建和分配SYS货币 创建最大值为100亿token的SYS货币，然后发行十亿个代币。 可以用特定货币名称替换SYS。 //在 eosio账户中创建10B SYS tokens ，这有效地创造了最大的代币供应，但不会使任何代币进入流通。 没有流通的代币可以被存储。 $ cleos push action eosio.token create &#39;[ &quot;eosio&quot;, &quot;10000000000.0000 SYS&quot; ]&#39; -p eosio.token executed transaction: 0440461e0d8816b4a8fd9d47c1a6a53536d3c7af54abf53eace884f008429697 120 bytes 326 us eosio.token &lt;= eosio.token::create {&quot;issuer&quot;:&quot;eosio&quot;,&quot;maximum_supply&quot;:&quot;10000000000.0000 SYS&quot;} //eosio.token合同将1B SYS token从存储中移除并将其置于流通中。在发行时，token保存在eosio帐户中。 由于eosio帐户拥有未流通的token储备，因此需要其权限才能执行此操作。 $ cleos push action eosio.token issue &#39;[ &quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;, &quot;memo&quot; ]&#39; -p eosio executed transaction: a53961a566c1faa95531efb422cd952611b17d728edac833c9a55582425f98ed 128 bytes 432 us eosio.token &lt;= eosio.token::issue {&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;1000000000.0000 SYS&quot;,&quot;memo&quot;:&quot;memo&quot;} 3.7 创建eosio.system 合约 此合约包含了几乎所有基于toekn的操作。 一旦启用了系统合同，必须支付资源（cpu，网络，内存）、创建新帐户。 系统合同允许标记放样和未标记，要购买的资源，潜在生产者的注册和投票，生产者奖励认领，设置特权和限制等。 $ cleos set contract eosio eos/build/contracts/eosio.system 3.8 从单一生产者过渡到多个生产者 此后，将从单个块生成器（创建节点）转换到多个生成器。到目前为止，只有内置的eosio帐户具有特权并且可以对块进行签名。但目标是通过一系列选定的生产者来管理区块链。 选举产生的生产者名单可以改变，规则不是直接向任何生产者提供特权，而是与名为eosio.prods的特殊内置帐户相关联。该帐户代表当选的生产者组。 eosio.prods帐户（实际上是生产者组）使用eosio.msig合同定义的权限进行操作。 安装eosio.system合同后，尽快将eosio.msig设为特权帐户，以便代表eosio帐户进行授权。 eosio将尽快辞去其权威，由eosio.prods接管。 //使eosio.msig成为特权帐户 $ cleos push action eosio setpriv &#39;[&quot;eosio.msig&quot;, 1]&#39; -p eosio@active 3.9 放置token并扩展网络 至此，完成了单主机单节点的以下合约配置： eosio.token eosio.msig eosio.system 帐户eosio和eosio.msig是特权帐户。 其他eosio帐户已创建但没有特权。接下来绑定账户并扩大生产者网络。 3.10 创建赌注账户 放样是将“真实世界”中的实体（例如，以Crowdsale或其他方式购买某物的个人）获得的令牌分配给EOSIO系统内的账户的过程。 对于初始放样过程可以采用如下方法： 1）0.1令牌：赌注RAM。默认情况下，cleos在创建帐户时会占用8 KB的RAM，由帐户创建者支付。在最初的赌注中，eosio账户是进行赌注的账户创建者。在最初的令牌赌注过程中，赌注的代币在达到最低投票要求之前不能保持不变，且要求为流动。 2）为CPU赌注0.45令牌，为网络赌注0.45令牌。 3）最多9个token可用作流动代币。 4）剩余toekn是赌注50/50 CPU和网络。 Example 1. accountnum11 has 100 SYS. It will be staked as 0.1000 SYS on RAM; 45.4500 SYS on CPU; 45.4500 SYS on network; and 9.0000 SYS held for liquid use. Example 2. accountnum33 has 5 SYS. It will be staked as 0.1000 SYS on RAM; 0.4500 SYS on CPU; 0.4500 SYS on network; and 4.0000 SYS held for liquid use. 使用Pareto分布将1B令牌分发给帐户，模型为80-20规则，即80％的令牌由20％的人口持有。 （1）创建赌注账户 使用以下步骤为每个帐户放置令牌。 必须为每个帐户单独完成这些步骤。 $ cleos create key # for accountnum11 $ cleos wallet import ${private-key} 使用初始资源和公钥创建一个赌注帐户。 cleossystemnewaccounteosio−−transferaccountnum11 c l e o s s y s t e m n e w a c c o u n t e o s i o − − t r a n s f e r a c c o u n t n u m 11 {pubkey} –stake-net “100000.0000 SYS” –stake-cpu “100000.0000 SYS” 3.11 选择生产者 （1）注册为生产者 使用以下命令注册为生产者。 这使得节点成为生产者的候选者，但除非被选举，否则该节点实际上不是生产者。 $ cleos system regproducer accountnum11 ${pubkey} https://accountnum11.com/${pubkey} （2）列出生产者 $ cleos system listproducers Producer Producer key Url （3）启动生产者 使用以下命令启动生成。 由于所有生产者都在单个服务器上运行，因此命令行参数用于确保每个生产者使用自己的目录。 在每个生产者的窗口中，运行以下nodeos命令。 $ nodeos --genesis-json ~/eosio_test/accountnum11/genesis.json --block-log-dir ~/eosio_test/accountnum11/blocks --config-dir ~/eosio_test/accountnum11/ --data-dir ~/eosio_test/accountnum11/ --http-server-address 127.0.0.1:8011 --p2p-listen-endpoint 127.0.0.1:9011 --enable-stale-production --producer-name accountnum11 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --plugin eosio::history_api_plugin --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9033 --p2p-peer-address localhost:9044 为方便起见，可以复制以下命令行以在帐户accountnum22，accountnum33和accountnum44的单独shell窗口中运行nodeos。 $ nodeos --genesis-json ~/eosio_test/accountnum22/genesis.json --block-log-dir ~/eosio_test/accountnum22/blocks --config-dir ~/eosio_test/accountnum22/ --data-dir ~/eosio_test/accountnum22/ --http-server-address 127.0.0.1:8022 --p2p-listen-endpoint 127.0.0.1:9022 --enable-stale-production --producer-name accountnum22 --private-key &#39;[ &quot;&quot;pubkey&quot;,&quot;privatekey&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9033 --p2p-peer-address localhost:9044 $ nodeos --genesis-json ~/eosio_test/accountnum33/genesis.json --block-log-dir ~/eosio_test/accountnum33/blocks --config-dir ~/eosio_test/accountnum33/ --data-dir ~/eosio_test/accountnum33/ --http-server-address 127.0.0.1:8033 --p2p-listen-endpoint 127.0.0.1:9033 --enable-stale-production --producer-name accountnum33 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot;]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9044 $ nodeos --genesis-json ~/eosio_test/accountnum44/genesis.json --block-log-dir ~/eosio_test/accountnum44/blocks --config-dir ~/eosio_test/accountnum44/ --data-dir ~/eosio_test/accountnum44/ --http-server-address 127.0.0.1:8044 --p2p-listen-endpoint 127.0.0.1:9044 --enable-stale-production --producer-name accountnum44 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot;]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9033 （3）genesis.json 每个节点的输出都在该节点工作目录中的文件stderr中捕获，例如./nodes/accountnum44/stderr。 3.12 销毁eosio账户 一旦选择生产者满足了最低数量要求，即被选出，eosio帐户就可以销毁，将eosio.msig帐户留作唯一的特权帐户。 销毁主要涉及将eosio的所有帐户的密钥设置为null。 使用以下命令清除eosio帐户的所有者和活动密钥： $ cleos push action eosio updateauth &#39;{&quot;account&quot;: &quot;eosio&quot;, &quot;permission&quot;: &quot;owner&quot;, &quot;parent&quot;: &quot;&quot;, &quot;auth&quot;: {&quot;threshold&quot;: 1, &quot;keys&quot;: [], &quot;waits&quot;: [], &quot;accounts&quot;: [{&quot;weight&quot;: 1, &quot;permission&quot;: {&quot;actor&quot;: &quot;eosio.prods&quot;, &quot;permission&quot;: &quot;active&quot;}}]}}&#39; -p eosio@owner $ cleos push action eosio updateauth &#39;{&quot;account&quot;: &quot;eosio&quot;, &quot;permission&quot;: &quot;active&quot;, &quot;parent&quot;: &quot;owner&quot;, &quot;auth&quot;: {&quot;threshold&quot;: 1, &quot;keys&quot;: [], &quot;waits&quot;: [], &quot;accounts&quot;: [{&quot;weight&quot;: 1, &quot;permission&quot;: {&quot;actor&quot;: &quot;eosio.prods&quot;, &quot;permission&quot;: &quot;active&quot;}}]}}&#39; -p eosio@active 阅读更多" />
<meta property="og:description" content="一、网络层 1.1 EOS网络视图： 1.2 核心网络层 1.3 访问网络层 1.4 消费网络层 二、系统自带合约 2.1 eosio.bios 2.2 eosio.token 2.3 eosio.msig 2.4 eosio.system 三、BIOS 启动顺序 3.1 配置初始的nodeos节点集 3.2 启动 “genesis” 节点 3.3 创建重要的系统账户 3.4 创建eosio.token合约 3.5 创建eosio.msig合约 3.6 创建和分配SYS货币 3.7 创建eosio.system 合约 3.8 从单一生产者过渡到多个生产者 3.9 放置token并扩展网络 3.10 创建赌注账户 3.11 选择生产者 3.12 销毁eosio账户 一、网络层 1.1 EOS网络视图： 1.2 核心网络层 EOSIO网络的核心是块生产者和其所在服务器。完整的EOSIO网络由21个生产节点组成，这些节点已由网络社区投票选出，通过网络连接在一起，生产这之间可以流畅地通信。 这一层网络的关键设计目标是使生产节点专注于生成块并在它们之间进行同步。每个服务器都配备了高处理能力和大的内存，大的磁盘（用于日志存储），通过高容量冗余链路连接，受防火墙保护。如果运行服务器出现问题，备份服务器可以接管。 1.3 访问网络层 在消费层和核心层的生产者之间进行过滤和缓冲，保证核心层的高效运转。 根据功能可分为： API 、 Seed 、 Proxy 节点。 （1）API节点处理来自cleos的请求以执行事务和查询状态，每个生产者节点应至少具有一个关联的API节点。 （2）seed节点：seed节点与其他节点节点通信，以便与生产者节点保持同步。 可能是生产者候选者，它们与生产者保持同步并为其他节点提供服务，并因此建立了他们作为生产者的能力，希望得到社区投票。也可以进行区块链间通信，提供对另一个区块链的访问。 可以隔离生产者和网络上的其他节点之间。 一种重要类型是验证节点，验证类型节点在Access或Consumer 网络中运行，并跟踪区块链。 seed节点通常仅使用EOSIO网络协议传送块（而不是事务），并且未配置为运行http协议（即不能通过cleos访问）。每个生产者节点应至少具有一个关联的seed节点。 （3）Proxy 代理节点：提供负载均衡和DDOS保护。 1.4 消费网络层 任何使用区块链的用户，包括直接通过cleos、间接使用与区块链接口的某些应用程序。 二、系统自带合约 2.1 eosio.bios 基本操作，设置帐户和全局操作限制、权限、生产者以及建立授权级别。 2.2 eosio.token 提供基本货币管理功能。包括创建货币、发行货币、转移货币。 2.3 eosio.msig 进行所需授权级别的多个签名。 2.4 eosio.system 让用户可以使用token，对生产者和工作人员进行配置和投票提案，可以经济且有效地建立和管理区块链。 三、BIOS 启动顺序 3.1 配置初始的nodeos节点集 将启动一些nodeos节点，将它们指向彼此，并最终对一组生产者进行投票。 所有nodeos节点都在同一服务器上运行。 （1） 为每个nodeos创建配置和数据目录 //在nodeos命令行上将这些目录与--config-dir和--data-dir参数一起使用。 $ mkdir ~/eosio_test $ for (( i = 1; i &lt;= 5; i++ )); do for (( j = 1 ; j &lt;=5 ; j++ )); do mkdir ~/eosio_test/accountnum$i$j; done; done （2）准备用于对等通信的IP地址 将生产者指向彼此，以便进行对等通信。确定每个nodeos节点之间的对等通信的IP地址和端口号集，可以通过在启动nodeos时在命令行上设置p2p-peer-address配置属性（每个对等体一个参数），或者通过在config.ini文件中为nodeos设置属性（每个对等体一行）来配置每个nodeos 。 //例如，假设我们为生产者使用端口号9011-9055（即分别为accountnum11-accountnum55），请在nodes命令行上为accountnum12包含以下参数： --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9013 --p2p-peer-address localhost:9014 ... //或者在config.mini里设置 p2p-peer-address = localhost:9011 p2p-peer-address = localhost:9013 p2p-peer-address = localhost:9014 ... 无论是使用命令行还是配置文件方法，都注意不要在生成器列表中包含生产者自己的地址。 3.2 启动 “genesis” 节点 “genesis”节点是开始的第一个节点，它将生成区块链。 所有其他节点将从genesis节点派生。 在genesis节点上执行以下操作。 （1）创建一个钱包wallet $ cleos wallet create （2）配制genesis.json 位置：eos/tutorials/bios-boot-tutorial 作用：genesis.json文件定义了初始链状态。所有节点必须从相同的初始状态开始。有以下两个重要属性： initial_timestamp：区块链的开始时间 initial_key ：将使用该密钥对启动genesis节点，并使用此密钥对创建eosio的所有帐户。与genesis nodeos的公钥相匹配. 密钥对可以通过nodeos命令行 –private-key 指定,或 config.ini 的 private-key属性。 （3）为eosio帐户创建密钥： $ cleos create key （4）启动genesis 节点 $ nodeos -e -p eosio --private-key &#39;[ &quot;${pub-key}&quot;,&quot;${private-key}&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --plugin eosio::history_api_plugin 3.3 创建重要的系统账户 //系统账户 eosio.bpay eosio.msig eosio.names eosio.ram eosio.ramfee eosio.saving eosio.stake eosio.token eosio.vpay 重复以下过程： $ cleos create key # for eosio.bpay $ cleos wallet import ${private-key} $ cleos create account eosio eosio.bpay ${owner-key} ${active-key} 3.4 创建eosio.token合约 此合约可以创建，发布，传输和获取有关token的信息。 $ cleos set contract eosio.token /eos/build/contracts/eosio.token 3.5 创建eosio.msig合约 作用：启用并简化了权限级别的定义和管理、执行多签名操作。 $ cleos set contract eosio.msig eos/build/contracts/eosio.msig 3.6 创建和分配SYS货币 创建最大值为100亿token的SYS货币，然后发行十亿个代币。 可以用特定货币名称替换SYS。 //在 eosio账户中创建10B SYS tokens ，这有效地创造了最大的代币供应，但不会使任何代币进入流通。 没有流通的代币可以被存储。 $ cleos push action eosio.token create &#39;[ &quot;eosio&quot;, &quot;10000000000.0000 SYS&quot; ]&#39; -p eosio.token executed transaction: 0440461e0d8816b4a8fd9d47c1a6a53536d3c7af54abf53eace884f008429697 120 bytes 326 us eosio.token &lt;= eosio.token::create {&quot;issuer&quot;:&quot;eosio&quot;,&quot;maximum_supply&quot;:&quot;10000000000.0000 SYS&quot;} //eosio.token合同将1B SYS token从存储中移除并将其置于流通中。在发行时，token保存在eosio帐户中。 由于eosio帐户拥有未流通的token储备，因此需要其权限才能执行此操作。 $ cleos push action eosio.token issue &#39;[ &quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;, &quot;memo&quot; ]&#39; -p eosio executed transaction: a53961a566c1faa95531efb422cd952611b17d728edac833c9a55582425f98ed 128 bytes 432 us eosio.token &lt;= eosio.token::issue {&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;1000000000.0000 SYS&quot;,&quot;memo&quot;:&quot;memo&quot;} 3.7 创建eosio.system 合约 此合约包含了几乎所有基于toekn的操作。 一旦启用了系统合同，必须支付资源（cpu，网络，内存）、创建新帐户。 系统合同允许标记放样和未标记，要购买的资源，潜在生产者的注册和投票，生产者奖励认领，设置特权和限制等。 $ cleos set contract eosio eos/build/contracts/eosio.system 3.8 从单一生产者过渡到多个生产者 此后，将从单个块生成器（创建节点）转换到多个生成器。到目前为止，只有内置的eosio帐户具有特权并且可以对块进行签名。但目标是通过一系列选定的生产者来管理区块链。 选举产生的生产者名单可以改变，规则不是直接向任何生产者提供特权，而是与名为eosio.prods的特殊内置帐户相关联。该帐户代表当选的生产者组。 eosio.prods帐户（实际上是生产者组）使用eosio.msig合同定义的权限进行操作。 安装eosio.system合同后，尽快将eosio.msig设为特权帐户，以便代表eosio帐户进行授权。 eosio将尽快辞去其权威，由eosio.prods接管。 //使eosio.msig成为特权帐户 $ cleos push action eosio setpriv &#39;[&quot;eosio.msig&quot;, 1]&#39; -p eosio@active 3.9 放置token并扩展网络 至此，完成了单主机单节点的以下合约配置： eosio.token eosio.msig eosio.system 帐户eosio和eosio.msig是特权帐户。 其他eosio帐户已创建但没有特权。接下来绑定账户并扩大生产者网络。 3.10 创建赌注账户 放样是将“真实世界”中的实体（例如，以Crowdsale或其他方式购买某物的个人）获得的令牌分配给EOSIO系统内的账户的过程。 对于初始放样过程可以采用如下方法： 1）0.1令牌：赌注RAM。默认情况下，cleos在创建帐户时会占用8 KB的RAM，由帐户创建者支付。在最初的赌注中，eosio账户是进行赌注的账户创建者。在最初的令牌赌注过程中，赌注的代币在达到最低投票要求之前不能保持不变，且要求为流动。 2）为CPU赌注0.45令牌，为网络赌注0.45令牌。 3）最多9个token可用作流动代币。 4）剩余toekn是赌注50/50 CPU和网络。 Example 1. accountnum11 has 100 SYS. It will be staked as 0.1000 SYS on RAM; 45.4500 SYS on CPU; 45.4500 SYS on network; and 9.0000 SYS held for liquid use. Example 2. accountnum33 has 5 SYS. It will be staked as 0.1000 SYS on RAM; 0.4500 SYS on CPU; 0.4500 SYS on network; and 4.0000 SYS held for liquid use. 使用Pareto分布将1B令牌分发给帐户，模型为80-20规则，即80％的令牌由20％的人口持有。 （1）创建赌注账户 使用以下步骤为每个帐户放置令牌。 必须为每个帐户单独完成这些步骤。 $ cleos create key # for accountnum11 $ cleos wallet import ${private-key} 使用初始资源和公钥创建一个赌注帐户。 cleossystemnewaccounteosio−−transferaccountnum11 c l e o s s y s t e m n e w a c c o u n t e o s i o − − t r a n s f e r a c c o u n t n u m 11 {pubkey} –stake-net “100000.0000 SYS” –stake-cpu “100000.0000 SYS” 3.11 选择生产者 （1）注册为生产者 使用以下命令注册为生产者。 这使得节点成为生产者的候选者，但除非被选举，否则该节点实际上不是生产者。 $ cleos system regproducer accountnum11 ${pubkey} https://accountnum11.com/${pubkey} （2）列出生产者 $ cleos system listproducers Producer Producer key Url （3）启动生产者 使用以下命令启动生成。 由于所有生产者都在单个服务器上运行，因此命令行参数用于确保每个生产者使用自己的目录。 在每个生产者的窗口中，运行以下nodeos命令。 $ nodeos --genesis-json ~/eosio_test/accountnum11/genesis.json --block-log-dir ~/eosio_test/accountnum11/blocks --config-dir ~/eosio_test/accountnum11/ --data-dir ~/eosio_test/accountnum11/ --http-server-address 127.0.0.1:8011 --p2p-listen-endpoint 127.0.0.1:9011 --enable-stale-production --producer-name accountnum11 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --plugin eosio::history_api_plugin --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9033 --p2p-peer-address localhost:9044 为方便起见，可以复制以下命令行以在帐户accountnum22，accountnum33和accountnum44的单独shell窗口中运行nodeos。 $ nodeos --genesis-json ~/eosio_test/accountnum22/genesis.json --block-log-dir ~/eosio_test/accountnum22/blocks --config-dir ~/eosio_test/accountnum22/ --data-dir ~/eosio_test/accountnum22/ --http-server-address 127.0.0.1:8022 --p2p-listen-endpoint 127.0.0.1:9022 --enable-stale-production --producer-name accountnum22 --private-key &#39;[ &quot;&quot;pubkey&quot;,&quot;privatekey&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9033 --p2p-peer-address localhost:9044 $ nodeos --genesis-json ~/eosio_test/accountnum33/genesis.json --block-log-dir ~/eosio_test/accountnum33/blocks --config-dir ~/eosio_test/accountnum33/ --data-dir ~/eosio_test/accountnum33/ --http-server-address 127.0.0.1:8033 --p2p-listen-endpoint 127.0.0.1:9033 --enable-stale-production --producer-name accountnum33 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot;]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9044 $ nodeos --genesis-json ~/eosio_test/accountnum44/genesis.json --block-log-dir ~/eosio_test/accountnum44/blocks --config-dir ~/eosio_test/accountnum44/ --data-dir ~/eosio_test/accountnum44/ --http-server-address 127.0.0.1:8044 --p2p-listen-endpoint 127.0.0.1:9044 --enable-stale-production --producer-name accountnum44 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot;]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9033 （3）genesis.json 每个节点的输出都在该节点工作目录中的文件stderr中捕获，例如./nodes/accountnum44/stderr。 3.12 销毁eosio账户 一旦选择生产者满足了最低数量要求，即被选出，eosio帐户就可以销毁，将eosio.msig帐户留作唯一的特权帐户。 销毁主要涉及将eosio的所有帐户的密钥设置为null。 使用以下命令清除eosio帐户的所有者和活动密钥： $ cleos push action eosio updateauth &#39;{&quot;account&quot;: &quot;eosio&quot;, &quot;permission&quot;: &quot;owner&quot;, &quot;parent&quot;: &quot;&quot;, &quot;auth&quot;: {&quot;threshold&quot;: 1, &quot;keys&quot;: [], &quot;waits&quot;: [], &quot;accounts&quot;: [{&quot;weight&quot;: 1, &quot;permission&quot;: {&quot;actor&quot;: &quot;eosio.prods&quot;, &quot;permission&quot;: &quot;active&quot;}}]}}&#39; -p eosio@owner $ cleos push action eosio updateauth &#39;{&quot;account&quot;: &quot;eosio&quot;, &quot;permission&quot;: &quot;active&quot;, &quot;parent&quot;: &quot;owner&quot;, &quot;auth&quot;: {&quot;threshold&quot;: 1, &quot;keys&quot;: [], &quot;waits&quot;: [], &quot;accounts&quot;: [{&quot;weight&quot;: 1, &quot;permission&quot;: {&quot;actor&quot;: &quot;eosio.prods&quot;, &quot;permission&quot;: &quot;active&quot;}}]}}&#39; -p eosio@active 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/08/07/80f09f4803ccf16870d7e95de5c24c9a.html" />
<meta property="og:url" content="https://mlh.app/2018/08/07/80f09f4803ccf16870d7e95de5c24c9a.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-07T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"一、网络层 1.1 EOS网络视图： 1.2 核心网络层 1.3 访问网络层 1.4 消费网络层 二、系统自带合约 2.1 eosio.bios 2.2 eosio.token 2.3 eosio.msig 2.4 eosio.system 三、BIOS 启动顺序 3.1 配置初始的nodeos节点集 3.2 启动 “genesis” 节点 3.3 创建重要的系统账户 3.4 创建eosio.token合约 3.5 创建eosio.msig合约 3.6 创建和分配SYS货币 3.7 创建eosio.system 合约 3.8 从单一生产者过渡到多个生产者 3.9 放置token并扩展网络 3.10 创建赌注账户 3.11 选择生产者 3.12 销毁eosio账户 一、网络层 1.1 EOS网络视图： 1.2 核心网络层 EOSIO网络的核心是块生产者和其所在服务器。完整的EOSIO网络由21个生产节点组成，这些节点已由网络社区投票选出，通过网络连接在一起，生产这之间可以流畅地通信。 这一层网络的关键设计目标是使生产节点专注于生成块并在它们之间进行同步。每个服务器都配备了高处理能力和大的内存，大的磁盘（用于日志存储），通过高容量冗余链路连接，受防火墙保护。如果运行服务器出现问题，备份服务器可以接管。 1.3 访问网络层 在消费层和核心层的生产者之间进行过滤和缓冲，保证核心层的高效运转。 根据功能可分为： API 、 Seed 、 Proxy 节点。 （1）API节点处理来自cleos的请求以执行事务和查询状态，每个生产者节点应至少具有一个关联的API节点。 （2）seed节点：seed节点与其他节点节点通信，以便与生产者节点保持同步。 可能是生产者候选者，它们与生产者保持同步并为其他节点提供服务，并因此建立了他们作为生产者的能力，希望得到社区投票。也可以进行区块链间通信，提供对另一个区块链的访问。 可以隔离生产者和网络上的其他节点之间。 一种重要类型是验证节点，验证类型节点在Access或Consumer 网络中运行，并跟踪区块链。 seed节点通常仅使用EOSIO网络协议传送块（而不是事务），并且未配置为运行http协议（即不能通过cleos访问）。每个生产者节点应至少具有一个关联的seed节点。 （3）Proxy 代理节点：提供负载均衡和DDOS保护。 1.4 消费网络层 任何使用区块链的用户，包括直接通过cleos、间接使用与区块链接口的某些应用程序。 二、系统自带合约 2.1 eosio.bios 基本操作，设置帐户和全局操作限制、权限、生产者以及建立授权级别。 2.2 eosio.token 提供基本货币管理功能。包括创建货币、发行货币、转移货币。 2.3 eosio.msig 进行所需授权级别的多个签名。 2.4 eosio.system 让用户可以使用token，对生产者和工作人员进行配置和投票提案，可以经济且有效地建立和管理区块链。 三、BIOS 启动顺序 3.1 配置初始的nodeos节点集 将启动一些nodeos节点，将它们指向彼此，并最终对一组生产者进行投票。 所有nodeos节点都在同一服务器上运行。 （1） 为每个nodeos创建配置和数据目录 //在nodeos命令行上将这些目录与--config-dir和--data-dir参数一起使用。 $ mkdir ~/eosio_test $ for (( i = 1; i &lt;= 5; i++ )); do for (( j = 1 ; j &lt;=5 ; j++ )); do mkdir ~/eosio_test/accountnum$i$j; done; done （2）准备用于对等通信的IP地址 将生产者指向彼此，以便进行对等通信。确定每个nodeos节点之间的对等通信的IP地址和端口号集，可以通过在启动nodeos时在命令行上设置p2p-peer-address配置属性（每个对等体一个参数），或者通过在config.ini文件中为nodeos设置属性（每个对等体一行）来配置每个nodeos 。 //例如，假设我们为生产者使用端口号9011-9055（即分别为accountnum11-accountnum55），请在nodes命令行上为accountnum12包含以下参数： --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9013 --p2p-peer-address localhost:9014 ... //或者在config.mini里设置 p2p-peer-address = localhost:9011 p2p-peer-address = localhost:9013 p2p-peer-address = localhost:9014 ... 无论是使用命令行还是配置文件方法，都注意不要在生成器列表中包含生产者自己的地址。 3.2 启动 “genesis” 节点 “genesis”节点是开始的第一个节点，它将生成区块链。 所有其他节点将从genesis节点派生。 在genesis节点上执行以下操作。 （1）创建一个钱包wallet $ cleos wallet create （2）配制genesis.json 位置：eos/tutorials/bios-boot-tutorial 作用：genesis.json文件定义了初始链状态。所有节点必须从相同的初始状态开始。有以下两个重要属性： initial_timestamp：区块链的开始时间 initial_key ：将使用该密钥对启动genesis节点，并使用此密钥对创建eosio的所有帐户。与genesis nodeos的公钥相匹配. 密钥对可以通过nodeos命令行 –private-key 指定,或 config.ini 的 private-key属性。 （3）为eosio帐户创建密钥： $ cleos create key （4）启动genesis 节点 $ nodeos -e -p eosio --private-key &#39;[ &quot;${pub-key}&quot;,&quot;${private-key}&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --plugin eosio::history_api_plugin 3.3 创建重要的系统账户 //系统账户 eosio.bpay eosio.msig eosio.names eosio.ram eosio.ramfee eosio.saving eosio.stake eosio.token eosio.vpay 重复以下过程： $ cleos create key # for eosio.bpay $ cleos wallet import ${private-key} $ cleos create account eosio eosio.bpay ${owner-key} ${active-key} 3.4 创建eosio.token合约 此合约可以创建，发布，传输和获取有关token的信息。 $ cleos set contract eosio.token /eos/build/contracts/eosio.token 3.5 创建eosio.msig合约 作用：启用并简化了权限级别的定义和管理、执行多签名操作。 $ cleos set contract eosio.msig eos/build/contracts/eosio.msig 3.6 创建和分配SYS货币 创建最大值为100亿token的SYS货币，然后发行十亿个代币。 可以用特定货币名称替换SYS。 //在 eosio账户中创建10B SYS tokens ，这有效地创造了最大的代币供应，但不会使任何代币进入流通。 没有流通的代币可以被存储。 $ cleos push action eosio.token create &#39;[ &quot;eosio&quot;, &quot;10000000000.0000 SYS&quot; ]&#39; -p eosio.token executed transaction: 0440461e0d8816b4a8fd9d47c1a6a53536d3c7af54abf53eace884f008429697 120 bytes 326 us eosio.token &lt;= eosio.token::create {&quot;issuer&quot;:&quot;eosio&quot;,&quot;maximum_supply&quot;:&quot;10000000000.0000 SYS&quot;} //eosio.token合同将1B SYS token从存储中移除并将其置于流通中。在发行时，token保存在eosio帐户中。 由于eosio帐户拥有未流通的token储备，因此需要其权限才能执行此操作。 $ cleos push action eosio.token issue &#39;[ &quot;eosio&quot;, &quot;1000000000.0000 SYS&quot;, &quot;memo&quot; ]&#39; -p eosio executed transaction: a53961a566c1faa95531efb422cd952611b17d728edac833c9a55582425f98ed 128 bytes 432 us eosio.token &lt;= eosio.token::issue {&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;1000000000.0000 SYS&quot;,&quot;memo&quot;:&quot;memo&quot;} 3.7 创建eosio.system 合约 此合约包含了几乎所有基于toekn的操作。 一旦启用了系统合同，必须支付资源（cpu，网络，内存）、创建新帐户。 系统合同允许标记放样和未标记，要购买的资源，潜在生产者的注册和投票，生产者奖励认领，设置特权和限制等。 $ cleos set contract eosio eos/build/contracts/eosio.system 3.8 从单一生产者过渡到多个生产者 此后，将从单个块生成器（创建节点）转换到多个生成器。到目前为止，只有内置的eosio帐户具有特权并且可以对块进行签名。但目标是通过一系列选定的生产者来管理区块链。 选举产生的生产者名单可以改变，规则不是直接向任何生产者提供特权，而是与名为eosio.prods的特殊内置帐户相关联。该帐户代表当选的生产者组。 eosio.prods帐户（实际上是生产者组）使用eosio.msig合同定义的权限进行操作。 安装eosio.system合同后，尽快将eosio.msig设为特权帐户，以便代表eosio帐户进行授权。 eosio将尽快辞去其权威，由eosio.prods接管。 //使eosio.msig成为特权帐户 $ cleos push action eosio setpriv &#39;[&quot;eosio.msig&quot;, 1]&#39; -p eosio@active 3.9 放置token并扩展网络 至此，完成了单主机单节点的以下合约配置： eosio.token eosio.msig eosio.system 帐户eosio和eosio.msig是特权帐户。 其他eosio帐户已创建但没有特权。接下来绑定账户并扩大生产者网络。 3.10 创建赌注账户 放样是将“真实世界”中的实体（例如，以Crowdsale或其他方式购买某物的个人）获得的令牌分配给EOSIO系统内的账户的过程。 对于初始放样过程可以采用如下方法： 1）0.1令牌：赌注RAM。默认情况下，cleos在创建帐户时会占用8 KB的RAM，由帐户创建者支付。在最初的赌注中，eosio账户是进行赌注的账户创建者。在最初的令牌赌注过程中，赌注的代币在达到最低投票要求之前不能保持不变，且要求为流动。 2）为CPU赌注0.45令牌，为网络赌注0.45令牌。 3）最多9个token可用作流动代币。 4）剩余toekn是赌注50/50 CPU和网络。 Example 1. accountnum11 has 100 SYS. It will be staked as 0.1000 SYS on RAM; 45.4500 SYS on CPU; 45.4500 SYS on network; and 9.0000 SYS held for liquid use. Example 2. accountnum33 has 5 SYS. It will be staked as 0.1000 SYS on RAM; 0.4500 SYS on CPU; 0.4500 SYS on network; and 4.0000 SYS held for liquid use. 使用Pareto分布将1B令牌分发给帐户，模型为80-20规则，即80％的令牌由20％的人口持有。 （1）创建赌注账户 使用以下步骤为每个帐户放置令牌。 必须为每个帐户单独完成这些步骤。 $ cleos create key # for accountnum11 $ cleos wallet import ${private-key} 使用初始资源和公钥创建一个赌注帐户。 cleossystemnewaccounteosio−−transferaccountnum11 c l e o s s y s t e m n e w a c c o u n t e o s i o − − t r a n s f e r a c c o u n t n u m 11 {pubkey} –stake-net “100000.0000 SYS” –stake-cpu “100000.0000 SYS” 3.11 选择生产者 （1）注册为生产者 使用以下命令注册为生产者。 这使得节点成为生产者的候选者，但除非被选举，否则该节点实际上不是生产者。 $ cleos system regproducer accountnum11 ${pubkey} https://accountnum11.com/${pubkey} （2）列出生产者 $ cleos system listproducers Producer Producer key Url （3）启动生产者 使用以下命令启动生成。 由于所有生产者都在单个服务器上运行，因此命令行参数用于确保每个生产者使用自己的目录。 在每个生产者的窗口中，运行以下nodeos命令。 $ nodeos --genesis-json ~/eosio_test/accountnum11/genesis.json --block-log-dir ~/eosio_test/accountnum11/blocks --config-dir ~/eosio_test/accountnum11/ --data-dir ~/eosio_test/accountnum11/ --http-server-address 127.0.0.1:8011 --p2p-listen-endpoint 127.0.0.1:9011 --enable-stale-production --producer-name accountnum11 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --plugin eosio::history_api_plugin --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9033 --p2p-peer-address localhost:9044 为方便起见，可以复制以下命令行以在帐户accountnum22，accountnum33和accountnum44的单独shell窗口中运行nodeos。 $ nodeos --genesis-json ~/eosio_test/accountnum22/genesis.json --block-log-dir ~/eosio_test/accountnum22/blocks --config-dir ~/eosio_test/accountnum22/ --data-dir ~/eosio_test/accountnum22/ --http-server-address 127.0.0.1:8022 --p2p-listen-endpoint 127.0.0.1:9022 --enable-stale-production --producer-name accountnum22 --private-key &#39;[ &quot;&quot;pubkey&quot;,&quot;privatekey&quot; ]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9033 --p2p-peer-address localhost:9044 $ nodeos --genesis-json ~/eosio_test/accountnum33/genesis.json --block-log-dir ~/eosio_test/accountnum33/blocks --config-dir ~/eosio_test/accountnum33/ --data-dir ~/eosio_test/accountnum33/ --http-server-address 127.0.0.1:8033 --p2p-listen-endpoint 127.0.0.1:9033 --enable-stale-production --producer-name accountnum33 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot;]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9044 $ nodeos --genesis-json ~/eosio_test/accountnum44/genesis.json --block-log-dir ~/eosio_test/accountnum44/blocks --config-dir ~/eosio_test/accountnum44/ --data-dir ~/eosio_test/accountnum44/ --http-server-address 127.0.0.1:8044 --p2p-listen-endpoint 127.0.0.1:9044 --enable-stale-production --producer-name accountnum44 --private-key &#39;[ &quot;pubkey&quot;,&quot;privatekey&quot;]&#39; --plugin eosio::producer_plugin --plugin eosio::chain_api_plugin --plugin eosio::http_plugin --p2p-peer-address localhost:9011 --p2p-peer-address localhost:9022 --p2p-peer-address localhost:9033 （3）genesis.json 每个节点的输出都在该节点工作目录中的文件stderr中捕获，例如./nodes/accountnum44/stderr。 3.12 销毁eosio账户 一旦选择生产者满足了最低数量要求，即被选出，eosio帐户就可以销毁，将eosio.msig帐户留作唯一的特权帐户。 销毁主要涉及将eosio的所有帐户的密钥设置为null。 使用以下命令清除eosio帐户的所有者和活动密钥： $ cleos push action eosio updateauth &#39;{&quot;account&quot;: &quot;eosio&quot;, &quot;permission&quot;: &quot;owner&quot;, &quot;parent&quot;: &quot;&quot;, &quot;auth&quot;: {&quot;threshold&quot;: 1, &quot;keys&quot;: [], &quot;waits&quot;: [], &quot;accounts&quot;: [{&quot;weight&quot;: 1, &quot;permission&quot;: {&quot;actor&quot;: &quot;eosio.prods&quot;, &quot;permission&quot;: &quot;active&quot;}}]}}&#39; -p eosio@owner $ cleos push action eosio updateauth &#39;{&quot;account&quot;: &quot;eosio&quot;, &quot;permission&quot;: &quot;active&quot;, &quot;parent&quot;: &quot;owner&quot;, &quot;auth&quot;: {&quot;threshold&quot;: 1, &quot;keys&quot;: [], &quot;waits&quot;: [], &quot;accounts&quot;: [{&quot;weight&quot;: 1, &quot;permission&quot;: {&quot;actor&quot;: &quot;eosio.prods&quot;, &quot;permission&quot;: &quot;active&quot;}}]}}&#39; -p eosio@active 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/08/07/80f09f4803ccf16870d7e95de5c24c9a.html","headline":"EOS开发扩展（一）","dateModified":"2018-08-07T00:00:00+08:00","datePublished":"2018-08-07T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/08/07/80f09f4803ccf16870d7e95de5c24c9a.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>EOS开发扩展（一）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <p></p>
  <div class="toc"> 
   <ul> 
    <li><a href="#一网络层" rel="nofollow">一、网络层</a>
     <ul> 
      <li><a href="#11-eos网络视图" rel="nofollow">1.1 EOS网络视图：</a></li> 
      <li><a href="#12-核心网络层" rel="nofollow">1.2 核心网络层</a></li> 
      <li><a href="#13-访问网络层" rel="nofollow">1.3 访问网络层</a></li> 
      <li><a href="#14-消费网络层" rel="nofollow">1.4 消费网络层</a></li> 
     </ul> </li> 
    <li><a href="#二系统自带合约" rel="nofollow">二、系统自带合约</a>
     <ul> 
      <li><a href="#21-eosiobios" rel="nofollow">2.1 eosio.bios</a></li> 
      <li><a href="#22-eosiotoken" rel="nofollow">2.2 eosio.token</a></li> 
      <li><a href="#23-eosiomsig" rel="nofollow">2.3 eosio.msig</a></li> 
      <li><a href="#24-eosiosystem" rel="nofollow">2.4 eosio.system</a></li> 
     </ul> </li> 
    <li><a href="#三bios-启动顺序" rel="nofollow">三、BIOS 启动顺序</a>
     <ul> 
      <li><a href="#31-配置初始的nodeos节点集" rel="nofollow">3.1 配置初始的nodeos节点集</a></li> 
      <li><a href="#32-启动-genesis-节点" rel="nofollow">3.2 启动 “genesis” 节点</a></li> 
      <li><a href="#33-创建重要的系统账户" rel="nofollow">3.3 创建重要的系统账户</a></li> 
      <li><a href="#34-创建eosiotoken合约" rel="nofollow">3.4 创建eosio.token合约</a></li> 
      <li><a href="#35-创建eosiomsig合约" rel="nofollow">3.5 创建eosio.msig合约</a></li> 
      <li><a href="#36-创建和分配sys货币" rel="nofollow">3.6 创建和分配SYS货币</a></li> 
      <li><a href="#37-创建eosiosystem-合约" rel="nofollow">3.7 创建eosio.system 合约</a></li> 
      <li><a href="#38-从单一生产者过渡到多个生产者" rel="nofollow">3.8 从单一生产者过渡到多个生产者</a></li> 
      <li><a href="#39-放置token并扩展网络" rel="nofollow">3.9 放置token并扩展网络</a></li> 
      <li><a href="#310-创建赌注账户" rel="nofollow">3.10 创建赌注账户</a></li> 
      <li><a href="#311-选择生产者" rel="nofollow">3.11 选择生产者</a></li> 
      <li><a href="#312-销毁eosio账户" rel="nofollow">3.12 销毁eosio账户</a></li> 
     </ul> </li> 
   </ul> 
  </div> 
  <p></p> 
  <h1 id="一网络层">一、网络层</h1> 
  <h2 id="11-eos网络视图">1.1 EOS网络视图：</h2> 
  <p><img src="https://img-blog.csdn.net/20180807160806171?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h0dHAxODgxODg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="" title=""></p> 
  <h2 id="12-核心网络层">1.2 核心网络层</h2> 
  <p>EOSIO网络的核心是块生产者和其所在服务器。完整的EOSIO网络由21个生产节点组成，这些节点已由网络社区投票选出，通过网络连接在一起，生产这之间可以流畅地通信。 <br> 这一层网络的关键设计目标是使生产节点专注于生成块并在它们之间进行同步。每个服务器都配备了高处理能力和大的内存，大的磁盘（用于日志存储），通过高容量冗余链路连接，受防火墙保护。如果运行服务器出现问题，备份服务器可以接管。 <br> <img src="https://files.readme.io/56002a1-EOSIO-core-network-layered-diagram.png" alt="核心网络" title=""></p> 
  <h2 id="13-访问网络层">1.3 访问网络层</h2> 
  <p>在消费层和核心层的生产者之间进行过滤和缓冲，保证核心层的高效运转。 <br> <img src="https://files.readme.io/bef8a3d-EOSIO-access-network-layered-diagram.png" alt="" title=""> <br> 根据功能可分为： API 、 Seed 、 Proxy 节点。 <br> （1）API节点处理来自cleos的请求以执行事务和查询状态，每个生产者节点应至少具有一个关联的API节点。 <br> （2）seed节点：seed节点与其他节点节点通信，以便与生产者节点保持同步。 可能是生产者候选者，它们与生产者保持同步并为其他节点提供服务，并因此建立了他们作为生产者的能力，希望得到社区投票。也可以进行区块链间通信，提供对另一个区块链的访问。 可以隔离生产者和网络上的其他节点之间。 一种重要类型是验证节点，验证类型节点在Access或Consumer 网络中运行，并跟踪区块链。 <br> seed节点通常仅使用EOSIO网络协议传送块（而不是事务），并且未配置为运行http协议（即不能通过cleos访问）。每个生产者节点应至少具有一个关联的seed节点。 <br> （3）Proxy 代理节点：提供负载均衡和DDOS保护。</p> 
  <h2 id="14-消费网络层">1.4 消费网络层</h2> 
  <p>任何使用区块链的用户，包括直接通过cleos、间接使用与区块链接口的某些应用程序。</p> 
  <h1 id="二系统自带合约">二、系统自带合约</h1> 
  <h2 id="21-eosiobios">2.1 eosio.bios</h2> 
  <p>基本操作，设置帐户和全局操作限制、权限、生产者以及建立授权级别。</p> 
  <h2 id="22-eosiotoken">2.2 eosio.token</h2> 
  <p>提供基本货币管理功能。包括创建货币、发行货币、转移货币。</p> 
  <h2 id="23-eosiomsig">2.3 eosio.msig</h2> 
  <p>进行所需授权级别的多个签名。</p> 
  <h2 id="24-eosiosystem">2.4 eosio.system</h2> 
  <p>让用户可以使用token，对生产者和工作人员进行配置和投票提案，可以经济且有效地建立和管理区块链。</p> 
  <h1 id="三bios-启动顺序">三、BIOS 启动顺序</h1> 
  <h2 id="31-配置初始的nodeos节点集">3.1 配置初始的nodeos节点集</h2> 
  <p>将启动一些nodeos节点，将它们指向彼此，并最终对一组生产者进行投票。 所有nodeos节点都在同一服务器上运行。 <br> （1） 为每个nodeos创建配置和数据目录</p> 
  <pre class="prettyprint"><code class=" hljs bash">//在nodeos命令行上将这些目录与--config-dir和--data-dir参数一起使用。
$ mkdir ~/eosio_test
$ <span class="hljs-keyword">for</span> (( i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i++ )); <span class="hljs-keyword">do</span> <span class="hljs-keyword">for</span> (( j = <span class="hljs-number">1</span> ; j &lt;=<span class="hljs-number">5</span> ; j++ )); <span class="hljs-keyword">do</span> mkdir ~/eosio_test/accountnum<span class="hljs-variable">$i</span><span class="hljs-variable">$j</span>; <span class="hljs-keyword">done</span>; <span class="hljs-keyword">done</span></code></pre> 
  <p>（2）准备用于对等通信的IP地址 <br> 将生产者指向彼此，以便进行对等通信。确定每个nodeos节点之间的对等通信的IP地址和端口号集，可以通过在启动nodeos时在命令行上设置p2p-peer-address配置属性（每个对等体一个参数），或者通过在config.ini文件中为nodeos设置属性（每个对等体一行）来配置每个nodeos 。</p> 
  <pre class="prettyprint"><code class=" hljs r">//例如，假设我们为生产者使用端口号<span class="hljs-number">9011</span>-<span class="hljs-number">9055</span>（即分别为accountnum11-accountnum55），请在nodes命令行上为accountnum12包含以下参数：
--p2p-peer-address localhost:<span class="hljs-number">9011</span> --p2p-peer-address localhost:<span class="hljs-number">9013</span> --p2p-peer-address localhost:<span class="hljs-number">9014</span> <span class="hljs-keyword">...</span>
//或者在config.mini里设置
p2p-peer-address = localhost:<span class="hljs-number">9011</span>
p2p-peer-address = localhost:<span class="hljs-number">9013</span>
p2p-peer-address = localhost:<span class="hljs-number">9014</span>
<span class="hljs-keyword">...</span></code></pre> 
  <p>无论是使用命令行还是配置文件方法，都注意不要在生成器列表中包含生产者自己的地址。</p> 
  <h2 id="32-启动-genesis-节点">3.2 启动 “genesis” 节点</h2> 
  <p>“genesis”节点是开始的第一个节点，它将生成区块链。 所有其他节点将从genesis节点派生。 在genesis节点上执行以下操作。 <br> （1）创建一个钱包wallet</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>cleos wallet create</code></pre> 
  <p>（2）配制genesis.json <br> 位置：eos/tutorials/bios-boot-tutorial <br> 作用：genesis.json文件定义了初始链状态。所有节点必须从相同的初始状态开始。有以下两个重要属性： <br> initial_timestamp：区块链的开始时间 <br> initial_key ：将使用该密钥对启动genesis节点，并使用此密钥对创建eosio的所有帐户。与genesis nodeos的公钥相匹配. 密钥对可以通过nodeos命令行 –private-key 指定,或 config.ini 的 private-key属性。 <br> （3）为eosio帐户创建密钥：</p> 
  <pre class="prettyprint"><code class=" hljs sql">$ cleos <span class="hljs-operator"><span class="hljs-keyword">create</span> <span class="hljs-keyword">key</span> </span></code></pre> 
  <p>（4）启动genesis 节点</p> 
  <pre class="prettyprint"><code class=" hljs lasso">$ nodeos <span class="hljs-attribute">-e</span> <span class="hljs-attribute">-p</span> eosio <span class="hljs-subst">--</span><span class="hljs-keyword">private</span><span class="hljs-attribute">-key</span> <span class="hljs-string">'[ "${pub-key}","${private-key}" ]'</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::producer_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::chain_api_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::http_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::history_api_plugin</span></code></pre> 
  <h2 id="33-创建重要的系统账户">3.3 创建重要的系统账户</h2> 
  <pre class="prettyprint"><code class=" hljs avrasm">//系统账户
  eosio<span class="hljs-preprocessor">.bpay</span>
  eosio<span class="hljs-preprocessor">.msig</span>
  eosio<span class="hljs-preprocessor">.names</span>
  eosio<span class="hljs-preprocessor">.ram</span>
  eosio<span class="hljs-preprocessor">.ramfee</span>
  eosio<span class="hljs-preprocessor">.saving</span>
  eosio<span class="hljs-preprocessor">.stake</span>
  eosio<span class="hljs-preprocessor">.token</span>
  eosio<span class="hljs-preprocessor">.vpay</span></code></pre> 
  <p>重复以下过程：</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>cleos create key  <span class="hljs-comment"># for eosio.bpay</span>
<span class="hljs-variable">$ </span>cleos wallet import <span class="hljs-variable">${</span>private-key}
<span class="hljs-variable">$ </span>cleos create account eosio eosio.bpay <span class="hljs-variable">${</span>owner-key}  <span class="hljs-variable">${</span>active-key}</code></pre> 
  <h2 id="34-创建eosiotoken合约">3.4 创建eosio.token合约</h2> 
  <p>此合约可以创建，发布，传输和获取有关token的信息。</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">$ cleos <span class="hljs-built_in">set</span> contract eosio.<span class="hljs-keyword">token</span>  /eos/build/contracts/eosio.<span class="hljs-keyword">token</span></code></pre> 
  <h2 id="35-创建eosiomsig合约">3.5 创建eosio.msig合约</h2> 
  <p>作用：启用并简化了权限级别的定义和管理、执行多签名操作。</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">$ cleos <span class="hljs-keyword">set</span> contract eosio<span class="hljs-preprocessor">.msig</span>  eos/build/contracts/eosio<span class="hljs-preprocessor">.msig</span></code></pre> 
  <h2 id="36-创建和分配sys货币">3.6 创建和分配SYS货币</h2> 
  <p>创建最大值为100亿token的SYS货币，然后发行十亿个代币。 可以用特定货币名称替换SYS。</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">//在 eosio账户中创建<span class="hljs-number">10</span>B SYS tokens ，这有效地创造了最大的代币供应，但不会使任何代币进入流通。 没有流通的代币可以被存储。
$ cleos push action eosio.<span class="hljs-keyword">token</span> <span class="hljs-built_in">create</span> <span class="hljs-string">'[ "eosio", "10000000000.0000 SYS" ]'</span> -p eosio.<span class="hljs-keyword">token</span>
executed transaction: <span class="hljs-number">0440461e0</span>d8816b4a8fd9d47c1a6a53536d3c7af54abf53eace884f008429697  <span class="hljs-number">120</span> <span class="hljs-keyword">bytes</span>  <span class="hljs-number">326</span> us  eosio.<span class="hljs-keyword">token</span> &lt;= eosio.<span class="hljs-keyword">token</span>::<span class="hljs-built_in">create</span>          {<span class="hljs-string">"issuer"</span>:<span class="hljs-string">"eosio"</span>,<span class="hljs-string">"maximum_supply"</span>:<span class="hljs-string">"10000000000.0000 SYS"</span>}<span class="hljs-comment"> //eosio.token合同将1B SYS token从存储中移除并将其置于流通中。在发行时，token保存在eosio帐户中。 由于eosio帐户拥有未流通的token储备，因此需要其权限才能执行此操作。</span>
$ cleos push action eosio.<span class="hljs-keyword">token</span> issue <span class="hljs-string">'[ "eosio", "1000000000.0000 SYS", "memo" ]'</span> -p eosio
executed transaction: a53961a566c1faa95531efb422cd952611b17d728edac833c9a55582425f98ed  <span class="hljs-number">128</span> <span class="hljs-keyword">bytes</span>  <span class="hljs-number">432</span> us eosio.<span class="hljs-keyword">token</span> &lt;= eosio.<span class="hljs-keyword">token</span>::issue           {<span class="hljs-string">"to"</span>:<span class="hljs-string">"eosio"</span>,<span class="hljs-string">"quantity"</span>:<span class="hljs-string">"1000000000.0000 SYS"</span>,<span class="hljs-string">"memo"</span>:<span class="hljs-string">"memo"</span>}</code></pre> 
  <h2 id="37-创建eosiosystem-合约">3.7 创建eosio.system 合约</h2> 
  <p>此合约包含了几乎所有基于toekn的操作。 一旦启用了系统合同，必须支付资源（cpu，网络，内存）、创建新帐户。 系统合同允许标记放样和未标记，要购买的资源，潜在生产者的注册和投票，生产者奖励认领，设置特权和限制等。</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">$ cleos <span class="hljs-built_in">set</span> contract eosio  eos/build/contracts/eosio.<span class="hljs-keyword">system</span></code></pre> 
  <h2 id="38-从单一生产者过渡到多个生产者">3.8 从单一生产者过渡到多个生产者</h2> 
  <p>此后，将从单个块生成器（创建节点）转换到多个生成器。到目前为止，只有内置的eosio帐户具有特权并且可以对块进行签名。但目标是通过一系列选定的生产者来管理区块链。 <br> 选举产生的生产者名单可以改变，规则不是直接向任何生产者提供特权，而是与名为eosio.prods的特殊内置帐户相关联。该帐户代表当选的生产者组。 eosio.prods帐户（实际上是生产者组）使用eosio.msig合同定义的权限进行操作。 <br> 安装eosio.system合同后，尽快将eosio.msig设为特权帐户，以便代表eosio帐户进行授权。 eosio将尽快辞去其权威，由eosio.prods接管。</p> 
  <pre class="prettyprint"><code class=" hljs java"><span class="hljs-comment">//使eosio.msig成为特权帐户</span>
$ cleos push action eosio setpriv <span class="hljs-string">'["eosio.msig", 1]'</span> -p eosio<span class="hljs-annotation">@active</span></code></pre> 
  <h2 id="39-放置token并扩展网络">3.9 放置token并扩展网络</h2> 
  <p>至此，完成了单主机单节点的以下合约配置： <br> eosio.token <br> eosio.msig <br> eosio.system <br> 帐户eosio和eosio.msig是特权帐户。 其他eosio帐户已创建但没有特权。接下来绑定账户并扩大生产者网络。</p> 
  <h2 id="310-创建赌注账户">3.10 创建赌注账户</h2> 
  <p>放样是将“真实世界”中的实体（例如，以Crowdsale或其他方式购买某物的个人）获得的令牌分配给EOSIO系统内的账户的过程。 <br> 对于初始放样过程可以采用如下方法： <br> 1）0.1令牌：赌注RAM。默认情况下，cleos在创建帐户时会占用8 KB的RAM，由帐户创建者支付。在最初的赌注中，eosio账户是进行赌注的账户创建者。在最初的令牌赌注过程中，赌注的代币在达到最低投票要求之前不能保持不变，且要求为流动。 <br> 2）为CPU赌注0.45令牌，为网络赌注0.45令牌。 <br> 3）最多9个token可用作流动代币。 <br> 4）剩余toekn是赌注50/50 CPU和网络。</p> 
  <pre class="prettyprint"><code class=" hljs applescript">Example <span class="hljs-number">1.</span>  accountnum11 has <span class="hljs-number">100</span> SYS. It will be staked <span class="hljs-keyword">as</span> <span class="hljs-number">0.1000</span> SYS <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> RAM; <span class="hljs-number">45.4500</span> SYS <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> CPU; <span class="hljs-number">45.4500</span> SYS <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> network; <span class="hljs-keyword">and</span> <span class="hljs-number">9.0000</span> SYS held <span class="hljs-keyword">for</span> liquid use.

Example <span class="hljs-number">2.</span>  accountnum33 has <span class="hljs-number">5</span> SYS. It will be staked <span class="hljs-keyword">as</span> <span class="hljs-number">0.1000</span> SYS <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> RAM; <span class="hljs-number">0.4500</span> SYS <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> CPU; <span class="hljs-number">0.4500</span> SYS <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> network; <span class="hljs-keyword">and</span> <span class="hljs-number">4.0000</span> SYS held <span class="hljs-keyword">for</span> liquid use.</code></pre> 
  <p>使用Pareto分布将1B令牌分发给帐户，模型为80-20规则，即80％的令牌由20％的人口持有。 <br> （1）创建赌注账户 <br> 使用以下步骤为每个帐户放置令牌。 必须为每个帐户单独完成这些步骤。</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>cleos create key  <span class="hljs-comment"># for accountnum11</span>
<span class="hljs-variable">$ </span>cleos wallet import <span class="hljs-variable">${</span>private-key}</code></pre> 
  <p>使用初始资源和公钥创建一个赌注帐户。 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>l</mi><mi>e</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>y</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>m</mi><mi>n</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>o</mi><mo>&amp;#x2212;</mo><mo>&amp;#x2212;</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>n</mi><mi>u</mi><mi>m</mi><mn>11</mn></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-1" style="width: 30.107em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.055em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1025em, 2.555em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">o</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">m</span><span class="mn" id="MathJax-Span-49" style="font-family: MathJax_Main;">11</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       c
      </mi>
      <mi>
       l
      </mi>
      <mi>
       e
      </mi>
      <mi>
       o
      </mi>
      <mi>
       s
      </mi>
      <mi>
       s
      </mi>
      <mi>
       y
      </mi>
      <mi>
       s
      </mi>
      <mi>
       t
      </mi>
      <mi>
       e
      </mi>
      <mi>
       m
      </mi>
      <mi>
       n
      </mi>
      <mi>
       e
      </mi>
      <mi>
       w
      </mi>
      <mi>
       a
      </mi>
      <mi>
       c
      </mi>
      <mi>
       c
      </mi>
      <mi>
       o
      </mi>
      <mi>
       u
      </mi>
      <mi>
       n
      </mi>
      <mi>
       t
      </mi>
      <mi>
       e
      </mi>
      <mi>
       o
      </mi>
      <mi>
       s
      </mi>
      <mi>
       i
      </mi>
      <mi>
       o
      </mi>
      <mo>
       −
      </mo>
      <mo>
       −
      </mo>
      <mi>
       t
      </mi>
      <mi>
       r
      </mi>
      <mi>
       a
      </mi>
      <mi>
       n
      </mi>
      <mi>
       s
      </mi>
      <mi>
       f
      </mi>
      <mi>
       e
      </mi>
      <mi>
       r
      </mi>
      <mi>
       a
      </mi>
      <mi>
       c
      </mi>
      <mi>
       c
      </mi>
      <mi>
       o
      </mi>
      <mi>
       u
      </mi>
      <mi>
       n
      </mi>
      <mi>
       t
      </mi>
      <mi>
       n
      </mi>
      <mi>
       u
      </mi>
      <mi>
       m
      </mi>
      <mn>
       11
      </mn>
     </math></span></span><script type="math/tex" id="MathJax-Element-1"> cleos system newaccount eosio --transfer accountnum11 </script>{pubkey} –stake-net “100000.0000 SYS” –stake-cpu “100000.0000 SYS”</p> 
  <h2 id="311-选择生产者">3.11 选择生产者</h2> 
  <p>（1）注册为生产者 <br> 使用以下命令注册为生产者。 这使得节点成为生产者的候选者，但除非被选举，否则该节点实际上不是生产者。</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>cleos system regproducer accountnum11   <span class="hljs-variable">${</span>pubkey}   <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/accountnum11.com/</span><span class="hljs-variable">${</span>pubkey}</code></pre> 
  <p>（2）列出生产者</p> 
  <pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-variable">$ </span>cleos system listproducers
<span class="hljs-constant">Producer</span>      <span class="hljs-constant">Producer</span> key                                           <span class="hljs-constant">Url</span>  </code></pre> 
  <p>（3）启动生产者 <br> 使用以下命令启动生成。 由于所有生产者都在单个服务器上运行，因此命令行参数用于确保每个生产者使用自己的目录。 <br> 在每个生产者的窗口中，运行以下nodeos命令。</p> 
  <pre class="prettyprint"><code class=" hljs lasso">$ nodeos <span class="hljs-subst">--</span>genesis<span class="hljs-attribute">-json</span> ~/eosio_test/accountnum11/genesis<span class="hljs-built_in">.</span>json <span class="hljs-subst">--</span>block<span class="hljs-attribute">-log</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum11/blocks <span class="hljs-subst">--</span>config<span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum11<span class="hljs-subst">/</span> <span class="hljs-subst">--</span><span class="hljs-built_in">data</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum11<span class="hljs-subst">/</span> <span class="hljs-subst">--</span>http<span class="hljs-attribute">-server</span><span class="hljs-attribute">-address</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8011</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-listen</span><span class="hljs-attribute">-endpoint</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">9011</span> <span class="hljs-subst">--</span>enable<span class="hljs-attribute">-stale</span><span class="hljs-attribute">-production</span> <span class="hljs-subst">--</span>producer<span class="hljs-attribute">-name</span> accountnum11 <span class="hljs-subst">--</span><span class="hljs-keyword">private</span><span class="hljs-attribute">-key</span> <span class="hljs-string">'[ "pubkey","privatekey" ]'</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::producer_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::chain_api_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::http_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::history_api_plugin</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9022</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9033</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9044</span></code></pre> 
  <p>为方便起见，可以复制以下命令行以在帐户accountnum22，accountnum33和accountnum44的单独shell窗口中运行nodeos。</p> 
  <pre class="prettyprint"><code class=" hljs lasso">$ nodeos <span class="hljs-subst">--</span>genesis<span class="hljs-attribute">-json</span> ~/eosio_test/accountnum22/genesis<span class="hljs-built_in">.</span>json <span class="hljs-subst">--</span>block<span class="hljs-attribute">-log</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum22/blocks <span class="hljs-subst">--</span>config<span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum22<span class="hljs-subst">/</span> <span class="hljs-subst">--</span><span class="hljs-built_in">data</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum22<span class="hljs-subst">/</span> <span class="hljs-subst">--</span>http<span class="hljs-attribute">-server</span><span class="hljs-attribute">-address</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8022</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-listen</span><span class="hljs-attribute">-endpoint</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">9022</span> <span class="hljs-subst">--</span>enable<span class="hljs-attribute">-stale</span><span class="hljs-attribute">-production</span> <span class="hljs-subst">--</span>producer<span class="hljs-attribute">-name</span> accountnum22 <span class="hljs-subst">--</span><span class="hljs-keyword">private</span><span class="hljs-attribute">-key</span> <span class="hljs-string">'[ ""pubkey","privatekey" ]'</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::producer_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::chain_api_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::http_plugin</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9011</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9033</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9044</span>
$ nodeos <span class="hljs-subst">--</span>genesis<span class="hljs-attribute">-json</span> ~/eosio_test/accountnum33/genesis<span class="hljs-built_in">.</span>json <span class="hljs-subst">--</span>block<span class="hljs-attribute">-log</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum33/blocks <span class="hljs-subst">--</span>config<span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum33<span class="hljs-subst">/</span> <span class="hljs-subst">--</span><span class="hljs-built_in">data</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum33<span class="hljs-subst">/</span> <span class="hljs-subst">--</span>http<span class="hljs-attribute">-server</span><span class="hljs-attribute">-address</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8033</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-listen</span><span class="hljs-attribute">-endpoint</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">9033</span> <span class="hljs-subst">--</span>enable<span class="hljs-attribute">-stale</span><span class="hljs-attribute">-production</span> <span class="hljs-subst">--</span>producer<span class="hljs-attribute">-name</span> accountnum33 <span class="hljs-subst">--</span><span class="hljs-keyword">private</span><span class="hljs-attribute">-key</span> <span class="hljs-string">'[ "pubkey","privatekey"]'</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::producer_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::chain_api_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::http_plugin</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9011</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9022</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9044</span>
$ nodeos <span class="hljs-subst">--</span>genesis<span class="hljs-attribute">-json</span> ~/eosio_test/accountnum44/genesis<span class="hljs-built_in">.</span>json <span class="hljs-subst">--</span>block<span class="hljs-attribute">-log</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum44/blocks <span class="hljs-subst">--</span>config<span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum44<span class="hljs-subst">/</span> <span class="hljs-subst">--</span><span class="hljs-built_in">data</span><span class="hljs-attribute">-dir</span> ~/eosio_test/accountnum44<span class="hljs-subst">/</span> <span class="hljs-subst">--</span>http<span class="hljs-attribute">-server</span><span class="hljs-attribute">-address</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8044</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-listen</span><span class="hljs-attribute">-endpoint</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">9044</span> <span class="hljs-subst">--</span>enable<span class="hljs-attribute">-stale</span><span class="hljs-attribute">-production</span> <span class="hljs-subst">--</span>producer<span class="hljs-attribute">-name</span> accountnum44 <span class="hljs-subst">--</span><span class="hljs-keyword">private</span><span class="hljs-attribute">-key</span> <span class="hljs-string">'[ "pubkey","privatekey"]'</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::producer_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::chain_api_plugin</span> <span class="hljs-subst">--</span>plugin eosio<span class="hljs-tag">::http_plugin</span> <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9011</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9022</span>  <span class="hljs-subst">--</span>p2p<span class="hljs-attribute">-peer</span><span class="hljs-attribute">-address</span> localhost:<span class="hljs-number">9033</span></code></pre> 
  <p>（3）genesis.json <br> 每个节点的输出都在该节点工作目录中的文件stderr中捕获，例如./nodes/accountnum44/stderr。 <br> <img src="https://img-blog.csdn.net/20180807160618384?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h0dHAxODgxODg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="" title=""></p> 
  <h2 id="312-销毁eosio账户">3.12 销毁eosio账户</h2> 
  <p>一旦选择生产者满足了最低数量要求，即被选出，eosio帐户就可以销毁，将eosio.msig帐户留作唯一的特权帐户。 <br> 销毁主要涉及将eosio的所有帐户的密钥设置为null。 使用以下命令清除eosio帐户的所有者和活动密钥：</p> 
  <pre class="prettyprint"><code class=" hljs scilab">$ cleos push action eosio updateauth <span class="hljs-string">'{"</span>account<span class="hljs-string">": "</span>eosio<span class="hljs-string">", "</span>permission<span class="hljs-string">": "</span>owner<span class="hljs-string">", "</span>parent<span class="hljs-string">": "</span><span class="hljs-string">", "</span>auth<span class="hljs-string">": {"</span>threshold<span class="hljs-string">": 1, "</span>keys<span class="hljs-string">": [], "</span>waits<span class="hljs-string">": [], "</span>accounts<span class="hljs-string">": [{"</span>weight<span class="hljs-string">": 1, "</span>permission<span class="hljs-string">": {"</span>actor<span class="hljs-string">": "</span><span class="hljs-transposed_variable">eosio.</span>prods<span class="hljs-string">", "</span>permission<span class="hljs-string">": "</span>active<span class="hljs-string">"}}]}}'</span> -p eosio@owner
$ cleos push action eosio updateauth <span class="hljs-string">'{"</span>account<span class="hljs-string">": "</span>eosio<span class="hljs-string">", "</span>permission<span class="hljs-string">": "</span>active<span class="hljs-string">", "</span>parent<span class="hljs-string">": "</span>owner<span class="hljs-string">", "</span>auth<span class="hljs-string">": {"</span>threshold<span class="hljs-string">": 1, "</span>keys<span class="hljs-string">": [], "</span>waits<span class="hljs-string">": [], "</span>accounts<span class="hljs-string">": [{"</span>weight<span class="hljs-string">": 1, "</span>permission<span class="hljs-string">": {"</span>actor<span class="hljs-string">": "</span><span class="hljs-transposed_variable">eosio.</span>prods<span class="hljs-string">", "</span>permission<span class="hljs-string">": "</span>active<span class="hljs-string">"}}]}}'</span> -p eosio@active</code></pre> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/http188188/article/details/81477710,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/http188188/article/details/81477710,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
