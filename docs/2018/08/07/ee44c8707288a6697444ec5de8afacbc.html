<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>深入浅出区块链教程——17.去中心化与区块链交易性能 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="深入浅出区块链教程——17.去中心化与区块链交易性能" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="去中心化与区块链交易性能 比特币和以太坊的 TPS 一直被技术领域的人所诟病，或许这与工程师“高性能高并发”的情节有关。 那么说，去中心化与高性能 TPS 是否真的可以做到鱼和熊掌的兼具呢？区块链业界又采取了哪些方案进行改善呢？围绕这两个主题，我们开始聊聊今天的话题。 再谈去中心化 说到区块链的最大标签，莫过于“去中心化”，在任何讨论区块链的场合，这个词几乎都会被提起。 今年 3 月份，全球顶级数字资产交易平台 OKEX 的负责人徐明星曾经发文，他表示业界应该避免使用“去中心化”这样的词汇，而改用“点对点”，“点对点”一词后来甚至被直接冠到了比特币白皮书的标题上。 去中心化与点对点有区别吗？我认为是有的，去中心化是包含了一定政治主观色彩的词汇，点对点只是一个中性词汇，更适合用来描述系统的性质。 去中心化这种说法树立了一个无形的靶子，这个靶子可大可小，大到政府机关，小到小商小贩。 正如我们说的是 P2P 网络，而不是去中心化网络。所以在技术领域使用点对点，而不是去中心化，可以避免这种概念被过度消费， 说到了“过度消费”，我认为“去中心化”已经演变成了区块链行业对外宣传的消费概念，这是一种情怀消费，它消费了人们对强权者的不满，例如店大欺客的商家、死皮赖脸的中间商、缺乏诚信的供应商。 这些内容，你或多或少都在生活中经历过，当“去中心化”的口号响起的时候，人们终于找到了一个发泄口，强烈的共鸣放大了区块链的光环，造成了区块链能掀起一场大革新的错觉。 革新肯定是有的，但去中心化只是表象，如果我们加深层次去理解，就可以发现数字货币和数字资产带来更多的是交易效率的成倍提升。 人类的现代文明是建立在交易的基础上的，没有交易就意味着直接回到了农耕社会。所以交易效率的提升才是区块链的根本所在，那么说，区块链本来是这样看似低效的 TPS，为什么说它提高了交易效率呢？ 我们先回到传统的交易模式来看一看。 交易首先是基于中心化平台的，当我们进入某个中心化平台，在这个平台内部，交易效率是提升了，但是我们回顾整个交易的生命周期，就会发现这个平台可能只是交易的一环，平台和平台之间的协作似乎并不是那么顺畅。 跨境支付便是典型的例子，市值长居 Top3 的区块链项目 Ripple 就是为了解决跨境支付的难题而产生的。 我们再来看区块链点对点的交易模式，它的 TPS 看似低效，但是它提供了全局无缝衔接的资产流转过程，这减少了整个交易生命周期的步骤，这也是区块链提升交易效率的关键所在。 所以说，虽然中心化系统能提供优秀的高性能服务，但是慢在人工审核、平台之间衔接、内部审计，平台之间的协作业务推进，想必你一定也深有体会。 技术上的去中心化 我们在聊 DPOS 共识机制的时候，提到过一个 TPS 的计算公式， TPS = (block_size network_bandwidth witness_performance) / (block_time * witness_count) 其中 witness_count 记账节点的数目与准入门槛在业界的争议比较大，如果完全去中心化的话，首先就意味着记账节点没有准入门槛，记账的节点可以无限多，当然这只是一个理想环境，工程实施的可行性几乎为零。 比特币全球的全节点 1.2 万个，大大小小的挖矿节点只有几十个，常出块的只有 5 大矿池，但是比特币依然没有限制记账节点的准入门槛，以太坊也是如此。而在 EOS 中，既规定了记账节点的数目，又规定了门槛。 可以这么说，控制了记账节点的数量和准入门槛，就等于决定了区块链 TPS 的大小。 为了帮助你深层次地理解去中心化与 TPS 的关系，这时候我们再次回到之前一直提到的 CAP 定理中。 CAP 定理中，C为最终一致性，决定了出块时间的长短。A 是可用性，这个是必选的，必须要保证区块链 7 X 24 X 365 全部可用。 P 是网络分区容忍性，P 的含义在区块链上有两层，第一层是必须保证分区可容忍，也就是一旦出现因为网络分区而导致区块链分叉，必须有一种机制可以合并区块链；第二层含义是如果我们尽量避免出现网络分区，那么就可以避免 P 的出现，从而提升 C 的性能。 C 和 P 是可以相互调整的，有两种情况。 情况 1，如果我们选则调整 C，也就是拉长了最终一致性的确认时间，那么对 P 的要求就会减弱，也就是网络产生分区不要紧，反正区块链有足够的时间恢复最终一致性。 情况 2，如果我们选则调整 P，也就是限制较少的记账节点的数量，并且对记账节点之间的带宽提出要求，降低出现网络分区的可能性，那么对 C 的要求就会减弱，就可以降低出块时间。 情况 1 就是比特币和以太坊的典型思路，情况 2 就是 EOS 的典型思路。 区块链属于分布式系统，通过简单分析我们可以知道，区块链交易 TPS 与去中心化的具有不可调和性，任何一个号称 TPS 过万的区块链项目肯定是极其中心化的（至少技术上是的）。 所以，那些试图兼具高性能与去中心化的工作大多都是徒劳的。 各个区块链的 TPS 指标 图中是 TPS 都在千笔以上的区块链项目，通过控制了记账节点的数量，牺牲了去中心化特性提升了 TPS，比如石墨烯系列的 DPOS，Ripple 的共识。 如果我们把 CAP 做一个可视化处理，就构建出来一个三角形分布，我们可以得到下图： 从图中我们可以看出，PoW、PoS 型公链偏好 AP 特性，于是 TPS 有限。联盟链以及 DPoS 型共识偏好比较均匀，可以达到可观的 TPS。 传统数据中心往往不考虑 P 在第二层语义上的问题，更不考虑拜占庭容错问题，所以他们拥有更好的 TPS，但是在网络分区和出现拜占庭错误的时候，表现得不尽如人意。 这些共识机制在不同场景中可以有不同的选择，不存在适用所有场景的的共识机制。 业界的可选方案之一：Sharding 分片 好了，我们在上文讨论了 CAP 定理对区块链的影响，那么业界也还是使出了浑身解数来尽可能地提升 TPS。 目前一共有两种正在讨论的方案，分别是 Sharding 分片技术和 闪电网络(不算侧链，侧链主要用于扩容) 。闪电网络旨在解决比特币微小额支付的实时性问题，其中的算法是比特币 TPS 扩展的一种方案。 这两种方案不涉及修改共识机制。如果我们修改为 DPoS 共识机制、DAG 共识算法，也可以提升 TPS，不过不在本篇的讨论范围。 分片技术是一种安装传统数据库分片的扩展，主要思路是将数据库分成多个分区（碎片）并将分区放置在不同的服务器上。 在区块链场景下，全网的节点相当于分布式数据库中的不同服务器，这时候 我们可以将交易分成不同的部分，然后每个记账节点只需要验证交易的一部分即可，而不必验证完整的交易性 。 这带来的好处是就是 并行化处理，记账节点之间相当于是协作关系，而不再是单纯的独立关系。 随着网络的增长，这种协作关系也可以随之扩展，这种扩展也叫做水平扩容。 分片技术有以下优势：首先是 TPS 可以从十几笔提升至少两个数量级，也就是千笔每秒，这不但对应用友好，也提升了用户体验；其次 TPS 的提升可以带来更多应用，这些应用在共识的激励下可以水平扩展区块链的性能，形成一种良性循环。 下面我介绍一下分片的两种方案：状态分片、网络分片。 第一种方案是是网络分片，网络分片是我们按照网络进行分区，区域内的交易归集在一起并在区域内进行验证，这样区域内的用户可以享受低延迟高吞吐的 TPS，但是会带来跨区域分片的复杂性。我们也可以将网络分片比喻成数据库集群分区。 其次是状态分片，状态分片是在以太坊上提出的方案，状态分片目前没有确切的技术方案，尚在研究讨论阶段。 我们可以简单类比数据库的分表。我们将同一张表的数据塞到不同的节点，这些节点分布在全世界各地并且没有可信的网络环境。所以状态分片是非常复杂的技术，实践的最终结果我们需要看以太坊后续的动作。 上一篇：深入区块链技术（八）：UTXO与普通账户模型 下一篇：智能合约与以太坊 完整区块链教程：《深入浅出区块链》 欢迎star和fork。 阅读更多" />
<meta property="og:description" content="去中心化与区块链交易性能 比特币和以太坊的 TPS 一直被技术领域的人所诟病，或许这与工程师“高性能高并发”的情节有关。 那么说，去中心化与高性能 TPS 是否真的可以做到鱼和熊掌的兼具呢？区块链业界又采取了哪些方案进行改善呢？围绕这两个主题，我们开始聊聊今天的话题。 再谈去中心化 说到区块链的最大标签，莫过于“去中心化”，在任何讨论区块链的场合，这个词几乎都会被提起。 今年 3 月份，全球顶级数字资产交易平台 OKEX 的负责人徐明星曾经发文，他表示业界应该避免使用“去中心化”这样的词汇，而改用“点对点”，“点对点”一词后来甚至被直接冠到了比特币白皮书的标题上。 去中心化与点对点有区别吗？我认为是有的，去中心化是包含了一定政治主观色彩的词汇，点对点只是一个中性词汇，更适合用来描述系统的性质。 去中心化这种说法树立了一个无形的靶子，这个靶子可大可小，大到政府机关，小到小商小贩。 正如我们说的是 P2P 网络，而不是去中心化网络。所以在技术领域使用点对点，而不是去中心化，可以避免这种概念被过度消费， 说到了“过度消费”，我认为“去中心化”已经演变成了区块链行业对外宣传的消费概念，这是一种情怀消费，它消费了人们对强权者的不满，例如店大欺客的商家、死皮赖脸的中间商、缺乏诚信的供应商。 这些内容，你或多或少都在生活中经历过，当“去中心化”的口号响起的时候，人们终于找到了一个发泄口，强烈的共鸣放大了区块链的光环，造成了区块链能掀起一场大革新的错觉。 革新肯定是有的，但去中心化只是表象，如果我们加深层次去理解，就可以发现数字货币和数字资产带来更多的是交易效率的成倍提升。 人类的现代文明是建立在交易的基础上的，没有交易就意味着直接回到了农耕社会。所以交易效率的提升才是区块链的根本所在，那么说，区块链本来是这样看似低效的 TPS，为什么说它提高了交易效率呢？ 我们先回到传统的交易模式来看一看。 交易首先是基于中心化平台的，当我们进入某个中心化平台，在这个平台内部，交易效率是提升了，但是我们回顾整个交易的生命周期，就会发现这个平台可能只是交易的一环，平台和平台之间的协作似乎并不是那么顺畅。 跨境支付便是典型的例子，市值长居 Top3 的区块链项目 Ripple 就是为了解决跨境支付的难题而产生的。 我们再来看区块链点对点的交易模式，它的 TPS 看似低效，但是它提供了全局无缝衔接的资产流转过程，这减少了整个交易生命周期的步骤，这也是区块链提升交易效率的关键所在。 所以说，虽然中心化系统能提供优秀的高性能服务，但是慢在人工审核、平台之间衔接、内部审计，平台之间的协作业务推进，想必你一定也深有体会。 技术上的去中心化 我们在聊 DPOS 共识机制的时候，提到过一个 TPS 的计算公式， TPS = (block_size network_bandwidth witness_performance) / (block_time * witness_count) 其中 witness_count 记账节点的数目与准入门槛在业界的争议比较大，如果完全去中心化的话，首先就意味着记账节点没有准入门槛，记账的节点可以无限多，当然这只是一个理想环境，工程实施的可行性几乎为零。 比特币全球的全节点 1.2 万个，大大小小的挖矿节点只有几十个，常出块的只有 5 大矿池，但是比特币依然没有限制记账节点的准入门槛，以太坊也是如此。而在 EOS 中，既规定了记账节点的数目，又规定了门槛。 可以这么说，控制了记账节点的数量和准入门槛，就等于决定了区块链 TPS 的大小。 为了帮助你深层次地理解去中心化与 TPS 的关系，这时候我们再次回到之前一直提到的 CAP 定理中。 CAP 定理中，C为最终一致性，决定了出块时间的长短。A 是可用性，这个是必选的，必须要保证区块链 7 X 24 X 365 全部可用。 P 是网络分区容忍性，P 的含义在区块链上有两层，第一层是必须保证分区可容忍，也就是一旦出现因为网络分区而导致区块链分叉，必须有一种机制可以合并区块链；第二层含义是如果我们尽量避免出现网络分区，那么就可以避免 P 的出现，从而提升 C 的性能。 C 和 P 是可以相互调整的，有两种情况。 情况 1，如果我们选则调整 C，也就是拉长了最终一致性的确认时间，那么对 P 的要求就会减弱，也就是网络产生分区不要紧，反正区块链有足够的时间恢复最终一致性。 情况 2，如果我们选则调整 P，也就是限制较少的记账节点的数量，并且对记账节点之间的带宽提出要求，降低出现网络分区的可能性，那么对 C 的要求就会减弱，就可以降低出块时间。 情况 1 就是比特币和以太坊的典型思路，情况 2 就是 EOS 的典型思路。 区块链属于分布式系统，通过简单分析我们可以知道，区块链交易 TPS 与去中心化的具有不可调和性，任何一个号称 TPS 过万的区块链项目肯定是极其中心化的（至少技术上是的）。 所以，那些试图兼具高性能与去中心化的工作大多都是徒劳的。 各个区块链的 TPS 指标 图中是 TPS 都在千笔以上的区块链项目，通过控制了记账节点的数量，牺牲了去中心化特性提升了 TPS，比如石墨烯系列的 DPOS，Ripple 的共识。 如果我们把 CAP 做一个可视化处理，就构建出来一个三角形分布，我们可以得到下图： 从图中我们可以看出，PoW、PoS 型公链偏好 AP 特性，于是 TPS 有限。联盟链以及 DPoS 型共识偏好比较均匀，可以达到可观的 TPS。 传统数据中心往往不考虑 P 在第二层语义上的问题，更不考虑拜占庭容错问题，所以他们拥有更好的 TPS，但是在网络分区和出现拜占庭错误的时候，表现得不尽如人意。 这些共识机制在不同场景中可以有不同的选择，不存在适用所有场景的的共识机制。 业界的可选方案之一：Sharding 分片 好了，我们在上文讨论了 CAP 定理对区块链的影响，那么业界也还是使出了浑身解数来尽可能地提升 TPS。 目前一共有两种正在讨论的方案，分别是 Sharding 分片技术和 闪电网络(不算侧链，侧链主要用于扩容) 。闪电网络旨在解决比特币微小额支付的实时性问题，其中的算法是比特币 TPS 扩展的一种方案。 这两种方案不涉及修改共识机制。如果我们修改为 DPoS 共识机制、DAG 共识算法，也可以提升 TPS，不过不在本篇的讨论范围。 分片技术是一种安装传统数据库分片的扩展，主要思路是将数据库分成多个分区（碎片）并将分区放置在不同的服务器上。 在区块链场景下，全网的节点相当于分布式数据库中的不同服务器，这时候 我们可以将交易分成不同的部分，然后每个记账节点只需要验证交易的一部分即可，而不必验证完整的交易性 。 这带来的好处是就是 并行化处理，记账节点之间相当于是协作关系，而不再是单纯的独立关系。 随着网络的增长，这种协作关系也可以随之扩展，这种扩展也叫做水平扩容。 分片技术有以下优势：首先是 TPS 可以从十几笔提升至少两个数量级，也就是千笔每秒，这不但对应用友好，也提升了用户体验；其次 TPS 的提升可以带来更多应用，这些应用在共识的激励下可以水平扩展区块链的性能，形成一种良性循环。 下面我介绍一下分片的两种方案：状态分片、网络分片。 第一种方案是是网络分片，网络分片是我们按照网络进行分区，区域内的交易归集在一起并在区域内进行验证，这样区域内的用户可以享受低延迟高吞吐的 TPS，但是会带来跨区域分片的复杂性。我们也可以将网络分片比喻成数据库集群分区。 其次是状态分片，状态分片是在以太坊上提出的方案，状态分片目前没有确切的技术方案，尚在研究讨论阶段。 我们可以简单类比数据库的分表。我们将同一张表的数据塞到不同的节点，这些节点分布在全世界各地并且没有可信的网络环境。所以状态分片是非常复杂的技术，实践的最终结果我们需要看以太坊后续的动作。 上一篇：深入区块链技术（八）：UTXO与普通账户模型 下一篇：智能合约与以太坊 完整区块链教程：《深入浅出区块链》 欢迎star和fork。 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-07T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"去中心化与区块链交易性能 比特币和以太坊的 TPS 一直被技术领域的人所诟病，或许这与工程师“高性能高并发”的情节有关。 那么说，去中心化与高性能 TPS 是否真的可以做到鱼和熊掌的兼具呢？区块链业界又采取了哪些方案进行改善呢？围绕这两个主题，我们开始聊聊今天的话题。 再谈去中心化 说到区块链的最大标签，莫过于“去中心化”，在任何讨论区块链的场合，这个词几乎都会被提起。 今年 3 月份，全球顶级数字资产交易平台 OKEX 的负责人徐明星曾经发文，他表示业界应该避免使用“去中心化”这样的词汇，而改用“点对点”，“点对点”一词后来甚至被直接冠到了比特币白皮书的标题上。 去中心化与点对点有区别吗？我认为是有的，去中心化是包含了一定政治主观色彩的词汇，点对点只是一个中性词汇，更适合用来描述系统的性质。 去中心化这种说法树立了一个无形的靶子，这个靶子可大可小，大到政府机关，小到小商小贩。 正如我们说的是 P2P 网络，而不是去中心化网络。所以在技术领域使用点对点，而不是去中心化，可以避免这种概念被过度消费， 说到了“过度消费”，我认为“去中心化”已经演变成了区块链行业对外宣传的消费概念，这是一种情怀消费，它消费了人们对强权者的不满，例如店大欺客的商家、死皮赖脸的中间商、缺乏诚信的供应商。 这些内容，你或多或少都在生活中经历过，当“去中心化”的口号响起的时候，人们终于找到了一个发泄口，强烈的共鸣放大了区块链的光环，造成了区块链能掀起一场大革新的错觉。 革新肯定是有的，但去中心化只是表象，如果我们加深层次去理解，就可以发现数字货币和数字资产带来更多的是交易效率的成倍提升。 人类的现代文明是建立在交易的基础上的，没有交易就意味着直接回到了农耕社会。所以交易效率的提升才是区块链的根本所在，那么说，区块链本来是这样看似低效的 TPS，为什么说它提高了交易效率呢？ 我们先回到传统的交易模式来看一看。 交易首先是基于中心化平台的，当我们进入某个中心化平台，在这个平台内部，交易效率是提升了，但是我们回顾整个交易的生命周期，就会发现这个平台可能只是交易的一环，平台和平台之间的协作似乎并不是那么顺畅。 跨境支付便是典型的例子，市值长居 Top3 的区块链项目 Ripple 就是为了解决跨境支付的难题而产生的。 我们再来看区块链点对点的交易模式，它的 TPS 看似低效，但是它提供了全局无缝衔接的资产流转过程，这减少了整个交易生命周期的步骤，这也是区块链提升交易效率的关键所在。 所以说，虽然中心化系统能提供优秀的高性能服务，但是慢在人工审核、平台之间衔接、内部审计，平台之间的协作业务推进，想必你一定也深有体会。 技术上的去中心化 我们在聊 DPOS 共识机制的时候，提到过一个 TPS 的计算公式， TPS = (block_size network_bandwidth witness_performance) / (block_time * witness_count) 其中 witness_count 记账节点的数目与准入门槛在业界的争议比较大，如果完全去中心化的话，首先就意味着记账节点没有准入门槛，记账的节点可以无限多，当然这只是一个理想环境，工程实施的可行性几乎为零。 比特币全球的全节点 1.2 万个，大大小小的挖矿节点只有几十个，常出块的只有 5 大矿池，但是比特币依然没有限制记账节点的准入门槛，以太坊也是如此。而在 EOS 中，既规定了记账节点的数目，又规定了门槛。 可以这么说，控制了记账节点的数量和准入门槛，就等于决定了区块链 TPS 的大小。 为了帮助你深层次地理解去中心化与 TPS 的关系，这时候我们再次回到之前一直提到的 CAP 定理中。 CAP 定理中，C为最终一致性，决定了出块时间的长短。A 是可用性，这个是必选的，必须要保证区块链 7 X 24 X 365 全部可用。 P 是网络分区容忍性，P 的含义在区块链上有两层，第一层是必须保证分区可容忍，也就是一旦出现因为网络分区而导致区块链分叉，必须有一种机制可以合并区块链；第二层含义是如果我们尽量避免出现网络分区，那么就可以避免 P 的出现，从而提升 C 的性能。 C 和 P 是可以相互调整的，有两种情况。 情况 1，如果我们选则调整 C，也就是拉长了最终一致性的确认时间，那么对 P 的要求就会减弱，也就是网络产生分区不要紧，反正区块链有足够的时间恢复最终一致性。 情况 2，如果我们选则调整 P，也就是限制较少的记账节点的数量，并且对记账节点之间的带宽提出要求，降低出现网络分区的可能性，那么对 C 的要求就会减弱，就可以降低出块时间。 情况 1 就是比特币和以太坊的典型思路，情况 2 就是 EOS 的典型思路。 区块链属于分布式系统，通过简单分析我们可以知道，区块链交易 TPS 与去中心化的具有不可调和性，任何一个号称 TPS 过万的区块链项目肯定是极其中心化的（至少技术上是的）。 所以，那些试图兼具高性能与去中心化的工作大多都是徒劳的。 各个区块链的 TPS 指标 图中是 TPS 都在千笔以上的区块链项目，通过控制了记账节点的数量，牺牲了去中心化特性提升了 TPS，比如石墨烯系列的 DPOS，Ripple 的共识。 如果我们把 CAP 做一个可视化处理，就构建出来一个三角形分布，我们可以得到下图： 从图中我们可以看出，PoW、PoS 型公链偏好 AP 特性，于是 TPS 有限。联盟链以及 DPoS 型共识偏好比较均匀，可以达到可观的 TPS。 传统数据中心往往不考虑 P 在第二层语义上的问题，更不考虑拜占庭容错问题，所以他们拥有更好的 TPS，但是在网络分区和出现拜占庭错误的时候，表现得不尽如人意。 这些共识机制在不同场景中可以有不同的选择，不存在适用所有场景的的共识机制。 业界的可选方案之一：Sharding 分片 好了，我们在上文讨论了 CAP 定理对区块链的影响，那么业界也还是使出了浑身解数来尽可能地提升 TPS。 目前一共有两种正在讨论的方案，分别是 Sharding 分片技术和 闪电网络(不算侧链，侧链主要用于扩容) 。闪电网络旨在解决比特币微小额支付的实时性问题，其中的算法是比特币 TPS 扩展的一种方案。 这两种方案不涉及修改共识机制。如果我们修改为 DPoS 共识机制、DAG 共识算法，也可以提升 TPS，不过不在本篇的讨论范围。 分片技术是一种安装传统数据库分片的扩展，主要思路是将数据库分成多个分区（碎片）并将分区放置在不同的服务器上。 在区块链场景下，全网的节点相当于分布式数据库中的不同服务器，这时候 我们可以将交易分成不同的部分，然后每个记账节点只需要验证交易的一部分即可，而不必验证完整的交易性 。 这带来的好处是就是 并行化处理，记账节点之间相当于是协作关系，而不再是单纯的独立关系。 随着网络的增长，这种协作关系也可以随之扩展，这种扩展也叫做水平扩容。 分片技术有以下优势：首先是 TPS 可以从十几笔提升至少两个数量级，也就是千笔每秒，这不但对应用友好，也提升了用户体验；其次 TPS 的提升可以带来更多应用，这些应用在共识的激励下可以水平扩展区块链的性能，形成一种良性循环。 下面我介绍一下分片的两种方案：状态分片、网络分片。 第一种方案是是网络分片，网络分片是我们按照网络进行分区，区域内的交易归集在一起并在区域内进行验证，这样区域内的用户可以享受低延迟高吞吐的 TPS，但是会带来跨区域分片的复杂性。我们也可以将网络分片比喻成数据库集群分区。 其次是状态分片，状态分片是在以太坊上提出的方案，状态分片目前没有确切的技术方案，尚在研究讨论阶段。 我们可以简单类比数据库的分表。我们将同一张表的数据塞到不同的节点，这些节点分布在全世界各地并且没有可信的网络环境。所以状态分片是非常复杂的技术，实践的最终结果我们需要看以太坊后续的动作。 上一篇：深入区块链技术（八）：UTXO与普通账户模型 下一篇：智能合约与以太坊 完整区块链教程：《深入浅出区块链》 欢迎star和fork。 阅读更多","@type":"BlogPosting","url":"/2018/08/07/ee44c8707288a6697444ec5de8afacbc.html","headline":"深入浅出区块链教程——17.去中心化与区块链交易性能","dateModified":"2018-08-07T00:00:00+08:00","datePublished":"2018-08-07T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/08/07/ee44c8707288a6697444ec5de8afacbc.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>深入浅出区块链教程——17.去中心化与区块链交易性能</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <h1 id="去中心化与区块链交易性能">去中心化与区块链交易性能</h1> 
  <p>比特币和以太坊的 TPS 一直被技术领域的人所诟病，或许这与工程师“高性能高并发”的情节有关。</p> 
  <p>那么说，去中心化与高性能 TPS 是否真的可以做到鱼和熊掌的兼具呢？区块链业界又采取了哪些方案进行改善呢？围绕这两个主题，我们开始聊聊今天的话题。</p> 
  <h2 id="再谈去中心化">再谈去中心化</h2> 
  <p>说到区块链的最大标签，莫过于“去中心化”，在任何讨论区块链的场合，这个词几乎都会被提起。</p> 
  <p>今年 3 月份，全球顶级数字资产交易平台 OKEX 的负责人徐明星曾经发文，他表示业界应该避免使用“去中心化”这样的词汇，而改用“点对点”，“点对点”一词后来甚至被直接冠到了比特币白皮书的标题上。</p> 
  <p>去中心化与点对点有区别吗？我认为是有的，去中心化是包含了一定政治主观色彩的词汇，点对点只是一个中性词汇，更适合用来描述系统的性质。</p> 
  <p>去中心化这种说法树立了一个无形的靶子，这个靶子可大可小，大到政府机关，小到小商小贩。</p> 
  <p>正如我们说的是 P2P 网络，而不是去中心化网络。所以在技术领域使用点对点，而不是去中心化，可以避免这种概念被过度消费，</p> 
  <p>说到了“过度消费”，我认为“去中心化”已经演变成了区块链行业对外宣传的消费概念，这是一种情怀消费，它消费了人们对强权者的不满，例如店大欺客的商家、死皮赖脸的中间商、缺乏诚信的供应商。</p> 
  <p>这些内容，你或多或少都在生活中经历过，当“去中心化”的口号响起的时候，人们终于找到了一个发泄口，强烈的共鸣放大了区块链的光环，造成了区块链能掀起一场大革新的错觉。</p> 
  <p>革新肯定是有的，但去中心化只是表象，如果我们加深层次去理解，就可以发现数字货币和数字资产带来更多的是交易效率的成倍提升。</p> 
  <p>人类的现代文明是建立在交易的基础上的，没有交易就意味着直接回到了农耕社会。所以交易效率的提升才是区块链的根本所在，那么说，区块链本来是这样看似低效的 TPS，为什么说它提高了交易效率呢？</p> 
  <p>我们先回到传统的交易模式来看一看。</p> 
  <p>交易首先是基于中心化平台的，当我们进入某个中心化平台，在这个平台内部，交易效率是提升了，但是我们回顾整个交易的生命周期，就会发现这个平台可能只是交易的一环，平台和平台之间的协作似乎并不是那么顺畅。</p> 
  <p>跨境支付便是典型的例子，市值长居 Top3 的区块链项目 Ripple 就是为了解决跨境支付的难题而产生的。</p> 
  <p>我们再来看区块链点对点的交易模式，它的 TPS 看似低效，但是它提供了全局无缝衔接的资产流转过程，这减少了整个交易生命周期的步骤，这也是区块链提升交易效率的关键所在。</p> 
  <p>所以说，虽然中心化系统能提供优秀的高性能服务，但是慢在人工审核、平台之间衔接、内部审计，平台之间的协作业务推进，想必你一定也深有体会。</p> 
  <h2 id="技术上的去中心化">技术上的去中心化</h2> 
  <p>我们在聊 DPOS 共识机制的时候，提到过一个 TPS 的计算公式，</p> 
  <p>TPS = (block_size network_bandwidth witness_performance) / <br> (block_time * witness_count)</p> 
  <p>其中 witness_count 记账节点的数目与准入门槛在业界的争议比较大，如果完全去中心化的话，首先就意味着记账节点没有准入门槛，记账的节点可以无限多，当然这只是一个理想环境，工程实施的可行性几乎为零。</p> 
  <p>比特币全球的全节点 1.2 万个，大大小小的挖矿节点只有几十个，常出块的只有 5 大矿池，但是比特币依然没有限制记账节点的准入门槛，以太坊也是如此。而在 EOS 中，既规定了记账节点的数目，又规定了门槛。</p> 
  <p>可以这么说，控制了记账节点的数量和准入门槛，就等于决定了区块链 TPS 的大小。</p> 
  <p>为了帮助你深层次地理解去中心化与 TPS 的关系，这时候我们再次回到之前一直提到的 CAP 定理中。</p> 
  <p>CAP 定理中，C为最终一致性，决定了出块时间的长短。A 是可用性，这个是必选的，必须要保证区块链 7 X 24 X 365 全部可用。</p> 
  <p>P 是网络分区容忍性，P 的含义在区块链上有两层，第一层是必须保证分区可容忍，也就是一旦出现因为网络分区而导致区块链分叉，必须有一种机制可以合并区块链；第二层含义是如果我们尽量避免出现网络分区，那么就可以避免 P 的出现，从而提升 C 的性能。</p> 
  <p>C 和 P 是可以相互调整的，有两种情况。</p> 
  <ul> 
   <li><p>情况 1，如果我们选则调整 C，也就是拉长了最终一致性的确认时间，那么对 P 的要求就会减弱，也就是网络产生分区不要紧，反正区块链有足够的时间恢复最终一致性。</p></li> 
   <li><p>情况 2，如果我们选则调整 P，也就是限制较少的记账节点的数量，并且对记账节点之间的带宽提出要求，降低出现网络分区的可能性，那么对 C 的要求就会减弱，就可以降低出块时间。</p></li> 
  </ul> 
  <p>情况 1 就是比特币和以太坊的典型思路，情况 2 就是 EOS 的典型思路。</p> 
  <p>区块链属于分布式系统，通过简单分析我们可以知道，区块链交易 TPS 与去中心化的具有不可调和性，任何一个号称 TPS 过万的区块链项目肯定是极其中心化的（至少技术上是的）。</p> 
  <p>所以，那些试图兼具高性能与去中心化的工作大多都是徒劳的。</p> 
  <h2 id="各个区块链的-tps-指标">各个区块链的 TPS 指标</h2> 
  <p><img src="https://upload-images.jianshu.io/upload_images/11336404-b41ce2812091bc19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="17.1.png" title=""></p> 
  <p>图中是 TPS 都在千笔以上的区块链项目，通过控制了记账节点的数量，牺牲了去中心化特性提升了 TPS，比如石墨烯系列的 DPOS，Ripple 的共识。</p> 
  <p>如果我们把 CAP 做一个可视化处理，就构建出来一个三角形分布，我们可以得到下图：</p> 
  <p><img src="https://upload-images.jianshu.io/upload_images/11336404-08990eebe1c95b57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="17.2.png" title=""></p> 
  <p>从图中我们可以看出，PoW、PoS 型公链偏好 AP 特性，于是 TPS 有限。联盟链以及 DPoS 型共识偏好比较均匀，可以达到可观的 TPS。</p> 
  <p>传统数据中心往往不考虑 P 在第二层语义上的问题，更不考虑拜占庭容错问题，所以他们拥有更好的 TPS，但是在网络分区和出现拜占庭错误的时候，表现得不尽如人意。</p> 
  <p>这些共识机制在不同场景中可以有不同的选择，不存在适用所有场景的的共识机制。</p> 
  <h2 id="业界的可选方案之一sharding-分片">业界的可选方案之一：Sharding 分片</h2> 
  <p>好了，我们在上文讨论了 CAP 定理对区块链的影响，那么业界也还是使出了浑身解数来尽可能地提升 TPS。</p> 
  <p>目前一共有两种正在讨论的方案，分别是 <strong>Sharding 分片技术</strong>和 <strong>闪电网络(不算侧链，侧链主要用于扩容)</strong> 。闪电网络旨在解决比特币微小额支付的实时性问题，其中的算法是比特币 TPS 扩展的一种<a href="https://mp.weixin.qq.com/s?__biz=MzI4MjIyNjM2Mg==&amp;mid=2247483881&amp;idx=1&amp;sn=96be8dce5ea4b94eaa9a86975724076a&amp;scene=19#wechat_redirect" rel="nofollow">方案</a>。</p> 
  <p><strong>这两种方案不涉及修改共识机制</strong>。如果我们修改为 <strong>DPoS 共识机制</strong>、<strong>DAG 共识算法</strong>，也可以提升 TPS，不过不在本篇的讨论范围。</p> 
  <p>分片技术是一种安装传统数据库分片的扩展，主要思路是将数据库分成多个分区（碎片）并将分区放置在不同的服务器上。</p> 
  <p>在区块链场景下，全网的节点相当于分布式数据库中的不同服务器，这时候 <strong>我们可以将交易分成不同的部分，然后每个记账节点只需要验证交易的一部分即可，而不必验证完整的交易性</strong> 。</p> 
  <p>这带来的好处是就是 <strong>并行化处理，记账节点之间相当于是协作关系，而不再是单纯的独立关系</strong>。</p> 
  <p>随着网络的增长，这种协作关系也可以随之扩展，这种扩展也叫做水平扩容。</p> 
  <p><strong>分片技术有以下优势：首先是 TPS 可以从十几笔提升至少两个数量级，也就是千笔每秒，这不但对应用友好，也提升了用户体验；其次 TPS 的提升可以带来更多应用，这些应用在共识的激励下可以水平扩展区块链的性能，形成一种良性循环。</strong></p> 
  <p>下面我介绍一下分片的两种方案：状态分片、网络分片。</p> 
  <p>第一种方案是是网络分片，网络分片是我们按照网络进行分区，区域内的交易归集在一起并在区域内进行验证，这样区域内的用户可以享受低延迟高吞吐的 TPS，但是会带来跨区域分片的复杂性。我们也可以将网络分片比喻成数据库集群分区。</p> 
  <p>其次是状态分片，状态分片是在以太坊上提出的方案，状态分片目前没有确切的技术方案，尚在研究讨论阶段。</p> 
  <p>我们可以简单类比数据库的分表。我们将同一张表的数据塞到不同的节点，这些节点分布在全世界各地并且没有可信的网络环境。所以状态分片是非常复杂的技术，实践的最终结果我们需要看以太坊后续的动作。</p> 
  <hr> 
  <p>上一篇：<a href="https://github.com/yjjnls/blockchain-tutorial-cn/blob/master/doc/16.%E6%B7%B1%E5%85%A5%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%EF%BC%88%E5%85%AB%EF%BC%89%EF%BC%9AUTXO%E4%B8%8E%E6%99%AE%E9%80%9A%E8%B4%A6%E6%88%B7%E6%A8%A1%E5%9E%8B.md" rel="nofollow">深入区块链技术（八）：UTXO与普通账户模型</a> 下一篇：<a href="https://github.com/yjjnls/blockchain-tutorial-cn/blob/master/doc/18.%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E4%B8%8E%E4%BB%A5%E5%A4%AA%E5%9D%8A.md" rel="nofollow">智能合约与以太坊</a> </p> 
  <p>完整区块链教程：<a href="https://github.com/yjjnls/blockchain-tutorial-cn" rel="nofollow">《深入浅出区块链》</a> 欢迎star和fork。</p> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yjjnls/article/details/81474473,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yjjnls/article/details/81474473,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
