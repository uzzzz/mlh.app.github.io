<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>alipay.trade.refund(统一收单交易退款接口) | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="alipay.trade.refund(统一收单交易退款接口)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="转载&nbsp;https://blog.csdn.net/a369405354/article/details/79385819 当交易发生之后一段时间内，由于买家或者卖家的原因需要退款时，卖家可以通过退款接口将支付款退还给买家，支付宝将在收到退款请求并且验证成功之后，按照退款规则将支付款按原路退到买家帐号上。 交易超过约定时间（签约时设置的可退款时间）的订单无法进行退款 支付宝退款支持单笔交易分多次退款，多次退款需要提交原支付订单的商户订单号和设置不同的退款单号。一笔退款失败后重新提交，要采用原来的退款单号。总退款金额不能超过用户实际支付金额 公共参数 请求地址 环境 HTTPS请求地址 正式环境 https://openapi.alipay.com/gateway.do 公共请求参数 参数 类型 是否必填 最大长度 描述 示例值 app_id String 是 32 支付宝分配给开发者的应用ID 2014072300007148 method String 是 128 接口名称 alipay.trade.refund format String 否 40 仅支持JSON JSON charset String 是 10 请求使用的编码格式，如utf-8,gbk,gb2312等 utf-8 sign_type String 是 10 商户生成签名字符串所使用的签名算法类型，目前支持RSA2和RSA，推荐使用RSA2 RSA2 sign String 是 344 商户请求参数的签名串，详见签名 详见示例 timestamp String 是 19 发送请求的时间，格式&quot;yyyy-MM-dd HH:mm:ss&quot; 2014-07-24 03:07:50 version String 是 3 调用的接口版本，固定为：1.0 1.0 app_auth_token String 否 40 详见应用授权概述 &nbsp; biz_content String 是 &nbsp; 请求参数的集合，最大长度不限，除公共参数外所有请求参数都必须放在这个参数中传递，具体参照各产品快速接入文档 &nbsp; 请求参数 参数 类型 是否必填 最大长度 描述 示例值 out_trade_no String 特殊可选 64 订单支付时传入的商户订单号,不能和 trade_no同时为空。 20150320010101001 trade_no String 特殊可选 64 支付宝交易号，和商户订单号不能同时为空 2014112611001004680073956707 refund_amount Price 必选 9 需要退款的金额，该金额不能大于订单金额,单位为元，支持两位小数 200.12 refund_reason String 可选 256 退款的原因说明 正常退款 out_request_no String 可选 64 标识一次退款请求，同一笔交易多次退款需要保证唯一，如需部分退款，则此参数必传。 HZ01RF001 operator_id String 可选 30 商户的操作员编号 OP001 store_id String 可选 32 商户的门店编号 NJ_S_001 terminal_id String 可选 32 商户的终端编号 NJ_T_001 &nbsp;goods_detail GoodsDetail[] 可选 &nbsp; 退款包含的商品列表信息，Json格式。&nbsp; 其它说明详见：“商品明细说明” &nbsp; 公共响应参数 参数 类型 是否必填 最大长度 描述 示例值 code String 是 - 网关返回码,详见文档 40004 msg String 是 - 网关返回码描述,详见文档 Business Failed sub_code String 否 - 业务返回码，参见具体的API接口文档 ACQ.TRADE_HAS_SUCCESS sub_msg String 否 - 业务返回码描述，参见具体的API接口文档 交易已被支付 sign String 是 - 签名,详见文档 DZXh8eeTuAHoYE3w1J+POiPhfDxOYBfUNn1lkeT/V7P4zJdyojWEa6IZs6Hz0yDW5Cp/viufUb5I0/V5WENS3OYR8zRedqo6D+fUTdLHdc+EFyCkiQhBxIzgngPdPdfp1PIS7BdhhzrsZHbRqb7o4k3Dxc+AAnFauu4V6Zdwczo= 响应参数 参数 类型 是否必填 最大长度 描述 示例值 trade_no String 必填 64 2013112011001004330000121536 支付宝交易号 out_trade_no String 必填 64 商户订单号 6823789339978248 buyer_logon_id String 必填 100 用户的登录id 159****5620 fund_change String 必填 1 本次退款是否发生了资金变化 Y refund_fee Price 必填 11 退款总金额 88.88 gmt_refund_pay Date 必填 32 退款支付时间 2014-11-27 15:45:57 refund_detail_item_list TradeFundBill 选填 &nbsp; 退款使用的资金渠道 &nbsp; store_name String 选填 512 交易在支付时候的门店名称 望湘园联洋店 buyer_user_id String 必填 28 买家在支付宝的用户id 2088101117955611 present_refund_buyer_amount String 选填 11 本次退款金额中买家退款金额 88.88 present_refund_discount_amount String 选填 11 本次退款金额中平台优惠退款金额 88.88 present_refund_mdiscount_amount String 选填 11 本次退款金额中商家优惠退款金额 88.88 请求示例 JAVA&nbsp; .NET&nbsp; PHP&nbsp; HTTP请求源码 &nbsp; $aop = new AopClient (); $aop-&gt;gatewayUrl = &#39;https://openapi.alipay.com/gateway.do&#39;; $aop-&gt;appId = &#39;your app_id&#39;; $aop-&gt;rsaPrivateKey = &#39;请填写开发者私钥去头去尾去回车，一行字符串&#39;; $aop-&gt;alipayrsaPublicKey=&#39;请填写支付宝公钥，一行字符串&#39;; $aop-&gt;apiVersion = &#39;1.0&#39;; $aop-&gt;signType = &#39;RSA2&#39;; $aop-&gt;postCharset=&#39;GBK&#39;; $aop-&gt;format=&#39;json&#39;; $request = new AlipayTradeRefundRequest (); $request-&gt;setBizContent(&quot;{&quot; . &quot;\&quot;out_trade_no\&quot;:\&quot;20150320010101001\&quot;,&quot; . &quot;\&quot;trade_no\&quot;:\&quot;2014112611001004680073956707\&quot;,&quot; . &quot;\&quot;refund_amount\&quot;:200.12,&quot; . &quot;\&quot;refund_currency\&quot;:\&quot;USD\&quot;,&quot; . &quot;\&quot;refund_reason\&quot;:\&quot;正常退款\&quot;,&quot; . &quot;\&quot;out_request_no\&quot;:\&quot;HZ01RF001\&quot;,&quot; . &quot;\&quot;operator_id\&quot;:\&quot;OP001\&quot;,&quot; . &quot;\&quot;store_id\&quot;:\&quot;NJ_S_001\&quot;,&quot; . &quot;\&quot;terminal_id\&quot;:\&quot;NJ_T_001\&quot;,&quot; . &quot; \&quot;goods_detail\&quot;:[{&quot; . &quot; \&quot;goods_id\&quot;:\&quot;apple-01\&quot;,&quot; . &quot;\&quot;alipay_goods_id\&quot;:\&quot;20010001\&quot;,&quot; . &quot;\&quot;goods_name\&quot;:\&quot;ipad\&quot;,&quot; . &quot;\&quot;quantity\&quot;:1,&quot; . &quot;\&quot;price\&quot;:2000,&quot; . &quot;\&quot;goods_category\&quot;:\&quot;34543238\&quot;,&quot; . &quot;\&quot;body\&quot;:\&quot;特价手机\&quot;,&quot; . &quot;\&quot;show_url\&quot;:\&quot;http://www.alipay.com/xxx.jpg\&quot;&quot; . &quot; }]&quot; . &quot; }&quot;); $result = $aop-&gt;execute ( $request); &nbsp; $responseNode = str_replace(&quot;.&quot;, &quot;_&quot;, $request-&gt;getApiMethodName()) . &quot;_response&quot;; $resultCode = $result-&gt;$responseNode-&gt;code; if(!empty($resultCode)&amp;&amp;$resultCode == 10000){ echo &quot;成功&quot;; } else { echo &quot;失败&quot;; } 响应示例 JSON 示例&nbsp; XML 示例 &nbsp; { &quot;alipay_trade_refund_response&quot;: { &quot;code&quot;: &quot;10000&quot;, &quot;msg&quot;: &quot;Success&quot;, &quot;trade_no&quot;: &quot;支付宝交易号&quot;, &quot;out_trade_no&quot;: &quot;6823789339978248&quot;, &quot;buyer_logon_id&quot;: &quot;159****5620&quot;, &quot;fund_change&quot;: &quot;Y&quot;, &quot;refund_fee&quot;: 88.88, &quot;gmt_refund_pay&quot;: &quot;2014-11-27 15:45:57&quot;, &quot;refund_detail_item_list&quot;: [ { &quot;fund_channel&quot;: &quot;ALIPAYACCOUNT&quot;, &quot;bank_code&quot;: &quot;CEB&quot;, &quot;amount&quot;: 10, &quot;real_amount&quot;: 11.21, &quot;fund_type&quot;: &quot;DEBIT_CARD&quot; } ], &quot;store_name&quot;: &quot;望湘园联洋店&quot;, &quot;buyer_user_id&quot;: &quot;2088101117955611&quot;, &quot;present_refund_buyer_amount&quot;: &quot;88.88&quot;, &quot;present_refund_discount_amount&quot;: &quot;88.88&quot;, &quot;present_refund_mdiscount_amount&quot;: &quot;88.88&quot; }, &quot;sign&quot;: &quot;ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE&quot; } 异常示例 JSON 示例 &nbsp; { &quot;alipay_trade_refund_response&quot;: { &quot;code&quot;: &quot;20000&quot;, &quot;msg&quot;: &quot;Service Currently Unavailable&quot;, &quot;sub_code&quot;: &quot;isp.unknow-error&quot;, &quot;sub_msg&quot;: &quot;系统繁忙&quot; }, &quot;sign&quot;: &quot;ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE&quot; } 业务错误码 公共错误码 错误码 错误描述 解决方案 ACQ.SYSTEM_ERROR 系统错误 请使用相同的参数再次调用 ACQ.INVALID_PARAMETER 参数无效 请求参数有错，重新检查请求后，再调用退款 ACQ.SELLER_BALANCE_NOT_ENOUGH 卖家余额不足 商户支付宝账户充值后重新发起退款即可 ACQ.REFUND_AMT_NOT_EQUAL_TOTAL 退款金额超限 检查退款金额是否正确，重新修改请求后，重新发起退款 ACQ.REASON_TRADE_BEEN_FREEZEN 请求退款的交易被冻结 联系支付宝小二，确认该笔交易的具体情况 ACQ.TRADE_NOT_EXIST 交易不存在 检查请求中的交易号和商户订单号是否正确，确认后重新发起 ACQ.TRADE_HAS_FINISHED 交易已完结 该交易已完结，不允许进行退款，确认请求的退款的交易信息是否正确 ACQ.TRADE_STATUS_ERROR 交易状态非法 查询交易，确认交易是否已经付款 ACQ.DISCORDANT_REPEAT_REQUEST 不一致的请求 检查该退款号是否已退过款或更换退款号重新发起请求 ACQ.REASON_TRADE_REFUND_FEE_ERR 退款金额无效 检查退款请求的金额是否正确 ACQ.TRADE_NOT_ALLOW_REFUND 当前交易不允许退款 检查当前交易的状态是否为交易成功状态以及签约的退款属性是否允许退款，确认后，重新发起请求 阅读更多" />
<meta property="og:description" content="转载&nbsp;https://blog.csdn.net/a369405354/article/details/79385819 当交易发生之后一段时间内，由于买家或者卖家的原因需要退款时，卖家可以通过退款接口将支付款退还给买家，支付宝将在收到退款请求并且验证成功之后，按照退款规则将支付款按原路退到买家帐号上。 交易超过约定时间（签约时设置的可退款时间）的订单无法进行退款 支付宝退款支持单笔交易分多次退款，多次退款需要提交原支付订单的商户订单号和设置不同的退款单号。一笔退款失败后重新提交，要采用原来的退款单号。总退款金额不能超过用户实际支付金额 公共参数 请求地址 环境 HTTPS请求地址 正式环境 https://openapi.alipay.com/gateway.do 公共请求参数 参数 类型 是否必填 最大长度 描述 示例值 app_id String 是 32 支付宝分配给开发者的应用ID 2014072300007148 method String 是 128 接口名称 alipay.trade.refund format String 否 40 仅支持JSON JSON charset String 是 10 请求使用的编码格式，如utf-8,gbk,gb2312等 utf-8 sign_type String 是 10 商户生成签名字符串所使用的签名算法类型，目前支持RSA2和RSA，推荐使用RSA2 RSA2 sign String 是 344 商户请求参数的签名串，详见签名 详见示例 timestamp String 是 19 发送请求的时间，格式&quot;yyyy-MM-dd HH:mm:ss&quot; 2014-07-24 03:07:50 version String 是 3 调用的接口版本，固定为：1.0 1.0 app_auth_token String 否 40 详见应用授权概述 &nbsp; biz_content String 是 &nbsp; 请求参数的集合，最大长度不限，除公共参数外所有请求参数都必须放在这个参数中传递，具体参照各产品快速接入文档 &nbsp; 请求参数 参数 类型 是否必填 最大长度 描述 示例值 out_trade_no String 特殊可选 64 订单支付时传入的商户订单号,不能和 trade_no同时为空。 20150320010101001 trade_no String 特殊可选 64 支付宝交易号，和商户订单号不能同时为空 2014112611001004680073956707 refund_amount Price 必选 9 需要退款的金额，该金额不能大于订单金额,单位为元，支持两位小数 200.12 refund_reason String 可选 256 退款的原因说明 正常退款 out_request_no String 可选 64 标识一次退款请求，同一笔交易多次退款需要保证唯一，如需部分退款，则此参数必传。 HZ01RF001 operator_id String 可选 30 商户的操作员编号 OP001 store_id String 可选 32 商户的门店编号 NJ_S_001 terminal_id String 可选 32 商户的终端编号 NJ_T_001 &nbsp;goods_detail GoodsDetail[] 可选 &nbsp; 退款包含的商品列表信息，Json格式。&nbsp; 其它说明详见：“商品明细说明” &nbsp; 公共响应参数 参数 类型 是否必填 最大长度 描述 示例值 code String 是 - 网关返回码,详见文档 40004 msg String 是 - 网关返回码描述,详见文档 Business Failed sub_code String 否 - 业务返回码，参见具体的API接口文档 ACQ.TRADE_HAS_SUCCESS sub_msg String 否 - 业务返回码描述，参见具体的API接口文档 交易已被支付 sign String 是 - 签名,详见文档 DZXh8eeTuAHoYE3w1J+POiPhfDxOYBfUNn1lkeT/V7P4zJdyojWEa6IZs6Hz0yDW5Cp/viufUb5I0/V5WENS3OYR8zRedqo6D+fUTdLHdc+EFyCkiQhBxIzgngPdPdfp1PIS7BdhhzrsZHbRqb7o4k3Dxc+AAnFauu4V6Zdwczo= 响应参数 参数 类型 是否必填 最大长度 描述 示例值 trade_no String 必填 64 2013112011001004330000121536 支付宝交易号 out_trade_no String 必填 64 商户订单号 6823789339978248 buyer_logon_id String 必填 100 用户的登录id 159****5620 fund_change String 必填 1 本次退款是否发生了资金变化 Y refund_fee Price 必填 11 退款总金额 88.88 gmt_refund_pay Date 必填 32 退款支付时间 2014-11-27 15:45:57 refund_detail_item_list TradeFundBill 选填 &nbsp; 退款使用的资金渠道 &nbsp; store_name String 选填 512 交易在支付时候的门店名称 望湘园联洋店 buyer_user_id String 必填 28 买家在支付宝的用户id 2088101117955611 present_refund_buyer_amount String 选填 11 本次退款金额中买家退款金额 88.88 present_refund_discount_amount String 选填 11 本次退款金额中平台优惠退款金额 88.88 present_refund_mdiscount_amount String 选填 11 本次退款金额中商家优惠退款金额 88.88 请求示例 JAVA&nbsp; .NET&nbsp; PHP&nbsp; HTTP请求源码 &nbsp; $aop = new AopClient (); $aop-&gt;gatewayUrl = &#39;https://openapi.alipay.com/gateway.do&#39;; $aop-&gt;appId = &#39;your app_id&#39;; $aop-&gt;rsaPrivateKey = &#39;请填写开发者私钥去头去尾去回车，一行字符串&#39;; $aop-&gt;alipayrsaPublicKey=&#39;请填写支付宝公钥，一行字符串&#39;; $aop-&gt;apiVersion = &#39;1.0&#39;; $aop-&gt;signType = &#39;RSA2&#39;; $aop-&gt;postCharset=&#39;GBK&#39;; $aop-&gt;format=&#39;json&#39;; $request = new AlipayTradeRefundRequest (); $request-&gt;setBizContent(&quot;{&quot; . &quot;\&quot;out_trade_no\&quot;:\&quot;20150320010101001\&quot;,&quot; . &quot;\&quot;trade_no\&quot;:\&quot;2014112611001004680073956707\&quot;,&quot; . &quot;\&quot;refund_amount\&quot;:200.12,&quot; . &quot;\&quot;refund_currency\&quot;:\&quot;USD\&quot;,&quot; . &quot;\&quot;refund_reason\&quot;:\&quot;正常退款\&quot;,&quot; . &quot;\&quot;out_request_no\&quot;:\&quot;HZ01RF001\&quot;,&quot; . &quot;\&quot;operator_id\&quot;:\&quot;OP001\&quot;,&quot; . &quot;\&quot;store_id\&quot;:\&quot;NJ_S_001\&quot;,&quot; . &quot;\&quot;terminal_id\&quot;:\&quot;NJ_T_001\&quot;,&quot; . &quot; \&quot;goods_detail\&quot;:[{&quot; . &quot; \&quot;goods_id\&quot;:\&quot;apple-01\&quot;,&quot; . &quot;\&quot;alipay_goods_id\&quot;:\&quot;20010001\&quot;,&quot; . &quot;\&quot;goods_name\&quot;:\&quot;ipad\&quot;,&quot; . &quot;\&quot;quantity\&quot;:1,&quot; . &quot;\&quot;price\&quot;:2000,&quot; . &quot;\&quot;goods_category\&quot;:\&quot;34543238\&quot;,&quot; . &quot;\&quot;body\&quot;:\&quot;特价手机\&quot;,&quot; . &quot;\&quot;show_url\&quot;:\&quot;http://www.alipay.com/xxx.jpg\&quot;&quot; . &quot; }]&quot; . &quot; }&quot;); $result = $aop-&gt;execute ( $request); &nbsp; $responseNode = str_replace(&quot;.&quot;, &quot;_&quot;, $request-&gt;getApiMethodName()) . &quot;_response&quot;; $resultCode = $result-&gt;$responseNode-&gt;code; if(!empty($resultCode)&amp;&amp;$resultCode == 10000){ echo &quot;成功&quot;; } else { echo &quot;失败&quot;; } 响应示例 JSON 示例&nbsp; XML 示例 &nbsp; { &quot;alipay_trade_refund_response&quot;: { &quot;code&quot;: &quot;10000&quot;, &quot;msg&quot;: &quot;Success&quot;, &quot;trade_no&quot;: &quot;支付宝交易号&quot;, &quot;out_trade_no&quot;: &quot;6823789339978248&quot;, &quot;buyer_logon_id&quot;: &quot;159****5620&quot;, &quot;fund_change&quot;: &quot;Y&quot;, &quot;refund_fee&quot;: 88.88, &quot;gmt_refund_pay&quot;: &quot;2014-11-27 15:45:57&quot;, &quot;refund_detail_item_list&quot;: [ { &quot;fund_channel&quot;: &quot;ALIPAYACCOUNT&quot;, &quot;bank_code&quot;: &quot;CEB&quot;, &quot;amount&quot;: 10, &quot;real_amount&quot;: 11.21, &quot;fund_type&quot;: &quot;DEBIT_CARD&quot; } ], &quot;store_name&quot;: &quot;望湘园联洋店&quot;, &quot;buyer_user_id&quot;: &quot;2088101117955611&quot;, &quot;present_refund_buyer_amount&quot;: &quot;88.88&quot;, &quot;present_refund_discount_amount&quot;: &quot;88.88&quot;, &quot;present_refund_mdiscount_amount&quot;: &quot;88.88&quot; }, &quot;sign&quot;: &quot;ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE&quot; } 异常示例 JSON 示例 &nbsp; { &quot;alipay_trade_refund_response&quot;: { &quot;code&quot;: &quot;20000&quot;, &quot;msg&quot;: &quot;Service Currently Unavailable&quot;, &quot;sub_code&quot;: &quot;isp.unknow-error&quot;, &quot;sub_msg&quot;: &quot;系统繁忙&quot; }, &quot;sign&quot;: &quot;ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE&quot; } 业务错误码 公共错误码 错误码 错误描述 解决方案 ACQ.SYSTEM_ERROR 系统错误 请使用相同的参数再次调用 ACQ.INVALID_PARAMETER 参数无效 请求参数有错，重新检查请求后，再调用退款 ACQ.SELLER_BALANCE_NOT_ENOUGH 卖家余额不足 商户支付宝账户充值后重新发起退款即可 ACQ.REFUND_AMT_NOT_EQUAL_TOTAL 退款金额超限 检查退款金额是否正确，重新修改请求后，重新发起退款 ACQ.REASON_TRADE_BEEN_FREEZEN 请求退款的交易被冻结 联系支付宝小二，确认该笔交易的具体情况 ACQ.TRADE_NOT_EXIST 交易不存在 检查请求中的交易号和商户订单号是否正确，确认后重新发起 ACQ.TRADE_HAS_FINISHED 交易已完结 该交易已完结，不允许进行退款，确认请求的退款的交易信息是否正确 ACQ.TRADE_STATUS_ERROR 交易状态非法 查询交易，确认交易是否已经付款 ACQ.DISCORDANT_REPEAT_REQUEST 不一致的请求 检查该退款号是否已退过款或更换退款号重新发起请求 ACQ.REASON_TRADE_REFUND_FEE_ERR 退款金额无效 检查退款请求的金额是否正确 ACQ.TRADE_NOT_ALLOW_REFUND 当前交易不允许退款 检查当前交易的状态是否为交易成功状态以及签约的退款属性是否允许退款，确认后，重新发起请求 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-15T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"转载&nbsp;https://blog.csdn.net/a369405354/article/details/79385819 当交易发生之后一段时间内，由于买家或者卖家的原因需要退款时，卖家可以通过退款接口将支付款退还给买家，支付宝将在收到退款请求并且验证成功之后，按照退款规则将支付款按原路退到买家帐号上。 交易超过约定时间（签约时设置的可退款时间）的订单无法进行退款 支付宝退款支持单笔交易分多次退款，多次退款需要提交原支付订单的商户订单号和设置不同的退款单号。一笔退款失败后重新提交，要采用原来的退款单号。总退款金额不能超过用户实际支付金额 公共参数 请求地址 环境 HTTPS请求地址 正式环境 https://openapi.alipay.com/gateway.do 公共请求参数 参数 类型 是否必填 最大长度 描述 示例值 app_id String 是 32 支付宝分配给开发者的应用ID 2014072300007148 method String 是 128 接口名称 alipay.trade.refund format String 否 40 仅支持JSON JSON charset String 是 10 请求使用的编码格式，如utf-8,gbk,gb2312等 utf-8 sign_type String 是 10 商户生成签名字符串所使用的签名算法类型，目前支持RSA2和RSA，推荐使用RSA2 RSA2 sign String 是 344 商户请求参数的签名串，详见签名 详见示例 timestamp String 是 19 发送请求的时间，格式&quot;yyyy-MM-dd HH:mm:ss&quot; 2014-07-24 03:07:50 version String 是 3 调用的接口版本，固定为：1.0 1.0 app_auth_token String 否 40 详见应用授权概述 &nbsp; biz_content String 是 &nbsp; 请求参数的集合，最大长度不限，除公共参数外所有请求参数都必须放在这个参数中传递，具体参照各产品快速接入文档 &nbsp; 请求参数 参数 类型 是否必填 最大长度 描述 示例值 out_trade_no String 特殊可选 64 订单支付时传入的商户订单号,不能和 trade_no同时为空。 20150320010101001 trade_no String 特殊可选 64 支付宝交易号，和商户订单号不能同时为空 2014112611001004680073956707 refund_amount Price 必选 9 需要退款的金额，该金额不能大于订单金额,单位为元，支持两位小数 200.12 refund_reason String 可选 256 退款的原因说明 正常退款 out_request_no String 可选 64 标识一次退款请求，同一笔交易多次退款需要保证唯一，如需部分退款，则此参数必传。 HZ01RF001 operator_id String 可选 30 商户的操作员编号 OP001 store_id String 可选 32 商户的门店编号 NJ_S_001 terminal_id String 可选 32 商户的终端编号 NJ_T_001 &nbsp;goods_detail GoodsDetail[] 可选 &nbsp; 退款包含的商品列表信息，Json格式。&nbsp; 其它说明详见：“商品明细说明” &nbsp; 公共响应参数 参数 类型 是否必填 最大长度 描述 示例值 code String 是 - 网关返回码,详见文档 40004 msg String 是 - 网关返回码描述,详见文档 Business Failed sub_code String 否 - 业务返回码，参见具体的API接口文档 ACQ.TRADE_HAS_SUCCESS sub_msg String 否 - 业务返回码描述，参见具体的API接口文档 交易已被支付 sign String 是 - 签名,详见文档 DZXh8eeTuAHoYE3w1J+POiPhfDxOYBfUNn1lkeT/V7P4zJdyojWEa6IZs6Hz0yDW5Cp/viufUb5I0/V5WENS3OYR8zRedqo6D+fUTdLHdc+EFyCkiQhBxIzgngPdPdfp1PIS7BdhhzrsZHbRqb7o4k3Dxc+AAnFauu4V6Zdwczo= 响应参数 参数 类型 是否必填 最大长度 描述 示例值 trade_no String 必填 64 2013112011001004330000121536 支付宝交易号 out_trade_no String 必填 64 商户订单号 6823789339978248 buyer_logon_id String 必填 100 用户的登录id 159****5620 fund_change String 必填 1 本次退款是否发生了资金变化 Y refund_fee Price 必填 11 退款总金额 88.88 gmt_refund_pay Date 必填 32 退款支付时间 2014-11-27 15:45:57 refund_detail_item_list TradeFundBill 选填 &nbsp; 退款使用的资金渠道 &nbsp; store_name String 选填 512 交易在支付时候的门店名称 望湘园联洋店 buyer_user_id String 必填 28 买家在支付宝的用户id 2088101117955611 present_refund_buyer_amount String 选填 11 本次退款金额中买家退款金额 88.88 present_refund_discount_amount String 选填 11 本次退款金额中平台优惠退款金额 88.88 present_refund_mdiscount_amount String 选填 11 本次退款金额中商家优惠退款金额 88.88 请求示例 JAVA&nbsp; .NET&nbsp; PHP&nbsp; HTTP请求源码 &nbsp; $aop = new AopClient (); $aop-&gt;gatewayUrl = &#39;https://openapi.alipay.com/gateway.do&#39;; $aop-&gt;appId = &#39;your app_id&#39;; $aop-&gt;rsaPrivateKey = &#39;请填写开发者私钥去头去尾去回车，一行字符串&#39;; $aop-&gt;alipayrsaPublicKey=&#39;请填写支付宝公钥，一行字符串&#39;; $aop-&gt;apiVersion = &#39;1.0&#39;; $aop-&gt;signType = &#39;RSA2&#39;; $aop-&gt;postCharset=&#39;GBK&#39;; $aop-&gt;format=&#39;json&#39;; $request = new AlipayTradeRefundRequest (); $request-&gt;setBizContent(&quot;{&quot; . &quot;\\&quot;out_trade_no\\&quot;:\\&quot;20150320010101001\\&quot;,&quot; . &quot;\\&quot;trade_no\\&quot;:\\&quot;2014112611001004680073956707\\&quot;,&quot; . &quot;\\&quot;refund_amount\\&quot;:200.12,&quot; . &quot;\\&quot;refund_currency\\&quot;:\\&quot;USD\\&quot;,&quot; . &quot;\\&quot;refund_reason\\&quot;:\\&quot;正常退款\\&quot;,&quot; . &quot;\\&quot;out_request_no\\&quot;:\\&quot;HZ01RF001\\&quot;,&quot; . &quot;\\&quot;operator_id\\&quot;:\\&quot;OP001\\&quot;,&quot; . &quot;\\&quot;store_id\\&quot;:\\&quot;NJ_S_001\\&quot;,&quot; . &quot;\\&quot;terminal_id\\&quot;:\\&quot;NJ_T_001\\&quot;,&quot; . &quot; \\&quot;goods_detail\\&quot;:[{&quot; . &quot; \\&quot;goods_id\\&quot;:\\&quot;apple-01\\&quot;,&quot; . &quot;\\&quot;alipay_goods_id\\&quot;:\\&quot;20010001\\&quot;,&quot; . &quot;\\&quot;goods_name\\&quot;:\\&quot;ipad\\&quot;,&quot; . &quot;\\&quot;quantity\\&quot;:1,&quot; . &quot;\\&quot;price\\&quot;:2000,&quot; . &quot;\\&quot;goods_category\\&quot;:\\&quot;34543238\\&quot;,&quot; . &quot;\\&quot;body\\&quot;:\\&quot;特价手机\\&quot;,&quot; . &quot;\\&quot;show_url\\&quot;:\\&quot;http://www.alipay.com/xxx.jpg\\&quot;&quot; . &quot; }]&quot; . &quot; }&quot;); $result = $aop-&gt;execute ( $request); &nbsp; $responseNode = str_replace(&quot;.&quot;, &quot;_&quot;, $request-&gt;getApiMethodName()) . &quot;_response&quot;; $resultCode = $result-&gt;$responseNode-&gt;code; if(!empty($resultCode)&amp;&amp;$resultCode == 10000){ echo &quot;成功&quot;; } else { echo &quot;失败&quot;; } 响应示例 JSON 示例&nbsp; XML 示例 &nbsp; { &quot;alipay_trade_refund_response&quot;: { &quot;code&quot;: &quot;10000&quot;, &quot;msg&quot;: &quot;Success&quot;, &quot;trade_no&quot;: &quot;支付宝交易号&quot;, &quot;out_trade_no&quot;: &quot;6823789339978248&quot;, &quot;buyer_logon_id&quot;: &quot;159****5620&quot;, &quot;fund_change&quot;: &quot;Y&quot;, &quot;refund_fee&quot;: 88.88, &quot;gmt_refund_pay&quot;: &quot;2014-11-27 15:45:57&quot;, &quot;refund_detail_item_list&quot;: [ { &quot;fund_channel&quot;: &quot;ALIPAYACCOUNT&quot;, &quot;bank_code&quot;: &quot;CEB&quot;, &quot;amount&quot;: 10, &quot;real_amount&quot;: 11.21, &quot;fund_type&quot;: &quot;DEBIT_CARD&quot; } ], &quot;store_name&quot;: &quot;望湘园联洋店&quot;, &quot;buyer_user_id&quot;: &quot;2088101117955611&quot;, &quot;present_refund_buyer_amount&quot;: &quot;88.88&quot;, &quot;present_refund_discount_amount&quot;: &quot;88.88&quot;, &quot;present_refund_mdiscount_amount&quot;: &quot;88.88&quot; }, &quot;sign&quot;: &quot;ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE&quot; } 异常示例 JSON 示例 &nbsp; { &quot;alipay_trade_refund_response&quot;: { &quot;code&quot;: &quot;20000&quot;, &quot;msg&quot;: &quot;Service Currently Unavailable&quot;, &quot;sub_code&quot;: &quot;isp.unknow-error&quot;, &quot;sub_msg&quot;: &quot;系统繁忙&quot; }, &quot;sign&quot;: &quot;ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE&quot; } 业务错误码 公共错误码 错误码 错误描述 解决方案 ACQ.SYSTEM_ERROR 系统错误 请使用相同的参数再次调用 ACQ.INVALID_PARAMETER 参数无效 请求参数有错，重新检查请求后，再调用退款 ACQ.SELLER_BALANCE_NOT_ENOUGH 卖家余额不足 商户支付宝账户充值后重新发起退款即可 ACQ.REFUND_AMT_NOT_EQUAL_TOTAL 退款金额超限 检查退款金额是否正确，重新修改请求后，重新发起退款 ACQ.REASON_TRADE_BEEN_FREEZEN 请求退款的交易被冻结 联系支付宝小二，确认该笔交易的具体情况 ACQ.TRADE_NOT_EXIST 交易不存在 检查请求中的交易号和商户订单号是否正确，确认后重新发起 ACQ.TRADE_HAS_FINISHED 交易已完结 该交易已完结，不允许进行退款，确认请求的退款的交易信息是否正确 ACQ.TRADE_STATUS_ERROR 交易状态非法 查询交易，确认交易是否已经付款 ACQ.DISCORDANT_REPEAT_REQUEST 不一致的请求 检查该退款号是否已退过款或更换退款号重新发起请求 ACQ.REASON_TRADE_REFUND_FEE_ERR 退款金额无效 检查退款请求的金额是否正确 ACQ.TRADE_NOT_ALLOW_REFUND 当前交易不允许退款 检查当前交易的状态是否为交易成功状态以及签约的退款属性是否允许退款，确认后，重新发起请求 阅读更多","@type":"BlogPosting","url":"/2018/08/15/1cc5d57cd6f6180fb511a83d24518f41.html","headline":"alipay.trade.refund(统一收单交易退款接口)","dateModified":"2018-08-15T00:00:00+08:00","datePublished":"2018-08-15T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/08/15/1cc5d57cd6f6180fb511a83d24518f41.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>alipay.trade.refund(统一收单交易退款接口)</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>转载&nbsp;<a href="https://blog.csdn.net/a369405354/article/details/79385819" rel="nofollow">https://blog.csdn.net/a369405354/article/details/79385819</a></p> 
  <p>当交易发生之后一段时间内，由于买家或者卖家的原因需要退款时，卖家可以通过退款接口将支付款退还给买家，支付宝将在收到退款请求并且验证成功之后，按照退款规则将支付款按原路退到买家帐号上。 交易超过约定时间（签约时设置的可退款时间）的订单无法进行退款 支付宝退款支持单笔交易分多次退款，多次退款需要提交原支付订单的商户订单号和设置不同的退款单号。一笔退款失败后重新提交，要采用原来的退款单号。总退款金额不能超过用户实际支付金额</p> 
  <h2><a name="t0"></a>公共参数</h2> 
  <h3><a name="t1"></a>请求地址</h3> 
  <table>
   <tbody>
    <tr>
     <th>环境</th> 
     <th>HTTPS请求地址</th> 
    </tr>
    <tr>
     <td>正式环境</td> 
     <td>https://openapi.alipay.com/gateway.do</td> 
    </tr>
   </tbody>
  </table>
  <h3><a name="t2"></a>公共请求参数</h3> 
  <table>
   <tbody>
    <tr>
     <th>参数</th> 
     <th>类型</th> 
     <th>是否必填</th> 
     <th>最大长度</th> 
     <th>描述</th> 
     <th>示例值</th> 
    </tr>
    <tr>
     <td>app_id</td> 
     <td>String</td> 
     <td>是</td> 
     <td>32</td> 
     <td>支付宝分配给开发者的应用ID</td> 
     <td>2014072300007148</td> 
    </tr>
    <tr>
     <td>method</td> 
     <td>String</td> 
     <td>是</td> 
     <td>128</td> 
     <td>接口名称</td> 
     <td>alipay.trade.refund</td> 
    </tr>
    <tr>
     <td>format</td> 
     <td>String</td> 
     <td>否</td> 
     <td>40</td> 
     <td>仅支持JSON</td> 
     <td>JSON</td> 
    </tr>
    <tr>
     <td>charset</td> 
     <td>String</td> 
     <td>是</td> 
     <td>10</td> 
     <td>请求使用的编码格式，如utf-8,gbk,gb2312等</td> 
     <td>utf-8</td> 
    </tr>
    <tr>
     <td>sign_type</td> 
     <td>String</td> 
     <td>是</td> 
     <td>10</td> 
     <td>商户生成签名字符串所使用的签名算法类型，目前支持RSA2和RSA，推荐使用RSA2</td> 
     <td>RSA2</td> 
    </tr>
    <tr>
     <td>sign</td> 
     <td>String</td> 
     <td>是</td> 
     <td>344</td> 
     <td>商户请求参数的签名串，详见<a href="https://docs.open.alipay.com/291/105974" rel="nofollow">签名</a></td> 
     <td>详见示例</td> 
    </tr>
    <tr>
     <td>timestamp</td> 
     <td>String</td> 
     <td>是</td> 
     <td>19</td> 
     <td>发送请求的时间，格式"yyyy-MM-dd HH:mm:ss"</td> 
     <td>2014-07-24 03:07:50</td> 
    </tr>
    <tr>
     <td>version</td> 
     <td>String</td> 
     <td>是</td> 
     <td>3</td> 
     <td>调用的接口版本，固定为：1.0</td> 
     <td>1.0</td> 
    </tr>
    <tr>
     <td>app_auth_token</td> 
     <td>String</td> 
     <td>否</td> 
     <td>40</td> 
     <td>详见<a href="https://docs.open.alipay.com/common/105193" rel="nofollow">应用授权概述</a></td> 
     <td>&nbsp;</td> 
    </tr>
    <tr>
     <td>biz_content</td> 
     <td>String</td> 
     <td>是</td> 
     <td>&nbsp;</td> 
     <td>请求参数的集合，最大长度不限，除公共参数外所有请求参数都必须放在这个参数中传递，具体参照各产品快速接入文档</td> 
     <td>&nbsp;</td> 
    </tr>
   </tbody>
  </table>
  <h2><a name="t3"></a>请求参数</h2> 
  <table>
   <tbody>
    <tr>
     <th>参数</th> 
     <th>类型</th> 
     <th>是否必填</th> 
     <th>最大长度</th> 
     <th>描述</th> 
     <th>示例值</th> 
    </tr>
    <tr>
     <td>out_trade_no</td> 
     <td>String</td> 
     <td>特殊可选</td> 
     <td>64</td> 
     <td>订单支付时传入的商户订单号,不能和 trade_no同时为空。</td> 
     <td>20150320010101001</td> 
    </tr>
    <tr>
     <td>trade_no</td> 
     <td>String</td> 
     <td>特殊可选</td> 
     <td>64</td> 
     <td>支付宝交易号，和商户订单号不能同时为空</td> 
     <td>2014112611001004680073956707</td> 
    </tr>
    <tr>
     <td>refund_amount</td> 
     <td>Price</td> 
     <td>必选</td> 
     <td>9</td> 
     <td>需要退款的金额，该金额不能大于订单金额,单位为元，支持两位小数</td> 
     <td>200.12</td> 
    </tr>
    <tr>
     <td>refund_reason</td> 
     <td>String</td> 
     <td>可选</td> 
     <td>256</td> 
     <td>退款的原因说明</td> 
     <td>正常退款</td> 
    </tr>
    <tr>
     <td>out_request_no</td> 
     <td>String</td> 
     <td>可选</td> 
     <td>64</td> 
     <td>标识一次退款请求，同一笔交易多次退款需要保证唯一，如需部分退款，则此参数必传。</td> 
     <td>HZ01RF001</td> 
    </tr>
    <tr>
     <td>operator_id</td> 
     <td>String</td> 
     <td>可选</td> 
     <td>30</td> 
     <td>商户的操作员编号</td> 
     <td>OP001</td> 
    </tr>
    <tr>
     <td>store_id</td> 
     <td>String</td> 
     <td>可选</td> 
     <td>32</td> 
     <td>商户的门店编号</td> 
     <td>NJ_S_001</td> 
    </tr>
    <tr>
     <td>terminal_id</td> 
     <td>String</td> 
     <td>可选</td> 
     <td>32</td> 
     <td>商户的终端编号</td> 
     <td>NJ_T_001</td> 
    </tr>
    <tr>
     <td>&nbsp;goods_detail</td> 
     <td>GoodsDetail[]</td> 
     <td>可选</td> 
     <td>&nbsp;</td> 
     <td>退款包含的商品列表信息，Json格式。&nbsp;<br> 其它说明详见：“商品明细说明”</td> 
     <td>&nbsp;</td> 
    </tr>
   </tbody>
  </table>
  <h2><a name="t4"></a>公共响应参数</h2> 
  <table>
   <thead>
    <tr>
     <th>参数</th> 
     <th>类型</th> 
     <th>是否必填</th> 
     <th>最大长度</th> 
     <th>描述</th> 
     <th>示例值</th> 
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>code</td> 
     <td>String</td> 
     <td>是</td> 
     <td>-</td> 
     <td>网关返回码,<a href="https://docs.open.alipay.com/common/105806" rel="nofollow">详见文档</a></td> 
     <td>40004</td> 
    </tr>
    <tr>
     <td>msg</td> 
     <td>String</td> 
     <td>是</td> 
     <td>-</td> 
     <td>网关返回码描述,<a href="https://docs.open.alipay.com/common/105806" rel="nofollow">详见文档</a></td> 
     <td>Business Failed</td> 
    </tr>
    <tr>
     <td>sub_code</td> 
     <td>String</td> 
     <td>否</td> 
     <td>-</td> 
     <td>业务返回码，参见具体的API接口文档</td> 
     <td>ACQ.TRADE_HAS_SUCCESS</td> 
    </tr>
    <tr>
     <td>sub_msg</td> 
     <td>String</td> 
     <td>否</td> 
     <td>-</td> 
     <td>业务返回码描述，参见具体的API接口文档</td> 
     <td>交易已被支付</td> 
    </tr>
    <tr>
     <td>sign</td> 
     <td>String</td> 
     <td>是</td> 
     <td>-</td> 
     <td>签名,<a href="https://docs.open.alipay.com/291/106074" rel="nofollow">详见文档</a></td> 
     <td>DZXh8eeTuAHoYE3w1J+POiPhfDxOYBfUNn1lkeT/V7P4zJdyojWEa6IZs6Hz0yDW5Cp/viufUb5I0/V5WENS3OYR8zRedqo6D+fUTdLHdc+EFyCkiQhBxIzgngPdPdfp1PIS7BdhhzrsZHbRqb7o4k3Dxc+AAnFauu4V6Zdwczo=</td> 
    </tr>
   </tbody>
  </table>
  <h2><a name="t5"></a>响应参数</h2> 
  <table>
   <tbody>
    <tr>
     <th>参数</th> 
     <th>类型</th> 
     <th>是否必填</th> 
     <th>最大长度</th> 
     <th>描述</th> 
     <th>示例值</th> 
    </tr>
    <tr>
     <td>trade_no</td> 
     <td>String</td> 
     <td>必填</td> 
     <td>64</td> 
     <td>2013112011001004330000121536</td> 
     <td>支付宝交易号</td> 
    </tr>
    <tr>
     <td>out_trade_no</td> 
     <td>String</td> 
     <td>必填</td> 
     <td>64</td> 
     <td>商户订单号</td> 
     <td>6823789339978248</td> 
    </tr>
    <tr>
     <td>buyer_logon_id</td> 
     <td>String</td> 
     <td>必填</td> 
     <td>100</td> 
     <td>用户的登录id</td> 
     <td>159****5620</td> 
    </tr>
    <tr>
     <td>fund_change</td> 
     <td>String</td> 
     <td>必填</td> 
     <td>1</td> 
     <td>本次退款是否发生了资金变化</td> 
     <td>Y</td> 
    </tr>
    <tr>
     <td>refund_fee</td> 
     <td>Price</td> 
     <td>必填</td> 
     <td>11</td> 
     <td>退款总金额</td> 
     <td>88.88</td> 
    </tr>
    <tr>
     <td>gmt_refund_pay</td> 
     <td>Date</td> 
     <td>必填</td> 
     <td>32</td> 
     <td>退款支付时间</td> 
     <td>2014-11-27 15:45:57</td> 
    </tr>
    <tr>
     <td>refund_detail_item_list</td> 
     <td>TradeFundBill</td> 
     <td>选填</td> 
     <td>&nbsp;</td> 
     <td>退款使用的资金渠道</td> 
     <td>&nbsp;</td> 
    </tr>
    <tr>
     <td>store_name</td> 
     <td>String</td> 
     <td>选填</td> 
     <td>512</td> 
     <td>交易在支付时候的门店名称</td> 
     <td>望湘园联洋店</td> 
    </tr>
    <tr>
     <td>buyer_user_id</td> 
     <td>String</td> 
     <td>必填</td> 
     <td>28</td> 
     <td>买家在支付宝的用户id</td> 
     <td>2088101117955611</td> 
    </tr>
    <tr>
     <td>present_refund_buyer_amount</td> 
     <td>String</td> 
     <td>选填</td> 
     <td>11</td> 
     <td>本次退款金额中买家退款金额</td> 
     <td>88.88</td> 
    </tr>
    <tr>
     <td>present_refund_discount_amount</td> 
     <td>String</td> 
     <td>选填</td> 
     <td>11</td> 
     <td>本次退款金额中平台优惠退款金额</td> 
     <td>88.88</td> 
    </tr>
    <tr>
     <td>present_refund_mdiscount_amount</td> 
     <td>String</td> 
     <td>选填</td> 
     <td>11</td> 
     <td>本次退款金额中商家优惠退款金额</td> 
     <td>88.88</td> 
    </tr>
   </tbody>
  </table>
  <h2><a name="t6"></a>请求示例</h2> 
  <ul>
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">JAVA</a>&nbsp;</li> 
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">.NET</a>&nbsp;</li> 
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">PHP</a>&nbsp;</li> 
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">HTTP请求源码</a></li> 
  </ul>
  <pre>

&nbsp;</pre> 
  <ol>
   <li> <p><code>$aop = new AopClient ();</code></p> </li> 
   <li> <p><code>$aop-&gt;gatewayUrl = 'https://openapi.alipay.com/gateway.do';</code></p> </li> 
   <li> <p><code>$aop-&gt;appId = 'your app_id';</code></p> </li> 
   <li> <p><code>$aop-&gt;rsaPrivateKey = '请填写开发者私钥去头去尾去回车，一行字符串';</code></p> </li> 
   <li> <p><code>$aop-&gt;alipayrsaPublicKey='请填写支付宝公钥，一行字符串';</code></p> </li> 
   <li> <p><code>$aop-&gt;apiVersion = '1.0';</code></p> </li> 
   <li> <p><code>$aop-&gt;signType = 'RSA2';</code></p> </li> 
   <li> <p><code>$aop-&gt;postCharset='GBK';</code></p> </li> 
   <li> <p><code>$aop-&gt;format='json';</code></p> </li> 
   <li> <p><code>$request = new AlipayTradeRefundRequest ();</code></p> </li> 
   <li> <p><code>$request-&gt;setBizContent("{" .</code></p> </li> 
   <li> <p><code>"\"out_trade_no\":\"20150320010101001\"," .</code></p> </li> 
   <li> <p><code>"\"trade_no\":\"2014112611001004680073956707\"," .</code></p> </li> 
   <li> <p><code>"\"refund_amount\":200.12," .</code></p> </li> 
   <li> <p><code>"\"refund_currency\":\"USD\"," .</code></p> </li> 
   <li> <p><code>"\"refund_reason\":\"正常退款\"," .</code></p> </li> 
   <li> <p><code>"\"out_request_no\":\"HZ01RF001\"," .</code></p> </li> 
   <li> <p><code>"\"operator_id\":\"OP001\"," .</code></p> </li> 
   <li> <p><code>"\"store_id\":\"NJ_S_001\"," .</code></p> </li> 
   <li> <p><code>"\"terminal_id\":\"NJ_T_001\"," .</code></p> </li> 
   <li> <p><code>" \"goods_detail\":[{" .</code></p> </li> 
   <li> <p><code>" \"goods_id\":\"apple-01\"," .</code></p> </li> 
   <li> <p><code>"\"alipay_goods_id\":\"20010001\"," .</code></p> </li> 
   <li> <p><code>"\"goods_name\":\"ipad\"," .</code></p> </li> 
   <li> <p><code>"\"quantity\":1," .</code></p> </li> 
   <li> <p><code>"\"price\":2000," .</code></p> </li> 
   <li> <p><code>"\"goods_category\":\"34543238\"," .</code></p> </li> 
   <li> <p><code>"\"body\":\"特价手机\"," .</code></p> </li> 
   <li> <p><code>"\"show_url\":\"http://www.alipay.com/xxx.jpg\"" .</code></p> </li> 
   <li> <p><code>" }]" .</code></p> </li> 
   <li> <p><code>" }");</code></p> </li> 
   <li> <p><code>$result = $aop-&gt;execute ( $request); </code></p> </li> 
   <li>&nbsp;</li> 
   <li> <p><code>$responseNode = str_replace(".", "_", $request-&gt;getApiMethodName()) . "_response";</code></p> </li> 
   <li> <p><code>$resultCode = $result-&gt;$responseNode-&gt;code;</code></p> </li> 
   <li> <p><code>if(!empty($resultCode)&amp;&amp;$resultCode == 10000){</code></p> </li> 
   <li> <p><code>echo "成功";</code></p> </li> 
   <li> <p><code>} else {</code></p> </li> 
   <li> <p><code>echo "失败";</code></p> </li> 
   <li> <p><code>}</code></p> </li> 
  </ol>
  <h2><a name="t7"></a>响应示例</h2> 
  <ul>
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">JSON 示例</a>&nbsp;</li> 
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">XML 示例</a></li> 
  </ul>
  <pre>

&nbsp;</pre> 
  <ol>
   <li> <p><code>{</code></p> </li> 
   <li> <p><code>"alipay_trade_refund_response": {</code></p> </li> 
   <li> <p><code>"code": "10000",</code></p> </li> 
   <li> <p><code>"msg": "Success",</code></p> </li> 
   <li> <p><code>"trade_no": "支付宝交易号",</code></p> </li> 
   <li> <p><code>"out_trade_no": "6823789339978248",</code></p> </li> 
   <li> <p><code>"buyer_logon_id": "159****5620",</code></p> </li> 
   <li> <p><code>"fund_change": "Y",</code></p> </li> 
   <li> <p><code>"refund_fee": 88.88,</code></p> </li> 
   <li> <p><code>"gmt_refund_pay": "2014-11-27 15:45:57",</code></p> </li> 
   <li> <p><code>"refund_detail_item_list": [</code></p> </li> 
   <li> <p><code>{</code></p> </li> 
   <li> <p><code>"fund_channel": "ALIPAYACCOUNT",</code></p> </li> 
   <li> <p><code>"bank_code": "CEB",</code></p> </li> 
   <li> <p><code>"amount": 10,</code></p> </li> 
   <li> <p><code>"real_amount": 11.21,</code></p> </li> 
   <li> <p><code>"fund_type": "DEBIT_CARD"</code></p> </li> 
   <li> <p><code>}</code></p> </li> 
   <li> <p><code>],</code></p> </li> 
   <li> <p><code>"store_name": "望湘园联洋店",</code></p> </li> 
   <li> <p><code>"buyer_user_id": "2088101117955611",</code></p> </li> 
   <li> <p><code>"present_refund_buyer_amount": "88.88",</code></p> </li> 
   <li> <p><code>"present_refund_discount_amount": "88.88",</code></p> </li> 
   <li> <p><code>"present_refund_mdiscount_amount": "88.88"</code></p> </li> 
   <li> <p><code>},</code></p> </li> 
   <li> <p><code>"sign": "ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE"</code></p> </li> 
   <li> <p><code>}</code></p> </li> 
  </ol>
  <h2><a name="t8"></a>异常示例</h2> 
  <ul>
   <li><a href="https://docs.open.alipay.com/#" rel="nofollow">JSON 示例</a></li> 
  </ul>
  <pre>

&nbsp;</pre> 
  <ol>
   <li> <p><code>{</code></p> </li> 
   <li> <p><code>"alipay_trade_refund_response": {</code></p> </li> 
   <li> <p><code>"code": "20000",</code></p> </li> 
   <li> <p><code>"msg": "Service Currently Unavailable",</code></p> </li> 
   <li> <p><code>"sub_code": "isp.unknow-error",</code></p> </li> 
   <li> <p><code>"sub_msg": "系统繁忙"</code></p> </li> 
   <li> <p><code>},</code></p> </li> 
   <li> <p><code>"sign": "ERITJKEIJKJHKKKKKKKHJEREEEEEEEEEEE"</code></p> </li> 
   <li> <p><code>}</code></p> </li> 
  </ol>
  <h2><a name="t9"></a>业务错误码</h2> 
  <p><a href="https://docs.open.alipay.com/common/105806" rel="nofollow">公共错误码</a></p> 
  <table>
   <tbody>
    <tr>
     <th>错误码</th> 
     <th>错误描述</th> 
     <th>解决方案</th> 
    </tr>
    <tr>
     <td>ACQ.SYSTEM_ERROR</td> 
     <td>系统错误</td> 
     <td>请使用相同的参数再次调用</td> 
    </tr>
    <tr>
     <td>ACQ.INVALID_PARAMETER</td> 
     <td>参数无效</td> 
     <td>请求参数有错，重新检查请求后，再调用退款</td> 
    </tr>
    <tr>
     <td>ACQ.SELLER_BALANCE_NOT_ENOUGH</td> 
     <td>卖家余额不足</td> 
     <td>商户支付宝账户充值后重新发起退款即可</td> 
    </tr>
    <tr>
     <td>ACQ.REFUND_AMT_NOT_EQUAL_TOTAL</td> 
     <td>退款金额超限</td> 
     <td>检查退款金额是否正确，重新修改请求后，重新发起退款</td> 
    </tr>
    <tr>
     <td>ACQ.REASON_TRADE_BEEN_FREEZEN</td> 
     <td>请求退款的交易被冻结</td> 
     <td>联系支付宝小二，确认该笔交易的具体情况</td> 
    </tr>
    <tr>
     <td>ACQ.TRADE_NOT_EXIST</td> 
     <td>交易不存在</td> 
     <td>检查请求中的交易号和商户订单号是否正确，确认后重新发起</td> 
    </tr>
    <tr>
     <td>ACQ.TRADE_HAS_FINISHED</td> 
     <td>交易已完结</td> 
     <td>该交易已完结，不允许进行退款，确认请求的退款的交易信息是否正确</td> 
    </tr>
    <tr>
     <td>ACQ.TRADE_STATUS_ERROR</td> 
     <td>交易状态非法</td> 
     <td>查询交易，确认交易是否已经付款</td> 
    </tr>
    <tr>
     <td>ACQ.DISCORDANT_REPEAT_REQUEST</td> 
     <td>不一致的请求</td> 
     <td>检查该退款号是否已退过款或更换退款号重新发起请求</td> 
    </tr>
    <tr>
     <td>ACQ.REASON_TRADE_REFUND_FEE_ERR</td> 
     <td>退款金额无效</td> 
     <td>检查退款请求的金额是否正确</td> 
    </tr>
    <tr>
     <td>ACQ.TRADE_NOT_ALLOW_REFUND</td> 
     <td>当前交易不允许退款</td> 
     <td>检查当前交易的状态是否为交易成功状态以及签约的退款属性是否允许退款，确认后，重新发起请求</td> 
    </tr>
   </tbody>
  </table> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/weixin_38738277/article/details/81705187,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/weixin_38738277/article/details/81705187,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
