<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>【区块链学习】（4）以太坊智能合约布置及发布ICO代币 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="【区块链学习】（4）以太坊智能合约布置及发布ICO代币" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="首先通过geth启动节点进行交互模式 geth --datadir data console 查询账号 &gt; eth.accounts [&quot;0x53099d033d847921e44812067d720d17b133a2d8&quot;, &quot;0x6917c3b6eb6f4df7c80d3c3167bec2e4959d9152&quot;] &gt; eth.getBalance(eth.accounts[0]) 75000000000000000000 // 如果没钱就执行挖矿 &gt; miner.start() 1. 代币的智能合约代码 pragma solidity ^0.4.2; contract Token { address issuer; mapping (address =&gt; uint) balances; event Issue(address account, uint amount); event Transfer(address from, address to,uint amount); function Token() { issuer = msg.sender; } function issue(address account, uint amount) { if (msg.sender != issuer) throw; balances[account] += amount; } function transfer(address to, uint amount){ if (balances[msg.sender] &lt; amount)throw; balances[msg.sender] -= amount; balances[to] += amount; Transfer(msg.sender, to, amount); } function getBalance(address account)constant returns (uint) { return balances[account]; } } 在线编译网站 remix 2.合约代码编译 选择WEB3DEPLOY的编码,编译代码如下 var tokenContract = web3.eth.contract([{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;issue&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Token&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getBalance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Issue&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;}]); var token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) 3. 定义合约 注:编码后的第一行 本人测试需要去掉var 及结尾的分号; 才能执行成功 &gt; tokenContract = web3.eth.contract([{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;issue&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Token&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getBalance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Issue&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;}]) 4. 合约部署上交易链 其实就是执行编码后的第二行代码 &gt; token = tokenContract.new( ... { ...... data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, ...... gas: &#39;4700000&#39; ...... }, function (e, contract){ ...... console.log(e, contract); ...... if (typeof contract.address !== &#39;undefined&#39;) { ......... console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); ......... } ...... }) Error: authentication needed: password or unlock undefined undefined &gt; 这里报了异常,原因是账户没有解锁进行解锁 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x53099d033d847921e44812067d720d17b133a2d8 Passphrase: true 再次执行 &gt; var token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080&gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) INFO [08-31|17:06:15.864] Submitted contract creation fullhash=0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8 contract=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 null [object Object] 这里再次执行还是失败,原因需要去掉换行符及var变量关健字 再次执行 &gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) 如出现交易记录的hash值.代表部署成功 address: undefined, transactionHash: &quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot; 如需要部署成功需要进行挖矿确认 &gt; miner.start() INFO [08-31|17:11:17.651] Updated mining threads threads=0 INFO [08-31|17:11:17.651] Transaction pool price threshold updated price=18000000000 INFO [08-31|17:11:17.651] Starting mining operation INFO [08-31|17:11:17.654] Commit new mining work number=253 txs=1 uncles=0 elapsed=2.507ms INFO [08-31|17:11:18.517] Successfully sealed new block number=253 hash=508765…aedfbb INFO [08-31|17:11:18.519] ? block reached canonical chain number=248 hash=a31bb8…40e316 INFO [08-31|17:11:18.519] ? mined potential block number=253 hash=508765…aedfbb INFO [08-31|17:11:18.520] Commit new mining work number=254 txs=1 uncles=0 elapsed=385.673µs 根据交易记录hash查询详细信息 &gt; eth.getTransactionReceipt(&quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot;) { blockHash: &quot;0x48fbf85484c083b808fecf3cc75c7e200187369f24f2dbeeaca0b244274ba117&quot;, blockNumber: 256, contractAddress: &quot;0x8ed7065cc990fbb38c8f5a80739722ecc8ab9e25&quot;, cumulativeGasUsed: 336109, from: &quot;0x53099d033d847921e44812067d720d17b133a2d8&quot;, gasUsed: 336109, logs: [], logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, root: &quot;0xca618cac97da3ff654524bfe70d51359f41bc58526c996405ca43f19472edb58&quot;, to: null, transactionHash: &quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot;, transactionIndex: 0 } &gt; 5. 发布代币 &gt; token.issue.sendTransaction(eth.accounts[0],500,{from:eth.accounts[0]}) INFO [08-31|17:16:24.403] Submitted transaction fullhash=0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f&quot; &gt; 如出现异常需要解锁账户: Error: authentication needed: password or unlock at web3.js:3143:20 at web3.js:6347:15 at web3.js:5081:36 at web3.js:4137:16 at &lt;anonymous&gt;:1:1 设置发币账户 &gt; token.Token({from:eth.accounts[0]}) INFO [08-31|17:49:01.149] Submitted transaction fullhash=0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3 recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3&quot; &gt; 充值并进行挖矿交易确认 &gt; token.issue(eth.accounts[0],100,{from:eth.accounts[0]}) INFO [08-31|17:49:11.393] Submitted transaction fullhash=0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b&quot; &gt; miner.start() INFO [08-31|17:49:27.068] Updated mining threads threads=0 INFO [08-31|17:49:27.068] Transaction pool price threshold updated price=18000000000 INFO [08-31|17:49:27.068] Starting mining operation 查询代码已经拥有100个代币了 &gt; token.getBalance(eth.accounts[0]) 100 &gt; ## 交易 &gt; token.transfer(eth.accounts[1],20,{from:eth.accounts[0]}) INFO [08-31|17:53:33.240] Submitted transaction fullhash=0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f&quot; ## 挖矿 进行交易确认 &gt; miner.start() INFO [08-31|17:53:41.179] Updated mining threads threads=0 INFO [08-31|17:53:41.179] Transaction pool price threshold updated price=18000000000 .... ## 代币查询发现交易已经成功.账户代币数量已经变更 &gt; token.getBalance(eth.accounts[0]) 80 &gt; token.getBalance(eth.accounts[1]) 20 &gt; 阅读更多 登录后自动展开" />
<meta property="og:description" content="首先通过geth启动节点进行交互模式 geth --datadir data console 查询账号 &gt; eth.accounts [&quot;0x53099d033d847921e44812067d720d17b133a2d8&quot;, &quot;0x6917c3b6eb6f4df7c80d3c3167bec2e4959d9152&quot;] &gt; eth.getBalance(eth.accounts[0]) 75000000000000000000 // 如果没钱就执行挖矿 &gt; miner.start() 1. 代币的智能合约代码 pragma solidity ^0.4.2; contract Token { address issuer; mapping (address =&gt; uint) balances; event Issue(address account, uint amount); event Transfer(address from, address to,uint amount); function Token() { issuer = msg.sender; } function issue(address account, uint amount) { if (msg.sender != issuer) throw; balances[account] += amount; } function transfer(address to, uint amount){ if (balances[msg.sender] &lt; amount)throw; balances[msg.sender] -= amount; balances[to] += amount; Transfer(msg.sender, to, amount); } function getBalance(address account)constant returns (uint) { return balances[account]; } } 在线编译网站 remix 2.合约代码编译 选择WEB3DEPLOY的编码,编译代码如下 var tokenContract = web3.eth.contract([{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;issue&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Token&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getBalance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Issue&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;}]); var token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) 3. 定义合约 注:编码后的第一行 本人测试需要去掉var 及结尾的分号; 才能执行成功 &gt; tokenContract = web3.eth.contract([{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;issue&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Token&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getBalance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Issue&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;}]) 4. 合约部署上交易链 其实就是执行编码后的第二行代码 &gt; token = tokenContract.new( ... { ...... data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, ...... gas: &#39;4700000&#39; ...... }, function (e, contract){ ...... console.log(e, contract); ...... if (typeof contract.address !== &#39;undefined&#39;) { ......... console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); ......... } ...... }) Error: authentication needed: password or unlock undefined undefined &gt; 这里报了异常,原因是账户没有解锁进行解锁 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x53099d033d847921e44812067d720d17b133a2d8 Passphrase: true 再次执行 &gt; var token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080&gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) INFO [08-31|17:06:15.864] Submitted contract creation fullhash=0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8 contract=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 null [object Object] 这里再次执行还是失败,原因需要去掉换行符及var变量关健字 再次执行 &gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) 如出现交易记录的hash值.代表部署成功 address: undefined, transactionHash: &quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot; 如需要部署成功需要进行挖矿确认 &gt; miner.start() INFO [08-31|17:11:17.651] Updated mining threads threads=0 INFO [08-31|17:11:17.651] Transaction pool price threshold updated price=18000000000 INFO [08-31|17:11:17.651] Starting mining operation INFO [08-31|17:11:17.654] Commit new mining work number=253 txs=1 uncles=0 elapsed=2.507ms INFO [08-31|17:11:18.517] Successfully sealed new block number=253 hash=508765…aedfbb INFO [08-31|17:11:18.519] ? block reached canonical chain number=248 hash=a31bb8…40e316 INFO [08-31|17:11:18.519] ? mined potential block number=253 hash=508765…aedfbb INFO [08-31|17:11:18.520] Commit new mining work number=254 txs=1 uncles=0 elapsed=385.673µs 根据交易记录hash查询详细信息 &gt; eth.getTransactionReceipt(&quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot;) { blockHash: &quot;0x48fbf85484c083b808fecf3cc75c7e200187369f24f2dbeeaca0b244274ba117&quot;, blockNumber: 256, contractAddress: &quot;0x8ed7065cc990fbb38c8f5a80739722ecc8ab9e25&quot;, cumulativeGasUsed: 336109, from: &quot;0x53099d033d847921e44812067d720d17b133a2d8&quot;, gasUsed: 336109, logs: [], logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, root: &quot;0xca618cac97da3ff654524bfe70d51359f41bc58526c996405ca43f19472edb58&quot;, to: null, transactionHash: &quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot;, transactionIndex: 0 } &gt; 5. 发布代币 &gt; token.issue.sendTransaction(eth.accounts[0],500,{from:eth.accounts[0]}) INFO [08-31|17:16:24.403] Submitted transaction fullhash=0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f&quot; &gt; 如出现异常需要解锁账户: Error: authentication needed: password or unlock at web3.js:3143:20 at web3.js:6347:15 at web3.js:5081:36 at web3.js:4137:16 at &lt;anonymous&gt;:1:1 设置发币账户 &gt; token.Token({from:eth.accounts[0]}) INFO [08-31|17:49:01.149] Submitted transaction fullhash=0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3 recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3&quot; &gt; 充值并进行挖矿交易确认 &gt; token.issue(eth.accounts[0],100,{from:eth.accounts[0]}) INFO [08-31|17:49:11.393] Submitted transaction fullhash=0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b&quot; &gt; miner.start() INFO [08-31|17:49:27.068] Updated mining threads threads=0 INFO [08-31|17:49:27.068] Transaction pool price threshold updated price=18000000000 INFO [08-31|17:49:27.068] Starting mining operation 查询代码已经拥有100个代币了 &gt; token.getBalance(eth.accounts[0]) 100 &gt; ## 交易 &gt; token.transfer(eth.accounts[1],20,{from:eth.accounts[0]}) INFO [08-31|17:53:33.240] Submitted transaction fullhash=0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f&quot; ## 挖矿 进行交易确认 &gt; miner.start() INFO [08-31|17:53:41.179] Updated mining threads threads=0 INFO [08-31|17:53:41.179] Transaction pool price threshold updated price=18000000000 .... ## 代币查询发现交易已经成功.账户代币数量已经变更 &gt; token.getBalance(eth.accounts[0]) 80 &gt; token.getBalance(eth.accounts[1]) 20 &gt; 阅读更多 登录后自动展开" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-31T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"首先通过geth启动节点进行交互模式 geth --datadir data console 查询账号 &gt; eth.accounts [&quot;0x53099d033d847921e44812067d720d17b133a2d8&quot;, &quot;0x6917c3b6eb6f4df7c80d3c3167bec2e4959d9152&quot;] &gt; eth.getBalance(eth.accounts[0]) 75000000000000000000 // 如果没钱就执行挖矿 &gt; miner.start() 1. 代币的智能合约代码 pragma solidity ^0.4.2; contract Token { address issuer; mapping (address =&gt; uint) balances; event Issue(address account, uint amount); event Transfer(address from, address to,uint amount); function Token() { issuer = msg.sender; } function issue(address account, uint amount) { if (msg.sender != issuer) throw; balances[account] += amount; } function transfer(address to, uint amount){ if (balances[msg.sender] &lt; amount)throw; balances[msg.sender] -= amount; balances[to] += amount; Transfer(msg.sender, to, amount); } function getBalance(address account)constant returns (uint) { return balances[account]; } } 在线编译网站 remix 2.合约代码编译 选择WEB3DEPLOY的编码,编译代码如下 var tokenContract = web3.eth.contract([{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;issue&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Token&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getBalance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Issue&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;}]); var token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) 3. 定义合约 注:编码后的第一行 本人测试需要去掉var 及结尾的分号; 才能执行成功 &gt; tokenContract = web3.eth.contract([{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;issue&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Token&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;nonpayable&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getBalance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;,&quot;stateMutability&quot;:&quot;view&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Issue&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;}]) 4. 合约部署上交易链 其实就是执行编码后的第二行代码 &gt; token = tokenContract.new( ... { ...... data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, ...... gas: &#39;4700000&#39; ...... }, function (e, contract){ ...... console.log(e, contract); ...... if (typeof contract.address !== &#39;undefined&#39;) { ......... console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); ......... } ...... }) Error: authentication needed: password or unlock undefined undefined &gt; 这里报了异常,原因是账户没有解锁进行解锁 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x53099d033d847921e44812067d720d17b133a2d8 Passphrase: true 再次执行 &gt; var token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080&gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) INFO [08-31|17:06:15.864] Submitted contract creation fullhash=0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8 contract=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 null [object Object] 这里再次执行还是失败,原因需要去掉换行符及var变量关健字 再次执行 &gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: &#39;0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029&#39;, gas: &#39;4700000&#39; }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== &#39;undefined&#39;) { console.log(&#39;Contract mined! address: &#39; + contract.address + &#39; transactionHash: &#39; + contract.transactionHash); } }) 如出现交易记录的hash值.代表部署成功 address: undefined, transactionHash: &quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot; 如需要部署成功需要进行挖矿确认 &gt; miner.start() INFO [08-31|17:11:17.651] Updated mining threads threads=0 INFO [08-31|17:11:17.651] Transaction pool price threshold updated price=18000000000 INFO [08-31|17:11:17.651] Starting mining operation INFO [08-31|17:11:17.654] Commit new mining work number=253 txs=1 uncles=0 elapsed=2.507ms INFO [08-31|17:11:18.517] Successfully sealed new block number=253 hash=508765…aedfbb INFO [08-31|17:11:18.519] ? block reached canonical chain number=248 hash=a31bb8…40e316 INFO [08-31|17:11:18.519] ? mined potential block number=253 hash=508765…aedfbb INFO [08-31|17:11:18.520] Commit new mining work number=254 txs=1 uncles=0 elapsed=385.673µs 根据交易记录hash查询详细信息 &gt; eth.getTransactionReceipt(&quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot;) { blockHash: &quot;0x48fbf85484c083b808fecf3cc75c7e200187369f24f2dbeeaca0b244274ba117&quot;, blockNumber: 256, contractAddress: &quot;0x8ed7065cc990fbb38c8f5a80739722ecc8ab9e25&quot;, cumulativeGasUsed: 336109, from: &quot;0x53099d033d847921e44812067d720d17b133a2d8&quot;, gasUsed: 336109, logs: [], logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, root: &quot;0xca618cac97da3ff654524bfe70d51359f41bc58526c996405ca43f19472edb58&quot;, to: null, transactionHash: &quot;0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8&quot;, transactionIndex: 0 } &gt; 5. 发布代币 &gt; token.issue.sendTransaction(eth.accounts[0],500,{from:eth.accounts[0]}) INFO [08-31|17:16:24.403] Submitted transaction fullhash=0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f&quot; &gt; 如出现异常需要解锁账户: Error: authentication needed: password or unlock at web3.js:3143:20 at web3.js:6347:15 at web3.js:5081:36 at web3.js:4137:16 at &lt;anonymous&gt;:1:1 设置发币账户 &gt; token.Token({from:eth.accounts[0]}) INFO [08-31|17:49:01.149] Submitted transaction fullhash=0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3 recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3&quot; &gt; 充值并进行挖矿交易确认 &gt; token.issue(eth.accounts[0],100,{from:eth.accounts[0]}) INFO [08-31|17:49:11.393] Submitted transaction fullhash=0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b&quot; &gt; miner.start() INFO [08-31|17:49:27.068] Updated mining threads threads=0 INFO [08-31|17:49:27.068] Transaction pool price threshold updated price=18000000000 INFO [08-31|17:49:27.068] Starting mining operation 查询代码已经拥有100个代币了 &gt; token.getBalance(eth.accounts[0]) 100 &gt; ## 交易 &gt; token.transfer(eth.accounts[1],20,{from:eth.accounts[0]}) INFO [08-31|17:53:33.240] Submitted transaction fullhash=0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 &quot;0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f&quot; ## 挖矿 进行交易确认 &gt; miner.start() INFO [08-31|17:53:41.179] Updated mining threads threads=0 INFO [08-31|17:53:41.179] Transaction pool price threshold updated price=18000000000 .... ## 代币查询发现交易已经成功.账户代币数量已经变更 &gt; token.getBalance(eth.accounts[0]) 80 &gt; token.getBalance(eth.accounts[1]) 20 &gt; 阅读更多 登录后自动展开","@type":"BlogPosting","url":"/2018/08/31/69321ef764a9690ef2a5f5b94271e523.html","headline":"【区块链学习】（4）以太坊智能合约布置及发布ICO代币","dateModified":"2018-08-31T00:00:00+08:00","datePublished":"2018-08-31T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/08/31/69321ef764a9690ef2a5f5b94271e523.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>【区块链学习】（4）以太坊智能合约布置及发布ICO代币</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <p>首先通过geth启动节点进行交互模式</p> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">geth</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">datadir</span> <span class="hljs-comment">data</span> <span class="hljs-comment">console</span>
</code></pre> 
  <p>查询账号</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; eth<span class="hljs-preprocessor">.accounts</span>
[<span class="hljs-string">"0x53099d033d847921e44812067d720d17b133a2d8"</span>, <span class="hljs-string">"0x6917c3b6eb6f4df7c80d3c3167bec2e4959d9152"</span>]
&gt; eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">75000000000000000000</span> // 如果没钱就执行挖矿
&gt; miner<span class="hljs-preprocessor">.start</span>()
</code></pre> 
  <h5 id="1-代币的智能合约代码">1. 代币的智能合约代码</h5> 
  <pre class="prettyprint"><code class=" hljs php">pragma solidity ^<span class="hljs-number">0.4</span><span class="hljs-number">.2</span>;
contract Token {
             address issuer;
             mapping (address =&gt; uint) balances;

             event Issue(address account, uint amount);
             event Transfer(address from, address to,uint amount);

             <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Token</span><span class="hljs-params">()</span> {</span>
                 issuer = msg.sender;
             }

             <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">issue</span><span class="hljs-params">(address account, uint amount)</span> {</span>
                 <span class="hljs-keyword">if</span> (msg.sender != issuer) <span class="hljs-keyword">throw</span>;
                 balances[account] += amount;
             }

             <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transfer</span><span class="hljs-params">(address to, uint amount)</span>{</span>
                 <span class="hljs-keyword">if</span> (balances[msg.sender] &lt; amount)<span class="hljs-keyword">throw</span>;

                 balances[msg.sender] -= amount;
                 balances[to] += amount;

                 Transfer(msg.sender, to, amount);
             }

             <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBalance</span><span class="hljs-params">(address account)</span><span class="hljs-title">constant</span> <span class="hljs-title">returns</span> <span class="hljs-params">(uint)</span> {</span>
                 <span class="hljs-keyword">return</span> balances[account];
             }
         }</code></pre> 
  <p>在线编译网站 <a href="https://remix.ethereum.org/#optimize=true&amp;version=soljson-v0.4.24+commit.e67f0147.js" rel="nofollow">remix</a></p> 
  <h5 id="2合约代码编译-选择web3deploy的编码编译代码如下">2.合约代码编译 选择WEB3DEPLOY的编码,编译代码如下</h5> 
  <pre class="prettyprint"><code class=" hljs actionscript"><span class="hljs-keyword">var</span> tokenContract = web3.eth.contract([{<span class="hljs-string">"constant"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"inputs"</span>:[{<span class="hljs-string">"name"</span>:<span class="hljs-string">"account"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"address"</span>},{<span class="hljs-string">"name"</span>:<span class="hljs-string">"amount"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"uint256"</span>}],<span class="hljs-string">"name"</span>:<span class="hljs-string">"issue"</span>,<span class="hljs-string">"outputs"</span>:[],<span class="hljs-string">"payable"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"function"</span>,<span class="hljs-string">"stateMutability"</span>:<span class="hljs-string">"nonpayable"</span>},{<span class="hljs-string">"constant"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"inputs"</span>:[{<span class="hljs-string">"name"</span>:<span class="hljs-string">"to"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"address"</span>},{<span class="hljs-string">"name"</span>:<span class="hljs-string">"amount"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"uint256"</span>}],<span class="hljs-string">"name"</span>:<span class="hljs-string">"transfer"</span>,<span class="hljs-string">"outputs"</span>:[],<span class="hljs-string">"payable"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"function"</span>,<span class="hljs-string">"stateMutability"</span>:<span class="hljs-string">"nonpayable"</span>},{<span class="hljs-string">"constant"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"inputs"</span>:[],<span class="hljs-string">"name"</span>:<span class="hljs-string">"Token"</span>,<span class="hljs-string">"outputs"</span>:[],<span class="hljs-string">"payable"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"function"</span>,<span class="hljs-string">"stateMutability"</span>:<span class="hljs-string">"nonpayable"</span>},{<span class="hljs-string">"constant"</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">"inputs"</span>:[{<span class="hljs-string">"name"</span>:<span class="hljs-string">"account"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"address"</span>}],<span class="hljs-string">"name"</span>:<span class="hljs-string">"getBalance"</span>,<span class="hljs-string">"outputs"</span>:[{<span class="hljs-string">"name"</span>:<span class="hljs-string">""</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"uint256"</span>}],<span class="hljs-string">"payable"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"function"</span>,<span class="hljs-string">"stateMutability"</span>:<span class="hljs-string">"view"</span>},{<span class="hljs-string">"anonymous"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"inputs"</span>:[{<span class="hljs-string">"indexed"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"account"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"address"</span>},{<span class="hljs-string">"indexed"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"amount"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"uint256"</span>}],<span class="hljs-string">"name"</span>:<span class="hljs-string">"Issue"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"event"</span>},{<span class="hljs-string">"anonymous"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"inputs"</span>:[{<span class="hljs-string">"indexed"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"from"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"address"</span>},{<span class="hljs-string">"indexed"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"to"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"address"</span>},{<span class="hljs-string">"indexed"</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"amount"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"uint256"</span>}],<span class="hljs-string">"name"</span>:<span class="hljs-string">"Transfer"</span>,<span class="hljs-string">"type"</span>:<span class="hljs-string">"event"</span>}]);
<span class="hljs-keyword">var</span> token = tokenContract.<span class="hljs-keyword">new</span>(
   {
     from: web3.eth.accounts[<span class="hljs-number">0</span>], 
     data: <span class="hljs-string">'0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029'</span>, 
     gas: <span class="hljs-string">'4700000'</span>
   }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, contract)</span>{</span>
    console.log(e, contract);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> contract.address !== <span class="hljs-string">'undefined'</span>) {
         console.log(<span class="hljs-string">'Contract mined! address: '</span> + contract.address + <span class="hljs-string">' transactionHash: '</span> + contract.transactionHash);
    }
 })
</code></pre> 
  <h5 id="3-定义合约">3. 定义合约</h5> 
  <p>注:编码后的第一行 本人测试需要去掉var 及结尾的分号; 才能执行成功</p> 
  <pre class="prettyprint"><code class=" hljs ruby">&gt; tokenContract = web3.eth.contract([{<span class="hljs-string">"constant"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"inputs"</span><span class="hljs-symbol">:</span>[{<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"account"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"address"</span></span>},{<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"amount"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"uint256"</span></span>}],<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"issue"</span></span>,<span class="hljs-string">"outputs"</span><span class="hljs-symbol">:[]</span>,<span class="hljs-string">"payable"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"function"</span></span>,<span class="hljs-string">"stateMutability"</span><span class="hljs-symbol">:<span class="hljs-string">"nonpayable"</span></span>},{<span class="hljs-string">"constant"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"inputs"</span><span class="hljs-symbol">:</span>[{<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"to"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"address"</span></span>},{<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"amount"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"uint256"</span></span>}],<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"transfer"</span></span>,<span class="hljs-string">"outputs"</span><span class="hljs-symbol">:[]</span>,<span class="hljs-string">"payable"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"function"</span></span>,<span class="hljs-string">"stateMutability"</span><span class="hljs-symbol">:<span class="hljs-string">"nonpayable"</span></span>},{<span class="hljs-string">"constant"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"inputs"</span><span class="hljs-symbol">:[]</span>,<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"Token"</span></span>,<span class="hljs-string">"outputs"</span><span class="hljs-symbol">:[]</span>,<span class="hljs-string">"payable"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"function"</span></span>,<span class="hljs-string">"stateMutability"</span><span class="hljs-symbol">:<span class="hljs-string">"nonpayable"</span></span>},{<span class="hljs-string">"constant"</span><span class="hljs-symbol">:true</span>,<span class="hljs-string">"inputs"</span><span class="hljs-symbol">:</span>[{<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"account"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"address"</span></span>}],<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"getBalance"</span></span>,<span class="hljs-string">"outputs"</span><span class="hljs-symbol">:</span>[{<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">""</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"uint256"</span></span>}],<span class="hljs-string">"payable"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"function"</span></span>,<span class="hljs-string">"stateMutability"</span><span class="hljs-symbol">:<span class="hljs-string">"view"</span></span>},{<span class="hljs-string">"anonymous"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"inputs"</span><span class="hljs-symbol">:</span>[{<span class="hljs-string">"indexed"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"account"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"address"</span></span>},{<span class="hljs-string">"indexed"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"amount"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"uint256"</span></span>}],<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"Issue"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"event"</span></span>},{<span class="hljs-string">"anonymous"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"inputs"</span><span class="hljs-symbol">:</span>[{<span class="hljs-string">"indexed"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"from"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"address"</span></span>},{<span class="hljs-string">"indexed"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"to"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"address"</span></span>},{<span class="hljs-string">"indexed"</span><span class="hljs-symbol">:false</span>,<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"amount"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"uint256"</span></span>}],<span class="hljs-string">"name"</span><span class="hljs-symbol">:<span class="hljs-string">"Transfer"</span></span>,<span class="hljs-string">"type"</span><span class="hljs-symbol">:<span class="hljs-string">"event"</span></span>}])
</code></pre> 
  <h5 id="4-合约部署上交易链">4. 合约部署上交易链</h5> 
  <p>其实就是执行编码后的第二行代码</p> 
  <pre class="prettyprint"><code class=" hljs lasso"><span class="hljs-subst">&gt;</span> token <span class="hljs-subst">=</span> tokenContract<span class="hljs-built_in">.</span><span class="hljs-literal">new</span>(
<span class="hljs-attribute">...</span>    {
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>      <span class="hljs-built_in">data</span>: <span class="hljs-string">'0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029'</span>,
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>      gas: <span class="hljs-string">'4700000'</span>
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>    }, function (e, contract){
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>     console<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span>(e, contract);
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>     <span class="hljs-keyword">if</span> (typeof contract<span class="hljs-built_in">.</span>address <span class="hljs-subst">!==</span> <span class="hljs-string">'undefined'</span>) {
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>          console<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span>(<span class="hljs-string">'Contract mined! address: '</span> <span class="hljs-subst">+</span> contract<span class="hljs-built_in">.</span>address <span class="hljs-subst">+</span> <span class="hljs-string">' transactionHash: '</span> <span class="hljs-subst">+</span> contract<span class="hljs-built_in">.</span>transactionHash);
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>     }
<span class="hljs-attribute">...</span><span class="hljs-attribute">...</span>  })
Error: authentication needed: password <span class="hljs-literal">or</span> unlock undefined
undefined
<span class="hljs-subst">&gt;</span></code></pre> 
  <p>这里报了异常,原因是账户没有解锁进行解锁</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; personal<span class="hljs-preprocessor">.unlockAccount</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
Unlock account <span class="hljs-number">0x53099d033d847921e44812067d720d17b133a2d8</span>
<span class="hljs-label">Passphrase:</span>
true</code></pre> 
  <p>再次执行</p> 
  <pre class="prettyprint"><code class=" hljs coffeescript">&gt; <span class="hljs-reserved">var</span> token = tokenContract.<span class="hljs-keyword">new</span>(   {     <span class="hljs-attribute">from</span>: web3.eth.accounts[<span class="hljs-number">0</span>],      <span class="hljs-attribute">data</span>: <span class="hljs-string">'0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080&gt; token = tokenContract.new( { from: web3.eth.accounts[0], data: '</span><span class="hljs-number">0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029</span><span class="hljs-string">', gas: '</span><span class="hljs-number">4700000</span><span class="hljs-string">' }, function (e, contract){ console.log(e, contract); if (typeof contract.address !== '</span><span class="hljs-literal">undefined</span><span class="hljs-string">') { console.log('</span>Contract mined! <span class="hljs-attribute">address</span>: <span class="hljs-string">' + contract.address + '</span> <span class="hljs-attribute">transactionHash</span>: <span class="hljs-string">' + contract.transactionHash); } }) INFO [08-31|17:06:15.864] Submitted contract creation fullhash=0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8 contract=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25 null [object Object]</span></code></pre> 
  <p>这里再次执行还是失败,原因需要去掉换行符及var变量关健字</p> 
  <p>再次执行</p> 
  <pre class="prettyprint"><code class=" hljs actionscript">&gt; token = tokenContract.<span class="hljs-keyword">new</span>(   {     from: web3.eth.accounts[<span class="hljs-number">0</span>],      data: <span class="hljs-string">'0x6060604052341561000c57fe5b5b61042a8061001c6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063867904b41461005c578063a9059cbb1461009b578063c2412676146100da578063f8b2cb4f146100ec575bfe5b341561006457fe5b610099600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610136565b005b34156100a357fe5b6100d8600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506101e5565b005b34156100e257fe5b6100ea610370565b005b34156100f457fe5b610120600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506103b4565b6040518082815260200191505060405180910390f35b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156101935760006000fd5b80600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505b5050565b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205410156102325760006000fd5b80600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254039250508190555080600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055507fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef338383604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390a15b5050565b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b9190505600a165627a7a7230582001290f3be2be06979e6b7120c8b0e6b5440aeee14a5fade1d3a161c4599425490029'</span>,      gas: <span class="hljs-string">'4700000'</span>   }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e, contract)</span>{</span>    console.log(e, contract);    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> contract.address !== <span class="hljs-string">'undefined'</span>) {         console.log(<span class="hljs-string">'Contract mined! address: '</span> + contract.address + <span class="hljs-string">' transactionHash: '</span> + contract.transactionHash);    } })</code></pre> 
  <p>如出现交易记录的hash值.代表部署成功</p> 
  <pre class="prettyprint"><code class=" hljs http">  <span class="hljs-attribute">address</span>: <span class="hljs-string">undefined,</span>
  <span class="hljs-attribute">transactionHash</span>: <span class="hljs-string">"0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8"</span></code></pre> 
  <p>如需要部署成功需要进行挖矿确认</p> 
  <pre class="prettyprint"><code class=" hljs 1c">&gt; miner.start()
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:17.651] Updated mining threads threads=0</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:17.651] Transaction pool price threshold updated price=18000000000</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:17.651] Starting mining operation</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:17.654] Commit new mining work number=253 txs=1 uncles=0 elapsed=2.507ms</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:18.517] Successfully sealed new block number=253 hash=508765…aedfbb</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:18.519] ? block reached canonical chain number=248 hash=a31bb8…40e316</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:18.519] ? mined potential block number=253 hash=508765…aedfbb</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:11:18.520] Commit new mining work number=254 txs=1 uncles=0 elapsed=385.673µs</span></code></pre> 
  <p>根据交易记录hash查询详细信息</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">&gt; eth.getTransactionReceipt(<span class="hljs-string">"0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8"</span>)
{
  blockHash: <span class="hljs-string">"0x48fbf85484c083b808fecf3cc75c7e200187369f24f2dbeeaca0b244274ba117"</span>,
  blockNumber: <span class="hljs-number">256</span>,
  contractAddress: <span class="hljs-string">"0x8ed7065cc990fbb38c8f5a80739722ecc8ab9e25"</span>,
  cumulativeGasUsed: <span class="hljs-number">336109</span>,
  <span class="hljs-built_in">from</span>: <span class="hljs-string">"0x53099d033d847921e44812067d720d17b133a2d8"</span>,
  gasUsed: <span class="hljs-number">336109</span>,
  logs: [],
  logsBloom: <span class="hljs-string">"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>,
  root: <span class="hljs-string">"0xca618cac97da3ff654524bfe70d51359f41bc58526c996405ca43f19472edb58"</span>,
  <span class="hljs-built_in">to</span>: <span class="hljs-constant">null</span>,
  transactionHash: <span class="hljs-string">"0xe8f5aadb7c35abf8808996b84a3679db2282659d19e422949d405b9d6ff066c8"</span>,
  transactionIndex: <span class="hljs-number">0</span>
}
&gt;</code></pre> 
  <h5 id="5-发布代币">5. 发布代币</h5> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; token<span class="hljs-preprocessor">.issue</span><span class="hljs-preprocessor">.sendTransaction</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>],<span class="hljs-number">500</span>,{from:eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]})
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span>|<span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">24.403</span>] Submitted transaction                    fullhash=<span class="hljs-number">0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f</span> recipient=<span class="hljs-number">0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25</span>
<span class="hljs-string">"0xa4bedeb003ad77dc943c0cde9044f02dc880b48be5324f919ca3b137493b413f"</span>
&gt;</code></pre> 
  <p>如出现异常需要解锁账户:</p> 
  <pre class="prettyprint"><code class=" hljs css"><span class="hljs-tag">Error</span>: <span class="hljs-tag">authentication</span> <span class="hljs-tag">needed</span>: <span class="hljs-tag">password</span> <span class="hljs-tag">or</span> <span class="hljs-tag">unlock</span>
    <span class="hljs-tag">at</span> <span class="hljs-tag">web3</span><span class="hljs-class">.js</span><span class="hljs-pseudo">:3143</span><span class="hljs-pseudo">:20</span>
    <span class="hljs-tag">at</span> <span class="hljs-tag">web3</span><span class="hljs-class">.js</span><span class="hljs-pseudo">:6347</span><span class="hljs-pseudo">:15</span>
    <span class="hljs-tag">at</span> <span class="hljs-tag">web3</span><span class="hljs-class">.js</span><span class="hljs-pseudo">:5081</span><span class="hljs-pseudo">:36</span>
    <span class="hljs-tag">at</span> <span class="hljs-tag">web3</span><span class="hljs-class">.js</span><span class="hljs-pseudo">:4137</span><span class="hljs-pseudo">:16</span>
    <span class="hljs-tag">at</span> &lt;<span class="hljs-tag">anonymous</span>&gt;<span class="hljs-pseudo">:1</span><span class="hljs-pseudo">:1</span>
</code></pre> 
  <p>设置发币账户</p> 
  <pre class="prettyprint"><code class=" hljs profile">&gt; <span class="hljs-filename">token.Token({from</span>:<span class="hljs-filename">eth.accounts[0]}) INFO [08-31|17</span>:<span class="hljs-number">49</span>:<span class="hljs-number">01.149</span>] Submitted transaction                    fullhash=<span class="hljs-number">0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3</span> recipient=<span class="hljs-number">0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25</span>
<span class="hljs-string">"0x306833e2870653723b320aa771e41d495d67d62c1a62ea8bb92b146d282993f3"</span>
&gt;</code></pre> 
  <p>充值并进行挖矿交易确认</p> 
  <pre class="prettyprint"><code class=" hljs 1c">&gt; token.issue(eth.accounts[<span class="hljs-number">0</span>],<span class="hljs-number">100</span>,{from:eth.accounts[<span class="hljs-number">0</span>]})
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:49:11.393] Submitted transaction fullhash=0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b recipient=0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25</span>
<span class="hljs-string">"0xb5c46bc08695075863e58e5befe1b19340b1a7760c61b713a58a3044750ca52b"</span>
&gt; miner.start()
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:49:27.068] Updated mining threads threads=0</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:49:27.068] Transaction pool price threshold updated price=18000000000</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span><span class="hljs-string">|17:49:27.068] Starting mining operation</span></code></pre> 
  <p>查询代码已经拥有100个代币了</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; token<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">100</span>
&gt;
<span class="hljs-preprocessor">## 交易</span>
&gt; token<span class="hljs-preprocessor">.transfer</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">1</span>],<span class="hljs-number">20</span>,{from:eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]})
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span>|<span class="hljs-number">17</span>:<span class="hljs-number">53</span>:<span class="hljs-number">33.240</span>] Submitted transaction                    fullhash=<span class="hljs-number">0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f</span> recipient=<span class="hljs-number">0x8ED7065Cc990Fbb38C8f5A80739722ECC8ab9e25</span>
<span class="hljs-string">"0x5d397234eee995918901a6266e00ab0af4a1223f82a2ab6fb725f37ef0b3423f"</span>
<span class="hljs-preprocessor">## 挖矿 进行交易确认</span>
&gt; miner<span class="hljs-preprocessor">.start</span>()
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span>|<span class="hljs-number">17</span>:<span class="hljs-number">53</span>:<span class="hljs-number">41.179</span>] Updated mining threads                   threads=<span class="hljs-number">0</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">31</span>|<span class="hljs-number">17</span>:<span class="hljs-number">53</span>:<span class="hljs-number">41.179</span>] Transaction pool price threshold updated 
price=<span class="hljs-number">18000000000</span>
....

<span class="hljs-preprocessor">## 代币查询发现交易已经成功.账户代币数量已经变更</span>
&gt; token<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">80</span>
&gt; token<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">1</span>])
<span class="hljs-number">20</span>
&gt;</code></pre> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/GeekSnow/article/details/82260172,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/GeekSnow/article/details/82260172,&quot;}">阅读更多</a> 
 <a class="btn" href="https://passport.csdn.net/account/login?utm_source=csdn_blog_pc_more_login" target="_self" id="btn-lobinreadmore" data-track-view="{&quot;mod&quot;:&quot;popu_557&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/GeekSnow/article/details/82260172,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_557&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/GeekSnow/article/details/82260172,&quot;}">登录后自动展开</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
