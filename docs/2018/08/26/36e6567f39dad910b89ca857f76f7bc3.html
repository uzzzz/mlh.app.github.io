<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>以太坊实战：一个简单转账的实现 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="以太坊实战：一个简单转账的实现" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/zg_hover/article/details/82081572 概述 本文讲解了如何通过以太坊私链来进行转账。在学习以太坊实战之前，请先根据我写的这篇文章搭建好以太坊的私有链。 基于以太坊私链模拟转账 进入控制台 先按上一篇文章开启一个节点，可以先通过命令：miner.stop()停止挖矿。再按以下命令进入控制台： geth --datadir &quot;./db&quot; attach ipc:./db/geth.ipc 1. 新建账户 为了完成转账，我们首先需要创建两个账号，如下： 创建第一个账户 &gt; personal.newAccount(&quot;hover&quot;) &quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot; &gt; personal.newAccount函数的参数是账户的密码。执行成功后会返回账户的公钥，生成的账户文件在keystore文件夹下，此时工作目录geth的目录结构如下： ├── db │ ├── geth │ │ ├── chaindata │ │ │ ├── 000002.ldb │ │ │ ├── 000003.log │ │ │ ├── CURRENT │ │ │ ├── CURRENT.bak │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000004 │ │ ├── lightchaindata │ │ │ ├── 000001.log │ │ │ ├── CURRENT │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000000 │ │ ├── LOCK │ │ ├── nodekey │ │ ├── nodes │ │ │ ├── 000001.log │ │ │ ├── CURRENT │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000000 │ │ └── transactions.rlp │ ├── geth.ipc │ └── keystore │ └── UTC--2018-08-26T03-56-48.638581930Z--8663aca6d67330041e3218de54e3123bcea9e866 其中账户信息在keystore文件夹下。 创建第2个账户 &gt; personal.newAccount(&quot;123&quot;) &quot;0x96c275557213349816d57c4b482378eef1552150&quot; 再看一下keystore下的目录结构： └── keystore │ ├── UTC--2018-08-26T03-56-48.638581930Z--8663aca6d67330041e3218de54e3123bcea9e866 │ └── UTC--2018-08-26T04-02-57.501956829Z--96c275557213349816d57c4b482378eef1552150 查看一下目前账户的情况： &gt; eth.accounts [&quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot;, &quot;0x96c275557213349816d57c4b482378eef1552150&quot;] 好了，现在我们已经有了两个账户。 2.查看余额 要完成转账首先需要有余额，我先查看一下目前账户的余额情况： &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 0 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[1]), &quot;ether&quot;) 0 eth.accounts[index]会按传入的索引返回已有的账户。eth.getBalance(address)会返回账户的余额，余额以wei为单位。传入的参数是账户的公钥，web3.fromWei单位转换，在这个例子中是将wei转换成ether。 通过以上例子我们看到两个账户的余额都是0，我们需要通过挖矿开获取以太币，下面来挖矿。 3.挖矿 在挖矿前，我们需要设置挖矿的奖励地址。 * 设置奖励地址 &gt; miner.setEtherbase(eth.accounts[0]) true 查看是否设置成功 &gt; eth.coinbase &quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot; &gt; eth.accounts [&quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot;, &quot;0x96c275557213349816d57c4b482378eef1552150&quot;] eth.coinbase是设置的奖励地址。从以上命令，我们可以看到，已经设置成功了。 开始挖矿 miner.start(1) start的参数是线程数，我这里设置的是1。此时要是attach到某个节点上，那么可以该节点上看到对应的输出： ... INFO [08-26|15:36:22.591] Successfully sealed new block number=31 hash=14416f…bf92ab elapsed=550.351ms INFO [08-26|15:36:22.592] ? block reached canonical chain number=26 hash=034961…db0845 INFO [08-26|15:36:22.592] ? mined potential block number=31 hash=14416f…bf92ab INFO [08-26|15:36:22.592] Commit new mining work number=32 uncles=0 txs=0 gas=0 fees=0 elapsed=116.351µs INFO [08-26|15:36:23.070] Successfully sealed new block number=32 hash=ea42ae…74e5a4 elapsed=477.569ms INFO [08-26|15:36:23.070] ? block reached canonical chain number=27 hash=9d3a02…ea355a INFO [08-26|15:36:23.070] ? mined potential block number=32 hash=ea42ae…74e5a4 INFO [08-26|15:36:23.070] Commit new mining work number=33 uncles=0 txs=0 gas=0 fees=0 elapsed=119.824µs INFO [08-26|15:36:23.548] Successfully sealed new block number=33 hash=7e4983…8995f0 elapsed=478.359ms INFO [08-26|15:36:23.549] ? block reached canonical chain number=28 hash=8d8380…e21886 INFO [08-26|15:36:23.549] ? mined potential block ... 停止挖矿 miner.stop() 查看现在的余额 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 415 4.解锁账号 在开始转账之前需要先解锁账号，否则会报错。 &gt; personal.unlockAccount(eth.accounts[0], &quot;123&quot;, 900) true 其中的第1个参数是：账户。第2个参数是：密码。第3个参数是：解锁的持续时间。 5. 交易：转账 &gt;eth.sendTransaction({from: eth.accounts[0], to : eth.accounts[1], value: web3.toWei(10, &quot;ether&quot;)}) &quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot; 当交易发送到区块链后，会返回一个交易的hash，此时的交易正在矿工的交易池中等待被打包。可以查看交易池中等待被打包的交易: &gt; txpool.status { pending: 1, queued: 0 } 有一个交易被pending，还没有被处理。可以查看pending交易的详情： &gt; txpool.inspect.pending { 0xDaE3d4234AD88421Bb4Dd5033143d25d8760DbfA: { 0: &quot;0xFF50D7746384D7e5a8769EA5501B2f894C241a14: 10000000000000000000 wei + 90000 gas × 18000000000 wei&quot; } } 6. 再次挖矿，让交易被处理 要让交易被处理，就必须要挖矿。我们启动挖矿，然后等待挖到一个区块链后就停止： &gt; miner.start(1); admin.sleepBlocks(1); miner.stop(); true 再查看未被处理的交易情况： &gt; txpool.inspect.pending {} 可以看到，已经没有未被处理的交易。 查看余额：确认交易成功 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 410 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[1]), &quot;ether&quot;) 10 可以看到，交易已经成功，成功的把10个以太币从账户0，转移到账户1。但这里的数量好像不对？ 415-10=405，应该剩下405，怎么剩下410呢？ 原因是，这里的coinbase账号是account[0]，而每个区块生成的(挖矿成功)的奖励是5，所以这里是405+5=410。 这说明，我们的转账成功了。 查看交易详情 把刚才发起交易时返回的交易hash值传入eth.getTransaction函数，即可得到交易的详情。 &gt; eth.getTransaction(&quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;) { blockHash: &quot;0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4&quot;, blockNumber: 108, from: &quot;0xdae3d4234ad88421bb4dd5033143d25d8760dbfa&quot;, gas: 90000, gasPrice: 18000000000, hash: &quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;, input: &quot;0x&quot;, nonce: 0, r: &quot;0x10dec63e3844284d2568e68c233ddbdfedf287783e8db03749e38da632acf109&quot;, s: &quot;0x53ff6bc3821140a1711d98e26a4d3ca161af341605543f3ee8377a28032b70d7&quot;, to: &quot;0xff50d7746384d7e5a8769ea5501b2f894c241a14&quot;, transactionIndex: 0, v: &quot;0x4c&quot;, value: 10000000000000000000 } 查看区块详情 从交易的详情中可以得到区块号，通过eth.getBlock函数，可以获取到某个区块号的区块的详细信息。 &gt; eth.getBlock(108) { difficulty: 131834, extraData: &quot;0xd98301080e846765746888676f312e31302e318664617277696e&quot;, gasLimit: 3864853197, gasUsed: 21000, hash: &quot;0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0xdae3d4234ad88421bb4dd5033143d25d8760dbfa&quot;, mixHash: &quot;0x7e58396f67a9e4cc706d29c54544492caa6b44b04b4cb7e9e62e6f6642333be3&quot;, nonce: &quot;0x6bde023f861f3089&quot;, number: 108, parentHash: &quot;0x43832c74e796c1b22675419ddfc66374e2aa283174d864fb6fd5179ef4419a01&quot;, receiptsRoot: &quot;0xb1e76317cdac9eed95b9e30439dc4020f130f2b5d66b8c31d07906a0aef096a7&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 652, stateRoot: &quot;0x30866579a619eaa4e0894d99e4fbbc1f1877f8ff9182e528b71ee02921ac766b&quot;, timestamp: 1535269782, totalDifficulty: 14391713, transactions: [&quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;], transactionsRoot: &quot;0x7adf91188514ae548ca69b6b25c8e66c757340009630c39a8d4af60c0aecaf13&quot;, uncles: [] } 获取创世块的信息 &gt; eth.getBlock(0) { difficulty: 1, extraData: &quot;0x777573686f756865&quot;, gasLimit: 4294967295, gasUsed: 0, hash: &quot;0x8c0faf797027b7e1f0fc0528ef73ec4b7cf2c9d19f358c19a0d770506737fa8e&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0x0000000000000000000000000000000000000000&quot;, mixHash: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, nonce: &quot;0x0000000000000001&quot;, number: 0, parentHash: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, receiptsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 513, stateRoot: &quot;0x614bf1b5ff99d2d78f80b391f520819f5cc0d873c822944a9497b9aabae5b159&quot;, timestamp: 0, totalDifficulty: 1, transactions: [], transactionsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, uncles: [] } 总结 本文描述了如何通过以太坊私有链的命令来发起交易，查看区块信息，执行交易等操作。并结合一个转账的场景进行了模拟使用。 阅读更多" />
<meta property="og:description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/zg_hover/article/details/82081572 概述 本文讲解了如何通过以太坊私链来进行转账。在学习以太坊实战之前，请先根据我写的这篇文章搭建好以太坊的私有链。 基于以太坊私链模拟转账 进入控制台 先按上一篇文章开启一个节点，可以先通过命令：miner.stop()停止挖矿。再按以下命令进入控制台： geth --datadir &quot;./db&quot; attach ipc:./db/geth.ipc 1. 新建账户 为了完成转账，我们首先需要创建两个账号，如下： 创建第一个账户 &gt; personal.newAccount(&quot;hover&quot;) &quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot; &gt; personal.newAccount函数的参数是账户的密码。执行成功后会返回账户的公钥，生成的账户文件在keystore文件夹下，此时工作目录geth的目录结构如下： ├── db │ ├── geth │ │ ├── chaindata │ │ │ ├── 000002.ldb │ │ │ ├── 000003.log │ │ │ ├── CURRENT │ │ │ ├── CURRENT.bak │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000004 │ │ ├── lightchaindata │ │ │ ├── 000001.log │ │ │ ├── CURRENT │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000000 │ │ ├── LOCK │ │ ├── nodekey │ │ ├── nodes │ │ │ ├── 000001.log │ │ │ ├── CURRENT │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000000 │ │ └── transactions.rlp │ ├── geth.ipc │ └── keystore │ └── UTC--2018-08-26T03-56-48.638581930Z--8663aca6d67330041e3218de54e3123bcea9e866 其中账户信息在keystore文件夹下。 创建第2个账户 &gt; personal.newAccount(&quot;123&quot;) &quot;0x96c275557213349816d57c4b482378eef1552150&quot; 再看一下keystore下的目录结构： └── keystore │ ├── UTC--2018-08-26T03-56-48.638581930Z--8663aca6d67330041e3218de54e3123bcea9e866 │ └── UTC--2018-08-26T04-02-57.501956829Z--96c275557213349816d57c4b482378eef1552150 查看一下目前账户的情况： &gt; eth.accounts [&quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot;, &quot;0x96c275557213349816d57c4b482378eef1552150&quot;] 好了，现在我们已经有了两个账户。 2.查看余额 要完成转账首先需要有余额，我先查看一下目前账户的余额情况： &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 0 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[1]), &quot;ether&quot;) 0 eth.accounts[index]会按传入的索引返回已有的账户。eth.getBalance(address)会返回账户的余额，余额以wei为单位。传入的参数是账户的公钥，web3.fromWei单位转换，在这个例子中是将wei转换成ether。 通过以上例子我们看到两个账户的余额都是0，我们需要通过挖矿开获取以太币，下面来挖矿。 3.挖矿 在挖矿前，我们需要设置挖矿的奖励地址。 * 设置奖励地址 &gt; miner.setEtherbase(eth.accounts[0]) true 查看是否设置成功 &gt; eth.coinbase &quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot; &gt; eth.accounts [&quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot;, &quot;0x96c275557213349816d57c4b482378eef1552150&quot;] eth.coinbase是设置的奖励地址。从以上命令，我们可以看到，已经设置成功了。 开始挖矿 miner.start(1) start的参数是线程数，我这里设置的是1。此时要是attach到某个节点上，那么可以该节点上看到对应的输出： ... INFO [08-26|15:36:22.591] Successfully sealed new block number=31 hash=14416f…bf92ab elapsed=550.351ms INFO [08-26|15:36:22.592] ? block reached canonical chain number=26 hash=034961…db0845 INFO [08-26|15:36:22.592] ? mined potential block number=31 hash=14416f…bf92ab INFO [08-26|15:36:22.592] Commit new mining work number=32 uncles=0 txs=0 gas=0 fees=0 elapsed=116.351µs INFO [08-26|15:36:23.070] Successfully sealed new block number=32 hash=ea42ae…74e5a4 elapsed=477.569ms INFO [08-26|15:36:23.070] ? block reached canonical chain number=27 hash=9d3a02…ea355a INFO [08-26|15:36:23.070] ? mined potential block number=32 hash=ea42ae…74e5a4 INFO [08-26|15:36:23.070] Commit new mining work number=33 uncles=0 txs=0 gas=0 fees=0 elapsed=119.824µs INFO [08-26|15:36:23.548] Successfully sealed new block number=33 hash=7e4983…8995f0 elapsed=478.359ms INFO [08-26|15:36:23.549] ? block reached canonical chain number=28 hash=8d8380…e21886 INFO [08-26|15:36:23.549] ? mined potential block ... 停止挖矿 miner.stop() 查看现在的余额 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 415 4.解锁账号 在开始转账之前需要先解锁账号，否则会报错。 &gt; personal.unlockAccount(eth.accounts[0], &quot;123&quot;, 900) true 其中的第1个参数是：账户。第2个参数是：密码。第3个参数是：解锁的持续时间。 5. 交易：转账 &gt;eth.sendTransaction({from: eth.accounts[0], to : eth.accounts[1], value: web3.toWei(10, &quot;ether&quot;)}) &quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot; 当交易发送到区块链后，会返回一个交易的hash，此时的交易正在矿工的交易池中等待被打包。可以查看交易池中等待被打包的交易: &gt; txpool.status { pending: 1, queued: 0 } 有一个交易被pending，还没有被处理。可以查看pending交易的详情： &gt; txpool.inspect.pending { 0xDaE3d4234AD88421Bb4Dd5033143d25d8760DbfA: { 0: &quot;0xFF50D7746384D7e5a8769EA5501B2f894C241a14: 10000000000000000000 wei + 90000 gas × 18000000000 wei&quot; } } 6. 再次挖矿，让交易被处理 要让交易被处理，就必须要挖矿。我们启动挖矿，然后等待挖到一个区块链后就停止： &gt; miner.start(1); admin.sleepBlocks(1); miner.stop(); true 再查看未被处理的交易情况： &gt; txpool.inspect.pending {} 可以看到，已经没有未被处理的交易。 查看余额：确认交易成功 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 410 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[1]), &quot;ether&quot;) 10 可以看到，交易已经成功，成功的把10个以太币从账户0，转移到账户1。但这里的数量好像不对？ 415-10=405，应该剩下405，怎么剩下410呢？ 原因是，这里的coinbase账号是account[0]，而每个区块生成的(挖矿成功)的奖励是5，所以这里是405+5=410。 这说明，我们的转账成功了。 查看交易详情 把刚才发起交易时返回的交易hash值传入eth.getTransaction函数，即可得到交易的详情。 &gt; eth.getTransaction(&quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;) { blockHash: &quot;0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4&quot;, blockNumber: 108, from: &quot;0xdae3d4234ad88421bb4dd5033143d25d8760dbfa&quot;, gas: 90000, gasPrice: 18000000000, hash: &quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;, input: &quot;0x&quot;, nonce: 0, r: &quot;0x10dec63e3844284d2568e68c233ddbdfedf287783e8db03749e38da632acf109&quot;, s: &quot;0x53ff6bc3821140a1711d98e26a4d3ca161af341605543f3ee8377a28032b70d7&quot;, to: &quot;0xff50d7746384d7e5a8769ea5501b2f894c241a14&quot;, transactionIndex: 0, v: &quot;0x4c&quot;, value: 10000000000000000000 } 查看区块详情 从交易的详情中可以得到区块号，通过eth.getBlock函数，可以获取到某个区块号的区块的详细信息。 &gt; eth.getBlock(108) { difficulty: 131834, extraData: &quot;0xd98301080e846765746888676f312e31302e318664617277696e&quot;, gasLimit: 3864853197, gasUsed: 21000, hash: &quot;0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0xdae3d4234ad88421bb4dd5033143d25d8760dbfa&quot;, mixHash: &quot;0x7e58396f67a9e4cc706d29c54544492caa6b44b04b4cb7e9e62e6f6642333be3&quot;, nonce: &quot;0x6bde023f861f3089&quot;, number: 108, parentHash: &quot;0x43832c74e796c1b22675419ddfc66374e2aa283174d864fb6fd5179ef4419a01&quot;, receiptsRoot: &quot;0xb1e76317cdac9eed95b9e30439dc4020f130f2b5d66b8c31d07906a0aef096a7&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 652, stateRoot: &quot;0x30866579a619eaa4e0894d99e4fbbc1f1877f8ff9182e528b71ee02921ac766b&quot;, timestamp: 1535269782, totalDifficulty: 14391713, transactions: [&quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;], transactionsRoot: &quot;0x7adf91188514ae548ca69b6b25c8e66c757340009630c39a8d4af60c0aecaf13&quot;, uncles: [] } 获取创世块的信息 &gt; eth.getBlock(0) { difficulty: 1, extraData: &quot;0x777573686f756865&quot;, gasLimit: 4294967295, gasUsed: 0, hash: &quot;0x8c0faf797027b7e1f0fc0528ef73ec4b7cf2c9d19f358c19a0d770506737fa8e&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0x0000000000000000000000000000000000000000&quot;, mixHash: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, nonce: &quot;0x0000000000000001&quot;, number: 0, parentHash: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, receiptsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 513, stateRoot: &quot;0x614bf1b5ff99d2d78f80b391f520819f5cc0d873c822944a9497b9aabae5b159&quot;, timestamp: 0, totalDifficulty: 1, transactions: [], transactionsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, uncles: [] } 总结 本文描述了如何通过以太坊私有链的命令来发起交易，查看区块信息，执行交易等操作。并结合一个转账的场景进行了模拟使用。 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-26T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/zg_hover/article/details/82081572 概述 本文讲解了如何通过以太坊私链来进行转账。在学习以太坊实战之前，请先根据我写的这篇文章搭建好以太坊的私有链。 基于以太坊私链模拟转账 进入控制台 先按上一篇文章开启一个节点，可以先通过命令：miner.stop()停止挖矿。再按以下命令进入控制台： geth --datadir &quot;./db&quot; attach ipc:./db/geth.ipc 1. 新建账户 为了完成转账，我们首先需要创建两个账号，如下： 创建第一个账户 &gt; personal.newAccount(&quot;hover&quot;) &quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot; &gt; personal.newAccount函数的参数是账户的密码。执行成功后会返回账户的公钥，生成的账户文件在keystore文件夹下，此时工作目录geth的目录结构如下： ├── db │ ├── geth │ │ ├── chaindata │ │ │ ├── 000002.ldb │ │ │ ├── 000003.log │ │ │ ├── CURRENT │ │ │ ├── CURRENT.bak │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000004 │ │ ├── lightchaindata │ │ │ ├── 000001.log │ │ │ ├── CURRENT │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000000 │ │ ├── LOCK │ │ ├── nodekey │ │ ├── nodes │ │ │ ├── 000001.log │ │ │ ├── CURRENT │ │ │ ├── LOCK │ │ │ ├── LOG │ │ │ └── MANIFEST-000000 │ │ └── transactions.rlp │ ├── geth.ipc │ └── keystore │ └── UTC--2018-08-26T03-56-48.638581930Z--8663aca6d67330041e3218de54e3123bcea9e866 其中账户信息在keystore文件夹下。 创建第2个账户 &gt; personal.newAccount(&quot;123&quot;) &quot;0x96c275557213349816d57c4b482378eef1552150&quot; 再看一下keystore下的目录结构： └── keystore │ ├── UTC--2018-08-26T03-56-48.638581930Z--8663aca6d67330041e3218de54e3123bcea9e866 │ └── UTC--2018-08-26T04-02-57.501956829Z--96c275557213349816d57c4b482378eef1552150 查看一下目前账户的情况： &gt; eth.accounts [&quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot;, &quot;0x96c275557213349816d57c4b482378eef1552150&quot;] 好了，现在我们已经有了两个账户。 2.查看余额 要完成转账首先需要有余额，我先查看一下目前账户的余额情况： &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 0 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[1]), &quot;ether&quot;) 0 eth.accounts[index]会按传入的索引返回已有的账户。eth.getBalance(address)会返回账户的余额，余额以wei为单位。传入的参数是账户的公钥，web3.fromWei单位转换，在这个例子中是将wei转换成ether。 通过以上例子我们看到两个账户的余额都是0，我们需要通过挖矿开获取以太币，下面来挖矿。 3.挖矿 在挖矿前，我们需要设置挖矿的奖励地址。 * 设置奖励地址 &gt; miner.setEtherbase(eth.accounts[0]) true 查看是否设置成功 &gt; eth.coinbase &quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot; &gt; eth.accounts [&quot;0x8663aca6d67330041e3218de54e3123bcea9e866&quot;, &quot;0x96c275557213349816d57c4b482378eef1552150&quot;] eth.coinbase是设置的奖励地址。从以上命令，我们可以看到，已经设置成功了。 开始挖矿 miner.start(1) start的参数是线程数，我这里设置的是1。此时要是attach到某个节点上，那么可以该节点上看到对应的输出： ... INFO [08-26|15:36:22.591] Successfully sealed new block number=31 hash=14416f…bf92ab elapsed=550.351ms INFO [08-26|15:36:22.592] ? block reached canonical chain number=26 hash=034961…db0845 INFO [08-26|15:36:22.592] ? mined potential block number=31 hash=14416f…bf92ab INFO [08-26|15:36:22.592] Commit new mining work number=32 uncles=0 txs=0 gas=0 fees=0 elapsed=116.351µs INFO [08-26|15:36:23.070] Successfully sealed new block number=32 hash=ea42ae…74e5a4 elapsed=477.569ms INFO [08-26|15:36:23.070] ? block reached canonical chain number=27 hash=9d3a02…ea355a INFO [08-26|15:36:23.070] ? mined potential block number=32 hash=ea42ae…74e5a4 INFO [08-26|15:36:23.070] Commit new mining work number=33 uncles=0 txs=0 gas=0 fees=0 elapsed=119.824µs INFO [08-26|15:36:23.548] Successfully sealed new block number=33 hash=7e4983…8995f0 elapsed=478.359ms INFO [08-26|15:36:23.549] ? block reached canonical chain number=28 hash=8d8380…e21886 INFO [08-26|15:36:23.549] ? mined potential block ... 停止挖矿 miner.stop() 查看现在的余额 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 415 4.解锁账号 在开始转账之前需要先解锁账号，否则会报错。 &gt; personal.unlockAccount(eth.accounts[0], &quot;123&quot;, 900) true 其中的第1个参数是：账户。第2个参数是：密码。第3个参数是：解锁的持续时间。 5. 交易：转账 &gt;eth.sendTransaction({from: eth.accounts[0], to : eth.accounts[1], value: web3.toWei(10, &quot;ether&quot;)}) &quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot; 当交易发送到区块链后，会返回一个交易的hash，此时的交易正在矿工的交易池中等待被打包。可以查看交易池中等待被打包的交易: &gt; txpool.status { pending: 1, queued: 0 } 有一个交易被pending，还没有被处理。可以查看pending交易的详情： &gt; txpool.inspect.pending { 0xDaE3d4234AD88421Bb4Dd5033143d25d8760DbfA: { 0: &quot;0xFF50D7746384D7e5a8769EA5501B2f894C241a14: 10000000000000000000 wei + 90000 gas × 18000000000 wei&quot; } } 6. 再次挖矿，让交易被处理 要让交易被处理，就必须要挖矿。我们启动挖矿，然后等待挖到一个区块链后就停止： &gt; miner.start(1); admin.sleepBlocks(1); miner.stop(); true 再查看未被处理的交易情况： &gt; txpool.inspect.pending {} 可以看到，已经没有未被处理的交易。 查看余额：确认交易成功 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[0]), &quot;ether&quot;) 410 &gt; balance = web3.fromWei(eth.getBalance(eth.accounts[1]), &quot;ether&quot;) 10 可以看到，交易已经成功，成功的把10个以太币从账户0，转移到账户1。但这里的数量好像不对？ 415-10=405，应该剩下405，怎么剩下410呢？ 原因是，这里的coinbase账号是account[0]，而每个区块生成的(挖矿成功)的奖励是5，所以这里是405+5=410。 这说明，我们的转账成功了。 查看交易详情 把刚才发起交易时返回的交易hash值传入eth.getTransaction函数，即可得到交易的详情。 &gt; eth.getTransaction(&quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;) { blockHash: &quot;0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4&quot;, blockNumber: 108, from: &quot;0xdae3d4234ad88421bb4dd5033143d25d8760dbfa&quot;, gas: 90000, gasPrice: 18000000000, hash: &quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;, input: &quot;0x&quot;, nonce: 0, r: &quot;0x10dec63e3844284d2568e68c233ddbdfedf287783e8db03749e38da632acf109&quot;, s: &quot;0x53ff6bc3821140a1711d98e26a4d3ca161af341605543f3ee8377a28032b70d7&quot;, to: &quot;0xff50d7746384d7e5a8769ea5501b2f894c241a14&quot;, transactionIndex: 0, v: &quot;0x4c&quot;, value: 10000000000000000000 } 查看区块详情 从交易的详情中可以得到区块号，通过eth.getBlock函数，可以获取到某个区块号的区块的详细信息。 &gt; eth.getBlock(108) { difficulty: 131834, extraData: &quot;0xd98301080e846765746888676f312e31302e318664617277696e&quot;, gasLimit: 3864853197, gasUsed: 21000, hash: &quot;0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0xdae3d4234ad88421bb4dd5033143d25d8760dbfa&quot;, mixHash: &quot;0x7e58396f67a9e4cc706d29c54544492caa6b44b04b4cb7e9e62e6f6642333be3&quot;, nonce: &quot;0x6bde023f861f3089&quot;, number: 108, parentHash: &quot;0x43832c74e796c1b22675419ddfc66374e2aa283174d864fb6fd5179ef4419a01&quot;, receiptsRoot: &quot;0xb1e76317cdac9eed95b9e30439dc4020f130f2b5d66b8c31d07906a0aef096a7&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 652, stateRoot: &quot;0x30866579a619eaa4e0894d99e4fbbc1f1877f8ff9182e528b71ee02921ac766b&quot;, timestamp: 1535269782, totalDifficulty: 14391713, transactions: [&quot;0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548&quot;], transactionsRoot: &quot;0x7adf91188514ae548ca69b6b25c8e66c757340009630c39a8d4af60c0aecaf13&quot;, uncles: [] } 获取创世块的信息 &gt; eth.getBlock(0) { difficulty: 1, extraData: &quot;0x777573686f756865&quot;, gasLimit: 4294967295, gasUsed: 0, hash: &quot;0x8c0faf797027b7e1f0fc0528ef73ec4b7cf2c9d19f358c19a0d770506737fa8e&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0x0000000000000000000000000000000000000000&quot;, mixHash: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, nonce: &quot;0x0000000000000001&quot;, number: 0, parentHash: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, receiptsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 513, stateRoot: &quot;0x614bf1b5ff99d2d78f80b391f520819f5cc0d873c822944a9497b9aabae5b159&quot;, timestamp: 0, totalDifficulty: 1, transactions: [], transactionsRoot: &quot;0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421&quot;, uncles: [] } 总结 本文描述了如何通过以太坊私有链的命令来发起交易，查看区块信息，执行交易等操作。并结合一个转账的场景进行了模拟使用。 阅读更多","@type":"BlogPosting","url":"/2018/08/26/36e6567f39dad910b89ca857f76f7bc3.html","headline":"以太坊实战：一个简单转账的实现","dateModified":"2018-08-26T00:00:00+08:00","datePublished":"2018-08-26T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/08/26/36e6567f39dad910b89ca857f76f7bc3.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>以太坊实战：一个简单转账的实现</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/zg_hover/article/details/82081572 
 </div> 
 <div class="markdown_views"> 
  <h2 id="概述">概述</h2> 
  <p>本文讲解了如何通过以太坊私链来进行转账。在学习以太坊实战之前，请先根据<a href="https://blog.csdn.net/zg_hover/article/details/82080958" rel="nofollow">我写的这篇文章</a>搭建好以太坊的私有链。</p> 
  <h2 id="基于以太坊私链模拟转账">基于以太坊私链模拟转账</h2> 
  <h3 id="进入控制台">进入控制台</h3> 
  <p>先按上一篇文章开启一个节点，可以先通过命令：miner.stop()停止挖矿。再按以下命令进入控制台：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">geth --datadir <span class="hljs-string">"./db"</span> attach ipc:./db/geth<span class="hljs-preprocessor">.ipc</span></code></pre> 
  <h3 id="1-新建账户">1. 新建账户</h3> 
  <p>为了完成转账，我们首先需要创建两个账号，如下：</p> 
  <ul> 
   <li>创建第一个账户</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; personal<span class="hljs-preprocessor">.newAccount</span>(<span class="hljs-string">"hover"</span>)
<span class="hljs-string">"0x8663aca6d67330041e3218de54e3123bcea9e866"</span>
&gt; </code></pre> 
  <p>personal.newAccount函数的参数是账户的密码。执行成功后会返回账户的公钥，生成的账户文件在keystore文件夹下，此时工作目录geth的目录结构如下：</p> 
  <pre class="prettyprint"><code class=" hljs sql">├── db
│   ├── geth
│   │   ├── chaindata
│   │   │   ├── 000002.ldb
│   │   │   ├── 000003.log
│   │   │   ├── CURRENT
│   │   │   ├── CURRENT.bak
│   │   │   ├── <span class="hljs-operator"><span class="hljs-keyword">LOCK</span> │ │ │ ├── LOG │ │ │ └── MANIFEST-<span class="hljs-number">000004</span> │ │ ├── lightchaindata │ │ │ ├── <span class="hljs-number">000001.</span>log │ │ │ ├── <span class="hljs-keyword">CURRENT</span> │ │ │ ├── <span class="hljs-keyword">LOCK</span> │ │ │ ├── LOG │ │ │ └── MANIFEST-<span class="hljs-number">000000</span> │ │ ├── <span class="hljs-keyword">LOCK</span> │ │ ├── nodekey │ │ ├── nodes │ │ │ ├── <span class="hljs-number">000001.</span>log │ │ │ ├── <span class="hljs-keyword">CURRENT</span> │ │ │ ├── <span class="hljs-keyword">LOCK</span> │ │ │ ├── LOG │ │ │ └── MANIFEST-<span class="hljs-number">000000</span> │ │ └── transactions.rlp │ ├── geth.ipc │ └── keystore │ └── UTC--<span class="hljs-number">2018</span>-<span class="hljs-number">08</span>-<span class="hljs-number">26</span>T03-<span class="hljs-number">56</span>-<span class="hljs-number">48.638581930</span>Z--<span class="hljs-number">8663</span>aca6d67330041e3218de54e3123bcea9e866</span></code></pre> 
  <p>其中账户信息在keystore文件夹下。</p> 
  <ul> 
   <li>创建第2个账户</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; personal<span class="hljs-preprocessor">.newAccount</span>(<span class="hljs-string">"123"</span>)
<span class="hljs-string">"0x96c275557213349816d57c4b482378eef1552150"</span></code></pre> 
  <p>再看一下keystore下的目录结构：</p> 
  <pre class="prettyprint"><code class=" hljs brainfuck"> <span class="hljs-comment">└──</span> <span class="hljs-comment">keystore</span>
<span class="hljs-comment">│</span>       <span class="hljs-comment">├──</span> <span class="hljs-comment">UTC</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">2018</span><span class="hljs-literal">-</span><span class="hljs-comment">08</span><span class="hljs-literal">-</span><span class="hljs-comment">26T03</span><span class="hljs-literal">-</span><span class="hljs-comment">56</span><span class="hljs-literal">-</span><span class="hljs-comment">48</span><span class="hljs-string">.</span><span class="hljs-comment">638581930Z</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">8663aca6d67330041e3218de54e3123bcea9e866</span>
<span class="hljs-comment">│</span>       <span class="hljs-comment">└──</span> <span class="hljs-comment">UTC</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">2018</span><span class="hljs-literal">-</span><span class="hljs-comment">08</span><span class="hljs-literal">-</span><span class="hljs-comment">26T04</span><span class="hljs-literal">-</span><span class="hljs-comment">02</span><span class="hljs-literal">-</span><span class="hljs-comment">57</span><span class="hljs-string">.</span><span class="hljs-comment">501956829Z</span><span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">96c275557213349816d57c4b482378eef1552150</span></code></pre> 
  <p>查看一下目前账户的情况：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; eth<span class="hljs-preprocessor">.accounts</span>
[<span class="hljs-string">"0x8663aca6d67330041e3218de54e3123bcea9e866"</span>, <span class="hljs-string">"0x96c275557213349816d57c4b482378eef1552150"</span>]</code></pre> 
  <p>好了，现在我们已经有了两个账户。</p> 
  <h3 id="2查看余额">2.查看余额</h3> 
  <p>要完成转账首先需要有余额，我先查看一下目前账户的余额情况：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; balance = web3<span class="hljs-preprocessor">.fromWei</span>(eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]), <span class="hljs-string">"ether"</span>)
<span class="hljs-number">0</span>
&gt; balance = web3<span class="hljs-preprocessor">.fromWei</span>(eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">1</span>]), <span class="hljs-string">"ether"</span>)
<span class="hljs-number">0</span></code></pre> 
  <p>eth.accounts[index]会按传入的索引返回已有的账户。eth.getBalance(address)会返回账户的余额，余额以wei为单位。传入的参数是账户的公钥，web3.fromWei单位转换，在这个例子中是将wei转换成ether。</p> 
  <p>通过以上例子我们看到两个账户的余额都是0，我们需要通过挖矿开获取以太币，下面来挖矿。</p> 
  <h3 id="3挖矿">3.挖矿</h3> 
  <p>在挖矿前，我们需要设置挖矿的奖励地址。 <br> * 设置奖励地址</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; miner<span class="hljs-preprocessor">.setEtherbase</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
true</code></pre> 
  <ul> 
   <li>查看是否设置成功</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; eth<span class="hljs-preprocessor">.coinbase</span>
<span class="hljs-string">"0x8663aca6d67330041e3218de54e3123bcea9e866"</span>
&gt; eth<span class="hljs-preprocessor">.accounts</span>
[<span class="hljs-string">"0x8663aca6d67330041e3218de54e3123bcea9e866"</span>, <span class="hljs-string">"0x96c275557213349816d57c4b482378eef1552150"</span>]</code></pre> 
  <p>eth.coinbase是设置的奖励地址。从以上命令，我们可以看到，已经设置成功了。</p> 
  <ul> 
   <li>开始挖矿</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs sql">miner.<span class="hljs-operator"><span class="hljs-keyword">start</span>(<span class="hljs-number">1</span>)</span></code></pre> 
  <p>start的参数是线程数，我这里设置的是1。此时要是attach到某个节点上，那么可以该节点上看到对应的输出：</p> 
  <pre class="prettyprint"><code class=" hljs r"><span class="hljs-keyword">...</span>
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">22.591</span>] Successfully sealed new block            number=<span class="hljs-number">31</span> hash=14416f…bf92ab elapsed=<span class="hljs-number">550.</span>351ms
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">22.592</span>] ? block reached canonical chain          number=<span class="hljs-number">26</span> hash=<span class="hljs-number">034961</span>…db0845
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">22.592</span>] ? mined potential block                  number=<span class="hljs-number">31</span> hash=14416f…bf92ab
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">22.592</span>] Commit new mining work                   number=<span class="hljs-number">32</span> uncles=<span class="hljs-number">0</span> txs=<span class="hljs-number">0</span> gas=<span class="hljs-number">0</span> fees=<span class="hljs-number">0</span> elapsed=<span class="hljs-number">116.351</span>µs
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.070</span>] Successfully sealed new block            number=<span class="hljs-number">32</span> hash=ea42ae…74e5a4 elapsed=<span class="hljs-number">477.</span>569ms
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.070</span>] ? block reached canonical chain          number=<span class="hljs-number">27</span> hash=9d3a02…ea355a
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.070</span>] ? mined potential block                  number=<span class="hljs-number">32</span> hash=ea42ae…74e5a4
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.070</span>] Commit new mining work                   number=<span class="hljs-number">33</span> uncles=<span class="hljs-number">0</span> txs=<span class="hljs-number">0</span> gas=<span class="hljs-number">0</span> fees=<span class="hljs-number">0</span> elapsed=<span class="hljs-number">119.824</span>µs
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.548</span>] Successfully sealed new block            number=<span class="hljs-number">33</span> hash=<span class="hljs-number">7e4983</span>…8995f0 elapsed=<span class="hljs-number">478.</span>359ms
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.549</span>] ? block reached canonical chain          number=<span class="hljs-number">28</span> hash=8d8380…e21886
INFO [<span class="hljs-number">08</span>-<span class="hljs-number">26</span>|<span class="hljs-number">15</span>:<span class="hljs-number">36</span>:<span class="hljs-number">23.549</span>] ? mined potential block  
<span class="hljs-keyword">...</span></code></pre> 
  <ul> 
   <li>停止挖矿</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs vbnet">miner.<span class="hljs-keyword">stop</span>()</code></pre> 
  <ul> 
   <li>查看现在的余额</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; balance = web3<span class="hljs-preprocessor">.fromWei</span>(eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]), <span class="hljs-string">"ether"</span>)
<span class="hljs-number">415</span></code></pre> 
  <h3 id="4解锁账号">4.解锁账号</h3> 
  <p>在开始转账之前需要先解锁账号，否则会报错。</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; personal<span class="hljs-preprocessor">.unlockAccount</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>], <span class="hljs-string">"123"</span>, <span class="hljs-number">900</span>)
true</code></pre> 
  <p>其中的第1个参数是：账户。第2个参数是：密码。第3个参数是：解锁的持续时间。</p> 
  <h3 id="5-交易转账">5. 交易：转账</h3> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt;eth<span class="hljs-preprocessor">.sendTransaction</span>({from: eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>], to : eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">1</span>], value: web3<span class="hljs-preprocessor">.toWei</span>(<span class="hljs-number">10</span>, <span class="hljs-string">"ether"</span>)})
<span class="hljs-string">"0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548"</span></code></pre> 
  <p>当交易发送到区块链后，会返回一个交易的hash，此时的交易正在矿工的交易池中等待被打包。可以查看交易池中等待被打包的交易:</p> 
  <pre class="prettyprint"><code class=" hljs css">&gt; <span class="hljs-tag">txpool</span><span class="hljs-class">.status</span>
<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">pending</span>:<span class="hljs-value"> <span class="hljs-number">1</span>, queued: <span class="hljs-number">0</span> </span></span></span>}</code></pre> 
  <p>有一个交易被pending，还没有被处理。可以查看pending交易的详情：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; txpool<span class="hljs-preprocessor">.inspect</span><span class="hljs-preprocessor">.pending</span>
{
  <span class="hljs-number">0xDaE3d4234AD88421Bb4Dd5033143d25d8760DbfA</span>: {
    <span class="hljs-number">0</span>: <span class="hljs-string">"0xFF50D7746384D7e5a8769EA5501B2f894C241a14: 10000000000000000000 wei + 90000 gas × 18000000000 wei"</span>
  }
}</code></pre> 
  <h3 id="6-再次挖矿让交易被处理">6. 再次挖矿，让交易被处理</h3> 
  <p>要让交易被处理，就必须要挖矿。我们启动挖矿，然后等待挖到一个区块链后就停止：</p> 
  <pre class="prettyprint"><code class=" hljs vbnet">&gt; miner.start(<span class="hljs-number">1</span>); admin.sleepBlocks(<span class="hljs-number">1</span>); miner.<span class="hljs-keyword">stop</span>();
<span class="hljs-literal">true</span></code></pre> 
  <p>再查看未被处理的交易情况：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; txpool<span class="hljs-preprocessor">.inspect</span><span class="hljs-preprocessor">.pending</span>
{}</code></pre> 
  <p>可以看到，已经没有未被处理的交易。</p> 
  <h3 id="查看余额确认交易成功">查看余额：确认交易成功</h3> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; balance = web3<span class="hljs-preprocessor">.fromWei</span>(eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>]), <span class="hljs-string">"ether"</span>)
<span class="hljs-number">410</span>
&gt; balance = web3<span class="hljs-preprocessor">.fromWei</span>(eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">1</span>]), <span class="hljs-string">"ether"</span>)
<span class="hljs-number">10</span></code></pre> 
  <p>可以看到，交易已经成功，成功的把10个以太币从账户0，转移到账户1。但这里的数量好像不对？ <br> 415-10=405，应该剩下405，怎么剩下410呢？ <br> 原因是，这里的coinbase账号是account[0]，而每个区块生成的(挖矿成功)的奖励是5，所以这里是405+5=410。 <br> 这说明，我们的转账成功了。</p> 
  <h3 id="查看交易详情">查看交易详情</h3> 
  <p>把刚才发起交易时返回的交易hash值传入eth.getTransaction函数，即可得到交易的详情。</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">&gt; eth.getTransaction(<span class="hljs-string">"0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548"</span>)
{
  blockHash: <span class="hljs-string">"0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4"</span>,
  blockNumber: <span class="hljs-number">108</span>,
  <span class="hljs-built_in">from</span>: <span class="hljs-string">"0xdae3d4234ad88421bb4dd5033143d25d8760dbfa"</span>,
  gas: <span class="hljs-number">90000</span>,
  gasPrice: <span class="hljs-number">18000000000</span>,
  hash: <span class="hljs-string">"0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548"</span>,
  input: <span class="hljs-string">"0x"</span>,
  nonce: <span class="hljs-number">0</span>,
  r: <span class="hljs-string">"0x10dec63e3844284d2568e68c233ddbdfedf287783e8db03749e38da632acf109"</span>,
  s: <span class="hljs-string">"0x53ff6bc3821140a1711d98e26a4d3ca161af341605543f3ee8377a28032b70d7"</span>,
  <span class="hljs-built_in">to</span>: <span class="hljs-string">"0xff50d7746384d7e5a8769ea5501b2f894c241a14"</span>,
  transactionIndex: <span class="hljs-number">0</span>,
  v: <span class="hljs-string">"0x4c"</span>,
  <span class="hljs-built_in">value</span>: <span class="hljs-number">10000000000000000000</span>
}
</code></pre> 
  <h3 id="查看区块详情">查看区块详情</h3> 
  <p>从交易的详情中可以得到区块号，通过eth.getBlock函数，可以获取到某个区块号的区块的详细信息。</p> 
  <pre class="prettyprint"><code class=" hljs css">&gt; <span class="hljs-tag">eth</span><span class="hljs-class">.getBlock</span>(108)
<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">difficulty</span>:<span class="hljs-value"> <span class="hljs-number">131834</span>, extraData: <span class="hljs-string">"0xd98301080e846765746888676f312e31302e318664617277696e"</span>, gasLimit: <span class="hljs-number">3864853197</span>, gasUsed: <span class="hljs-number">21000</span>, hash: <span class="hljs-string">"0xf232c92c07bbb7c1728567515ade844190b975d481c1e9017d0fa7dc445d76c4"</span>, logsBloom: <span class="hljs-string">"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>, miner: <span class="hljs-string">"0xdae3d4234ad88421bb4dd5033143d25d8760dbfa"</span>, mixHash: <span class="hljs-string">"0x7e58396f67a9e4cc706d29c54544492caa6b44b04b4cb7e9e62e6f6642333be3"</span>, nonce: <span class="hljs-string">"0x6bde023f861f3089"</span>, number: <span class="hljs-number">108</span>, parentHash: <span class="hljs-string">"0x43832c74e796c1b22675419ddfc66374e2aa283174d864fb6fd5179ef4419a01"</span>, receiptsRoot: <span class="hljs-string">"0xb1e76317cdac9eed95b9e30439dc4020f130f2b5d66b8c31d07906a0aef096a7"</span>, sha3Uncles: <span class="hljs-string">"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"</span>, size: <span class="hljs-number">652</span>, stateRoot: <span class="hljs-string">"0x30866579a619eaa4e0894d99e4fbbc1f1877f8ff9182e528b71ee02921ac766b"</span>, timestamp: <span class="hljs-number">1535269782</span>, totalDifficulty: <span class="hljs-number">14391713</span>, transactions: [<span class="hljs-string">"0x4edf43809d4c5603a2dfd8496ddb056d1725ffd80e8afaf95132447f19168548"</span>], transactionsRoot: <span class="hljs-string">"0x7adf91188514ae548ca69b6b25c8e66c757340009630c39a8d4af60c0aecaf13"</span>, uncles: [] </span></span></span>}
</code></pre> 
  <h3 id="获取创世块的信息">获取创世块的信息</h3> 
  <pre class="prettyprint"><code class=" hljs css">&gt; <span class="hljs-tag">eth</span><span class="hljs-class">.getBlock</span>(0)
<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">difficulty</span>:<span class="hljs-value"> <span class="hljs-number">1</span>, extraData: <span class="hljs-string">"0x777573686f756865"</span>, gasLimit: <span class="hljs-number">4294967295</span>, gasUsed: <span class="hljs-number">0</span>, hash: <span class="hljs-string">"0x8c0faf797027b7e1f0fc0528ef73ec4b7cf2c9d19f358c19a0d770506737fa8e"</span>, logsBloom: <span class="hljs-string">"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>, miner: <span class="hljs-string">"0x0000000000000000000000000000000000000000"</span>, mixHash: <span class="hljs-string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span>, nonce: <span class="hljs-string">"0x0000000000000001"</span>, number: <span class="hljs-number">0</span>, parentHash: <span class="hljs-string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span>, receiptsRoot: <span class="hljs-string">"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"</span>, sha3Uncles: <span class="hljs-string">"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"</span>, size: <span class="hljs-number">513</span>, stateRoot: <span class="hljs-string">"0x614bf1b5ff99d2d78f80b391f520819f5cc0d873c822944a9497b9aabae5b159"</span>, timestamp: <span class="hljs-number">0</span>, totalDifficulty: <span class="hljs-number">1</span>, transactions: [], transactionsRoot: <span class="hljs-string">"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"</span>, uncles: [] </span></span></span>}</code></pre> 
  <h2 id="总结">总结</h2> 
  <p>本文描述了如何通过以太坊私有链的命令来发起交易，查看区块信息，执行交易等操作。并结合一个转账的场景进行了模拟使用。</p> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/zg_hover/article/details/82081572,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/zg_hover/article/details/82081572,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
