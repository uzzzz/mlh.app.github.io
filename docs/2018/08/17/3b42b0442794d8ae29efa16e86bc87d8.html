<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>区块链、超级账本调试笔记第二版 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="区块链、超级账本调试笔记第二版" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="https://hyperledger-fabric.readthedocs.io/en/release-1.2/install.html docker pull hyperledger/fabric-ca:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-peer:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-orderer:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-couchdb:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-tools:x86_64-1.2.0 $ docker images $ docker tag hyperledger/fabric-ca:1.2.0 hyperledger/fabric-ca \ &amp;&amp; docker tag hyperledger/fabric-peer:1.2.0 hyperledger/fabric-peer \ &amp;&amp; docker tag hyperledger/fabric-orderer:1.2.0 hyperledger/fabric-orderer \ &amp;&amp; docker tag hyperledger/fabric-couchdb:0.4.10 hyperledger/fabric-couchdb \ &amp;&amp; docker tag hyperledger/fabric-tools:1.2.0 hyperledger/fabric-tools\ &amp;&amp; docker tag hyperledger/fabric-ccenv:1.2.0 hyperledger/fabric-ccenv &nbsp; 启动docker service docker start 需要升级docker中的go版本 wget https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz sudo rm -rf /opt/go sudo tar -C /opt -xzvf go1.10.3.linux-amd64.tar.gz export $GOPATH=/opt/gopath export $GOROOT=/usr/local/go 往docker中传文件： docker inspect -f &#39;{{.Id}}&#39; cli f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298 docker cp mychaincode/ f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/ docker cp /opt/gopath/src/github.com/hyperledger/fabric f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric 从docker拷出文件 docker cp f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric/peer /opt/gopath/src/github.com/hyperledger/fabric/peer &nbsp; docker cp go1.10.3.linux-amd64.tar.gz f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric docker cp /opt/gopath/src/mychaincode 37ee6f7d4c3d97d878c3697ce8f449c1b6f74538fe9a5d8350fe06ed75f0d46b:/opt/gopath/src 部署： peer chaincode install -n tang -v 8.8 -p mychaincode peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; 查询 peer chaincode query -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; peer chaincode query -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;0:287&quot;]}&#39; 调用 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;billing&quot;,&quot;a&quot;,&quot;b&quot;,&quot;100&quot;,&quot;billing&quot;]}&#39; 升级 peer chaincode upgrade -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; &nbsp; 运行和启动Fabric例子 1、下载hyperledger/fabric-sample 2、切换到release-1.0 git checkout release-1.2 git branch -vv 3、下载bin到fabric-sample目录 https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.0.0/ https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/ wget https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz 3、进入first-network文件夹 ./byfn.sh -m up 4、关闭 ./byfn.sh -m down 5、初始化 ./byfn.sh -m generate ⽣成初始区块 $ ../bin/cryptogen generate --config=./crypto-config.yaml $ export FABRIC_CFG_PATH=$PWD $ ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block ⽣成应⽤通道的配置信息 $ export CHANNEL_NAME=mychannel $ ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME ⽣成锚节点配置更新⽂件 $ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP &nbsp; $ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP 操作⽹络(v1.2.0后不需要操作Alex.Zhang20180817) 编辑 docker-compose-cli.yaml ,注释到 command 命令 working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer # command: /bin/bash -c &#39;./scripts/script.sh ${CHANNEL_NAME}; sleep $TIMEOUT&#39; volumes 操作网络 $ CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d 更多区块链精品课程 请到优米 IT 学院： https://shop557190130.taobao.com/ 创建和加⼊通道 进⼊ docker 容器 $ docker exec -it cli bash 创建通道 $ export CHANNEL_NAME=mychannel $ peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem 加⼊通道 $ peer channel join -b mychannel.block 链上代码 （链码） 安装链码 $ peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 实例化链码 $ peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; 查询 $ peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}‘ 转账 $ peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}’ &nbsp; 以下启动REST API的web服务 在&nbsp;GOPATH&nbsp;的 root 目录中创建 docker-compose.yml 文件。粘贴以下内容： membersrvc: &nbsp;&nbsp;image: hyperledger/fabric-membersrvc &nbsp;&nbsp;ports: &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7054:7054&quot; &nbsp;&nbsp;command: membersrvc vp0: &nbsp;&nbsp;image: hyperledger/fabric-peer:x86_64-0.6.0-preview &nbsp;&nbsp;ports: &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7050:7050&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7051:7051&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7053:7053&quot; &nbsp;&nbsp;environment: &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ADDRESSAUTODETECT=true &nbsp;&nbsp;&nbsp;&nbsp;- CORE_VM_ENDPOINT=unix:///var/run/docker.sock &nbsp;&nbsp;&nbsp;&nbsp;- CORE_LOGGING_LEVEL=DEBUG &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ID=vp0 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_ECA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TCA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TLSCA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENABLED=false &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLID=test_vp0 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLSECRET=MwYpmSRjupbT &nbsp;&nbsp;links: &nbsp;&nbsp;&nbsp;&nbsp;- membersrvc &nbsp;&nbsp;command: sh -c &quot;sleep 5; peer node start --peer-chaincodedev&quot; &nbsp; 部署示例 Hyperledger Fabric 提供了一个用于与该结构交互的 REST Web 服务接口。与 fabric 的第一次交互是部署链代码。确保本地区块链网络正在运行，然后启动 SoapUI，单击&nbsp;REST&nbsp;按钮创建一个新的 REST 项目。您会看到一个类似图 3 的对话框，在其中输入用于所有 REST 请求的基础 URL： 图 3. SoapUI New REST Project 对话框 输入&nbsp;http://localhost:7050&nbsp;作为 URL，然后单击&nbsp;OK。端口&nbsp;7050&nbsp;是 fabric 使用的默认 REST 端口，而且因为区块链网络是在本地计算机上运行的，所以将使用&nbsp;localhost&nbsp;作为主机名。 在 SoapUI 启动后，可以执行一次快速冒烟测试，以确保它能与本地区块链网络进行通信。展开刚创建的新的 REST 资源，直到看到&nbsp;Request 1，然后在 Editor 窗口中打开它。使用&nbsp;GET&nbsp;方法，在&nbsp;resource&nbsp;下输入&nbsp;/chain。确保单击了 output 选项卡上的&nbsp;JSON&nbsp;选项，然后运行请求（通过单击&nbsp;arrow&nbsp;图标）。执行此请求时，会在 Editor 窗口右侧的输出选项卡中返回当前区块的哈希值，如图 4 所示 &nbsp; &nbsp; &nbsp; 2、关闭原有例子 3、第一终端进入chaincode-docker-devmode，启动网络 docker-compose -f docker-compose-simple.yaml up 4、第二终端进入docker docker exec -it chaincode bash 5、第二终端进入chaincode文件夹 /opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode 6、第二个终端启动chaincode CORE_PEER_ADDRESS=peer:7051 CORE_CHAINCODE_ID_NAME=mycc:0 ./chaincode002 7、第三个终端 docker exec -it cli bash &nbsp; 安装链码 peer chaincode install -p chaincodedev/chaincode/chaincode002 -n mycc -v 0 实例化链码 peer chaincode instantiate -n mycc -v 0 -c &#39;{&quot;Args&quot;:[&quot;str&quot;,&quot;helloworld&quot;]}&#39; -C myc # 查询链码 $ peer chaincode query -n mycc -c &#39;{&quot;Args&quot;:[&quot;get&quot;,&quot;str&quot;]}&#39; -C myc # 调用链码 peer chaincode invoke -n mycc -c &#39;{&quot;Args&quot;:[&quot;set&quot;, &quot;str&quot;, &quot;helloworld111&quot;]}&#39; -C myc # 查询链码 $ peer chaincode query -n mycc -c &#39;{&quot;Args&quot;:[&quot;get&quot;,&quot;str&quot;]}&#39; -C myc &nbsp; docker rm -f $(docker ps -aq) &nbsp; chaincode002 链码放入： /opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode &nbsp; &nbsp; chaincode002.go &nbsp; package main import( &quot;fmt&quot; &quot;github.com/hyperledger/fabric/core/chaincode/shim&quot; &quot;github.com/hyperledger/fabric/protos/peer&quot; ) type Helloworld struct { } func (t *Helloworld) Init(stub shim.ChaincodeStubInterface) peer.Response{ fmt.Println(&quot;helloworld init&quot;) args := stub.GetStringArgs() err := stub.PutState(args[0],[]byte(args[1])) if err != nil { shim.Error(fmt.Sprintf(&quot;helloworld init err %s&quot;,err)) } return shim.Success(nil) } func (t *Helloworld) Invoke(stub shim.ChaincodeStubInterface) peer.Response { fn,args := stub.GetFunctionAndParameters() var result string var err error if fn == &quot;set&quot; { result,err = set(stub,args) }else{ result,err = get(stub,args) } if err != nil { shim.Error(err.Error()) } return shim.Success([]byte(result)) } func set (stub shim.ChaincodeStubInterface, args []string) (string,error){ fmt.Println(&quot;helloworld set&quot;) err := stub.PutState(args[0],[]byte(args[1])) if err != nil { return &quot;&quot;, fmt.Errorf(&quot;Failed to set asset: %s&quot;, args[0]) } return args[0],nil } func get(stub shim.ChaincodeStubInterface, args []string) (string,error){ value, err := stub.GetState(args[0]) if err != nil { return &quot;&quot;, fmt.Errorf(&quot;Failed to get asset: %s&quot;, args[0]) } if value == nil { return &quot;&quot;, fmt.Errorf(&quot;Asset not found: %s&quot;, args[0]) } return string(value),nil } func main() { err := shim.Start(new(Helloworld)) if err != nil { fmt.Printf(&quot;shim start err %s&quot;,err) } } &nbsp; chaincode002_test.go &nbsp; package main import( &quot;fmt&quot; &quot;testing&quot; &quot;github.com/hyperledger/fabric/core/chaincode/shim&quot; ) func checkInit(t *testing.T, stub *shim.MockStub, args [][]byte) { res := stub.MockInit(&quot;1&quot;, args) if res.Status != shim.OK { fmt.Println(&quot;Init failed&quot;, string(res.Message)) t.FailNow() } } func checkQuery(t *testing.T, stub *shim.MockStub, name string) { res := stub.MockInvoke(&quot;1&quot;, [][]byte{[]byte(&quot;get&quot;), []byte(name)}) if res.Status != shim.OK { fmt.Println(&quot;Query&quot;, name, &quot;failed&quot;, string(res.Message)) t.FailNow() } if res.Payload == nil { fmt.Println(&quot;Query&quot;, name, &quot;failed to get value&quot;) t.FailNow() } fmt.Println(&quot;Query value&quot;, name, &quot;was &quot;, string(res.Payload)) } func checkInvoke(t *testing.T, stub *shim.MockStub, args [][]byte) { res := stub.MockInvoke(&quot;1&quot;, args) if res.Status != shim.OK { fmt.Println(&quot;Invoke&quot;, args, &quot;failed&quot;, string(res.Message)) t.FailNow() } } func Test_Helloworld(t *testing.T) { hello := new(Helloworld) stub := shim.NewMockStub(&quot;hello&quot;, hello) checkInit(t, stub, [][]byte{[]byte(&quot;str&quot;), []byte(&quot;helloworld&quot;)}) checkQuery(t, stub, &quot;str&quot;) checkInvoke(t, stub, [][]byte{[]byte(&quot;set&quot;), []byte(&quot;str&quot;),[]byte(&quot;helloworld-1111&quot;)}) checkQuery(t, stub, &quot;str&quot;) } &nbsp; &nbsp; &nbsp; 通过 go test -v helloworld_test.go helloworld.go 测试相应的方法，运行结果： === RUN Test_Helloworld helloworld init Query value str was helloworld helloworld set Query value str was helloworld-1111 --- PASS: Test_Helloworld (0.00s) PASS ok command-line-arguments 0.028s &nbsp; &nbsp; https://hyperledger.github.io/composer/latest/tutorials/developer-tutorial &nbsp; https://hyperledger.github.io/composer/latest/business-network/bnd-create Cloning an Example Business Network Definition The sample business network definitions are stored on GitHub at&nbsp;https://github.com/hyperledger/composer-sample-networks. You can&nbsp;git clone&nbsp;this repository to pull down all the sample networks. Each sample network is stored under the&nbsp;packages&nbsp;directory. Generating a Business Network Definition Generation yo hyperledger-composer Copy ? Please select the type of project: (Use arrow keys) ❯ Angular Business Network Model And select&nbsp;Business Netork Answer all of the questions Copy Welcome to the Hyperledger Composer project generator ? Please select the type of project: Business Network You can run this generator using: &#39;yo hyperledger-composer:businessnetwork&#39; Welcome to the business network generator ? Business network name: mynetwork ? Description: This is my test network ? Author name: Mr Conga ? Author email: conga@congazone.org ? License: Apache-2 ? Namespace: org.conga create package.json create permissions.acl create README.md create models/org.conga.cto create .eslintrc.yml create features/sample.feature create features/support/index.js create test/logic.js create lib/logic.js This generates a skeleton business network with an&nbsp;asset,&nbsp;participant&nbsp;and&nbsp;transaction&nbsp;defined, as well as a&nbsp;mocha&nbsp;unit test. Also included, is a &#39;best practice&#39; eslint config file which defines sample linting rules for JS code. &nbsp; 问题解决 修改 fabric-samples/basic-network/start.sh export FABRIC_START_TIMEOUT=300 //适当调大此值可以改善此问题 &nbsp; peer channel list &nbsp; 阅读更多" />
<meta property="og:description" content="https://hyperledger-fabric.readthedocs.io/en/release-1.2/install.html docker pull hyperledger/fabric-ca:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-peer:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-orderer:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-couchdb:x86_64-1.2.0 \ &amp;&amp; docker pull hyperledger/fabric-tools:x86_64-1.2.0 $ docker images $ docker tag hyperledger/fabric-ca:1.2.0 hyperledger/fabric-ca \ &amp;&amp; docker tag hyperledger/fabric-peer:1.2.0 hyperledger/fabric-peer \ &amp;&amp; docker tag hyperledger/fabric-orderer:1.2.0 hyperledger/fabric-orderer \ &amp;&amp; docker tag hyperledger/fabric-couchdb:0.4.10 hyperledger/fabric-couchdb \ &amp;&amp; docker tag hyperledger/fabric-tools:1.2.0 hyperledger/fabric-tools\ &amp;&amp; docker tag hyperledger/fabric-ccenv:1.2.0 hyperledger/fabric-ccenv &nbsp; 启动docker service docker start 需要升级docker中的go版本 wget https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz sudo rm -rf /opt/go sudo tar -C /opt -xzvf go1.10.3.linux-amd64.tar.gz export $GOPATH=/opt/gopath export $GOROOT=/usr/local/go 往docker中传文件： docker inspect -f &#39;{{.Id}}&#39; cli f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298 docker cp mychaincode/ f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/ docker cp /opt/gopath/src/github.com/hyperledger/fabric f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric 从docker拷出文件 docker cp f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric/peer /opt/gopath/src/github.com/hyperledger/fabric/peer &nbsp; docker cp go1.10.3.linux-amd64.tar.gz f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric docker cp /opt/gopath/src/mychaincode 37ee6f7d4c3d97d878c3697ce8f449c1b6f74538fe9a5d8350fe06ed75f0d46b:/opt/gopath/src 部署： peer chaincode install -n tang -v 8.8 -p mychaincode peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; 查询 peer chaincode query -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; peer chaincode query -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;0:287&quot;]}&#39; 调用 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;billing&quot;,&quot;a&quot;,&quot;b&quot;,&quot;100&quot;,&quot;billing&quot;]}&#39; 升级 peer chaincode upgrade -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; &nbsp; 运行和启动Fabric例子 1、下载hyperledger/fabric-sample 2、切换到release-1.0 git checkout release-1.2 git branch -vv 3、下载bin到fabric-sample目录 https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.0.0/ https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/ wget https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz 3、进入first-network文件夹 ./byfn.sh -m up 4、关闭 ./byfn.sh -m down 5、初始化 ./byfn.sh -m generate ⽣成初始区块 $ ../bin/cryptogen generate --config=./crypto-config.yaml $ export FABRIC_CFG_PATH=$PWD $ ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block ⽣成应⽤通道的配置信息 $ export CHANNEL_NAME=mychannel $ ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME ⽣成锚节点配置更新⽂件 $ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP &nbsp; $ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP 操作⽹络(v1.2.0后不需要操作Alex.Zhang20180817) 编辑 docker-compose-cli.yaml ,注释到 command 命令 working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer # command: /bin/bash -c &#39;./scripts/script.sh ${CHANNEL_NAME}; sleep $TIMEOUT&#39; volumes 操作网络 $ CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d 更多区块链精品课程 请到优米 IT 学院： https://shop557190130.taobao.com/ 创建和加⼊通道 进⼊ docker 容器 $ docker exec -it cli bash 创建通道 $ export CHANNEL_NAME=mychannel $ peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem 加⼊通道 $ peer channel join -b mychannel.block 链上代码 （链码） 安装链码 $ peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 实例化链码 $ peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; 查询 $ peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}‘ 转账 $ peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}’ &nbsp; 以下启动REST API的web服务 在&nbsp;GOPATH&nbsp;的 root 目录中创建 docker-compose.yml 文件。粘贴以下内容： membersrvc: &nbsp;&nbsp;image: hyperledger/fabric-membersrvc &nbsp;&nbsp;ports: &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7054:7054&quot; &nbsp;&nbsp;command: membersrvc vp0: &nbsp;&nbsp;image: hyperledger/fabric-peer:x86_64-0.6.0-preview &nbsp;&nbsp;ports: &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7050:7050&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7051:7051&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7053:7053&quot; &nbsp;&nbsp;environment: &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ADDRESSAUTODETECT=true &nbsp;&nbsp;&nbsp;&nbsp;- CORE_VM_ENDPOINT=unix:///var/run/docker.sock &nbsp;&nbsp;&nbsp;&nbsp;- CORE_LOGGING_LEVEL=DEBUG &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ID=vp0 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_ECA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TCA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TLSCA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENABLED=false &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLID=test_vp0 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLSECRET=MwYpmSRjupbT &nbsp;&nbsp;links: &nbsp;&nbsp;&nbsp;&nbsp;- membersrvc &nbsp;&nbsp;command: sh -c &quot;sleep 5; peer node start --peer-chaincodedev&quot; &nbsp; 部署示例 Hyperledger Fabric 提供了一个用于与该结构交互的 REST Web 服务接口。与 fabric 的第一次交互是部署链代码。确保本地区块链网络正在运行，然后启动 SoapUI，单击&nbsp;REST&nbsp;按钮创建一个新的 REST 项目。您会看到一个类似图 3 的对话框，在其中输入用于所有 REST 请求的基础 URL： 图 3. SoapUI New REST Project 对话框 输入&nbsp;http://localhost:7050&nbsp;作为 URL，然后单击&nbsp;OK。端口&nbsp;7050&nbsp;是 fabric 使用的默认 REST 端口，而且因为区块链网络是在本地计算机上运行的，所以将使用&nbsp;localhost&nbsp;作为主机名。 在 SoapUI 启动后，可以执行一次快速冒烟测试，以确保它能与本地区块链网络进行通信。展开刚创建的新的 REST 资源，直到看到&nbsp;Request 1，然后在 Editor 窗口中打开它。使用&nbsp;GET&nbsp;方法，在&nbsp;resource&nbsp;下输入&nbsp;/chain。确保单击了 output 选项卡上的&nbsp;JSON&nbsp;选项，然后运行请求（通过单击&nbsp;arrow&nbsp;图标）。执行此请求时，会在 Editor 窗口右侧的输出选项卡中返回当前区块的哈希值，如图 4 所示 &nbsp; &nbsp; &nbsp; 2、关闭原有例子 3、第一终端进入chaincode-docker-devmode，启动网络 docker-compose -f docker-compose-simple.yaml up 4、第二终端进入docker docker exec -it chaincode bash 5、第二终端进入chaincode文件夹 /opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode 6、第二个终端启动chaincode CORE_PEER_ADDRESS=peer:7051 CORE_CHAINCODE_ID_NAME=mycc:0 ./chaincode002 7、第三个终端 docker exec -it cli bash &nbsp; 安装链码 peer chaincode install -p chaincodedev/chaincode/chaincode002 -n mycc -v 0 实例化链码 peer chaincode instantiate -n mycc -v 0 -c &#39;{&quot;Args&quot;:[&quot;str&quot;,&quot;helloworld&quot;]}&#39; -C myc # 查询链码 $ peer chaincode query -n mycc -c &#39;{&quot;Args&quot;:[&quot;get&quot;,&quot;str&quot;]}&#39; -C myc # 调用链码 peer chaincode invoke -n mycc -c &#39;{&quot;Args&quot;:[&quot;set&quot;, &quot;str&quot;, &quot;helloworld111&quot;]}&#39; -C myc # 查询链码 $ peer chaincode query -n mycc -c &#39;{&quot;Args&quot;:[&quot;get&quot;,&quot;str&quot;]}&#39; -C myc &nbsp; docker rm -f $(docker ps -aq) &nbsp; chaincode002 链码放入： /opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode &nbsp; &nbsp; chaincode002.go &nbsp; package main import( &quot;fmt&quot; &quot;github.com/hyperledger/fabric/core/chaincode/shim&quot; &quot;github.com/hyperledger/fabric/protos/peer&quot; ) type Helloworld struct { } func (t *Helloworld) Init(stub shim.ChaincodeStubInterface) peer.Response{ fmt.Println(&quot;helloworld init&quot;) args := stub.GetStringArgs() err := stub.PutState(args[0],[]byte(args[1])) if err != nil { shim.Error(fmt.Sprintf(&quot;helloworld init err %s&quot;,err)) } return shim.Success(nil) } func (t *Helloworld) Invoke(stub shim.ChaincodeStubInterface) peer.Response { fn,args := stub.GetFunctionAndParameters() var result string var err error if fn == &quot;set&quot; { result,err = set(stub,args) }else{ result,err = get(stub,args) } if err != nil { shim.Error(err.Error()) } return shim.Success([]byte(result)) } func set (stub shim.ChaincodeStubInterface, args []string) (string,error){ fmt.Println(&quot;helloworld set&quot;) err := stub.PutState(args[0],[]byte(args[1])) if err != nil { return &quot;&quot;, fmt.Errorf(&quot;Failed to set asset: %s&quot;, args[0]) } return args[0],nil } func get(stub shim.ChaincodeStubInterface, args []string) (string,error){ value, err := stub.GetState(args[0]) if err != nil { return &quot;&quot;, fmt.Errorf(&quot;Failed to get asset: %s&quot;, args[0]) } if value == nil { return &quot;&quot;, fmt.Errorf(&quot;Asset not found: %s&quot;, args[0]) } return string(value),nil } func main() { err := shim.Start(new(Helloworld)) if err != nil { fmt.Printf(&quot;shim start err %s&quot;,err) } } &nbsp; chaincode002_test.go &nbsp; package main import( &quot;fmt&quot; &quot;testing&quot; &quot;github.com/hyperledger/fabric/core/chaincode/shim&quot; ) func checkInit(t *testing.T, stub *shim.MockStub, args [][]byte) { res := stub.MockInit(&quot;1&quot;, args) if res.Status != shim.OK { fmt.Println(&quot;Init failed&quot;, string(res.Message)) t.FailNow() } } func checkQuery(t *testing.T, stub *shim.MockStub, name string) { res := stub.MockInvoke(&quot;1&quot;, [][]byte{[]byte(&quot;get&quot;), []byte(name)}) if res.Status != shim.OK { fmt.Println(&quot;Query&quot;, name, &quot;failed&quot;, string(res.Message)) t.FailNow() } if res.Payload == nil { fmt.Println(&quot;Query&quot;, name, &quot;failed to get value&quot;) t.FailNow() } fmt.Println(&quot;Query value&quot;, name, &quot;was &quot;, string(res.Payload)) } func checkInvoke(t *testing.T, stub *shim.MockStub, args [][]byte) { res := stub.MockInvoke(&quot;1&quot;, args) if res.Status != shim.OK { fmt.Println(&quot;Invoke&quot;, args, &quot;failed&quot;, string(res.Message)) t.FailNow() } } func Test_Helloworld(t *testing.T) { hello := new(Helloworld) stub := shim.NewMockStub(&quot;hello&quot;, hello) checkInit(t, stub, [][]byte{[]byte(&quot;str&quot;), []byte(&quot;helloworld&quot;)}) checkQuery(t, stub, &quot;str&quot;) checkInvoke(t, stub, [][]byte{[]byte(&quot;set&quot;), []byte(&quot;str&quot;),[]byte(&quot;helloworld-1111&quot;)}) checkQuery(t, stub, &quot;str&quot;) } &nbsp; &nbsp; &nbsp; 通过 go test -v helloworld_test.go helloworld.go 测试相应的方法，运行结果： === RUN Test_Helloworld helloworld init Query value str was helloworld helloworld set Query value str was helloworld-1111 --- PASS: Test_Helloworld (0.00s) PASS ok command-line-arguments 0.028s &nbsp; &nbsp; https://hyperledger.github.io/composer/latest/tutorials/developer-tutorial &nbsp; https://hyperledger.github.io/composer/latest/business-network/bnd-create Cloning an Example Business Network Definition The sample business network definitions are stored on GitHub at&nbsp;https://github.com/hyperledger/composer-sample-networks. You can&nbsp;git clone&nbsp;this repository to pull down all the sample networks. Each sample network is stored under the&nbsp;packages&nbsp;directory. Generating a Business Network Definition Generation yo hyperledger-composer Copy ? Please select the type of project: (Use arrow keys) ❯ Angular Business Network Model And select&nbsp;Business Netork Answer all of the questions Copy Welcome to the Hyperledger Composer project generator ? Please select the type of project: Business Network You can run this generator using: &#39;yo hyperledger-composer:businessnetwork&#39; Welcome to the business network generator ? Business network name: mynetwork ? Description: This is my test network ? Author name: Mr Conga ? Author email: conga@congazone.org ? License: Apache-2 ? Namespace: org.conga create package.json create permissions.acl create README.md create models/org.conga.cto create .eslintrc.yml create features/sample.feature create features/support/index.js create test/logic.js create lib/logic.js This generates a skeleton business network with an&nbsp;asset,&nbsp;participant&nbsp;and&nbsp;transaction&nbsp;defined, as well as a&nbsp;mocha&nbsp;unit test. Also included, is a &#39;best practice&#39; eslint config file which defines sample linting rules for JS code. &nbsp; 问题解决 修改 fabric-samples/basic-network/start.sh export FABRIC_START_TIMEOUT=300 //适当调大此值可以改善此问题 &nbsp; peer channel list &nbsp; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/08/17/3b42b0442794d8ae29efa16e86bc87d8.html" />
<meta property="og:url" content="https://mlh.app/2018/08/17/3b42b0442794d8ae29efa16e86bc87d8.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"https://hyperledger-fabric.readthedocs.io/en/release-1.2/install.html docker pull hyperledger/fabric-ca:x86_64-1.2.0 \\ &amp;&amp; docker pull hyperledger/fabric-peer:x86_64-1.2.0 \\ &amp;&amp; docker pull hyperledger/fabric-orderer:x86_64-1.2.0 \\ &amp;&amp; docker pull hyperledger/fabric-couchdb:x86_64-1.2.0 \\ &amp;&amp; docker pull hyperledger/fabric-tools:x86_64-1.2.0 $ docker images $ docker tag hyperledger/fabric-ca:1.2.0 hyperledger/fabric-ca \\ &amp;&amp; docker tag hyperledger/fabric-peer:1.2.0 hyperledger/fabric-peer \\ &amp;&amp; docker tag hyperledger/fabric-orderer:1.2.0 hyperledger/fabric-orderer \\ &amp;&amp; docker tag hyperledger/fabric-couchdb:0.4.10 hyperledger/fabric-couchdb \\ &amp;&amp; docker tag hyperledger/fabric-tools:1.2.0 hyperledger/fabric-tools\\ &amp;&amp; docker tag hyperledger/fabric-ccenv:1.2.0 hyperledger/fabric-ccenv &nbsp; 启动docker service docker start 需要升级docker中的go版本 wget https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz sudo rm -rf /opt/go sudo tar -C /opt -xzvf go1.10.3.linux-amd64.tar.gz export $GOPATH=/opt/gopath export $GOROOT=/usr/local/go 往docker中传文件： docker inspect -f &#39;{{.Id}}&#39; cli f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298 docker cp mychaincode/ f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/ docker cp /opt/gopath/src/github.com/hyperledger/fabric f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric 从docker拷出文件 docker cp f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric/peer /opt/gopath/src/github.com/hyperledger/fabric/peer &nbsp; docker cp go1.10.3.linux-amd64.tar.gz f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric docker cp /opt/gopath/src/mychaincode 37ee6f7d4c3d97d878c3697ce8f449c1b6f74538fe9a5d8350fe06ed75f0d46b:/opt/gopath/src 部署： peer chaincode install -n tang -v 8.8 -p mychaincode peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; 查询 peer chaincode query -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}&#39; peer chaincode query -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;0:287&quot;]}&#39; 调用 peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -c &#39;{&quot;Args&quot;:[&quot;billing&quot;,&quot;a&quot;,&quot;b&quot;,&quot;100&quot;,&quot;billing&quot;]}&#39; 升级 peer chaincode upgrade -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; &nbsp; 运行和启动Fabric例子 1、下载hyperledger/fabric-sample 2、切换到release-1.0 git checkout release-1.2 git branch -vv 3、下载bin到fabric-sample目录 https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.0.0/ https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/ wget https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz 3、进入first-network文件夹 ./byfn.sh -m up 4、关闭 ./byfn.sh -m down 5、初始化 ./byfn.sh -m generate ⽣成初始区块 $ ../bin/cryptogen generate --config=./crypto-config.yaml $ export FABRIC_CFG_PATH=$PWD $ ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block ⽣成应⽤通道的配置信息 $ export CHANNEL_NAME=mychannel $ ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME ⽣成锚节点配置更新⽂件 $ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP &nbsp; $ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP 操作⽹络(v1.2.0后不需要操作Alex.Zhang20180817) 编辑 docker-compose-cli.yaml ,注释到 command 命令 working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer # command: /bin/bash -c &#39;./scripts/script.sh ${CHANNEL_NAME}; sleep $TIMEOUT&#39; volumes 操作网络 $ CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d 更多区块链精品课程 请到优米 IT 学院： https://shop557190130.taobao.com/ 创建和加⼊通道 进⼊ docker 容器 $ docker exec -it cli bash 创建通道 $ export CHANNEL_NAME=mychannel $ peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem 加⼊通道 $ peer channel join -b mychannel.block 链上代码 （链码） 安装链码 $ peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 实例化链码 $ peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c &#39;{&quot;Args&quot;:[&quot;init&quot;,&quot;a&quot;, &quot;100&quot;, &quot;b&quot;,&quot;200&quot;]}&#39; -P &quot;OR (&#39;Org1MSP.member&#39;,&#39;Org2MSP.member&#39;)&quot; 查询 $ peer chaincode query -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;query&quot;,&quot;a&quot;]}‘ 转账 $ peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c &#39;{&quot;Args&quot;:[&quot;invoke&quot;,&quot;a&quot;,&quot;b&quot;,&quot;10&quot;]}’ &nbsp; 以下启动REST API的web服务 在&nbsp;GOPATH&nbsp;的 root 目录中创建 docker-compose.yml 文件。粘贴以下内容： membersrvc: &nbsp;&nbsp;image: hyperledger/fabric-membersrvc &nbsp;&nbsp;ports: &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7054:7054&quot; &nbsp;&nbsp;command: membersrvc vp0: &nbsp;&nbsp;image: hyperledger/fabric-peer:x86_64-0.6.0-preview &nbsp;&nbsp;ports: &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7050:7050&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7051:7051&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &quot;7053:7053&quot; &nbsp;&nbsp;environment: &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ADDRESSAUTODETECT=true &nbsp;&nbsp;&nbsp;&nbsp;- CORE_VM_ENDPOINT=unix:///var/run/docker.sock &nbsp;&nbsp;&nbsp;&nbsp;- CORE_LOGGING_LEVEL=DEBUG &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ID=vp0 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_ECA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TCA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TLSCA_PADDR=membersrvc:7054 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENABLED=false &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLID=test_vp0 &nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLSECRET=MwYpmSRjupbT &nbsp;&nbsp;links: &nbsp;&nbsp;&nbsp;&nbsp;- membersrvc &nbsp;&nbsp;command: sh -c &quot;sleep 5; peer node start --peer-chaincodedev&quot; &nbsp; 部署示例 Hyperledger Fabric 提供了一个用于与该结构交互的 REST Web 服务接口。与 fabric 的第一次交互是部署链代码。确保本地区块链网络正在运行，然后启动 SoapUI，单击&nbsp;REST&nbsp;按钮创建一个新的 REST 项目。您会看到一个类似图 3 的对话框，在其中输入用于所有 REST 请求的基础 URL： 图 3. SoapUI New REST Project 对话框 输入&nbsp;http://localhost:7050&nbsp;作为 URL，然后单击&nbsp;OK。端口&nbsp;7050&nbsp;是 fabric 使用的默认 REST 端口，而且因为区块链网络是在本地计算机上运行的，所以将使用&nbsp;localhost&nbsp;作为主机名。 在 SoapUI 启动后，可以执行一次快速冒烟测试，以确保它能与本地区块链网络进行通信。展开刚创建的新的 REST 资源，直到看到&nbsp;Request 1，然后在 Editor 窗口中打开它。使用&nbsp;GET&nbsp;方法，在&nbsp;resource&nbsp;下输入&nbsp;/chain。确保单击了 output 选项卡上的&nbsp;JSON&nbsp;选项，然后运行请求（通过单击&nbsp;arrow&nbsp;图标）。执行此请求时，会在 Editor 窗口右侧的输出选项卡中返回当前区块的哈希值，如图 4 所示 &nbsp; &nbsp; &nbsp; 2、关闭原有例子 3、第一终端进入chaincode-docker-devmode，启动网络 docker-compose -f docker-compose-simple.yaml up 4、第二终端进入docker docker exec -it chaincode bash 5、第二终端进入chaincode文件夹 /opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode 6、第二个终端启动chaincode CORE_PEER_ADDRESS=peer:7051 CORE_CHAINCODE_ID_NAME=mycc:0 ./chaincode002 7、第三个终端 docker exec -it cli bash &nbsp; 安装链码 peer chaincode install -p chaincodedev/chaincode/chaincode002 -n mycc -v 0 实例化链码 peer chaincode instantiate -n mycc -v 0 -c &#39;{&quot;Args&quot;:[&quot;str&quot;,&quot;helloworld&quot;]}&#39; -C myc # 查询链码 $ peer chaincode query -n mycc -c &#39;{&quot;Args&quot;:[&quot;get&quot;,&quot;str&quot;]}&#39; -C myc # 调用链码 peer chaincode invoke -n mycc -c &#39;{&quot;Args&quot;:[&quot;set&quot;, &quot;str&quot;, &quot;helloworld111&quot;]}&#39; -C myc # 查询链码 $ peer chaincode query -n mycc -c &#39;{&quot;Args&quot;:[&quot;get&quot;,&quot;str&quot;]}&#39; -C myc &nbsp; docker rm -f $(docker ps -aq) &nbsp; chaincode002 链码放入： /opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode &nbsp; &nbsp; chaincode002.go &nbsp; package main import( &quot;fmt&quot; &quot;github.com/hyperledger/fabric/core/chaincode/shim&quot; &quot;github.com/hyperledger/fabric/protos/peer&quot; ) type Helloworld struct { } func (t *Helloworld) Init(stub shim.ChaincodeStubInterface) peer.Response{ fmt.Println(&quot;helloworld init&quot;) args := stub.GetStringArgs() err := stub.PutState(args[0],[]byte(args[1])) if err != nil { shim.Error(fmt.Sprintf(&quot;helloworld init err %s&quot;,err)) } return shim.Success(nil) } func (t *Helloworld) Invoke(stub shim.ChaincodeStubInterface) peer.Response { fn,args := stub.GetFunctionAndParameters() var result string var err error if fn == &quot;set&quot; { result,err = set(stub,args) }else{ result,err = get(stub,args) } if err != nil { shim.Error(err.Error()) } return shim.Success([]byte(result)) } func set (stub shim.ChaincodeStubInterface, args []string) (string,error){ fmt.Println(&quot;helloworld set&quot;) err := stub.PutState(args[0],[]byte(args[1])) if err != nil { return &quot;&quot;, fmt.Errorf(&quot;Failed to set asset: %s&quot;, args[0]) } return args[0],nil } func get(stub shim.ChaincodeStubInterface, args []string) (string,error){ value, err := stub.GetState(args[0]) if err != nil { return &quot;&quot;, fmt.Errorf(&quot;Failed to get asset: %s&quot;, args[0]) } if value == nil { return &quot;&quot;, fmt.Errorf(&quot;Asset not found: %s&quot;, args[0]) } return string(value),nil } func main() { err := shim.Start(new(Helloworld)) if err != nil { fmt.Printf(&quot;shim start err %s&quot;,err) } } &nbsp; chaincode002_test.go &nbsp; package main import( &quot;fmt&quot; &quot;testing&quot; &quot;github.com/hyperledger/fabric/core/chaincode/shim&quot; ) func checkInit(t *testing.T, stub *shim.MockStub, args [][]byte) { res := stub.MockInit(&quot;1&quot;, args) if res.Status != shim.OK { fmt.Println(&quot;Init failed&quot;, string(res.Message)) t.FailNow() } } func checkQuery(t *testing.T, stub *shim.MockStub, name string) { res := stub.MockInvoke(&quot;1&quot;, [][]byte{[]byte(&quot;get&quot;), []byte(name)}) if res.Status != shim.OK { fmt.Println(&quot;Query&quot;, name, &quot;failed&quot;, string(res.Message)) t.FailNow() } if res.Payload == nil { fmt.Println(&quot;Query&quot;, name, &quot;failed to get value&quot;) t.FailNow() } fmt.Println(&quot;Query value&quot;, name, &quot;was &quot;, string(res.Payload)) } func checkInvoke(t *testing.T, stub *shim.MockStub, args [][]byte) { res := stub.MockInvoke(&quot;1&quot;, args) if res.Status != shim.OK { fmt.Println(&quot;Invoke&quot;, args, &quot;failed&quot;, string(res.Message)) t.FailNow() } } func Test_Helloworld(t *testing.T) { hello := new(Helloworld) stub := shim.NewMockStub(&quot;hello&quot;, hello) checkInit(t, stub, [][]byte{[]byte(&quot;str&quot;), []byte(&quot;helloworld&quot;)}) checkQuery(t, stub, &quot;str&quot;) checkInvoke(t, stub, [][]byte{[]byte(&quot;set&quot;), []byte(&quot;str&quot;),[]byte(&quot;helloworld-1111&quot;)}) checkQuery(t, stub, &quot;str&quot;) } &nbsp; &nbsp; &nbsp; 通过 go test -v helloworld_test.go helloworld.go 测试相应的方法，运行结果： === RUN Test_Helloworld helloworld init Query value str was helloworld helloworld set Query value str was helloworld-1111 --- PASS: Test_Helloworld (0.00s) PASS ok command-line-arguments 0.028s &nbsp; &nbsp; https://hyperledger.github.io/composer/latest/tutorials/developer-tutorial &nbsp; https://hyperledger.github.io/composer/latest/business-network/bnd-create Cloning an Example Business Network Definition The sample business network definitions are stored on GitHub at&nbsp;https://github.com/hyperledger/composer-sample-networks. You can&nbsp;git clone&nbsp;this repository to pull down all the sample networks. Each sample network is stored under the&nbsp;packages&nbsp;directory. Generating a Business Network Definition Generation yo hyperledger-composer Copy ? Please select the type of project: (Use arrow keys) ❯ Angular Business Network Model And select&nbsp;Business Netork Answer all of the questions Copy Welcome to the Hyperledger Composer project generator ? Please select the type of project: Business Network You can run this generator using: &#39;yo hyperledger-composer:businessnetwork&#39; Welcome to the business network generator ? Business network name: mynetwork ? Description: This is my test network ? Author name: Mr Conga ? Author email: conga@congazone.org ? License: Apache-2 ? Namespace: org.conga create package.json create permissions.acl create README.md create models/org.conga.cto create .eslintrc.yml create features/sample.feature create features/support/index.js create test/logic.js create lib/logic.js This generates a skeleton business network with an&nbsp;asset,&nbsp;participant&nbsp;and&nbsp;transaction&nbsp;defined, as well as a&nbsp;mocha&nbsp;unit test. Also included, is a &#39;best practice&#39; eslint config file which defines sample linting rules for JS code. &nbsp; 问题解决 修改 fabric-samples/basic-network/start.sh export FABRIC_START_TIMEOUT=300 //适当调大此值可以改善此问题 &nbsp; peer channel list &nbsp; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/08/17/3b42b0442794d8ae29efa16e86bc87d8.html","headline":"区块链、超级账本调试笔记第二版","dateModified":"2018-08-17T00:00:00+08:00","datePublished":"2018-08-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/08/17/3b42b0442794d8ae29efa16e86bc87d8.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>区块链、超级账本调试笔记第二版</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p><a href="https://hyperledger-fabric.readthedocs.io/en/release-1.2/install.html" rel="nofollow">https://hyperledger-fabric.readthedocs.io/en/release-1.2/install.html</a></p> 
  <p>docker pull hyperledger/fabric-ca:x86_64-1.2.0 \</p> 
  <p>&amp;&amp; docker pull hyperledger/fabric-peer:x86_64-1.2.0 \</p> 
  <p>&amp;&amp; docker pull hyperledger/fabric-orderer:x86_64-1.2.0 \</p> 
  <p>&amp;&amp; docker pull hyperledger/fabric-couchdb:x86_64-1.2.0 \</p> 
  <p>&amp;&amp; docker pull hyperledger/fabric-tools:x86_64-1.2.0</p> 
  <p>$ docker images</p> 
  <p>$ docker tag hyperledger/fabric-ca:1.2.0 hyperledger/fabric-ca \</p> 
  <p>&amp;&amp; docker tag hyperledger/fabric-peer:1.2.0 hyperledger/fabric-peer \</p> 
  <p>&amp;&amp; docker tag hyperledger/fabric-orderer:1.2.0 hyperledger/fabric-orderer \</p> 
  <p>&amp;&amp; docker tag hyperledger/fabric-couchdb:0.4.10 hyperledger/fabric-couchdb \</p> 
  <p>&amp;&amp; docker tag hyperledger/fabric-tools:1.2.0 hyperledger/fabric-tools\</p> 
  <p>&amp;&amp; docker tag hyperledger/fabric-ccenv:1.2.0 hyperledger/fabric-ccenv</p> 
  <p>&nbsp;</p> 
  <p>启动docker</p> 
  <p>service docker start</p> 
  <p>需要升级docker中的go版本</p> 
  <p>wget <a href="https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz" rel="nofollow">https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz</a></p> 
  <p>sudo rm -rf /opt/go</p> 
  <p>sudo tar -C /opt -xzvf <a href="https://dl.google.com/go/go1.10.3.linux-amd64.tar.gz" rel="nofollow">go1.10.3.linux-amd64.tar.gz</a></p> 
  <p>export $GOPATH=/opt/gopath</p> 
  <p>export $GOROOT=/usr/local/go</p> 
  <p>往docker中传文件：</p> 
  <p>docker inspect -f '{{.Id}}' cli</p> 
  <p>f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298</p> 
  <p>docker cp mychaincode/ f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/</p> 
  <p>docker cp /opt/gopath/src/github.com/hyperledger/fabric</p> 
  <p>f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric</p> 
  <p>从docker拷出文件</p> 
  <p>docker cp f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric/peer /opt/gopath/src/github.com/hyperledger/fabric/peer</p> 
  <p>&nbsp;</p> 
  <p>docker cp go1.10.3.linux-amd64.tar.gz f3d908de39a70ad0272413b97922c2cb19d29a433ce2764ae9ceb0a2cd721298:/opt/gopath/src/github.com/hyperledger/fabric</p> 
  <p>docker cp /opt/gopath/src/mychaincode 37ee6f7d4c3d97d878c3697ce8f449c1b6f74538fe9a5d8350fe06ed75f0d46b:/opt/gopath/src</p> 
  <p>部署：</p> 
  <p>peer chaincode install -n tang -v 8.8 -p mychaincode</p> 
  <p>peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c '{"Args":["init","a", "100", "b","200"]}' -P "OR ('Org1MSP.member','Org2MSP.member')"</p> 
  <p>查询</p> 
  <p>peer chaincode query -C mychannel -n tang -c '{"Args":["query","a"]}'</p> 
  <p>peer chaincode query -C mychannel -n tang -c '{"Args":["query","0:287"]}'</p> 
  <p>调用</p> 
  <p>peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -c '{"Args":["billing","a","b","100","billing"]}'</p> 
  <p>升级</p> 
  <p>peer chaincode upgrade -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n tang -v 8.8 -c '{"Args":["init","a", "100", "b","200"]}' -P "OR ('Org1MSP.member','Org2MSP.member')"</p> 
  <p>&nbsp;</p> 
  <p>运行和启动Fabric例子</p> 
  <p>1、下载hyperledger/fabric-sample</p> 
  <p>2、切换到release-1.0</p> 
  <p>git checkout release-1.2</p> 
  <p>git branch -vv</p> 
  <p>3、下载bin到fabric-sample目录</p> 
  <p><a href="https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.0.0/" rel="nofollow">https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.0.0/</a></p> 
  <p><a href="https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/" rel="nofollow">https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/</a></p> 
  <p>wget <a href="https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz" rel="nofollow">https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.2.0/hyperledger-fabric-linux-amd64-1.2.0.tar.gz</a></p> 
  <p>3、进入first-network文件夹</p> 
  <p>./byfn.sh -m up</p> 
  <p>4、关闭</p> 
  <p>./byfn.sh -m down</p> 
  <p>5、初始化</p> 
  <p>./byfn.sh -m generate</p> 
  <p>⽣成初始区块</p> 
  <p>$ ../bin/cryptogen generate --config=./crypto-config.yaml</p> 
  <p>$ export FABRIC_CFG_PATH=$PWD</p> 
  <p>$ ../bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block</p> 
  <p>⽣成应⽤通道的配置信息</p> 
  <p>$ export CHANNEL_NAME=mychannel</p> 
  <p>$ ../bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID $CHANNEL_NAME</p> 
  <p>⽣成锚节点配置更新⽂件</p> 
  <p>$ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP</p> 
  <p>&nbsp;</p> 
  <p>$ ../bin/configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID mychannel -asOrg Org2MSP</p> 
  <p>操作⽹络(v1.2.0后不需要操作Alex.Zhang20180817)</p> 
  <p>编辑 docker-compose-cli.yaml ,注释到 command 命令</p> 
  <p>working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer #</p> 
  <p>command: /bin/bash -c './scripts/script.sh ${CHANNEL_NAME}; sleep</p> 
  <p>$TIMEOUT' volumes</p> 
  <p>操作网络</p> 
  <p>$ CHANNEL_NAME=$CHANNEL_NAME TIMEOUT=600 docker-compose -f docker-compose-cli.yaml up -d</p> 
  <p>更多区块链精品课程 请到优米 IT 学院： https://shop557190130.taobao.com/</p> 
  <p>创建和加⼊通道</p> 
  <p>进⼊ docker 容器</p> 
  <p>$ docker exec -it cli bash</p> 
  <p>创建通道</p> 
  <p>$ export CHANNEL_NAME=mychannel</p> 
  <p>$ peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel.tx --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</p> 
  <p>加⼊通道</p> 
  <p>$ peer channel join -b mychannel.block</p> 
  <p>链上代码 （链码）</p> 
  <p>安装链码</p> 
  <p>$ peer chaincode install -n mycc -v 1.0 -p github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02</p> 
  <p>实例化链码</p> 
  <p>$ peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c '{"Args":["init","a", "100", "b","200"]}' -P "OR ('Org1MSP.member','Org2MSP.member')"</p> 
  <p>查询</p> 
  <p>$ peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}‘</p> 
  <p>转账</p> 
  <p>$ peer chaincode invoke -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -c '{"Args":["invoke","a","b","10"]}’</p> 
  <p>&nbsp;</p> 
  <p>以下启动REST API的web服务</p> 
  <p>在&nbsp;GOPATH&nbsp;的 root 目录中创建 docker-compose.yml 文件。粘贴以下内容：</p> 
  <table>
   <tbody>
    <tr>
     <td> <p>membersrvc:</p> <p>&nbsp;&nbsp;image: hyperledger/fabric-membersrvc</p> <p>&nbsp;&nbsp;ports:</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- "7054:7054"</p> <p>&nbsp;&nbsp;command: membersrvc</p> <p>vp0:</p> <p>&nbsp;&nbsp;image: hyperledger/fabric-peer:x86_64-0.6.0-preview</p> <p>&nbsp;&nbsp;ports:</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- "7050:7050"</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- "7051:7051"</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- "7053:7053"</p> <p>&nbsp;&nbsp;environment:</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ADDRESSAUTODETECT=true</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_VM_ENDPOINT=unix:///var/run/docker.sock</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_LOGGING_LEVEL=DEBUG</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_ID=vp0</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_ECA_PADDR=membersrvc:7054</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TCA_PADDR=membersrvc:7054</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_PEER_PKI_TLSCA_PADDR=membersrvc:7054</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENABLED=false</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLID=test_vp0</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- CORE_SECURITY_ENROLLSECRET=MwYpmSRjupbT</p> <p>&nbsp;&nbsp;links:</p> <p>&nbsp;&nbsp;&nbsp;&nbsp;- membersrvc</p> <p>&nbsp;&nbsp;command: sh -c "sleep 5; peer node start --peer-chaincodedev"</p> </td> 
    </tr>
   </tbody>
  </table>
  <p>&nbsp;</p> 
  <p>部署示例</p> 
  <p>Hyperledger Fabric 提供了一个用于与该结构交互的 REST Web 服务接口。与 fabric 的第一次交互是部署链代码。确保本地区块链网络正在运行，然后启动 SoapUI，单击&nbsp;REST&nbsp;按钮创建一个新的 REST 项目。您会看到一个类似图 3 的对话框，在其中输入用于所有 REST 请求的基础 URL：</p> 
  <p>图 3. SoapUI New REST Project 对话框</p> 
  <p></p> 
  <p>输入&nbsp;http://localhost:7050&nbsp;作为 URL，然后单击&nbsp;OK。端口&nbsp;7050&nbsp;是 fabric 使用的默认 REST 端口，而且因为区块链网络是在本地计算机上运行的，所以将使用&nbsp;localhost&nbsp;作为主机名。</p> 
  <p>在 SoapUI 启动后，可以执行一次快速冒烟测试，以确保它能与本地区块链网络进行通信。展开刚创建的新的 REST 资源，直到看到&nbsp;Request 1，然后在 Editor 窗口中打开它。使用&nbsp;GET&nbsp;方法，在&nbsp;resource&nbsp;下输入&nbsp;/chain。确保单击了 output 选项卡上的&nbsp;JSON&nbsp;选项，然后运行请求（通过单击&nbsp;arrow&nbsp;图标）。执行此请求时，会在 Editor 窗口右侧的输出选项卡中返回当前区块的哈希值，如图 4 所示</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>2、关闭原有例子</p> 
  <p>3、第一终端进入chaincode-docker-devmode，启动网络</p> 
  <p>docker-compose -f docker-compose-simple.yaml up</p> 
  <p>4、第二终端进入docker</p> 
  <p>docker exec -it chaincode bash</p> 
  <p>5、第二终端进入chaincode文件夹</p> 
  <p>/opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode</p> 
  <p>6、第二个终端启动chaincode</p> 
  <p>CORE_PEER_ADDRESS=peer:7051 CORE_CHAINCODE_ID_NAME=mycc:0 ./chaincode002</p> 
  <p>7、第三个终端</p> 
  <p>docker exec -it cli bash</p> 
  <p>&nbsp;</p> 
  <p>安装链码</p> 
  <p>peer chaincode install -p chaincodedev/chaincode/chaincode002 -n mycc -v 0</p> 
  <p>实例化链码</p> 
  <p>peer chaincode instantiate -n mycc -v 0 -c '{"Args":["str","helloworld"]}' -C myc</p> 
  <p># 查询链码</p> 
  <p>$ peer chaincode query -n mycc -c '{"Args":["get","str"]}' -C myc</p> 
  <p># 调用链码</p> 
  <p>peer chaincode invoke -n mycc -c '{"Args":["set", "str", "helloworld111"]}'</p> 
  <p>-C myc</p> 
  <p># 查询链码</p> 
  <p>$ peer chaincode query -n mycc -c '{"Args":["get","str"]}' -C myc</p> 
  <p>&nbsp;</p> 
  <p>docker rm -f $(docker ps -aq)</p> 
  <p>&nbsp;</p> 
  <p>chaincode002</p> 
  <p>链码放入：</p> 
  <p>/opt/gopath/src/github.com/hyperledger/fabric-samples/chaincode</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>chaincode002.go</p> 
  <p>&nbsp;</p> 
  <p>package main</p> 
  <p>import(</p> 
  <p>"fmt"</p> 
  <p>"github.com/hyperledger/fabric/core/chaincode/shim"</p> 
  <p>"github.com/hyperledger/fabric/protos/peer"</p> 
  <p>)</p> 
  <p>type Helloworld struct {</p> 
  <p>}</p> 
  <p>func (t *Helloworld) Init(stub shim.ChaincodeStubInterface) peer.Response{</p> 
  <p>fmt.Println("helloworld init")</p> 
  <p>args := stub.GetStringArgs()</p> 
  <p>err := stub.PutState(args[0],[]byte(args[1]))</p> 
  <p>if err != nil {</p> 
  <p>shim.Error(fmt.Sprintf("helloworld init err %s",err))</p> 
  <p>}</p> 
  <p>return shim.Success(nil)</p> 
  <p>}</p> 
  <p>func (t *Helloworld) Invoke(stub shim.ChaincodeStubInterface) peer.Response {</p> 
  <p>fn,args := stub.GetFunctionAndParameters()</p> 
  <p>var result string</p> 
  <p>var err error</p> 
  <p>if fn == "set" {</p> 
  <p>result,err = set(stub,args)</p> 
  <p>}else{</p> 
  <p>result,err = get(stub,args)</p> 
  <p>}</p> 
  <p>if err != nil {</p> 
  <p>shim.Error(err.Error())</p> 
  <p>}</p> 
  <p>return shim.Success([]byte(result))</p> 
  <p>}</p> 
  <p>func set (stub shim.ChaincodeStubInterface, args []string) (string,error){</p> 
  <p>fmt.Println("helloworld set")</p> 
  <p>err := stub.PutState(args[0],[]byte(args[1]))</p> 
  <p>if err != nil {</p> 
  <p>return "", fmt.Errorf("Failed to set asset: %s", args[0])</p> 
  <p>}</p> 
  <p>return args[0],nil</p> 
  <p>}</p> 
  <p>func get(stub shim.ChaincodeStubInterface, args []string) (string,error){</p> 
  <p>value, err := stub.GetState(args[0])</p> 
  <p>if err != nil {</p> 
  <p>return "", fmt.Errorf("Failed to get asset: %s", args[0])</p> 
  <p>}</p> 
  <p>if value == nil {</p> 
  <p>return "", fmt.Errorf("Asset not found: %s", args[0])</p> 
  <p>}</p> 
  <p>return string(value),nil</p> 
  <p>}</p> 
  <p>func main() {</p> 
  <p>err := shim.Start(new(Helloworld))</p> 
  <p>if err != nil {</p> 
  <p>fmt.Printf("shim start err %s",err)</p> 
  <p>}</p> 
  <p>}</p> 
  <p>&nbsp;</p> 
  <p>chaincode002_test.go</p> 
  <p>&nbsp;</p> 
  <p>package main</p> 
  <p>import(</p> 
  <p>"fmt"</p> 
  <p>"testing"</p> 
  <p>"github.com/hyperledger/fabric/core/chaincode/shim" )</p> 
  <p>func checkInit(t *testing.T, stub *shim.MockStub, args [][]byte) {</p> 
  <p>res := stub.MockInit("1", args)</p> 
  <p>if res.Status != shim.OK {</p> 
  <p>fmt.Println("Init failed", string(res.Message))</p> 
  <p>t.FailNow()</p> 
  <p>}</p> 
  <p>}</p> 
  <p>func checkQuery(t *testing.T, stub *shim.MockStub, name string) {</p> 
  <p>res := stub.MockInvoke("1", [][]byte{[]byte("get"), []byte(name)})</p> 
  <p>if res.Status != shim.OK {</p> 
  <p>fmt.Println("Query", name, "failed", string(res.Message))</p> 
  <p>t.FailNow()</p> 
  <p>}</p> 
  <p>if res.Payload == nil {</p> 
  <p>fmt.Println("Query", name, "failed to get value")</p> 
  <p>t.FailNow()</p> 
  <p>}</p> 
  <p>fmt.Println("Query value", name, "was ", string(res.Payload))</p> 
  <p>}</p> 
  <p>func checkInvoke(t *testing.T, stub *shim.MockStub, args [][]byte) {</p> 
  <p>res := stub.MockInvoke("1", args)</p> 
  <p>if res.Status != shim.OK {</p> 
  <p>fmt.Println("Invoke", args, "failed", string(res.Message))</p> 
  <p>t.FailNow()</p> 
  <p>}</p> 
  <p>}</p> 
  <p>func Test_Helloworld(t *testing.T) {</p> 
  <p>hello := new(Helloworld)</p> 
  <p>stub := shim.NewMockStub("hello", hello)</p> 
  <p>checkInit(t, stub, [][]byte{[]byte("str"), []byte("helloworld")})</p> 
  <p>checkQuery(t, stub, "str")</p> 
  <p>checkInvoke(t, stub, [][]byte{[]byte("set"), []byte("str"),[]byte("helloworld-1111")})</p> 
  <p>checkQuery(t, stub, "str")</p> 
  <p>}</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p>通过 go test -v helloworld_test.go helloworld.go 测试相应的方法，运行结果：</p> 
  <p>=== RUN Test_Helloworld</p> 
  <p>helloworld init</p> 
  <p>Query value str was helloworld</p> 
  <p>helloworld set</p> 
  <p>Query value str was helloworld-1111</p> 
  <p>--- PASS: Test_Helloworld (0.00s)</p> 
  <p>PASS ok command-line-arguments 0.028s</p> 
  <p>&nbsp;</p> 
  <p>&nbsp;</p> 
  <p><a href="https://hyperledger.github.io/composer/latest/tutorials/developer-tutorial" rel="nofollow">https://hyperledger.github.io/composer/latest/tutorials/developer-tutorial</a></p> 
  <p>&nbsp;</p> 
  <p><a href="https://hyperledger.github.io/composer/latest/business-network/bnd-create" rel="nofollow">https://hyperledger.github.io/composer/latest/business-network/bnd-create</a></p> 
  <p>Cloning an Example Business Network Definition</p> 
  <p>The sample business network definitions are stored on GitHub at&nbsp;https://github.com/hyperledger/composer-sample-networks. You can&nbsp;git clone&nbsp;this repository to pull down all the sample networks. Each sample network is stored under the&nbsp;packages&nbsp;directory.</p> 
  <p>Generating a Business Network Definition</p> 
  <p>Generation</p> 
  <ol>
   <li>yo hyperledger-composer</li> 
  </ol>
  <p>Copy</p> 
  <p>? Please select the type of project: (Use arrow keys) ❯ Angular Business Network Model</p> 
  <p>And select&nbsp;Business Netork</p> 
  <ol>
   <li>Answer all of the questions</li> 
  </ol>
  <p>Copy</p> 
  <p>Welcome to the Hyperledger Composer project generator ? Please select the type of project: Business Network You can run this generator using: 'yo hyperledger-composer:businessnetwork' Welcome to the business network generator ? Business network name: mynetwork ? Description: This is my test network ? Author name: Mr Conga ? Author email: conga@congazone.org ? License: Apache-2 ? Namespace: org.conga create package.json create permissions.acl create README.md create models/org.conga.cto create .eslintrc.yml create features/sample.feature create features/support/index.js create test/logic.js create lib/logic.js</p> 
  <p>This generates a skeleton business network with an&nbsp;asset,&nbsp;participant&nbsp;and&nbsp;transaction&nbsp;defined, as well as a&nbsp;mocha&nbsp;unit test.</p> 
  <p>Also included, is a 'best practice' eslint config file which defines sample linting rules for JS code.</p> 
  <p>&nbsp;</p> 
  <p>问题解决</p> 
  <p>修改</p> 
  <p>fabric-samples/basic-network/start.sh export FABRIC_START_TIMEOUT=300 //适当调大此值可以改善此问题</p> 
  <p>&nbsp;</p> 
  <p>peer channel list</p> 
  <p>&nbsp;</p> 
  <p></p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ranjio_z/article/details/81780883,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ranjio_z/article/details/81780883,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
