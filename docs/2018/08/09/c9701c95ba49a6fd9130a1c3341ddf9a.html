<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>偷天换日合约易主，地址变脸移花接木——底层函数误用漏洞 漏洞分析连载之四… | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="偷天换日合约易主，地址变脸移花接木——底层函数误用漏洞 漏洞分析连载之四…" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="安全，区块链领域举足轻重的话题，为什么一行代码能瞬间蒸发几十亿市值？合约底层函数的使用不当会引起哪些漏洞？可注入call漏洞和delegatecall误用漏洞会导致什么风险？ 「区块链大本营」携手「链安科技」团队重磅推出「合约安全漏洞解析连载」，以讲故事的方式，带你回顾区块链安全走过的历程；分析漏洞背后的玄机。让开发者在趣味中学习，写出更加牢固的合约，且防患于未然。 当然，这些文章并不是专为开发者而作的，即使你不是开发者，当你读完本连载，相信再有安全问题爆出时，你会有全新的理解。 引子：阵有纵横，天衡为梁，地轴为柱。梁柱以精兵为之，故观其阵，则知精兵之所有。共战他敌时，频更其阵，暗中抽换其精兵，或竟代其为梁柱，势成阵塌，遂兼其兵。并此敌以击他敌之首策 —— 《三十六计第二十五计之偷梁换柱》 却说“重入”“竞态”里应外合币穷财尽，“交互”“限制”强强联手链泰民安，锁定关键变量，应用内置函数，不留可乘之机。 没看过的请戳：合约安全漏洞连载之三 本回咱们聊聊： 底层函数调用险象环生 外部功能慎用防患未然 时至今日，加密货币市场价值富可敌国，已达3000亿美元，是加拿大最大银行RBC两倍有余。行情较好的加密货币蕴含大量的资本，在数字交易所中这座“金库”中大放光彩，犹如璀璨夺目的宝石。但同时也吸引了众多行走江湖的黑客神偷。为此，合约的安全成为重中之重，迭代扩展后的新协议带来的不一定是严丝合缝的守护，也可能有意想不到的疏漏，无孔不入的黑客便试图寻找衔接处的缝隙。 ﻿﻿ 今天我们来说说关于底层函数调用时产生的隐患：可注入call漏洞和delegatecall误用漏洞 事件回顾 2018年5月11日， 人工智能项目方ATN发现其代币ATN Token供应量发生异常，市场上流通的代币无故增加了1100万个。并且黑客在完事之后还不忘隐藏踪迹，归还了权限地址，并且将偷来的Token分发到14个账户地址当中，试图掩人耳目。 好在项目方及时采取了措施，定位了所有可疑账户并采用了冻结销毁等措施，才维持住代币市场的稳定运行。 ATN项目方为了实现代币互换，权限扩展以及控制，合约升级三个新型的功能，采用的是更新的ERC223协议来开发智能合约，并且使用了DS-auth库[1]。按理说双剑合璧能使功能性的提升颇有成效，却被始料未及的攻击泼了一盆冷水。 ﻿﻿ &nbsp; 追根溯源，主要问题出在代币互换的实现——call函数，即合约外部调用函数的实现过程中。 合约外部调用在最近的游戏智能合约中使用广泛，因为这样能够提高代码复用率，简化代码。最新的MyCryptoChamp游戏漏洞就源于合约内部算法生成的随机数可被预测，没有调用外部可靠的随机数生成模块。所以合约外部调用还是很实用的一项功能，但是利是弊就要看合约编写者的功力了。 &nbsp;&nbsp;何为合约外部调用 专业的来说，call与delegatecall&nbsp;函数让 Ethereum开发者将他们的代码模块化（Modularise）。用 call函数来处理对合约的外部标准信息调用（Standard MessageCall）时，代码在外部函数的环境中运行。delegate函数也是标准消息调用，但在目标地址中的代码会在调用合约的环境下运行，也就是说，保持msg.sender 和 msg.value不变。该功能支持实现库，开发人员可以为未来的合约创建可重用的代码。 通俗的来说，它是一个合约调用另一个合约某些功能的方式[2]。 拿西游记打个比方： 话说唐僧去西天取经途中遇到了法力高强的妖怪，要过这一难，必须孙大圣出马，于是八戒和沙僧去花果山搬救兵请猴子。 ﻿﻿ 但是如果请来的那位并不是悟空，而是假猴王六耳猕猴，可能不光妖怪降服不了，师傅都会被拐跑。 这就是黑客用来投机倒把的伎俩，利用跨合约调用这个过程偷梁换柱，打入合约内部。我们来看具体案例的分析。 漏洞分析以及详细修复建议 1.可注入call漏洞 漏洞分析 call是以太坊智能合约编写语言Solidity提供的底层函数，用来与外部合约或者库进行交互。此类函数使用时需要对调用参数的安全性进行判定，建议谨慎使用。 案例 ﻿ receiver，_custom_fallback，_from, _amount,_data是由用户控制的，也就是说用户可以控制整个call调用，包括调用的合约地址（receiver），调用哪个函数（_custom_fallback）,以及传递的参数（_from,_amount,_data），这实际上是很危险的。在ATN事件中攻击者通过指定receiver为案例合约地址，利用DS-Auth授权，调用合约自身的函数，从而获得了合约的控制权[3]。 此外，下面是ERC223标准的另一个call错误实现[4]： ﻿﻿ 这种合约本身允许用户自定义&nbsp;call()&nbsp;任意地址上任意函数的设计，十分危险。攻击者可以很容易地借用当前合约的身份来进行任何操作。可能导致如下后果： 1）允许攻击者以缺陷合约身份来盗走其它 Token 合约中的 Token 2）与 ds-auth 之类的鉴权机制结合，绕过合约自身的权限检查 3）允许攻击者以缺陷合约身份来盗走其它 Token 账户所授权（Approve）的Token 4）攻击者可传入虚假数据（_data）欺骗 Receiver 合约 漏洞修复 1）推荐使用如下方式调用tokenFallback函数 ﻿﻿ 2）DS-Auth在设置权限的时候，不要把合约本身地址加入白名单 ﻿﻿ 2.delegatecall误用漏洞 漏洞分析 DELEGATECALL会保持调用环境不变的属性表明，构建无漏洞的定制库并不像人们想象的那么容易。库中的代码本身可以是安全的，无漏洞的，但是当在另一个应用的环境中运行时，可能会出现新的漏洞。 案例 案例代码来源于Ethernaut第6关[5] ﻿﻿ 在主合约Delegation的fallback函数中，可通过delegatecall调用Delegate合约的函数，并在主合约环境下执行，如果msg.data是0xdd365b8b(pwn()的函数签名)，即调用Delegate的pwn函数，那么消息发起者就可以变成主合约的owner[6]。 漏洞修复 Solidity 为实现库合约提供了关键字&nbsp;library&nbsp;（参见&nbsp;SolidityDocs&nbsp;了解更多详情)。这确保了library&nbsp;是无状态（Stateless）且不可自毁的。强制让library&nbsp;成为无状态的，可以缓解本节所述的存储环境的复杂性。无状态library&nbsp;还可以防止攻击者直接修改library&nbsp;状态以实现对依赖于library&nbsp;代码的合约的攻击。在使用时&nbsp;DELEGATECALL&nbsp;时要特别注意库合约和调用合约可能对状态变量进行修改，并且尽可能构建无状态library&nbsp;。 真假难辨，如何防范 黑客千方百计试图欺骗合约，或无所不用其极地打开合约的后门，对合约的安全开发过程是一个严峻的考验，从内部和外部我们可以做到以下两点进行防范： 跨合约调用时，要慎用外部函数，周全考虑可能的调用风险，及时添补相应函数和规则，杜绝外患。 内部权限设置必须考虑可能的权限被夺取的情况，从代码逻辑性和功能准确性全方面进行考量。 智能合约的安全规则终将会在安全团队与黑客的较量中不断完善，我们要做好打持久战的准备。 次回予告： 地址恢复功亏一篑 身份判断轻虑浅谋 逻辑补全自圆其说 原理辨析帷幄运筹 杨霞&nbsp;&nbsp; 成都链安科技CEO，创始人。电子科技大学副教授，最早研究区块链形式化验证的专家。一直为航空航天、军事领域提供形式化验证服务。主持国家核高基、装发重大软件课题等近10项国家课题。CC国际安全标准成员、CCF区块链专委会委员。发表学术论文30多篇，申请20多项专利。 本文引用： [1]&nbsp;ATN抵御合约攻击的报告： https://atn.io/resource/aareport.pdf [2]&nbsp;以太坊智能合约call注入攻击： https://blog.csdn.net/u011721501/article/details/80757811 [3]&nbsp;ATN披露特殊场景下的以太坊合约重大漏洞并与慢雾科技达成战略合作： https://www.bitansuo.com/articles/512680.html [4]&nbsp;ERC223-token-standard： https:/github.com/Dexaran/ERC223-token-standard/tree/Recommended [5]&nbsp;Ethernaut： https://ethernaut.zeppelin.solutions [6]&nbsp;delegatecall： https://blog.sigmaprime.io/solidity-security.html 内容转载请联系微信： qk15732632926（注明公众号+转载） 商务合作请联系微信： fengyan-1101（注明公司+合作意向） 最新热文： 40000%通货膨胀，总统险些被杀，第三代加密货币却被他们玩转了 27亿美金被狂撸！这些年，被狠狠抽脸的8次区块链安全祸事儿 我研究了V神的黄皮书，发现EVM里竟然藏着函数手册，虐哭你别怪我 黑客来袭！手把手带你深挖区块链安全漏洞 扫码加入区块链大本营读者群，群满加微信 qk15732632926 入群 了解更多区块链技术及应用内容 敬请关注： 阅读更多" />
<meta property="og:description" content="安全，区块链领域举足轻重的话题，为什么一行代码能瞬间蒸发几十亿市值？合约底层函数的使用不当会引起哪些漏洞？可注入call漏洞和delegatecall误用漏洞会导致什么风险？ 「区块链大本营」携手「链安科技」团队重磅推出「合约安全漏洞解析连载」，以讲故事的方式，带你回顾区块链安全走过的历程；分析漏洞背后的玄机。让开发者在趣味中学习，写出更加牢固的合约，且防患于未然。 当然，这些文章并不是专为开发者而作的，即使你不是开发者，当你读完本连载，相信再有安全问题爆出时，你会有全新的理解。 引子：阵有纵横，天衡为梁，地轴为柱。梁柱以精兵为之，故观其阵，则知精兵之所有。共战他敌时，频更其阵，暗中抽换其精兵，或竟代其为梁柱，势成阵塌，遂兼其兵。并此敌以击他敌之首策 —— 《三十六计第二十五计之偷梁换柱》 却说“重入”“竞态”里应外合币穷财尽，“交互”“限制”强强联手链泰民安，锁定关键变量，应用内置函数，不留可乘之机。 没看过的请戳：合约安全漏洞连载之三 本回咱们聊聊： 底层函数调用险象环生 外部功能慎用防患未然 时至今日，加密货币市场价值富可敌国，已达3000亿美元，是加拿大最大银行RBC两倍有余。行情较好的加密货币蕴含大量的资本，在数字交易所中这座“金库”中大放光彩，犹如璀璨夺目的宝石。但同时也吸引了众多行走江湖的黑客神偷。为此，合约的安全成为重中之重，迭代扩展后的新协议带来的不一定是严丝合缝的守护，也可能有意想不到的疏漏，无孔不入的黑客便试图寻找衔接处的缝隙。 ﻿﻿ 今天我们来说说关于底层函数调用时产生的隐患：可注入call漏洞和delegatecall误用漏洞 事件回顾 2018年5月11日， 人工智能项目方ATN发现其代币ATN Token供应量发生异常，市场上流通的代币无故增加了1100万个。并且黑客在完事之后还不忘隐藏踪迹，归还了权限地址，并且将偷来的Token分发到14个账户地址当中，试图掩人耳目。 好在项目方及时采取了措施，定位了所有可疑账户并采用了冻结销毁等措施，才维持住代币市场的稳定运行。 ATN项目方为了实现代币互换，权限扩展以及控制，合约升级三个新型的功能，采用的是更新的ERC223协议来开发智能合约，并且使用了DS-auth库[1]。按理说双剑合璧能使功能性的提升颇有成效，却被始料未及的攻击泼了一盆冷水。 ﻿﻿ &nbsp; 追根溯源，主要问题出在代币互换的实现——call函数，即合约外部调用函数的实现过程中。 合约外部调用在最近的游戏智能合约中使用广泛，因为这样能够提高代码复用率，简化代码。最新的MyCryptoChamp游戏漏洞就源于合约内部算法生成的随机数可被预测，没有调用外部可靠的随机数生成模块。所以合约外部调用还是很实用的一项功能，但是利是弊就要看合约编写者的功力了。 &nbsp;&nbsp;何为合约外部调用 专业的来说，call与delegatecall&nbsp;函数让 Ethereum开发者将他们的代码模块化（Modularise）。用 call函数来处理对合约的外部标准信息调用（Standard MessageCall）时，代码在外部函数的环境中运行。delegate函数也是标准消息调用，但在目标地址中的代码会在调用合约的环境下运行，也就是说，保持msg.sender 和 msg.value不变。该功能支持实现库，开发人员可以为未来的合约创建可重用的代码。 通俗的来说，它是一个合约调用另一个合约某些功能的方式[2]。 拿西游记打个比方： 话说唐僧去西天取经途中遇到了法力高强的妖怪，要过这一难，必须孙大圣出马，于是八戒和沙僧去花果山搬救兵请猴子。 ﻿﻿ 但是如果请来的那位并不是悟空，而是假猴王六耳猕猴，可能不光妖怪降服不了，师傅都会被拐跑。 这就是黑客用来投机倒把的伎俩，利用跨合约调用这个过程偷梁换柱，打入合约内部。我们来看具体案例的分析。 漏洞分析以及详细修复建议 1.可注入call漏洞 漏洞分析 call是以太坊智能合约编写语言Solidity提供的底层函数，用来与外部合约或者库进行交互。此类函数使用时需要对调用参数的安全性进行判定，建议谨慎使用。 案例 ﻿ receiver，_custom_fallback，_from, _amount,_data是由用户控制的，也就是说用户可以控制整个call调用，包括调用的合约地址（receiver），调用哪个函数（_custom_fallback）,以及传递的参数（_from,_amount,_data），这实际上是很危险的。在ATN事件中攻击者通过指定receiver为案例合约地址，利用DS-Auth授权，调用合约自身的函数，从而获得了合约的控制权[3]。 此外，下面是ERC223标准的另一个call错误实现[4]： ﻿﻿ 这种合约本身允许用户自定义&nbsp;call()&nbsp;任意地址上任意函数的设计，十分危险。攻击者可以很容易地借用当前合约的身份来进行任何操作。可能导致如下后果： 1）允许攻击者以缺陷合约身份来盗走其它 Token 合约中的 Token 2）与 ds-auth 之类的鉴权机制结合，绕过合约自身的权限检查 3）允许攻击者以缺陷合约身份来盗走其它 Token 账户所授权（Approve）的Token 4）攻击者可传入虚假数据（_data）欺骗 Receiver 合约 漏洞修复 1）推荐使用如下方式调用tokenFallback函数 ﻿﻿ 2）DS-Auth在设置权限的时候，不要把合约本身地址加入白名单 ﻿﻿ 2.delegatecall误用漏洞 漏洞分析 DELEGATECALL会保持调用环境不变的属性表明，构建无漏洞的定制库并不像人们想象的那么容易。库中的代码本身可以是安全的，无漏洞的，但是当在另一个应用的环境中运行时，可能会出现新的漏洞。 案例 案例代码来源于Ethernaut第6关[5] ﻿﻿ 在主合约Delegation的fallback函数中，可通过delegatecall调用Delegate合约的函数，并在主合约环境下执行，如果msg.data是0xdd365b8b(pwn()的函数签名)，即调用Delegate的pwn函数，那么消息发起者就可以变成主合约的owner[6]。 漏洞修复 Solidity 为实现库合约提供了关键字&nbsp;library&nbsp;（参见&nbsp;SolidityDocs&nbsp;了解更多详情)。这确保了library&nbsp;是无状态（Stateless）且不可自毁的。强制让library&nbsp;成为无状态的，可以缓解本节所述的存储环境的复杂性。无状态library&nbsp;还可以防止攻击者直接修改library&nbsp;状态以实现对依赖于library&nbsp;代码的合约的攻击。在使用时&nbsp;DELEGATECALL&nbsp;时要特别注意库合约和调用合约可能对状态变量进行修改，并且尽可能构建无状态library&nbsp;。 真假难辨，如何防范 黑客千方百计试图欺骗合约，或无所不用其极地打开合约的后门，对合约的安全开发过程是一个严峻的考验，从内部和外部我们可以做到以下两点进行防范： 跨合约调用时，要慎用外部函数，周全考虑可能的调用风险，及时添补相应函数和规则，杜绝外患。 内部权限设置必须考虑可能的权限被夺取的情况，从代码逻辑性和功能准确性全方面进行考量。 智能合约的安全规则终将会在安全团队与黑客的较量中不断完善，我们要做好打持久战的准备。 次回予告： 地址恢复功亏一篑 身份判断轻虑浅谋 逻辑补全自圆其说 原理辨析帷幄运筹 杨霞&nbsp;&nbsp; 成都链安科技CEO，创始人。电子科技大学副教授，最早研究区块链形式化验证的专家。一直为航空航天、军事领域提供形式化验证服务。主持国家核高基、装发重大软件课题等近10项国家课题。CC国际安全标准成员、CCF区块链专委会委员。发表学术论文30多篇，申请20多项专利。 本文引用： [1]&nbsp;ATN抵御合约攻击的报告： https://atn.io/resource/aareport.pdf [2]&nbsp;以太坊智能合约call注入攻击： https://blog.csdn.net/u011721501/article/details/80757811 [3]&nbsp;ATN披露特殊场景下的以太坊合约重大漏洞并与慢雾科技达成战略合作： https://www.bitansuo.com/articles/512680.html [4]&nbsp;ERC223-token-standard： https:/github.com/Dexaran/ERC223-token-standard/tree/Recommended [5]&nbsp;Ethernaut： https://ethernaut.zeppelin.solutions [6]&nbsp;delegatecall： https://blog.sigmaprime.io/solidity-security.html 内容转载请联系微信： qk15732632926（注明公众号+转载） 商务合作请联系微信： fengyan-1101（注明公司+合作意向） 最新热文： 40000%通货膨胀，总统险些被杀，第三代加密货币却被他们玩转了 27亿美金被狂撸！这些年，被狠狠抽脸的8次区块链安全祸事儿 我研究了V神的黄皮书，发现EVM里竟然藏着函数手册，虐哭你别怪我 黑客来袭！手把手带你深挖区块链安全漏洞 扫码加入区块链大本营读者群，群满加微信 qk15732632926 入群 了解更多区块链技术及应用内容 敬请关注： 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/08/09/c9701c95ba49a6fd9130a1c3341ddf9a.html" />
<meta property="og:url" content="https://mlh.app/2018/08/09/c9701c95ba49a6fd9130a1c3341ddf9a.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-09T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"安全，区块链领域举足轻重的话题，为什么一行代码能瞬间蒸发几十亿市值？合约底层函数的使用不当会引起哪些漏洞？可注入call漏洞和delegatecall误用漏洞会导致什么风险？ 「区块链大本营」携手「链安科技」团队重磅推出「合约安全漏洞解析连载」，以讲故事的方式，带你回顾区块链安全走过的历程；分析漏洞背后的玄机。让开发者在趣味中学习，写出更加牢固的合约，且防患于未然。 当然，这些文章并不是专为开发者而作的，即使你不是开发者，当你读完本连载，相信再有安全问题爆出时，你会有全新的理解。 引子：阵有纵横，天衡为梁，地轴为柱。梁柱以精兵为之，故观其阵，则知精兵之所有。共战他敌时，频更其阵，暗中抽换其精兵，或竟代其为梁柱，势成阵塌，遂兼其兵。并此敌以击他敌之首策 —— 《三十六计第二十五计之偷梁换柱》 却说“重入”“竞态”里应外合币穷财尽，“交互”“限制”强强联手链泰民安，锁定关键变量，应用内置函数，不留可乘之机。 没看过的请戳：合约安全漏洞连载之三 本回咱们聊聊： 底层函数调用险象环生 外部功能慎用防患未然 时至今日，加密货币市场价值富可敌国，已达3000亿美元，是加拿大最大银行RBC两倍有余。行情较好的加密货币蕴含大量的资本，在数字交易所中这座“金库”中大放光彩，犹如璀璨夺目的宝石。但同时也吸引了众多行走江湖的黑客神偷。为此，合约的安全成为重中之重，迭代扩展后的新协议带来的不一定是严丝合缝的守护，也可能有意想不到的疏漏，无孔不入的黑客便试图寻找衔接处的缝隙。 ﻿﻿ 今天我们来说说关于底层函数调用时产生的隐患：可注入call漏洞和delegatecall误用漏洞 事件回顾 2018年5月11日， 人工智能项目方ATN发现其代币ATN Token供应量发生异常，市场上流通的代币无故增加了1100万个。并且黑客在完事之后还不忘隐藏踪迹，归还了权限地址，并且将偷来的Token分发到14个账户地址当中，试图掩人耳目。 好在项目方及时采取了措施，定位了所有可疑账户并采用了冻结销毁等措施，才维持住代币市场的稳定运行。 ATN项目方为了实现代币互换，权限扩展以及控制，合约升级三个新型的功能，采用的是更新的ERC223协议来开发智能合约，并且使用了DS-auth库[1]。按理说双剑合璧能使功能性的提升颇有成效，却被始料未及的攻击泼了一盆冷水。 ﻿﻿ &nbsp; 追根溯源，主要问题出在代币互换的实现——call函数，即合约外部调用函数的实现过程中。 合约外部调用在最近的游戏智能合约中使用广泛，因为这样能够提高代码复用率，简化代码。最新的MyCryptoChamp游戏漏洞就源于合约内部算法生成的随机数可被预测，没有调用外部可靠的随机数生成模块。所以合约外部调用还是很实用的一项功能，但是利是弊就要看合约编写者的功力了。 &nbsp;&nbsp;何为合约外部调用 专业的来说，call与delegatecall&nbsp;函数让 Ethereum开发者将他们的代码模块化（Modularise）。用 call函数来处理对合约的外部标准信息调用（Standard MessageCall）时，代码在外部函数的环境中运行。delegate函数也是标准消息调用，但在目标地址中的代码会在调用合约的环境下运行，也就是说，保持msg.sender 和 msg.value不变。该功能支持实现库，开发人员可以为未来的合约创建可重用的代码。 通俗的来说，它是一个合约调用另一个合约某些功能的方式[2]。 拿西游记打个比方： 话说唐僧去西天取经途中遇到了法力高强的妖怪，要过这一难，必须孙大圣出马，于是八戒和沙僧去花果山搬救兵请猴子。 ﻿﻿ 但是如果请来的那位并不是悟空，而是假猴王六耳猕猴，可能不光妖怪降服不了，师傅都会被拐跑。 这就是黑客用来投机倒把的伎俩，利用跨合约调用这个过程偷梁换柱，打入合约内部。我们来看具体案例的分析。 漏洞分析以及详细修复建议 1.可注入call漏洞 漏洞分析 call是以太坊智能合约编写语言Solidity提供的底层函数，用来与外部合约或者库进行交互。此类函数使用时需要对调用参数的安全性进行判定，建议谨慎使用。 案例 ﻿ receiver，_custom_fallback，_from, _amount,_data是由用户控制的，也就是说用户可以控制整个call调用，包括调用的合约地址（receiver），调用哪个函数（_custom_fallback）,以及传递的参数（_from,_amount,_data），这实际上是很危险的。在ATN事件中攻击者通过指定receiver为案例合约地址，利用DS-Auth授权，调用合约自身的函数，从而获得了合约的控制权[3]。 此外，下面是ERC223标准的另一个call错误实现[4]： ﻿﻿ 这种合约本身允许用户自定义&nbsp;call()&nbsp;任意地址上任意函数的设计，十分危险。攻击者可以很容易地借用当前合约的身份来进行任何操作。可能导致如下后果： 1）允许攻击者以缺陷合约身份来盗走其它 Token 合约中的 Token 2）与 ds-auth 之类的鉴权机制结合，绕过合约自身的权限检查 3）允许攻击者以缺陷合约身份来盗走其它 Token 账户所授权（Approve）的Token 4）攻击者可传入虚假数据（_data）欺骗 Receiver 合约 漏洞修复 1）推荐使用如下方式调用tokenFallback函数 ﻿﻿ 2）DS-Auth在设置权限的时候，不要把合约本身地址加入白名单 ﻿﻿ 2.delegatecall误用漏洞 漏洞分析 DELEGATECALL会保持调用环境不变的属性表明，构建无漏洞的定制库并不像人们想象的那么容易。库中的代码本身可以是安全的，无漏洞的，但是当在另一个应用的环境中运行时，可能会出现新的漏洞。 案例 案例代码来源于Ethernaut第6关[5] ﻿﻿ 在主合约Delegation的fallback函数中，可通过delegatecall调用Delegate合约的函数，并在主合约环境下执行，如果msg.data是0xdd365b8b(pwn()的函数签名)，即调用Delegate的pwn函数，那么消息发起者就可以变成主合约的owner[6]。 漏洞修复 Solidity 为实现库合约提供了关键字&nbsp;library&nbsp;（参见&nbsp;SolidityDocs&nbsp;了解更多详情)。这确保了library&nbsp;是无状态（Stateless）且不可自毁的。强制让library&nbsp;成为无状态的，可以缓解本节所述的存储环境的复杂性。无状态library&nbsp;还可以防止攻击者直接修改library&nbsp;状态以实现对依赖于library&nbsp;代码的合约的攻击。在使用时&nbsp;DELEGATECALL&nbsp;时要特别注意库合约和调用合约可能对状态变量进行修改，并且尽可能构建无状态library&nbsp;。 真假难辨，如何防范 黑客千方百计试图欺骗合约，或无所不用其极地打开合约的后门，对合约的安全开发过程是一个严峻的考验，从内部和外部我们可以做到以下两点进行防范： 跨合约调用时，要慎用外部函数，周全考虑可能的调用风险，及时添补相应函数和规则，杜绝外患。 内部权限设置必须考虑可能的权限被夺取的情况，从代码逻辑性和功能准确性全方面进行考量。 智能合约的安全规则终将会在安全团队与黑客的较量中不断完善，我们要做好打持久战的准备。 次回予告： 地址恢复功亏一篑 身份判断轻虑浅谋 逻辑补全自圆其说 原理辨析帷幄运筹 杨霞&nbsp;&nbsp; 成都链安科技CEO，创始人。电子科技大学副教授，最早研究区块链形式化验证的专家。一直为航空航天、军事领域提供形式化验证服务。主持国家核高基、装发重大软件课题等近10项国家课题。CC国际安全标准成员、CCF区块链专委会委员。发表学术论文30多篇，申请20多项专利。 本文引用： [1]&nbsp;ATN抵御合约攻击的报告： https://atn.io/resource/aareport.pdf [2]&nbsp;以太坊智能合约call注入攻击： https://blog.csdn.net/u011721501/article/details/80757811 [3]&nbsp;ATN披露特殊场景下的以太坊合约重大漏洞并与慢雾科技达成战略合作： https://www.bitansuo.com/articles/512680.html [4]&nbsp;ERC223-token-standard： https:/github.com/Dexaran/ERC223-token-standard/tree/Recommended [5]&nbsp;Ethernaut： https://ethernaut.zeppelin.solutions [6]&nbsp;delegatecall： https://blog.sigmaprime.io/solidity-security.html 内容转载请联系微信： qk15732632926（注明公众号+转载） 商务合作请联系微信： fengyan-1101（注明公司+合作意向） 最新热文： 40000%通货膨胀，总统险些被杀，第三代加密货币却被他们玩转了 27亿美金被狂撸！这些年，被狠狠抽脸的8次区块链安全祸事儿 我研究了V神的黄皮书，发现EVM里竟然藏着函数手册，虐哭你别怪我 黑客来袭！手把手带你深挖区块链安全漏洞 扫码加入区块链大本营读者群，群满加微信 qk15732632926 入群 了解更多区块链技术及应用内容 敬请关注： 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/08/09/c9701c95ba49a6fd9130a1c3341ddf9a.html","headline":"偷天换日合约易主，地址变脸移花接木——底层函数误用漏洞 漏洞分析连载之四…","dateModified":"2018-08-09T00:00:00+08:00","datePublished":"2018-08-09T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/08/09/c9701c95ba49a6fd9130a1c3341ddf9a.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>偷天换日合约易主，地址变脸移花接木——底层函数误用漏洞 | 漏洞分析连载之四...</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <div class="rich_media_content" id="js_content"> 
   <p style="text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRnrOPlQvy5KJKsJ7jOlu6OdKIfv2LcsKV2k5j06h4R5ibzFK1a7EJeUQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><br></p>
   <blockquote>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);"><em>安全，区块链领域举足轻重的话题，为什么一行代码能瞬间蒸发几十亿市值？合约底层函数的使用不当会引起哪些漏洞？</em><em>可注入call漏洞和delegatecall误用漏洞</em><em>会导致什么风险？</em></span></p>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);"><em><br></em></span></p>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);"><em>「区块链大本营」携手「链安科技」团队重磅推出「合约安全漏洞解析连载」，以讲故事的方式，带你回顾区块链安全走过的历程；分析漏洞背后的玄机。让开发者在趣味中学习，写出更加牢固的合约，且防患于未然。</em></span></p>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);"><em><br></em></span></p>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);"><em>当然，这些文章并不是专为开发者而作的，即使你不是开发者，当你读完本连载，相信再有安全问题爆出时，你会有全新的理解。</em></span></p>
   </blockquote>
   <p style="margin-left:8px;color:rgb(51,51,51);"><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><em><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">引子：阵有纵横，天衡为梁，地轴为柱。梁柱以精兵为之，故观其阵，则知精兵之所有。共战他敌时，频更其阵，暗中抽换其精兵，或竟代其为梁柱，势成阵塌，遂兼其兵。并此敌以击他敌之首策 —— 《三十六计第二十五计之偷梁换柱》</span></strong></em></p>
   <p style="margin-left:8px;text-align:justify;"><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">却说</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">“重入”“竞态”里应外合币穷财尽，“交互”“限制”强强联手链泰民安</span></strong><span style="font-size:15px;letter-spacing:.5px;">，锁定关键变量，应用内置函数，不留可乘之机。</span></p>
   <p><br></p>
   <p style="margin-left:8px;"><span style="color:rgb(51,51,51);">没看过的请戳：</span><a href="https://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247487666&amp;idx=2&amp;sn=7e84f7367ba576b893eaf2ca7c11b62f&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:15px;"><strong style="color:rgb(0,122,170);">合约安全漏洞连载之三</strong></a></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><br></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><strong style="color:rgb(51,51,51);"><span style="color:rgb(0,122,170);">本回咱们聊聊：</span></strong></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">底层函数调用险象环生</span></strong></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">外部功能慎用防患未然</span></strong></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">时至今日，加密货币市场价值富可敌国，已达3000亿美元，是加拿大最大银行RBC两倍有余。行情较好的加密货币蕴含大量的资本，在数字交易所中这座“金库”中大放光彩，犹如璀璨夺目的宝石。但同时也吸引了众多行走江湖的黑客神偷。为此，合约的安全成为重中之重，迭代扩展后的新协议带来的不一定是严丝合缝的守护，也可能有意想不到的疏漏，无孔不入的黑客便试图寻找衔接处的缝隙。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRyF0bhLqy6MT9xxT8aHOKNlrNc2Qd9H29MlcE5m7HiaSibwZAOQFg1L2Q/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p><br></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">今天我们来说说关于底层函数调用时产生的隐患：</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">可注入call漏洞和delegatecall误用漏洞</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="letter-spacing:.5px;font-size:18px;color:rgb(0,122,170);">事件回顾</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">2018年5月11日， 人工智能项目方ATN发现其代币ATN Token供应量发生异常，市场上流通的代币无故增加了1100万个。并且黑客在完事之后还不忘隐藏踪迹，归还了权限地址，并且将偷来的Token分发到14个账户地址当中，试图掩人耳目。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">好在项目方及时采取了措施，定位了所有可疑账户并采用了冻结销毁等措施，才维持住代币市场的稳定运行。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">ATN项目方为了实现代币互换，权限扩展以及控制，合约升级三个新型的功能，采用的是更新的ERC223协议来开发智能合约，并且使用了DS-auth库<strong style="color:rgb(51,51,51);"><sup>[1]</sup></strong>。按理说双剑合璧能使功能性的提升颇有成效，却被始料未及的攻击泼了一盆冷水。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" style="width:320px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/trm5VMeFp9kYpEdmo8QBuT3yny5JyefR9gksPkQI9Hibkk3UAdgrAViaKtD9xMiaf0L7GSA0WgvQXFo8HTtfiaRmOQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">&nbsp;</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">追根溯源，</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">主要问题出在代币互换的实现——call函数</span></strong><span style="font-size:15px;letter-spacing:.5px;">，即</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">合约外部调用函数</span></strong><span style="font-size:15px;letter-spacing:.5px;">的实现过程中。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">合约外部调用在最近的游戏智能合约中使用广泛，因为这样能够提高代码复用率，简化代码。最新的MyCryptoChamp游戏漏洞就源于合约内部算法生成的随机数可被预测，没有调用外部可靠的随机数生成模块。所以合约外部调用还是很实用的一项功能，但是利是弊就要看合约编写者的功力了。</span></p>
   <p><br></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">&nbsp;&nbsp;</span><strong><span style="letter-spacing:.5px;font-size:18px;color:rgb(0,122,170);">何为合约外部调用</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">专业的来说，</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">call</span></strong><span style="font-size:15px;letter-spacing:.5px;">与</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">delegatecall</span></strong>&nbsp;<span style="font-size:15px;letter-spacing:.5px;">函数让 Ethereum开发者将他们的代码模块化（Modularise）。</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">用 call函数来处理对合约的外部标准信息调用（Standard MessageCall）时，代码在外部函数的环境中运行。</span></strong><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">delegate函数也是标准消息调用，但在目标地址中的代码会在调用合约的环境下运行</span></strong><span style="font-size:15px;letter-spacing:.5px;">，也就是说，保持msg.sender 和 msg.value不变。该功能支持实现库，开发人员可以为未来的合约创建可重用的代码。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">通俗的来说，它是一个合约调用另一个合约某些功能的方式<strong style="color:rgb(51,51,51);"><sup>[2]</sup></strong>。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">拿西游记打个比方：</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">话说唐僧去西天取经途中遇到了法力高强的妖怪，要过这一难，必须孙大圣出马，于是八戒和沙僧去花果山搬救兵请猴子。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/trm5VMeFp9kYpEdmo8QBuT3yny5JyefR4a2xsqEJfSib8GlIxOM8Kfnh02vBeeS0dlQJbbVOTaH4aJHZvBqPpdQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">但是如果请来的那位并不是悟空，而是假猴王六耳猕猴，可能不光妖怪降服不了，师傅都会被拐跑。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">这就是黑客用来投机倒把的伎俩，利用跨合约调用这个过程偷梁换柱，打入合约内部。我们来看具体案例的分析。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="letter-spacing:.5px;font-size:18px;color:rgb(0,122,170);">漏洞分析以及详细修复建议</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">1.可注入call漏洞</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;">漏洞分析</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">call是以太坊智能合约编写语言Solidity提供的底层函数，用来与外部合约或者库进行交互。</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">此类函数使用时需要对调用参数的安全性进行判定，建议谨慎使用。</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;">案例</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRpJqD0jiabdPic6P6E74iatdyl3Ygico0sMOzFhPcjLVz8k1Xw0AcvDuZDg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">receiver，_custom_fallback，_from, _amount,_data是由用户控制的，也就是说用户可以控制整个call调用，包括调用的合约地址（receiver），调用哪个函数（_custom_fallback）,以及传递的参数（_from,_amount,_data），这实际上是很危险的。在ATN事件中攻击者通过指定receiver为案例合约地址，利用DS-Auth授权，调用合约自身的函数，从而获得了合约的控制权<strong style="color:rgb(51,51,51);"><sup>[3]</sup></strong>。</span></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">此外，下面是ERC223标准的另一个call错误实现<strong style="color:rgb(51,51,51);"><sup>[4]</sup></strong>：</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRmJYIQBlwTnJtT5qNiaEZXZmwoibsajYDgU8YPPrDOD0LkSAYaibGAK04w/640?wx_fmt=png" alt="640?wx_fmt=png"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">这种合约本身允许用户自定义&nbsp;call()&nbsp;任意地址上任意函数的设计，十分危险。攻击者可以很容易地借用当前合约的身份来进行任何操作。可能导致如下后果：</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">1）允许攻击者以缺陷合约身份来盗走其它 Token 合约中的 Token</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">2）与 ds-auth 之类的鉴权机制结合，绕过合约自身的权限检查</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">3）允许攻击者以缺陷合约身份来盗走其它 Token 账户所授权（Approve）的Token</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">4）攻击者可传入虚假数据（_data）欺骗 Receiver 合约</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;">漏洞修复</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">1）推荐使用如下方式调用</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">tokenFallback函数</span></strong><br></p>
   <p style="text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRnfniaoEozou0Z1cunLTz1zkXUNyVWPibzSlOdOY7Zkk2t7aAVyYOzAog/640?wx_fmt=png" alt="640?wx_fmt=png"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;text-align:justify;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">2）DS-Auth在设置权限的时候，不要把合约本身地址加入白名单</span><br></p>
   <p style="text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRgeoggQk09ialQ1eSkruDu14CiciaRbDicL8LwDia2Ha0q8pUibbvANRNd21A/640?wx_fmt=png" alt="640?wx_fmt=png"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);"><br></span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">2.delegatecall误用漏洞</span></strong><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;">漏洞分析</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">DELEGATECALL会保持调用环境不变的属性表明，构建无漏洞的定制库并不像人们想象的那么容易。库中的代码本身可以是安全的，无漏洞的，但是当在另一个应用的环境中运行时，可能会出现新的漏洞。</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;">案例</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">案例代码来源于Ethernaut第6关<strong style="color:rgb(51,51,51);"><sup>[5]</sup></strong></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">﻿</span><img class="gallery-image" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9kYpEdmo8QBuT3yny5JyefRBR5kdUfPqTBFJWR7NzWKc6HPB2ia7UPS6WLcMLic201MUib4VcwicruaicA/640?wx_fmt=png" alt="640?wx_fmt=png"><span style="font-size:15px;letter-spacing:.5px;">﻿</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">在主合约Delegation的fallback函数中，可通过delegatecall调用Delegate合约的函数，并在主合约环境下执行，如果msg.data是0xdd365b8b(pwn()的函数签名)，即调用Delegate的pwn函数，那么消息发起者就可以变成主合约的owner<strong style="color:rgb(51,51,51);"><sup>[6]</sup></strong>。</span></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;">漏洞修复</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">Solidity 为实现库合约提供了关键字&nbsp;library&nbsp;（参见&nbsp;SolidityDocs&nbsp;了解更多详情)。这确保了library&nbsp;是无状态（Stateless）且不可自毁的。强制让library&nbsp;成为无状态的，可以缓解本节所述的存储环境的复杂性。无状态library&nbsp;还可以防止攻击者直接修改library&nbsp;状态以实现对依赖于library&nbsp;代码的合约的攻击。</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">在使用时&nbsp;DELEGATECALL&nbsp;时要特别注意库合约和调用合约可能对状态变量进行修改，并且尽可能构建无状态library&nbsp;。</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"></span><strong><span style="letter-spacing:.5px;font-size:18px;color:rgb(0,122,170);">真假难辨，如何防范</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">黑客千方百计试图欺骗合约，或无所不用其极地打开合约的后门，对合约的安全开发过程是一个严峻的考验，从内部和外部我们可以做到以下两点进行防范：</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <ol class="ql-long-8866642 list-paddingleft-2" style="margin-left:8px;">
    <li><p style="text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">跨合约调用时，</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">要慎用外部函数</span></strong><span style="font-size:15px;letter-spacing:.5px;">，周全考虑可能的调用风险，及时添补相应函数和规则，杜绝外患。</span></p><p style="text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">内部权限设置必须</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">考虑可能的权限被夺取的情况</span></strong><span style="font-size:15px;letter-spacing:.5px;">，从代码逻辑性和功能准确性全方面进行考量。</span></p></li>
   </ol>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">智能合约的安全规则终将会在安全团队与黑客的较量中不断完善，我们要做好打持久战的准备。</span></p>
   <p><br></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><strong style="color:rgb(51,51,51);"><span style="color:rgb(0,122,170);"><strong style="color:rgb(51,51,51);"><span style="color:rgb(0,122,170);">次回予告：</span></strong></span></strong></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">地址恢复功亏一篑</span></strong></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">身份判断轻虑浅谋</span></strong></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">逻辑补全自圆其说</span></strong></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;"><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">原理辨析帷幄运筹</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <blockquote>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">杨霞&nbsp;&nbsp;</span></p>
    <p style="margin-left:8px;color:rgb(51,51,51);"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">成都链安科技CEO，创始人。电子科技大学副教授，最早研究区块链形式化验证的专家。一直为航空航天、军事领域提供形式化验证服务。主持国家核高基、装发重大软件课题等近10项国家课题。CC国际安全标准成员、CCF区块链专委会委员。发表学术论文30多篇，申请20多项专利。</span></p>
   </blockquote>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><br></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">本文引用：</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">[1]&nbsp;</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">ATN抵御合约攻击的报告：</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">https://atn.io/resource/aareport.pdf</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">[2]&nbsp;</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">以太坊智能合约call注入攻击：</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">https://blog.csdn.net/u011721501/article/details/80757811</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">[3]&nbsp;</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">ATN披露特殊场景下的以太坊合约重大漏洞并与慢雾科技达成战略合作：</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">https://www.bitansuo.com/articles/512680.html</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">[4]&nbsp;</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">ERC223-token-standard：</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">https:/github.com/Dexaran/ERC223-token-standard/tree/Recommended</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">[5]&nbsp;</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">Ethernaut：</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">https://ethernaut.zeppelin.solutions</span></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">[6]&nbsp;</span><strong><span style="font-size:15px;letter-spacing:.5px;color:rgb(0,122,170);">delegatecall：</span></strong></p>
   <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">https://blog.sigmaprime.io/solidity-security.html</span></p>
   <p><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <blockquote>
    <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">内容转载请联系微信：</span></p>
    <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><em><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">qk15732632926（注明公众号+转载）</span></em></p>
    <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">商务合作请联系微信：</span></p>
    <p style="margin-left:8px;text-align:justify;line-height:1.75em;"><em><span style="font-size:15px;letter-spacing:.5px;color:rgb(136,136,136);">fengyan-1101（注明公司+合作意向）</span></em></p>
   </blockquote>
   <p><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p><span style="font-size:15px;letter-spacing:.5px;"><br></span></p>
   <p style="margin-left:8px;font-size:16px;color:rgb(51,51,51);font-family:'微软雅黑';text-align:center;background-color:rgb(255,255,255);line-height:1.75em;letter-spacing:.5px;"><span style="font-family:'宋体';font-size:15px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9lUGQW5MzBJAwicHRjXt8EiaxLuLKrknMw1MxRrd21kYaerjibWRJRTGLCY5YsIcqYHSP1pX3rmvmxEg/640?wx_fmt=png" alt="640?wx_fmt=png"></span></p>
   <p style="margin-left:8px;font-size:18px;line-height:1.75em;letter-spacing:.5px;"><span style="color:rgb(136,136,136);font-size:15px;"><strong><br></strong></span></p>
   <p style="margin-left:8px;font-size:18px;line-height:1.75em;letter-spacing:.5px;"><span style="color:rgb(136,136,136);font-size:15px;"><strong>最新热文：</strong></span></p>
   <ul class="list-paddingleft-2" style="margin-left:8px;">
    <li><p style="line-height:1.75em;letter-spacing:.5px;"><a href="http://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247487765&amp;idx=1&amp;sn=ef8f5bde79ca88358ead346072024322&amp;chksm=fc7c4fe8cb0bc6fe76238077055a1400c759c3587059b83e51f8f448c03e158b307459d40622&amp;scene=21#wechat_redirect" rel="nofollow" style="color:rgb(0,122,170);text-decoration:underline;font-size:15px;"><strong>40000%通货膨胀，总统险些被杀，第三代加密货币却被他们玩转了</strong></a><br></p></li>
    <li><p style="line-height:1.75em;letter-spacing:.5px;"><a href="http://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247487749&amp;idx=1&amp;sn=5a1688bb91eeb66257ef158620fe0921&amp;chksm=fc7c4ff8cb0bc6ee7ffbabcb2843a906f083f446cd75408f5a19821429d5c4faf512bfa9bc93&amp;scene=21#wechat_redirect" rel="nofollow" style="color:rgb(0,122,170);text-decoration:underline;font-size:15px;"><strong>27亿美金被狂撸！这些年，被狠狠抽脸的8次区块链安全祸事儿</strong></a><br></p></li>
    <li><p style="line-height:1.75em;letter-spacing:.5px;"><a href="http://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247487727&amp;idx=1&amp;sn=edd756976da2598a08a48419034347d0&amp;chksm=fc7c4e12cb0bc704f01aae93e94c44caa0f65124e5d385ba2083534bc79d1db7612aa245cb48&amp;scene=21#wechat_redirect" rel="nofollow" style="color:rgb(0,122,170);text-decoration:underline;font-size:15px;"><strong>我研究了V神的黄皮书，发现EVM里竟然藏着函数手册，虐哭你别怪我</strong></a><br></p></li>
    <li><p style="line-height:1.75em;letter-spacing:.5px;"><strong style="color:rgb(0,122,170);text-decoration:underline;font-size:15px;"><a href="http://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247487700&amp;idx=1&amp;sn=e8213ddc708c69afcf267569155af0c3&amp;chksm=fc7c4e29cb0bc73fe75c619f035fd9ee6738f0a315db15163a23eeebc80393ef44aeb286cb29&amp;scene=21#wechat_redirect" rel="nofollow" style="color:rgb(0,122,170);">黑客来袭！手把手带你深挖区块链安全漏洞</a></strong></p></li>
   </ul>
   <p><br></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/trm5VMeFp9lczGjKyM2GYHrEeRPuutG8OLBiaNVOVpTRkMwPAjauLhuFh7QD79wrNZrRMY9BswRBssMiaEoyRykg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;"><strong style="color:rgb(63,63,63);">扫码加入区块链大本营读者群，群满加微信 qk15732632926 入群</strong></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;"><strong style="color:rgb(63,63,63);"><br></strong></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;"><strong style="color:rgb(63,63,63);"><br></strong></span></p>
   <p style="letter-spacing:.544px;"><img class="__bg_gif" style="margin-left:auto;line-height:28px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/trm5VMeFp9kuuGYcoeg06IYM4TSEE1eCF4aiadptTMnNFDia5JfEBLuUslraYtDcYbKr2b4takjM2MfqeZYcVqkQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p style="letter-spacing:.544px;"><br></p>
   <p style="letter-spacing:.544px;"><br></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;"><strong><span style="color:rgb(0,122,170);">了解更多区块链技术及应用内容</span></strong></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;"><strong><span style="color:rgb(0,122,170);">敬请关注：</span></strong></span></p>
   <p style="margin-left:8px;text-align:center;line-height:1.75em;letter-spacing:.5px;"><img class="__bg_gif" style="width:644px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/trm5VMeFp9kegUbp0DLNf5dM2JbggFlThJvvibDiaEicHicPaTJV6oOMMWYZynQZcNupmQJIbPAdlVhT8PeicsKaFMQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/Blockchain_lemon/article/details/81571918,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/Blockchain_lemon/article/details/81571918,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
