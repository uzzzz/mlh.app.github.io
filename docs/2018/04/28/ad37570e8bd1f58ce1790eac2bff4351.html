<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>航天，百旺组件开票调用说明 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="航天，百旺组件开票调用说明" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="调用方法一：（SHKJKP.dll）&nbsp; 32位 functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKP.dll&#39;; 64位平台 functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKPx64.dll&#39;; &nbsp; 说明:不同的parameter功能传不同的值，下面为各功能的值。 相应文件可以在http://sh-gz.cn/下载 航天初始化： &#39;{&quot;LX&quot;:&quot;Of_Uninit&quot;}&#39; &#39;{&quot;LX&quot;:&quot;Of_init&quot;,&quot;QYSH&quot;:&quot;企业税号&quot;,&quot;CERT&quot;:&quot;12345678&quot;,&quot;FJH&quot;:&quot;0&quot;}&#39; JSON说明：企业税号,证书密码,分机号 &nbsp; 百旺初始化 &#39;{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;URL&quot;:&quot;https://skfp.tax.sh.gov.cn/acceptFramework/UniAcceptService&quot;,&quot;JSPPASSWORD&quot;:&quot;&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;}&#39; JSON说明：税务局URL(参考百旺的参数设置),金税盘口令，证书口令 &nbsp; 初始化调用示例1: 传入参数:{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;JSPPASSWORD&quot;:&quot;66666666&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;} &nbsp; 初始化返回值:&nbsp; 成功&nbsp;{&quot;Result&quot;:&quot;1&quot;,&quot;Message&quot;:&quot;&quot;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 失败&nbsp;{&quot;Result&quot;:&quot;0&quot;,&quot;Message&quot;:&quot;失败说明&quot;} &nbsp; 获取发票信息 &#39;{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;}&#39; &nbsp; JSON说明： 开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票） &nbsp;调用示例1: 查询参数:{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;} 返回{&quot;Result&quot;:&quot;1&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;4094639&quot;,&quot;COUNT&quot;:&quot;79&quot;,&quot;Message&quot;:&quot;&quot;} &nbsp; 开票 &#39;{&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;TEST&quot;:&quot;1&quot;,&quot;XML&quot;:&quot;XML并且经过base64编码&quot;}&#39; &nbsp; JSON说明： 开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），TEST 是否检验数据1不开票仅做数据检查、0直接开票，KP的xml数据 &nbsp;开票调用示例1: 传入参数: {&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;XML&quot;:&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KICA8SW52b2ljZUxpc3Q+DQogICAgICAgIDxJbnZIZWFkIEludm9pY2VOdW1iZXI9IjQ5ODQwMzEwNTIwNjEzMTIiIEN1c3RvbWVyTmFtZT0iyc+6o760zamyzdL7udzA7dPQz965q8u+IiBDdXN0b21lclRheENvZGU9IjkxMzEwMjMwTUExSlk0TFE5UCIgQWRkcmVzc0FuZFBob25lPSKz58P3x/izx8fF1fLQ48m9wrc4usUztLHSu8f4MDIxLTgwMzkyNDE3IiBCYW5rQW5kQWNjb3VudD0i1tC5+sWp0rXS+NDQu8a2ydan0NAwMzgzMDEwMDA0MDA0ODM2MyIgSkdDUz0iMSIgU2VsbGVyQmFua05hbWU9ItXQyczS+NDQucm33dPQz965q8u+xP6yqL2tsbHWp9DQNTc0OTA2MjUzNjEwMjAxIiBLSFNKPSIxMzY4MTIzNDU2NzgiIEtIWUo9IjMyOTEwNDQ4NDZAcXEuY29tIiBTZWxsZXJBZHJyUGhvbmU9IrnjtqvKobnj1t3K0MzsutPH+NbQyb2087XAMTAzNbrF06+4u8nMzvG088/DN8KlMDIwMTIzNDU2NzgiIFNlbGxlclRheENvZGU9IjkxNDQwMTAxTUE1OUxDSzE3MCIgRlBaTD0iMCIgSW52b2ljZU1lbW89IrG416IxMjMiIEtQUj0iwLXQocflIiBTS1I9Ire2zsC9+iIgRkhSPSK3ts7AvfoiIEZQSE09IiIgQ0hGUEg9IiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgSW5UYXhBbW91bnQ9IjEwNiIgVGF4UmF0ZT0iNiIgSXNMaXN0aW5nPSIwIiBKRUZTPSIwIiBSb3dDb3VudD0iMCIvPg0KICAgICAgICA8SW52RGV0YWlsPg0KICAgICAgICAgICAgPERldGFpbEVudHJ5IFByb2R1Y3RDb2RlPSIzMDQwMjAxMDMiIEVudHJ5TnVtYmVyPSIxIiBQcm9kdWN0TmFtZT0ivLzK9bf+zvG30SIgUHJvZHVjdE1vZGVsPSLV+8zXIiBQcm9kdWN0VW5pdD0izNciIFRheFJhdGU9IjYiIFF1YW50aXR5PSIxIiBQcmljZT0iMTAwIiBIU0RKPSIxMDYiIEFtb3VudD0iMTAwIiBUYXhBbW91bnQ9IjYiIFJvd0F0dHJpYj0iMCIgUHJvZHVjdFR5cGVzPSI0MDAxIiBGbGJtPSIzMDQwMjAxMDMwMDAwMDAwMDAwIiBYc3loPSIwIiBMc2x2YnM9IiIgWWhzbT0iIi8+DQogICAgICAgIDwvSW52RGV0YWlsPg0KICA8L0ludm9pY2VMaXN0ID4NCjwvQ29uZmlnPg0K&quot;} &nbsp; &nbsp;开票返回值: {&quot;Result&quot;:&quot;1&quot;,&quot;XML&quot;:&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KCTxJbnZvaWNlTGlzdD4NCgkJPEludkhlYWQgSW52b2ljZU51bWJlcj0iNDk4NDAzMTA1MjA2MTMxMiIgQ3VzdG9tZXJOYW1lPSLJz7qjvrTNqbLN0vu53MDt09DP3rmry74iIEN1c3RvbWVyVGF4Q29kZT0iOTEzMTAyMzBNQTFKWTRMUTlQIiBBZGRyZXNzQW5kUGhvbmU9IrPnw/fH+LPHx8XV8tDjyb3Ctzi6xTO0sdK7x/gwMjEtODAzOTI0MTciIEJhbmtBbmRBY2NvdW50PSLW0Ln6xanStdL40NC7xrbJ1qfQ0DAzODMwMTAwMDQwMDQ4MzYzIiBKR0NTPSIxIiBTZWxsZXJCYW5rTmFtZT0i1dDJzNL40NC5ybfd09DP3rmry77E/rKova2xsdan0NA1NzQ5MDYyNTM2MTAyMDEiIEtIU0o9IjEzNjgxMjM0NTY3OCIgS0hZSj0iMzI5MTA0NDg0NkBxcS5jb20iIFNlbGxlckFkcnJQaG9uZT0iueO2q8qhuePW3crQzOy608f41tDJvbTztcAxMDM1usXTr7i7yczO8bTzz8M3wqUwMjAxMjM0NTY3OCIgU2VsbGVyVGF4Q29kZT0iOTE0NDAxMDFNQTU5TENLMTcwIiBGUFpMPSIwIiBJbnZvaWNlTWVtbz0isbjXojEyMyIgS1BSPSLAtdChx+UiIFNLUj0it7bOwL36IiBGSFI9Ire2zsC9+iIgRlBITT0iIiBDSEZQSD0iIiBBbW91bnQ9IjEwMCIgVGF4QW1vdW50PSI2IiBJblRheEFtb3VudD0iMTA2IiBUYXhSYXRlPSI2IiBJc0xpc3Rpbmc9IjAiIEpFRlM9IjAiIFJvd0NvdW50PSIwIiBSRVRDT0RFPSIwMDAwMDAzMiIgUkVUTVNHPSLLsL/YyeixuNC0t6LGscP3z7jKsdLss6MgIERpc2tFcnI6MDlkMTFmIi8+DQoJCTxJbnZEZXRhaWw+DQoJCQk8RGV0YWlsRW50cnkgUHJvZHVjdENvZGU9IjMwNDAyMDEwMyIgRW50cnlOdW1iZXI9IjEiIFByb2R1Y3ROYW1lPSK8vMr1t/7O8bfRIiBQcm9kdWN0TW9kZWw9ItX7zNciIFByb2R1Y3RVbml0PSLM1yIgVGF4UmF0ZT0iNiIgUXVhbnRpdHk9IjEiIFByaWNlPSIxMDAiIEhTREo9IjEwNiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgUm93QXR0cmliPSIwIiBQcm9kdWN0VHlwZXM9IjQwMDEiIEZsYm09IjMwNDAyMDEwMzAwMDAwMDAwMDAiIFhzeWg9IjAiIExzbHZicz0iIiBZaHNtPSIiLz4NCgkJPC9JbnZEZXRhaWw+DQoJPC9JbnZvaWNlTGlzdD4NCjwvQ29uZmlnPg0K&quot;} &nbsp; 作废 &#39;{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;}&#39; JSON说明： 开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票）、发票代码，发票号码 &nbsp; 作废调用 示例1: &nbsp;&nbsp;&nbsp;&nbsp; 传入参数{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;04138547&quot;} &nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp;&nbsp;{&quot;Result&quot;:&quot;0&quot;,&quot;Message&quot;:&quot;FPZF-ZF-不能作废发票或开具红字发票，原发票已开作废发票&quot;} 打印发票 &#39;{&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;,&quot;QDBZ&quot;:&quot;&quot;,&quot;ISVISIBLE&quot;:&quot;&quot;}&#39; JSON说明： 开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），发票代码，发票号码，打印类型（0打印发票 1打印清单），是否显示打印设置窗口（0不显示 1显示） &nbsp;&nbsp; 打印调用示例1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传入参数: {&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;04138532&quot;,&quot;QDBZ&quot;:&quot;0&quot;,&quot;ISVISIBLE&quot;:&quot;0&quot;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp; :{&quot;Result&quot;:&quot;1&quot;,&quot;Message&quot;:&quot;&quot;} 调用方法二：采用OCX调用 COM名称：KPOCXDLL.KP &nbsp; functionSHKP(const Param1: WideString): WideString; safecall; 调用方法三：在 B/S架构中，JS写法 myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;Of_init&quot;,&quot;QYSH&quot;:&quot;税号&quot;,&quot;CERT&quot;:&quot;12345678&quot;,&quot;FJH&quot;:&quot;0&quot;}&#39;); myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;&#39;{&quot;LX&quot;:&quot;Of_Uninit&quot;}&#39;); myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;&#39;{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;JSPPASSWORD&quot;:&quot;&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;}&#39; ); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;XML&quot;:&quot;XML并且经过base64编码&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;,&quot;QDBZ&quot;:&quot;0&quot;,&quot;ISVISIBLE&quot;:&quot;1&quot;}&#39;)); &nbsp; xml:说明： &lt;?xmlversion=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt; &lt;Config&gt; &nbsp; &lt;InvoiceList&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InvHead InvoiceNumber=&quot;单据号&quot; CustomerName=&quot;客户名称&quot; CustomerTaxCode=&quot;税号&quot; AddressAndPhone=&quot;地址&quot; BankAndAccount=&quot;客户银行账号&quot; JGCS=”1”SellerBankName=&quot;销方银行账号&quot; KHSJ=”客户手机”KHYJ=”客户邮件” SellerAdrrPhone=&quot;销方地址和电话&quot; SellerTaxCode=”销方税号”FPZL=”发票种类” InvoiceMemo=&quot;备注&quot; KPR=&quot;开票人&quot; SKR=&quot;收款人&quot; FHR=&quot;复核人&quot; FPHM=”红冲发票原发票号” CHFPH=&quot;信息表编号&quot; Amount=”整张发票不含税金额” TaxAmount=”整张发票税额” InTaxAmount=”整张发票价税合计” TaxRate=”税率” IsListing=”是否开具清单0不强制开清单 1强制开清单”JEFS=”正常票0 红冲票1” RowCount=”0”/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InvDetail&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DetailEntry ProductCode=&quot;产品代码&quot; EntryNumber=”行号，从1开始算起”ProductName=&quot;产品名称&quot; ProductModel=&quot;产品型号&quot; ProductUnit=&quot;产品单位&quot; TaxRate=&quot;税率&quot; Quantity=&quot;数量&quot; Price=”不含税价” HSDJ=”含税价” Amount=&quot;不含税金额&quot; TaxAmount=&quot;税额&quot; RowAttrib=”行性质0正常行 3被折扣行 4折扣行” ProductTypes=&quot;4001&quot; Flbm=&quot;分类编码&quot; Xsyh=&quot;税率优惠 0无优惠1有优惠&quot; Lslvbs=&quot;零税率标志&quot; Yhsm=&quot;优惠说明&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/InvDetail&gt; &nbsp; &lt;/InvoiceList &gt; &lt;/Config&gt; 如果是多张发票：那么就多个 InvoiceList节点，如果一张发票，多行明细，那么就多个 DetailEntry节点 &nbsp; 名称 说明 是否可以为空 备注 默认值 InvoiceNumber 单据号 否 &nbsp; &nbsp; CustomerName 客户名称 否 &nbsp; &nbsp; CustomerTaxCode 客户税号 是 按税务规定，开具给企业的发票必需有税号 &nbsp; AddressAndPhone 客户地址电话 是 &nbsp; &nbsp; BankAndAccount 客户银行账号 是 &nbsp; &nbsp; KHSJ 客户手机 是 &nbsp; &nbsp; KHYJ 客户邮件 是 &nbsp; &nbsp; SellerBankName 销方银行账号 否 &nbsp; &nbsp; SellerAdrrPhone 销方地址和电话 否 &nbsp; &nbsp; SellerTaxCode 销方税号 否 &nbsp; &nbsp; FPZL 发票种类 否 &nbsp; &nbsp; InvoiceMemo 备注 是 &nbsp; &nbsp; KPR 开票人 否 &nbsp; &nbsp; SKR 收款人 是 &nbsp; &nbsp; FHR 复核人 是 &nbsp; &nbsp; FPHM 红冲发票原发票号 是 当发票种类是普票、电票、卷票、运输发票并且JEFS=1时，必需传原发票号过来 &nbsp; CHFPH 红字信息表编码 是 当发票种类是专票并且JEFS=1时，必需传红字信息表编号 &nbsp; Amount 整张发票不含税金额 否 等于 明细行的 Amount 之和 &nbsp; TaxAmount 整张发票税额 否 等于 明细行的 TaxAmount 之和 &nbsp; InTaxAmount 整张发票价税合计 否 等于 Amount+ TaxAmount &nbsp; TaxRate 税率 是 可以是17，也可以是0.17，当明细行有多种税率时，必需是空 &nbsp; IsListing 是否强制开具清单 否 0 不进行强制，由系统自动处理，当超过8行明细时，系统自动出具清单。 1 进行强制转换成清单，强制转换后，没超过8行明细也会出具清单 0 JEFS 开具类型 否 0 正常发票 1 红字发票 0 RowCount 明细汇总行数 否 用固定值 0 0 明细字段说明 ProductCode 产品代码 是 &nbsp; &nbsp; EntryNumber 行号 否 从1开始算起 &nbsp; ProductName 产品名称 否 &nbsp; &nbsp; ProductModel 产品型号 是 &nbsp; &nbsp; ProductUnit 产品单位 是 &nbsp; &nbsp; TaxRate 税率 否 可以是17，也可以是0.17 &nbsp; Quantity 数量 是 当不需要打印数量时，传空 &nbsp; Price 不含税价 是 当不需要打印单价时，传空 &nbsp; HSDJ 含税价 是 当不需要打印单价时，传空 &nbsp; Amount 不含税金额 否 &nbsp; &nbsp; TaxAmount 税额 否 &nbsp; &nbsp; RowAttrib 行性质 否 正常行 :0 被折扣行 3 折扣行 4 &nbsp; ProductTypes 商品税目 是 4001代表是 商品销售 4001 Flbm 分类编码 否 &nbsp; &nbsp; Xsyh 税收优惠 否 无税收优惠0 有税收优惠1 &nbsp; Lslvbs 零税率标志 是 当税收优惠=1时 免税 1出口零税 0不征税 2 其它3，当税收优惠是0时，空 &nbsp; Yhsm 优惠说明 是 &nbsp; &nbsp; &nbsp; &nbsp; 注意：如果红字 带清单的，只需要传一行明细， 产品名称必需是 详见对应正数发票及清单 阅读更多" />
<meta property="og:description" content="调用方法一：（SHKJKP.dll）&nbsp; 32位 functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKP.dll&#39;; 64位平台 functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKPx64.dll&#39;; &nbsp; 说明:不同的parameter功能传不同的值，下面为各功能的值。 相应文件可以在http://sh-gz.cn/下载 航天初始化： &#39;{&quot;LX&quot;:&quot;Of_Uninit&quot;}&#39; &#39;{&quot;LX&quot;:&quot;Of_init&quot;,&quot;QYSH&quot;:&quot;企业税号&quot;,&quot;CERT&quot;:&quot;12345678&quot;,&quot;FJH&quot;:&quot;0&quot;}&#39; JSON说明：企业税号,证书密码,分机号 &nbsp; 百旺初始化 &#39;{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;URL&quot;:&quot;https://skfp.tax.sh.gov.cn/acceptFramework/UniAcceptService&quot;,&quot;JSPPASSWORD&quot;:&quot;&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;}&#39; JSON说明：税务局URL(参考百旺的参数设置),金税盘口令，证书口令 &nbsp; 初始化调用示例1: 传入参数:{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;JSPPASSWORD&quot;:&quot;66666666&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;} &nbsp; 初始化返回值:&nbsp; 成功&nbsp;{&quot;Result&quot;:&quot;1&quot;,&quot;Message&quot;:&quot;&quot;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 失败&nbsp;{&quot;Result&quot;:&quot;0&quot;,&quot;Message&quot;:&quot;失败说明&quot;} &nbsp; 获取发票信息 &#39;{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;}&#39; &nbsp; JSON说明： 开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票） &nbsp;调用示例1: 查询参数:{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;} 返回{&quot;Result&quot;:&quot;1&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;4094639&quot;,&quot;COUNT&quot;:&quot;79&quot;,&quot;Message&quot;:&quot;&quot;} &nbsp; 开票 &#39;{&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;TEST&quot;:&quot;1&quot;,&quot;XML&quot;:&quot;XML并且经过base64编码&quot;}&#39; &nbsp; JSON说明： 开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），TEST 是否检验数据1不开票仅做数据检查、0直接开票，KP的xml数据 &nbsp;开票调用示例1: 传入参数: {&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;XML&quot;:&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KICA8SW52b2ljZUxpc3Q+DQogICAgICAgIDxJbnZIZWFkIEludm9pY2VOdW1iZXI9IjQ5ODQwMzEwNTIwNjEzMTIiIEN1c3RvbWVyTmFtZT0iyc+6o760zamyzdL7udzA7dPQz965q8u+IiBDdXN0b21lclRheENvZGU9IjkxMzEwMjMwTUExSlk0TFE5UCIgQWRkcmVzc0FuZFBob25lPSKz58P3x/izx8fF1fLQ48m9wrc4usUztLHSu8f4MDIxLTgwMzkyNDE3IiBCYW5rQW5kQWNjb3VudD0i1tC5+sWp0rXS+NDQu8a2ydan0NAwMzgzMDEwMDA0MDA0ODM2MyIgSkdDUz0iMSIgU2VsbGVyQmFua05hbWU9ItXQyczS+NDQucm33dPQz965q8u+xP6yqL2tsbHWp9DQNTc0OTA2MjUzNjEwMjAxIiBLSFNKPSIxMzY4MTIzNDU2NzgiIEtIWUo9IjMyOTEwNDQ4NDZAcXEuY29tIiBTZWxsZXJBZHJyUGhvbmU9IrnjtqvKobnj1t3K0MzsutPH+NbQyb2087XAMTAzNbrF06+4u8nMzvG088/DN8KlMDIwMTIzNDU2NzgiIFNlbGxlclRheENvZGU9IjkxNDQwMTAxTUE1OUxDSzE3MCIgRlBaTD0iMCIgSW52b2ljZU1lbW89IrG416IxMjMiIEtQUj0iwLXQocflIiBTS1I9Ire2zsC9+iIgRkhSPSK3ts7AvfoiIEZQSE09IiIgQ0hGUEg9IiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgSW5UYXhBbW91bnQ9IjEwNiIgVGF4UmF0ZT0iNiIgSXNMaXN0aW5nPSIwIiBKRUZTPSIwIiBSb3dDb3VudD0iMCIvPg0KICAgICAgICA8SW52RGV0YWlsPg0KICAgICAgICAgICAgPERldGFpbEVudHJ5IFByb2R1Y3RDb2RlPSIzMDQwMjAxMDMiIEVudHJ5TnVtYmVyPSIxIiBQcm9kdWN0TmFtZT0ivLzK9bf+zvG30SIgUHJvZHVjdE1vZGVsPSLV+8zXIiBQcm9kdWN0VW5pdD0izNciIFRheFJhdGU9IjYiIFF1YW50aXR5PSIxIiBQcmljZT0iMTAwIiBIU0RKPSIxMDYiIEFtb3VudD0iMTAwIiBUYXhBbW91bnQ9IjYiIFJvd0F0dHJpYj0iMCIgUHJvZHVjdFR5cGVzPSI0MDAxIiBGbGJtPSIzMDQwMjAxMDMwMDAwMDAwMDAwIiBYc3loPSIwIiBMc2x2YnM9IiIgWWhzbT0iIi8+DQogICAgICAgIDwvSW52RGV0YWlsPg0KICA8L0ludm9pY2VMaXN0ID4NCjwvQ29uZmlnPg0K&quot;} &nbsp; &nbsp;开票返回值: {&quot;Result&quot;:&quot;1&quot;,&quot;XML&quot;:&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KCTxJbnZvaWNlTGlzdD4NCgkJPEludkhlYWQgSW52b2ljZU51bWJlcj0iNDk4NDAzMTA1MjA2MTMxMiIgQ3VzdG9tZXJOYW1lPSLJz7qjvrTNqbLN0vu53MDt09DP3rmry74iIEN1c3RvbWVyVGF4Q29kZT0iOTEzMTAyMzBNQTFKWTRMUTlQIiBBZGRyZXNzQW5kUGhvbmU9IrPnw/fH+LPHx8XV8tDjyb3Ctzi6xTO0sdK7x/gwMjEtODAzOTI0MTciIEJhbmtBbmRBY2NvdW50PSLW0Ln6xanStdL40NC7xrbJ1qfQ0DAzODMwMTAwMDQwMDQ4MzYzIiBKR0NTPSIxIiBTZWxsZXJCYW5rTmFtZT0i1dDJzNL40NC5ybfd09DP3rmry77E/rKova2xsdan0NA1NzQ5MDYyNTM2MTAyMDEiIEtIU0o9IjEzNjgxMjM0NTY3OCIgS0hZSj0iMzI5MTA0NDg0NkBxcS5jb20iIFNlbGxlckFkcnJQaG9uZT0iueO2q8qhuePW3crQzOy608f41tDJvbTztcAxMDM1usXTr7i7yczO8bTzz8M3wqUwMjAxMjM0NTY3OCIgU2VsbGVyVGF4Q29kZT0iOTE0NDAxMDFNQTU5TENLMTcwIiBGUFpMPSIwIiBJbnZvaWNlTWVtbz0isbjXojEyMyIgS1BSPSLAtdChx+UiIFNLUj0it7bOwL36IiBGSFI9Ire2zsC9+iIgRlBITT0iIiBDSEZQSD0iIiBBbW91bnQ9IjEwMCIgVGF4QW1vdW50PSI2IiBJblRheEFtb3VudD0iMTA2IiBUYXhSYXRlPSI2IiBJc0xpc3Rpbmc9IjAiIEpFRlM9IjAiIFJvd0NvdW50PSIwIiBSRVRDT0RFPSIwMDAwMDAzMiIgUkVUTVNHPSLLsL/YyeixuNC0t6LGscP3z7jKsdLss6MgIERpc2tFcnI6MDlkMTFmIi8+DQoJCTxJbnZEZXRhaWw+DQoJCQk8RGV0YWlsRW50cnkgUHJvZHVjdENvZGU9IjMwNDAyMDEwMyIgRW50cnlOdW1iZXI9IjEiIFByb2R1Y3ROYW1lPSK8vMr1t/7O8bfRIiBQcm9kdWN0TW9kZWw9ItX7zNciIFByb2R1Y3RVbml0PSLM1yIgVGF4UmF0ZT0iNiIgUXVhbnRpdHk9IjEiIFByaWNlPSIxMDAiIEhTREo9IjEwNiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgUm93QXR0cmliPSIwIiBQcm9kdWN0VHlwZXM9IjQwMDEiIEZsYm09IjMwNDAyMDEwMzAwMDAwMDAwMDAiIFhzeWg9IjAiIExzbHZicz0iIiBZaHNtPSIiLz4NCgkJPC9JbnZEZXRhaWw+DQoJPC9JbnZvaWNlTGlzdD4NCjwvQ29uZmlnPg0K&quot;} &nbsp; 作废 &#39;{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;}&#39; JSON说明： 开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票）、发票代码，发票号码 &nbsp; 作废调用 示例1: &nbsp;&nbsp;&nbsp;&nbsp; 传入参数{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;04138547&quot;} &nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp;&nbsp;{&quot;Result&quot;:&quot;0&quot;,&quot;Message&quot;:&quot;FPZF-ZF-不能作废发票或开具红字发票，原发票已开作废发票&quot;} 打印发票 &#39;{&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;,&quot;QDBZ&quot;:&quot;&quot;,&quot;ISVISIBLE&quot;:&quot;&quot;}&#39; JSON说明： 开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），发票代码，发票号码，打印类型（0打印发票 1打印清单），是否显示打印设置窗口（0不显示 1显示） &nbsp;&nbsp; 打印调用示例1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传入参数: {&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;04138532&quot;,&quot;QDBZ&quot;:&quot;0&quot;,&quot;ISVISIBLE&quot;:&quot;0&quot;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp; :{&quot;Result&quot;:&quot;1&quot;,&quot;Message&quot;:&quot;&quot;} 调用方法二：采用OCX调用 COM名称：KPOCXDLL.KP &nbsp; functionSHKP(const Param1: WideString): WideString; safecall; 调用方法三：在 B/S架构中，JS写法 myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;Of_init&quot;,&quot;QYSH&quot;:&quot;税号&quot;,&quot;CERT&quot;:&quot;12345678&quot;,&quot;FJH&quot;:&quot;0&quot;}&#39;); myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;&#39;{&quot;LX&quot;:&quot;Of_Uninit&quot;}&#39;); myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;&#39;{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;JSPPASSWORD&quot;:&quot;&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;}&#39; ); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;XML&quot;:&quot;XML并且经过base64编码&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;,&quot;QDBZ&quot;:&quot;0&quot;,&quot;ISVISIBLE&quot;:&quot;1&quot;}&#39;)); &nbsp; xml:说明： &lt;?xmlversion=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt; &lt;Config&gt; &nbsp; &lt;InvoiceList&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InvHead InvoiceNumber=&quot;单据号&quot; CustomerName=&quot;客户名称&quot; CustomerTaxCode=&quot;税号&quot; AddressAndPhone=&quot;地址&quot; BankAndAccount=&quot;客户银行账号&quot; JGCS=”1”SellerBankName=&quot;销方银行账号&quot; KHSJ=”客户手机”KHYJ=”客户邮件” SellerAdrrPhone=&quot;销方地址和电话&quot; SellerTaxCode=”销方税号”FPZL=”发票种类” InvoiceMemo=&quot;备注&quot; KPR=&quot;开票人&quot; SKR=&quot;收款人&quot; FHR=&quot;复核人&quot; FPHM=”红冲发票原发票号” CHFPH=&quot;信息表编号&quot; Amount=”整张发票不含税金额” TaxAmount=”整张发票税额” InTaxAmount=”整张发票价税合计” TaxRate=”税率” IsListing=”是否开具清单0不强制开清单 1强制开清单”JEFS=”正常票0 红冲票1” RowCount=”0”/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InvDetail&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DetailEntry ProductCode=&quot;产品代码&quot; EntryNumber=”行号，从1开始算起”ProductName=&quot;产品名称&quot; ProductModel=&quot;产品型号&quot; ProductUnit=&quot;产品单位&quot; TaxRate=&quot;税率&quot; Quantity=&quot;数量&quot; Price=”不含税价” HSDJ=”含税价” Amount=&quot;不含税金额&quot; TaxAmount=&quot;税额&quot; RowAttrib=”行性质0正常行 3被折扣行 4折扣行” ProductTypes=&quot;4001&quot; Flbm=&quot;分类编码&quot; Xsyh=&quot;税率优惠 0无优惠1有优惠&quot; Lslvbs=&quot;零税率标志&quot; Yhsm=&quot;优惠说明&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/InvDetail&gt; &nbsp; &lt;/InvoiceList &gt; &lt;/Config&gt; 如果是多张发票：那么就多个 InvoiceList节点，如果一张发票，多行明细，那么就多个 DetailEntry节点 &nbsp; 名称 说明 是否可以为空 备注 默认值 InvoiceNumber 单据号 否 &nbsp; &nbsp; CustomerName 客户名称 否 &nbsp; &nbsp; CustomerTaxCode 客户税号 是 按税务规定，开具给企业的发票必需有税号 &nbsp; AddressAndPhone 客户地址电话 是 &nbsp; &nbsp; BankAndAccount 客户银行账号 是 &nbsp; &nbsp; KHSJ 客户手机 是 &nbsp; &nbsp; KHYJ 客户邮件 是 &nbsp; &nbsp; SellerBankName 销方银行账号 否 &nbsp; &nbsp; SellerAdrrPhone 销方地址和电话 否 &nbsp; &nbsp; SellerTaxCode 销方税号 否 &nbsp; &nbsp; FPZL 发票种类 否 &nbsp; &nbsp; InvoiceMemo 备注 是 &nbsp; &nbsp; KPR 开票人 否 &nbsp; &nbsp; SKR 收款人 是 &nbsp; &nbsp; FHR 复核人 是 &nbsp; &nbsp; FPHM 红冲发票原发票号 是 当发票种类是普票、电票、卷票、运输发票并且JEFS=1时，必需传原发票号过来 &nbsp; CHFPH 红字信息表编码 是 当发票种类是专票并且JEFS=1时，必需传红字信息表编号 &nbsp; Amount 整张发票不含税金额 否 等于 明细行的 Amount 之和 &nbsp; TaxAmount 整张发票税额 否 等于 明细行的 TaxAmount 之和 &nbsp; InTaxAmount 整张发票价税合计 否 等于 Amount+ TaxAmount &nbsp; TaxRate 税率 是 可以是17，也可以是0.17，当明细行有多种税率时，必需是空 &nbsp; IsListing 是否强制开具清单 否 0 不进行强制，由系统自动处理，当超过8行明细时，系统自动出具清单。 1 进行强制转换成清单，强制转换后，没超过8行明细也会出具清单 0 JEFS 开具类型 否 0 正常发票 1 红字发票 0 RowCount 明细汇总行数 否 用固定值 0 0 明细字段说明 ProductCode 产品代码 是 &nbsp; &nbsp; EntryNumber 行号 否 从1开始算起 &nbsp; ProductName 产品名称 否 &nbsp; &nbsp; ProductModel 产品型号 是 &nbsp; &nbsp; ProductUnit 产品单位 是 &nbsp; &nbsp; TaxRate 税率 否 可以是17，也可以是0.17 &nbsp; Quantity 数量 是 当不需要打印数量时，传空 &nbsp; Price 不含税价 是 当不需要打印单价时，传空 &nbsp; HSDJ 含税价 是 当不需要打印单价时，传空 &nbsp; Amount 不含税金额 否 &nbsp; &nbsp; TaxAmount 税额 否 &nbsp; &nbsp; RowAttrib 行性质 否 正常行 :0 被折扣行 3 折扣行 4 &nbsp; ProductTypes 商品税目 是 4001代表是 商品销售 4001 Flbm 分类编码 否 &nbsp; &nbsp; Xsyh 税收优惠 否 无税收优惠0 有税收优惠1 &nbsp; Lslvbs 零税率标志 是 当税收优惠=1时 免税 1出口零税 0不征税 2 其它3，当税收优惠是0时，空 &nbsp; Yhsm 优惠说明 是 &nbsp; &nbsp; &nbsp; &nbsp; 注意：如果红字 带清单的，只需要传一行明细， 产品名称必需是 详见对应正数发票及清单 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/04/28/ad37570e8bd1f58ce1790eac2bff4351.html" />
<meta property="og:url" content="https://mlh.app/2018/04/28/ad37570e8bd1f58ce1790eac2bff4351.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-28T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"调用方法一：（SHKJKP.dll）&nbsp; 32位 functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKP.dll&#39;; 64位平台 functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKPx64.dll&#39;; &nbsp; 说明:不同的parameter功能传不同的值，下面为各功能的值。 相应文件可以在http://sh-gz.cn/下载 航天初始化： &#39;{&quot;LX&quot;:&quot;Of_Uninit&quot;}&#39; &#39;{&quot;LX&quot;:&quot;Of_init&quot;,&quot;QYSH&quot;:&quot;企业税号&quot;,&quot;CERT&quot;:&quot;12345678&quot;,&quot;FJH&quot;:&quot;0&quot;}&#39; JSON说明：企业税号,证书密码,分机号 &nbsp; 百旺初始化 &#39;{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;URL&quot;:&quot;https://skfp.tax.sh.gov.cn/acceptFramework/UniAcceptService&quot;,&quot;JSPPASSWORD&quot;:&quot;&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;}&#39; JSON说明：税务局URL(参考百旺的参数设置),金税盘口令，证书口令 &nbsp; 初始化调用示例1: 传入参数:{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;JSPPASSWORD&quot;:&quot;66666666&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;} &nbsp; 初始化返回值:&nbsp; 成功&nbsp;{&quot;Result&quot;:&quot;1&quot;,&quot;Message&quot;:&quot;&quot;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 失败&nbsp;{&quot;Result&quot;:&quot;0&quot;,&quot;Message&quot;:&quot;失败说明&quot;} &nbsp; 获取发票信息 &#39;{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;}&#39; &nbsp; JSON说明： 开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票） &nbsp;调用示例1: 查询参数:{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;} 返回{&quot;Result&quot;:&quot;1&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;4094639&quot;,&quot;COUNT&quot;:&quot;79&quot;,&quot;Message&quot;:&quot;&quot;} &nbsp; 开票 &#39;{&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;TEST&quot;:&quot;1&quot;,&quot;XML&quot;:&quot;XML并且经过base64编码&quot;}&#39; &nbsp; JSON说明： 开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），TEST 是否检验数据1不开票仅做数据检查、0直接开票，KP的xml数据 &nbsp;开票调用示例1: 传入参数: {&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;XML&quot;:&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KICA8SW52b2ljZUxpc3Q+DQogICAgICAgIDxJbnZIZWFkIEludm9pY2VOdW1iZXI9IjQ5ODQwMzEwNTIwNjEzMTIiIEN1c3RvbWVyTmFtZT0iyc+6o760zamyzdL7udzA7dPQz965q8u+IiBDdXN0b21lclRheENvZGU9IjkxMzEwMjMwTUExSlk0TFE5UCIgQWRkcmVzc0FuZFBob25lPSKz58P3x/izx8fF1fLQ48m9wrc4usUztLHSu8f4MDIxLTgwMzkyNDE3IiBCYW5rQW5kQWNjb3VudD0i1tC5+sWp0rXS+NDQu8a2ydan0NAwMzgzMDEwMDA0MDA0ODM2MyIgSkdDUz0iMSIgU2VsbGVyQmFua05hbWU9ItXQyczS+NDQucm33dPQz965q8u+xP6yqL2tsbHWp9DQNTc0OTA2MjUzNjEwMjAxIiBLSFNKPSIxMzY4MTIzNDU2NzgiIEtIWUo9IjMyOTEwNDQ4NDZAcXEuY29tIiBTZWxsZXJBZHJyUGhvbmU9IrnjtqvKobnj1t3K0MzsutPH+NbQyb2087XAMTAzNbrF06+4u8nMzvG088/DN8KlMDIwMTIzNDU2NzgiIFNlbGxlclRheENvZGU9IjkxNDQwMTAxTUE1OUxDSzE3MCIgRlBaTD0iMCIgSW52b2ljZU1lbW89IrG416IxMjMiIEtQUj0iwLXQocflIiBTS1I9Ire2zsC9+iIgRkhSPSK3ts7AvfoiIEZQSE09IiIgQ0hGUEg9IiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgSW5UYXhBbW91bnQ9IjEwNiIgVGF4UmF0ZT0iNiIgSXNMaXN0aW5nPSIwIiBKRUZTPSIwIiBSb3dDb3VudD0iMCIvPg0KICAgICAgICA8SW52RGV0YWlsPg0KICAgICAgICAgICAgPERldGFpbEVudHJ5IFByb2R1Y3RDb2RlPSIzMDQwMjAxMDMiIEVudHJ5TnVtYmVyPSIxIiBQcm9kdWN0TmFtZT0ivLzK9bf+zvG30SIgUHJvZHVjdE1vZGVsPSLV+8zXIiBQcm9kdWN0VW5pdD0izNciIFRheFJhdGU9IjYiIFF1YW50aXR5PSIxIiBQcmljZT0iMTAwIiBIU0RKPSIxMDYiIEFtb3VudD0iMTAwIiBUYXhBbW91bnQ9IjYiIFJvd0F0dHJpYj0iMCIgUHJvZHVjdFR5cGVzPSI0MDAxIiBGbGJtPSIzMDQwMjAxMDMwMDAwMDAwMDAwIiBYc3loPSIwIiBMc2x2YnM9IiIgWWhzbT0iIi8+DQogICAgICAgIDwvSW52RGV0YWlsPg0KICA8L0ludm9pY2VMaXN0ID4NCjwvQ29uZmlnPg0K&quot;} &nbsp; &nbsp;开票返回值: {&quot;Result&quot;:&quot;1&quot;,&quot;XML&quot;:&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KCTxJbnZvaWNlTGlzdD4NCgkJPEludkhlYWQgSW52b2ljZU51bWJlcj0iNDk4NDAzMTA1MjA2MTMxMiIgQ3VzdG9tZXJOYW1lPSLJz7qjvrTNqbLN0vu53MDt09DP3rmry74iIEN1c3RvbWVyVGF4Q29kZT0iOTEzMTAyMzBNQTFKWTRMUTlQIiBBZGRyZXNzQW5kUGhvbmU9IrPnw/fH+LPHx8XV8tDjyb3Ctzi6xTO0sdK7x/gwMjEtODAzOTI0MTciIEJhbmtBbmRBY2NvdW50PSLW0Ln6xanStdL40NC7xrbJ1qfQ0DAzODMwMTAwMDQwMDQ4MzYzIiBKR0NTPSIxIiBTZWxsZXJCYW5rTmFtZT0i1dDJzNL40NC5ybfd09DP3rmry77E/rKova2xsdan0NA1NzQ5MDYyNTM2MTAyMDEiIEtIU0o9IjEzNjgxMjM0NTY3OCIgS0hZSj0iMzI5MTA0NDg0NkBxcS5jb20iIFNlbGxlckFkcnJQaG9uZT0iueO2q8qhuePW3crQzOy608f41tDJvbTztcAxMDM1usXTr7i7yczO8bTzz8M3wqUwMjAxMjM0NTY3OCIgU2VsbGVyVGF4Q29kZT0iOTE0NDAxMDFNQTU5TENLMTcwIiBGUFpMPSIwIiBJbnZvaWNlTWVtbz0isbjXojEyMyIgS1BSPSLAtdChx+UiIFNLUj0it7bOwL36IiBGSFI9Ire2zsC9+iIgRlBITT0iIiBDSEZQSD0iIiBBbW91bnQ9IjEwMCIgVGF4QW1vdW50PSI2IiBJblRheEFtb3VudD0iMTA2IiBUYXhSYXRlPSI2IiBJc0xpc3Rpbmc9IjAiIEpFRlM9IjAiIFJvd0NvdW50PSIwIiBSRVRDT0RFPSIwMDAwMDAzMiIgUkVUTVNHPSLLsL/YyeixuNC0t6LGscP3z7jKsdLss6MgIERpc2tFcnI6MDlkMTFmIi8+DQoJCTxJbnZEZXRhaWw+DQoJCQk8RGV0YWlsRW50cnkgUHJvZHVjdENvZGU9IjMwNDAyMDEwMyIgRW50cnlOdW1iZXI9IjEiIFByb2R1Y3ROYW1lPSK8vMr1t/7O8bfRIiBQcm9kdWN0TW9kZWw9ItX7zNciIFByb2R1Y3RVbml0PSLM1yIgVGF4UmF0ZT0iNiIgUXVhbnRpdHk9IjEiIFByaWNlPSIxMDAiIEhTREo9IjEwNiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgUm93QXR0cmliPSIwIiBQcm9kdWN0VHlwZXM9IjQwMDEiIEZsYm09IjMwNDAyMDEwMzAwMDAwMDAwMDAiIFhzeWg9IjAiIExzbHZicz0iIiBZaHNtPSIiLz4NCgkJPC9JbnZEZXRhaWw+DQoJPC9JbnZvaWNlTGlzdD4NCjwvQ29uZmlnPg0K&quot;} &nbsp; 作废 &#39;{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;}&#39; JSON说明： 开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票）、发票代码，发票号码 &nbsp; 作废调用 示例1: &nbsp;&nbsp;&nbsp;&nbsp; 传入参数{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;04138547&quot;} &nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp;&nbsp;{&quot;Result&quot;:&quot;0&quot;,&quot;Message&quot;:&quot;FPZF-ZF-不能作废发票或开具红字发票，原发票已开作废发票&quot;} 打印发票 &#39;{&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;,&quot;QDBZ&quot;:&quot;&quot;,&quot;ISVISIBLE&quot;:&quot;&quot;}&#39; JSON说明： 开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），发票代码，发票号码，打印类型（0打印发票 1打印清单），是否显示打印设置窗口（0不显示 1显示） &nbsp;&nbsp; 打印调用示例1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传入参数: {&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;1&quot;,&quot;FPZL&quot;:&quot;0&quot;,&quot;FPDM&quot;:&quot;4400173130&quot;,&quot;FPHM&quot;:&quot;04138532&quot;,&quot;QDBZ&quot;:&quot;0&quot;,&quot;ISVISIBLE&quot;:&quot;0&quot;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp; :{&quot;Result&quot;:&quot;1&quot;,&quot;Message&quot;:&quot;&quot;} 调用方法二：采用OCX调用 COM名称：KPOCXDLL.KP &nbsp; functionSHKP(const Param1: WideString): WideString; safecall; 调用方法三：在 B/S架构中，JS写法 myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;Of_init&quot;,&quot;QYSH&quot;:&quot;税号&quot;,&quot;CERT&quot;:&quot;12345678&quot;,&quot;FJH&quot;:&quot;0&quot;}&#39;); myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;&#39;{&quot;LX&quot;:&quot;Of_Uninit&quot;}&#39;); myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;&#39;{&quot;LX&quot;:&quot;of_bw_init&quot;,&quot;JSPPASSWORD&quot;:&quot;&quot;,&quot;ZSPASSWORD&quot;:&quot;12345678&quot;}&#39; ); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;GetInfo&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;KP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;XML&quot;:&quot;XML并且经过base64编码&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;ZF&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;}&#39;)); alert(myCst.CallFun(&#39;SHKJKP.dll&#39;,&#39;SHKP&#39;,&#39;{&quot;LX&quot;:&quot;PrintFP&quot;,&quot;KPJLX&quot;:&quot;0&quot;,&quot;FPZL&quot;:&quot;41&quot;,&quot;FPDM&quot;:&quot;&quot;,&quot;FPHM&quot;:&quot;&quot;,&quot;QDBZ&quot;:&quot;0&quot;,&quot;ISVISIBLE&quot;:&quot;1&quot;}&#39;)); &nbsp; xml:说明： &lt;?xmlversion=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt; &lt;Config&gt; &nbsp; &lt;InvoiceList&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InvHead InvoiceNumber=&quot;单据号&quot; CustomerName=&quot;客户名称&quot; CustomerTaxCode=&quot;税号&quot; AddressAndPhone=&quot;地址&quot; BankAndAccount=&quot;客户银行账号&quot; JGCS=”1”SellerBankName=&quot;销方银行账号&quot; KHSJ=”客户手机”KHYJ=”客户邮件” SellerAdrrPhone=&quot;销方地址和电话&quot; SellerTaxCode=”销方税号”FPZL=”发票种类” InvoiceMemo=&quot;备注&quot; KPR=&quot;开票人&quot; SKR=&quot;收款人&quot; FHR=&quot;复核人&quot; FPHM=”红冲发票原发票号” CHFPH=&quot;信息表编号&quot; Amount=”整张发票不含税金额” TaxAmount=”整张发票税额” InTaxAmount=”整张发票价税合计” TaxRate=”税率” IsListing=”是否开具清单0不强制开清单 1强制开清单”JEFS=”正常票0 红冲票1” RowCount=”0”/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InvDetail&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DetailEntry ProductCode=&quot;产品代码&quot; EntryNumber=”行号，从1开始算起”ProductName=&quot;产品名称&quot; ProductModel=&quot;产品型号&quot; ProductUnit=&quot;产品单位&quot; TaxRate=&quot;税率&quot; Quantity=&quot;数量&quot; Price=”不含税价” HSDJ=”含税价” Amount=&quot;不含税金额&quot; TaxAmount=&quot;税额&quot; RowAttrib=”行性质0正常行 3被折扣行 4折扣行” ProductTypes=&quot;4001&quot; Flbm=&quot;分类编码&quot; Xsyh=&quot;税率优惠 0无优惠1有优惠&quot; Lslvbs=&quot;零税率标志&quot; Yhsm=&quot;优惠说明&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/InvDetail&gt; &nbsp; &lt;/InvoiceList &gt; &lt;/Config&gt; 如果是多张发票：那么就多个 InvoiceList节点，如果一张发票，多行明细，那么就多个 DetailEntry节点 &nbsp; 名称 说明 是否可以为空 备注 默认值 InvoiceNumber 单据号 否 &nbsp; &nbsp; CustomerName 客户名称 否 &nbsp; &nbsp; CustomerTaxCode 客户税号 是 按税务规定，开具给企业的发票必需有税号 &nbsp; AddressAndPhone 客户地址电话 是 &nbsp; &nbsp; BankAndAccount 客户银行账号 是 &nbsp; &nbsp; KHSJ 客户手机 是 &nbsp; &nbsp; KHYJ 客户邮件 是 &nbsp; &nbsp; SellerBankName 销方银行账号 否 &nbsp; &nbsp; SellerAdrrPhone 销方地址和电话 否 &nbsp; &nbsp; SellerTaxCode 销方税号 否 &nbsp; &nbsp; FPZL 发票种类 否 &nbsp; &nbsp; InvoiceMemo 备注 是 &nbsp; &nbsp; KPR 开票人 否 &nbsp; &nbsp; SKR 收款人 是 &nbsp; &nbsp; FHR 复核人 是 &nbsp; &nbsp; FPHM 红冲发票原发票号 是 当发票种类是普票、电票、卷票、运输发票并且JEFS=1时，必需传原发票号过来 &nbsp; CHFPH 红字信息表编码 是 当发票种类是专票并且JEFS=1时，必需传红字信息表编号 &nbsp; Amount 整张发票不含税金额 否 等于 明细行的 Amount 之和 &nbsp; TaxAmount 整张发票税额 否 等于 明细行的 TaxAmount 之和 &nbsp; InTaxAmount 整张发票价税合计 否 等于 Amount+ TaxAmount &nbsp; TaxRate 税率 是 可以是17，也可以是0.17，当明细行有多种税率时，必需是空 &nbsp; IsListing 是否强制开具清单 否 0 不进行强制，由系统自动处理，当超过8行明细时，系统自动出具清单。 1 进行强制转换成清单，强制转换后，没超过8行明细也会出具清单 0 JEFS 开具类型 否 0 正常发票 1 红字发票 0 RowCount 明细汇总行数 否 用固定值 0 0 明细字段说明 ProductCode 产品代码 是 &nbsp; &nbsp; EntryNumber 行号 否 从1开始算起 &nbsp; ProductName 产品名称 否 &nbsp; &nbsp; ProductModel 产品型号 是 &nbsp; &nbsp; ProductUnit 产品单位 是 &nbsp; &nbsp; TaxRate 税率 否 可以是17，也可以是0.17 &nbsp; Quantity 数量 是 当不需要打印数量时，传空 &nbsp; Price 不含税价 是 当不需要打印单价时，传空 &nbsp; HSDJ 含税价 是 当不需要打印单价时，传空 &nbsp; Amount 不含税金额 否 &nbsp; &nbsp; TaxAmount 税额 否 &nbsp; &nbsp; RowAttrib 行性质 否 正常行 :0 被折扣行 3 折扣行 4 &nbsp; ProductTypes 商品税目 是 4001代表是 商品销售 4001 Flbm 分类编码 否 &nbsp; &nbsp; Xsyh 税收优惠 否 无税收优惠0 有税收优惠1 &nbsp; Lslvbs 零税率标志 是 当税收优惠=1时 免税 1出口零税 0不征税 2 其它3，当税收优惠是0时，空 &nbsp; Yhsm 优惠说明 是 &nbsp; &nbsp; &nbsp; &nbsp; 注意：如果红字 带清单的，只需要传一行明细， 产品名称必需是 详见对应正数发票及清单 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/04/28/ad37570e8bd1f58ce1790eac2bff4351.html","headline":"航天，百旺组件开票调用说明","dateModified":"2018-04-28T00:00:00+08:00","datePublished":"2018-04-28T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/04/28/ad37570e8bd1f58ce1790eac2bff4351.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>航天，百旺组件开票调用说明</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <h1>调用方法一：（SHKJKP.dll）&nbsp;</h1>
  <p>32位</p>
  <p>functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKP.dll';</p>
  <p>64位平台</p>
  <p>functionSHKP(parameter:pansichar):pansichar;stdcall; external SHKJKPx64.dll';</p>
  <p>&nbsp;</p>
  <p>说明:不同的parameter功能传不同的值，下面为各功能的值。</p>
  <p><br></p>
  <p>相应文件可以在http://sh-gz.cn/下载</p>
  <p><br></p>
  <p>航天初始化：</p>
  <p>'{"LX":"Of_Uninit"}'</p>
  <p>'{"LX":"Of_init","QYSH":"企业税号","CERT":"12345678","FJH":"0"}'</p>
  <p>JSON说明：企业税号,证书密码,分机号</p>
  <p>&nbsp;</p>
  <p>百旺初始化</p>
  <p>'{"LX":"of_bw_init","URL":"https://skfp.tax.sh.gov.cn/acceptFramework/UniAcceptService","JSPPASSWORD":"","ZSPASSWORD":"12345678"}'</p>
  <p>JSON说明：税务局URL(参考百旺的参数设置),金税盘口令，证书口令</p>
  <p>&nbsp; 初始化调用示例1: 传入参数:{"LX":"of_bw_init","JSPPASSWORD":"66666666","ZSPASSWORD":"12345678"}</p>
  <p>&nbsp; 初始化返回值:&nbsp; 成功&nbsp;{"Result":"1","Message":""}</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 失败&nbsp;{"Result":"0","Message":"失败说明"}</p>
  <p>&nbsp;</p>
  <p>获取发票信息</p>
  <p>'{"LX":"GetInfo","KPJLX":"0","FPZL":"41"}'</p>
  <p>&nbsp;</p>
  <p>JSON说明：</p>
  <p>开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票）</p>
  <p>&nbsp;调用示例1: 查询参数:{"LX":"GetInfo","KPJLX":"1","FPZL":"0"}</p>
  <p>返回{"Result":"1","FPDM":"4400173130","FPHM":"4094639","COUNT":"79","Message":""}</p>
  <p>&nbsp;</p>
  <p>开票</p>
  <p>'{"LX":"KP","KPJLX":"0","FPZL":"41","TEST":"1","XML":"XML并且经过base64编码"}'</p>
  <p>&nbsp;</p>
  <p>JSON说明：</p>
  <p>开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），TEST 是否检验数据1不开票仅做数据检查、0直接开票，KP的xml数据</p>
  <p>&nbsp;开票调用示例1: 传入参数:</p>
  <p>{"LX":"KP","KPJLX":"1","FPZL":"0","XML":"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KICA8SW52b2ljZUxpc3Q+DQogICAgICAgIDxJbnZIZWFkIEludm9pY2VOdW1iZXI9IjQ5ODQwMzEwNTIwNjEzMTIiIEN1c3RvbWVyTmFtZT0iyc+6o760zamyzdL7udzA7dPQz965q8u+IiBDdXN0b21lclRheENvZGU9IjkxMzEwMjMwTUExSlk0TFE5UCIgQWRkcmVzc0FuZFBob25lPSKz58P3x/izx8fF1fLQ48m9wrc4usUztLHSu8f4MDIxLTgwMzkyNDE3IiBCYW5rQW5kQWNjb3VudD0i1tC5+sWp0rXS+NDQu8a2ydan0NAwMzgzMDEwMDA0MDA0ODM2MyIgSkdDUz0iMSIgU2VsbGVyQmFua05hbWU9ItXQyczS+NDQucm33dPQz965q8u+xP6yqL2tsbHWp9DQNTc0OTA2MjUzNjEwMjAxIiBLSFNKPSIxMzY4MTIzNDU2NzgiIEtIWUo9IjMyOTEwNDQ4NDZAcXEuY29tIiBTZWxsZXJBZHJyUGhvbmU9IrnjtqvKobnj1t3K0MzsutPH+NbQyb2087XAMTAzNbrF06+4u8nMzvG088/DN8KlMDIwMTIzNDU2NzgiIFNlbGxlclRheENvZGU9IjkxNDQwMTAxTUE1OUxDSzE3MCIgRlBaTD0iMCIgSW52b2ljZU1lbW89IrG416IxMjMiIEtQUj0iwLXQocflIiBTS1I9Ire2zsC9+iIgRkhSPSK3ts7AvfoiIEZQSE09IiIgQ0hGUEg9IiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgSW5UYXhBbW91bnQ9IjEwNiIgVGF4UmF0ZT0iNiIgSXNMaXN0aW5nPSIwIiBKRUZTPSIwIiBSb3dDb3VudD0iMCIvPg0KICAgICAgICA8SW52RGV0YWlsPg0KICAgICAgICAgICAgPERldGFpbEVudHJ5IFByb2R1Y3RDb2RlPSIzMDQwMjAxMDMiIEVudHJ5TnVtYmVyPSIxIiBQcm9kdWN0TmFtZT0ivLzK9bf+zvG30SIgUHJvZHVjdE1vZGVsPSLV+8zXIiBQcm9kdWN0VW5pdD0izNciIFRheFJhdGU9IjYiIFF1YW50aXR5PSIxIiBQcmljZT0iMTAwIiBIU0RKPSIxMDYiIEFtb3VudD0iMTAwIiBUYXhBbW91bnQ9IjYiIFJvd0F0dHJpYj0iMCIgUHJvZHVjdFR5cGVzPSI0MDAxIiBGbGJtPSIzMDQwMjAxMDMwMDAwMDAwMDAwIiBYc3loPSIwIiBMc2x2YnM9IiIgWWhzbT0iIi8+DQogICAgICAgIDwvSW52RGV0YWlsPg0KICA8L0ludm9pY2VMaXN0ID4NCjwvQ29uZmlnPg0K"}</p>
  <p>&nbsp;</p>
  <p>&nbsp;开票返回值: </p>
  <p>{"Result":"1","XML":"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iR0IyMzEyIj8+DQo8Q29uZmlnPg0KCTxJbnZvaWNlTGlzdD4NCgkJPEludkhlYWQgSW52b2ljZU51bWJlcj0iNDk4NDAzMTA1MjA2MTMxMiIgQ3VzdG9tZXJOYW1lPSLJz7qjvrTNqbLN0vu53MDt09DP3rmry74iIEN1c3RvbWVyVGF4Q29kZT0iOTEzMTAyMzBNQTFKWTRMUTlQIiBBZGRyZXNzQW5kUGhvbmU9IrPnw/fH+LPHx8XV8tDjyb3Ctzi6xTO0sdK7x/gwMjEtODAzOTI0MTciIEJhbmtBbmRBY2NvdW50PSLW0Ln6xanStdL40NC7xrbJ1qfQ0DAzODMwMTAwMDQwMDQ4MzYzIiBKR0NTPSIxIiBTZWxsZXJCYW5rTmFtZT0i1dDJzNL40NC5ybfd09DP3rmry77E/rKova2xsdan0NA1NzQ5MDYyNTM2MTAyMDEiIEtIU0o9IjEzNjgxMjM0NTY3OCIgS0hZSj0iMzI5MTA0NDg0NkBxcS5jb20iIFNlbGxlckFkcnJQaG9uZT0iueO2q8qhuePW3crQzOy608f41tDJvbTztcAxMDM1usXTr7i7yczO8bTzz8M3wqUwMjAxMjM0NTY3OCIgU2VsbGVyVGF4Q29kZT0iOTE0NDAxMDFNQTU5TENLMTcwIiBGUFpMPSIwIiBJbnZvaWNlTWVtbz0isbjXojEyMyIgS1BSPSLAtdChx+UiIFNLUj0it7bOwL36IiBGSFI9Ire2zsC9+iIgRlBITT0iIiBDSEZQSD0iIiBBbW91bnQ9IjEwMCIgVGF4QW1vdW50PSI2IiBJblRheEFtb3VudD0iMTA2IiBUYXhSYXRlPSI2IiBJc0xpc3Rpbmc9IjAiIEpFRlM9IjAiIFJvd0NvdW50PSIwIiBSRVRDT0RFPSIwMDAwMDAzMiIgUkVUTVNHPSLLsL/YyeixuNC0t6LGscP3z7jKsdLss6MgIERpc2tFcnI6MDlkMTFmIi8+DQoJCTxJbnZEZXRhaWw+DQoJCQk8RGV0YWlsRW50cnkgUHJvZHVjdENvZGU9IjMwNDAyMDEwMyIgRW50cnlOdW1iZXI9IjEiIFByb2R1Y3ROYW1lPSK8vMr1t/7O8bfRIiBQcm9kdWN0TW9kZWw9ItX7zNciIFByb2R1Y3RVbml0PSLM1yIgVGF4UmF0ZT0iNiIgUXVhbnRpdHk9IjEiIFByaWNlPSIxMDAiIEhTREo9IjEwNiIgQW1vdW50PSIxMDAiIFRheEFtb3VudD0iNiIgUm93QXR0cmliPSIwIiBQcm9kdWN0VHlwZXM9IjQwMDEiIEZsYm09IjMwNDAyMDEwMzAwMDAwMDAwMDAiIFhzeWg9IjAiIExzbHZicz0iIiBZaHNtPSIiLz4NCgkJPC9JbnZEZXRhaWw+DQoJPC9JbnZvaWNlTGlzdD4NCjwvQ29uZmlnPg0K"}</p>
  <p>&nbsp;</p>
  <p>作废</p>
  <p>'{"LX":"ZF","KPJLX":"0","FPZL":"41","FPDM":"","FPHM":""}'</p>
  <p>JSON说明：</p>
  <p>开票机类型（0航天1百旺）、发票种类 （0 专票,2 普票,51 电票,41卷式发票 12 机动车发票）、发票代码，发票号码</p>
  <p>&nbsp; 作废调用 示例1:</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp; 传入参数{"LX":"ZF","KPJLX":"1","FPZL":"0","FPDM":"4400173130","FPHM":"04138547"}</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp;&nbsp;{"Result":"0","Message":"FPZF-ZF-不能作废发票或开具红字发票，原发票已开作废发票"}</p>
  <p>打印发票</p>
  <p>'{"LX":"PrintFP","KPJLX":"0","FPZL":"41","FPDM":"","FPHM":"","QDBZ":"","ISVISIBLE":""}'</p>
  <p>JSON说明：</p>
  <p>开票机类型（0航天1百旺）、发票种类（0 专票,2 普票,51 电票,41卷式发票 12 机动车发票），发票代码，发票号码，打印类型（0打印发票 1打印清单），是否显示打印设置窗口（0不显示 1显示）</p>
  <p>&nbsp;&nbsp; 打印调用示例1: </p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 传入参数: </p>
  <p>{"LX":"PrintFP","KPJLX":"1","FPZL":"0","FPDM":"4400173130","FPHM":"04138532","QDBZ":"0","ISVISIBLE":"0"}</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回值&nbsp; :{"Result":"1","Message":""}</p>
  <h1>调用方法二：采用OCX调用</h1>
  <p>COM名称：<span style="color:#464646;background:#BCD3E5;">KPOCXDLL.KP</span></p>
  <p>&nbsp;</p>
  <p>functionSHKP(const Param1: WideString): WideString; safecall;</p>
  <h1>调用方法三：在 B/S架构中，JS写法</h1>
  <p>myCst.CallFun('SHKJKP.dll','SHKP','{"LX":"Of_init","QYSH":"税号","CERT":"12345678","FJH":"0"}');</p>
  <p>myCst.CallFun('SHKJKP.dll','SHKP',''{"LX":"Of_Uninit"}');</p>
  <p>myCst.CallFun('SHKJKP.dll','SHKP',''{"LX":"of_bw_init","JSPPASSWORD":"","ZSPASSWORD":"12345678"}'</p>
  <p>);</p>
  <p>alert(myCst.CallFun('SHKJKP.dll','SHKP','{"LX":"GetInfo","KPJLX":"0","FPZL":"41"}'));</p>
  <p>alert(myCst.CallFun('SHKJKP.dll','SHKP','{"LX":"KP","KPJLX":"0","FPZL":"41","XML":"XML并且经过base64编码"}'));</p>
  <p>alert(myCst.CallFun('SHKJKP.dll','SHKP','{"LX":"ZF","KPJLX":"0","FPZL":"41","FPDM":"","FPHM":""}'));</p>
  <p>alert(myCst.CallFun('SHKJKP.dll','SHKP','{"LX":"PrintFP","KPJLX":"0","FPZL":"41","FPDM":"","FPHM":"","QDBZ":"0","ISVISIBLE":"1"}'));</p>
  <p>&nbsp;</p>
  <p>xml:说明：</p>
  <p><span style="color:#A31515;">&lt;?xmlversion="1.0" encoding="GB2312"?&gt;</span></p>
  <p><span style="color:#A31515;">&lt;Config&gt;</span></p>
  <p><span style="color:#A31515;">&nbsp; &lt;</span><span style="color:#881280;">InvoiceList</span><span style="color:#A31515;">&gt;</span></p>
  <p><span style="color:#A31515;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="color:#881280;">InvHead </span><span style="color:#994500;">InvoiceNumber</span><span style="color:#A31515;">="</span><span style="color:#A31515;">单据号" </span><span style="color:#994500;">CustomerName</span><span style="color:#A31515;">="</span><span style="color:#A31515;">客户名称" </span><span style="color:#994500;">CustomerTaxCode</span><span style="color:#A31515;">="</span><span style="color:#A31515;">税号" </span><span style="color:#994500;">AddressAndPhone</span><span style="color:#A31515;">="</span><span style="color:#A31515;">地址" </span><span style="color:#994500;">BankAndAccount</span><span style="color:#A31515;">="</span><span style="color:#A31515;">客户银行账号" </span><span style="color:#A31515;background:#FFFFFF;">JGCS=</span><span style="color:#A31515;">”</span><span style="color:#A31515;">1</span><span style="color:#A31515;">”</span><span style="color:#994500;">SellerBankName=</span><span style="color:#A31515;">"</span><span style="color:#A31515;">销方银行账号" </span><span style="color:#994500;">KHSJ=”</span><span style="color:#994500;">客户手机”</span><span style="color:#994500;">KHYJ=”</span><span style="color:#994500;">客户邮件” SellerAdrrPhone=</span><span style="color:#A31515;">"</span><span style="color:#A31515;">销方地址和电话" </span><span style="color:#994500;">SellerTaxCode=”</span><span style="color:#994500;">销方税号”</span><span style="color:#994500;">FPZL=”</span><span style="color:#994500;">发票种类” InvoiceMemo</span><span style="color:#A31515;">="</span><span style="color:#A31515;">备注" </span><span style="color:#994500;">KPR</span><span style="color:#A31515;">="</span><span style="color:#A31515;">开票人" SKR="</span>收款人" FHR="复核人" <span style="color:#994500;">FPHM=”</span><span style="color:#994500;">红冲发票原发票号” </span><span style="color:#A31515;">CHFPH="</span><span style="color:#A31515;">信息表编号" </span><span style="color:#994500;">Amount=”</span><span style="color:#994500;">整张发票不含税金额” TaxAmount=”</span>整张发票税额” InTaxAmount=”整张发票价税合计” TaxRate=”税率” IsListing=”是否开具清单0不强制开清单 1强制开清单”JEFS=”正常票0 红冲票1” RowCount<span style="color:#A31515;">=”0”/&gt;</span></p>
  <p><span style="color:#A31515;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="color:#881280;">InvDetail</span><span style="color:#A31515;">&gt;</span></p>
  <p><span style="color:#A31515;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="color:#881280;">DetailEntry </span><span style="color:#994500;">ProductCode</span><span style="color:#A31515;">="</span><span style="color:#A31515;">产品代码" </span><span style="color:#994500;">EntryNumber=”</span><span style="color:#994500;">行号，从1</span>开始算起”<span style="color:#994500;">ProductName</span><span style="color:#A31515;">="</span><span style="color:#A31515;">产品名称" </span><span style="color:#994500;">ProductModel</span><span style="color:#A31515;">="</span><span style="color:#A31515;">产品型号" </span><span style="color:#994500;">ProductUnit</span><span style="color:#A31515;">="</span><span style="color:#A31515;">产品单位" </span><span style="color:#994500;">TaxRate</span><span style="color:#A31515;">="</span><span style="color:#A31515;">税率" </span><span style="color:#994500;">Quantity</span><span style="color:#A31515;">="</span><span style="color:#A31515;">数量" </span><span style="color:#994500;">Price=”</span><span style="color:#994500;">不含税价” HSDJ=”</span>含税价” Amount<span style="color:#A31515;">="</span><span style="color:#A31515;">不含税金额" </span><span style="color:#994500;">TaxAmount="</span><span style="color:#994500;">税额" RowAttrib=”</span>行性质0正常行 3被折扣行 4折扣行” <span style="color:#994500;">ProductTypes</span><span style="color:#994500;">="</span><span style="color:#994500;">4001</span><span style="color:#994500;">" Flbm="</span><span style="color:#994500;">分类编码" Xsyh="</span>税率优惠 0无优惠1有优惠" Lslvbs="零税率标志" Yhsm="优惠说明"/&gt;</p>
  <p><span style="color:#A31515;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="color:#881280;">InvDetail</span><span style="color:#A31515;">&gt;</span></p>
  <p><span style="color:#A31515;">&nbsp; &lt;/</span><span style="color:#881280;">InvoiceList</span><span style="color:#A31515;"> &gt;</span></p>
  <p><span style="color:#A31515;">&lt;/Config&gt;</span></p>
  <p><span style="color:#A31515;">如果是多张发票：那么就多个 </span><span style="color:#881280;">InvoiceList</span><span style="color:#A31515;">节点，如果一张发票，多行明细，那么就多个 </span><span style="color:#881280;">DetailEntry</span><span style="color:#A31515;">节点</span></p>
  <p><span style="color:#A31515;">&nbsp;</span></p>
  <table border="1" cellspacing="0" cellpadding="0">
   <tbody>
    <tr>
     <td valign="top"><p align="center">名称</p></td> 
     <td valign="top"><p align="center">说明</p></td> 
     <td valign="top"><p align="center">是否可以为空</p></td> 
     <td valign="top"><p align="center">备注</p></td> 
     <td valign="top"><p align="center">默认值</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">InvoiceNumber</p></td> 
     <td valign="top"><p>单据号</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">CustomerName</p></td> 
     <td valign="top"><p>客户名称</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">CustomerTaxCode</p></td> 
     <td valign="top"><p>客户税号</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>按税务规定，开具给企业的发票必需有税号</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">AddressAndPhone</p></td> 
     <td valign="top"><p>客户地址电话</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">BankAndAccount</p></td> 
     <td valign="top"><p>客户银行账号</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">KHSJ</p></td> 
     <td valign="top"><p>客户手机</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">KHYJ</p></td> 
     <td valign="top"><p>客户邮件</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">SellerBankName</p></td> 
     <td valign="top"><p>销方银行账号</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">SellerAdrrPhone</p></td> 
     <td valign="top"><p>销方地址和电话</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">SellerTaxCode</p></td> 
     <td valign="top"><p>销方税号</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">FPZL</p></td> 
     <td valign="top"><p>发票种类</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">InvoiceMemo</p></td> 
     <td valign="top"><p>备注</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">KPR</p></td> 
     <td valign="top"><p>开票人</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">SKR</p></td> 
     <td valign="top"><p>收款人</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">FHR</p></td> 
     <td valign="top"><p>复核人</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">FPHM</p></td> 
     <td valign="top"><p>红冲发票原发票号</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>当发票种类是普票、电票、卷票、运输发票并且JEFS=1时，必需传原发票号过来</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">CHFPH</p></td> 
     <td valign="top"><p>红字信息表编码</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>当发票种类是专票并且JEFS=1时，必需传红字信息表编号</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Amount</p></td> 
     <td valign="top"><p>整张发票不含税金额</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>等于 明细行的 <span style="color:#994500;">Amount </span><span style="color:#994500;">之和</span></p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">TaxAmount</p></td> 
     <td valign="top"><p>整张发票税额</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>等于 明细行的 <span style="color:#994500;">TaxAmount </span><span style="color:#994500;">之和</span></p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">InTaxAmount</p></td> 
     <td valign="top"><p>整张发票价税合计</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>等于 Amount+ TaxAmount</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">TaxRate</p></td> 
     <td valign="top"><p>税率</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>可以是17，也可以是0.17，当明细行有多种税率时，必需是空</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">IsListing</p></td> 
     <td valign="top"><p>是否强制开具清单</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>0 不进行强制，由系统自动处理，当超过8行明细时，系统自动出具清单。</p> <p>1 进行强制转换成清单，强制转换后，没超过8行明细也会出具清单</p></td> 
     <td valign="top"><p>0</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">JEFS</p></td> 
     <td valign="top"><p>开具类型</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>0 正常发票 1 红字发票</p></td> 
     <td valign="top"><p>0</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">RowCount</p></td> 
     <td valign="top"><p>明细汇总行数</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p><span style="background:#FFFF00;">用固定值 0</span></p></td> 
     <td valign="top"><p>0</p></td> 
    </tr>
    <tr>
     <td colspan="5" valign="top"><p align="left">明细字段说明</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">ProductCode</p></td> 
     <td valign="top"><p>产品代码</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">EntryNumber</p></td> 
     <td valign="top"><p>行号</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>从1开始算起</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">ProductName</p></td> 
     <td valign="top"><p>产品名称</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">ProductModel</p></td> 
     <td valign="top"><p>产品型号</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">ProductUnit</p></td> 
     <td valign="top"><p>产品单位</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">TaxRate</p></td> 
     <td valign="top"><p>税率</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>可以是17，也可以是0.17</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Quantity</p></td> 
     <td valign="top"><p>数量</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>当不需要打印数量时，传空</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Price</p></td> 
     <td valign="top"><p>不含税价</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>当不需要打印单价时，传空</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">HSDJ</p></td> 
     <td valign="top"><p>含税价</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>当不需要打印单价时，传空</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Amount</p></td> 
     <td valign="top"><p>不含税金额</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">TaxAmount</p></td> 
     <td valign="top"><p>税额</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">RowAttrib</p></td> 
     <td valign="top"><p>行性质</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>正常行 :0 被折扣行 3 折扣行 4</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">ProductTypes</p></td> 
     <td valign="top"><p>商品税目</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>4001代表是 商品销售</p></td> 
     <td valign="top"><p>4001</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Flbm</p></td> 
     <td valign="top"><p>分类编码</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Xsyh</p></td> 
     <td valign="top"><p>税收优惠</p></td> 
     <td valign="top"><p>否</p></td> 
     <td valign="top"><p>无税收优惠0 有税收优惠1</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Lslvbs</p></td> 
     <td valign="top"><p>零税率标志</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>当税收优惠=1时 免税 1出口零税 0不征税 2 其它3，当税收优惠是0时，空</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
    <tr>
     <td valign="top"><p align="left">Yhsm</p></td> 
     <td valign="top"><p>优惠说明</p></td> 
     <td valign="top"><p>是</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
     <td valign="top"><p>&nbsp;</p></td> 
    </tr>
   </tbody>
  </table>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>注意：如果红字 带清单的，只需要传一行明细， 产品名称必需是 <span style="color:#A31515;">详见对应正数发票及清单</span></p>
  <p><br></p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/f805122102/article/details/80108194,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/f805122102/article/details/80108194,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
