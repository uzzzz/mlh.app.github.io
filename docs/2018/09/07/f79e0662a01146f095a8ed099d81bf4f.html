<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>使用Nethereum库的以太坊.NET、C#开发示例 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="使用Nethereum库的以太坊.NET、C#开发示例" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="这是一篇文章的早期版本，旨在帮助那些对以太坊区块链平台有基本了解的开发人员，如果想学习如何使用Nethereum .NET库对Ethereum平台进行编程。 我以后会在这篇文章中添加更多内容，但就目前而言，正在使用它发布.NET 10+的系列C＃示例，介绍如何使用Nethereum库执行针对以太坊区块链平台的最常见任务。 最常见任务列表包括以下内容： 1.获取协议版本 2.获取最大块数 3.获取帐户余额 4.发送以太 5.等待交易收据 6.在区块链中扫描块 7.列出个人账户（及其余额） 8.在区块链中扫描交易 9.与现有（已部署）合同互动 10.用事件和现有（已部署）合约交互 11.获取所有活动更改 12.获取合约金额历史 这里是c#的主文件： using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading; using System.Threading.Tasks; using Nethereum.Hex.HexTypes; using Nethereum.Web3; namespace MWH.MyNethereum.QuickRef { static public class TaskExamples { const int UNLOCK_TIMEOUT = 2 * 60; // 2 minutes (arbitrary) const int SLEEP_TIME = 5 * 1000; // 5 seconds (arbitrary) const int MAX_TIMEOUT = 2 * 60 * 1000; // 2 minutes (arbirtrary) // These static public variables do not represent a recommended pattern static public string LastProtocolVersion = &quot;&quot;; static public string LastTxHash = &quot;&quot;; static public Nethereum.RPC.Eth.DTOs.TransactionReceipt LastTxReceipt = null; static public HexBigInteger LastMaxBlockNumber = new HexBigInteger(0); static public async Task GetProtocolVersionExample(Web3 web3) { Console.WriteLine(&quot;GetProtocolVersionExample:&quot;); var protocolVersion = await web3.Eth.ProtocolVersion.SendRequestAsync(); Console.WriteLine(&quot;protocolVersion:\t&quot; + protocolVersion.ToString()); LastProtocolVersion = protocolVersion; } static public async Task GetMaxBlockExample(Web3 web3) { Console.WriteLine(&quot;GetMaxBlockExample:&quot;); var maxBlockNumber = await web3.Eth.Blocks.GetBlockNumber.SendRequestAsync(); Console.WriteLine(&quot;maxBlockNumber:\t&quot; + maxBlockNumber.Value.ToString()); LastMaxBlockNumber = maxBlockNumber; } static public async Task ScanBlocksExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber) { Console.WriteLine(&quot;ScanBlocksExample:&quot;); long txTotalCount = 0; for (ulong blockNumber = startBlockNumber; blockNumber &lt;= endBlockNumber; blockNumber++) { var blockParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockParameter); var trans = block.Transactions; int txCount = trans.Length; txTotalCount += txCount; if (blockNumber % 1000 == 0) Console.Write(&quot;.&quot;); if (blockNumber % 10000 == 0) { DateTime blockDateTime = Helpers.UnixTimeStampToDateTime((double)block.Timestamp.Value); Console.WriteLine(blockNumber.ToString() + &quot; &quot; + txTotalCount.ToString() + &quot; &quot; + blockDateTime.ToString()); } } Console.WriteLine(); } static public async Task ScanTxExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber) { Console.WriteLine(&quot;ScanTxExample:&quot;); long txTotalCount = 0; for (ulong blockNumber = startBlockNumber; blockNumber &lt;= endBlockNumber; blockNumber++) { var blockParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockParameter); var trans = block.Transactions; int txCount = trans.Length; txTotalCount += txCount; foreach (var tx in trans) { try { var bn = tx.BlockNumber.Value; var th = tx.TransactionHash; var ti = tx.TransactionIndex.Value; var rpt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(th); var status = rpt.Status.Value; var nc = tx.Nonce.Value; var from = tx.From; Console.WriteLine(th.ToString() + &quot; &quot; + ti.ToString() + &quot; &quot; + from.ToString() + &quot; &quot; + status.ToString()); var to = tx.To; if (to == null) to = &quot;to:NULL&quot;; var v = tx.Value.Value; var g = tx.Gas.Value; var gp = tx.GasPrice.Value; Console.WriteLine(th.ToString() + &quot; &quot; + ti.ToString() + &quot; &quot; + nc.ToString() + &quot; &quot; + from.ToString() + &quot; &quot; + to.ToString() + &quot; &quot; + v.ToString() + &quot; &quot; + g.ToString() + &quot; &quot; + gp.ToString()); } catch (Exception ex) { Console.WriteLine(&quot;ScanTxExample.Tx:\t&quot; + ex.ToString()); if (ex.InnerException != null) Console.WriteLine(&quot;ScanTxExample.Tx:\t&quot; + ex.InnerException.ToString()); } } Console.WriteLine(); } } static public async Task GetAccountBalanceExample(Web3 web3, string accountAddress) { Console.WriteLine(&quot;GetAccountBalanceExample:&quot;); var balanceWei = await web3.Eth.GetBalance.SendRequestAsync(accountAddress); var balanceEther = Web3.Convert.FromWei(balanceWei.Value); Console.WriteLine(&quot;accountAddress:\t&quot; + accountAddress.ToString()); Console.WriteLine(&quot;balanceEther:\t&quot; + balanceEther.ToString()); } static public async Task ListPersonalAccountsExample(Web3 web3) { Console.WriteLine(&quot;ListPersonalAccountsExample:&quot;); var accounts = await web3.Personal.ListAccounts.SendRequestAsync(); foreach (var account in accounts) { var balanceWei = await web3.Eth.GetBalance.SendRequestAsync(account); var balanceEther = Web3.Convert.FromWei(balanceWei.Value); Console.WriteLine(&quot;account:\t&quot; + account + &quot; balanceEther:\t&quot; + balanceEther.ToString()); } } static public async Task SendEtherExample(Web3 web3, string fromAddress, string fromPassword, string toAddress, long amountWei) { Console.WriteLine(&quot;SendEtherExample:&quot;); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var sendTxHash = await web3.Eth.TransactionManager.SendTransactionAsync(fromAddress, toAddress, new HexBigInteger(amountWei)); Console.WriteLine(&quot;fromAddress:\t&quot; + fromAddress.ToString()); Console.WriteLine(&quot;toAddress:\t&quot; + toAddress.ToString()); Console.WriteLine(&quot;amountWei:\t&quot; + amountWei.ToString()); Console.WriteLine(&quot;sendTxHash:\t&quot; + sendTxHash.ToString()); LastTxHash = sendTxHash; } static public async Task WaitForTxReceiptExample(Web3 web3, string txHash) { Console.WriteLine(&quot;WaitForTxReceiptExample:&quot;); int timeoutCount = 0; var txReceipt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash); while (txReceipt == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount &quot; + timeoutCount.ToString()); LastTxReceipt = txReceipt; } static public async Task InteractWithExistingContractExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;InteractWithExistingContractExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var setMessageFunction = contract.GetFunction(&quot;setMsg&quot;); var getMessageFunction = contract.GetFunction(&quot;getMsg&quot;); string nowTimestamp = DateTime.UtcNow.ToString() + &quot; UTC&quot;; Console.WriteLine(&quot;now:\t&quot; + nowTimestamp); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var txHash1 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 1, &quot;Hello World&quot;); Console.WriteLine(&quot;txHash1:\t&quot; + txHash1.ToString()); var txHash2 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 2, nowTimestamp); Console.WriteLine(&quot;txHash2:\t&quot; + txHash2.ToString()); var txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); int timeoutCount = 0; while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount:\t&quot; + timeoutCount.ToString()); var txReceipt3 = await setMessageFunction.SendTransactionAndWaitForReceiptAsync(fromAddress, new HexBigInteger(900000), null, null, 2, nowTimestamp + &quot; Wait&quot;); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.TransactionHash.ToString()); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.CumulativeGasUsed.Value.ToString()); var getResult1 = await getMessageFunction.CallAsync&lt;string&gt;(1); Console.WriteLine(&quot;getResult1:\t&quot; + getResult1.ToString()); var getResult2 = await getMessageFunction.CallAsync&lt;string&gt;(2); Console.WriteLine(&quot;getResult2:\t&quot; + getResult2.ToString()); } static public async Task InteractWithExistingContractWithEventsExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;InteractWithExistingContractWithEventsExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var setMessageFunction = contract.GetFunction(&quot;setMsg&quot;); var getMessageFunction = contract.GetFunction(&quot;getMsg&quot;); var multipliedEvent = contract.GetEvent(&quot;MultipliedEvent&quot;); var newMessageEvent = contract.GetEvent(&quot;NewMessageEvent&quot;); var filterAllMultipliedEvent = await multipliedEvent.CreateFilterAsync(); var filterAllNewMessageEvent = await newMessageEvent.CreateFilterAsync(); string nowTimestamp = DateTime.UtcNow.ToString() + &quot; UTC&quot;; Console.WriteLine(&quot;now:\t&quot; + nowTimestamp); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var txHash1 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 1, &quot;Hello World&quot;); Console.WriteLine(&quot;txHash1:\t&quot; + txHash1.ToString()); var txHash2 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 2, nowTimestamp); Console.WriteLine(&quot;txHash2:\t&quot; + txHash2.ToString()); var txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); int timeoutCount = 0; while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount:\t&quot; + timeoutCount.ToString()); var txReceipt3 = await setMessageFunction.SendTransactionAndWaitForReceiptAsync(fromAddress, new HexBigInteger(900000), null, null, 2, nowTimestamp + &quot; Wait&quot;); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.TransactionHash.ToString()); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.CumulativeGasUsed.Value.ToString()); var getResult1 = await getMessageFunction.CallAsync&lt;string&gt;(1); Console.WriteLine(&quot;getResult1:\t&quot; + getResult1.ToString()); var getResult2 = await getMessageFunction.CallAsync&lt;string&gt;(2); Console.WriteLine(&quot;getResult2:\t&quot; + getResult2.ToString()); var logMultipliedEvents = await multipliedEvent.GetFilterChanges&lt;FunctionOutputHelpers.MultipliedEventArgs&gt;(filterAllMultipliedEvent); foreach (var mea in logMultipliedEvents) { Console.WriteLine(&quot;multipliedEvent:\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.oldProduct.ToString() + &quot; &quot; + mea.Event.value.ToString() + &quot; &quot; + mea.Event.newProduct.ToString()); } var logNewMessageEvents = await newMessageEvent.GetFilterChanges&lt;FunctionOutputHelpers.NewMessageEventArgs&gt;(filterAllNewMessageEvent); foreach (var mea in logNewMessageEvents) { Console.WriteLine(&quot;newMessageEvent:\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.ind.ToString() + &quot; &quot; + mea.Event.msg.ToString()); } } static public async Task GetAllChangesExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;GetAllChangesExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var newMessageEvent = contract.GetEvent(&quot;NewMessageEvent&quot;); var filterAllNewMessageEvent = await newMessageEvent.CreateFilterAsync(fromAddress); var logNewMessageEvents = await newMessageEvent.GetAllChanges&lt;FunctionOutputHelpers.NewMessageEventArgs&gt;(filterAllNewMessageEvent); foreach (var mea in logNewMessageEvents) { Console.WriteLine(&quot;newMessageEvent:\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.ind.ToString() + &quot; &quot; + mea.Event.msg.ToString()); } } static public async Task GetContractValuesHistoryUniqueOffsetValueExample(Web3 web3, string contractAddress, HexBigInteger recentBlockNumber, ulong numberBlocks, int offset) { Console.WriteLine(&quot;GetContractValuesHistoryUniqueOffsetValueExample:&quot;); string previousValue = &quot;&quot;; for (ulong blockNumber = (ulong)recentBlockNumber.Value; blockNumber &gt; (ulong)recentBlockNumber.Value - numberBlocks; blockNumber--) { var blockNumberParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var valueAtOffset = await web3.Eth.GetStorageAt.SendRequestAsync(contractAddress, new HexBigInteger(offset), blockNumberParameter); if (valueAtOffset != previousValue) { var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockNumberParameter); DateTime blockDateTime = Helpers.UnixTimeStampToDateTime((double)block.Timestamp.Value); Console.WriteLine(&quot;blockDateTime:\t&quot; + blockDateTime.ToString()); for (int storageOffset = 0; storageOffset &lt; offset+2; storageOffset++) { var valueAt = await web3.Eth.GetStorageAt.SendRequestAsync(contractAddress, new HexBigInteger(storageOffset), blockNumberParameter); Console.WriteLine(&quot;value:\t&quot; + blockNumber.ToString() + &quot; &quot; + storageOffset.ToString() + &quot; &quot; + valueAt + &quot; &quot; + Helpers.ConvertHex(valueAt.Substring(2))); } previousValue = valueAtOffset; } } } } } 以下是一些支持文件： FunctionOutputHelpers.cs using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; using Nethereum.Web3; using Nethereum.ABI.FunctionEncoding.Attributes; namespace MWH.MyNethereum.QuickRef { static public class FunctionOutputHelpers { // event MultipliedEvent( // address indexed sender, // int oldProduct, // int value, // int newProduct // ); [FunctionOutput] public class MultipliedEventArgs { [Parameter(&quot;address&quot;, &quot;sender&quot;, 1, true)] public string sender { get; set; } [Parameter(&quot;int&quot;, &quot;oldProduct&quot;, 2, false)] public int oldProduct { get; set; } [Parameter(&quot;int&quot;, &quot;value&quot;, 3, false)] public int value { get; set; } [Parameter(&quot;int&quot;, &quot;newProduct&quot;, 4, false)] public int newProduct { get; set; } } //event NewMessageEvent( // address indexed sender, // uint256 indexed ind, // string msg //); [FunctionOutput] public class NewMessageEventArgs { [Parameter(&quot;address&quot;, &quot;sender&quot;, 1, true)] public string sender { get; set; } [Parameter(&quot;uint256&quot;, &quot;ind&quot;, 2, true)] public int ind { get; set; } [Parameter(&quot;string&quot;, &quot;msg&quot;, 3, false)] public string msg { get; set; } } } } Helpers.cs using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace MWH.MyNethereum.QuickRef { static public class Helpers { public static string ConvertHex(String hexString) { try { string ascii = string.Empty; for (int i = 0; i &lt; hexString.Length; i += 2) { String hs = string.Empty; hs = hexString.Substring(i, 2); uint decval = System.Convert.ToUInt32(hs, 16); char character = System.Convert.ToChar(decval); ascii += character; } return ascii; } catch (Exception ex) { Console.WriteLine(ex.Message); } return string.Empty; } public static DateTime UnixTimeStampToDateTime(double unixTimeStamp) { // Unix timestamp is seconds past epoch System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc); dtDateTime = dtDateTime.AddSeconds(unixTimeStamp); // .ToLocalTime(); return dtDateTime; } public static DateTime JavaTimeStampToDateTime(double javaTimeStamp) { // Java timestamp is milliseconds past epoch System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc); dtDateTime = dtDateTime.AddMilliseconds(javaTimeStamp); // .ToLocalTime(); return dtDateTime; } } } 以下是用于实施这些示例时使用的以太坊合约的Solidity代码： Test3.sol pragma solidity 0.4.19; contract Test3 { int public _product; string[5] _msgs; event MultipliedEvent( address indexed sender, int oldProduct, int value, int newProduct ); event NewMessageEvent( address indexed sender, uint256 indexed ind, string msg ); function Test3() public { _product = 1; } function multiply(int value) public returns(int product) { int old = _product; _product = value * _product; MultipliedEvent( msg.sender, old, value, _product ); return _product; } function getProduct() public constant returns(int product) { return _product; } function setMsg(uint256 i, string m) public returns(uint256 mi) { _msgs[i] = m; NewMessageEvent( msg.sender, i, m); return -i; } function getMsg(uint256 index) public constant returns(string m) { return _msgs[index]; } } 我觉得这是发布代码示例的一种相当简单粗暴的方式。有任何更好建议欢迎留言。 ====================================================================== 如果你想马上使用c#开发以太坊dapp，可以学习下面的教程： C#以太坊，主要讲解如何使用C#开发基于.Net的以太坊应用，包括账户管理、状态与交易、智能合约开发与交互、过滤器和事件等。 其他区块链教程： php以太坊，主要是介绍使用php进行智能合约开发交互，进行账号创建、交易、转账、代币开发以及过滤器和事件等内容。 web3j教程，主要是针对java和android程序员进行区块链以太坊开发的web3j详解。 以太坊教程，主要介绍智能合约与dapp应用开发，适合入门。 以太坊开发，主要是介绍使用node.js、mongodb、区块链、ipfs实现去中心化电商DApp实战，适合进阶。 python以太坊，主要是针对python工程师使用web3.py进行区块链以太坊开发的详解。 EOS智能合约与DApp开发入门教程，内容涵盖EOS工具链、账户与钱包、发行代币、智能合约开发与部署、使用代码与智能合约交互等核心知识点，最后运用react和各知识点完成一个便签DApp的开发。 汇智网原创翻译，转载请标明出处。这里是原文 阅读更多 登录后自动展开" />
<meta property="og:description" content="这是一篇文章的早期版本，旨在帮助那些对以太坊区块链平台有基本了解的开发人员，如果想学习如何使用Nethereum .NET库对Ethereum平台进行编程。 我以后会在这篇文章中添加更多内容，但就目前而言，正在使用它发布.NET 10+的系列C＃示例，介绍如何使用Nethereum库执行针对以太坊区块链平台的最常见任务。 最常见任务列表包括以下内容： 1.获取协议版本 2.获取最大块数 3.获取帐户余额 4.发送以太 5.等待交易收据 6.在区块链中扫描块 7.列出个人账户（及其余额） 8.在区块链中扫描交易 9.与现有（已部署）合同互动 10.用事件和现有（已部署）合约交互 11.获取所有活动更改 12.获取合约金额历史 这里是c#的主文件： using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading; using System.Threading.Tasks; using Nethereum.Hex.HexTypes; using Nethereum.Web3; namespace MWH.MyNethereum.QuickRef { static public class TaskExamples { const int UNLOCK_TIMEOUT = 2 * 60; // 2 minutes (arbitrary) const int SLEEP_TIME = 5 * 1000; // 5 seconds (arbitrary) const int MAX_TIMEOUT = 2 * 60 * 1000; // 2 minutes (arbirtrary) // These static public variables do not represent a recommended pattern static public string LastProtocolVersion = &quot;&quot;; static public string LastTxHash = &quot;&quot;; static public Nethereum.RPC.Eth.DTOs.TransactionReceipt LastTxReceipt = null; static public HexBigInteger LastMaxBlockNumber = new HexBigInteger(0); static public async Task GetProtocolVersionExample(Web3 web3) { Console.WriteLine(&quot;GetProtocolVersionExample:&quot;); var protocolVersion = await web3.Eth.ProtocolVersion.SendRequestAsync(); Console.WriteLine(&quot;protocolVersion:\t&quot; + protocolVersion.ToString()); LastProtocolVersion = protocolVersion; } static public async Task GetMaxBlockExample(Web3 web3) { Console.WriteLine(&quot;GetMaxBlockExample:&quot;); var maxBlockNumber = await web3.Eth.Blocks.GetBlockNumber.SendRequestAsync(); Console.WriteLine(&quot;maxBlockNumber:\t&quot; + maxBlockNumber.Value.ToString()); LastMaxBlockNumber = maxBlockNumber; } static public async Task ScanBlocksExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber) { Console.WriteLine(&quot;ScanBlocksExample:&quot;); long txTotalCount = 0; for (ulong blockNumber = startBlockNumber; blockNumber &lt;= endBlockNumber; blockNumber++) { var blockParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockParameter); var trans = block.Transactions; int txCount = trans.Length; txTotalCount += txCount; if (blockNumber % 1000 == 0) Console.Write(&quot;.&quot;); if (blockNumber % 10000 == 0) { DateTime blockDateTime = Helpers.UnixTimeStampToDateTime((double)block.Timestamp.Value); Console.WriteLine(blockNumber.ToString() + &quot; &quot; + txTotalCount.ToString() + &quot; &quot; + blockDateTime.ToString()); } } Console.WriteLine(); } static public async Task ScanTxExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber) { Console.WriteLine(&quot;ScanTxExample:&quot;); long txTotalCount = 0; for (ulong blockNumber = startBlockNumber; blockNumber &lt;= endBlockNumber; blockNumber++) { var blockParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockParameter); var trans = block.Transactions; int txCount = trans.Length; txTotalCount += txCount; foreach (var tx in trans) { try { var bn = tx.BlockNumber.Value; var th = tx.TransactionHash; var ti = tx.TransactionIndex.Value; var rpt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(th); var status = rpt.Status.Value; var nc = tx.Nonce.Value; var from = tx.From; Console.WriteLine(th.ToString() + &quot; &quot; + ti.ToString() + &quot; &quot; + from.ToString() + &quot; &quot; + status.ToString()); var to = tx.To; if (to == null) to = &quot;to:NULL&quot;; var v = tx.Value.Value; var g = tx.Gas.Value; var gp = tx.GasPrice.Value; Console.WriteLine(th.ToString() + &quot; &quot; + ti.ToString() + &quot; &quot; + nc.ToString() + &quot; &quot; + from.ToString() + &quot; &quot; + to.ToString() + &quot; &quot; + v.ToString() + &quot; &quot; + g.ToString() + &quot; &quot; + gp.ToString()); } catch (Exception ex) { Console.WriteLine(&quot;ScanTxExample.Tx:\t&quot; + ex.ToString()); if (ex.InnerException != null) Console.WriteLine(&quot;ScanTxExample.Tx:\t&quot; + ex.InnerException.ToString()); } } Console.WriteLine(); } } static public async Task GetAccountBalanceExample(Web3 web3, string accountAddress) { Console.WriteLine(&quot;GetAccountBalanceExample:&quot;); var balanceWei = await web3.Eth.GetBalance.SendRequestAsync(accountAddress); var balanceEther = Web3.Convert.FromWei(balanceWei.Value); Console.WriteLine(&quot;accountAddress:\t&quot; + accountAddress.ToString()); Console.WriteLine(&quot;balanceEther:\t&quot; + balanceEther.ToString()); } static public async Task ListPersonalAccountsExample(Web3 web3) { Console.WriteLine(&quot;ListPersonalAccountsExample:&quot;); var accounts = await web3.Personal.ListAccounts.SendRequestAsync(); foreach (var account in accounts) { var balanceWei = await web3.Eth.GetBalance.SendRequestAsync(account); var balanceEther = Web3.Convert.FromWei(balanceWei.Value); Console.WriteLine(&quot;account:\t&quot; + account + &quot; balanceEther:\t&quot; + balanceEther.ToString()); } } static public async Task SendEtherExample(Web3 web3, string fromAddress, string fromPassword, string toAddress, long amountWei) { Console.WriteLine(&quot;SendEtherExample:&quot;); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var sendTxHash = await web3.Eth.TransactionManager.SendTransactionAsync(fromAddress, toAddress, new HexBigInteger(amountWei)); Console.WriteLine(&quot;fromAddress:\t&quot; + fromAddress.ToString()); Console.WriteLine(&quot;toAddress:\t&quot; + toAddress.ToString()); Console.WriteLine(&quot;amountWei:\t&quot; + amountWei.ToString()); Console.WriteLine(&quot;sendTxHash:\t&quot; + sendTxHash.ToString()); LastTxHash = sendTxHash; } static public async Task WaitForTxReceiptExample(Web3 web3, string txHash) { Console.WriteLine(&quot;WaitForTxReceiptExample:&quot;); int timeoutCount = 0; var txReceipt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash); while (txReceipt == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount &quot; + timeoutCount.ToString()); LastTxReceipt = txReceipt; } static public async Task InteractWithExistingContractExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;InteractWithExistingContractExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var setMessageFunction = contract.GetFunction(&quot;setMsg&quot;); var getMessageFunction = contract.GetFunction(&quot;getMsg&quot;); string nowTimestamp = DateTime.UtcNow.ToString() + &quot; UTC&quot;; Console.WriteLine(&quot;now:\t&quot; + nowTimestamp); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var txHash1 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 1, &quot;Hello World&quot;); Console.WriteLine(&quot;txHash1:\t&quot; + txHash1.ToString()); var txHash2 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 2, nowTimestamp); Console.WriteLine(&quot;txHash2:\t&quot; + txHash2.ToString()); var txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); int timeoutCount = 0; while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount:\t&quot; + timeoutCount.ToString()); var txReceipt3 = await setMessageFunction.SendTransactionAndWaitForReceiptAsync(fromAddress, new HexBigInteger(900000), null, null, 2, nowTimestamp + &quot; Wait&quot;); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.TransactionHash.ToString()); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.CumulativeGasUsed.Value.ToString()); var getResult1 = await getMessageFunction.CallAsync&lt;string&gt;(1); Console.WriteLine(&quot;getResult1:\t&quot; + getResult1.ToString()); var getResult2 = await getMessageFunction.CallAsync&lt;string&gt;(2); Console.WriteLine(&quot;getResult2:\t&quot; + getResult2.ToString()); } static public async Task InteractWithExistingContractWithEventsExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;InteractWithExistingContractWithEventsExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var setMessageFunction = contract.GetFunction(&quot;setMsg&quot;); var getMessageFunction = contract.GetFunction(&quot;getMsg&quot;); var multipliedEvent = contract.GetEvent(&quot;MultipliedEvent&quot;); var newMessageEvent = contract.GetEvent(&quot;NewMessageEvent&quot;); var filterAllMultipliedEvent = await multipliedEvent.CreateFilterAsync(); var filterAllNewMessageEvent = await newMessageEvent.CreateFilterAsync(); string nowTimestamp = DateTime.UtcNow.ToString() + &quot; UTC&quot;; Console.WriteLine(&quot;now:\t&quot; + nowTimestamp); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var txHash1 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 1, &quot;Hello World&quot;); Console.WriteLine(&quot;txHash1:\t&quot; + txHash1.ToString()); var txHash2 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 2, nowTimestamp); Console.WriteLine(&quot;txHash2:\t&quot; + txHash2.ToString()); var txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); int timeoutCount = 0; while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount:\t&quot; + timeoutCount.ToString()); var txReceipt3 = await setMessageFunction.SendTransactionAndWaitForReceiptAsync(fromAddress, new HexBigInteger(900000), null, null, 2, nowTimestamp + &quot; Wait&quot;); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.TransactionHash.ToString()); Console.WriteLine(&quot;txReceipt3:\t&quot; + txReceipt3.CumulativeGasUsed.Value.ToString()); var getResult1 = await getMessageFunction.CallAsync&lt;string&gt;(1); Console.WriteLine(&quot;getResult1:\t&quot; + getResult1.ToString()); var getResult2 = await getMessageFunction.CallAsync&lt;string&gt;(2); Console.WriteLine(&quot;getResult2:\t&quot; + getResult2.ToString()); var logMultipliedEvents = await multipliedEvent.GetFilterChanges&lt;FunctionOutputHelpers.MultipliedEventArgs&gt;(filterAllMultipliedEvent); foreach (var mea in logMultipliedEvents) { Console.WriteLine(&quot;multipliedEvent:\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.oldProduct.ToString() + &quot; &quot; + mea.Event.value.ToString() + &quot; &quot; + mea.Event.newProduct.ToString()); } var logNewMessageEvents = await newMessageEvent.GetFilterChanges&lt;FunctionOutputHelpers.NewMessageEventArgs&gt;(filterAllNewMessageEvent); foreach (var mea in logNewMessageEvents) { Console.WriteLine(&quot;newMessageEvent:\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.ind.ToString() + &quot; &quot; + mea.Event.msg.ToString()); } } static public async Task GetAllChangesExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;GetAllChangesExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var newMessageEvent = contract.GetEvent(&quot;NewMessageEvent&quot;); var filterAllNewMessageEvent = await newMessageEvent.CreateFilterAsync(fromAddress); var logNewMessageEvents = await newMessageEvent.GetAllChanges&lt;FunctionOutputHelpers.NewMessageEventArgs&gt;(filterAllNewMessageEvent); foreach (var mea in logNewMessageEvents) { Console.WriteLine(&quot;newMessageEvent:\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.ind.ToString() + &quot; &quot; + mea.Event.msg.ToString()); } } static public async Task GetContractValuesHistoryUniqueOffsetValueExample(Web3 web3, string contractAddress, HexBigInteger recentBlockNumber, ulong numberBlocks, int offset) { Console.WriteLine(&quot;GetContractValuesHistoryUniqueOffsetValueExample:&quot;); string previousValue = &quot;&quot;; for (ulong blockNumber = (ulong)recentBlockNumber.Value; blockNumber &gt; (ulong)recentBlockNumber.Value - numberBlocks; blockNumber--) { var blockNumberParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var valueAtOffset = await web3.Eth.GetStorageAt.SendRequestAsync(contractAddress, new HexBigInteger(offset), blockNumberParameter); if (valueAtOffset != previousValue) { var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockNumberParameter); DateTime blockDateTime = Helpers.UnixTimeStampToDateTime((double)block.Timestamp.Value); Console.WriteLine(&quot;blockDateTime:\t&quot; + blockDateTime.ToString()); for (int storageOffset = 0; storageOffset &lt; offset+2; storageOffset++) { var valueAt = await web3.Eth.GetStorageAt.SendRequestAsync(contractAddress, new HexBigInteger(storageOffset), blockNumberParameter); Console.WriteLine(&quot;value:\t&quot; + blockNumber.ToString() + &quot; &quot; + storageOffset.ToString() + &quot; &quot; + valueAt + &quot; &quot; + Helpers.ConvertHex(valueAt.Substring(2))); } previousValue = valueAtOffset; } } } } } 以下是一些支持文件： FunctionOutputHelpers.cs using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; using Nethereum.Web3; using Nethereum.ABI.FunctionEncoding.Attributes; namespace MWH.MyNethereum.QuickRef { static public class FunctionOutputHelpers { // event MultipliedEvent( // address indexed sender, // int oldProduct, // int value, // int newProduct // ); [FunctionOutput] public class MultipliedEventArgs { [Parameter(&quot;address&quot;, &quot;sender&quot;, 1, true)] public string sender { get; set; } [Parameter(&quot;int&quot;, &quot;oldProduct&quot;, 2, false)] public int oldProduct { get; set; } [Parameter(&quot;int&quot;, &quot;value&quot;, 3, false)] public int value { get; set; } [Parameter(&quot;int&quot;, &quot;newProduct&quot;, 4, false)] public int newProduct { get; set; } } //event NewMessageEvent( // address indexed sender, // uint256 indexed ind, // string msg //); [FunctionOutput] public class NewMessageEventArgs { [Parameter(&quot;address&quot;, &quot;sender&quot;, 1, true)] public string sender { get; set; } [Parameter(&quot;uint256&quot;, &quot;ind&quot;, 2, true)] public int ind { get; set; } [Parameter(&quot;string&quot;, &quot;msg&quot;, 3, false)] public string msg { get; set; } } } } Helpers.cs using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace MWH.MyNethereum.QuickRef { static public class Helpers { public static string ConvertHex(String hexString) { try { string ascii = string.Empty; for (int i = 0; i &lt; hexString.Length; i += 2) { String hs = string.Empty; hs = hexString.Substring(i, 2); uint decval = System.Convert.ToUInt32(hs, 16); char character = System.Convert.ToChar(decval); ascii += character; } return ascii; } catch (Exception ex) { Console.WriteLine(ex.Message); } return string.Empty; } public static DateTime UnixTimeStampToDateTime(double unixTimeStamp) { // Unix timestamp is seconds past epoch System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc); dtDateTime = dtDateTime.AddSeconds(unixTimeStamp); // .ToLocalTime(); return dtDateTime; } public static DateTime JavaTimeStampToDateTime(double javaTimeStamp) { // Java timestamp is milliseconds past epoch System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc); dtDateTime = dtDateTime.AddMilliseconds(javaTimeStamp); // .ToLocalTime(); return dtDateTime; } } } 以下是用于实施这些示例时使用的以太坊合约的Solidity代码： Test3.sol pragma solidity 0.4.19; contract Test3 { int public _product; string[5] _msgs; event MultipliedEvent( address indexed sender, int oldProduct, int value, int newProduct ); event NewMessageEvent( address indexed sender, uint256 indexed ind, string msg ); function Test3() public { _product = 1; } function multiply(int value) public returns(int product) { int old = _product; _product = value * _product; MultipliedEvent( msg.sender, old, value, _product ); return _product; } function getProduct() public constant returns(int product) { return _product; } function setMsg(uint256 i, string m) public returns(uint256 mi) { _msgs[i] = m; NewMessageEvent( msg.sender, i, m); return -i; } function getMsg(uint256 index) public constant returns(string m) { return _msgs[index]; } } 我觉得这是发布代码示例的一种相当简单粗暴的方式。有任何更好建议欢迎留言。 ====================================================================== 如果你想马上使用c#开发以太坊dapp，可以学习下面的教程： C#以太坊，主要讲解如何使用C#开发基于.Net的以太坊应用，包括账户管理、状态与交易、智能合约开发与交互、过滤器和事件等。 其他区块链教程： php以太坊，主要是介绍使用php进行智能合约开发交互，进行账号创建、交易、转账、代币开发以及过滤器和事件等内容。 web3j教程，主要是针对java和android程序员进行区块链以太坊开发的web3j详解。 以太坊教程，主要介绍智能合约与dapp应用开发，适合入门。 以太坊开发，主要是介绍使用node.js、mongodb、区块链、ipfs实现去中心化电商DApp实战，适合进阶。 python以太坊，主要是针对python工程师使用web3.py进行区块链以太坊开发的详解。 EOS智能合约与DApp开发入门教程，内容涵盖EOS工具链、账户与钱包、发行代币、智能合约开发与部署、使用代码与智能合约交互等核心知识点，最后运用react和各知识点完成一个便签DApp的开发。 汇智网原创翻译，转载请标明出处。这里是原文 阅读更多 登录后自动展开" />
<link rel="canonical" href="https://mlh.app/2018/09/07/f79e0662a01146f095a8ed099d81bf4f.html" />
<meta property="og:url" content="https://mlh.app/2018/09/07/f79e0662a01146f095a8ed099d81bf4f.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-09-07T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"这是一篇文章的早期版本，旨在帮助那些对以太坊区块链平台有基本了解的开发人员，如果想学习如何使用Nethereum .NET库对Ethereum平台进行编程。 我以后会在这篇文章中添加更多内容，但就目前而言，正在使用它发布.NET 10+的系列C＃示例，介绍如何使用Nethereum库执行针对以太坊区块链平台的最常见任务。 最常见任务列表包括以下内容： 1.获取协议版本 2.获取最大块数 3.获取帐户余额 4.发送以太 5.等待交易收据 6.在区块链中扫描块 7.列出个人账户（及其余额） 8.在区块链中扫描交易 9.与现有（已部署）合同互动 10.用事件和现有（已部署）合约交互 11.获取所有活动更改 12.获取合约金额历史 这里是c#的主文件： using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading; using System.Threading.Tasks; using Nethereum.Hex.HexTypes; using Nethereum.Web3; namespace MWH.MyNethereum.QuickRef { static public class TaskExamples { const int UNLOCK_TIMEOUT = 2 * 60; // 2 minutes (arbitrary) const int SLEEP_TIME = 5 * 1000; // 5 seconds (arbitrary) const int MAX_TIMEOUT = 2 * 60 * 1000; // 2 minutes (arbirtrary) // These static public variables do not represent a recommended pattern static public string LastProtocolVersion = &quot;&quot;; static public string LastTxHash = &quot;&quot;; static public Nethereum.RPC.Eth.DTOs.TransactionReceipt LastTxReceipt = null; static public HexBigInteger LastMaxBlockNumber = new HexBigInteger(0); static public async Task GetProtocolVersionExample(Web3 web3) { Console.WriteLine(&quot;GetProtocolVersionExample:&quot;); var protocolVersion = await web3.Eth.ProtocolVersion.SendRequestAsync(); Console.WriteLine(&quot;protocolVersion:\\t&quot; + protocolVersion.ToString()); LastProtocolVersion = protocolVersion; } static public async Task GetMaxBlockExample(Web3 web3) { Console.WriteLine(&quot;GetMaxBlockExample:&quot;); var maxBlockNumber = await web3.Eth.Blocks.GetBlockNumber.SendRequestAsync(); Console.WriteLine(&quot;maxBlockNumber:\\t&quot; + maxBlockNumber.Value.ToString()); LastMaxBlockNumber = maxBlockNumber; } static public async Task ScanBlocksExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber) { Console.WriteLine(&quot;ScanBlocksExample:&quot;); long txTotalCount = 0; for (ulong blockNumber = startBlockNumber; blockNumber &lt;= endBlockNumber; blockNumber++) { var blockParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockParameter); var trans = block.Transactions; int txCount = trans.Length; txTotalCount += txCount; if (blockNumber % 1000 == 0) Console.Write(&quot;.&quot;); if (blockNumber % 10000 == 0) { DateTime blockDateTime = Helpers.UnixTimeStampToDateTime((double)block.Timestamp.Value); Console.WriteLine(blockNumber.ToString() + &quot; &quot; + txTotalCount.ToString() + &quot; &quot; + blockDateTime.ToString()); } } Console.WriteLine(); } static public async Task ScanTxExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber) { Console.WriteLine(&quot;ScanTxExample:&quot;); long txTotalCount = 0; for (ulong blockNumber = startBlockNumber; blockNumber &lt;= endBlockNumber; blockNumber++) { var blockParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockParameter); var trans = block.Transactions; int txCount = trans.Length; txTotalCount += txCount; foreach (var tx in trans) { try { var bn = tx.BlockNumber.Value; var th = tx.TransactionHash; var ti = tx.TransactionIndex.Value; var rpt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(th); var status = rpt.Status.Value; var nc = tx.Nonce.Value; var from = tx.From; Console.WriteLine(th.ToString() + &quot; &quot; + ti.ToString() + &quot; &quot; + from.ToString() + &quot; &quot; + status.ToString()); var to = tx.To; if (to == null) to = &quot;to:NULL&quot;; var v = tx.Value.Value; var g = tx.Gas.Value; var gp = tx.GasPrice.Value; Console.WriteLine(th.ToString() + &quot; &quot; + ti.ToString() + &quot; &quot; + nc.ToString() + &quot; &quot; + from.ToString() + &quot; &quot; + to.ToString() + &quot; &quot; + v.ToString() + &quot; &quot; + g.ToString() + &quot; &quot; + gp.ToString()); } catch (Exception ex) { Console.WriteLine(&quot;ScanTxExample.Tx:\\t&quot; + ex.ToString()); if (ex.InnerException != null) Console.WriteLine(&quot;ScanTxExample.Tx:\\t&quot; + ex.InnerException.ToString()); } } Console.WriteLine(); } } static public async Task GetAccountBalanceExample(Web3 web3, string accountAddress) { Console.WriteLine(&quot;GetAccountBalanceExample:&quot;); var balanceWei = await web3.Eth.GetBalance.SendRequestAsync(accountAddress); var balanceEther = Web3.Convert.FromWei(balanceWei.Value); Console.WriteLine(&quot;accountAddress:\\t&quot; + accountAddress.ToString()); Console.WriteLine(&quot;balanceEther:\\t&quot; + balanceEther.ToString()); } static public async Task ListPersonalAccountsExample(Web3 web3) { Console.WriteLine(&quot;ListPersonalAccountsExample:&quot;); var accounts = await web3.Personal.ListAccounts.SendRequestAsync(); foreach (var account in accounts) { var balanceWei = await web3.Eth.GetBalance.SendRequestAsync(account); var balanceEther = Web3.Convert.FromWei(balanceWei.Value); Console.WriteLine(&quot;account:\\t&quot; + account + &quot; balanceEther:\\t&quot; + balanceEther.ToString()); } } static public async Task SendEtherExample(Web3 web3, string fromAddress, string fromPassword, string toAddress, long amountWei) { Console.WriteLine(&quot;SendEtherExample:&quot;); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var sendTxHash = await web3.Eth.TransactionManager.SendTransactionAsync(fromAddress, toAddress, new HexBigInteger(amountWei)); Console.WriteLine(&quot;fromAddress:\\t&quot; + fromAddress.ToString()); Console.WriteLine(&quot;toAddress:\\t&quot; + toAddress.ToString()); Console.WriteLine(&quot;amountWei:\\t&quot; + amountWei.ToString()); Console.WriteLine(&quot;sendTxHash:\\t&quot; + sendTxHash.ToString()); LastTxHash = sendTxHash; } static public async Task WaitForTxReceiptExample(Web3 web3, string txHash) { Console.WriteLine(&quot;WaitForTxReceiptExample:&quot;); int timeoutCount = 0; var txReceipt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash); while (txReceipt == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount &quot; + timeoutCount.ToString()); LastTxReceipt = txReceipt; } static public async Task InteractWithExistingContractExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;InteractWithExistingContractExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var setMessageFunction = contract.GetFunction(&quot;setMsg&quot;); var getMessageFunction = contract.GetFunction(&quot;getMsg&quot;); string nowTimestamp = DateTime.UtcNow.ToString() + &quot; UTC&quot;; Console.WriteLine(&quot;now:\\t&quot; + nowTimestamp); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var txHash1 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 1, &quot;Hello World&quot;); Console.WriteLine(&quot;txHash1:\\t&quot; + txHash1.ToString()); var txHash2 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 2, nowTimestamp); Console.WriteLine(&quot;txHash2:\\t&quot; + txHash2.ToString()); var txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); int timeoutCount = 0; while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount:\\t&quot; + timeoutCount.ToString()); var txReceipt3 = await setMessageFunction.SendTransactionAndWaitForReceiptAsync(fromAddress, new HexBigInteger(900000), null, null, 2, nowTimestamp + &quot; Wait&quot;); Console.WriteLine(&quot;txReceipt3:\\t&quot; + txReceipt3.TransactionHash.ToString()); Console.WriteLine(&quot;txReceipt3:\\t&quot; + txReceipt3.CumulativeGasUsed.Value.ToString()); var getResult1 = await getMessageFunction.CallAsync&lt;string&gt;(1); Console.WriteLine(&quot;getResult1:\\t&quot; + getResult1.ToString()); var getResult2 = await getMessageFunction.CallAsync&lt;string&gt;(2); Console.WriteLine(&quot;getResult2:\\t&quot; + getResult2.ToString()); } static public async Task InteractWithExistingContractWithEventsExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;InteractWithExistingContractWithEventsExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var setMessageFunction = contract.GetFunction(&quot;setMsg&quot;); var getMessageFunction = contract.GetFunction(&quot;getMsg&quot;); var multipliedEvent = contract.GetEvent(&quot;MultipliedEvent&quot;); var newMessageEvent = contract.GetEvent(&quot;NewMessageEvent&quot;); var filterAllMultipliedEvent = await multipliedEvent.CreateFilterAsync(); var filterAllNewMessageEvent = await newMessageEvent.CreateFilterAsync(); string nowTimestamp = DateTime.UtcNow.ToString() + &quot; UTC&quot;; Console.WriteLine(&quot;now:\\t&quot; + nowTimestamp); var unlockResult = await web3.Personal.UnlockAccount.SendRequestAsync(fromAddress, fromPassword, UNLOCK_TIMEOUT); var txHash1 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 1, &quot;Hello World&quot;); Console.WriteLine(&quot;txHash1:\\t&quot; + txHash1.ToString()); var txHash2 = await setMessageFunction.SendTransactionAsync(fromAddress, new HexBigInteger(900000), null, 2, nowTimestamp); Console.WriteLine(&quot;txHash2:\\t&quot; + txHash2.ToString()); var txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); int timeoutCount = 0; while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT) { Console.WriteLine(&quot;Sleeping...&quot;); Thread.Sleep(SLEEP_TIME); txReceipt2 = await web3.Eth.Transactions.GetTransactionReceipt.SendRequestAsync(txHash2); timeoutCount += SLEEP_TIME; } Console.WriteLine(&quot;timeoutCount:\\t&quot; + timeoutCount.ToString()); var txReceipt3 = await setMessageFunction.SendTransactionAndWaitForReceiptAsync(fromAddress, new HexBigInteger(900000), null, null, 2, nowTimestamp + &quot; Wait&quot;); Console.WriteLine(&quot;txReceipt3:\\t&quot; + txReceipt3.TransactionHash.ToString()); Console.WriteLine(&quot;txReceipt3:\\t&quot; + txReceipt3.CumulativeGasUsed.Value.ToString()); var getResult1 = await getMessageFunction.CallAsync&lt;string&gt;(1); Console.WriteLine(&quot;getResult1:\\t&quot; + getResult1.ToString()); var getResult2 = await getMessageFunction.CallAsync&lt;string&gt;(2); Console.WriteLine(&quot;getResult2:\\t&quot; + getResult2.ToString()); var logMultipliedEvents = await multipliedEvent.GetFilterChanges&lt;FunctionOutputHelpers.MultipliedEventArgs&gt;(filterAllMultipliedEvent); foreach (var mea in logMultipliedEvents) { Console.WriteLine(&quot;multipliedEvent:\\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.oldProduct.ToString() + &quot; &quot; + mea.Event.value.ToString() + &quot; &quot; + mea.Event.newProduct.ToString()); } var logNewMessageEvents = await newMessageEvent.GetFilterChanges&lt;FunctionOutputHelpers.NewMessageEventArgs&gt;(filterAllNewMessageEvent); foreach (var mea in logNewMessageEvents) { Console.WriteLine(&quot;newMessageEvent:\\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.ind.ToString() + &quot; &quot; + mea.Event.msg.ToString()); } } static public async Task GetAllChangesExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi) { Console.WriteLine(&quot;GetAllChangesExample:&quot;); var contract = web3.Eth.GetContract(contractAbi, contractAddress); var newMessageEvent = contract.GetEvent(&quot;NewMessageEvent&quot;); var filterAllNewMessageEvent = await newMessageEvent.CreateFilterAsync(fromAddress); var logNewMessageEvents = await newMessageEvent.GetAllChanges&lt;FunctionOutputHelpers.NewMessageEventArgs&gt;(filterAllNewMessageEvent); foreach (var mea in logNewMessageEvents) { Console.WriteLine(&quot;newMessageEvent:\\t&quot; + mea.Event.sender + &quot; &quot; + mea.Event.ind.ToString() + &quot; &quot; + mea.Event.msg.ToString()); } } static public async Task GetContractValuesHistoryUniqueOffsetValueExample(Web3 web3, string contractAddress, HexBigInteger recentBlockNumber, ulong numberBlocks, int offset) { Console.WriteLine(&quot;GetContractValuesHistoryUniqueOffsetValueExample:&quot;); string previousValue = &quot;&quot;; for (ulong blockNumber = (ulong)recentBlockNumber.Value; blockNumber &gt; (ulong)recentBlockNumber.Value - numberBlocks; blockNumber--) { var blockNumberParameter = new Nethereum.RPC.Eth.DTOs.BlockParameter(blockNumber); var valueAtOffset = await web3.Eth.GetStorageAt.SendRequestAsync(contractAddress, new HexBigInteger(offset), blockNumberParameter); if (valueAtOffset != previousValue) { var block = await web3.Eth.Blocks.GetBlockWithTransactionsByNumber.SendRequestAsync(blockNumberParameter); DateTime blockDateTime = Helpers.UnixTimeStampToDateTime((double)block.Timestamp.Value); Console.WriteLine(&quot;blockDateTime:\\t&quot; + blockDateTime.ToString()); for (int storageOffset = 0; storageOffset &lt; offset+2; storageOffset++) { var valueAt = await web3.Eth.GetStorageAt.SendRequestAsync(contractAddress, new HexBigInteger(storageOffset), blockNumberParameter); Console.WriteLine(&quot;value:\\t&quot; + blockNumber.ToString() + &quot; &quot; + storageOffset.ToString() + &quot; &quot; + valueAt + &quot; &quot; + Helpers.ConvertHex(valueAt.Substring(2))); } previousValue = valueAtOffset; } } } } } 以下是一些支持文件： FunctionOutputHelpers.cs using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; using Nethereum.Web3; using Nethereum.ABI.FunctionEncoding.Attributes; namespace MWH.MyNethereum.QuickRef { static public class FunctionOutputHelpers { // event MultipliedEvent( // address indexed sender, // int oldProduct, // int value, // int newProduct // ); [FunctionOutput] public class MultipliedEventArgs { [Parameter(&quot;address&quot;, &quot;sender&quot;, 1, true)] public string sender { get; set; } [Parameter(&quot;int&quot;, &quot;oldProduct&quot;, 2, false)] public int oldProduct { get; set; } [Parameter(&quot;int&quot;, &quot;value&quot;, 3, false)] public int value { get; set; } [Parameter(&quot;int&quot;, &quot;newProduct&quot;, 4, false)] public int newProduct { get; set; } } //event NewMessageEvent( // address indexed sender, // uint256 indexed ind, // string msg //); [FunctionOutput] public class NewMessageEventArgs { [Parameter(&quot;address&quot;, &quot;sender&quot;, 1, true)] public string sender { get; set; } [Parameter(&quot;uint256&quot;, &quot;ind&quot;, 2, true)] public int ind { get; set; } [Parameter(&quot;string&quot;, &quot;msg&quot;, 3, false)] public string msg { get; set; } } } } Helpers.cs using System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; namespace MWH.MyNethereum.QuickRef { static public class Helpers { public static string ConvertHex(String hexString) { try { string ascii = string.Empty; for (int i = 0; i &lt; hexString.Length; i += 2) { String hs = string.Empty; hs = hexString.Substring(i, 2); uint decval = System.Convert.ToUInt32(hs, 16); char character = System.Convert.ToChar(decval); ascii += character; } return ascii; } catch (Exception ex) { Console.WriteLine(ex.Message); } return string.Empty; } public static DateTime UnixTimeStampToDateTime(double unixTimeStamp) { // Unix timestamp is seconds past epoch System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc); dtDateTime = dtDateTime.AddSeconds(unixTimeStamp); // .ToLocalTime(); return dtDateTime; } public static DateTime JavaTimeStampToDateTime(double javaTimeStamp) { // Java timestamp is milliseconds past epoch System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc); dtDateTime = dtDateTime.AddMilliseconds(javaTimeStamp); // .ToLocalTime(); return dtDateTime; } } } 以下是用于实施这些示例时使用的以太坊合约的Solidity代码： Test3.sol pragma solidity 0.4.19; contract Test3 { int public _product; string[5] _msgs; event MultipliedEvent( address indexed sender, int oldProduct, int value, int newProduct ); event NewMessageEvent( address indexed sender, uint256 indexed ind, string msg ); function Test3() public { _product = 1; } function multiply(int value) public returns(int product) { int old = _product; _product = value * _product; MultipliedEvent( msg.sender, old, value, _product ); return _product; } function getProduct() public constant returns(int product) { return _product; } function setMsg(uint256 i, string m) public returns(uint256 mi) { _msgs[i] = m; NewMessageEvent( msg.sender, i, m); return -i; } function getMsg(uint256 index) public constant returns(string m) { return _msgs[index]; } } 我觉得这是发布代码示例的一种相当简单粗暴的方式。有任何更好建议欢迎留言。 ====================================================================== 如果你想马上使用c#开发以太坊dapp，可以学习下面的教程： C#以太坊，主要讲解如何使用C#开发基于.Net的以太坊应用，包括账户管理、状态与交易、智能合约开发与交互、过滤器和事件等。 其他区块链教程： php以太坊，主要是介绍使用php进行智能合约开发交互，进行账号创建、交易、转账、代币开发以及过滤器和事件等内容。 web3j教程，主要是针对java和android程序员进行区块链以太坊开发的web3j详解。 以太坊教程，主要介绍智能合约与dapp应用开发，适合入门。 以太坊开发，主要是介绍使用node.js、mongodb、区块链、ipfs实现去中心化电商DApp实战，适合进阶。 python以太坊，主要是针对python工程师使用web3.py进行区块链以太坊开发的详解。 EOS智能合约与DApp开发入门教程，内容涵盖EOS工具链、账户与钱包、发行代币、智能合约开发与部署、使用代码与智能合约交互等核心知识点，最后运用react和各知识点完成一个便签DApp的开发。 汇智网原创翻译，转载请标明出处。这里是原文 阅读更多 登录后自动展开","@type":"BlogPosting","url":"https://mlh.app/2018/09/07/f79e0662a01146f095a8ed099d81bf4f.html","headline":"使用Nethereum库的以太坊.NET、C#开发示例","dateModified":"2018-09-07T00:00:00+08:00","datePublished":"2018-09-07T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/09/07/f79e0662a01146f095a8ed099d81bf4f.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>使用Nethereum库的以太坊.NET、C#开发示例</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <p>这是一篇文章的早期版本，旨在帮助那些对以太坊区块链平台有基本了解的开发人员，如果想学习如何使用Nethereum .NET库对Ethereum平台进行编程。</p> 
  <p>我以后会在这篇文章中添加更多内容，但就目前而言，正在使用它发布.NET 10+的系列C＃示例，介绍如何使用Nethereum库执行针对以太坊区块链平台的最常见任务。</p> 
  <p>最常见任务列表包括以下内容：</p> 
  <ul> 
   <li>1.获取协议版本</li> 
   <li>2.获取最大块数</li> 
   <li>3.获取帐户余额</li> 
   <li>4.发送以太</li> 
   <li>5.等待交易收据</li> 
   <li>6.在区块链中扫描块</li> 
   <li>7.列出个人账户（及其余额）</li> 
   <li>8.在区块链中扫描交易</li> 
   <li>9.与现有（已部署）合同互动</li> 
   <li>10.用事件和现有（已部署）合约交互</li> 
   <li>11.获取所有活动更改</li> 
   <li>12.获取合约金额历史</li> 
  </ul> 
  <p>这里是c#的主文件：</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">using System<span class="hljs-comment">;</span>
using System<span class="hljs-preprocessor">.Collections</span><span class="hljs-preprocessor">.Generic</span><span class="hljs-comment">;</span>
using System<span class="hljs-preprocessor">.Linq</span><span class="hljs-comment">;</span>
using System<span class="hljs-preprocessor">.Text</span><span class="hljs-comment">;</span>
using System<span class="hljs-preprocessor">.Threading</span><span class="hljs-comment">;</span>
using System<span class="hljs-preprocessor">.Threading</span><span class="hljs-preprocessor">.Tasks</span><span class="hljs-comment">;</span>

using Nethereum<span class="hljs-preprocessor">.Hex</span><span class="hljs-preprocessor">.HexTypes</span><span class="hljs-comment">;</span>
using Nethereum<span class="hljs-preprocessor">.Web</span>3<span class="hljs-comment">;</span>

namespace MWH<span class="hljs-preprocessor">.MyNethereum</span><span class="hljs-preprocessor">.QuickRef</span>
{
 static public class TaskExamples
 {
 const int UNLOCK_TIMEOUT = <span class="hljs-number">2</span> * <span class="hljs-number">60</span><span class="hljs-comment">; // 2 minutes (arbitrary)</span>
 const int SLEEP_TIME = <span class="hljs-number">5</span> * <span class="hljs-number">1000</span><span class="hljs-comment">; // 5 seconds (arbitrary)</span>
 const int MAX_TIMEOUT = <span class="hljs-number">2</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span><span class="hljs-comment">; // 2 minutes (arbirtrary)</span>

// These static public variables do not represent a recommended pattern
 static public string LastProtocolVersion = <span class="hljs-string">""</span><span class="hljs-comment">;</span>
 static public string LastTxHash = <span class="hljs-string">""</span><span class="hljs-comment">;</span>
 static public Nethereum<span class="hljs-preprocessor">.RPC</span><span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.DTOs</span><span class="hljs-preprocessor">.TransactionReceipt</span> LastTxReceipt = null<span class="hljs-comment">;</span>
 static public HexBigInteger LastMaxBlockNumber = new HexBigInteger(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>

static public async Task GetProtocolVersionExample(Web3 web3)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"GetProtocolVersionExample:"</span>)<span class="hljs-comment">;</span>

var protocolVersion = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.ProtocolVersion</span><span class="hljs-preprocessor">.SendRequestAsync</span>()<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"protocolVersion:\t"</span> + protocolVersion<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 LastProtocolVersion = protocolVersion<span class="hljs-comment">;</span>
 }

static public async Task GetMaxBlockExample(Web3 web3)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"GetMaxBlockExample:"</span>)<span class="hljs-comment">;</span>

var maxBlockNumber = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Blocks</span><span class="hljs-preprocessor">.GetBlockNumber</span><span class="hljs-preprocessor">.SendRequestAsync</span>()<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"maxBlockNumber:\t"</span> + maxBlockNumber<span class="hljs-preprocessor">.Value</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 LastMaxBlockNumber = maxBlockNumber<span class="hljs-comment">;</span>
 }

static public async Task ScanBlocksExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"ScanBlocksExample:"</span>)<span class="hljs-comment">;</span>

long txTotalCount = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 for (ulong blockNumber = startBlockNumber<span class="hljs-comment">; blockNumber &lt;= endBlockNumber; blockNumber++)</span>
 {
 var blockParameter = new Nethereum<span class="hljs-preprocessor">.RPC</span><span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.DTOs</span><span class="hljs-preprocessor">.BlockParameter</span>(blockNumber)<span class="hljs-comment">;</span>
 var block = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Blocks</span><span class="hljs-preprocessor">.GetBlockWithTransactionsByNumber</span><span class="hljs-preprocessor">.SendRequestAsync</span>(blockParameter)<span class="hljs-comment">;</span>
 var trans = block<span class="hljs-preprocessor">.Transactions</span><span class="hljs-comment">;</span>
 int txCount = trans<span class="hljs-preprocessor">.Length</span><span class="hljs-comment">;</span>
 txTotalCount += txCount<span class="hljs-comment">;</span>
 if (blockNumber % <span class="hljs-number">1000</span> == <span class="hljs-number">0</span>) Console<span class="hljs-preprocessor">.Write</span>(<span class="hljs-string">"."</span>)<span class="hljs-comment">;</span>
 if (blockNumber % <span class="hljs-number">10000</span> == <span class="hljs-number">0</span>)
 {
 DateTime blockDateTime = Helpers<span class="hljs-preprocessor">.UnixTimeStampToDateTime</span>((double)block<span class="hljs-preprocessor">.Timestamp</span><span class="hljs-preprocessor">.Value</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(blockNumber<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + txTotalCount<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + blockDateTime<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }
 }
 Console<span class="hljs-preprocessor">.WriteLine</span>()<span class="hljs-comment">;</span>
 }

static public async Task ScanTxExample(Web3 web3, ulong startBlockNumber, ulong endBlockNumber)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"ScanTxExample:"</span>)<span class="hljs-comment">;</span>

long txTotalCount = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 for (ulong blockNumber = startBlockNumber<span class="hljs-comment">; blockNumber &lt;= endBlockNumber; blockNumber++)</span>
 {
 var blockParameter = new Nethereum<span class="hljs-preprocessor">.RPC</span><span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.DTOs</span><span class="hljs-preprocessor">.BlockParameter</span>(blockNumber)<span class="hljs-comment">;</span>
 var block = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Blocks</span><span class="hljs-preprocessor">.GetBlockWithTransactionsByNumber</span><span class="hljs-preprocessor">.SendRequestAsync</span>(blockParameter)<span class="hljs-comment">;</span>
 var trans = block<span class="hljs-preprocessor">.Transactions</span><span class="hljs-comment">;</span>
 int txCount = trans<span class="hljs-preprocessor">.Length</span><span class="hljs-comment">;</span>
 txTotalCount += txCount<span class="hljs-comment">;</span>
 foreach (var tx <span class="hljs-keyword">in</span> trans)
 {
 try
 {
 var bn = tx<span class="hljs-preprocessor">.BlockNumber</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>
 var th = tx<span class="hljs-preprocessor">.TransactionHash</span><span class="hljs-comment">;</span>
 var ti = tx<span class="hljs-preprocessor">.TransactionIndex</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>

var rpt = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(th)<span class="hljs-comment">;</span>
 var status = rpt<span class="hljs-preprocessor">.Status</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>

var nc = tx<span class="hljs-preprocessor">.Nonce</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>
 var from = tx<span class="hljs-preprocessor">.From</span><span class="hljs-comment">;</span>

Console<span class="hljs-preprocessor">.WriteLine</span>(th<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + ti<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + from<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + status<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var to = tx<span class="hljs-preprocessor">.To</span><span class="hljs-comment">;</span>
 if (to == null) to = <span class="hljs-string">"to:NULL"</span><span class="hljs-comment">;</span>
 var v = tx<span class="hljs-preprocessor">.Value</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>
 var g = tx<span class="hljs-preprocessor">.Gas</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>
 var gp = tx<span class="hljs-preprocessor">.GasPrice</span><span class="hljs-preprocessor">.Value</span><span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(th<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + ti<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + nc<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + from<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + to<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + v<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + g<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + gp<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }
 catch (Exception ex)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"ScanTxExample.Tx:\t"</span> + ex<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 if (ex<span class="hljs-preprocessor">.InnerException</span> != null) Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"ScanTxExample.Tx:\t"</span> + ex<span class="hljs-preprocessor">.InnerException</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }
 }
 Console<span class="hljs-preprocessor">.WriteLine</span>()<span class="hljs-comment">;</span>
 }
 }

static public async Task GetAccountBalanceExample(Web3 web3, string accountAddress)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"GetAccountBalanceExample:"</span>)<span class="hljs-comment">;</span>

var balanceWei = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetBalance</span><span class="hljs-preprocessor">.SendRequestAsync</span>(accountAddress)<span class="hljs-comment">;</span>
 var balanceEther = Web3<span class="hljs-preprocessor">.Convert</span><span class="hljs-preprocessor">.FromWei</span>(balanceWei<span class="hljs-preprocessor">.Value</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"accountAddress:\t"</span> + accountAddress<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"balanceEther:\t"</span> + balanceEther<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }

static public async Task ListPersonalAccountsExample(Web3 web3)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"ListPersonalAccountsExample:"</span>)<span class="hljs-comment">;</span>

var accounts = await web3<span class="hljs-preprocessor">.Personal</span><span class="hljs-preprocessor">.ListAccounts</span><span class="hljs-preprocessor">.SendRequestAsync</span>()<span class="hljs-comment">;</span>
 foreach (var account <span class="hljs-keyword">in</span> accounts)
 {
 var balanceWei = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetBalance</span><span class="hljs-preprocessor">.SendRequestAsync</span>(account)<span class="hljs-comment">;</span>
 var balanceEther = Web3<span class="hljs-preprocessor">.Convert</span><span class="hljs-preprocessor">.FromWei</span>(balanceWei<span class="hljs-preprocessor">.Value</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"account:\t"</span> + account + <span class="hljs-string">" balanceEther:\t"</span> + balanceEther<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }
 }

static public async Task SendEtherExample(Web3 web3, string fromAddress, string fromPassword, string toAddress, long amountWei)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"SendEtherExample:"</span>)<span class="hljs-comment">;</span>

var unlockResult = await web3<span class="hljs-preprocessor">.Personal</span><span class="hljs-preprocessor">.UnlockAccount</span><span class="hljs-preprocessor">.SendRequestAsync</span>(fromAddress, fromPassword, UNLOCK_TIMEOUT)<span class="hljs-comment">;</span>
 var sendTxHash = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.TransactionManager</span><span class="hljs-preprocessor">.SendTransactionAsync</span>(fromAddress, toAddress, new HexBigInteger(amountWei))<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"fromAddress:\t"</span> + fromAddress<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"toAddress:\t"</span> + toAddress<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"amountWei:\t"</span> + amountWei<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"sendTxHash:\t"</span> + sendTxHash<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 LastTxHash = sendTxHash<span class="hljs-comment">;</span>
 }

static public async Task WaitForTxReceiptExample(Web3 web3, string txHash)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"WaitForTxReceiptExample:"</span>)<span class="hljs-comment">;</span>

int timeoutCount = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 var txReceipt = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(txHash)<span class="hljs-comment">;</span>
 while (txReceipt == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"Sleeping..."</span>)<span class="hljs-comment">;</span>
 Thread<span class="hljs-preprocessor">.Sleep</span>(SLEEP_TIME)<span class="hljs-comment">;</span>
 txReceipt = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(txHash)<span class="hljs-comment">;</span>
 timeoutCount += SLEEP_TIME<span class="hljs-comment">;</span>
 }
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"timeoutCount "</span> + timeoutCount<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 LastTxReceipt = txReceipt<span class="hljs-comment">;</span>
 }

static public async Task InteractWithExistingContractExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"InteractWithExistingContractExample:"</span>)<span class="hljs-comment">;</span>

var contract = web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetContract</span>(contractAbi, contractAddress)<span class="hljs-comment">;</span>

var setMessageFunction = contract<span class="hljs-preprocessor">.GetFunction</span>(<span class="hljs-string">"setMsg"</span>)<span class="hljs-comment">;</span>
 var getMessageFunction = contract<span class="hljs-preprocessor">.GetFunction</span>(<span class="hljs-string">"getMsg"</span>)<span class="hljs-comment">;</span>

string nowTimestamp = DateTime<span class="hljs-preprocessor">.UtcNow</span><span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" UTC"</span><span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"now:\t"</span> + nowTimestamp)<span class="hljs-comment">;</span>

var unlockResult = await web3<span class="hljs-preprocessor">.Personal</span><span class="hljs-preprocessor">.UnlockAccount</span><span class="hljs-preprocessor">.SendRequestAsync</span>(fromAddress, fromPassword, UNLOCK_TIMEOUT)<span class="hljs-comment">;</span>
 var txHash1 = await setMessageFunction<span class="hljs-preprocessor">.SendTransactionAsync</span>(fromAddress, new HexBigInteger(<span class="hljs-number">900000</span>), null, <span class="hljs-number">1</span>, <span class="hljs-string">"Hello World"</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txHash1:\t"</span> + txHash1<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 var txHash2 = await setMessageFunction<span class="hljs-preprocessor">.SendTransactionAsync</span>(fromAddress, new HexBigInteger(<span class="hljs-number">900000</span>), null, <span class="hljs-number">2</span>, nowTimestamp)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txHash2:\t"</span> + txHash2<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var txReceipt2 = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(txHash2)<span class="hljs-comment">;</span>
 int timeoutCount = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"Sleeping..."</span>)<span class="hljs-comment">;</span>
 Thread<span class="hljs-preprocessor">.Sleep</span>(SLEEP_TIME)<span class="hljs-comment">;</span>
 txReceipt2 = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(txHash2)<span class="hljs-comment">;</span>
 timeoutCount += SLEEP_TIME<span class="hljs-comment">;</span>
 }
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"timeoutCount:\t"</span> + timeoutCount<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var txReceipt3 = await setMessageFunction<span class="hljs-preprocessor">.SendTransactionAndWaitForReceiptAsync</span>(fromAddress, new HexBigInteger(<span class="hljs-number">900000</span>), null, null, <span class="hljs-number">2</span>, nowTimestamp + <span class="hljs-string">" Wait"</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txReceipt3:\t"</span> + txReceipt3<span class="hljs-preprocessor">.TransactionHash</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txReceipt3:\t"</span> + txReceipt3<span class="hljs-preprocessor">.CumulativeGasUsed</span><span class="hljs-preprocessor">.Value</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var getResult1 = await getMessageFunction<span class="hljs-preprocessor">.CallAsync</span>&lt;string&gt;(<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"getResult1:\t"</span> + getResult1<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 var getResult2 = await getMessageFunction<span class="hljs-preprocessor">.CallAsync</span>&lt;string&gt;(<span class="hljs-number">2</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"getResult2:\t"</span> + getResult2<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }

static public async Task InteractWithExistingContractWithEventsExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"InteractWithExistingContractWithEventsExample:"</span>)<span class="hljs-comment">;</span>

var contract = web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetContract</span>(contractAbi, contractAddress)<span class="hljs-comment">;</span>

var setMessageFunction = contract<span class="hljs-preprocessor">.GetFunction</span>(<span class="hljs-string">"setMsg"</span>)<span class="hljs-comment">;</span>
 var getMessageFunction = contract<span class="hljs-preprocessor">.GetFunction</span>(<span class="hljs-string">"getMsg"</span>)<span class="hljs-comment">;</span>
 var multipliedEvent = contract<span class="hljs-preprocessor">.GetEvent</span>(<span class="hljs-string">"MultipliedEvent"</span>)<span class="hljs-comment">;</span>
 var newMessageEvent = contract<span class="hljs-preprocessor">.GetEvent</span>(<span class="hljs-string">"NewMessageEvent"</span>)<span class="hljs-comment">;</span>

var filterAllMultipliedEvent = await multipliedEvent<span class="hljs-preprocessor">.CreateFilterAsync</span>()<span class="hljs-comment">;</span>
 var filterAllNewMessageEvent = await newMessageEvent<span class="hljs-preprocessor">.CreateFilterAsync</span>()<span class="hljs-comment">;</span>

string nowTimestamp = DateTime<span class="hljs-preprocessor">.UtcNow</span><span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" UTC"</span><span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"now:\t"</span> + nowTimestamp)<span class="hljs-comment">;</span>

var unlockResult = await web3<span class="hljs-preprocessor">.Personal</span><span class="hljs-preprocessor">.UnlockAccount</span><span class="hljs-preprocessor">.SendRequestAsync</span>(fromAddress, fromPassword, UNLOCK_TIMEOUT)<span class="hljs-comment">;</span>
 var txHash1 = await setMessageFunction<span class="hljs-preprocessor">.SendTransactionAsync</span>(fromAddress, new HexBigInteger(<span class="hljs-number">900000</span>), null, <span class="hljs-number">1</span>, <span class="hljs-string">"Hello World"</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txHash1:\t"</span> + txHash1<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 var txHash2 = await setMessageFunction<span class="hljs-preprocessor">.SendTransactionAsync</span>(fromAddress, new HexBigInteger(<span class="hljs-number">900000</span>), null, <span class="hljs-number">2</span>, nowTimestamp)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txHash2:\t"</span> + txHash2<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var txReceipt2 = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(txHash2)<span class="hljs-comment">;</span>
 int timeoutCount = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 while (txReceipt2 == null &amp;&amp; timeoutCount &lt; MAX_TIMEOUT)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"Sleeping..."</span>)<span class="hljs-comment">;</span>
 Thread<span class="hljs-preprocessor">.Sleep</span>(SLEEP_TIME)<span class="hljs-comment">;</span>
 txReceipt2 = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Transactions</span><span class="hljs-preprocessor">.GetTransactionReceipt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(txHash2)<span class="hljs-comment">;</span>
 timeoutCount += SLEEP_TIME<span class="hljs-comment">;</span>
 }
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"timeoutCount:\t"</span> + timeoutCount<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var txReceipt3 = await setMessageFunction<span class="hljs-preprocessor">.SendTransactionAndWaitForReceiptAsync</span>(fromAddress, new HexBigInteger(<span class="hljs-number">900000</span>), null, null, <span class="hljs-number">2</span>, nowTimestamp + <span class="hljs-string">" Wait"</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txReceipt3:\t"</span> + txReceipt3<span class="hljs-preprocessor">.TransactionHash</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"txReceipt3:\t"</span> + txReceipt3<span class="hljs-preprocessor">.CumulativeGasUsed</span><span class="hljs-preprocessor">.Value</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var getResult1 = await getMessageFunction<span class="hljs-preprocessor">.CallAsync</span>&lt;string&gt;(<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"getResult1:\t"</span> + getResult1<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 var getResult2 = await getMessageFunction<span class="hljs-preprocessor">.CallAsync</span>&lt;string&gt;(<span class="hljs-number">2</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"getResult2:\t"</span> + getResult2<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

var logMultipliedEvents = await multipliedEvent<span class="hljs-preprocessor">.GetFilterChanges</span>&lt;FunctionOutputHelpers<span class="hljs-preprocessor">.MultipliedEventArgs</span>&gt;(filterAllMultipliedEvent)<span class="hljs-comment">;</span>
 foreach (var mea <span class="hljs-keyword">in</span> logMultipliedEvents)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"multipliedEvent:\t"</span> +
 mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.sender</span> + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.oldProduct</span><span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.value</span><span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.newProduct</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }

var logNewMessageEvents = await newMessageEvent<span class="hljs-preprocessor">.GetFilterChanges</span>&lt;FunctionOutputHelpers<span class="hljs-preprocessor">.NewMessageEventArgs</span>&gt;(filterAllNewMessageEvent)<span class="hljs-comment">;</span>
 foreach (var mea <span class="hljs-keyword">in</span> logNewMessageEvents)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"newMessageEvent:\t"</span> +
 mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.sender</span> + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.ind</span><span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.msg</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }
 }

static public async Task GetAllChangesExample(Web3 web3, string fromAddress, string fromPassword, string contractAddress, string contractAbi)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"GetAllChangesExample:"</span>)<span class="hljs-comment">;</span>

var contract = web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetContract</span>(contractAbi, contractAddress)<span class="hljs-comment">;</span>
 var newMessageEvent = contract<span class="hljs-preprocessor">.GetEvent</span>(<span class="hljs-string">"NewMessageEvent"</span>)<span class="hljs-comment">;</span>
 var filterAllNewMessageEvent = await newMessageEvent<span class="hljs-preprocessor">.CreateFilterAsync</span>(fromAddress)<span class="hljs-comment">;</span>
 var logNewMessageEvents = await newMessageEvent<span class="hljs-preprocessor">.GetAllChanges</span>&lt;FunctionOutputHelpers<span class="hljs-preprocessor">.NewMessageEventArgs</span>&gt;(filterAllNewMessageEvent)<span class="hljs-comment">;</span>
 foreach (var mea <span class="hljs-keyword">in</span> logNewMessageEvents)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"newMessageEvent:\t"</span> +
 mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.sender</span> + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.ind</span><span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + mea<span class="hljs-preprocessor">.Event</span><span class="hljs-preprocessor">.msg</span><span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>
 }
 }

static public async Task GetContractValuesHistoryUniqueOffsetValueExample(Web3 web3, string contractAddress, HexBigInteger recentBlockNumber, ulong numberBlocks, int offset)
 {
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"GetContractValuesHistoryUniqueOffsetValueExample:"</span>)<span class="hljs-comment">;</span>

string previousValue = <span class="hljs-string">""</span><span class="hljs-comment">;</span>
 for (ulong blockNumber = (ulong)recentBlockNumber<span class="hljs-preprocessor">.Value</span><span class="hljs-comment">; blockNumber &gt; (ulong)recentBlockNumber.Value - numberBlocks; blockNumber--)</span>
 {
 var blockNumberParameter = new Nethereum<span class="hljs-preprocessor">.RPC</span><span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.DTOs</span><span class="hljs-preprocessor">.BlockParameter</span>(blockNumber)<span class="hljs-comment">;</span>
 var valueAtOffset = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetStorageAt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(contractAddress, new HexBigInteger(offset), blockNumberParameter)<span class="hljs-comment">;</span>
 if (valueAtOffset != previousValue)
 {
 var block = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.Blocks</span><span class="hljs-preprocessor">.GetBlockWithTransactionsByNumber</span><span class="hljs-preprocessor">.SendRequestAsync</span>(blockNumberParameter)<span class="hljs-comment">;</span>
 DateTime blockDateTime = Helpers<span class="hljs-preprocessor">.UnixTimeStampToDateTime</span>((double)block<span class="hljs-preprocessor">.Timestamp</span><span class="hljs-preprocessor">.Value</span>)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"blockDateTime:\t"</span> + blockDateTime<span class="hljs-preprocessor">.ToString</span>())<span class="hljs-comment">;</span>

for (int storageOffset = <span class="hljs-number">0</span><span class="hljs-comment">; storageOffset &lt; offset+2; storageOffset++)</span>
 {
 var valueAt = await web3<span class="hljs-preprocessor">.Eth</span><span class="hljs-preprocessor">.GetStorageAt</span><span class="hljs-preprocessor">.SendRequestAsync</span>(contractAddress, new HexBigInteger(storageOffset), blockNumberParameter)<span class="hljs-comment">;</span>
 Console<span class="hljs-preprocessor">.WriteLine</span>(<span class="hljs-string">"value:\t"</span> + blockNumber<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + storageOffset<span class="hljs-preprocessor">.ToString</span>() + <span class="hljs-string">" "</span> + valueAt + <span class="hljs-string">" "</span> + Helpers<span class="hljs-preprocessor">.ConvertHex</span>(valueAt<span class="hljs-preprocessor">.Substring</span>(<span class="hljs-number">2</span>)))<span class="hljs-comment">;</span>
 }
 previousValue = valueAtOffset<span class="hljs-comment">;</span>
 }
 }
 }
 }
}</code></pre> 
  <p>以下是一些支持文件：</p> 
  <p>FunctionOutputHelpers.cs</p> 
  <pre class="prettyprint"><code class=" hljs cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Linq;
<span class="hljs-keyword">using</span> System.Text;
<span class="hljs-keyword">using</span> System.Threading.Tasks;

<span class="hljs-keyword">using</span> Nethereum.Web3;
<span class="hljs-keyword">using</span> Nethereum.ABI.FunctionEncoding.Attributes;

namespace MWH.MyNethereum.QuickRef
{
 <span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> FunctionOutputHelpers
 {
 <span class="hljs-comment">// event MultipliedEvent(</span>
 <span class="hljs-comment">// address indexed sender,</span>
 <span class="hljs-comment">// int oldProduct,</span>
 <span class="hljs-comment">// int value,</span>
 <span class="hljs-comment">// int newProduct</span>
 <span class="hljs-comment">// );</span>

[FunctionOutput]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> MultipliedEventArgs
 {
 [Parameter(<span class="hljs-string">"address"</span>, <span class="hljs-string">"sender"</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">true</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> sender { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

[Parameter(<span class="hljs-string">"int"</span>, <span class="hljs-string">"oldProduct"</span>, <span class="hljs-number">2</span>, <span class="hljs-keyword">false</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> oldProduct { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

[Parameter(<span class="hljs-string">"int"</span>, <span class="hljs-string">"value"</span>, <span class="hljs-number">3</span>, <span class="hljs-keyword">false</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-keyword">value</span> { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

[Parameter(<span class="hljs-string">"int"</span>, <span class="hljs-string">"newProduct"</span>, <span class="hljs-number">4</span>, <span class="hljs-keyword">false</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> newProduct { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

}

<span class="hljs-comment">//event NewMessageEvent(</span>
 <span class="hljs-comment">// address indexed sender,</span>
 <span class="hljs-comment">// uint256 indexed ind,</span>
 <span class="hljs-comment">// string msg</span>
 <span class="hljs-comment">//);</span>

[FunctionOutput]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> NewMessageEventArgs
 {
 [Parameter(<span class="hljs-string">"address"</span>, <span class="hljs-string">"sender"</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">true</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> sender { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

[Parameter(<span class="hljs-string">"uint256"</span>, <span class="hljs-string">"ind"</span>, <span class="hljs-number">2</span>, <span class="hljs-keyword">true</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> ind { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

[Parameter(<span class="hljs-string">"string"</span>, <span class="hljs-string">"msg"</span>, <span class="hljs-number">3</span>, <span class="hljs-keyword">false</span>)]
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> msg { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
 }
 }
}</code></pre> 
  <p>Helpers.cs</p> 
  <pre class="prettyprint"><code class=" hljs cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Linq;
<span class="hljs-keyword">using</span> System.Text;
<span class="hljs-keyword">using</span> System.Threading.Tasks;

namespace MWH.MyNethereum.QuickRef
{
 <span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> Helpers
 {
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">ConvertHex</span>(String hexString)
 {
 <span class="hljs-keyword">try</span>
 {
 <span class="hljs-keyword">string</span> ascii = <span class="hljs-keyword">string</span>.Empty;

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; hexString.Length; i += <span class="hljs-number">2</span>)
 {
 String hs = <span class="hljs-keyword">string</span>.Empty;

hs = hexString.Substring(i, <span class="hljs-number">2</span>);
 <span class="hljs-keyword">uint</span> decval = System.Convert.ToUInt32(hs, <span class="hljs-number">16</span>);
 <span class="hljs-keyword">char</span> character = System.Convert.ToChar(decval);
 ascii += character;

}

<span class="hljs-keyword">return</span> ascii;
 }
 <span class="hljs-keyword">catch</span> (Exception ex) { Console.WriteLine(ex.Message); }

<span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>.Empty;
 }

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DateTime <span class="hljs-title">UnixTimeStampToDateTime</span>(<span class="hljs-keyword">double</span> unixTimeStamp)
 {
 <span class="hljs-comment">// Unix timestamp is seconds past epoch</span>
 System.DateTime dtDateTime = <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">1970</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, System.DateTimeKind.Utc);
 dtDateTime = dtDateTime.AddSeconds(unixTimeStamp); <span class="hljs-comment">// .ToLocalTime();</span>
 <span class="hljs-keyword">return</span> dtDateTime;
 }

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DateTime <span class="hljs-title">JavaTimeStampToDateTime</span>(<span class="hljs-keyword">double</span> javaTimeStamp)
 {
 <span class="hljs-comment">// Java timestamp is milliseconds past epoch</span>
 System.DateTime dtDateTime = <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">1970</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, System.DateTimeKind.Utc);
 dtDateTime = dtDateTime.AddMilliseconds(javaTimeStamp); <span class="hljs-comment">// .ToLocalTime();</span>
 <span class="hljs-keyword">return</span> dtDateTime;
 }
 }
}</code></pre> 
  <p>以下是用于实施这些示例时使用的以太坊合约的Solidity代码：</p> 
  <p>Test3.sol</p> 
  <pre class="prettyprint"><code class=" hljs cs">pragma solidity <span class="hljs-number">0.4</span><span class="hljs-number">.19</span>;

contract Test3 {

<span class="hljs-keyword">int</span> <span class="hljs-keyword">public</span> _product;
<span class="hljs-keyword">string</span>[<span class="hljs-number">5</span>] _msgs;

<span class="hljs-keyword">event</span> MultipliedEvent(
address indexed sender,
<span class="hljs-keyword">int</span> oldProduct,
<span class="hljs-keyword">int</span> <span class="hljs-keyword">value</span>,
<span class="hljs-keyword">int</span> newProduct
);

<span class="hljs-keyword">event</span> NewMessageEvent(
address indexed sender,
uint256 indexed ind,
<span class="hljs-keyword">string</span> msg
);

function Test3() <span class="hljs-keyword">public</span> {
_product = <span class="hljs-number">1</span>;
}

function multiply(<span class="hljs-keyword">int</span> <span class="hljs-keyword">value</span>) <span class="hljs-keyword">public</span> <span class="hljs-title">returns</span>(<span class="hljs-keyword">int</span> product) {
<span class="hljs-keyword">int</span> old = _product;
_product = <span class="hljs-keyword">value</span> * _product;
MultipliedEvent( msg.sender, old, <span class="hljs-keyword">value</span>, _product );
<span class="hljs-keyword">return</span> _product;
}

function getProduct() <span class="hljs-keyword">public</span> constant <span class="hljs-title">returns</span>(<span class="hljs-keyword">int</span> product) {
<span class="hljs-keyword">return</span> _product;
}

function setMsg(uint256 i, <span class="hljs-keyword">string</span> m) <span class="hljs-keyword">public</span> <span class="hljs-title">returns</span>(uint256 mi) {
_msgs[i] = m;
NewMessageEvent( msg.sender, i, m);
<span class="hljs-keyword">return</span> -i;
}

function getMsg(uint256 index) <span class="hljs-keyword">public</span> constant <span class="hljs-title">returns</span>(<span class="hljs-keyword">string</span> m) {
<span class="hljs-keyword">return</span> _msgs[index];
}
}</code></pre> 
  <p>我觉得这是发布代码示例的一种相当简单粗暴的方式。有任何更好建议欢迎留言。</p> 
  <p>======================================================================</p> 
  <p>如果你想马上使用c#开发以太坊dapp，可以学习下面的教程：</p> 
  <p><a href="http://xc.hubwiz.com/course/5b6048c3c02e6b6a59171dee?affid=97csdn" rel="nofollow">C#以太坊</a>，主要讲解如何使用C#开发基于.Net的以太坊应用，包括账户管理、状态与交易、智能合约开发与交互、过滤器和事件等。</p> 
  <p>其他区块链教程：</p> 
  <blockquote> 
   <ul> 
    <li><a href="http://xc.hubwiz.com/course/5b36629bc02e6b6a59171de3?affid=97csdn" rel="nofollow">php以太坊</a>，主要是介绍使用php进行智能合约开发交互，进行账号创建、交易、转账、代币开发以及过滤器和事件等内容。</li> 
    <li><a href="http://xc.hubwiz.com/course/5b2b6e82c02e6b6a59171de2?affid=97csdn" rel="nofollow">web3j教程</a>，主要是针对java和android程序员进行区块链以太坊开发的web3j详解。</li> 
    <li><a href="http://xc.hubwiz.com/course/5a952991adb3847553d205d1?affid=97csdn" rel="nofollow">以太坊教程</a>，主要介绍智能合约与dapp应用开发，适合入门。</li> 
    <li><a href="http://xc.hubwiz.com/course/5abbb7acc02e6b6a59171dd6?affid=97csdn" rel="nofollow">以太坊开发</a>，主要是介绍使用node.js、mongodb、区块链、ipfs实现去中心化电商DApp实战，适合进阶。</li> 
    <li><a href="http://xc.hubwiz.com/course/5b40462cc02e6b6a59171de4?affid=97csdn" rel="nofollow">python以太坊</a>，主要是针对python工程师使用web3.py进行区块链以太坊开发的详解。</li> 
    <li><a href="http://xc.hubwiz.com/course/5b52c0a2c02e6b6a59171ded?affid=97csdn" rel="nofollow">EOS智能合约与DApp开发入门教程</a>，内容涵盖EOS工具链、账户与钱包、发行代币、智能合约开发与部署、使用代码与智能合约交互等核心知识点，最后运用react和各知识点完成一个便签DApp的开发。</li> 
   </ul> 
  </blockquote> 
  <p>汇智网原创翻译，转载请标明出处。这里是<a href="http://blog.hubwiz.com/2018/09/06/ethereum-Csharp-nethereum-demo/" rel="nofollow">原文</a></p> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/mongo_node/article/details/82490921,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/mongo_node/article/details/82490921,&quot;}">阅读更多</a> 
 <a class="btn" href="https://passport.csdn.net/account/login?utm_source=csdn_blog_pc_more_login" target="_self" id="btn-lobinreadmore" data-track-view="{&quot;mod&quot;:&quot;popu_557&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/mongo_node/article/details/82490921,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_557&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/mongo_node/article/details/82490921,&quot;}">登录后自动展开</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
