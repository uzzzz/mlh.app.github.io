<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>【ERC1155实践】欧阳询书法复制品从确权设计到买卖测试 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="【ERC1155实践】欧阳询书法复制品从确权设计到买卖测试" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="作者介绍 笔名辉哥 副总（赋能中心）尖晶投资 1，摘要 【本文目标】 通过本文学习，了解以太坊ERC1155标准规范和ERC1155Mintable可增发智能合约函数功能，并通过一个有趣的故事完成功能测试。 【前置条件】 1）对以太坊ERC20(同质化代币)，ERC721(非同质化代币)有所了解，对ERC1155有兴趣了解。 2） 懂得在REMIX调试SOLIDITY语言，不熟悉的参考文章《第十课 Solidity语言编辑器REMIX指导大全》。 #2， 概念介绍 ERC-1155的创造者是Enjin coin的CTO Witek Radomski。ERC1155标准定义了一种解决上述问题的新方法。现在“物品”（可能包含ERC20的token或ERC721的token或两者都有）可以被单一的一个合约（打包处理）来定义了。合约里包含区别token们所需的最小量的数据。好比，后来出现的视频压缩技术，后一帧只记录了与前一帧的不同之处，所以极大的压缩了整个视频的体积，合约的状态包含了每个token ID的配置信息和管理收集的所有行为。ERC-1155的灵活性更强，它使得开发者可以自行选择是批量生成某一种特定的token，还是构建不可被复制的惟一元数据。 更多描述参考文件《ERC-1155，未来游戏DApp的新一代token！》，可点击查看。 #3，代码分析 ERC1155协议主要包括ERC1155Mintable.sol同质化可增发智能合约和ERC1155NonFungibleMintable.sol非同质化可增发智能合约，本章只讲解同质化可增发智能合约的功能。 ##3.1 代码引用 点击可获取ERC1155Mintable.sol的完整代码和依赖代码。 辉哥此处给出在REMIX编译环境能够编译运行的合约代码，对引用合约给出了绝对路径，以便能够在REMIX能够编译成功并可以单步调试。 pragma solidity ^0.4.24; //import &quot;./ERC1155.sol&quot;; import &#39;https://github.com/enjin/erc-1155/contracts/ERC1155.sol&#39;; /** @dev Mintable form of ERC1155 Shows how easy it is to mint new items */ contract ERC1155Mintable is ERC1155 { mapping (uint256 =&gt; address) public minters; uint256 public nonce; modifier minterOnly(uint256 _id) { require(minters[_id] == msg.sender); _; } function mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol) external returns(uint256 _id) { _id = ++nonce; minters[_id] = msg.sender; // items[_id].name = _name; items[_id].totalSupply = _totalSupply; metadataURIs[_id] = _uri; decimals[_id] = _decimals; symbols[_id] = _symbol; // Grant the items to the minter items[_id].balances[msg.sender] = _totalSupply; } function setURI(uint256 _id, string _uri) external minterOnly(_id) { metadataURIs[_id] = _uri; } } ##3.2 ERC1155Mintable.sol类图函数说明 主要函数功能说明： 1） mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol) 增发同质化通证 2）approve(address _spender, uint256 _id, uint256 _currentValue, uint256 _value) 授权给_spender账户一定额度的编号为 _id的同质化通证，_currentValue为当前已授权额度； 3）transferFrom(address _from, address _to, uint256 _id, uint256 _value) 拥有者从 _from地址给 _to地址转账授权范围内的一定额度的一类同质化通证； 4）balanceOf(uint256 _id, address _owner) 拥有者_owner的 _id同质化通证的余额； 5）allowance(uint256 _id, address _owner, address _spender) 拥有者 _owner给消费者_spender在当前查询账户授权(approve)的额度； 6）batchApprove(address _spender, uint256[] _ids, uint256[] _currentValues, uint256[] _values) 批量授权给_spender[]一组账户一定额度_values[]的编号为_ids[]的同质化通证，_currentValue[]为当前已授权额度，这几个数组的长度要严格对齐； 7）batchTransferFrom(address _from, address _to, uint256[] _ids, uint256[] _values) 拥有者从 _from地址给 _to地址转账授权范围内的一定额度_values[]的各类编号为_ids[]的各类同质化通证； 8） -batchTransfer(address _to, uint256[] _ids, uint256[] _values) 批量给目标账号_to转账各类编号为_ids[]的各类数额分别是_values[]的各类同质化通证； 9）multicastTransfer(address[] _to, uint256[] _ids, uint256[] _values) 当前账号批量给目标地址组合_to[]分别转移额度为_values[]的各类编号为_ids[]的同质化通证。 #4，买卖测试 为了更形象的说明ERC1155 可增发智能合约的功能，辉哥和欧阳哥哥，ELLA配合来完成本故事。 话说欧阳哥哥近期想入手仁恒滨江的大平层房子一套，但目前现金不够。欧阳哥哥想起家有祖上唐初书法家欧阳询知名作品《皇甫诞碑》，《九成宫》，《仲尼梦奠帖》三幅。原作是无论如何也不能出售的，那能否限量制作若干复制品，通过区块链技术进行资产确权来完成限量销售呢。 ##4.1 欧阳哥哥创建智能合约 说干就干，欧阳在REMIX欢迎编译“ERC1155Mintable.sol”成功后，点击“Create”按钮完成“ERC1155Mintable”智能合约的创建。 说明： 欧阳哥哥的以太坊地址为“0xca35b7d915458ef540ade6068dfe2f44e8fa733c”，合约由此账号创建成功。 ##4.2 欧阳哥哥增发三作品的数字资产 在欧阳哥哥&quot; 0xca35b7d915458ef540ade6068dfe2f44e8fa733c &quot;账户下运行mint()函数，完成三作品的数字资产发布。 mint(&quot;HuangPuDanBei&quot;, 5, &quot;http://img688.ph.126.net/AQpGPSuvKQUJJnQO5OOovg==/1159958379025162213.jpg&quot;, 0, &quot;HPDB&quot;) mint(&quot;JiuChengGong&quot;, 200, &quot;http://image106.360doc.com/DownloadImg/2017/06/0600/101000542_3.jpg&quot;, 0, &quot;JCG&quot;) mint(&quot;ZhongNiMengDianTie&quot;, 1000000, &quot;http://img8.ph.126.net/hIyr_YwiPqSmDTImf_KEUw==/6597582139075295968.jpg&quot;, 0, &quot;ZNMDT&quot;) 发布成功截图说明： 结果验证： name(1) name(2) name(3) 输入id为1,2,3到name函数获取通证的名称分别是&quot;HuangPuDanBei&quot;,“JiuChengGong”,“ZhongNiMengDianTie” 结果截图： ##4.3 辉哥购买2幅名作复制品 辉哥最近在币圈小赚一笔，急切想提高下自己的艺术修养，知道欧阳哥哥卖画后，毫不犹豫的转给了欧阳100个BTC，希望能先把复制品收入囊中。 在欧阳哥哥&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;账户下,运行批量转账函数,把“皇甫诞碑”，“九成宫”转账给辉哥账号 “0x14723a09acff6d2a60dcdf7aa4aff308fddc160c”。 batchTransfer(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, [1,2], [1,1]) 转账截图： 结果验证： 查询辉哥账户的余额查询函数，获取结果分别为1,1,0,转账成功。 balanceOf(1,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 结果截图： ##4.3 辉哥当了代理商 辉哥拿到复制品作品在朋友圈一炫，结果一堆好友打听作品的购买出处。辉哥觉得这应该是一笔好生意，就跟欧阳哥哥谈起来代理合作的生意。 欧阳哥哥对辉哥还是挺信任的，决定先把辉哥购买的“皇甫诞碑”，“九成宫”让他做代理看看，于是就给他设置了各1幅的权限。 1）第一次代理授权 在欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;账户下,运行批量授权函数，授权给辉哥&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;， 把ID为1,2的画作通证资产授权给辉哥,数量分别为1,1。其当前授权值为0,0。 batchApprove(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, [1,2], [0,0], [1,1]) 结果验证 allowance(1, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(2, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(3, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0,验证成功。 2）第二次代理授权 辉哥经过分析评估，希望欧阳哥哥能把“九成宫”授权数量调整为2，欧阳哥哥也答应了。 欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;授权辉哥&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;的Id为2（“九成宫”作品）的资产数量为2（原授权数量为1） approve(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, 2, 1, 2） 把ID为2的通证资产授权给user2,授权累计数量分别为2。其当前授权值为1。 结果验证 allowance(1, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(2, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(3, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。 ##4.4 辉哥出售画作给ELLA 有一天，辉哥跟币圈新锐ELLA见了面，ELLA对欧阳家的画作很有兴趣，愿意从辉哥处购买“皇甫诞碑”，“九成宫”各一幅。 辉哥账户下，批量从欧阳哥哥&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;转账给ELLA &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;的Id为[1,2]的资产数量为[1,1] batchTransferFrom(&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;, [1,2], [1,1]) 代理商转账： 结果验证： balanceOf(1, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(2, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(3, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0。 ##4.5 辉哥买下授权的“九成宫”画作 画作的生意做得越来越顺，辉哥觉得直接把已授权的“九成宫”买下来算了。 在辉哥账号下，从欧阳账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;转账给辉哥自己 &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;的Id为2的资产数量为1，把已授权的“九成宫”剩余画作买下来。 transferFrom(&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, 2, 1) 结果查询 balanceOf(1, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。 ##4.6 欧阳哥哥同时卖画给辉哥和ELLA ELLA对所得作品非常喜欢，希望直接找欧阳哥哥买，不想让辉哥做代理商赚差价。辉哥竟然也同意了。有一天，2人一起到欧阳哥哥处，分别购买了“九成宫”作品3幅，“仲尼梦奠帖”作品3幅。 在欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;下，批量转账给辉哥账号&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, ELLA账号&quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;的Id为2，3（“九成宫”，“仲尼梦奠帖”）的资产数量各3,3幅。 multicastTransfer([&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;,&quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;], [2,3], [3,3]) 执行如下： 结果验证： balanceOf(1, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,5,0 balanceOf(1, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(2, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(3, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,3。 ##4.7 业务流程总结 用流程图画出上面的业务流程，如下： 【画外音】 至此，欧阳哥哥已卖出11幅，所得收入1100个BTC，轻松把仁恒滨江的房子收入囊中。辉哥和ELLA对入手的画作也非常满意，付出的BTC可以再从市场上赚回来嘛，况且现在处于市场低点，正式建仓的好时机。 #5，参考 1） ERC1155提案提交-GITHUB 2） ERC1155Mintable.sol合约源码 3）ERC-1155，未来游戏DApp的新一代token！ 本文章测试故事纯属虚构，欧阳哥哥不会复制欧阳询书法作品用于改善生活的。 添加微信（cdong1024），加入区块链开发者技术交流群 虫洞社区：https://www.uzanapp.com/ 阅读更多" />
<meta property="og:description" content="作者介绍 笔名辉哥 副总（赋能中心）尖晶投资 1，摘要 【本文目标】 通过本文学习，了解以太坊ERC1155标准规范和ERC1155Mintable可增发智能合约函数功能，并通过一个有趣的故事完成功能测试。 【前置条件】 1）对以太坊ERC20(同质化代币)，ERC721(非同质化代币)有所了解，对ERC1155有兴趣了解。 2） 懂得在REMIX调试SOLIDITY语言，不熟悉的参考文章《第十课 Solidity语言编辑器REMIX指导大全》。 #2， 概念介绍 ERC-1155的创造者是Enjin coin的CTO Witek Radomski。ERC1155标准定义了一种解决上述问题的新方法。现在“物品”（可能包含ERC20的token或ERC721的token或两者都有）可以被单一的一个合约（打包处理）来定义了。合约里包含区别token们所需的最小量的数据。好比，后来出现的视频压缩技术，后一帧只记录了与前一帧的不同之处，所以极大的压缩了整个视频的体积，合约的状态包含了每个token ID的配置信息和管理收集的所有行为。ERC-1155的灵活性更强，它使得开发者可以自行选择是批量生成某一种特定的token，还是构建不可被复制的惟一元数据。 更多描述参考文件《ERC-1155，未来游戏DApp的新一代token！》，可点击查看。 #3，代码分析 ERC1155协议主要包括ERC1155Mintable.sol同质化可增发智能合约和ERC1155NonFungibleMintable.sol非同质化可增发智能合约，本章只讲解同质化可增发智能合约的功能。 ##3.1 代码引用 点击可获取ERC1155Mintable.sol的完整代码和依赖代码。 辉哥此处给出在REMIX编译环境能够编译运行的合约代码，对引用合约给出了绝对路径，以便能够在REMIX能够编译成功并可以单步调试。 pragma solidity ^0.4.24; //import &quot;./ERC1155.sol&quot;; import &#39;https://github.com/enjin/erc-1155/contracts/ERC1155.sol&#39;; /** @dev Mintable form of ERC1155 Shows how easy it is to mint new items */ contract ERC1155Mintable is ERC1155 { mapping (uint256 =&gt; address) public minters; uint256 public nonce; modifier minterOnly(uint256 _id) { require(minters[_id] == msg.sender); _; } function mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol) external returns(uint256 _id) { _id = ++nonce; minters[_id] = msg.sender; // items[_id].name = _name; items[_id].totalSupply = _totalSupply; metadataURIs[_id] = _uri; decimals[_id] = _decimals; symbols[_id] = _symbol; // Grant the items to the minter items[_id].balances[msg.sender] = _totalSupply; } function setURI(uint256 _id, string _uri) external minterOnly(_id) { metadataURIs[_id] = _uri; } } ##3.2 ERC1155Mintable.sol类图函数说明 主要函数功能说明： 1） mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol) 增发同质化通证 2）approve(address _spender, uint256 _id, uint256 _currentValue, uint256 _value) 授权给_spender账户一定额度的编号为 _id的同质化通证，_currentValue为当前已授权额度； 3）transferFrom(address _from, address _to, uint256 _id, uint256 _value) 拥有者从 _from地址给 _to地址转账授权范围内的一定额度的一类同质化通证； 4）balanceOf(uint256 _id, address _owner) 拥有者_owner的 _id同质化通证的余额； 5）allowance(uint256 _id, address _owner, address _spender) 拥有者 _owner给消费者_spender在当前查询账户授权(approve)的额度； 6）batchApprove(address _spender, uint256[] _ids, uint256[] _currentValues, uint256[] _values) 批量授权给_spender[]一组账户一定额度_values[]的编号为_ids[]的同质化通证，_currentValue[]为当前已授权额度，这几个数组的长度要严格对齐； 7）batchTransferFrom(address _from, address _to, uint256[] _ids, uint256[] _values) 拥有者从 _from地址给 _to地址转账授权范围内的一定额度_values[]的各类编号为_ids[]的各类同质化通证； 8） -batchTransfer(address _to, uint256[] _ids, uint256[] _values) 批量给目标账号_to转账各类编号为_ids[]的各类数额分别是_values[]的各类同质化通证； 9）multicastTransfer(address[] _to, uint256[] _ids, uint256[] _values) 当前账号批量给目标地址组合_to[]分别转移额度为_values[]的各类编号为_ids[]的同质化通证。 #4，买卖测试 为了更形象的说明ERC1155 可增发智能合约的功能，辉哥和欧阳哥哥，ELLA配合来完成本故事。 话说欧阳哥哥近期想入手仁恒滨江的大平层房子一套，但目前现金不够。欧阳哥哥想起家有祖上唐初书法家欧阳询知名作品《皇甫诞碑》，《九成宫》，《仲尼梦奠帖》三幅。原作是无论如何也不能出售的，那能否限量制作若干复制品，通过区块链技术进行资产确权来完成限量销售呢。 ##4.1 欧阳哥哥创建智能合约 说干就干，欧阳在REMIX欢迎编译“ERC1155Mintable.sol”成功后，点击“Create”按钮完成“ERC1155Mintable”智能合约的创建。 说明： 欧阳哥哥的以太坊地址为“0xca35b7d915458ef540ade6068dfe2f44e8fa733c”，合约由此账号创建成功。 ##4.2 欧阳哥哥增发三作品的数字资产 在欧阳哥哥&quot; 0xca35b7d915458ef540ade6068dfe2f44e8fa733c &quot;账户下运行mint()函数，完成三作品的数字资产发布。 mint(&quot;HuangPuDanBei&quot;, 5, &quot;http://img688.ph.126.net/AQpGPSuvKQUJJnQO5OOovg==/1159958379025162213.jpg&quot;, 0, &quot;HPDB&quot;) mint(&quot;JiuChengGong&quot;, 200, &quot;http://image106.360doc.com/DownloadImg/2017/06/0600/101000542_3.jpg&quot;, 0, &quot;JCG&quot;) mint(&quot;ZhongNiMengDianTie&quot;, 1000000, &quot;http://img8.ph.126.net/hIyr_YwiPqSmDTImf_KEUw==/6597582139075295968.jpg&quot;, 0, &quot;ZNMDT&quot;) 发布成功截图说明： 结果验证： name(1) name(2) name(3) 输入id为1,2,3到name函数获取通证的名称分别是&quot;HuangPuDanBei&quot;,“JiuChengGong”,“ZhongNiMengDianTie” 结果截图： ##4.3 辉哥购买2幅名作复制品 辉哥最近在币圈小赚一笔，急切想提高下自己的艺术修养，知道欧阳哥哥卖画后，毫不犹豫的转给了欧阳100个BTC，希望能先把复制品收入囊中。 在欧阳哥哥&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;账户下,运行批量转账函数,把“皇甫诞碑”，“九成宫”转账给辉哥账号 “0x14723a09acff6d2a60dcdf7aa4aff308fddc160c”。 batchTransfer(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, [1,2], [1,1]) 转账截图： 结果验证： 查询辉哥账户的余额查询函数，获取结果分别为1,1,0,转账成功。 balanceOf(1,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 结果截图： ##4.3 辉哥当了代理商 辉哥拿到复制品作品在朋友圈一炫，结果一堆好友打听作品的购买出处。辉哥觉得这应该是一笔好生意，就跟欧阳哥哥谈起来代理合作的生意。 欧阳哥哥对辉哥还是挺信任的，决定先把辉哥购买的“皇甫诞碑”，“九成宫”让他做代理看看，于是就给他设置了各1幅的权限。 1）第一次代理授权 在欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;账户下,运行批量授权函数，授权给辉哥&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;， 把ID为1,2的画作通证资产授权给辉哥,数量分别为1,1。其当前授权值为0,0。 batchApprove(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, [1,2], [0,0], [1,1]) 结果验证 allowance(1, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(2, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(3, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0,验证成功。 2）第二次代理授权 辉哥经过分析评估，希望欧阳哥哥能把“九成宫”授权数量调整为2，欧阳哥哥也答应了。 欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;授权辉哥&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;的Id为2（“九成宫”作品）的资产数量为2（原授权数量为1） approve(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, 2, 1, 2） 把ID为2的通证资产授权给user2,授权累计数量分别为2。其当前授权值为1。 结果验证 allowance(1, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(2, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(3, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。 ##4.4 辉哥出售画作给ELLA 有一天，辉哥跟币圈新锐ELLA见了面，ELLA对欧阳家的画作很有兴趣，愿意从辉哥处购买“皇甫诞碑”，“九成宫”各一幅。 辉哥账户下，批量从欧阳哥哥&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;转账给ELLA &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;的Id为[1,2]的资产数量为[1,1] batchTransferFrom(&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;, [1,2], [1,1]) 代理商转账： 结果验证： balanceOf(1, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(2, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(3, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0。 ##4.5 辉哥买下授权的“九成宫”画作 画作的生意做得越来越顺，辉哥觉得直接把已授权的“九成宫”买下来算了。 在辉哥账号下，从欧阳账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;转账给辉哥自己 &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;的Id为2的资产数量为1，把已授权的“九成宫”剩余画作买下来。 transferFrom(&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, 2, 1) 结果查询 balanceOf(1, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。 ##4.6 欧阳哥哥同时卖画给辉哥和ELLA ELLA对所得作品非常喜欢，希望直接找欧阳哥哥买，不想让辉哥做代理商赚差价。辉哥竟然也同意了。有一天，2人一起到欧阳哥哥处，分别购买了“九成宫”作品3幅，“仲尼梦奠帖”作品3幅。 在欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;下，批量转账给辉哥账号&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, ELLA账号&quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;的Id为2，3（“九成宫”，“仲尼梦奠帖”）的资产数量各3,3幅。 multicastTransfer([&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;,&quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;], [2,3], [3,3]) 执行如下： 结果验证： balanceOf(1, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,5,0 balanceOf(1, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(2, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(3, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,3。 ##4.7 业务流程总结 用流程图画出上面的业务流程，如下： 【画外音】 至此，欧阳哥哥已卖出11幅，所得收入1100个BTC，轻松把仁恒滨江的房子收入囊中。辉哥和ELLA对入手的画作也非常满意，付出的BTC可以再从市场上赚回来嘛，况且现在处于市场低点，正式建仓的好时机。 #5，参考 1） ERC1155提案提交-GITHUB 2） ERC1155Mintable.sol合约源码 3）ERC-1155，未来游戏DApp的新一代token！ 本文章测试故事纯属虚构，欧阳哥哥不会复制欧阳询书法作品用于改善生活的。 添加微信（cdong1024），加入区块链开发者技术交流群 虫洞社区：https://www.uzanapp.com/ 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-09-22T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"作者介绍 笔名辉哥 副总（赋能中心）尖晶投资 1，摘要 【本文目标】 通过本文学习，了解以太坊ERC1155标准规范和ERC1155Mintable可增发智能合约函数功能，并通过一个有趣的故事完成功能测试。 【前置条件】 1）对以太坊ERC20(同质化代币)，ERC721(非同质化代币)有所了解，对ERC1155有兴趣了解。 2） 懂得在REMIX调试SOLIDITY语言，不熟悉的参考文章《第十课 Solidity语言编辑器REMIX指导大全》。 #2， 概念介绍 ERC-1155的创造者是Enjin coin的CTO Witek Radomski。ERC1155标准定义了一种解决上述问题的新方法。现在“物品”（可能包含ERC20的token或ERC721的token或两者都有）可以被单一的一个合约（打包处理）来定义了。合约里包含区别token们所需的最小量的数据。好比，后来出现的视频压缩技术，后一帧只记录了与前一帧的不同之处，所以极大的压缩了整个视频的体积，合约的状态包含了每个token ID的配置信息和管理收集的所有行为。ERC-1155的灵活性更强，它使得开发者可以自行选择是批量生成某一种特定的token，还是构建不可被复制的惟一元数据。 更多描述参考文件《ERC-1155，未来游戏DApp的新一代token！》，可点击查看。 #3，代码分析 ERC1155协议主要包括ERC1155Mintable.sol同质化可增发智能合约和ERC1155NonFungibleMintable.sol非同质化可增发智能合约，本章只讲解同质化可增发智能合约的功能。 ##3.1 代码引用 点击可获取ERC1155Mintable.sol的完整代码和依赖代码。 辉哥此处给出在REMIX编译环境能够编译运行的合约代码，对引用合约给出了绝对路径，以便能够在REMIX能够编译成功并可以单步调试。 pragma solidity ^0.4.24; //import &quot;./ERC1155.sol&quot;; import &#39;https://github.com/enjin/erc-1155/contracts/ERC1155.sol&#39;; /** @dev Mintable form of ERC1155 Shows how easy it is to mint new items */ contract ERC1155Mintable is ERC1155 { mapping (uint256 =&gt; address) public minters; uint256 public nonce; modifier minterOnly(uint256 _id) { require(minters[_id] == msg.sender); _; } function mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol) external returns(uint256 _id) { _id = ++nonce; minters[_id] = msg.sender; // items[_id].name = _name; items[_id].totalSupply = _totalSupply; metadataURIs[_id] = _uri; decimals[_id] = _decimals; symbols[_id] = _symbol; // Grant the items to the minter items[_id].balances[msg.sender] = _totalSupply; } function setURI(uint256 _id, string _uri) external minterOnly(_id) { metadataURIs[_id] = _uri; } } ##3.2 ERC1155Mintable.sol类图函数说明 主要函数功能说明： 1） mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol) 增发同质化通证 2）approve(address _spender, uint256 _id, uint256 _currentValue, uint256 _value) 授权给_spender账户一定额度的编号为 _id的同质化通证，_currentValue为当前已授权额度； 3）transferFrom(address _from, address _to, uint256 _id, uint256 _value) 拥有者从 _from地址给 _to地址转账授权范围内的一定额度的一类同质化通证； 4）balanceOf(uint256 _id, address _owner) 拥有者_owner的 _id同质化通证的余额； 5）allowance(uint256 _id, address _owner, address _spender) 拥有者 _owner给消费者_spender在当前查询账户授权(approve)的额度； 6）batchApprove(address _spender, uint256[] _ids, uint256[] _currentValues, uint256[] _values) 批量授权给_spender[]一组账户一定额度_values[]的编号为_ids[]的同质化通证，_currentValue[]为当前已授权额度，这几个数组的长度要严格对齐； 7）batchTransferFrom(address _from, address _to, uint256[] _ids, uint256[] _values) 拥有者从 _from地址给 _to地址转账授权范围内的一定额度_values[]的各类编号为_ids[]的各类同质化通证； 8） -batchTransfer(address _to, uint256[] _ids, uint256[] _values) 批量给目标账号_to转账各类编号为_ids[]的各类数额分别是_values[]的各类同质化通证； 9）multicastTransfer(address[] _to, uint256[] _ids, uint256[] _values) 当前账号批量给目标地址组合_to[]分别转移额度为_values[]的各类编号为_ids[]的同质化通证。 #4，买卖测试 为了更形象的说明ERC1155 可增发智能合约的功能，辉哥和欧阳哥哥，ELLA配合来完成本故事。 话说欧阳哥哥近期想入手仁恒滨江的大平层房子一套，但目前现金不够。欧阳哥哥想起家有祖上唐初书法家欧阳询知名作品《皇甫诞碑》，《九成宫》，《仲尼梦奠帖》三幅。原作是无论如何也不能出售的，那能否限量制作若干复制品，通过区块链技术进行资产确权来完成限量销售呢。 ##4.1 欧阳哥哥创建智能合约 说干就干，欧阳在REMIX欢迎编译“ERC1155Mintable.sol”成功后，点击“Create”按钮完成“ERC1155Mintable”智能合约的创建。 说明： 欧阳哥哥的以太坊地址为“0xca35b7d915458ef540ade6068dfe2f44e8fa733c”，合约由此账号创建成功。 ##4.2 欧阳哥哥增发三作品的数字资产 在欧阳哥哥&quot; 0xca35b7d915458ef540ade6068dfe2f44e8fa733c &quot;账户下运行mint()函数，完成三作品的数字资产发布。 mint(&quot;HuangPuDanBei&quot;, 5, &quot;http://img688.ph.126.net/AQpGPSuvKQUJJnQO5OOovg==/1159958379025162213.jpg&quot;, 0, &quot;HPDB&quot;) mint(&quot;JiuChengGong&quot;, 200, &quot;http://image106.360doc.com/DownloadImg/2017/06/0600/101000542_3.jpg&quot;, 0, &quot;JCG&quot;) mint(&quot;ZhongNiMengDianTie&quot;, 1000000, &quot;http://img8.ph.126.net/hIyr_YwiPqSmDTImf_KEUw==/6597582139075295968.jpg&quot;, 0, &quot;ZNMDT&quot;) 发布成功截图说明： 结果验证： name(1) name(2) name(3) 输入id为1,2,3到name函数获取通证的名称分别是&quot;HuangPuDanBei&quot;,“JiuChengGong”,“ZhongNiMengDianTie” 结果截图： ##4.3 辉哥购买2幅名作复制品 辉哥最近在币圈小赚一笔，急切想提高下自己的艺术修养，知道欧阳哥哥卖画后，毫不犹豫的转给了欧阳100个BTC，希望能先把复制品收入囊中。 在欧阳哥哥&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;账户下,运行批量转账函数,把“皇甫诞碑”，“九成宫”转账给辉哥账号 “0x14723a09acff6d2a60dcdf7aa4aff308fddc160c”。 batchTransfer(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, [1,2], [1,1]) 转账截图： 结果验证： 查询辉哥账户的余额查询函数，获取结果分别为1,1,0,转账成功。 balanceOf(1,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3,&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 结果截图： ##4.3 辉哥当了代理商 辉哥拿到复制品作品在朋友圈一炫，结果一堆好友打听作品的购买出处。辉哥觉得这应该是一笔好生意，就跟欧阳哥哥谈起来代理合作的生意。 欧阳哥哥对辉哥还是挺信任的，决定先把辉哥购买的“皇甫诞碑”，“九成宫”让他做代理看看，于是就给他设置了各1幅的权限。 1）第一次代理授权 在欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;账户下,运行批量授权函数，授权给辉哥&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;， 把ID为1,2的画作通证资产授权给辉哥,数量分别为1,1。其当前授权值为0,0。 batchApprove(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, [1,2], [0,0], [1,1]) 结果验证 allowance(1, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(2, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(3, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0,验证成功。 2）第二次代理授权 辉哥经过分析评估，希望欧阳哥哥能把“九成宫”授权数量调整为2，欧阳哥哥也答应了。 欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;授权辉哥&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;的Id为2（“九成宫”作品）的资产数量为2（原授权数量为1） approve(&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, 2, 1, 2） 把ID为2的通证资产授权给user2,授权累计数量分别为2。其当前授权值为1。 结果验证 allowance(1, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(2, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) allowance(3, &quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。 ##4.4 辉哥出售画作给ELLA 有一天，辉哥跟币圈新锐ELLA见了面，ELLA对欧阳家的画作很有兴趣，愿意从辉哥处购买“皇甫诞碑”，“九成宫”各一幅。 辉哥账户下，批量从欧阳哥哥&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;转账给ELLA &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;的Id为[1,2]的资产数量为[1,1] batchTransferFrom(&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;, [1,2], [1,1]) 代理商转账： 结果验证： balanceOf(1, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(2, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(3, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0。 ##4.5 辉哥买下授权的“九成宫”画作 画作的生意做得越来越顺，辉哥觉得直接把已授权的“九成宫”买下来算了。 在辉哥账号下，从欧阳账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;转账给辉哥自己 &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;的Id为2的资产数量为1，把已授权的“九成宫”剩余画作买下来。 transferFrom(&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, 2, 1) 结果查询 balanceOf(1, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。 ##4.6 欧阳哥哥同时卖画给辉哥和ELLA ELLA对所得作品非常喜欢，希望直接找欧阳哥哥买，不想让辉哥做代理商赚差价。辉哥竟然也同意了。有一天，2人一起到欧阳哥哥处，分别购买了“九成宫”作品3幅，“仲尼梦奠帖”作品3幅。 在欧阳哥哥账号&quot;0xca35b7d915458ef540ade6068dfe2f44e8fa733c&quot;下，批量转账给辉哥账号&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;, ELLA账号&quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;的Id为2，3（“九成宫”，“仲尼梦奠帖”）的资产数量各3,3幅。 multicastTransfer([&quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;,&quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;], [2,3], [3,3]) 执行如下： 结果验证： balanceOf(1, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(2, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) balanceOf(3, &quot;0x14723a09acff6d2a60dcdf7aa4aff308fddc160c&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,5,0 balanceOf(1, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(2, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) balanceOf(3, &quot;0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db&quot;) 查询资产ID为1,2,3的授权资产数量，余额分别为1,1,3。 ##4.7 业务流程总结 用流程图画出上面的业务流程，如下： 【画外音】 至此，欧阳哥哥已卖出11幅，所得收入1100个BTC，轻松把仁恒滨江的房子收入囊中。辉哥和ELLA对入手的画作也非常满意，付出的BTC可以再从市场上赚回来嘛，况且现在处于市场低点，正式建仓的好时机。 #5，参考 1） ERC1155提案提交-GITHUB 2） ERC1155Mintable.sol合约源码 3）ERC-1155，未来游戏DApp的新一代token！ 本文章测试故事纯属虚构，欧阳哥哥不会复制欧阳询书法作品用于改善生活的。 添加微信（cdong1024），加入区块链开发者技术交流群 虫洞社区：https://www.uzanapp.com/ 阅读更多","@type":"BlogPosting","url":"/2018/09/22/5f9657d89ae8970e384396902e7825ff.html","headline":"【ERC1155实践】欧阳询书法复制品从确权设计到买卖测试","dateModified":"2018-09-22T00:00:00+08:00","datePublished":"2018-09-22T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/09/22/5f9657d89ae8970e384396902e7825ff.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>【ERC1155实践】欧阳询书法复制品从确权设计到买卖测试</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/a08d382f577b826deecd0c3d36af6e98" alt=""></p> 
  <h3><a id="_1"></a>作者介绍</h3> 
  <p>笔名辉哥 副总（赋能中心）尖晶投资</p> 
  <h1><a id="1_3"></a>1，摘要</h1> 
  <p><strong>【本文目标】</strong><br> 通过本文学习，了解以太坊ERC1155标准规范和ERC1155Mintable可增发智能合约函数功能，并通过一个有趣的故事完成功能测试。</p> 
  <p><strong>【前置条件】</strong><br> 1）对以太坊ERC20(同质化代币)，ERC721(非同质化代币)有所了解，对ERC1155有兴趣了解。<br> 2） 懂得在REMIX调试SOLIDITY语言，不熟悉的参考文章<a href="https://www.jianshu.com/p/2110ed61d2cc" rel="nofollow">《第十课 Solidity语言编辑器REMIX指导大全》</a>。</p> 
  <p>#2， 概念介绍<br> ERC-1155的创造者是Enjin coin的CTO Witek Radomski。ERC1155标准定义了一种解决上述问题的新方法。现在“物品”（可能包含ERC20的token或ERC721的token或两者都有）可以被单一的一个合约（打包处理）来定义了。合约里包含区别token们所需的最小量的数据。好比，后来出现的视频压缩技术，后一帧只记录了与前一帧的不同之处，所以极大的压缩了整个视频的体积，合约的状态包含了每个token ID的配置信息和管理收集的所有行为。ERC-1155的灵活性更强，它使得开发者可以自行选择是批量生成某一种特定的token，还是构建不可被复制的惟一元数据。<br> 更多描述参考文件<a href="http://baijiahao.baidu.com/s?id=1604713768750901244&amp;wfr=spider&amp;for=pc" rel="nofollow">《ERC-1155，未来游戏DApp的新一代token！》</a>，可点击查看。</p> 
  <p>#3，代码分析<br> ERC1155协议主要包括ERC1155Mintable.sol同质化可增发智能合约和ERC1155NonFungibleMintable.sol非同质化可增发智能合约，本章只讲解同质化可增发智能合约的功能。<br> ##3.1 代码引用<br> <a href="https://github.com/enjin/erc-1155/blob/master/contracts/ERC1155Mintable.sol" rel="nofollow">点击可获取ERC1155Mintable.sol的完整代码和依赖代码</a>。<br> 辉哥此处给出在REMIX编译环境能够编译运行的合约代码，对引用合约给出了绝对路径，以便能够在REMIX能够编译成功并可以单步调试。</p> 
  <pre><code>pragma solidity ^0.4.24;

//import "./ERC1155.sol";
import 'https://github.com/enjin/erc-1155/contracts/ERC1155.sol';

/**
    @dev Mintable form of ERC1155
    Shows how easy it is to mint new items
*/
contract ERC1155Mintable is ERC1155 {
    mapping (uint256 =&gt; address) public minters;
    uint256 public nonce;

    modifier minterOnly(uint256 _id) {
        require(minters[_id] == msg.sender);
        _;
    }

    function mint(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol)
    external returns(uint256 _id) {
        _id = ++nonce;
        minters[_id] = msg.sender; //

        items[_id].name = _name;
        items[_id].totalSupply = _totalSupply;
        metadataURIs[_id] = _uri;
        decimals[_id] = _decimals;
        symbols[_id] = _symbol;

        // Grant the items to the minter
        items[_id].balances[msg.sender] = _totalSupply;
    }

    function setURI(uint256 _id, string _uri) external minterOnly(_id) {
        metadataURIs[_id] = _uri;
    }
}

</code></pre> 
  <p>##3.2 ERC1155Mintable.sol类图函数说明<br> <img src="https://cdn.ktvsky.com/1536644259719/2fe8c1dfe358381d7b42e12ff768fa7b" alt="ERC1155Mintable.sol类图"></p> 
  <p><strong>主要函数功能说明：</strong><br> <strong>1） mint</strong>(string _name, uint256 _totalSupply, string _uri, uint8 _decimals, string _symbol)<br> 增发同质化通证<br> <strong>2）approve</strong>(address _spender, uint256 _id, uint256 _currentValue, uint256 _value)<br> 授权给_spender账户一定额度的编号为 _id的同质化通证，_currentValue为当前已授权额度；<br> <strong>3）transferFrom</strong>(address _from, address _to, uint256 _id, uint256 _value)<br> 拥有者从 _from地址给 _to地址转账授权范围内的一定额度的一类同质化通证；<br> <strong>4）balanceOf</strong>(uint256 _id, address _owner)<br> 拥有者_owner的 _id同质化通证的余额；<br> <strong>5）allowance</strong>(uint256 _id, address _owner, address _spender)<br> 拥有者 _owner给消费者_spender在当前查询账户授权(approve)的额度；<br> <strong>6）batchApprove</strong>(address _spender, uint256[] _ids, uint256[] _currentValues, uint256[] _values)<br> 批量授权给_spender[]一组账户一定额度_values[]的编号为_ids[]的同质化通证，_currentValue[]为当前已授权额度，这几个数组的长度要严格对齐；<br> <strong>7）batchTransferFrom</strong>(address _from, address _to, uint256[] _ids, uint256[] _values)<br> 拥有者从 _from地址给 _to地址转账授权范围内的一定额度_values[]的各类编号为_ids[]的各类同质化通证；<br> <strong>8） -batchTransfer</strong>(address _to, uint256[] _ids, uint256[] _values)<br> 批量给目标账号_to转账各类编号为_ids[]的各类数额分别是_values[]的各类同质化通证；<br> <strong>9）multicastTransfer</strong>(address[] _to, uint256[] _ids, uint256[] _values)<br> 当前账号批量给目标地址组合_to[]分别转移额度为_values[]的各类编号为_ids[]的同质化通证。</p> 
  <p>#4，买卖测试<br> 为了更形象的说明ERC1155 可增发智能合约的功能，辉哥和欧阳哥哥，ELLA配合来完成本故事。<br> <img src="https://cdn.ktvsky.com/1536644259719/e29372f983adb07d24b65b42108386f6" alt="欧阳询头像"></p> 
  <p>话说欧阳哥哥近期想入手仁恒滨江的大平层房子一套，但目前现金不够。欧阳哥哥想起家有祖上<strong>唐初书法家欧阳询</strong>知名作品<a href="http://img688.ph.126.net/AQpGPSuvKQUJJnQO5OOovg==/1159958379025162213.jpg" rel="nofollow">《皇甫诞碑》</a>，<a href="http://image106.360doc.com/DownloadImg/2017/06/0600/101000542_3.jpg" rel="nofollow">《九成宫》</a>，<a href="http://img8.ph.126.net/hIyr_YwiPqSmDTImf_KEUw==/6597582139075295968.jpg" rel="nofollow">《仲尼梦奠帖》</a>三幅。原作是无论如何也不能出售的，那能否限量制作若干复制品，通过区块链技术进行资产确权来完成限量销售呢。<br> <img src="https://cdn.ktvsky.com/1536644259719/1b00592b46b45d942fb3e761eddac445" alt="皇甫诞碑"></p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/ee178e426cd0a635cec4de08011504be" alt="九成宫"></p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/e905ab68e64ace8aea8ed8c98628e195" alt="仲尼梦奠帖"></p> 
  <p>##4.1 欧阳哥哥创建智能合约<br> 说干就干，欧阳在REMIX欢迎编译“ERC1155Mintable.sol”成功后，点击“Create”按钮完成“ERC1155Mintable”智能合约的创建。<br> <strong>说明：</strong><br> 欧阳哥哥的以太坊地址为“0xca35b7d915458ef540ade6068dfe2f44e8fa733c”，合约由此账号创建成功。</p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/9fc09bc19f4247ece6043544b2f1e7bc" alt="1. 创建ERC1155智能合约"></p> 
  <p>##4.2 欧阳哥哥增发三作品的数字资产<br> 在欧阳哥哥" 0xca35b7d915458ef540ade6068dfe2f44e8fa733c "账户下运行mint()函数，完成三作品的数字资产发布。</p> 
  <pre><code>mint("HuangPuDanBei", 5, "http://img688.ph.126.net/AQpGPSuvKQUJJnQO5OOovg==/1159958379025162213.jpg", 0, "HPDB")
mint("JiuChengGong", 200, "http://image106.360doc.com/DownloadImg/2017/06/0600/101000542_3.jpg", 0, "JCG")
mint("ZhongNiMengDianTie", 1000000, "http://img8.ph.126.net/hIyr_YwiPqSmDTImf_KEUw==/6597582139075295968.jpg", 0, "ZNMDT")
</code></pre> 
  <p>发布成功截图说明：</p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/e04de10bf9320600470eb58318e49a26" alt="2. 发布三类资产"></p> 
  <p><strong>结果验证：</strong></p> 
  <pre><code>name(1)
name(2)
name(3)
</code></pre> 
  <p>输入id为1,2,3到name函数获取通证的名称分别是"HuangPuDanBei",“JiuChengGong”,“ZhongNiMengDianTie”<br> <strong>结果截图：</strong></p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/64def27a3a7f85f60ea35b02dc8c1cd6" alt="3. 查询资产名称"></p> 
  <p>##4.3 辉哥购买2幅名作复制品<br> 辉哥最近在币圈小赚一笔，急切想提高下自己的艺术修养，知道欧阳哥哥卖画后，毫不犹豫的转给了欧阳100个BTC，希望能先把复制品收入囊中。<br> 在欧阳哥哥"0xca35b7d915458ef540ade6068dfe2f44e8fa733c"账户下,运行批量转账函数,把“皇甫诞碑”，“九成宫”转账给辉哥账号 “0x14723a09acff6d2a60dcdf7aa4aff308fddc160c”。</p> 
  <pre><code>batchTransfer("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c", [1,2], [1,1])
</code></pre> 
  <p>转账截图：</p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/2ffef09da9a5b9d76f8756cf4ad3639e" alt="4. 批量转账"></p> 
  <p><strong>结果验证：</strong><br> 查询辉哥账户的余额查询函数，获取结果分别为1,1,0,转账成功。</p> 
  <pre><code>balanceOf(1,"0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
balanceOf(2,"0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
balanceOf(3,"0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
</code></pre> 
  <p><strong>结果截图：</strong></p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/5cd7239848730466320f890a5500d63e" alt="5. 转账结果"></p> 
  <p>##4.3 辉哥当了代理商<br> 辉哥拿到复制品作品在朋友圈一炫，结果一堆好友打听作品的购买出处。辉哥觉得这应该是一笔好生意，就跟欧阳哥哥谈起来代理合作的生意。<br> 欧阳哥哥对辉哥还是挺信任的，决定先把辉哥购买的“皇甫诞碑”，“九成宫”让他做代理看看，于是就给他设置了各1幅的权限。</p> 
  <p><strong>1）第一次代理授权</strong><br> 在欧阳哥哥账号"0xca35b7d915458ef540ade6068dfe2f44e8fa733c"账户下,运行批量授权函数，授权给辉哥"0x14723a09acff6d2a60dcdf7aa4aff308fddc160c"，<br> 把ID为1,2的画作通证资产授权给辉哥,数量分别为1,1。其当前授权值为0,0。</p> 
  <pre><code>batchApprove("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c", [1,2], [0,0], [1,1])
</code></pre> 
  <p><strong>结果验证</strong></p> 
  <pre><code>allowance(1, "0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
allowance(2, "0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
allowance(3, "0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
</code></pre> 
  <p>查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0,验证成功。</p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/653440b0ed37376ff373e82acfa6bb8c" alt="6. 授权结果"></p> 
  <p><strong>2）第二次代理授权</strong><br> 辉哥经过分析评估，希望欧阳哥哥能把“九成宫”授权数量调整为2，欧阳哥哥也答应了。<br> 欧阳哥哥账号"0xca35b7d915458ef540ade6068dfe2f44e8fa733c"授权辉哥"0x14723a09acff6d2a60dcdf7aa4aff308fddc160c"的Id为2（“九成宫”作品）的资产数量为2（原授权数量为1）</p> 
  <pre><code>approve("0x14723a09acff6d2a60dcdf7aa4aff308fddc160c", 2, 1, 2）
</code></pre> 
  <p>把ID为2的通证资产授权给user2,授权累计数量分别为2。其当前授权值为1。<br> <strong>结果验证</strong></p> 
  <pre><code>allowance(1, "0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
allowance(2, "0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
allowance(3, "0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
</code></pre> 
  <p>查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。</p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/49319063440667e38734557bdf95469c" alt="7. 重新查询授权数量"></p> 
  <p>##4.4 辉哥出售画作给ELLA<br> 有一天，辉哥跟币圈新锐ELLA见了面，ELLA对欧阳家的画作很有兴趣，愿意从辉哥处购买“皇甫诞碑”，“九成宫”各一幅。<br> 辉哥账户下，批量从欧阳哥哥"0xca35b7d915458ef540ade6068dfe2f44e8fa733c"转账给ELLA "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db"的Id为[1,2]的资产数量为[1,1]</p> 
  <pre><code>batchTransferFrom("0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db", [1,2], [1,1])
</code></pre> 
  <p>代理商转账：<br> <img src="https://cdn.ktvsky.com/1536644259719/963d6c5bd2d722c6d516ae3e71048fc6" alt="8. 代理转账"><br> <strong>结果验证：</strong></p> 
  <pre><code>balanceOf(1, "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db")
balanceOf(2, "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db")
balanceOf(3, "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db")
</code></pre> 
  <p>查询资产ID为1,2,3的授权资产数量，余额分别为1,1,0。</p> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/72ff59670b4293d91bb533a3511ae89c" alt="9.ELLA账户余额查询"></p> 
  <p>##4.5 辉哥买下授权的“九成宫”画作<br> 画作的生意做得越来越顺，辉哥觉得直接把已授权的“九成宫”买下来算了。<br> 在辉哥账号下，从欧阳账号"0xca35b7d915458ef540ade6068dfe2f44e8fa733c"转账给辉哥自己 "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c"的Id为2的资产数量为1，把已授权的“九成宫”剩余画作买下来。</p> 
  <pre><code>transferFrom("0xca35b7d915458ef540ade6068dfe2f44e8fa733c", "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c", 2, 1)
</code></pre> 
  <p><img src="https://cdn.ktvsky.com/1536644259719/e60ed56e2577ac33db84e84d1b41b833" alt="10.代理商买下画作"></p> 
  <p><strong>结果查询</strong></p> 
  <pre><code>balanceOf(1, "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
balanceOf(2, "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
balanceOf(3, "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
</code></pre> 
  <p>查询资产ID为1,2,3的授权资产数量，余额分别为1,2,0。<br> <img src="https://cdn.ktvsky.com/1536644259719/1cfdc23df5805492ba634674f7607c36" alt="11. 代理商余额查询"></p> 
  <p>##4.6 欧阳哥哥同时卖画给辉哥和ELLA<br> ELLA对所得作品非常喜欢，希望直接找欧阳哥哥买，不想让辉哥做代理商赚差价。辉哥竟然也同意了。有一天，2人一起到欧阳哥哥处，分别购买了“九成宫”作品3幅，“仲尼梦奠帖”作品3幅。<br> 在欧阳哥哥账号"0xca35b7d915458ef540ade6068dfe2f44e8fa733c"下，批量转账给辉哥账号"0x14723a09acff6d2a60dcdf7aa4aff308fddc160c",<br> ELLA账号"0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db"的Id为2，3（“九成宫”，“仲尼梦奠帖”）的资产数量各3,3幅。</p> 
  <pre><code>multicastTransfer(["0x14723a09acff6d2a60dcdf7aa4aff308fddc160c","0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db"], [2,3], [3,3])
</code></pre> 
  <p>执行如下：<br> <img src="https://cdn.ktvsky.com/1536644259719/a8f1124a525c4dbcd7e3479fbcb5a04d" alt="12.批量给多人转让"></p> 
  <p><strong>结果验证：</strong></p> 
  <pre><code>balanceOf(1, "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
balanceOf(2, "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
balanceOf(3, "0x14723a09acff6d2a60dcdf7aa4aff308fddc160c")
</code></pre> 
  <p>查询资产ID为1,2,3的授权资产数量，余额分别为1,5,0</p> 
  <pre><code>balanceOf(1, "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db")
balanceOf(2, "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db")
balanceOf(3, "0x4b0897b0513fdc7c541b6d9d7e929c4e5364d2db")
</code></pre> 
  <p>查询资产ID为1,2,3的授权资产数量，余额分别为1,1,3。</p> 
  <p>##4.7 业务流程总结<br> 用流程图画出上面的业务流程，如下：<br> <img src="https://cdn.ktvsky.com/1536644259719/f656f30fc51d4145d14ace6735b44a2c" alt="ERC1155测试流程图"></p> 
  <p><strong>【画外音】</strong><br> 至此，欧阳哥哥已卖出11幅，所得收入1100个BTC，轻松把仁恒滨江的房子收入囊中。辉哥和ELLA对入手的画作也非常满意，付出的BTC可以再从市场上赚回来嘛，况且现在处于市场低点，正式建仓的好时机。</p> 
  <p>#5，参考<br> 1） <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1155.md" rel="nofollow">ERC1155提案提交-GITHUB</a><br> 2） <a href="https://github.com/enjin/erc-1155/blob/master/contracts/ERC1155Mintable.sol" rel="nofollow">ERC1155Mintable.sol合约源码</a><br> 3）<a href="http://baijiahao.baidu.com/s?id=1604713768750901244&amp;wfr=spider&amp;for=pc" rel="nofollow">ERC-1155，未来游戏DApp的新一代token！</a></p> 
  <p><em>本文章测试故事纯属虚构，欧阳哥哥不会复制欧阳询书法作品用于改善生活的。</em></p> 
  <h4><a id="cdong1024_258"></a>添加微信（cdong1024），加入区块链开发者技术交流群</h4> 
  <h4><a id="httpswwwuzanappcom_259"></a>虫洞社区：<a href="https://www.uzanapp.com/" rel="nofollow">https://www.uzanapp.com/</a></h4> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180922103906891?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI0OTMzOQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-8cccb36679.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/weixin_43249339/article/details/82810747,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/weixin_43249339/article/details/82810747,&quot;}">阅读更多</a> 
 <!-- <a class="btn" href="https://passport.csdn.net/account/login?utm_source=csdn_blog_pc_more_login" target="_self" id="btn-lobinreadmore" data-track-view='{"mod":"popu_557","con":",https://blog.csdn.net/weixin_43249339/article/details/82810747,"}' data-track-click='{"mod":"popu_557","con":",https://blog.csdn.net/weixin_43249339/article/details/82810747,"}'>登录后自动展开</a> --> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
