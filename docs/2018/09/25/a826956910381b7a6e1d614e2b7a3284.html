<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>手动构建hyperledger fabric网络 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="手动构建hyperledger fabric网络" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="环境：mac os 准备： Docker: 先注册docker hub的一个账号-&gt;docker hub 下载安装docker下载地址 使用之前注册好的账号进行登入 切换镜像源，推荐使用daocloude注册地址(具体更换方法自行百度吧) ps: docker for mac 不需要单独在安装docker-compose, centos 或者 ubuntu 需要单独进行安装 Go: 这个肯定不用说了~~~ 相信您已经安装了 安装指南 使用 Hyperledger fabric 1.0.5构建一个简单的网络 1、创建项目目录 mkdir -p $GOPATH/src/github.com/chainHero/heroes-service-network 2、这里为了简化部署网络部署，提供了二进制文件，方便安装 仓库地址： (Linux x64 ): cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; git clone https://github.com/chainHero/heroes-service-network/branches/master/bin ps：这个地址貌似有点问题所以提供了下面的下载链接，解压后将整个bin目录移动到 之前建好的目录中 Linux AMD 64 Windows AMD 64 Darwin AMD 64 3、我们要知道我们的网络由那些东西组成所以需要一个配置文件，配置文件包含网络拓扑，并根据组织和组件生成证书和秘钥 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch crypto-config.yaml &amp;&amp; vim crypto-config.yaml 并将下面的内容复制到crypto-config.yaml 文件中 （文件内容申明了我们的网络有一个组织和两个peer 节点） # &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes OrdererOrgs: - Name: ChainHero Domain: hf.chainhero.io # Specs is an array of Spec entries. Each Spec entry consists of two fields : Hostname and CommonName Specs: - Hostname: orderer # &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes PeerOrgs: - Name: Org1ChainHero Domain: org1.hf.chainhero.io # Allows for the definition of 1 or more hosts that are created sequentially # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1. # You may override the number of nodes (Count), the starting index (Start) # or the template used to construct the name (Hostname). Template: Count: 2 Users: # The number of user accounts _in addition_ to Admin Count: 2 4、使用Cryptogen 生成加密材料 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p crypto-config &amp;&amp; ./bin/cryptogen generate --config=./crypto-config.yaml 这时候crypto-config下就多了两个文件夹 5、为了初始化我们的网络我们还需要做一下操作： 创世区块 channel 配置交易生成器 继续我们的操作 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch configtx.yaml &amp;&amp; vim configtx.yaml 将一下内容复制到configtx.yaml 中 ################################################################################ # # SECTION : Profile # # - Different configuration profiles may be encoded here to be specified # as parameters to the configtxgen tool. The profiles which specify consortiums # are to be used for generating the orderer genesis block. With the correct # consortium members defined in the orderer genesis block, channel creation # requests may be generated with only the org member names and a consortium name # ################################################################################ Profiles: ChainHero: Orderer: &lt;&lt;: *OrdererDefaults Organizations: - *ChainHero Application: &lt;&lt;: *ApplicationDefaults Organizations: - *Org1ChainHero Consortium: SampleConsortium Consortiums: SampleConsortium: Organizations: - *ChainHero - *Org1ChainHero ################################################################################ # # SECTION: Organizations # # - This section defines the different organizational identities which will # be referenced later in the configuration. # ################################################################################ Organizations: - &amp;ChainHero Name: ChainHero ID: hf.chainhero.io AdminPrincipal: Role.ADMIN MSPDir: crypto-config/ordererOrganizations/hf.chainhero.io/msp - &amp;Org1ChainHero Name: ChainHeroOrganization1 ID: org1.hf.chainhero.io AdminPrincipal: Role.ADMIN MSPDir: crypto-config/peerOrganizations/org1.hf.chainhero.io/msp AnchorPeers: - Host: peer0.org1.hf.chainhero.io Port: 7051 ################################################################################ # # SECTION: Orderer # # - This section defines the values to encode into a config transaction or # genesis block for orderer related parameters. # ################################################################################ Orderer: &amp;OrdererDefaults OrdererType: solo Addresses: - orderer.hf.chainhero.io:7050 BatchTimeout: 5s # Batch Size: Controls the number of messages batched into a block. BatchSize: # Max Message Count: The maximum number of messages to permit in a batch. MaxMessageCount: 10 # Absolute Max Bytes: The absolute maximum number of bytes allowed for # the serialized messages in a batch. If the &quot;kafka&quot; OrdererType is # selected, set &#39;message.max.bytes&#39; and &#39;replica.fetch.max.bytes&#39; on the # Kafka brokers to a value that is larger than this one. AbsoluteMaxBytes: 98 MB # Preferred Max Bytes: The preferred maximum number of bytes allowed for # the serialized messages in a batch. A message larger than the # preferred max bytes will result in a batch larger than preferred max # bytes. PreferredMaxBytes: 512 KB # Max Channels is the maximum number of channels to allow on the ordering # network. When set to 0, this implies no maximum number of channels. MaxChannels: 0 # Organizations is the list of orgs which are defined as participants on # the orderer side of the network. Organizations: ################################################################################ # # SECTION: Application # # - This section defines the values to encode into a config transaction or # genesis block for application related parameters. # ################################################################################ Application: &amp;ApplicationDefaults Organizations: 配置文件已经生成好了，我们需要用configtxgen 来生成我们的创世区块 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p artifacts cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputBlock ./artifacts/orderer.genesis.block 创建我们的channel FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputCreateChannelTx ./artifacts/chainhero.channel.tx -channelID chainhero 配置交易生成器 FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputAnchorPeersUpdate ./artifacts/org1.chainhero.anchors.tx -channelID chainhero -asOrg ChainHeroOrganization1 区块链网络我们已经搭建完成了，接下来是怎么启动他们~~~ 我们使用docker-compose来启动创建一个docker-compose.yaml文件 version: &#39;2&#39; networks: default: services: orderer.hf.chainhero.io: image: hyperledger/fabric-orderer:x86_64-1.0.5 container_name: orderer.hf.chainhero.io environment: - ORDERER_GENERAL_LOGLEVEL=debug - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0 - ORDERER_GENERAL_LISTENPORT=7050 - ORDERER_GENERAL_GENESISPROFILE=ChainHero - ORDERER_GENERAL_GENESISMETHOD=file - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block - ORDERER_GENERAL_LOCALMSPID=hf.chainhero.io - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp - ORDERER_GENERAL_TLS_ENABLED=true - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt] working_dir: /opt/gopath/src/github.com/hyperledger/fabric command: orderer volumes: - ./artifacts/orderer.genesis.block:/var/hyperledger/orderer/orderer.genesis.block - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/msp:/var/hyperledger/orderer/msp - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/tls:/var/hyperledger/orderer/tls ports: - 7050:7050 networks: default: aliases: - orderer.hf.chainhero.io ca.org1.hf.chainhero.io: image: hyperledger/fabric-ca:x86_64-1.0.5 container_name: ca.org1.hf.chainhero.io environment: - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server - FABRIC_CA_SERVER_CA_NAME=ca.org1.hf.chainhero.io - FABRIC_CA_SERVER_CA_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem - FABRIC_CA_SERVER_CA_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE-- - FABRIC_CA_SERVER_TLS_ENABLED=true - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE-- ports: - 7054:7054 command: sh -c &#39;fabric-ca-server start -b admin:adminpw -d&#39; volumes: - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/:/etc/hyperledger/fabric-ca-server-config networks: default: aliases: - ca.org1.hf.chainhero.io peer0.org1.hf.chainhero.io: image: hyperledger/fabric-peer:x86_64-1.0.5 container_name: peer0.org1.hf.chainhero.io environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_VM_DOCKER_ATTACHSTDOUT=true - CORE_LOGGING_LEVEL=DEBUG - CORE_PEER_NETWORKID=chainhero - CORE_PEER_PROFILE_ENABLED=true - CORE_PEER_TLS_ENABLED=true - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt - CORE_PEER_ID=peer0.org1.hf.chainhero.io - CORE_PEER_ADDRESSAUTODETECT=true - CORE_PEER_ADDRESS=peer0.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_USELEADERELECTION=true - CORE_PEER_GOSSIP_ORGLEADER=false - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer0.org1.hf.chainhero.io working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer command: peer node start volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/msp:/var/hyperledger/msp - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/tls:/var/hyperledger/tls ports: - 7051:7051 - 7053:7053 depends_on: - orderer.hf.chainhero.io links: - orderer.hf.chainhero.io networks: default: aliases: - peer0.org1.hf.chainhero.io peer1.org1.hf.chainhero.io: image: hyperledger/fabric-peer:x86_64-1.0.5 container_name: peer1.org1.hf.chainhero.io environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_VM_DOCKER_ATTACHSTDOUT=true - CORE_LOGGING_LEVEL=DEBUG - CORE_PEER_NETWORKID=chainhero - CORE_PEER_PROFILE_ENABLED=true - CORE_PEER_TLS_ENABLED=true - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt - CORE_PEER_ID=peer1.org1.hf.chainhero.io - CORE_PEER_ADDRESSAUTODETECT=true - CORE_PEER_ADDRESS=peer1.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_USELEADERELECTION=true - CORE_PEER_GOSSIP_ORGLEADER=false - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer1.org1.hf.chainhero.io working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer command: peer node start volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/msp:/var/hyperledger/msp - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/tls:/var/hyperledger/tls ports: - 8051:7051 - 8053:7053 depends_on: - orderer.hf.chainhero.io links: - orderer.hf.chainhero.io networks: default: aliases: - peer1.org1.hf.chainhero.io 这需要改动一点东西： 将内容中的 --HERE--替换为heroes-service-network/crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/xxxx_sk 这里的xxxx_sk图中的文件名 启动网络： cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; docker-compose up -d 查看容器是否都启动了 第一部分已经完成 墙的那边：参考链接 阅读更多" />
<meta property="og:description" content="环境：mac os 准备： Docker: 先注册docker hub的一个账号-&gt;docker hub 下载安装docker下载地址 使用之前注册好的账号进行登入 切换镜像源，推荐使用daocloude注册地址(具体更换方法自行百度吧) ps: docker for mac 不需要单独在安装docker-compose, centos 或者 ubuntu 需要单独进行安装 Go: 这个肯定不用说了~~~ 相信您已经安装了 安装指南 使用 Hyperledger fabric 1.0.5构建一个简单的网络 1、创建项目目录 mkdir -p $GOPATH/src/github.com/chainHero/heroes-service-network 2、这里为了简化部署网络部署，提供了二进制文件，方便安装 仓库地址： (Linux x64 ): cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; git clone https://github.com/chainHero/heroes-service-network/branches/master/bin ps：这个地址貌似有点问题所以提供了下面的下载链接，解压后将整个bin目录移动到 之前建好的目录中 Linux AMD 64 Windows AMD 64 Darwin AMD 64 3、我们要知道我们的网络由那些东西组成所以需要一个配置文件，配置文件包含网络拓扑，并根据组织和组件生成证书和秘钥 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch crypto-config.yaml &amp;&amp; vim crypto-config.yaml 并将下面的内容复制到crypto-config.yaml 文件中 （文件内容申明了我们的网络有一个组织和两个peer 节点） # &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes OrdererOrgs: - Name: ChainHero Domain: hf.chainhero.io # Specs is an array of Spec entries. Each Spec entry consists of two fields : Hostname and CommonName Specs: - Hostname: orderer # &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes PeerOrgs: - Name: Org1ChainHero Domain: org1.hf.chainhero.io # Allows for the definition of 1 or more hosts that are created sequentially # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1. # You may override the number of nodes (Count), the starting index (Start) # or the template used to construct the name (Hostname). Template: Count: 2 Users: # The number of user accounts _in addition_ to Admin Count: 2 4、使用Cryptogen 生成加密材料 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p crypto-config &amp;&amp; ./bin/cryptogen generate --config=./crypto-config.yaml 这时候crypto-config下就多了两个文件夹 5、为了初始化我们的网络我们还需要做一下操作： 创世区块 channel 配置交易生成器 继续我们的操作 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch configtx.yaml &amp;&amp; vim configtx.yaml 将一下内容复制到configtx.yaml 中 ################################################################################ # # SECTION : Profile # # - Different configuration profiles may be encoded here to be specified # as parameters to the configtxgen tool. The profiles which specify consortiums # are to be used for generating the orderer genesis block. With the correct # consortium members defined in the orderer genesis block, channel creation # requests may be generated with only the org member names and a consortium name # ################################################################################ Profiles: ChainHero: Orderer: &lt;&lt;: *OrdererDefaults Organizations: - *ChainHero Application: &lt;&lt;: *ApplicationDefaults Organizations: - *Org1ChainHero Consortium: SampleConsortium Consortiums: SampleConsortium: Organizations: - *ChainHero - *Org1ChainHero ################################################################################ # # SECTION: Organizations # # - This section defines the different organizational identities which will # be referenced later in the configuration. # ################################################################################ Organizations: - &amp;ChainHero Name: ChainHero ID: hf.chainhero.io AdminPrincipal: Role.ADMIN MSPDir: crypto-config/ordererOrganizations/hf.chainhero.io/msp - &amp;Org1ChainHero Name: ChainHeroOrganization1 ID: org1.hf.chainhero.io AdminPrincipal: Role.ADMIN MSPDir: crypto-config/peerOrganizations/org1.hf.chainhero.io/msp AnchorPeers: - Host: peer0.org1.hf.chainhero.io Port: 7051 ################################################################################ # # SECTION: Orderer # # - This section defines the values to encode into a config transaction or # genesis block for orderer related parameters. # ################################################################################ Orderer: &amp;OrdererDefaults OrdererType: solo Addresses: - orderer.hf.chainhero.io:7050 BatchTimeout: 5s # Batch Size: Controls the number of messages batched into a block. BatchSize: # Max Message Count: The maximum number of messages to permit in a batch. MaxMessageCount: 10 # Absolute Max Bytes: The absolute maximum number of bytes allowed for # the serialized messages in a batch. If the &quot;kafka&quot; OrdererType is # selected, set &#39;message.max.bytes&#39; and &#39;replica.fetch.max.bytes&#39; on the # Kafka brokers to a value that is larger than this one. AbsoluteMaxBytes: 98 MB # Preferred Max Bytes: The preferred maximum number of bytes allowed for # the serialized messages in a batch. A message larger than the # preferred max bytes will result in a batch larger than preferred max # bytes. PreferredMaxBytes: 512 KB # Max Channels is the maximum number of channels to allow on the ordering # network. When set to 0, this implies no maximum number of channels. MaxChannels: 0 # Organizations is the list of orgs which are defined as participants on # the orderer side of the network. Organizations: ################################################################################ # # SECTION: Application # # - This section defines the values to encode into a config transaction or # genesis block for application related parameters. # ################################################################################ Application: &amp;ApplicationDefaults Organizations: 配置文件已经生成好了，我们需要用configtxgen 来生成我们的创世区块 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p artifacts cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputBlock ./artifacts/orderer.genesis.block 创建我们的channel FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputCreateChannelTx ./artifacts/chainhero.channel.tx -channelID chainhero 配置交易生成器 FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputAnchorPeersUpdate ./artifacts/org1.chainhero.anchors.tx -channelID chainhero -asOrg ChainHeroOrganization1 区块链网络我们已经搭建完成了，接下来是怎么启动他们~~~ 我们使用docker-compose来启动创建一个docker-compose.yaml文件 version: &#39;2&#39; networks: default: services: orderer.hf.chainhero.io: image: hyperledger/fabric-orderer:x86_64-1.0.5 container_name: orderer.hf.chainhero.io environment: - ORDERER_GENERAL_LOGLEVEL=debug - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0 - ORDERER_GENERAL_LISTENPORT=7050 - ORDERER_GENERAL_GENESISPROFILE=ChainHero - ORDERER_GENERAL_GENESISMETHOD=file - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block - ORDERER_GENERAL_LOCALMSPID=hf.chainhero.io - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp - ORDERER_GENERAL_TLS_ENABLED=true - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt] working_dir: /opt/gopath/src/github.com/hyperledger/fabric command: orderer volumes: - ./artifacts/orderer.genesis.block:/var/hyperledger/orderer/orderer.genesis.block - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/msp:/var/hyperledger/orderer/msp - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/tls:/var/hyperledger/orderer/tls ports: - 7050:7050 networks: default: aliases: - orderer.hf.chainhero.io ca.org1.hf.chainhero.io: image: hyperledger/fabric-ca:x86_64-1.0.5 container_name: ca.org1.hf.chainhero.io environment: - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server - FABRIC_CA_SERVER_CA_NAME=ca.org1.hf.chainhero.io - FABRIC_CA_SERVER_CA_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem - FABRIC_CA_SERVER_CA_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE-- - FABRIC_CA_SERVER_TLS_ENABLED=true - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE-- ports: - 7054:7054 command: sh -c &#39;fabric-ca-server start -b admin:adminpw -d&#39; volumes: - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/:/etc/hyperledger/fabric-ca-server-config networks: default: aliases: - ca.org1.hf.chainhero.io peer0.org1.hf.chainhero.io: image: hyperledger/fabric-peer:x86_64-1.0.5 container_name: peer0.org1.hf.chainhero.io environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_VM_DOCKER_ATTACHSTDOUT=true - CORE_LOGGING_LEVEL=DEBUG - CORE_PEER_NETWORKID=chainhero - CORE_PEER_PROFILE_ENABLED=true - CORE_PEER_TLS_ENABLED=true - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt - CORE_PEER_ID=peer0.org1.hf.chainhero.io - CORE_PEER_ADDRESSAUTODETECT=true - CORE_PEER_ADDRESS=peer0.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_USELEADERELECTION=true - CORE_PEER_GOSSIP_ORGLEADER=false - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer0.org1.hf.chainhero.io working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer command: peer node start volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/msp:/var/hyperledger/msp - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/tls:/var/hyperledger/tls ports: - 7051:7051 - 7053:7053 depends_on: - orderer.hf.chainhero.io links: - orderer.hf.chainhero.io networks: default: aliases: - peer0.org1.hf.chainhero.io peer1.org1.hf.chainhero.io: image: hyperledger/fabric-peer:x86_64-1.0.5 container_name: peer1.org1.hf.chainhero.io environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_VM_DOCKER_ATTACHSTDOUT=true - CORE_LOGGING_LEVEL=DEBUG - CORE_PEER_NETWORKID=chainhero - CORE_PEER_PROFILE_ENABLED=true - CORE_PEER_TLS_ENABLED=true - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt - CORE_PEER_ID=peer1.org1.hf.chainhero.io - CORE_PEER_ADDRESSAUTODETECT=true - CORE_PEER_ADDRESS=peer1.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_USELEADERELECTION=true - CORE_PEER_GOSSIP_ORGLEADER=false - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer1.org1.hf.chainhero.io working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer command: peer node start volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/msp:/var/hyperledger/msp - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/tls:/var/hyperledger/tls ports: - 8051:7051 - 8053:7053 depends_on: - orderer.hf.chainhero.io links: - orderer.hf.chainhero.io networks: default: aliases: - peer1.org1.hf.chainhero.io 这需要改动一点东西： 将内容中的 --HERE--替换为heroes-service-network/crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/xxxx_sk 这里的xxxx_sk图中的文件名 启动网络： cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; docker-compose up -d 查看容器是否都启动了 第一部分已经完成 墙的那边：参考链接 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-09-25T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"环境：mac os 准备： Docker: 先注册docker hub的一个账号-&gt;docker hub 下载安装docker下载地址 使用之前注册好的账号进行登入 切换镜像源，推荐使用daocloude注册地址(具体更换方法自行百度吧) ps: docker for mac 不需要单独在安装docker-compose, centos 或者 ubuntu 需要单独进行安装 Go: 这个肯定不用说了~~~ 相信您已经安装了 安装指南 使用 Hyperledger fabric 1.0.5构建一个简单的网络 1、创建项目目录 mkdir -p $GOPATH/src/github.com/chainHero/heroes-service-network 2、这里为了简化部署网络部署，提供了二进制文件，方便安装 仓库地址： (Linux x64 ): cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; git clone https://github.com/chainHero/heroes-service-network/branches/master/bin ps：这个地址貌似有点问题所以提供了下面的下载链接，解压后将整个bin目录移动到 之前建好的目录中 Linux AMD 64 Windows AMD 64 Darwin AMD 64 3、我们要知道我们的网络由那些东西组成所以需要一个配置文件，配置文件包含网络拓扑，并根据组织和组件生成证书和秘钥 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch crypto-config.yaml &amp;&amp; vim crypto-config.yaml 并将下面的内容复制到crypto-config.yaml 文件中 （文件内容申明了我们的网络有一个组织和两个peer 节点） # &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes OrdererOrgs: - Name: ChainHero Domain: hf.chainhero.io # Specs is an array of Spec entries. Each Spec entry consists of two fields : Hostname and CommonName Specs: - Hostname: orderer # &quot;PeerOrgs&quot; - Definition of organizations managing peer nodes PeerOrgs: - Name: Org1ChainHero Domain: org1.hf.chainhero.io # Allows for the definition of 1 or more hosts that are created sequentially # from a template. By default, this looks like &quot;peer%d&quot; from 0 to Count-1. # You may override the number of nodes (Count), the starting index (Start) # or the template used to construct the name (Hostname). Template: Count: 2 Users: # The number of user accounts _in addition_ to Admin Count: 2 4、使用Cryptogen 生成加密材料 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p crypto-config &amp;&amp; ./bin/cryptogen generate --config=./crypto-config.yaml 这时候crypto-config下就多了两个文件夹 5、为了初始化我们的网络我们还需要做一下操作： 创世区块 channel 配置交易生成器 继续我们的操作 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch configtx.yaml &amp;&amp; vim configtx.yaml 将一下内容复制到configtx.yaml 中 ################################################################################ # # SECTION : Profile # # - Different configuration profiles may be encoded here to be specified # as parameters to the configtxgen tool. The profiles which specify consortiums # are to be used for generating the orderer genesis block. With the correct # consortium members defined in the orderer genesis block, channel creation # requests may be generated with only the org member names and a consortium name # ################################################################################ Profiles: ChainHero: Orderer: &lt;&lt;: *OrdererDefaults Organizations: - *ChainHero Application: &lt;&lt;: *ApplicationDefaults Organizations: - *Org1ChainHero Consortium: SampleConsortium Consortiums: SampleConsortium: Organizations: - *ChainHero - *Org1ChainHero ################################################################################ # # SECTION: Organizations # # - This section defines the different organizational identities which will # be referenced later in the configuration. # ################################################################################ Organizations: - &amp;ChainHero Name: ChainHero ID: hf.chainhero.io AdminPrincipal: Role.ADMIN MSPDir: crypto-config/ordererOrganizations/hf.chainhero.io/msp - &amp;Org1ChainHero Name: ChainHeroOrganization1 ID: org1.hf.chainhero.io AdminPrincipal: Role.ADMIN MSPDir: crypto-config/peerOrganizations/org1.hf.chainhero.io/msp AnchorPeers: - Host: peer0.org1.hf.chainhero.io Port: 7051 ################################################################################ # # SECTION: Orderer # # - This section defines the values to encode into a config transaction or # genesis block for orderer related parameters. # ################################################################################ Orderer: &amp;OrdererDefaults OrdererType: solo Addresses: - orderer.hf.chainhero.io:7050 BatchTimeout: 5s # Batch Size: Controls the number of messages batched into a block. BatchSize: # Max Message Count: The maximum number of messages to permit in a batch. MaxMessageCount: 10 # Absolute Max Bytes: The absolute maximum number of bytes allowed for # the serialized messages in a batch. If the &quot;kafka&quot; OrdererType is # selected, set &#39;message.max.bytes&#39; and &#39;replica.fetch.max.bytes&#39; on the # Kafka brokers to a value that is larger than this one. AbsoluteMaxBytes: 98 MB # Preferred Max Bytes: The preferred maximum number of bytes allowed for # the serialized messages in a batch. A message larger than the # preferred max bytes will result in a batch larger than preferred max # bytes. PreferredMaxBytes: 512 KB # Max Channels is the maximum number of channels to allow on the ordering # network. When set to 0, this implies no maximum number of channels. MaxChannels: 0 # Organizations is the list of orgs which are defined as participants on # the orderer side of the network. Organizations: ################################################################################ # # SECTION: Application # # - This section defines the values to encode into a config transaction or # genesis block for application related parameters. # ################################################################################ Application: &amp;ApplicationDefaults Organizations: 配置文件已经生成好了，我们需要用configtxgen 来生成我们的创世区块 cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p artifacts cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputBlock ./artifacts/orderer.genesis.block 创建我们的channel FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputCreateChannelTx ./artifacts/chainhero.channel.tx -channelID chainhero 配置交易生成器 FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputAnchorPeersUpdate ./artifacts/org1.chainhero.anchors.tx -channelID chainhero -asOrg ChainHeroOrganization1 区块链网络我们已经搭建完成了，接下来是怎么启动他们~~~ 我们使用docker-compose来启动创建一个docker-compose.yaml文件 version: &#39;2&#39; networks: default: services: orderer.hf.chainhero.io: image: hyperledger/fabric-orderer:x86_64-1.0.5 container_name: orderer.hf.chainhero.io environment: - ORDERER_GENERAL_LOGLEVEL=debug - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0 - ORDERER_GENERAL_LISTENPORT=7050 - ORDERER_GENERAL_GENESISPROFILE=ChainHero - ORDERER_GENERAL_GENESISMETHOD=file - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block - ORDERER_GENERAL_LOCALMSPID=hf.chainhero.io - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp - ORDERER_GENERAL_TLS_ENABLED=true - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt] working_dir: /opt/gopath/src/github.com/hyperledger/fabric command: orderer volumes: - ./artifacts/orderer.genesis.block:/var/hyperledger/orderer/orderer.genesis.block - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/msp:/var/hyperledger/orderer/msp - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/tls:/var/hyperledger/orderer/tls ports: - 7050:7050 networks: default: aliases: - orderer.hf.chainhero.io ca.org1.hf.chainhero.io: image: hyperledger/fabric-ca:x86_64-1.0.5 container_name: ca.org1.hf.chainhero.io environment: - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server - FABRIC_CA_SERVER_CA_NAME=ca.org1.hf.chainhero.io - FABRIC_CA_SERVER_CA_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem - FABRIC_CA_SERVER_CA_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE-- - FABRIC_CA_SERVER_TLS_ENABLED=true - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE-- ports: - 7054:7054 command: sh -c &#39;fabric-ca-server start -b admin:adminpw -d&#39; volumes: - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/:/etc/hyperledger/fabric-ca-server-config networks: default: aliases: - ca.org1.hf.chainhero.io peer0.org1.hf.chainhero.io: image: hyperledger/fabric-peer:x86_64-1.0.5 container_name: peer0.org1.hf.chainhero.io environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_VM_DOCKER_ATTACHSTDOUT=true - CORE_LOGGING_LEVEL=DEBUG - CORE_PEER_NETWORKID=chainhero - CORE_PEER_PROFILE_ENABLED=true - CORE_PEER_TLS_ENABLED=true - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt - CORE_PEER_ID=peer0.org1.hf.chainhero.io - CORE_PEER_ADDRESSAUTODETECT=true - CORE_PEER_ADDRESS=peer0.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_USELEADERELECTION=true - CORE_PEER_GOSSIP_ORGLEADER=false - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer0.org1.hf.chainhero.io working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer command: peer node start volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/msp:/var/hyperledger/msp - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/tls:/var/hyperledger/tls ports: - 7051:7051 - 7053:7053 depends_on: - orderer.hf.chainhero.io links: - orderer.hf.chainhero.io networks: default: aliases: - peer0.org1.hf.chainhero.io peer1.org1.hf.chainhero.io: image: hyperledger/fabric-peer:x86_64-1.0.5 container_name: peer1.org1.hf.chainhero.io environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_VM_DOCKER_ATTACHSTDOUT=true - CORE_LOGGING_LEVEL=DEBUG - CORE_PEER_NETWORKID=chainhero - CORE_PEER_PROFILE_ENABLED=true - CORE_PEER_TLS_ENABLED=true - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt - CORE_PEER_ID=peer1.org1.hf.chainhero.io - CORE_PEER_ADDRESSAUTODETECT=true - CORE_PEER_ADDRESS=peer1.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.hf.chainhero.io:7051 - CORE_PEER_GOSSIP_USELEADERELECTION=true - CORE_PEER_GOSSIP_ORGLEADER=false - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer1.org1.hf.chainhero.io working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer command: peer node start volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/msp:/var/hyperledger/msp - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/tls:/var/hyperledger/tls ports: - 8051:7051 - 8053:7053 depends_on: - orderer.hf.chainhero.io links: - orderer.hf.chainhero.io networks: default: aliases: - peer1.org1.hf.chainhero.io 这需要改动一点东西： 将内容中的 --HERE--替换为heroes-service-network/crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/xxxx_sk 这里的xxxx_sk图中的文件名 启动网络： cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; docker-compose up -d 查看容器是否都启动了 第一部分已经完成 墙的那边：参考链接 阅读更多","@type":"BlogPosting","url":"/2018/09/25/a826956910381b7a6e1d614e2b7a3284.html","headline":"手动构建hyperledger fabric网络","dateModified":"2018-09-25T00:00:00+08:00","datePublished":"2018-09-25T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/09/25/a826956910381b7a6e1d614e2b7a3284.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>手动构建hyperledger fabric网络</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <blockquote> 
   <p>环境：mac os</p> 
  </blockquote> 
  <h3><a id="_3"></a>准备：</h3> 
  <p>Docker:</p> 
  <ol> 
   <li>先注册docker hub的一个账号-&gt;<a href="https://hub.docker.com/" rel="nofollow">docker hub</a></li> 
   <li>下载安装docker<a href="https://www.docker.com/products/docker-desktop" rel="nofollow">下载地址</a></li> 
   <li>使用之前注册好的账号进行登入</li> 
   <li>切换镜像源，推荐使用daocloude<a href="https://www.daocloud.io/mirror" rel="nofollow">注册地址</a>(具体更换方法自行百度吧)</li> 
  </ol> 
  <p>ps: docker for mac 不需要单独在安装docker-compose, centos 或者 ubuntu 需要单独进行安装</p> 
  <p>Go:<br> 这个肯定不用说了~~~ 相信您已经安装了</p> 
  <h3><a id="_16"></a>安装指南</h3> 
  <p>使用 Hyperledger fabric 1.0.5构建一个简单的网络</p> 
  <p>1、创建项目目录</p> 
  <pre><code>mkdir -p $GOPATH/src/github.com/chainHero/heroes-service-network
</code></pre> 
  <p>2、这里为了简化部署网络部署，提供了二进制文件，方便安装</p> 
  <p>仓库地址： (Linux x64 ):</p> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; git clone  https://github.com/chainHero/heroes-service-network/branches/master/bin
</code></pre> 
  <p>ps：这个地址貌似有点问题所以提供了下面的下载链接，解压后将整个bin目录移动到 之前建好的目录中</p> 
  <ul> 
   <li><a href="https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.0.5/hyperledger-fabric-linux-amd64-1.0.5.tar.gz" rel="nofollow">Linux AMD 64</a></li> 
   <li><a href="https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/windows-amd64-1.0.5/hyperledger-fabric-windows-amd64-1.0.5.tar.gz" rel="nofollow">Windows AMD 64</a></li> 
   <li><a href="https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/darwin-amd64-1.0.5/hyperledger-fabric-darwin-amd64-1.0.5.tar.gz" rel="nofollow">Darwin AMD 64</a></li> 
  </ul> 
  <p>3、我们要知道我们的网络由那些东西组成所以需要一个配置文件，配置文件包含网络拓扑，并根据组织和组件生成证书和秘钥</p> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch crypto-config.yaml &amp;&amp;  vim crypto-config.yaml
</code></pre> 
  <p>并将下面的内容复制到crypto-config.yaml 文件中<br> （文件内容申明了我们的网络有一个组织和两个peer 节点）</p> 
  <pre><code># "OrdererOrgs" - Definition of organizations managing orderer nodes
OrdererOrgs:
  - Name: ChainHero
    Domain: hf.chainhero.io
    # Specs is an array of Spec entries.  Each Spec entry consists of two fields : Hostname and CommonName
    Specs:
      - Hostname: orderer
# "PeerOrgs" - Definition of organizations managing peer nodes
PeerOrgs:
  - Name: Org1ChainHero
    Domain: org1.hf.chainhero.io
    # Allows for the definition of 1 or more hosts that are created sequentially
    # from a template. By default, this looks like "peer%d" from 0 to Count-1.
    # You may override the number of nodes (Count), the starting index (Start)
    # or the template used to construct the name (Hostname).
    Template:
      Count: 2
    Users:
      # The number of user accounts _in addition_ to Admin
      Count: 2
</code></pre> 
  <p>4、使用Cryptogen 生成加密材料</p> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; mkdir -p crypto-config &amp;&amp;  ./bin/cryptogen generate --config=./crypto-config.yaml
</code></pre> 
  <p>这时候crypto-config下就多了两个文件夹<br> <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180921155956884?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Jhb2dlZWc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></p> 
  <p>5、为了初始化我们的网络我们还需要做一下操作：</p> 
  <ul> 
   <li>创世区块</li> 
   <li>channel</li> 
   <li>配置交易生成器</li> 
  </ul> 
  <p>继续我们的操作</p> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; touch configtx.yaml &amp;&amp; vim configtx.yaml
</code></pre> 
  <p>将一下内容复制到configtx.yaml 中</p> 
  <pre><code>################################################################################
#
#   SECTION : Profile
#
#   - Different configuration profiles may be encoded here to be specified
#   as parameters to the configtxgen tool. The profiles which specify consortiums
#   are to be used for generating the orderer genesis block.  With the correct
#   consortium members defined in the orderer genesis block, channel creation
#   requests may be generated with only the org member names and a consortium name
#
################################################################################
Profiles:
    ChainHero:
        Orderer:
            &lt;&lt;: *OrdererDefaults
            Organizations:
                - *ChainHero
        Application:
            &lt;&lt;: *ApplicationDefaults
            Organizations:
                - *Org1ChainHero
        Consortium: SampleConsortium
        Consortiums:
            SampleConsortium:
                Organizations:
                    - *ChainHero
                    - *Org1ChainHero

################################################################################
#
#   SECTION: Organizations
#
#   - This section defines the different organizational identities which will
#   be referenced later in the configuration.
#
################################################################################
Organizations:
    - &amp;ChainHero
        Name: ChainHero
        ID: hf.chainhero.io
        AdminPrincipal: Role.ADMIN
        MSPDir: crypto-config/ordererOrganizations/hf.chainhero.io/msp

    - &amp;Org1ChainHero
        Name: ChainHeroOrganization1
        ID: org1.hf.chainhero.io
        AdminPrincipal: Role.ADMIN
        MSPDir: crypto-config/peerOrganizations/org1.hf.chainhero.io/msp
        AnchorPeers:
            - Host: peer0.org1.hf.chainhero.io
              Port: 7051

################################################################################
#
#   SECTION: Orderer
#
#   - This section defines the values to encode into a config transaction or
#   genesis block for orderer related parameters.
#
################################################################################
Orderer: &amp;OrdererDefaults
    OrdererType: solo
    Addresses:
        - orderer.hf.chainhero.io:7050
    BatchTimeout: 5s
    # Batch Size: Controls the number of messages batched into a block.
    BatchSize:
        # Max Message Count: The maximum number of messages to permit in a batch.
        MaxMessageCount: 10
        # Absolute Max Bytes: The absolute maximum number of bytes allowed for
        # the serialized messages in a batch. If the "kafka" OrdererType is
        # selected, set 'message.max.bytes' and 'replica.fetch.max.bytes' on the
        # Kafka brokers to a value that is larger than this one.
        AbsoluteMaxBytes: 98 MB
        # Preferred Max Bytes: The preferred maximum number of bytes allowed for
        # the serialized messages in a batch. A message larger than the
        # preferred max bytes will result in a batch larger than preferred max
        # bytes.
        PreferredMaxBytes: 512 KB
    # Max Channels is the maximum number of channels to allow on the ordering
    # network. When set to 0, this implies no maximum number of channels.
    MaxChannels: 0

    # Organizations is the list of orgs which are defined as participants on
    # the orderer side of the network.
    Organizations:

################################################################################
#
#   SECTION: Application
#
#   - This section defines the values to encode into a config transaction or
#   genesis block for application related parameters.
#
################################################################################
Application: &amp;ApplicationDefaults
    Organizations:
</code></pre> 
  <p>配置文件已经生成好了，我们需要用configtxgen 来生成我们的创世区块</p> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; 
mkdir -p artifacts
</code></pre> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; 
FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputBlock ./artifacts/orderer.genesis.block
</code></pre> 
  <p>创建我们的channel</p> 
  <pre><code>FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputCreateChannelTx ./artifacts/chainhero.channel.tx -channelID chainhero
</code></pre> 
  <p>配置交易生成器</p> 
  <pre><code>FABRIC_CFG_PATH=$PWD ./bin/configtxgen -profile ChainHero -outputAnchorPeersUpdate ./artifacts/org1.chainhero.anchors.tx -channelID chainhero -asOrg ChainHeroOrganization1
</code></pre> 
  <p>区块链网络我们已经搭建完成了，接下来是怎么启动他们~~~<br> 我们使用docker-compose来启动创建一个<code>docker-compose.yaml</code>文件</p> 
  <pre><code>version: '2'

networks:
  default:

services:

  orderer.hf.chainhero.io:
    image: hyperledger/fabric-orderer:x86_64-1.0.5
    container_name: orderer.hf.chainhero.io
    environment:
      - ORDERER_GENERAL_LOGLEVEL=debug
      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
      - ORDERER_GENERAL_LISTENPORT=7050
      - ORDERER_GENERAL_GENESISPROFILE=ChainHero
      - ORDERER_GENERAL_GENESISMETHOD=file
      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block
      - ORDERER_GENERAL_LOCALMSPID=hf.chainhero.io
      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp
      - ORDERER_GENERAL_TLS_ENABLED=true
      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key
      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt
      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]

    working_dir: /opt/gopath/src/github.com/hyperledger/fabric
    command: orderer
    volumes:
      - ./artifacts/orderer.genesis.block:/var/hyperledger/orderer/orderer.genesis.block
      - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/msp:/var/hyperledger/orderer/msp
      - ./crypto-config/ordererOrganizations/hf.chainhero.io/orderers/orderer.hf.chainhero.io/tls:/var/hyperledger/orderer/tls
    ports:
      - 7050:7050
    networks:
      default:
        aliases:
          - orderer.hf.chainhero.io

  ca.org1.hf.chainhero.io:
    image: hyperledger/fabric-ca:x86_64-1.0.5
    container_name: ca.org1.hf.chainhero.io
    environment:
      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
      - FABRIC_CA_SERVER_CA_NAME=ca.org1.hf.chainhero.io
      - FABRIC_CA_SERVER_CA_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem
      - FABRIC_CA_SERVER_CA_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE--
      - FABRIC_CA_SERVER_TLS_ENABLED=true
      - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.hf.chainhero.io-cert.pem
      - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/--HERE--
    ports:
      - 7054:7054
    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
    volumes:
      - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/:/etc/hyperledger/fabric-ca-server-config
    networks:
      default:
        aliases:
          - ca.org1.hf.chainhero.io

  peer0.org1.hf.chainhero.io:
    image: hyperledger/fabric-peer:x86_64-1.0.5
    container_name: peer0.org1.hf.chainhero.io
    environment:
      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
      - CORE_VM_DOCKER_ATTACHSTDOUT=true
      - CORE_LOGGING_LEVEL=DEBUG
      - CORE_PEER_NETWORKID=chainhero
      - CORE_PEER_PROFILE_ENABLED=true
      - CORE_PEER_TLS_ENABLED=true
      - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt
      - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key
      - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt
      - CORE_PEER_ID=peer0.org1.hf.chainhero.io
      - CORE_PEER_ADDRESSAUTODETECT=true
      - CORE_PEER_ADDRESS=peer0.org1.hf.chainhero.io:7051
      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.hf.chainhero.io:7051
      - CORE_PEER_GOSSIP_USELEADERELECTION=true
      - CORE_PEER_GOSSIP_ORGLEADER=false
      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true
      - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io
      - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp
      - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer0.org1.hf.chainhero.io
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
    command: peer node start
    volumes:
      - /var/run/:/host/var/run/
      - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/msp:/var/hyperledger/msp
      - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer0.org1.hf.chainhero.io/tls:/var/hyperledger/tls
    ports:
      - 7051:7051
      - 7053:7053
    depends_on:
      - orderer.hf.chainhero.io
    links:
      - orderer.hf.chainhero.io
    networks:
      default:
        aliases:
          - peer0.org1.hf.chainhero.io

  peer1.org1.hf.chainhero.io:
    image: hyperledger/fabric-peer:x86_64-1.0.5
    container_name: peer1.org1.hf.chainhero.io
    environment:
      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
      - CORE_VM_DOCKER_ATTACHSTDOUT=true
      - CORE_LOGGING_LEVEL=DEBUG
      - CORE_PEER_NETWORKID=chainhero
      - CORE_PEER_PROFILE_ENABLED=true
      - CORE_PEER_TLS_ENABLED=true
      - CORE_PEER_TLS_CERT_FILE=/var/hyperledger/tls/server.crt
      - CORE_PEER_TLS_KEY_FILE=/var/hyperledger/tls/server.key
      - CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/tls/ca.crt
      - CORE_PEER_ID=peer1.org1.hf.chainhero.io
      - CORE_PEER_ADDRESSAUTODETECT=true
      - CORE_PEER_ADDRESS=peer1.org1.hf.chainhero.io:7051
      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.hf.chainhero.io:7051
      - CORE_PEER_GOSSIP_USELEADERELECTION=true
      - CORE_PEER_GOSSIP_ORGLEADER=false
      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true
      - CORE_PEER_LOCALMSPID=org1.hf.chainhero.io
      - CORE_PEER_MSPCONFIGPATH=/var/hyperledger/msp
      - CORE_PEER_TLS_SERVERHOSTOVERRIDE=peer1.org1.hf.chainhero.io
    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
    command: peer node start
    volumes:
      - /var/run/:/host/var/run/
      - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/msp:/var/hyperledger/msp
      - ./crypto-config/peerOrganizations/org1.hf.chainhero.io/peers/peer1.org1.hf.chainhero.io/tls:/var/hyperledger/tls
    ports:
      - 8051:7051
      - 8053:7053
    depends_on:
      - orderer.hf.chainhero.io
    links:
      - orderer.hf.chainhero.io
    networks:
      default:
        aliases:
          - peer1.org1.hf.chainhero.io

</code></pre> 
  <p>这需要改动一点东西：<br> 将内容中的 <code>--HERE--</code>替换为<code>heroes-service-network/crypto-config/peerOrganizations/org1.hf.chainhero.io/ca/xxxx_sk</code><br> 这里的<code>xxxx_sk</code>图中的文件名<br> <img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180921170621862?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Jhb2dlZWc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></p> 
  <p>启动网络：</p> 
  <pre><code>cd $GOPATH/src/github.com/chainHero/heroes-service-network &amp;&amp; docker-compose up -d
</code></pre> 
  <p>查看容器是否都启动了</p> 
  <p><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180921170835257?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Jhb2dlZWc=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></p> 
  <p>第一部分已经完成</p> 
  <p>墙的那边：<a href="https://chainhero.io/2018/03/tutorial-build-blockchain-app-2/#prerequisites" rel="nofollow">参考链接</a></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-8cccb36679.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/raogeeg/article/details/82801516,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/raogeeg/article/details/82801516,&quot;}">阅读更多</a> 
 <!-- <a class="btn" href="https://passport.csdn.net/account/login?utm_source=csdn_blog_pc_more_login" target="_self" id="btn-lobinreadmore" data-track-view='{"mod":"popu_557","con":",https://blog.csdn.net/raogeeg/article/details/82801516,"}' data-track-click='{"mod":"popu_557","con":",https://blog.csdn.net/raogeeg/article/details/82801516,"}'>登录后自动展开</a> --> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
