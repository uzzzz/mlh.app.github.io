<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>【策略研究】海龟交易法则（附源码） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="【策略研究】海龟交易法则（附源码）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="海龟交易法则简介 什么是海龟交易法则？ ​ ​ 1983年年中，著名的商品投机家理查德.丹尼斯与他的老友比尔.埃克哈特进行了一场辩论，这场辩论是关于伟大的交易员是天生造就还是后天培养的。理查德相信，他可以教会人们成为伟大的交易员。比尔则认为遗传和天性才是决定因素。 ​ 为了解决这一问题，理查德建议招募并培训一些交易员，给他们提供真实的帐户进行交易，看看两个人中谁是正确的。 ​ 他们在《巴伦氏》、《华尔街期刊》和《纽约时报》上刊登了大幅广告，招聘交易学员。广告中称，在一个短暂的培训会后，新手将被提供一个帐户进行交易。 ​ 理查德从报名的人中精选出13个人，1983年12月底，学员被邀请到芝加哥进行两周的培训，到1984年1月初，开始用小帐户进行交易。到了2月初，在学员证明了自己的能力之后，丹尼斯给其中的大多数人提供了50万至200万美元的资金帐户。 ​ “学员们被称为‘海龟’（丹尼斯先生说这项计划开始时他刚刚从亚洲回来，他解释了自己向别人说过的话，‘我们正在成长为交易员，就象在新加坡他们正在成长为海龟一样’）。”----斯坦利.W.安格瑞斯特，《华尔街期刊》，1989年9月5日 ​ 海龟成为交易史上最著名的实验，因为在随后的四年中这些海龟交易员取得了年均复利80%的收益。 ​ 是的，里克证明了交易可以被传授。他证明了用一套简单的法则，他可以使仅有很少或根本没有交易经验的人成为优秀的交易员。而这个交易法则被后世称为“海龟交易法则”。 海龟交易法则具体内容 海龟交易法则：海龟交易法则属于趋势交易，首先建立唐奇安通道（下文会具体解释），即确定上突破线和下突破线，如果价格突破上线，则做多，如果价格突破下线就平仓或做空。 唐奇安通道与开仓 唐奇安通道，作为一个通道必定有上线和下线，上线就是前N1日内的最高价，下线就是前N2日内的最低价，一般来说N1=20，N2=10；然后，价格上穿就买，下穿就卖，就是这么简单。 但是仅仅只用唐奇安通道进行买卖，其实效果跟MACD线等其他趋势策略的效果差不多，并没有更优 ATR与仓位管理 海龟交易法则最核心的部分，在于仓位的控制，这种止损会让你基准的亏损不超过总资金的n%，所以这部分的思想是需要我们学习的。 当日的真实波幅TR（true range） 计算当日真实波幅公式 ​ TR_1=Max(H_1−L_1,H_1−C_0,C_0−L_1) 其中，下表1代表当日，下表0代表昨日，C_0是昨日开盘价close，H是最高价high，L是最低价low。 平均波幅ATR（Average true range） 一般取前20日的平均TR。 ​ ATR{20}=mean(TR_1,TR_2…TR{19},TR_{20}) 其中，公式mean(X_1,X_2)代表求X_1和X_2的平均数。 这时候我们已经求出ATR，这个数字可以当做衡量今天的价格波幅的基准，为1单位，比如现在价格是100元，基准波幅ATR=4元，代表今天基准波幅在98-102元，如果是2倍ATR，波幅就在96-104元。 仓位管理 在仅讨论多头的情况下： 1、如果标的价格跌破&quot;持仓均价-0.5（1、1.5、2）倍的ATR&quot;，则平仓至原始仓位的75%（50%，25%，0%）。 2、如果标的价格跌破唐奇安通道下轨，则全平仓。 海龟交易法则策略实现（基于掘金量化平台） 策略思想 当价格上穿唐奇安通道且短MA在长MA上方时开多仓;当价格下穿唐奇安通道且短MA在长MA下方时开空仓(8手) 若有多仓则在价格跌破唐奇安平仓通道下轨的时候全平仓位,否则根据跌破持仓均价 - x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手 若有空仓则在价格涨破唐奇安平仓通道上轨的时候全平仓位,否则根据涨破持仓均价 + x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手 策略主要步骤实现 订阅数据 subscribe(symbols=symbols, frequency=&#39;1d&#39;, count=31, wait_group=True)(symbols=symbols, frequency=&#39;1d&#39;, count=31, wait_group=True) ​ 订阅数据需要在定义init函数里面设置，并调用subscribe函数，这里注意，我们需要通过计算前三十根bars来作为开平仓的标准，并在当前bar上做出开平仓操作，所以需要获取31根bar： symbols 需要设置订阅的标的代码。 frequency需设置订阅数据的周期级别，这里设置1d 表示以一天为周期。 count需要设置获取的bar的数量 数据获取 data = context.data(symbol=symbol, frequency=&#39;1d&#39;, count=31, fields=&#39;close&#39;) = context.data(symbol=symbol, frequency=&#39;1d&#39;, count=31, fields=&#39;close&#39;) ​ 订阅数据之后，需要获取已经订阅的数据来进行操作，这时需调用context.data函数： symbols 需要设置订阅的标的代码。 frequency需设置订阅数据的周期级别，这里设置1d表示以一天为周期。 count需要设置获取的bar的数量 fields需要设置返回值的种类 获取持仓信息 position_long = context.account().position(symbol=symbol, side=PositionSide_Long) ​ position_short = context.account().position(symbol=symbol, side=PositionSide_Short) = context.account().position(symbol=symbol, side=PositionSide_Long) ​ position_short = context.account().position(symbol=symbol, side=PositionSide_Short) ​ 在判断平仓条件时，需要获取持仓信息（包含持仓均价），这就需要调用context.account().position函数： symbols 需要设置订阅的标的代码。 side需要设置持仓方向，有PositionSide_Long和PositionSide_Short两个选择。 策略回测分析 回测报告 分析 ​ 我们选取了2017年6月至2017年12月作为回测周期，“RB1801”与“FG801”作为标的合约，均线长短周期分别为5d，20d，唐奇安通道上下轨计算周期分别为20d，10d，ATR计算周期为20d，可以看出： 胜率（具有盈利的平仓次数与总平仓次数之比）达到了34.48%，因为海龟交易法则为趋势跟踪策略，所以胜率不会太高。 卡玛比率（年化收益率与历史最大回撤之比）是使用最大回撤率来衡量风险。采用最大回撤率来衡量风险，关注的是最极端的情况。卡玛比率越高表示策略承受每单位最大损失获得的报酬越高。在这里卡玛比率超过了9。 夏普比率（年化收益率减无风险收益率的差收益波动率之比）超过2.5，也即承受1单位的风险，会有超过2.5个单位的收益回报。 策略收益曲线整体相对稳定，适合稳定型投资者，最大回撤极小，另外，策略在趋势行情行情中表现更加。 &nbsp; 海龟交易策略源码： &nbsp; &nbsp; # coding=utf-8 from __future__ import print_function, absolute_import, unicode_literals &nbsp; import numpy as np import pandas as pd try: import talib except: print(&#39;请安装TA-Lib库&#39;) from gm.api import * &nbsp; &#39;&#39;&#39; 本策略通过计算CZCE.FG801和SHFE.rb1801的ATR.唐奇安通道和MA线,并: 上穿唐奇安通道且短MA在长MA上方则开多仓,下穿唐奇安通道且短MA在长MA下方则开空仓 若有 多/空 仓位则分别: 价格 跌/涨 破唐奇安平仓通道 上/下 轨则全平仓位,否则 根据 跌/涨 破持仓均价 -/+ x(x=0.5,1,1.5,2)倍ATR把仓位 回测数据为:CZCE.FG801和SHFE.rb1801的1min数据 回测时间为:2017-09-15 09:15:00到2017-10-01 15:00:00 &#39;&#39;&#39; &nbsp; &nbsp; def init(context): # context.parameter分别为唐奇安开仓通道.唐奇安平仓通道.短ma.长ma.ATR的参数 context.parameter = [55, 20, 10, 60, 20] context.tar = context.parameter[4] # context.goods交易的品种 context.goods = [&#39;CZCE.FG801&#39;, &#39;SHFE.rb1801&#39;] # context.ratio交易最大资金比率 context.ratio = 0.8 # 订阅context.goods里面的品种, bar频率为1min subscribe(symbols=context.goods, frequency=&#39;60s&#39;, count=101) # 止损的比例区间 &nbsp; &nbsp; def on_bar(context, bars): bar = bars[0] symbol = bar[&#39;symbol&#39;] recent_data = context.data(symbol=symbol, frequency=&#39;60s&#39;, count=101, fields=&#39;close,high,low&#39;) close = recent_data[&#39;close&#39;].values[-1] # 计算ATR atr = talib.ATR(recent_data[&#39;high&#39;].values, recent_data[&#39;low&#39;].values, recent_data[&#39;close&#39;].values, timeperiod=context.tar)[-1] # 计算唐奇安开仓和平仓通道 context.don_open = context.parameter[0] + 1 upper_band = talib.MAX(recent_data[&#39;close&#39;].values[:-1], timeperiod=context.don_open)[-1] context.don_close = context.parameter[1] + 1 lower_band = talib.MIN(recent_data[&#39;close&#39;].values[:-1], timeperiod=context.don_close)[-1] # 计算开仓的资金比例 percent = context.ratio / float(len(context.goods)) # 若没有仓位则开仓 position_long = context.account().position(symbol=symbol, side=PositionSide_Long) position_short = context.account().position(symbol=symbol, side=PositionSide_Short) if not position_long and not position_short: # 计算长短ma线.DIF ma_short = talib.MA(recent_data[&#39;close&#39;].values, timeperiod=(context.parameter[2] + 1))[-1] ma_long = talib.MA(recent_data[&#39;close&#39;].values, timeperiod=(context.parameter[3] + 1))[-1] dif = ma_short - ma_long # 获取当前价格 # 上穿唐奇安通道且短ma在长ma上方则开多仓 if close &gt; upper_band and (dif &gt; 0): order_target_percent(symbol=symbol, percent=percent, order_type=OrderType_Market, position_side=PositionSide_Long) print(symbol, &#39;市价单开多仓到比例: &#39;, percent) # 下穿唐奇安通道且短ma在长ma下方则开空仓 if close &lt; lower_band and (dif &lt; 0): order_target_percent(symbol=symbol, percent=percent, order_type=OrderType_Market, position_side=PositionSide_Short) print(symbol, &#39;市价单开空仓到比例: &#39;, percent) elif position_long: # 价格跌破唐奇安平仓通道全平仓位止损 if close &lt; lower_band: order_close_all() print(symbol, &#39;市价单全平仓位&#39;) else: # 获取持仓均价 vwap = position_long[&#39;vwap&#39;] # 获取持仓的资金 money = position_long[&#39;cost&#39;] # 获取平仓的区间 band = vwap - np.array([200, 2, 1.5, 1, 0.5, -100]) * atr grid_percent = float(pd.cut([close], band, labels=[0, 0.25, 0.5, 0.75, 1])[0]) * percent # 选择现有百分比和区间百分比中较小的值(避免开仓) target_percent = np.minimum(money / context.account().cash[&#39;nav&#39;], grid_percent) if target_percent != 1.0: print(symbol, &#39;市价单平多仓到比例: &#39;, target_percent) order_target_percent(symbol=symbol, percent=target_percent, order_type=OrderType_Market, position_side=PositionSide_Long) &nbsp; elif position_short: # 价格涨破唐奇安平仓通道或价格涨破持仓均价加两倍ATR平空仓 if close &gt; upper_band: order_close_all() print(symbol, &#39;市价单全平仓位&#39;) else: # 获取持仓均价 vwap = position_short[&#39;vwap&#39;] # 获取持仓的资金 money = position_short[&#39;cost&#39;] # 获取平仓的区间 band = vwap + np.array([-100, 0.5, 1, 1.5, 2, 200]) * atr grid_percent = float(pd.cut([close], band, labels=[1, 0.75, 0.5, 0.25, 0])[0]) * percent # 选择现有百分比和区间百分比中较小的值(避免开仓) target_percent = np.minimum(money / context.account().cash[&#39;nav&#39;], grid_percent) if target_percent != 1.0: order_target_percent(symbol=symbol, percent=target_percent, order_type=OrderType_Market, position_side=PositionSide_Short) print(symbol, &#39;市价单平空仓到比例: &#39;, target_percent) &nbsp; &nbsp; if __name__ == &#39;__main__&#39;: &#39;&#39;&#39; strategy_id策略ID,由系统生成 filename文件名,请与本文件名保持一致 mode实时模式:MODE_LIVE回测模式:MODE_BACKTEST token绑定计算机的ID,可在系统设置-密钥管理中生成 backtest_start_time回测开始时间 backtest_end_time回测结束时间 backtest_adjust股票复权方式不复权:ADJUST_NONE前复权:ADJUST_PREV后复权:ADJUST_POST backtest_initial_cash回测初始资金 backtest_commission_ratio回测佣金比例 backtest_slippage_ratio回测滑点比例 &#39;&#39;&#39; run(strategy_id=&#39;strategy_id&#39;, filename=&#39;main.py&#39;, mode=MODE_BACKTEST, token=&#39;token_id&#39;, backtest_start_time=&#39;2017-09-15 09:15:00&#39;, backtest_end_time=&#39;2017-10-01 15:00:00&#39;, backtest_adjust=ADJUST_PREV, backtest_initial_cash=10000000, backtest_commission_ratio=0.0001, backtest_slippage_ratio=0.0001) 文章来源：掘金量化交易平台&nbsp; &nbsp; &nbsp;转载请注明出处！ ----------------------------------------------------------------------------------------------------------------------------------------------------------- 更多策略源码查看： 1 双均线策略(期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/153 2 alpha对冲(股票+期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/101 3 集合竞价选股(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/102 4 多因子选股(股票)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/103 5 网格交易(期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/104 6 指数增强(股票)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/105 7 跨品种套利(期货)量化策略源码 https://www.myquant.cn/docs/python_strategyies/106 8 跨期套利(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/107 9 日内回转交易(股票)量化策略源码 https://www.myquant.cn/docs/python_strategyies/108 10 做市商交易(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/109 11 海龟交易法(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/110 12 行业轮动(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/111 13 机器学习(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/112 阅读更多" />
<meta property="og:description" content="海龟交易法则简介 什么是海龟交易法则？ ​ ​ 1983年年中，著名的商品投机家理查德.丹尼斯与他的老友比尔.埃克哈特进行了一场辩论，这场辩论是关于伟大的交易员是天生造就还是后天培养的。理查德相信，他可以教会人们成为伟大的交易员。比尔则认为遗传和天性才是决定因素。 ​ 为了解决这一问题，理查德建议招募并培训一些交易员，给他们提供真实的帐户进行交易，看看两个人中谁是正确的。 ​ 他们在《巴伦氏》、《华尔街期刊》和《纽约时报》上刊登了大幅广告，招聘交易学员。广告中称，在一个短暂的培训会后，新手将被提供一个帐户进行交易。 ​ 理查德从报名的人中精选出13个人，1983年12月底，学员被邀请到芝加哥进行两周的培训，到1984年1月初，开始用小帐户进行交易。到了2月初，在学员证明了自己的能力之后，丹尼斯给其中的大多数人提供了50万至200万美元的资金帐户。 ​ “学员们被称为‘海龟’（丹尼斯先生说这项计划开始时他刚刚从亚洲回来，他解释了自己向别人说过的话，‘我们正在成长为交易员，就象在新加坡他们正在成长为海龟一样’）。”----斯坦利.W.安格瑞斯特，《华尔街期刊》，1989年9月5日 ​ 海龟成为交易史上最著名的实验，因为在随后的四年中这些海龟交易员取得了年均复利80%的收益。 ​ 是的，里克证明了交易可以被传授。他证明了用一套简单的法则，他可以使仅有很少或根本没有交易经验的人成为优秀的交易员。而这个交易法则被后世称为“海龟交易法则”。 海龟交易法则具体内容 海龟交易法则：海龟交易法则属于趋势交易，首先建立唐奇安通道（下文会具体解释），即确定上突破线和下突破线，如果价格突破上线，则做多，如果价格突破下线就平仓或做空。 唐奇安通道与开仓 唐奇安通道，作为一个通道必定有上线和下线，上线就是前N1日内的最高价，下线就是前N2日内的最低价，一般来说N1=20，N2=10；然后，价格上穿就买，下穿就卖，就是这么简单。 但是仅仅只用唐奇安通道进行买卖，其实效果跟MACD线等其他趋势策略的效果差不多，并没有更优 ATR与仓位管理 海龟交易法则最核心的部分，在于仓位的控制，这种止损会让你基准的亏损不超过总资金的n%，所以这部分的思想是需要我们学习的。 当日的真实波幅TR（true range） 计算当日真实波幅公式 ​ TR_1=Max(H_1−L_1,H_1−C_0,C_0−L_1) 其中，下表1代表当日，下表0代表昨日，C_0是昨日开盘价close，H是最高价high，L是最低价low。 平均波幅ATR（Average true range） 一般取前20日的平均TR。 ​ ATR{20}=mean(TR_1,TR_2…TR{19},TR_{20}) 其中，公式mean(X_1,X_2)代表求X_1和X_2的平均数。 这时候我们已经求出ATR，这个数字可以当做衡量今天的价格波幅的基准，为1单位，比如现在价格是100元，基准波幅ATR=4元，代表今天基准波幅在98-102元，如果是2倍ATR，波幅就在96-104元。 仓位管理 在仅讨论多头的情况下： 1、如果标的价格跌破&quot;持仓均价-0.5（1、1.5、2）倍的ATR&quot;，则平仓至原始仓位的75%（50%，25%，0%）。 2、如果标的价格跌破唐奇安通道下轨，则全平仓。 海龟交易法则策略实现（基于掘金量化平台） 策略思想 当价格上穿唐奇安通道且短MA在长MA上方时开多仓;当价格下穿唐奇安通道且短MA在长MA下方时开空仓(8手) 若有多仓则在价格跌破唐奇安平仓通道下轨的时候全平仓位,否则根据跌破持仓均价 - x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手 若有空仓则在价格涨破唐奇安平仓通道上轨的时候全平仓位,否则根据涨破持仓均价 + x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手 策略主要步骤实现 订阅数据 subscribe(symbols=symbols, frequency=&#39;1d&#39;, count=31, wait_group=True)(symbols=symbols, frequency=&#39;1d&#39;, count=31, wait_group=True) ​ 订阅数据需要在定义init函数里面设置，并调用subscribe函数，这里注意，我们需要通过计算前三十根bars来作为开平仓的标准，并在当前bar上做出开平仓操作，所以需要获取31根bar： symbols 需要设置订阅的标的代码。 frequency需设置订阅数据的周期级别，这里设置1d 表示以一天为周期。 count需要设置获取的bar的数量 数据获取 data = context.data(symbol=symbol, frequency=&#39;1d&#39;, count=31, fields=&#39;close&#39;) = context.data(symbol=symbol, frequency=&#39;1d&#39;, count=31, fields=&#39;close&#39;) ​ 订阅数据之后，需要获取已经订阅的数据来进行操作，这时需调用context.data函数： symbols 需要设置订阅的标的代码。 frequency需设置订阅数据的周期级别，这里设置1d表示以一天为周期。 count需要设置获取的bar的数量 fields需要设置返回值的种类 获取持仓信息 position_long = context.account().position(symbol=symbol, side=PositionSide_Long) ​ position_short = context.account().position(symbol=symbol, side=PositionSide_Short) = context.account().position(symbol=symbol, side=PositionSide_Long) ​ position_short = context.account().position(symbol=symbol, side=PositionSide_Short) ​ 在判断平仓条件时，需要获取持仓信息（包含持仓均价），这就需要调用context.account().position函数： symbols 需要设置订阅的标的代码。 side需要设置持仓方向，有PositionSide_Long和PositionSide_Short两个选择。 策略回测分析 回测报告 分析 ​ 我们选取了2017年6月至2017年12月作为回测周期，“RB1801”与“FG801”作为标的合约，均线长短周期分别为5d，20d，唐奇安通道上下轨计算周期分别为20d，10d，ATR计算周期为20d，可以看出： 胜率（具有盈利的平仓次数与总平仓次数之比）达到了34.48%，因为海龟交易法则为趋势跟踪策略，所以胜率不会太高。 卡玛比率（年化收益率与历史最大回撤之比）是使用最大回撤率来衡量风险。采用最大回撤率来衡量风险，关注的是最极端的情况。卡玛比率越高表示策略承受每单位最大损失获得的报酬越高。在这里卡玛比率超过了9。 夏普比率（年化收益率减无风险收益率的差收益波动率之比）超过2.5，也即承受1单位的风险，会有超过2.5个单位的收益回报。 策略收益曲线整体相对稳定，适合稳定型投资者，最大回撤极小，另外，策略在趋势行情行情中表现更加。 &nbsp; 海龟交易策略源码： &nbsp; &nbsp; # coding=utf-8 from __future__ import print_function, absolute_import, unicode_literals &nbsp; import numpy as np import pandas as pd try: import talib except: print(&#39;请安装TA-Lib库&#39;) from gm.api import * &nbsp; &#39;&#39;&#39; 本策略通过计算CZCE.FG801和SHFE.rb1801的ATR.唐奇安通道和MA线,并: 上穿唐奇安通道且短MA在长MA上方则开多仓,下穿唐奇安通道且短MA在长MA下方则开空仓 若有 多/空 仓位则分别: 价格 跌/涨 破唐奇安平仓通道 上/下 轨则全平仓位,否则 根据 跌/涨 破持仓均价 -/+ x(x=0.5,1,1.5,2)倍ATR把仓位 回测数据为:CZCE.FG801和SHFE.rb1801的1min数据 回测时间为:2017-09-15 09:15:00到2017-10-01 15:00:00 &#39;&#39;&#39; &nbsp; &nbsp; def init(context): # context.parameter分别为唐奇安开仓通道.唐奇安平仓通道.短ma.长ma.ATR的参数 context.parameter = [55, 20, 10, 60, 20] context.tar = context.parameter[4] # context.goods交易的品种 context.goods = [&#39;CZCE.FG801&#39;, &#39;SHFE.rb1801&#39;] # context.ratio交易最大资金比率 context.ratio = 0.8 # 订阅context.goods里面的品种, bar频率为1min subscribe(symbols=context.goods, frequency=&#39;60s&#39;, count=101) # 止损的比例区间 &nbsp; &nbsp; def on_bar(context, bars): bar = bars[0] symbol = bar[&#39;symbol&#39;] recent_data = context.data(symbol=symbol, frequency=&#39;60s&#39;, count=101, fields=&#39;close,high,low&#39;) close = recent_data[&#39;close&#39;].values[-1] # 计算ATR atr = talib.ATR(recent_data[&#39;high&#39;].values, recent_data[&#39;low&#39;].values, recent_data[&#39;close&#39;].values, timeperiod=context.tar)[-1] # 计算唐奇安开仓和平仓通道 context.don_open = context.parameter[0] + 1 upper_band = talib.MAX(recent_data[&#39;close&#39;].values[:-1], timeperiod=context.don_open)[-1] context.don_close = context.parameter[1] + 1 lower_band = talib.MIN(recent_data[&#39;close&#39;].values[:-1], timeperiod=context.don_close)[-1] # 计算开仓的资金比例 percent = context.ratio / float(len(context.goods)) # 若没有仓位则开仓 position_long = context.account().position(symbol=symbol, side=PositionSide_Long) position_short = context.account().position(symbol=symbol, side=PositionSide_Short) if not position_long and not position_short: # 计算长短ma线.DIF ma_short = talib.MA(recent_data[&#39;close&#39;].values, timeperiod=(context.parameter[2] + 1))[-1] ma_long = talib.MA(recent_data[&#39;close&#39;].values, timeperiod=(context.parameter[3] + 1))[-1] dif = ma_short - ma_long # 获取当前价格 # 上穿唐奇安通道且短ma在长ma上方则开多仓 if close &gt; upper_band and (dif &gt; 0): order_target_percent(symbol=symbol, percent=percent, order_type=OrderType_Market, position_side=PositionSide_Long) print(symbol, &#39;市价单开多仓到比例: &#39;, percent) # 下穿唐奇安通道且短ma在长ma下方则开空仓 if close &lt; lower_band and (dif &lt; 0): order_target_percent(symbol=symbol, percent=percent, order_type=OrderType_Market, position_side=PositionSide_Short) print(symbol, &#39;市价单开空仓到比例: &#39;, percent) elif position_long: # 价格跌破唐奇安平仓通道全平仓位止损 if close &lt; lower_band: order_close_all() print(symbol, &#39;市价单全平仓位&#39;) else: # 获取持仓均价 vwap = position_long[&#39;vwap&#39;] # 获取持仓的资金 money = position_long[&#39;cost&#39;] # 获取平仓的区间 band = vwap - np.array([200, 2, 1.5, 1, 0.5, -100]) * atr grid_percent = float(pd.cut([close], band, labels=[0, 0.25, 0.5, 0.75, 1])[0]) * percent # 选择现有百分比和区间百分比中较小的值(避免开仓) target_percent = np.minimum(money / context.account().cash[&#39;nav&#39;], grid_percent) if target_percent != 1.0: print(symbol, &#39;市价单平多仓到比例: &#39;, target_percent) order_target_percent(symbol=symbol, percent=target_percent, order_type=OrderType_Market, position_side=PositionSide_Long) &nbsp; elif position_short: # 价格涨破唐奇安平仓通道或价格涨破持仓均价加两倍ATR平空仓 if close &gt; upper_band: order_close_all() print(symbol, &#39;市价单全平仓位&#39;) else: # 获取持仓均价 vwap = position_short[&#39;vwap&#39;] # 获取持仓的资金 money = position_short[&#39;cost&#39;] # 获取平仓的区间 band = vwap + np.array([-100, 0.5, 1, 1.5, 2, 200]) * atr grid_percent = float(pd.cut([close], band, labels=[1, 0.75, 0.5, 0.25, 0])[0]) * percent # 选择现有百分比和区间百分比中较小的值(避免开仓) target_percent = np.minimum(money / context.account().cash[&#39;nav&#39;], grid_percent) if target_percent != 1.0: order_target_percent(symbol=symbol, percent=target_percent, order_type=OrderType_Market, position_side=PositionSide_Short) print(symbol, &#39;市价单平空仓到比例: &#39;, target_percent) &nbsp; &nbsp; if __name__ == &#39;__main__&#39;: &#39;&#39;&#39; strategy_id策略ID,由系统生成 filename文件名,请与本文件名保持一致 mode实时模式:MODE_LIVE回测模式:MODE_BACKTEST token绑定计算机的ID,可在系统设置-密钥管理中生成 backtest_start_time回测开始时间 backtest_end_time回测结束时间 backtest_adjust股票复权方式不复权:ADJUST_NONE前复权:ADJUST_PREV后复权:ADJUST_POST backtest_initial_cash回测初始资金 backtest_commission_ratio回测佣金比例 backtest_slippage_ratio回测滑点比例 &#39;&#39;&#39; run(strategy_id=&#39;strategy_id&#39;, filename=&#39;main.py&#39;, mode=MODE_BACKTEST, token=&#39;token_id&#39;, backtest_start_time=&#39;2017-09-15 09:15:00&#39;, backtest_end_time=&#39;2017-10-01 15:00:00&#39;, backtest_adjust=ADJUST_PREV, backtest_initial_cash=10000000, backtest_commission_ratio=0.0001, backtest_slippage_ratio=0.0001) 文章来源：掘金量化交易平台&nbsp; &nbsp; &nbsp;转载请注明出处！ ----------------------------------------------------------------------------------------------------------------------------------------------------------- 更多策略源码查看： 1 双均线策略(期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/153 2 alpha对冲(股票+期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/101 3 集合竞价选股(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/102 4 多因子选股(股票)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/103 5 网格交易(期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/104 6 指数增强(股票)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/105 7 跨品种套利(期货)量化策略源码 https://www.myquant.cn/docs/python_strategyies/106 8 跨期套利(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/107 9 日内回转交易(股票)量化策略源码 https://www.myquant.cn/docs/python_strategyies/108 10 做市商交易(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/109 11 海龟交易法(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/110 12 行业轮动(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/111 13 机器学习(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/112 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/06/04/c7e81983d59413b35246121bd6495dd7.html" />
<meta property="og:url" content="https://mlh.app/2018/06/04/c7e81983d59413b35246121bd6495dd7.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-04T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"海龟交易法则简介 什么是海龟交易法则？ ​ ​ 1983年年中，著名的商品投机家理查德.丹尼斯与他的老友比尔.埃克哈特进行了一场辩论，这场辩论是关于伟大的交易员是天生造就还是后天培养的。理查德相信，他可以教会人们成为伟大的交易员。比尔则认为遗传和天性才是决定因素。 ​ 为了解决这一问题，理查德建议招募并培训一些交易员，给他们提供真实的帐户进行交易，看看两个人中谁是正确的。 ​ 他们在《巴伦氏》、《华尔街期刊》和《纽约时报》上刊登了大幅广告，招聘交易学员。广告中称，在一个短暂的培训会后，新手将被提供一个帐户进行交易。 ​ 理查德从报名的人中精选出13个人，1983年12月底，学员被邀请到芝加哥进行两周的培训，到1984年1月初，开始用小帐户进行交易。到了2月初，在学员证明了自己的能力之后，丹尼斯给其中的大多数人提供了50万至200万美元的资金帐户。 ​ “学员们被称为‘海龟’（丹尼斯先生说这项计划开始时他刚刚从亚洲回来，他解释了自己向别人说过的话，‘我们正在成长为交易员，就象在新加坡他们正在成长为海龟一样’）。”----斯坦利.W.安格瑞斯特，《华尔街期刊》，1989年9月5日 ​ 海龟成为交易史上最著名的实验，因为在随后的四年中这些海龟交易员取得了年均复利80%的收益。 ​ 是的，里克证明了交易可以被传授。他证明了用一套简单的法则，他可以使仅有很少或根本没有交易经验的人成为优秀的交易员。而这个交易法则被后世称为“海龟交易法则”。 海龟交易法则具体内容 海龟交易法则：海龟交易法则属于趋势交易，首先建立唐奇安通道（下文会具体解释），即确定上突破线和下突破线，如果价格突破上线，则做多，如果价格突破下线就平仓或做空。 唐奇安通道与开仓 唐奇安通道，作为一个通道必定有上线和下线，上线就是前N1日内的最高价，下线就是前N2日内的最低价，一般来说N1=20，N2=10；然后，价格上穿就买，下穿就卖，就是这么简单。 但是仅仅只用唐奇安通道进行买卖，其实效果跟MACD线等其他趋势策略的效果差不多，并没有更优 ATR与仓位管理 海龟交易法则最核心的部分，在于仓位的控制，这种止损会让你基准的亏损不超过总资金的n%，所以这部分的思想是需要我们学习的。 当日的真实波幅TR（true range） 计算当日真实波幅公式 ​ TR_1=Max(H_1−L_1,H_1−C_0,C_0−L_1) 其中，下表1代表当日，下表0代表昨日，C_0是昨日开盘价close，H是最高价high，L是最低价low。 平均波幅ATR（Average true range） 一般取前20日的平均TR。 ​ ATR{20}=mean(TR_1,TR_2…TR{19},TR_{20}) 其中，公式mean(X_1,X_2)代表求X_1和X_2的平均数。 这时候我们已经求出ATR，这个数字可以当做衡量今天的价格波幅的基准，为1单位，比如现在价格是100元，基准波幅ATR=4元，代表今天基准波幅在98-102元，如果是2倍ATR，波幅就在96-104元。 仓位管理 在仅讨论多头的情况下： 1、如果标的价格跌破&quot;持仓均价-0.5（1、1.5、2）倍的ATR&quot;，则平仓至原始仓位的75%（50%，25%，0%）。 2、如果标的价格跌破唐奇安通道下轨，则全平仓。 海龟交易法则策略实现（基于掘金量化平台） 策略思想 当价格上穿唐奇安通道且短MA在长MA上方时开多仓;当价格下穿唐奇安通道且短MA在长MA下方时开空仓(8手) 若有多仓则在价格跌破唐奇安平仓通道下轨的时候全平仓位,否则根据跌破持仓均价 - x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手 若有空仓则在价格涨破唐奇安平仓通道上轨的时候全平仓位,否则根据涨破持仓均价 + x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手 策略主要步骤实现 订阅数据 subscribe(symbols=symbols, frequency=&#39;1d&#39;, count=31, wait_group=True)(symbols=symbols, frequency=&#39;1d&#39;, count=31, wait_group=True) ​ 订阅数据需要在定义init函数里面设置，并调用subscribe函数，这里注意，我们需要通过计算前三十根bars来作为开平仓的标准，并在当前bar上做出开平仓操作，所以需要获取31根bar： symbols 需要设置订阅的标的代码。 frequency需设置订阅数据的周期级别，这里设置1d 表示以一天为周期。 count需要设置获取的bar的数量 数据获取 data = context.data(symbol=symbol, frequency=&#39;1d&#39;, count=31, fields=&#39;close&#39;) = context.data(symbol=symbol, frequency=&#39;1d&#39;, count=31, fields=&#39;close&#39;) ​ 订阅数据之后，需要获取已经订阅的数据来进行操作，这时需调用context.data函数： symbols 需要设置订阅的标的代码。 frequency需设置订阅数据的周期级别，这里设置1d表示以一天为周期。 count需要设置获取的bar的数量 fields需要设置返回值的种类 获取持仓信息 position_long = context.account().position(symbol=symbol, side=PositionSide_Long) ​ position_short = context.account().position(symbol=symbol, side=PositionSide_Short) = context.account().position(symbol=symbol, side=PositionSide_Long) ​ position_short = context.account().position(symbol=symbol, side=PositionSide_Short) ​ 在判断平仓条件时，需要获取持仓信息（包含持仓均价），这就需要调用context.account().position函数： symbols 需要设置订阅的标的代码。 side需要设置持仓方向，有PositionSide_Long和PositionSide_Short两个选择。 策略回测分析 回测报告 分析 ​ 我们选取了2017年6月至2017年12月作为回测周期，“RB1801”与“FG801”作为标的合约，均线长短周期分别为5d，20d，唐奇安通道上下轨计算周期分别为20d，10d，ATR计算周期为20d，可以看出： 胜率（具有盈利的平仓次数与总平仓次数之比）达到了34.48%，因为海龟交易法则为趋势跟踪策略，所以胜率不会太高。 卡玛比率（年化收益率与历史最大回撤之比）是使用最大回撤率来衡量风险。采用最大回撤率来衡量风险，关注的是最极端的情况。卡玛比率越高表示策略承受每单位最大损失获得的报酬越高。在这里卡玛比率超过了9。 夏普比率（年化收益率减无风险收益率的差收益波动率之比）超过2.5，也即承受1单位的风险，会有超过2.5个单位的收益回报。 策略收益曲线整体相对稳定，适合稳定型投资者，最大回撤极小，另外，策略在趋势行情行情中表现更加。 &nbsp; 海龟交易策略源码： &nbsp; &nbsp; # coding=utf-8 from __future__ import print_function, absolute_import, unicode_literals &nbsp; import numpy as np import pandas as pd try: import talib except: print(&#39;请安装TA-Lib库&#39;) from gm.api import * &nbsp; &#39;&#39;&#39; 本策略通过计算CZCE.FG801和SHFE.rb1801的ATR.唐奇安通道和MA线,并: 上穿唐奇安通道且短MA在长MA上方则开多仓,下穿唐奇安通道且短MA在长MA下方则开空仓 若有 多/空 仓位则分别: 价格 跌/涨 破唐奇安平仓通道 上/下 轨则全平仓位,否则 根据 跌/涨 破持仓均价 -/+ x(x=0.5,1,1.5,2)倍ATR把仓位 回测数据为:CZCE.FG801和SHFE.rb1801的1min数据 回测时间为:2017-09-15 09:15:00到2017-10-01 15:00:00 &#39;&#39;&#39; &nbsp; &nbsp; def init(context): # context.parameter分别为唐奇安开仓通道.唐奇安平仓通道.短ma.长ma.ATR的参数 context.parameter = [55, 20, 10, 60, 20] context.tar = context.parameter[4] # context.goods交易的品种 context.goods = [&#39;CZCE.FG801&#39;, &#39;SHFE.rb1801&#39;] # context.ratio交易最大资金比率 context.ratio = 0.8 # 订阅context.goods里面的品种, bar频率为1min subscribe(symbols=context.goods, frequency=&#39;60s&#39;, count=101) # 止损的比例区间 &nbsp; &nbsp; def on_bar(context, bars): bar = bars[0] symbol = bar[&#39;symbol&#39;] recent_data = context.data(symbol=symbol, frequency=&#39;60s&#39;, count=101, fields=&#39;close,high,low&#39;) close = recent_data[&#39;close&#39;].values[-1] # 计算ATR atr = talib.ATR(recent_data[&#39;high&#39;].values, recent_data[&#39;low&#39;].values, recent_data[&#39;close&#39;].values, timeperiod=context.tar)[-1] # 计算唐奇安开仓和平仓通道 context.don_open = context.parameter[0] + 1 upper_band = talib.MAX(recent_data[&#39;close&#39;].values[:-1], timeperiod=context.don_open)[-1] context.don_close = context.parameter[1] + 1 lower_band = talib.MIN(recent_data[&#39;close&#39;].values[:-1], timeperiod=context.don_close)[-1] # 计算开仓的资金比例 percent = context.ratio / float(len(context.goods)) # 若没有仓位则开仓 position_long = context.account().position(symbol=symbol, side=PositionSide_Long) position_short = context.account().position(symbol=symbol, side=PositionSide_Short) if not position_long and not position_short: # 计算长短ma线.DIF ma_short = talib.MA(recent_data[&#39;close&#39;].values, timeperiod=(context.parameter[2] + 1))[-1] ma_long = talib.MA(recent_data[&#39;close&#39;].values, timeperiod=(context.parameter[3] + 1))[-1] dif = ma_short - ma_long # 获取当前价格 # 上穿唐奇安通道且短ma在长ma上方则开多仓 if close &gt; upper_band and (dif &gt; 0): order_target_percent(symbol=symbol, percent=percent, order_type=OrderType_Market, position_side=PositionSide_Long) print(symbol, &#39;市价单开多仓到比例: &#39;, percent) # 下穿唐奇安通道且短ma在长ma下方则开空仓 if close &lt; lower_band and (dif &lt; 0): order_target_percent(symbol=symbol, percent=percent, order_type=OrderType_Market, position_side=PositionSide_Short) print(symbol, &#39;市价单开空仓到比例: &#39;, percent) elif position_long: # 价格跌破唐奇安平仓通道全平仓位止损 if close &lt; lower_band: order_close_all() print(symbol, &#39;市价单全平仓位&#39;) else: # 获取持仓均价 vwap = position_long[&#39;vwap&#39;] # 获取持仓的资金 money = position_long[&#39;cost&#39;] # 获取平仓的区间 band = vwap - np.array([200, 2, 1.5, 1, 0.5, -100]) * atr grid_percent = float(pd.cut([close], band, labels=[0, 0.25, 0.5, 0.75, 1])[0]) * percent # 选择现有百分比和区间百分比中较小的值(避免开仓) target_percent = np.minimum(money / context.account().cash[&#39;nav&#39;], grid_percent) if target_percent != 1.0: print(symbol, &#39;市价单平多仓到比例: &#39;, target_percent) order_target_percent(symbol=symbol, percent=target_percent, order_type=OrderType_Market, position_side=PositionSide_Long) &nbsp; elif position_short: # 价格涨破唐奇安平仓通道或价格涨破持仓均价加两倍ATR平空仓 if close &gt; upper_band: order_close_all() print(symbol, &#39;市价单全平仓位&#39;) else: # 获取持仓均价 vwap = position_short[&#39;vwap&#39;] # 获取持仓的资金 money = position_short[&#39;cost&#39;] # 获取平仓的区间 band = vwap + np.array([-100, 0.5, 1, 1.5, 2, 200]) * atr grid_percent = float(pd.cut([close], band, labels=[1, 0.75, 0.5, 0.25, 0])[0]) * percent # 选择现有百分比和区间百分比中较小的值(避免开仓) target_percent = np.minimum(money / context.account().cash[&#39;nav&#39;], grid_percent) if target_percent != 1.0: order_target_percent(symbol=symbol, percent=target_percent, order_type=OrderType_Market, position_side=PositionSide_Short) print(symbol, &#39;市价单平空仓到比例: &#39;, target_percent) &nbsp; &nbsp; if __name__ == &#39;__main__&#39;: &#39;&#39;&#39; strategy_id策略ID,由系统生成 filename文件名,请与本文件名保持一致 mode实时模式:MODE_LIVE回测模式:MODE_BACKTEST token绑定计算机的ID,可在系统设置-密钥管理中生成 backtest_start_time回测开始时间 backtest_end_time回测结束时间 backtest_adjust股票复权方式不复权:ADJUST_NONE前复权:ADJUST_PREV后复权:ADJUST_POST backtest_initial_cash回测初始资金 backtest_commission_ratio回测佣金比例 backtest_slippage_ratio回测滑点比例 &#39;&#39;&#39; run(strategy_id=&#39;strategy_id&#39;, filename=&#39;main.py&#39;, mode=MODE_BACKTEST, token=&#39;token_id&#39;, backtest_start_time=&#39;2017-09-15 09:15:00&#39;, backtest_end_time=&#39;2017-10-01 15:00:00&#39;, backtest_adjust=ADJUST_PREV, backtest_initial_cash=10000000, backtest_commission_ratio=0.0001, backtest_slippage_ratio=0.0001) 文章来源：掘金量化交易平台&nbsp; &nbsp; &nbsp;转载请注明出处！ ----------------------------------------------------------------------------------------------------------------------------------------------------------- 更多策略源码查看： 1 双均线策略(期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/153 2 alpha对冲(股票+期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/101 3 集合竞价选股(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/102 4 多因子选股(股票)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/103 5 网格交易(期货)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/104 6 指数增强(股票)&nbsp; 量化策略源码 https://www.myquant.cn/docs/python_strategyies/105 7 跨品种套利(期货)量化策略源码 https://www.myquant.cn/docs/python_strategyies/106 8 跨期套利(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/107 9 日内回转交易(股票)量化策略源码 https://www.myquant.cn/docs/python_strategyies/108 10 做市商交易(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/109 11 海龟交易法(期货) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/110 12 行业轮动(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/111 13 机器学习(股票) 量化策略源码 https://www.myquant.cn/docs/python_strategyies/112 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/06/04/c7e81983d59413b35246121bd6495dd7.html","headline":"【策略研究】海龟交易法则（附源码）","dateModified":"2018-06-04T00:00:00+08:00","datePublished":"2018-06-04T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/06/04/c7e81983d59413b35246121bd6495dd7.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>【策略研究】海龟交易法则（附源码）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-7f5a1a725b.css"> 
 <div class="htmledit_views"> 
  <h1>海龟交易法则简介</h1> 
  <h3>什么是海龟交易法则？</h3> 
  <p>​ <img alt="" class="has" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180604132913743"></p> 
  <p>​ 1983年年中，著名的商品投机家理查德.丹尼斯与他的老友比尔.埃克哈特进行了一场辩论，这场辩论是关于伟大的交易员是天生造就还是后天培养的。理查德相信，他可以教会人们成为伟大的交易员。比尔则认为遗传和天性才是决定因素。</p> 
  <p>​ 为了解决这一问题，理查德建议招募并培训一些交易员，给他们提供真实的帐户进行交易，看看两个人中谁是正确的。</p> 
  <p>​ 他们在《巴伦氏》、《华尔街期刊》和《纽约时报》上刊登了大幅广告，招聘交易学员。广告中称，在一个短暂的培训会后，新手将被提供一个帐户进行交易。</p> 
  <p>​ 理查德从报名的人中精选出13个人，1983年12月底，学员被邀请到芝加哥进行两周的培训，到1984年1月初，开始用小帐户进行交易。到了2月初，在学员证明了自己的能力之后，丹尼斯给其中的大多数人提供了50万至200万美元的资金帐户。</p> 
  <p>​ “学员们被称为‘海龟’（丹尼斯先生说这项计划开始时他刚刚从亚洲回来，他解释了自己向别人说过的话，‘我们正在成长为交易员，就象在新加坡他们正在成长为海龟一样’）。”----斯坦利.W.安格瑞斯特，《华尔街期刊》，1989年9月5日</p> 
  <p>​ 海龟成为交易史上最著名的实验，因为在随后的四年中这些海龟交易员取得了年均复利80%的收益。</p> 
  <p>​ 是的，里克证明了交易可以被传授。他证明了用一套简单的法则，他可以使仅有很少或根本没有交易经验的人成为优秀的交易员。而这个交易法则被后世称为“海龟交易法则”。</p> 
  <h3>海龟交易法则具体内容</h3> 
  <p><strong>海龟交易法则：</strong>海龟交易法则属于趋势交易，首先建立唐奇安通道（下文会具体解释），即确定上突破线和下突破线，如果价格突破上线，则做多，如果价格突破下线就平仓或做空。</p> 
  <p>唐奇安通道与开仓</p> 
  <p>唐奇安通道，作为一个通道必定有上线和下线，上线就是前N1日内的最高价，下线就是前N2日内的最低价，一般来说N1=20，N2=10；然后，价格上穿就买，下穿就卖，就是这么简单。</p> 
  <p>但是仅仅只用唐奇安通道进行买卖，其实效果跟MACD线等其他趋势策略的效果差不多，并没有更优</p> 
  <p>ATR与仓位管理</p> 
  <p>海龟交易法则最核心的部分，在于仓位的控制，这种止损会让你基准的亏损不超过总资金的n%，所以这部分的思想是需要我们学习的。</p> 
  <p>当日的真实波幅TR（true range）</p> 
  <p>计算当日真实波幅公式</p> 
  <p>​ TR_1=Max(H_1−L_1,H_1−C_0,C_0−L_1)</p> 
  <p>其中，下表1代表当日，下表0代表昨日，C_0是昨日开盘价close，H是最高价high，L是最低价low。</p> 
  <p>平均波幅ATR（Average true range）</p> 
  <p>一般取前20日的平均TR。</p> 
  <p>​ ATR<em>{20}=mean(TR_1,TR_2…TR</em>{19},TR_{20})</p> 
  <p>其中，公式mean(X_1,X_2)代表求X_1和X_2的平均数。</p> 
  <p>这时候我们已经求出ATR，这个数字可以当做衡量今天的价格波幅的基准，为1单位，比如现在价格是100元，基准波幅ATR=4元，代表今天基准波幅在98-102元，如果是2倍ATR，波幅就在96-104元。</p> 
  <p>仓位管理</p> 
  <p>在仅讨论多头的情况下：</p> 
  <p>1、如果标的价格跌破"持仓均价-0.5（1、1.5、2）倍的ATR"，则平仓至原始仓位的75%（50%，25%，0%）。</p> 
  <p>2、如果标的价格跌破唐奇安通道下轨，则全平仓。</p> 
  <h2>海龟交易法则策略实现（基于<a href="http://myquant.cn" rel="nofollow">掘金量化平台</a>）</h2> 
  <h3>策略思想</h3> 
  <ul>
   <li style="margin-left:0px;"> <p>当价格上穿唐奇安通道且短MA在长MA上方时开多仓;当价格下穿唐奇安通道且短MA在长MA下方时开空仓(8手)</p> </li> 
   <li style="margin-left:0px;"> <p>若有多仓则在价格跌破唐奇安平仓通道下轨的时候全平仓位,否则根据跌破持仓均价 - x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手</p> </li> 
   <li style="margin-left:0px;"> <p>若有空仓则在价格涨破唐奇安平仓通道上轨的时候全平仓位,否则根据涨破持仓均价 + x(x=0.5,1,1.5,2)倍ATR把仓位平至6/4/2/0手</p> </li> 
  </ul>
  <h3>策略主要步骤实现</h3> 
  <p>订阅数据</p> 
  <pre class="has">
<code class="language-md-end-block"><span style="color:#000000;">subscribe</span>(<span style="color:#000000;">symbols</span>=<span style="color:#000000;">symbols</span>, <span style="color:#000000;">frequency</span>=<span style="color:#aa1111;">'1d'</span>, <span style="color:#000000;">count</span>=<span style="color:#116644;">31</span>, <span style="color:#000000;">wait_group</span>=<span style="color:#770088;">True</span>)</code>(<span style="color:#000000;">symbols</span>=<span style="color:#000000;">symbols</span>, <span style="color:#000000;">frequency</span>=<span style="color:#aa1111;">'1d'</span>, <span style="color:#000000;">count</span>=<span style="color:#116644;">31</span>, <span style="color:#000000;">wait_group</span>=<span style="color:#770088;">True</span>)</pre> 
  <p>​ 订阅数据需要在定义<code>init</code>函数里面设置，并调用<code>subscribe</code>函数，这里注意，我们需要通过计算前三十根bars来作为开平仓的标准，并在当前bar上做出开平仓操作，所以需要获取31根bar：</p> 
  <ul>
   <li style="margin-left:0px;"> <p><code>symbols</code> 需要设置订阅的标的代码。</p> </li> 
   <li style="margin-left:0px;"> <p><code>frequency</code>需设置订阅数据的周期级别，这里设置<code>1d</code> 表示以一天为周期。</p> </li> 
   <li style="margin-left:0px;"> <p><code>count</code>需要设置获取的bar的数量</p> </li> 
  </ul>
  <p>数据获取</p> 
  <pre class="has">
<code class="language-md-end-block"><span style="color:#000000;">data</span> = <span style="color:#000000;">context</span>.<span style="color:#000000;">data</span>(<span style="color:#000000;">symbol</span>=<span style="color:#000000;">symbol</span>, <span style="color:#000000;">frequency</span>=<span style="color:#aa1111;">'1d'</span>, <span style="color:#000000;">count</span>=<span style="color:#116644;">31</span>, <span style="color:#000000;">fields</span>=<span style="color:#aa1111;">'close'</span>)</code> = <span style="color:#000000;">context</span>.<span style="color:#000000;">data</span>(<span style="color:#000000;">symbol</span>=<span style="color:#000000;">symbol</span>, <span style="color:#000000;">frequency</span>=<span style="color:#aa1111;">'1d'</span>, <span style="color:#000000;">count</span>=<span style="color:#116644;">31</span>, <span style="color:#000000;">fields</span>=<span style="color:#aa1111;">'close'</span>)</pre> 
  <p>​ 订阅数据之后，需要获取已经订阅的数据来进行操作，这时需调用<code>context.data</code>函数：</p> 
  <ul>
   <li style="margin-left:0px;"> <p><code>symbols</code> 需要设置订阅的标的代码。</p> </li> 
   <li style="margin-left:0px;"> <p><code>frequency</code>需设置订阅数据的周期级别，这里设置<code>1d</code>表示以一天为周期。</p> </li> 
   <li style="margin-left:0px;"> <p><code>count</code>需要设置获取的bar的数量</p> </li> 
   <li style="margin-left:0px;"> <p><code>fields</code>需要设置返回值的种类</p> </li> 
  </ul>
  <p>获取持仓信息</p> 
  <pre class="has">
<code class="language-md-end-block"><span style="color:#000000;">position_long</span> = <span style="color:#000000;">context</span>.<span style="color:#000000;">account</span>().<span style="color:#000000;">position</span>(<span style="color:#000000;">symbol</span>=<span style="color:#000000;">symbol</span>, <span style="color:#000000;">side</span>=<span style="color:#000000;">PositionSide_Long</span>)
​
<span style="color:#000000;">position_short</span> = <span style="color:#000000;">context</span>.<span style="color:#000000;">account</span>().<span style="color:#000000;">position</span>(<span style="color:#000000;">symbol</span>=<span style="color:#000000;">symbol</span>, <span style="color:#000000;">side</span>=<span style="color:#000000;">PositionSide_Short</span>)</code> = <span style="color:#000000;">context</span>.<span style="color:#000000;">account</span>().<span style="color:#000000;">position</span>(<span style="color:#000000;">symbol</span>=<span style="color:#000000;">symbol</span>, <span style="color:#000000;">side</span>=<span style="color:#000000;">PositionSide_Long</span>)
​
<span style="color:#000000;">position_short</span> = <span style="color:#000000;">context</span>.<span style="color:#000000;">account</span>().<span style="color:#000000;">position</span>(<span style="color:#000000;">symbol</span>=<span style="color:#000000;">symbol</span>, <span style="color:#000000;">side</span>=<span style="color:#000000;">PositionSide_Short</span>)</pre> 
  <p>​ 在判断平仓条件时，需要获取持仓信息（包含持仓均价），这就需要调用<code>context.account().position</code>函数：</p> 
  <ul>
   <li style="margin-left:0px;"> <p><code>symbols</code> 需要设置订阅的标的代码。</p> </li> 
   <li style="margin-left:0px;"> <p><code>side</code>需要设置持仓方向，有<code>PositionSide_Long</code>和<code>PositionSide_Short</code>两个选择。</p> </li> 
  </ul>
  <h3>策略回测分析</h3> 
  <p>回测报告</p> 
  <p><img alt="" class="has" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180604133210572"></p> 
  <p>分析</p> 
  <p>​ 我们选取了2017年6月至2017年12月作为回测周期，“RB1801”与“FG801”作为标的合约，均线长短周期分别为5d，20d，唐奇安通道上下轨计算周期分别为20d，10d，ATR计算周期为20d，可以看出：</p> 
  <ul>
   <li style="margin-left:0px;"> <p><strong>胜率</strong>（具有盈利的平仓次数与总平仓次数之比）达到了34.48%，因为海龟交易法则为趋势跟踪策略，所以胜率不会太高。</p> </li> 
  </ul>
  <ul>
   <li style="margin-left:0px;"> <p><strong>卡玛比率</strong>（年化收益率与历史最大回撤之比）是使用<strong>最大回撤率</strong>来衡量风险。<strong>采用最大回撤率来衡量风险，关注的是最极端的情况。</strong>卡玛比率越高表示策略承受每单位最大损失获得的报酬越高。在这里卡玛比率超过了9。</p> </li> 
  </ul>
  <ul>
   <li style="margin-left:0px;"> <p><strong>夏普比率</strong>（年化收益率减无风险收益率的差收益波动率之比）超过2.5，也即承受1单位的风险，会有超过2.5个单位的收益回报。</p> </li> 
  </ul>
  <ul>
   <li style="margin-left:0px;"> <p><strong>策略收益曲线</strong>整体相对稳定，适合稳定型投资者，最大回撤极小，另外，策略在趋势行情行情中表现更加。</p> </li> 
  </ul>
  <p>&nbsp;</p> 
  <p><strong><a href="https://www.myquant.cn/docs/python_strategyies/110" rel="nofollow">海龟交易策略源码：</a></strong></p> 
  <p>&nbsp;</p> 
  <pre>

&nbsp;</pre> 
  <ol>
   <li><code><span style="color:#880000;"># coding=utf-8</span></code></li> 
   <li><code><span style="color:#000088;">from</span><span style="color:#000000;"> __future__ </span><span style="color:#000088;">import</span><span style="color:#000000;"> print_function</span><span style="color:#666600;">,</span><span style="color:#000000;"> absolute_import</span><span style="color:#666600;">,</span><span style="color:#000000;"> unicode_literals</span></code></li> 
   <li>&nbsp;</li> 
   <li><code><span style="color:#000088;">import</span><span style="color:#000000;"> numpy </span><span style="color:#000088;">as</span><span style="color:#000000;"> np</span></code></li> 
   <li><code><span style="color:#000088;">import</span><span style="color:#000000;"> pandas </span><span style="color:#000088;">as</span><span style="color:#000000;"> pd</span></code></li> 
   <li><code><span style="color:#000088;">try</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#000088;">import</span><span style="color:#000000;"> talib</span></code></li> 
   <li><code><span style="color:#000088;">except</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#008800;">'请安装TA-Lib库'</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">from</span><span style="color:#000000;"> gm</span><span style="color:#666600;">.</span><span style="color:#000000;">api </span><span style="color:#000088;">import</span><span style="color:#000000;"> </span><span style="color:#666600;">*</span></code></li> 
   <li>&nbsp;</li> 
   <li><code><span style="color:#008800;">'''</span></code></li> 
   <li><code><span style="color:#008800;">本策略通过计算CZCE.FG801和SHFE.rb1801的ATR.唐奇安通道和MA线,并:</span></code></li> 
   <li><code><span style="color:#008800;">上穿唐奇安通道且短MA在长MA上方则开多仓,下穿唐奇安通道且短MA在长MA下方则开空仓</span></code></li> 
   <li><code><span style="color:#008800;">若有 多/空 仓位则分别:</span></code></li> 
   <li><code><span style="color:#008800;">价格 跌/涨 破唐奇安平仓通道 上/下 轨则全平仓位,否则</span></code></li> 
   <li><code><span style="color:#008800;">根据 跌/涨 破持仓均价 -/+ x(x=0.5,1,1.5,2)倍ATR把仓位</span></code></li> 
   <li><code><span style="color:#008800;">回测数据为:CZCE.FG801和SHFE.rb1801的1min数据</span></code></li> 
   <li><code><span style="color:#008800;">回测时间为:2017-09-15 09:15:00到2017-10-01 15:00:00</span></code></li> 
   <li><code><span style="color:#008800;">'''</span></code></li> 
   <li>&nbsp;</li> 
   <li>&nbsp;</li> 
   <li><code><span style="color:#000088;">def</span><span style="color:#000000;"> init</span><span style="color:#666600;">(</span><span style="color:#000000;">context</span><span style="color:#666600;">):</span></code></li> 
   <li><code><span style="color:#880000;"># context.parameter分别为唐奇安开仓通道.唐奇安平仓通道.短ma.长ma.ATR的参数</span></code></li> 
   <li><code><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">parameter </span><span style="color:#666600;">=</span><span style="color:#000000;"> </span><span style="color:#666600;">[</span><span style="color:#006666;">55</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">20</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">10</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">60</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">20</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">tar </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">parameter</span><span style="color:#666600;">[</span><span style="color:#006666;">4</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># context.goods交易的品种</span></code></li> 
   <li><code><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">goods </span><span style="color:#666600;">=</span><span style="color:#000000;"> </span><span style="color:#666600;">[</span><span style="color:#008800;">'CZCE.FG801'</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'SHFE.rb1801'</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># context.ratio交易最大资金比率</span></code></li> 
   <li><code><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">ratio </span><span style="color:#666600;">=</span><span style="color:#000000;"> </span><span style="color:#006666;">0.8</span></code></li> 
   <li><code><span style="color:#880000;"># 订阅context.goods里面的品种, bar频率为1min</span></code></li> 
   <li><code><span style="color:#000000;">subscribe</span><span style="color:#666600;">(</span><span style="color:#000000;">symbols</span><span style="color:#666600;">=</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">goods</span><span style="color:#666600;">,</span><span style="color:#000000;"> frequency</span><span style="color:#666600;">=</span><span style="color:#008800;">'60s'</span><span style="color:#666600;">,</span><span style="color:#000000;"> count</span><span style="color:#666600;">=</span><span style="color:#006666;">101</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#880000;"># 止损的比例区间</span></code></li> 
   <li>&nbsp;</li> 
   <li>&nbsp;</li> 
   <li><code><span style="color:#000088;">def</span><span style="color:#000000;"> on_bar</span><span style="color:#666600;">(</span><span style="color:#000000;">context</span><span style="color:#666600;">,</span><span style="color:#000000;"> bars</span><span style="color:#666600;">):</span></code></li> 
   <li><code><span style="color:#000000;">bar </span><span style="color:#666600;">=</span><span style="color:#000000;"> bars</span><span style="color:#666600;">[</span><span style="color:#006666;">0</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#000000;">symbol </span><span style="color:#666600;">=</span><span style="color:#000000;"> bar</span><span style="color:#666600;">[</span><span style="color:#008800;">'symbol'</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#000000;">recent_data </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">data</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> frequency</span><span style="color:#666600;">=</span><span style="color:#008800;">'60s'</span><span style="color:#666600;">,</span><span style="color:#000000;"> count</span><span style="color:#666600;">=</span><span style="color:#006666;">101</span><span style="color:#666600;">,</span><span style="color:#000000;"> fields</span><span style="color:#666600;">=</span><span style="color:#008800;">'close,high,low'</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000000;">close </span><span style="color:#666600;">=</span><span style="color:#000000;"> recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'close'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">[-</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 计算ATR</span></code></li> 
   <li><code><span style="color:#000000;">atr </span><span style="color:#666600;">=</span><span style="color:#000000;"> talib</span><span style="color:#666600;">.</span><span style="color:#000000;">ATR</span><span style="color:#666600;">(</span><span style="color:#000000;">recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'high'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">,</span><span style="color:#000000;"> recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'low'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">,</span><span style="color:#000000;"> recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'close'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">timeperiod</span><span style="color:#666600;">=</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">tar</span><span style="color:#666600;">)[-</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 计算唐奇安开仓和平仓通道</span></code></li> 
   <li><code><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">don_open </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">parameter</span><span style="color:#666600;">[</span><span style="color:#006666;">0</span><span style="color:#666600;">]</span><span style="color:#000000;"> </span><span style="color:#666600;">+</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span></code></li> 
   <li><code><span style="color:#000000;">upper_band </span><span style="color:#666600;">=</span><span style="color:#000000;"> talib</span><span style="color:#666600;">.</span><span style="color:#000000;">MAX</span><span style="color:#666600;">(</span><span style="color:#000000;">recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'close'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">[:-</span><span style="color:#006666;">1</span><span style="color:#666600;">],</span><span style="color:#000000;"> timeperiod</span><span style="color:#666600;">=</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">don_open</span><span style="color:#666600;">)[-</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">don_close </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">parameter</span><span style="color:#666600;">[</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span><span style="color:#000000;"> </span><span style="color:#666600;">+</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span></code></li> 
   <li><code><span style="color:#000000;">lower_band </span><span style="color:#666600;">=</span><span style="color:#000000;"> talib</span><span style="color:#666600;">.</span><span style="color:#000000;">MIN</span><span style="color:#666600;">(</span><span style="color:#000000;">recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'close'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">[:-</span><span style="color:#006666;">1</span><span style="color:#666600;">],</span><span style="color:#000000;"> timeperiod</span><span style="color:#666600;">=</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">don_close</span><span style="color:#666600;">)[-</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 计算开仓的资金比例</span></code></li> 
   <li><code><span style="color:#000000;">percent </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">ratio </span><span style="color:#666600;">/</span><span style="color:#000000;"> float</span><span style="color:#666600;">(</span><span style="color:#000000;">len</span><span style="color:#666600;">(</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">goods</span><span style="color:#666600;">))</span></code></li> 
   <li><code><span style="color:#880000;"># 若没有仓位则开仓</span></code></li> 
   <li><code><span style="color:#000000;">position_long </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">account</span><span style="color:#666600;">().</span><span style="color:#000000;">position</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> side</span><span style="color:#666600;">=</span><span style="color:#660066;">PositionSide_Long</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000000;">position_short </span><span style="color:#666600;">=</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">account</span><span style="color:#666600;">().</span><span style="color:#000000;">position</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> side</span><span style="color:#666600;">=</span><span style="color:#660066;">PositionSide_Short</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> </span><span style="color:#000088;">not</span><span style="color:#000000;"> position_long </span><span style="color:#000088;">and</span><span style="color:#000000;"> </span><span style="color:#000088;">not</span><span style="color:#000000;"> position_short</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#880000;"># 计算长短ma线.DIF</span></code></li> 
   <li><code><span style="color:#000000;">ma_short </span><span style="color:#666600;">=</span><span style="color:#000000;"> talib</span><span style="color:#666600;">.</span><span style="color:#000000;">MA</span><span style="color:#666600;">(</span><span style="color:#000000;">recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'close'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">,</span><span style="color:#000000;"> timeperiod</span><span style="color:#666600;">=(</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">parameter</span><span style="color:#666600;">[</span><span style="color:#006666;">2</span><span style="color:#666600;">]</span><span style="color:#000000;"> </span><span style="color:#666600;">+</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span><span style="color:#666600;">))[-</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#000000;">ma_long </span><span style="color:#666600;">=</span><span style="color:#000000;"> talib</span><span style="color:#666600;">.</span><span style="color:#000000;">MA</span><span style="color:#666600;">(</span><span style="color:#000000;">recent_data</span><span style="color:#666600;">[</span><span style="color:#008800;">'close'</span><span style="color:#666600;">].</span><span style="color:#000000;">values</span><span style="color:#666600;">,</span><span style="color:#000000;"> timeperiod</span><span style="color:#666600;">=(</span><span style="color:#000000;">context</span><span style="color:#666600;">.</span><span style="color:#000000;">parameter</span><span style="color:#666600;">[</span><span style="color:#006666;">3</span><span style="color:#666600;">]</span><span style="color:#000000;"> </span><span style="color:#666600;">+</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span><span style="color:#666600;">))[-</span><span style="color:#006666;">1</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#000000;">dif </span><span style="color:#666600;">=</span><span style="color:#000000;"> ma_short </span><span style="color:#666600;">-</span><span style="color:#000000;"> ma_long</span></code></li> 
   <li><code><span style="color:#880000;"># 获取当前价格</span></code></li> 
   <li><code><span style="color:#880000;"># 上穿唐奇安通道且短ma在长ma上方则开多仓</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> close </span><span style="color:#666600;">&gt;</span><span style="color:#000000;"> upper_band </span><span style="color:#000088;">and</span><span style="color:#000000;"> </span><span style="color:#666600;">(</span><span style="color:#000000;">dif </span><span style="color:#666600;">&gt;</span><span style="color:#000000;"> </span><span style="color:#006666;">0</span><span style="color:#666600;">):</span></code></li> 
   <li><code><span style="color:#000000;">order_target_percent</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> percent</span><span style="color:#666600;">=</span><span style="color:#000000;">percent</span><span style="color:#666600;">,</span><span style="color:#000000;"> order_type</span><span style="color:#666600;">=</span><span style="color:#660066;">OrderType_Market</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">position_side</span><span style="color:#666600;">=</span><span style="color:#660066;">PositionSide_Long</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'市价单开多仓到比例: '</span><span style="color:#666600;">,</span><span style="color:#000000;"> percent</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#880000;"># 下穿唐奇安通道且短ma在长ma下方则开空仓</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> close </span><span style="color:#666600;">&lt;</span><span style="color:#000000;"> lower_band </span><span style="color:#000088;">and</span><span style="color:#000000;"> </span><span style="color:#666600;">(</span><span style="color:#000000;">dif </span><span style="color:#666600;">&lt;</span><span style="color:#000000;"> </span><span style="color:#006666;">0</span><span style="color:#666600;">):</span></code></li> 
   <li><code><span style="color:#000000;">order_target_percent</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> percent</span><span style="color:#666600;">=</span><span style="color:#000000;">percent</span><span style="color:#666600;">,</span><span style="color:#000000;"> order_type</span><span style="color:#666600;">=</span><span style="color:#660066;">OrderType_Market</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">position_side</span><span style="color:#666600;">=</span><span style="color:#660066;">PositionSide_Short</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'市价单开空仓到比例: '</span><span style="color:#666600;">,</span><span style="color:#000000;"> percent</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">elif</span><span style="color:#000000;"> position_long</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#880000;"># 价格跌破唐奇安平仓通道全平仓位止损</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> close </span><span style="color:#666600;">&lt;</span><span style="color:#000000;"> lower_band</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#000000;">order_close_all</span><span style="color:#666600;">()</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'市价单全平仓位'</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">else</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#880000;"># 获取持仓均价</span></code></li> 
   <li><code><span style="color:#000000;">vwap </span><span style="color:#666600;">=</span><span style="color:#000000;"> position_long</span><span style="color:#666600;">[</span><span style="color:#008800;">'vwap'</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 获取持仓的资金</span></code></li> 
   <li><code><span style="color:#000000;">money </span><span style="color:#666600;">=</span><span style="color:#000000;"> position_long</span><span style="color:#666600;">[</span><span style="color:#008800;">'cost'</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 获取平仓的区间</span></code></li> 
   <li><code><span style="color:#000000;">band </span><span style="color:#666600;">=</span><span style="color:#000000;"> vwap </span><span style="color:#666600;">-</span><span style="color:#000000;"> np</span><span style="color:#666600;">.</span><span style="color:#000000;">array</span><span style="color:#666600;">([</span><span style="color:#006666;">200</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">2</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">1.5</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.5</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#666600;">-</span><span style="color:#006666;">100</span><span style="color:#666600;">])</span><span style="color:#000000;"> </span><span style="color:#666600;">*</span><span style="color:#000000;"> atr</span></code></li> 
   <li><code><span style="color:#000000;">grid_percent </span><span style="color:#666600;">=</span><span style="color:#000000;"> float</span><span style="color:#666600;">(</span><span style="color:#000000;">pd</span><span style="color:#666600;">.</span><span style="color:#000000;">cut</span><span style="color:#666600;">([</span><span style="color:#000000;">close</span><span style="color:#666600;">],</span><span style="color:#000000;"> band</span><span style="color:#666600;">,</span><span style="color:#000000;"> labels</span><span style="color:#666600;">=[</span><span style="color:#006666;">0</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.25</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.5</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.75</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span><span style="color:#666600;">])[</span><span style="color:#006666;">0</span><span style="color:#666600;">])</span><span style="color:#000000;"> </span><span style="color:#666600;">*</span><span style="color:#000000;"> percent</span></code></li> 
   <li><code><span style="color:#880000;"># 选择现有百分比和区间百分比中较小的值(避免开仓)</span></code></li> 
   <li><code><span style="color:#000000;">target_percent </span><span style="color:#666600;">=</span><span style="color:#000000;"> np</span><span style="color:#666600;">.</span><span style="color:#000000;">minimum</span><span style="color:#666600;">(</span><span style="color:#000000;">money </span><span style="color:#666600;">/</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">account</span><span style="color:#666600;">().</span><span style="color:#000000;">cash</span><span style="color:#666600;">[</span><span style="color:#008800;">'nav'</span><span style="color:#666600;">],</span><span style="color:#000000;"> grid_percent</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> target_percent </span><span style="color:#666600;">!=</span><span style="color:#000000;"> </span><span style="color:#006666;">1.0</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'市价单平多仓到比例: '</span><span style="color:#666600;">,</span><span style="color:#000000;"> target_percent</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000000;">order_target_percent</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> percent</span><span style="color:#666600;">=</span><span style="color:#000000;">target_percent</span><span style="color:#666600;">,</span><span style="color:#000000;"> order_type</span><span style="color:#666600;">=</span><span style="color:#660066;">OrderType_Market</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">position_side</span><span style="color:#666600;">=</span><span style="color:#660066;">PositionSide_Long</span><span style="color:#666600;">)</span></code></li> 
   <li>&nbsp;</li> 
   <li><code><span style="color:#000088;">elif</span><span style="color:#000000;"> position_short</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#880000;"># 价格涨破唐奇安平仓通道或价格涨破持仓均价加两倍ATR平空仓</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> close </span><span style="color:#666600;">&gt;</span><span style="color:#000000;"> upper_band</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#000000;">order_close_all</span><span style="color:#666600;">()</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'市价单全平仓位'</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">else</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#880000;"># 获取持仓均价</span></code></li> 
   <li><code><span style="color:#000000;">vwap </span><span style="color:#666600;">=</span><span style="color:#000000;"> position_short</span><span style="color:#666600;">[</span><span style="color:#008800;">'vwap'</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 获取持仓的资金</span></code></li> 
   <li><code><span style="color:#000000;">money </span><span style="color:#666600;">=</span><span style="color:#000000;"> position_short</span><span style="color:#666600;">[</span><span style="color:#008800;">'cost'</span><span style="color:#666600;">]</span></code></li> 
   <li><code><span style="color:#880000;"># 获取平仓的区间</span></code></li> 
   <li><code><span style="color:#000000;">band </span><span style="color:#666600;">=</span><span style="color:#000000;"> vwap </span><span style="color:#666600;">+</span><span style="color:#000000;"> np</span><span style="color:#666600;">.</span><span style="color:#000000;">array</span><span style="color:#666600;">([-</span><span style="color:#006666;">100</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.5</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">1</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">1.5</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">2</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">200</span><span style="color:#666600;">])</span><span style="color:#000000;"> </span><span style="color:#666600;">*</span><span style="color:#000000;"> atr</span></code></li> 
   <li><code><span style="color:#000000;">grid_percent </span><span style="color:#666600;">=</span><span style="color:#000000;"> float</span><span style="color:#666600;">(</span><span style="color:#000000;">pd</span><span style="color:#666600;">.</span><span style="color:#000000;">cut</span><span style="color:#666600;">([</span><span style="color:#000000;">close</span><span style="color:#666600;">],</span><span style="color:#000000;"> band</span><span style="color:#666600;">,</span><span style="color:#000000;"> labels</span><span style="color:#666600;">=[</span><span style="color:#006666;">1</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.75</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.5</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0.25</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#006666;">0</span><span style="color:#666600;">])[</span><span style="color:#006666;">0</span><span style="color:#666600;">])</span><span style="color:#000000;"> </span><span style="color:#666600;">*</span><span style="color:#000000;"> percent</span></code></li> 
   <li><code><span style="color:#880000;"># 选择现有百分比和区间百分比中较小的值(避免开仓)</span></code></li> 
   <li><code><span style="color:#000000;">target_percent </span><span style="color:#666600;">=</span><span style="color:#000000;"> np</span><span style="color:#666600;">.</span><span style="color:#000000;">minimum</span><span style="color:#666600;">(</span><span style="color:#000000;">money </span><span style="color:#666600;">/</span><span style="color:#000000;"> context</span><span style="color:#666600;">.</span><span style="color:#000000;">account</span><span style="color:#666600;">().</span><span style="color:#000000;">cash</span><span style="color:#666600;">[</span><span style="color:#008800;">'nav'</span><span style="color:#666600;">],</span><span style="color:#000000;"> grid_percent</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> target_percent </span><span style="color:#666600;">!=</span><span style="color:#000000;"> </span><span style="color:#006666;">1.0</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#000000;">order_target_percent</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">=</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> percent</span><span style="color:#666600;">=</span><span style="color:#000000;">target_percent</span><span style="color:#666600;">,</span><span style="color:#000000;"> order_type</span><span style="color:#666600;">=</span><span style="color:#660066;">OrderType_Market</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">position_side</span><span style="color:#666600;">=</span><span style="color:#660066;">PositionSide_Short</span><span style="color:#666600;">)</span></code></li> 
   <li><code><span style="color:#000088;">print</span><span style="color:#666600;">(</span><span style="color:#000000;">symbol</span><span style="color:#666600;">,</span><span style="color:#000000;"> </span><span style="color:#008800;">'市价单平空仓到比例: '</span><span style="color:#666600;">,</span><span style="color:#000000;"> target_percent</span><span style="color:#666600;">)</span></code></li> 
   <li>&nbsp;</li> 
   <li>&nbsp;</li> 
   <li><code><span style="color:#000088;">if</span><span style="color:#000000;"> __name__ </span><span style="color:#666600;">==</span><span style="color:#000000;"> </span><span style="color:#008800;">'__main__'</span><span style="color:#666600;">:</span></code></li> 
   <li><code><span style="color:#008800;">'''</span></code></li> 
   <li><code><span style="color:#008800;">strategy_id策略ID,由系统生成</span></code></li> 
   <li><code><span style="color:#008800;">filename文件名,请与本文件名保持一致</span></code></li> 
   <li><code><span style="color:#008800;">mode实时模式:MODE_LIVE回测模式:MODE_BACKTEST</span></code></li> 
   <li><code><span style="color:#008800;">token绑定计算机的ID,可在系统设置-密钥管理中生成</span></code></li> 
   <li><code><span style="color:#008800;">backtest_start_time回测开始时间</span></code></li> 
   <li><code><span style="color:#008800;">backtest_end_time回测结束时间</span></code></li> 
   <li><code><span style="color:#008800;">backtest_adjust股票复权方式不复权:ADJUST_NONE前复权:ADJUST_PREV后复权:ADJUST_POST</span></code></li> 
   <li><code><span style="color:#008800;">backtest_initial_cash回测初始资金</span></code></li> 
   <li><code><span style="color:#008800;">backtest_commission_ratio回测佣金比例</span></code></li> 
   <li><code><span style="color:#008800;">backtest_slippage_ratio回测滑点比例</span></code></li> 
   <li><code><span style="color:#008800;">'''</span></code></li> 
   <li><code><span style="color:#000000;">run</span><span style="color:#666600;">(</span><span style="color:#000000;">strategy_id</span><span style="color:#666600;">=</span><span style="color:#008800;">'strategy_id'</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">filename</span><span style="color:#666600;">=</span><span style="color:#008800;">'main.py'</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">mode</span><span style="color:#666600;">=</span><span style="color:#000000;">MODE_BACKTEST</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">token</span><span style="color:#666600;">=</span><span style="color:#008800;">'token_id'</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">backtest_start_time</span><span style="color:#666600;">=</span><span style="color:#008800;">'2017-09-15 09:15:00'</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">backtest_end_time</span><span style="color:#666600;">=</span><span style="color:#008800;">'2017-10-01 15:00:00'</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">backtest_adjust</span><span style="color:#666600;">=</span><span style="color:#000000;">ADJUST_PREV</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">backtest_initial_cash</span><span style="color:#666600;">=</span><span style="color:#006666;">10000000</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">backtest_commission_ratio</span><span style="color:#666600;">=</span><span style="color:#006666;">0.0001</span><span style="color:#666600;">,</span></code></li> 
   <li><code><span style="color:#000000;">backtest_slippage_ratio</span><span style="color:#666600;">=</span><span style="color:#006666;">0.0001</span><span style="color:#666600;">)</span></code></li> 
  </ol>
  <p><img alt="" class="has" src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180604134111914"></p> 
  <p>文章来源：<a href="http://myquant.cn" rel="nofollow">掘金量化交易平台</a>&nbsp; &nbsp; &nbsp;转载请注明出处！</p> 
  <p>-----------------------------------------------------------------------------------------------------------------------------------------------------------</p> 
  <p><strong>更多策略源码查看：</strong></p> 
  <table cellspacing="0" style="width:512pt;">
   <tbody>
    <tr>
     <td style="text-align:center;vertical-align:middle;width:36pt;"><span style="color:#000000;">1</span></td> 
     <td style="vertical-align:bottom;width:197pt;"><span style="color:#000000;">双均线策略(期货)&nbsp; 量化策略源码</span></td> 
     <td style="vertical-align:bottom;width:279pt;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/153" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/153</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">2</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">alpha对冲(股票+期货)&nbsp; 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/101" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/101</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">3</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">集合竞价选股(股票) 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/102" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/102</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">4</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">多因子选股(股票)&nbsp; 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/103" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/103</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">5</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">网格交易(期货)&nbsp; 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/104" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/104</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">6</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">指数增强(股票)&nbsp; 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/105" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/105</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">7</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">跨品种套利(期货)量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/106" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/106</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">8</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">跨期套利(期货) 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/107" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/107</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">9</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">日内回转交易(股票)量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/108" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/108</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">10</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">做市商交易(期货) 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/109" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/109</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">11</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">海龟交易法(期货) 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/110" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/110</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">12</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">行业轮动(股票) 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/111" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/111</a></u></span></td> 
    </tr>
    <tr>
     <td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">13</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#000000;">机器学习(股票) 量化策略源码</span></td> 
     <td style="vertical-align:bottom;"><span style="color:#0563c1;"><u><a href="https://www.myquant.cn/docs/python_strategyies/112" rel="nofollow">https://www.myquant.cn/docs/python_strategyies/112</a></u></span></td> 
    </tr>
   </tbody>
  </table> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/myquant/article/details/80566076,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/myquant/article/details/80566076,&quot;}">阅读更多</a> 
</div> 
<script>
						(function(){
							function setArticleH(btnReadmore,posi){
								var winH = $(window).height();
								var articleBox = $("div.article_content");
								var artH = articleBox.height();
								if(artH > winH*posi){
									articleBox.css({
										'height':winH*posi+'px',
										'overflow':'hidden'
									})
									btnReadmore.click(function(){
										articleBox.removeAttr("style");
										$(this).parent().remove();
									})
								}else{
									btnReadmore.parent().remove();
								}
							}
							var btnReadmore = $("#btn-readmore");
							if(btnReadmore.length>0){
								if(currentUserName){
									setArticleH(btnReadmore,3);
								}else{
									setArticleH(btnReadmore,1.2);
								}
							}
						})()
					</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
