<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>以太坊(geth客户端)利用truffle部署智能合约 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="以太坊(geth客户端)利用truffle部署智能合约" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="开发环境：Ubuntu16.04 以太坊客户端:go-ethereum v1.7.3 第一步：node和npm安装(如果已经安装，请忽略该步骤) 官网下载node-v8.9.3-linux-x64.tar.xz 解压并移动到通用的软件安装目录 /opt/ tar -xJf node-v8.9.3-linux-x64.tar.xz sudo mv node-v8.9.3-linux-x64 /opt/ 安装 npm 和 node 命令到系统命令 sudo ln -s /opt/node-v8.9.3-linux-x64/bin/node /usr/local/bin/node sudo ln -s /opt/node-v8.9.3-linux-x64/bin/npm /usr/local/bin/npm 通过以下命令验证安装是否成功: node -v v8.9.3 npm -v 5.5.1 第二步：安装Truffle框架 sudo npm install -g truffle 通过以下命令验证truffle框架是否安装成功： truffle version 第三步：使用truffle进行智能合约的开发 (1)初始化一个 Truffle 项目 在用户自定义的目录下执行以下命令： mkdir test_truffle cd test_truffle truffle init 完成后，你将拥有如下目录： * contracts 智能合约目录 * migrations 发布脚本目录 * test 存放测试文件 * truffle.js Truffle的配置文件 (2)编译合约 进入到刚才的 test_truffle目录，执行&quot;truffle compile&quot;，可以将原始代码编译为以太坊认可的字节码。如果需要重新编译全部文件，可以执行&quot;truffle compile --compile-all&quot;命令。 (3)创建一个 合约并编译 在contracts目录中新建一个Hello_mshk_top.sol文件，代码如下： pragma solidity ^0.4.17; contract Hello_mshk_top { //say hello mshk.top function say() public pure returns (string) { return &quot;Hello mshk.top&quot;; } //print name function print(string name) public pure returns (string) { return name; } } 　编辑migrations/1_initial_migration.js部署脚本，将我们刚才创建的Hello_mshk_top.sol文件设置到发布配置文件中，内容如下： var Migrations = artifacts.require(&quot;./Migrations.sol&quot;); var Hello_mshk_top = artifacts.require(&quot;./Hello_mshk_top.sol&quot;); module.exports = function(deployer) { deployer.deploy(Migrations); deployer.deploy(Hello_mshk_top); }; 编译后的文件都放在了./build/contracts目录下：“./build/contracts/Hello_mshk_top.json&quot;，后面在部署到geth中，我们会用到。 第四步：部署智能合约 编辑truffle.js配置文件，设置我们稍后要部署智能合约的位置，内容如下： module.exports = { networks: { development: { host: &quot;localhost&quot;, port: 8545, network_id: &quot;*&quot; } } }; 该文件内容表示，我们在本地启动geth客户端，geth客户端的RPC端口为8545，geth的network_id不做限制。 (1)将智能合约部署到geth私链上 创世区块，使用RPC方式启动geth节点(此处略过) (2)新建账户、挖矿 (3)在geth中部署合约(执行该步骤之前，需要保证geth节点正常运行) truffle的智能合约项目部署，使用下面的命令：&quot;truffle migrate&quot;，这个命令会执行所有migrations目录下的js文件。使用 &quot;truffle migrate --reset&quot;命令，则会重新执行所有脚本的部署。 如果要部署到指定的网络，可以使用 &quot;truffle migrate --network live&quot;命令。 多个网络的配置如下： networks: { development: { host: &quot;localhost&quot;, port: 8545, network_id: &quot;*&quot; // match any network }, live: { host: &quot;178.25.19.88&quot;, // Random IP for example purposes (do not use) port: 80, network_id: 1, // Ethereum public network // optional config values: // gas Gas limit used for deploys. Default is 4712388 // gasPrice Gas price used for deploys. Default is 100000000000 (100 Shannon). // from - default address to use for any transaction Truffle makes during migrations // provider - web3 provider instance Truffle should use to talk to the Ethereum network. // - if specified, host and port are ignored. } } 如果出现&quot;Saving artifacts...&quot;，表示&quot; truffle migrate&quot;命令执行成功。 接下来，需要在geth客户端中执行命令。 这时，我们就要用到刚刚编译后的 Hello_mshk_top.json文件了，打开https://www.bejson.com网址，把abi部分取出并进行json压缩。然后在 geth中输入以下内容，将json转义后的内容，赋值给 mshk_abi变量： &gt;mshk_abi = [{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;say&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;name&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;print&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;}] 得到以下回复： [{ constant: true, inputs: [], name: &quot;say&quot;, outputs: [{ name: &quot;&quot;, type: &quot;string&quot; }], payable: false, stateMutability: &quot;pure&quot;, type: &quot;function&quot; }, { constant: true, inputs: [{ name: &quot;name&quot;, type: &quot;string&quot; }], name: &quot;print&quot;, outputs: [{ name: &quot;&quot;, type: &quot;string&quot; }], payable: false, stateMutability: &quot;pure&quot;, type: &quot;function&quot; }] 找到 Hello_mshk_top.json文件中的 bytecode部分，然后在 geth中，将值赋值给 mshk_bytecode变量，在 geth中输入以下内容： &gt;mshk_bytecode = &quot;0x6060604052341561000f57600080fd5b6102488061001e6000396000f30060606040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063954ab4b214610127575b600080fd5b341561005c57600080fd5b6100ac600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506101b5565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100ec5780820151818401526020810190506100d1565b50505050905090810190601f1680156101195780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561013257600080fd5b61013a6101c5565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561017a57808201518184015260208101905061015f565b50505050905090810190601f1680156101a75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101bd610208565b819050919050565b6101cd610208565b6040805190810160405280600e81526020017f48656c6c6f206d73686b2e746f70000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a723058203ae06ab41017e0b7aeb1484c4708c9b74fd1ae25a5d24db7c53d8376967d16630029&quot; 评估下创建合约需要的手续费是207296 gas： &gt; web3.eth.estimateGas({data: mshk_bytecode})207296 部署合约，并将合约传递给 mshk变量，在 geth中输入以下内容： &gt;acc0 = eth.accounts[0] &gt;mshk_Contract = web3.eth.contract(mshk_abi); &gt;mshk_hello = mshk_Contract.new({from:acc0, data:mshk_bytecode, gas:300000}) 第四步：测试部署成功的智能合约 &gt; mshk_hello.say() &quot;Hello mshk.top&quot; &gt; mshk_hello.print(&quot;Hello&quot;) &quot;Hello&quot; 注意点： 1.如果节点中只有一个账户，truffle.js中的配置可以不配置from和gas信息。 2.如果节点中多余一个账户，truffle.js中需要配置from和gas信息，如下所示： module.exports = { networks: { development: { host: &quot;192.168.1.42&quot;, port: 8545, network_id: &quot;*&quot;, // Match any network id from: &quot;0x3e43f30bdef44d08f650905350f0ff1a2a9ee1ba&quot;, gas: 3000000 } } }; 阅读更多" />
<meta property="og:description" content="开发环境：Ubuntu16.04 以太坊客户端:go-ethereum v1.7.3 第一步：node和npm安装(如果已经安装，请忽略该步骤) 官网下载node-v8.9.3-linux-x64.tar.xz 解压并移动到通用的软件安装目录 /opt/ tar -xJf node-v8.9.3-linux-x64.tar.xz sudo mv node-v8.9.3-linux-x64 /opt/ 安装 npm 和 node 命令到系统命令 sudo ln -s /opt/node-v8.9.3-linux-x64/bin/node /usr/local/bin/node sudo ln -s /opt/node-v8.9.3-linux-x64/bin/npm /usr/local/bin/npm 通过以下命令验证安装是否成功: node -v v8.9.3 npm -v 5.5.1 第二步：安装Truffle框架 sudo npm install -g truffle 通过以下命令验证truffle框架是否安装成功： truffle version 第三步：使用truffle进行智能合约的开发 (1)初始化一个 Truffle 项目 在用户自定义的目录下执行以下命令： mkdir test_truffle cd test_truffle truffle init 完成后，你将拥有如下目录： * contracts 智能合约目录 * migrations 发布脚本目录 * test 存放测试文件 * truffle.js Truffle的配置文件 (2)编译合约 进入到刚才的 test_truffle目录，执行&quot;truffle compile&quot;，可以将原始代码编译为以太坊认可的字节码。如果需要重新编译全部文件，可以执行&quot;truffle compile --compile-all&quot;命令。 (3)创建一个 合约并编译 在contracts目录中新建一个Hello_mshk_top.sol文件，代码如下： pragma solidity ^0.4.17; contract Hello_mshk_top { //say hello mshk.top function say() public pure returns (string) { return &quot;Hello mshk.top&quot;; } //print name function print(string name) public pure returns (string) { return name; } } 　编辑migrations/1_initial_migration.js部署脚本，将我们刚才创建的Hello_mshk_top.sol文件设置到发布配置文件中，内容如下： var Migrations = artifacts.require(&quot;./Migrations.sol&quot;); var Hello_mshk_top = artifacts.require(&quot;./Hello_mshk_top.sol&quot;); module.exports = function(deployer) { deployer.deploy(Migrations); deployer.deploy(Hello_mshk_top); }; 编译后的文件都放在了./build/contracts目录下：“./build/contracts/Hello_mshk_top.json&quot;，后面在部署到geth中，我们会用到。 第四步：部署智能合约 编辑truffle.js配置文件，设置我们稍后要部署智能合约的位置，内容如下： module.exports = { networks: { development: { host: &quot;localhost&quot;, port: 8545, network_id: &quot;*&quot; } } }; 该文件内容表示，我们在本地启动geth客户端，geth客户端的RPC端口为8545，geth的network_id不做限制。 (1)将智能合约部署到geth私链上 创世区块，使用RPC方式启动geth节点(此处略过) (2)新建账户、挖矿 (3)在geth中部署合约(执行该步骤之前，需要保证geth节点正常运行) truffle的智能合约项目部署，使用下面的命令：&quot;truffle migrate&quot;，这个命令会执行所有migrations目录下的js文件。使用 &quot;truffle migrate --reset&quot;命令，则会重新执行所有脚本的部署。 如果要部署到指定的网络，可以使用 &quot;truffle migrate --network live&quot;命令。 多个网络的配置如下： networks: { development: { host: &quot;localhost&quot;, port: 8545, network_id: &quot;*&quot; // match any network }, live: { host: &quot;178.25.19.88&quot;, // Random IP for example purposes (do not use) port: 80, network_id: 1, // Ethereum public network // optional config values: // gas Gas limit used for deploys. Default is 4712388 // gasPrice Gas price used for deploys. Default is 100000000000 (100 Shannon). // from - default address to use for any transaction Truffle makes during migrations // provider - web3 provider instance Truffle should use to talk to the Ethereum network. // - if specified, host and port are ignored. } } 如果出现&quot;Saving artifacts...&quot;，表示&quot; truffle migrate&quot;命令执行成功。 接下来，需要在geth客户端中执行命令。 这时，我们就要用到刚刚编译后的 Hello_mshk_top.json文件了，打开https://www.bejson.com网址，把abi部分取出并进行json压缩。然后在 geth中输入以下内容，将json转义后的内容，赋值给 mshk_abi变量： &gt;mshk_abi = [{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;say&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;name&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;print&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;}] 得到以下回复： [{ constant: true, inputs: [], name: &quot;say&quot;, outputs: [{ name: &quot;&quot;, type: &quot;string&quot; }], payable: false, stateMutability: &quot;pure&quot;, type: &quot;function&quot; }, { constant: true, inputs: [{ name: &quot;name&quot;, type: &quot;string&quot; }], name: &quot;print&quot;, outputs: [{ name: &quot;&quot;, type: &quot;string&quot; }], payable: false, stateMutability: &quot;pure&quot;, type: &quot;function&quot; }] 找到 Hello_mshk_top.json文件中的 bytecode部分，然后在 geth中，将值赋值给 mshk_bytecode变量，在 geth中输入以下内容： &gt;mshk_bytecode = &quot;0x6060604052341561000f57600080fd5b6102488061001e6000396000f30060606040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063954ab4b214610127575b600080fd5b341561005c57600080fd5b6100ac600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506101b5565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100ec5780820151818401526020810190506100d1565b50505050905090810190601f1680156101195780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561013257600080fd5b61013a6101c5565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561017a57808201518184015260208101905061015f565b50505050905090810190601f1680156101a75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101bd610208565b819050919050565b6101cd610208565b6040805190810160405280600e81526020017f48656c6c6f206d73686b2e746f70000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a723058203ae06ab41017e0b7aeb1484c4708c9b74fd1ae25a5d24db7c53d8376967d16630029&quot; 评估下创建合约需要的手续费是207296 gas： &gt; web3.eth.estimateGas({data: mshk_bytecode})207296 部署合约，并将合约传递给 mshk变量，在 geth中输入以下内容： &gt;acc0 = eth.accounts[0] &gt;mshk_Contract = web3.eth.contract(mshk_abi); &gt;mshk_hello = mshk_Contract.new({from:acc0, data:mshk_bytecode, gas:300000}) 第四步：测试部署成功的智能合约 &gt; mshk_hello.say() &quot;Hello mshk.top&quot; &gt; mshk_hello.print(&quot;Hello&quot;) &quot;Hello&quot; 注意点： 1.如果节点中只有一个账户，truffle.js中的配置可以不配置from和gas信息。 2.如果节点中多余一个账户，truffle.js中需要配置from和gas信息，如下所示： module.exports = { networks: { development: { host: &quot;192.168.1.42&quot;, port: 8545, network_id: &quot;*&quot;, // Match any network id from: &quot;0x3e43f30bdef44d08f650905350f0ff1a2a9ee1ba&quot;, gas: 3000000 } } }; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/02/05/08d3de74429ea4d66fa3d7fa797a3010.html" />
<meta property="og:url" content="https://mlh.app/2018/02/05/08d3de74429ea4d66fa3d7fa797a3010.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-05T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"开发环境：Ubuntu16.04 以太坊客户端:go-ethereum v1.7.3 第一步：node和npm安装(如果已经安装，请忽略该步骤) 官网下载node-v8.9.3-linux-x64.tar.xz 解压并移动到通用的软件安装目录 /opt/ tar -xJf node-v8.9.3-linux-x64.tar.xz sudo mv node-v8.9.3-linux-x64 /opt/ 安装 npm 和 node 命令到系统命令 sudo ln -s /opt/node-v8.9.3-linux-x64/bin/node /usr/local/bin/node sudo ln -s /opt/node-v8.9.3-linux-x64/bin/npm /usr/local/bin/npm 通过以下命令验证安装是否成功: node -v v8.9.3 npm -v 5.5.1 第二步：安装Truffle框架 sudo npm install -g truffle 通过以下命令验证truffle框架是否安装成功： truffle version 第三步：使用truffle进行智能合约的开发 (1)初始化一个 Truffle 项目 在用户自定义的目录下执行以下命令： mkdir test_truffle cd test_truffle truffle init 完成后，你将拥有如下目录： * contracts 智能合约目录 * migrations 发布脚本目录 * test 存放测试文件 * truffle.js Truffle的配置文件 (2)编译合约 进入到刚才的 test_truffle目录，执行&quot;truffle compile&quot;，可以将原始代码编译为以太坊认可的字节码。如果需要重新编译全部文件，可以执行&quot;truffle compile --compile-all&quot;命令。 (3)创建一个 合约并编译 在contracts目录中新建一个Hello_mshk_top.sol文件，代码如下： pragma solidity ^0.4.17; contract Hello_mshk_top { //say hello mshk.top function say() public pure returns (string) { return &quot;Hello mshk.top&quot;; } //print name function print(string name) public pure returns (string) { return name; } } 　编辑migrations/1_initial_migration.js部署脚本，将我们刚才创建的Hello_mshk_top.sol文件设置到发布配置文件中，内容如下： var Migrations = artifacts.require(&quot;./Migrations.sol&quot;); var Hello_mshk_top = artifacts.require(&quot;./Hello_mshk_top.sol&quot;); module.exports = function(deployer) { deployer.deploy(Migrations); deployer.deploy(Hello_mshk_top); }; 编译后的文件都放在了./build/contracts目录下：“./build/contracts/Hello_mshk_top.json&quot;，后面在部署到geth中，我们会用到。 第四步：部署智能合约 编辑truffle.js配置文件，设置我们稍后要部署智能合约的位置，内容如下： module.exports = { networks: { development: { host: &quot;localhost&quot;, port: 8545, network_id: &quot;*&quot; } } }; 该文件内容表示，我们在本地启动geth客户端，geth客户端的RPC端口为8545，geth的network_id不做限制。 (1)将智能合约部署到geth私链上 创世区块，使用RPC方式启动geth节点(此处略过) (2)新建账户、挖矿 (3)在geth中部署合约(执行该步骤之前，需要保证geth节点正常运行) truffle的智能合约项目部署，使用下面的命令：&quot;truffle migrate&quot;，这个命令会执行所有migrations目录下的js文件。使用 &quot;truffle migrate --reset&quot;命令，则会重新执行所有脚本的部署。 如果要部署到指定的网络，可以使用 &quot;truffle migrate --network live&quot;命令。 多个网络的配置如下： networks: { development: { host: &quot;localhost&quot;, port: 8545, network_id: &quot;*&quot; // match any network }, live: { host: &quot;178.25.19.88&quot;, // Random IP for example purposes (do not use) port: 80, network_id: 1, // Ethereum public network // optional config values: // gas Gas limit used for deploys. Default is 4712388 // gasPrice Gas price used for deploys. Default is 100000000000 (100 Shannon). // from - default address to use for any transaction Truffle makes during migrations // provider - web3 provider instance Truffle should use to talk to the Ethereum network. // - if specified, host and port are ignored. } } 如果出现&quot;Saving artifacts...&quot;，表示&quot; truffle migrate&quot;命令执行成功。 接下来，需要在geth客户端中执行命令。 这时，我们就要用到刚刚编译后的 Hello_mshk_top.json文件了，打开https://www.bejson.com网址，把abi部分取出并进行json压缩。然后在 geth中输入以下内容，将json转义后的内容，赋值给 mshk_abi变量： &gt;mshk_abi = [{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;say&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;name&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;print&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;}] 得到以下回复： [{ constant: true, inputs: [], name: &quot;say&quot;, outputs: [{ name: &quot;&quot;, type: &quot;string&quot; }], payable: false, stateMutability: &quot;pure&quot;, type: &quot;function&quot; }, { constant: true, inputs: [{ name: &quot;name&quot;, type: &quot;string&quot; }], name: &quot;print&quot;, outputs: [{ name: &quot;&quot;, type: &quot;string&quot; }], payable: false, stateMutability: &quot;pure&quot;, type: &quot;function&quot; }] 找到 Hello_mshk_top.json文件中的 bytecode部分，然后在 geth中，将值赋值给 mshk_bytecode变量，在 geth中输入以下内容： &gt;mshk_bytecode = &quot;0x6060604052341561000f57600080fd5b6102488061001e6000396000f30060606040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063954ab4b214610127575b600080fd5b341561005c57600080fd5b6100ac600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506101b5565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100ec5780820151818401526020810190506100d1565b50505050905090810190601f1680156101195780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561013257600080fd5b61013a6101c5565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561017a57808201518184015260208101905061015f565b50505050905090810190601f1680156101a75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101bd610208565b819050919050565b6101cd610208565b6040805190810160405280600e81526020017f48656c6c6f206d73686b2e746f70000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a723058203ae06ab41017e0b7aeb1484c4708c9b74fd1ae25a5d24db7c53d8376967d16630029&quot; 评估下创建合约需要的手续费是207296 gas： &gt; web3.eth.estimateGas({data: mshk_bytecode})207296 部署合约，并将合约传递给 mshk变量，在 geth中输入以下内容： &gt;acc0 = eth.accounts[0] &gt;mshk_Contract = web3.eth.contract(mshk_abi); &gt;mshk_hello = mshk_Contract.new({from:acc0, data:mshk_bytecode, gas:300000}) 第四步：测试部署成功的智能合约 &gt; mshk_hello.say() &quot;Hello mshk.top&quot; &gt; mshk_hello.print(&quot;Hello&quot;) &quot;Hello&quot; 注意点： 1.如果节点中只有一个账户，truffle.js中的配置可以不配置from和gas信息。 2.如果节点中多余一个账户，truffle.js中需要配置from和gas信息，如下所示： module.exports = { networks: { development: { host: &quot;192.168.1.42&quot;, port: 8545, network_id: &quot;*&quot;, // Match any network id from: &quot;0x3e43f30bdef44d08f650905350f0ff1a2a9ee1ba&quot;, gas: 3000000 } } }; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/02/05/08d3de74429ea4d66fa3d7fa797a3010.html","headline":"以太坊(geth客户端)利用truffle部署智能合约","dateModified":"2018-02-05T00:00:00+08:00","datePublished":"2018-02-05T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/02/05/08d3de74429ea4d66fa3d7fa797a3010.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>以太坊(geth客户端)利用truffle部署智能合约</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    开发环境：Ubuntu16.04
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    以太坊客户端:go-ethereum v1.7.3
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-weight:bold;">第一步：node和npm安装(如果已经安装，请忽略该步骤)</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    官网下载node-v8.9.3-linux-x64.tar.xz
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    解压并移动到通用的软件安装目录 /opt/
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    tar -xJf
   <span style="font-family:monospace;"> </span>node-v8.9.3-linux-x64.tar.xz
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    sudo mv node-v8.9.3-linux-x64 /opt/
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    安装 npm 和 node 命令到系统命令
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    sudo ln -s /opt/node-v8.9.3-linux-x64/bin/node /usr/local/bin/node
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    sudo ln -s /opt/node-v8.9.3-linux-x64/bin/npm /usr/local/bin/npm
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    通过以下命令验证安装是否成功:
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    node -v
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    v8.9.3
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    npm -v
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    5.5.1
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-weight:bold;">第二步：安装Truffle框架</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    sudo npm install -g truffle
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    通过以下命令验证truffle框架是否安装成功：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    truffle version
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-weight:bold;">第三步：使用truffle进行智能合约的开发</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    (1)初始化一个 Truffle 项目
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    在用户自定义的目录下执行以下命令：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    mkdir test_truffle
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    cd test_truffle
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    truffle init
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    完成后，你将拥有如下目录：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    * contracts 智能合约目录
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    * migrations 发布脚本目录
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    * test 存放测试文件
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    * truffle.js Truffle的配置文件
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    (2)编译合约
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    进入到刚才的 test_truffle目录，执行"truffle compile"，可以将原始代码编译为以太坊认可的字节码。如果需要重新编译全部文件，可以执行"truffle compile --compile-all"命令。
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    (3)创建一个 合约并编译
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    在contracts目录中新建一个Hello_mshk_top.sol文件，代码如下：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <pre><code class="language-javascript"><code class="language-javascript">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token punctuation">.</span><span class="token number">17</span><span class="token punctuation">;</span> contract Hello_mshk_top <span class="token punctuation">{</span> <span class="token comment">//say hello mshk.top</span> <span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure returns <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"Hello mshk.top"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">//print name</span> <span class="token keyword">function</span> <span class="token function">print</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token keyword">public</span> pure returns <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></code></pre> 
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    　编辑migrations/1_initial_migration.js部署脚本，将我们刚才创建的Hello_mshk_top.sol文件设置到发布配置文件中，内容如下：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <pre><code class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> Migrations <span class="token operator">=</span> artifacts<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./Migrations.sol"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">var</span> Hello_mshk_top <span class="token operator">=</span> artifacts<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./Hello_mshk_top.sol"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>deployer<span class="token punctuation">)</span> <span class="token punctuation">{</span> deployer<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>Migrations<span class="token punctuation">)</span><span class="token punctuation">;</span> deployer<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>Hello_mshk_top<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> </code></code></pre> 
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    编译后的文件都放在了./build/contracts目录下：“./build/contracts/Hello_mshk_top.json"，后面在部署到geth中，我们会用到。
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-weight:bold;">第四步：部署智能合约</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    编辑truffle.js配置文件，设置我们稍后要部署智能合约的位置，内容如下： 
   <div style="text-align:left;line-height:1.75;font-size:14px;">
     module.exports = { 
    <br> networks: { 
    <br> development: { 
    <br> host: "localhost", 
    <br> port: 8545, 
    <br> network_id: "*" 
    <br> } 
    <br> }
    <br> };
   </div> 
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;">该文件内容表示，我们在本地启动geth客户端，geth客户端的RPC端口为8545，geth的network_id不做限制。</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;">(1)将智能合约部署到geth私链上</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;">创世区块，使用RPC方式启动geth节点(此处略过)</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;">(2)新建账户、挖矿</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;">(3)在geth中部署合约(执行该步骤之前，需要保证geth节点正常运行)</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;">truffle的智能合约项目部署，使用下面的命令："truffle migrate"，这个命令会执行所有migrations目录下的js文件。使用 "truffle migrate --reset"命令，则会重新执行所有脚本的部署。</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    如果要部署到指定的网络，可以使用
   <span style="font-family:monospace;">"truffle migrate --network live"命令。</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    多个网络的配置如下：
   <span style="font-family:monospace;"></span> 
   <pre class="line-numbers prism-highlight language-json"><code class="language-json">networks<span class="token operator">:</span> <span class="token punctuation">{</span>
  development<span class="token operator">:</span> <span class="token punctuation">{</span>
    host<span class="token operator">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token number">8545</span><span class="token punctuation">,</span>
    network_id<span class="token operator">:</span> <span class="token string">"*"</span> // match any network
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  live<span class="token operator">:</span> <span class="token punctuation">{</span>
    host<span class="token operator">:</span> <span class="token string">"178.25.19.88"</span><span class="token punctuation">,</span> // Random IP for example purposes (do not use<span class="token punctuation">)</span>
    port<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
    network_id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        // Ethereum public network
    // optional config values<span class="token operator">:</span>
    // gas  Gas limit used for deploys. Default is <span class="token number">4712388</span>
    // gasPrice Gas price used for deploys. Default is <span class="token number">100000000000</span> (<span class="token number">100</span> Shannon<span class="token punctuation">)</span>.
    // from - default address to use for any transaction Truffle makes during migrations
    // provider - web3 provider instance Truffle should use to talk to the Ethereum network.
    //          - if specified<span class="token punctuation">,</span> host and port are ignored.
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> 
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    如果出现"Saving artifacts..."，表示"
   <span style="font-family:monospace;">truffle migrate"命令执行成功</span>。
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    接下来，需要在geth客户端中执行命令。
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    这时，我们就要用到刚刚编译后的
   <span style="font-family:monospace;">Hello_mshk_top.json</span>文件了，打开https://www.bejson.com网址，把abi部分取出并进行json压缩。然后在
   <span style="font-family:monospace;">geth</span>中输入以下内容，将json转义后的内容，赋值给
   <span style="font-family:monospace;">mshk_abi</span>变量：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    &gt;mshk_abi = [{"constant":true,"inputs":[],"name":"say","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"pure","type":"function"},{"constant":true,"inputs":[{"name":"name","type":"string"}],"name":"print","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"pure","type":"function"}]
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    得到以下回复：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    [{
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    constant: true,
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    inputs: [],
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    name: "say",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    outputs: [{
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    name: "",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    type: "string"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }],
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    payable: false,
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    stateMutability: "pure",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    type: "function"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }, {
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    constant: true,
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    inputs: [{
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    name: "name",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    type: "string"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }],
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    name: "print",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    outputs: [{
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    name: "",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    type: "string"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }],
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    payable: false,
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    stateMutability: "pure",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    type: "function"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }]
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    找到
   <span style="font-family:monospace;">Hello_mshk_top.json</span>文件中的
   <span style="font-family:monospace;">bytecode</span>部分，然后在
   <span style="font-family:monospace;">geth</span>中，将值赋值给
   <span style="font-family:monospace;">mshk_bytecode</span>变量，在
   <span style="font-family:monospace;">geth</span>中输入以下内容：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    &gt;mshk_bytecode = "0x6060604052341561000f57600080fd5b6102488061001e6000396000f30060606040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063954ab4b214610127575b600080fd5b341561005c57600080fd5b6100ac600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506101b5565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100ec5780820151818401526020810190506100d1565b50505050905090810190601f1680156101195780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561013257600080fd5b61013a6101c5565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561017a57808201518184015260208101905061015f565b50505050905090810190601f1680156101a75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101bd610208565b819050919050565b6101cd610208565b6040805190810160405280600e81526020017f48656c6c6f206d73686b2e746f70000000000000000000000000000000000000815250905090565b6020604051908101604052806000815250905600a165627a7a723058203ae06ab41017e0b7aeb1484c4708c9b74fd1ae25a5d24db7c53d8376967d16630029"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    评估下创建合约需要的手续费是207296
   <span style="font-family:monospace;">gas</span>：
  </div> 
  <div style="line-height:1.75;font-size:14px;">
   <span style="font-family:monospace;">&gt; web3.eth.estimateGas({data: mshk_bytecode})207296</span>
  </div> 
  <div style="line-height:1.75;font-size:14px;">
   <br>
  </div> 
  <div style="line-height:1.75;font-size:14px;">
   部署合约，并将合约传递给
   <span style="font-family:monospace;">mshk</span>变量，在
   <span style="font-family:monospace;">geth</span>中输入以下内容：
  </div> 
  <div style="line-height:1.75;font-size:14px;">
   &gt;acc0 = eth.accounts[0]
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    &gt;mshk_Contract = web3.eth.contract(mshk_abi);
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    &gt;mshk_hello = mshk_Contract.new({from:acc0, data:mshk_bytecode, gas:300000})
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-weight:bold;">第四步：测试部署成功的智能合约</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    &gt; mshk_hello.say()
   <br> "Hello mshk.top"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    &gt; mshk_hello.print("Hello")
   <br> "Hello"
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="font-family:monospace;"></span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <span style="color:#FF0000;">注意点：</span>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    1.如果节点中只有一个账户，truffle.js中的配置可以不配置from和gas信息。
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    2.如果节点中多余一个账户，truffle.js中需要配置from和gas信息，如下所示：
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    module.exports = {
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    networks: {
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    development: {
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    host: "192.168.1.42",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    port: 8545,
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    network_id: "*", // Match any network id
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    from: "0x3e43f30bdef44d08f650905350f0ff1a2a9ee1ba",
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    gas: 3000000
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    }
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;">
    };
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
  <div style="text-align:left;line-height:1.75;font-size:14px;"> 
   <br>
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/feifly818163_com/article/details/79259836,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/feifly818163_com/article/details/79259836,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
