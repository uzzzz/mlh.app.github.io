<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>UID 卡充值大揭秘（原创） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="UID 卡充值大揭秘（原创）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="所需工具： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u一台 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IC卡解密软件 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 64系统（建议用xp） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u驱动（无法对全加密卡进行破解,但可使用proxmark3......） 个人经验：普通IC卡（校园卡、水卡、澡卡） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;特殊IC卡（白卡） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上两种IC卡可使用同一破解软件进行破解，但是进行对卡片写入数据时却使用不同的软件。要点：对特殊IC卡（白卡）可直接写入数据；而普通IC卡（校园卡、水卡、澡卡）需先进行对该卡密码恢复默认值（即FFFFFFFFFFFF）在进行写入数据。 经验一（安工澡卡 十里铺） ： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1块区：46 01 D0 07 00 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2块区：46 01 D0 07 00 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;分析：十六进制 &nbsp;46 01 表示刷卡次数 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 十六进制 &nbsp;D0 07 表示余额 &nbsp; &nbsp; &nbsp;换算 07D0 =十进制 2000 &nbsp;也即是20.00￥ 经验二（安工水卡 十里铺） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1块区：68 05 00 00 &nbsp; &nbsp; 97 FA FF &nbsp;FF &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 11EE11EE &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2块区：68 05 00 00 &nbsp; &nbsp; 97 FA FF &nbsp;FF &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 12ED12ED &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;校验位：97 FA FF FF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;余额位：68 05 00 00&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 二者关系：十六进制 00 00 05 68&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转二进制 0000 &nbsp;0000 &nbsp;0000 &nbsp;0000 &nbsp; 0101 &nbsp;0110 &nbsp;1000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;取反 &nbsp; &nbsp; &nbsp; 1111 &nbsp;1111 &nbsp;1111 &nbsp;1111 &nbsp; 1010 &nbsp;1001 &nbsp;0111 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转十六进制FF FF 0A 97 经验三（安师水卡 兰园 +图书馆+教学楼） 分析1（偏离）：对应数值分别为（卡片以十进制进行记录数据，以十六进制进行校验） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 00.06 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.42 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.37 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.35 易知卡片会对最近两次刷卡进行记录 数值填充分析得： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;十进制：0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;3&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9 对应十六进制为：F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6 则可知：06---------------F9 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;42---------------BD &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;37---------------C8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;35---------------CA 分析2（正确） &nbsp; &nbsp; 校验位 = 单个字节数值位相加后 取反 得之 &nbsp; &nbsp; 即：BC = （43 + 00）取反 &nbsp; &nbsp; 注：以上皆为十六进制运算，但是数值位为在使用中被当做10进制使用 充值如下（50.00￥） &nbsp;&nbsp;&nbsp;&nbsp;0区块:81151234567800014798000000000000&nbsp;&nbsp;&nbsp;&nbsp;1区块:AF 0050 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;2区块:AE 0150 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;3区块:138731383233FF078069FFFFFFFFFFFF （-------------------------未完待续---------------------未完待续----------------------未完待续-----------------------------） 其一（安工水卡/澡卡 十里铺） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 充值数据如下：（45.00） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1.区块：94 11 00 00 00 &nbsp; &nbsp; &nbsp;6B EE FF FF FF &nbsp; &nbsp;94 11 00 00 00...... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2.区块：95 11 00 00 00 &nbsp; &nbsp; &nbsp;6A EE FF FF FF &nbsp; &nbsp;95 11 00 00 00...... 其二 其三 其四（转载） 饮水机卡数据分析 饮水机卡中的数据比较特别，没有采用标准的电子钱包数据格式而且加了校验位。 下面是存储余额的sector的数据： 00ca&nbsp;0901&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0140&nbsp;2338 cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56 cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56 3847&nbsp;fd12&nbsp;bd08&nbsp;7f07&nbsp;88da&nbsp;32c0&nbsp;fe32&nbsp;b864 block1和block2的数据完全相同。我们假设block1（也是block2）中的16个字节分别为B0~B15。经过几次刷卡之后发现，只有B0、B1、B15的数据会发生变化（对饮水机卡的研究已经过去很久了，数据都不在了，而我也懒得再出门去刷卡，请大家见谅哈）。经过多次对比卡机上显示的余额，初步确定B0、B1是余额数据（后来觉得B2B3应该也是余额数据的一部分）。然后猜测B14、B15是校验位，当然这是错的→_→。我的Sublime 3自动将2个字节放在一起显示，就像上面给的数据一样。 受此影响，我想当然的认为校验的时候是2个字节一组，于是发现校验位的值始终在0x5a00~0x5aff变化，而余额是一直减少的，试了相加、异或甚至MD5，都百思不得其解┬＿┬。于是到这里就算中断了，过一段时间后再看了看数据，发现0x5a是01011010，突然就想试试按字节校验（我也不知道为什么会这么想），结果还真是这样⊙０⊙。正确的数据结构是这样的： B0~B3是余额，B14固定为0x5a，B15为B0~B14求和后舍去进位的值，猜测B6开始的131106应该是卡首次投入使用的时间（饮水机卡是循环使用的）。以上面的数据为例，余额是4.63元。对B0~B14求和是0×156，因此B15是0×56。 这种加了校验的数据相对来说还是比较难分析的，但也并不安全。 其五（转载） 太阳能水卡数据分析 太阳能卡是在有余额和校验位的基础上又增加了其他数据。下面是存储余额数据的block连续3次刷卡的记录： 020d&nbsp;0000&nbsp;2c06&nbsp;5c09&nbsp;1500&nbsp;2c06&nbsp;4900&nbsp;5a90 f60c&nbsp;0000&nbsp;2f06&nbsp;5d09&nbsp;1500&nbsp;2f06&nbsp;4a00&nbsp;5a8b ea0c&nbsp;0000&nbsp;3206&nbsp;5e09&nbsp;1500&nbsp;3206&nbsp;4b00&nbsp;5a87 从以上刷卡数据中，结合饮水机卡中的分析，经过计算可以确定： 1、B0~B3为卡的余额，B14为固定的0x5a，B15为求和校验位； 2、B13B12和B7B6的数据每次刷卡会加一，所以我们猜测其中一个数据可能是刷卡次数，取第一行刷卡的数据，0x095c（B7B6）是十进制2396，不可能是这么多，所以B13B12是刷卡次数，而B7B6的初始值为 0x095c-0×0049=0×0913； 3、B8B9的值固定不变为0×1500，试试看B6B7的初始值和B8组合的结果——是130915，觉得熟悉吗？是的，是日期（好机智的设计有木有！）。 4、B4B5和B10B11的值是相同的，而它们也在增加。你发现了吗？它们每次增加3，也就是刷卡次数的3倍。据此我们能够计算出B5B4的初始值=0x062c-3*0×0049=0×0551。 现在，所有的数据都搞清楚了，我们要改写它的数据，让它的余额变成100元，也就是刚刚买到时候的余额。可以构造出这个block的数据为： 1027&nbsp;0000&nbsp;5105&nbsp;1309&nbsp;1500&nbsp;5105&nbsp;0000&nbsp;5a6e 其六 其七（安师水卡 竹园） 卡一： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0100 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;0F27 &nbsp;0000 &nbsp;FFFF &nbsp;29D6 &nbsp; &nbsp;0.01￥&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8813 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8813 &nbsp;0000 &nbsp;FFFF &nbsp;00FF &nbsp; &nbsp;50.00￥&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8713 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8913 &nbsp;0000 &nbsp;FFFF &nbsp;0EF1 &nbsp; &nbsp;49.00$ &nbsp;分析得：1388 + 1388 = 2710 = (10000)10进制 卡二： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;0100 &nbsp; 0000 &nbsp; FFFFFFFF &nbsp; 1F4E &nbsp; &nbsp;0000 &nbsp; FFFF &nbsp;50AF &nbsp;分析得： 0001 + 4E1F = 4E20 &nbsp;= (20000)10进制 校验位分析：经过卡一和卡二的对比，数据的后四位都可解析如下： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们容易发现b0b1 与 b8b9 有此消彼长的规律，b14和b15也存在这样的规律，且 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b0b1 + b8b9 恒等于 2*充值数据（即1388 + 1388 = 2710 = (10000)10进制）； &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b14 + b15 恒等于 FF（即29+D6 = FF） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;由此我们可以完全破解数据，充值如下：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:100.00$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 0000 FFFF FFFF 1027 0000 FFFF 00FF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:200.00$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E 0000 FFFF FFFF 204E 0000 FFFF 00FF 其八（安师澡卡 竹园）5扇区 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9601 &nbsp; 00C8 &nbsp; 0100 &nbsp; 1203 &nbsp;1E0C &nbsp; 080B &nbsp;3602 &nbsp; 00EA &nbsp; &nbsp; &nbsp; 406￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8801 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 060D &nbsp; 2904 &nbsp;3702 &nbsp; 0026 &nbsp; &nbsp; &nbsp; 392￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7A01 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 0C0B &nbsp;180D &nbsp;3802 &nbsp; 0015 &nbsp; &nbsp; &nbsp; 378￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上为连续三次数据变化&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 数据位：b0b1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 固定位：b2,b5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 校验位：b15(b0~b14的和) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 时间： &nbsp; b6 ~b11（年月日时分秒） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 刷卡次数：b12b13 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 本次刷卡消费金额：b3b4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 由此充值如下： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00A8 &nbsp; 100.00￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00DF &nbsp; 200.00￥ 注意：该卡的区块三中有 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;ff078069 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥a解密 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;7F0788DA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥b解密 其九 其十 阅读更多" />
<meta property="og:description" content="所需工具： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u一台 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IC卡解密软件 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 64系统（建议用xp） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u驱动（无法对全加密卡进行破解,但可使用proxmark3......） 个人经验：普通IC卡（校园卡、水卡、澡卡） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;特殊IC卡（白卡） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上两种IC卡可使用同一破解软件进行破解，但是进行对卡片写入数据时却使用不同的软件。要点：对特殊IC卡（白卡）可直接写入数据；而普通IC卡（校园卡、水卡、澡卡）需先进行对该卡密码恢复默认值（即FFFFFFFFFFFF）在进行写入数据。 经验一（安工澡卡 十里铺） ： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1块区：46 01 D0 07 00 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2块区：46 01 D0 07 00 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;分析：十六进制 &nbsp;46 01 表示刷卡次数 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 十六进制 &nbsp;D0 07 表示余额 &nbsp; &nbsp; &nbsp;换算 07D0 =十进制 2000 &nbsp;也即是20.00￥ 经验二（安工水卡 十里铺） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1块区：68 05 00 00 &nbsp; &nbsp; 97 FA FF &nbsp;FF &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 11EE11EE &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2块区：68 05 00 00 &nbsp; &nbsp; 97 FA FF &nbsp;FF &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 12ED12ED &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;校验位：97 FA FF FF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;余额位：68 05 00 00&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 二者关系：十六进制 00 00 05 68&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转二进制 0000 &nbsp;0000 &nbsp;0000 &nbsp;0000 &nbsp; 0101 &nbsp;0110 &nbsp;1000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;取反 &nbsp; &nbsp; &nbsp; 1111 &nbsp;1111 &nbsp;1111 &nbsp;1111 &nbsp; 1010 &nbsp;1001 &nbsp;0111 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转十六进制FF FF 0A 97 经验三（安师水卡 兰园 +图书馆+教学楼） 分析1（偏离）：对应数值分别为（卡片以十进制进行记录数据，以十六进制进行校验） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 00.06 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.42 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.37 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.35 易知卡片会对最近两次刷卡进行记录 数值填充分析得： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;十进制：0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;3&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9 对应十六进制为：F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6 则可知：06---------------F9 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;42---------------BD &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;37---------------C8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;35---------------CA 分析2（正确） &nbsp; &nbsp; 校验位 = 单个字节数值位相加后 取反 得之 &nbsp; &nbsp; 即：BC = （43 + 00）取反 &nbsp; &nbsp; 注：以上皆为十六进制运算，但是数值位为在使用中被当做10进制使用 充值如下（50.00￥） &nbsp;&nbsp;&nbsp;&nbsp;0区块:81151234567800014798000000000000&nbsp;&nbsp;&nbsp;&nbsp;1区块:AF 0050 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;2区块:AE 0150 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;3区块:138731383233FF078069FFFFFFFFFFFF （-------------------------未完待续---------------------未完待续----------------------未完待续-----------------------------） 其一（安工水卡/澡卡 十里铺） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 充值数据如下：（45.00） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1.区块：94 11 00 00 00 &nbsp; &nbsp; &nbsp;6B EE FF FF FF &nbsp; &nbsp;94 11 00 00 00...... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2.区块：95 11 00 00 00 &nbsp; &nbsp; &nbsp;6A EE FF FF FF &nbsp; &nbsp;95 11 00 00 00...... 其二 其三 其四（转载） 饮水机卡数据分析 饮水机卡中的数据比较特别，没有采用标准的电子钱包数据格式而且加了校验位。 下面是存储余额的sector的数据： 00ca&nbsp;0901&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0140&nbsp;2338 cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56 cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56 3847&nbsp;fd12&nbsp;bd08&nbsp;7f07&nbsp;88da&nbsp;32c0&nbsp;fe32&nbsp;b864 block1和block2的数据完全相同。我们假设block1（也是block2）中的16个字节分别为B0~B15。经过几次刷卡之后发现，只有B0、B1、B15的数据会发生变化（对饮水机卡的研究已经过去很久了，数据都不在了，而我也懒得再出门去刷卡，请大家见谅哈）。经过多次对比卡机上显示的余额，初步确定B0、B1是余额数据（后来觉得B2B3应该也是余额数据的一部分）。然后猜测B14、B15是校验位，当然这是错的→_→。我的Sublime 3自动将2个字节放在一起显示，就像上面给的数据一样。 受此影响，我想当然的认为校验的时候是2个字节一组，于是发现校验位的值始终在0x5a00~0x5aff变化，而余额是一直减少的，试了相加、异或甚至MD5，都百思不得其解┬＿┬。于是到这里就算中断了，过一段时间后再看了看数据，发现0x5a是01011010，突然就想试试按字节校验（我也不知道为什么会这么想），结果还真是这样⊙０⊙。正确的数据结构是这样的： B0~B3是余额，B14固定为0x5a，B15为B0~B14求和后舍去进位的值，猜测B6开始的131106应该是卡首次投入使用的时间（饮水机卡是循环使用的）。以上面的数据为例，余额是4.63元。对B0~B14求和是0×156，因此B15是0×56。 这种加了校验的数据相对来说还是比较难分析的，但也并不安全。 其五（转载） 太阳能水卡数据分析 太阳能卡是在有余额和校验位的基础上又增加了其他数据。下面是存储余额数据的block连续3次刷卡的记录： 020d&nbsp;0000&nbsp;2c06&nbsp;5c09&nbsp;1500&nbsp;2c06&nbsp;4900&nbsp;5a90 f60c&nbsp;0000&nbsp;2f06&nbsp;5d09&nbsp;1500&nbsp;2f06&nbsp;4a00&nbsp;5a8b ea0c&nbsp;0000&nbsp;3206&nbsp;5e09&nbsp;1500&nbsp;3206&nbsp;4b00&nbsp;5a87 从以上刷卡数据中，结合饮水机卡中的分析，经过计算可以确定： 1、B0~B3为卡的余额，B14为固定的0x5a，B15为求和校验位； 2、B13B12和B7B6的数据每次刷卡会加一，所以我们猜测其中一个数据可能是刷卡次数，取第一行刷卡的数据，0x095c（B7B6）是十进制2396，不可能是这么多，所以B13B12是刷卡次数，而B7B6的初始值为 0x095c-0×0049=0×0913； 3、B8B9的值固定不变为0×1500，试试看B6B7的初始值和B8组合的结果——是130915，觉得熟悉吗？是的，是日期（好机智的设计有木有！）。 4、B4B5和B10B11的值是相同的，而它们也在增加。你发现了吗？它们每次增加3，也就是刷卡次数的3倍。据此我们能够计算出B5B4的初始值=0x062c-3*0×0049=0×0551。 现在，所有的数据都搞清楚了，我们要改写它的数据，让它的余额变成100元，也就是刚刚买到时候的余额。可以构造出这个block的数据为： 1027&nbsp;0000&nbsp;5105&nbsp;1309&nbsp;1500&nbsp;5105&nbsp;0000&nbsp;5a6e 其六 其七（安师水卡 竹园） 卡一： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0100 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;0F27 &nbsp;0000 &nbsp;FFFF &nbsp;29D6 &nbsp; &nbsp;0.01￥&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8813 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8813 &nbsp;0000 &nbsp;FFFF &nbsp;00FF &nbsp; &nbsp;50.00￥&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8713 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8913 &nbsp;0000 &nbsp;FFFF &nbsp;0EF1 &nbsp; &nbsp;49.00$ &nbsp;分析得：1388 + 1388 = 2710 = (10000)10进制 卡二： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;0100 &nbsp; 0000 &nbsp; FFFFFFFF &nbsp; 1F4E &nbsp; &nbsp;0000 &nbsp; FFFF &nbsp;50AF &nbsp;分析得： 0001 + 4E1F = 4E20 &nbsp;= (20000)10进制 校验位分析：经过卡一和卡二的对比，数据的后四位都可解析如下： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们容易发现b0b1 与 b8b9 有此消彼长的规律，b14和b15也存在这样的规律，且 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b0b1 + b8b9 恒等于 2*充值数据（即1388 + 1388 = 2710 = (10000)10进制）； &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b14 + b15 恒等于 FF（即29+D6 = FF） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;由此我们可以完全破解数据，充值如下：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:100.00$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 0000 FFFF FFFF 1027 0000 FFFF 00FF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:200.00$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E 0000 FFFF FFFF 204E 0000 FFFF 00FF 其八（安师澡卡 竹园）5扇区 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9601 &nbsp; 00C8 &nbsp; 0100 &nbsp; 1203 &nbsp;1E0C &nbsp; 080B &nbsp;3602 &nbsp; 00EA &nbsp; &nbsp; &nbsp; 406￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8801 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 060D &nbsp; 2904 &nbsp;3702 &nbsp; 0026 &nbsp; &nbsp; &nbsp; 392￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7A01 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 0C0B &nbsp;180D &nbsp;3802 &nbsp; 0015 &nbsp; &nbsp; &nbsp; 378￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上为连续三次数据变化&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 数据位：b0b1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 固定位：b2,b5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 校验位：b15(b0~b14的和) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 时间： &nbsp; b6 ~b11（年月日时分秒） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 刷卡次数：b12b13 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 本次刷卡消费金额：b3b4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 由此充值如下： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00A8 &nbsp; 100.00￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00DF &nbsp; 200.00￥ 注意：该卡的区块三中有 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;ff078069 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥a解密 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;7F0788DA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥b解密 其九 其十 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/03/12/22e05d009857b826f5eae9ff77f68bb7.html" />
<meta property="og:url" content="https://mlh.app/2018/03/12/22e05d009857b826f5eae9ff77f68bb7.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-12T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"所需工具： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u一台 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IC卡解密软件 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 64系统（建议用xp） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u驱动（无法对全加密卡进行破解,但可使用proxmark3......） 个人经验：普通IC卡（校园卡、水卡、澡卡） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;特殊IC卡（白卡） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上两种IC卡可使用同一破解软件进行破解，但是进行对卡片写入数据时却使用不同的软件。要点：对特殊IC卡（白卡）可直接写入数据；而普通IC卡（校园卡、水卡、澡卡）需先进行对该卡密码恢复默认值（即FFFFFFFFFFFF）在进行写入数据。 经验一（安工澡卡 十里铺） ： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1块区：46 01 D0 07 00 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2块区：46 01 D0 07 00 00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;分析：十六进制 &nbsp;46 01 表示刷卡次数 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 十六进制 &nbsp;D0 07 表示余额 &nbsp; &nbsp; &nbsp;换算 07D0 =十进制 2000 &nbsp;也即是20.00￥ 经验二（安工水卡 十里铺） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1块区：68 05 00 00 &nbsp; &nbsp; 97 FA FF &nbsp;FF &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 11EE11EE &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2块区：68 05 00 00 &nbsp; &nbsp; 97 FA FF &nbsp;FF &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 12ED12ED &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;校验位：97 FA FF FF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;余额位：68 05 00 00&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 二者关系：十六进制 00 00 05 68&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转二进制 0000 &nbsp;0000 &nbsp;0000 &nbsp;0000 &nbsp; 0101 &nbsp;0110 &nbsp;1000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;取反 &nbsp; &nbsp; &nbsp; 1111 &nbsp;1111 &nbsp;1111 &nbsp;1111 &nbsp; 1010 &nbsp;1001 &nbsp;0111 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转十六进制FF FF 0A 97 经验三（安师水卡 兰园 +图书馆+教学楼） 分析1（偏离）：对应数值分别为（卡片以十进制进行记录数据，以十六进制进行校验） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 00.06 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.42 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.37 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.35 易知卡片会对最近两次刷卡进行记录 数值填充分析得： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;十进制：0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;3&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9 对应十六进制为：F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6 则可知：06---------------F9 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;42---------------BD &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;37---------------C8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;35---------------CA 分析2（正确） &nbsp; &nbsp; 校验位 = 单个字节数值位相加后 取反 得之 &nbsp; &nbsp; 即：BC = （43 + 00）取反 &nbsp; &nbsp; 注：以上皆为十六进制运算，但是数值位为在使用中被当做10进制使用 充值如下（50.00￥） &nbsp;&nbsp;&nbsp;&nbsp;0区块:81151234567800014798000000000000&nbsp;&nbsp;&nbsp;&nbsp;1区块:AF 0050 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;2区块:AE 0150 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;3区块:138731383233FF078069FFFFFFFFFFFF （-------------------------未完待续---------------------未完待续----------------------未完待续-----------------------------） 其一（安工水卡/澡卡 十里铺） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 充值数据如下：（45.00） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1.区块：94 11 00 00 00 &nbsp; &nbsp; &nbsp;6B EE FF FF FF &nbsp; &nbsp;94 11 00 00 00...... &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2.区块：95 11 00 00 00 &nbsp; &nbsp; &nbsp;6A EE FF FF FF &nbsp; &nbsp;95 11 00 00 00...... 其二 其三 其四（转载） 饮水机卡数据分析 饮水机卡中的数据比较特别，没有采用标准的电子钱包数据格式而且加了校验位。 下面是存储余额的sector的数据： 00ca&nbsp;0901&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0140&nbsp;2338 cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56 cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56 3847&nbsp;fd12&nbsp;bd08&nbsp;7f07&nbsp;88da&nbsp;32c0&nbsp;fe32&nbsp;b864 block1和block2的数据完全相同。我们假设block1（也是block2）中的16个字节分别为B0~B15。经过几次刷卡之后发现，只有B0、B1、B15的数据会发生变化（对饮水机卡的研究已经过去很久了，数据都不在了，而我也懒得再出门去刷卡，请大家见谅哈）。经过多次对比卡机上显示的余额，初步确定B0、B1是余额数据（后来觉得B2B3应该也是余额数据的一部分）。然后猜测B14、B15是校验位，当然这是错的→_→。我的Sublime 3自动将2个字节放在一起显示，就像上面给的数据一样。 受此影响，我想当然的认为校验的时候是2个字节一组，于是发现校验位的值始终在0x5a00~0x5aff变化，而余额是一直减少的，试了相加、异或甚至MD5，都百思不得其解┬＿┬。于是到这里就算中断了，过一段时间后再看了看数据，发现0x5a是01011010，突然就想试试按字节校验（我也不知道为什么会这么想），结果还真是这样⊙０⊙。正确的数据结构是这样的： B0~B3是余额，B14固定为0x5a，B15为B0~B14求和后舍去进位的值，猜测B6开始的131106应该是卡首次投入使用的时间（饮水机卡是循环使用的）。以上面的数据为例，余额是4.63元。对B0~B14求和是0×156，因此B15是0×56。 这种加了校验的数据相对来说还是比较难分析的，但也并不安全。 其五（转载） 太阳能水卡数据分析 太阳能卡是在有余额和校验位的基础上又增加了其他数据。下面是存储余额数据的block连续3次刷卡的记录： 020d&nbsp;0000&nbsp;2c06&nbsp;5c09&nbsp;1500&nbsp;2c06&nbsp;4900&nbsp;5a90 f60c&nbsp;0000&nbsp;2f06&nbsp;5d09&nbsp;1500&nbsp;2f06&nbsp;4a00&nbsp;5a8b ea0c&nbsp;0000&nbsp;3206&nbsp;5e09&nbsp;1500&nbsp;3206&nbsp;4b00&nbsp;5a87 从以上刷卡数据中，结合饮水机卡中的分析，经过计算可以确定： 1、B0~B3为卡的余额，B14为固定的0x5a，B15为求和校验位； 2、B13B12和B7B6的数据每次刷卡会加一，所以我们猜测其中一个数据可能是刷卡次数，取第一行刷卡的数据，0x095c（B7B6）是十进制2396，不可能是这么多，所以B13B12是刷卡次数，而B7B6的初始值为 0x095c-0×0049=0×0913； 3、B8B9的值固定不变为0×1500，试试看B6B7的初始值和B8组合的结果——是130915，觉得熟悉吗？是的，是日期（好机智的设计有木有！）。 4、B4B5和B10B11的值是相同的，而它们也在增加。你发现了吗？它们每次增加3，也就是刷卡次数的3倍。据此我们能够计算出B5B4的初始值=0x062c-3*0×0049=0×0551。 现在，所有的数据都搞清楚了，我们要改写它的数据，让它的余额变成100元，也就是刚刚买到时候的余额。可以构造出这个block的数据为： 1027&nbsp;0000&nbsp;5105&nbsp;1309&nbsp;1500&nbsp;5105&nbsp;0000&nbsp;5a6e 其六 其七（安师水卡 竹园） 卡一： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0100 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;0F27 &nbsp;0000 &nbsp;FFFF &nbsp;29D6 &nbsp; &nbsp;0.01￥&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8813 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8813 &nbsp;0000 &nbsp;FFFF &nbsp;00FF &nbsp; &nbsp;50.00￥&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8713 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8913 &nbsp;0000 &nbsp;FFFF &nbsp;0EF1 &nbsp; &nbsp;49.00$ &nbsp;分析得：1388 + 1388 = 2710 = (10000)10进制 卡二： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;0100 &nbsp; 0000 &nbsp; FFFFFFFF &nbsp; 1F4E &nbsp; &nbsp;0000 &nbsp; FFFF &nbsp;50AF &nbsp;分析得： 0001 + 4E1F = 4E20 &nbsp;= (20000)10进制 校验位分析：经过卡一和卡二的对比，数据的后四位都可解析如下： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们容易发现b0b1 与 b8b9 有此消彼长的规律，b14和b15也存在这样的规律，且 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b0b1 + b8b9 恒等于 2*充值数据（即1388 + 1388 = 2710 = (10000)10进制）； &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b14 + b15 恒等于 FF（即29+D6 = FF） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;由此我们可以完全破解数据，充值如下：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:100.00$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 0000 FFFF FFFF 1027 0000 FFFF 00FF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:200.00$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E 0000 FFFF FFFF 204E 0000 FFFF 00FF 其八（安师澡卡 竹园）5扇区 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9601 &nbsp; 00C8 &nbsp; 0100 &nbsp; 1203 &nbsp;1E0C &nbsp; 080B &nbsp;3602 &nbsp; 00EA &nbsp; &nbsp; &nbsp; 406￥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8801 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 060D &nbsp; 2904 &nbsp;3702 &nbsp; 0026 &nbsp; &nbsp; &nbsp; 392￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7A01 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 0C0B &nbsp;180D &nbsp;3802 &nbsp; 0015 &nbsp; &nbsp; &nbsp; 378￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上为连续三次数据变化&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 数据位：b0b1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 固定位：b2,b5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 校验位：b15(b0~b14的和) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 时间： &nbsp; b6 ~b11（年月日时分秒） &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 刷卡次数：b12b13 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 本次刷卡消费金额：b3b4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 由此充值如下： &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00A8 &nbsp; 100.00￥ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00DF &nbsp; 200.00￥ 注意：该卡的区块三中有 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;ff078069 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥a解密 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;7F0788DA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥b解密 其九 其十 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/03/12/22e05d009857b826f5eae9ff77f68bb7.html","headline":"UID 卡充值大揭秘（原创）","dateModified":"2018-03-12T00:00:00+08:00","datePublished":"2018-03-12T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/03/12/22e05d009857b826f5eae9ff77f68bb7.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>UID 卡充值大揭秘（原创）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>所需工具：</p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u一台</span></p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IC卡解密软件</span></p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 64系统（建议用xp）</span></p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acr122u驱动（无法对全加密卡进行破解,但可使用proxmark3......）</span></p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">个人经验：<span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">普通IC卡（校园卡、水卡、澡卡）</span></span></p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;<span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">特殊IC卡（白卡）</span></span></p>
  <p><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上两种IC卡可使用同一破解软件进行破解，但是进行对卡片写入数据时却使用不同的软件。要点：对<span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">特殊IC卡（白卡）可直接写入数据；而<span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">普通IC卡（校园卡、水卡、澡卡）需先进行对该卡密码恢复默认值（即FFFFFFFFFFFF）在进行写入数据。</span></span><br></span></p>
  <p><span style="font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;"><span style="color:#ff0000;">经验一（安工澡卡 十里铺）</span></span></p>
  <p style="text-align:center;"><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">：<img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180312211239877?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdWdseV9naXJs/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""></span></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1块区：46 01 D0 07 00 00<br></p>
  <p style="text-align:left;"><span style="color:rgb(51,51,51);font-family:'Microsoft Yahei', '微软雅黑', arial, '宋体', sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2<span style="text-align:left;">块区：<span style="text-align:left;">46 01 D0 07 00 00</span></span><br></span></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;分析：十六进制 &nbsp;46 01 表示刷卡次数<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 十六进制 &nbsp;D0 07 表示余额 &nbsp; &nbsp; &nbsp;换算 07D0 =十进制 2000 &nbsp;也即是20.00￥<br></p>
  <p><span style="color:#ff0000;">经验二（安工水卡 十里铺）</span></p>
  <p style="text-align:center;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180312212105227?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdWdseV9naXJs/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="text-align:left;">1块区：68 05 00 00 &nbsp; &nbsp; <u>97 FA FF &nbsp;FF</u> &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 11EE11EE &nbsp;</span><br></p>
  <p style="text-align:left;"><span style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2<span style="text-align:left;">块区：<span style="text-align:left;">68 05 00 00 &nbsp; &nbsp; <u>97 FA FF &nbsp;FF</u> &nbsp; &nbsp;68 05 00 00 &nbsp; &nbsp; 12ED12ED</span></span><br></span></p>
  <p style="text-align:left;"><span style="text-align:left;"><span style="text-align:left;"><span style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;校验位：<span style="text-align:left;">97 FA FF FF</span><br></span></span></span></p>
  <p style="text-align:left;"><span style="text-align:left;"><span style="text-align:left;"><span style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;余额位：<span style="text-align:left;">68 05 00 00&nbsp;</span><br></span></span></span></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 二者关系：十六进制 00 00 05 68&nbsp;<br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转二进制 0000 &nbsp;0000 &nbsp;0000 &nbsp;0000 &nbsp; 0101 &nbsp;0110 &nbsp;1000<br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;取反 &nbsp; &nbsp; &nbsp; 1111 &nbsp;1111 &nbsp;1111 &nbsp;1111 &nbsp; 1010 &nbsp;1001 &nbsp;0111<br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;转十六进制<span style="background-color:rgb(255,255,255);"><span style="color:#ff0000;">FF FF 0A 97</span></span><br></p>
  <p style="text-align:left;"><span style="color:#ff0000;">经验三（安师水卡 兰园 +图书馆+教学楼）</span></p>
  <p style="text-align:left;"><img src="http://img-blog.csdn.net/20180313151913206?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3VnbHlfZ2lybA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="text-align:left;">分析1（偏离）：对应数值分别为（卡片以十进制进行记录数据，以十六进制进行校验）</p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 00.06 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.42 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.37 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00.35<br></p>
  <p style="text-align:left;">易知卡片会对最近两次刷卡进行记录</p>
  <p style="text-align:left;">数值填充分析得：</p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;十进制：0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;3&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9</p>
  <p style="text-align:left;">对应十六进制为：F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 6</p>
  <p style="text-align:left;">则可知：06---------------F9</p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;42---------------BD<br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;37---------------C8<br></p>
  <p style="text-align:left;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;35---------------CA</p>
  <p style="text-align:left;">分析2（正确）</p>
  <p style="text-align:left;">&nbsp; &nbsp; 校验位 = 单个字节数值位相加后 取反 得之<br></p>
  <p style="text-align:left;">&nbsp; &nbsp; 即：BC = （43 + 00）取反<br></p>
  <p style="text-align:left;">&nbsp; &nbsp; 注：以上皆为十六进制运算，但是数值位为在使用中被当做10进制使用<br></p>
  <p style="text-align:left;">充值如下（50.00￥）</p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;0区块:81151234567800014798000000000000<br>&nbsp;&nbsp;&nbsp;&nbsp;1区块:AF 0050 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF<br>&nbsp;&nbsp;&nbsp;&nbsp;2区块:AE 0150 &nbsp;00FFFFFFFFFFFFFFFFFFFFFFFF<br>&nbsp;&nbsp;&nbsp;&nbsp;3区块:138731383233FF078069FFFFFFFFFFFF<br></p>
  <p style="text-align:left;"><span style="color:#ff0000;">（-------------------------未完待续---------------------未完待续<span style="text-align:left;">----------------------未完待续-----------------------------</span>）</span></p>
  <p style="text-align:left;"><br></p>
  <p style="text-align:left;"><span style="color:#ff0000;">其一（安工水卡/澡卡 十里铺）</span></p>
  <p style="text-align:center;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/2018031412275724?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3VnbHlfZ2lybA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 充值数据如下：（45.00）<br></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 1.区块：94 11 00 00 00 &nbsp; &nbsp; &nbsp;6B EE FF FF FF &nbsp; &nbsp;94 11 00 00 00......</p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 2.区块：95 11 00 00 00 &nbsp; &nbsp; &nbsp;6A EE FF FF FF &nbsp; &nbsp;95 11 00 00 00......<br></p>
  <p style="text-align:left;">其二</p>
  <p style="text-align:center;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/2018031412323671?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3VnbHlfZ2lybA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="text-align:left;">其三</p>
  <p style="text-align:center;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180314123340123?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3VnbHlfZ2lybA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="text-align:left;">其四（转载）</p>
  <p style="text-align:left;"></p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);"><span style="color:rgb(38,38,38);font-size:18px;"><span style="font-weight:700;line-height:24px;">饮水机卡数据分析</span></span></p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">饮水机卡中的数据比较特别，没有采用标准的电子钱包数据格式而且加了校验位。</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">下面是存储余额的sector的数据：</p>
  <pre style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;font-size:13px;line-height:1.42857;color:rgb(51,51,51);background-color:rgb(243,243,243);border:1px solid rgb(228,228,228);">00ca&nbsp;0901&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0140&nbsp;2338
cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56
cf01&nbsp;0000&nbsp;0000&nbsp;1311&nbsp;0600&nbsp;0000&nbsp;0200&nbsp;5a56
3847&nbsp;fd12&nbsp;bd08&nbsp;7f07&nbsp;88da&nbsp;32c0&nbsp;fe32&nbsp;b864</pre>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);"><span style="color:rgb(0,112,192);"><span style="font-weight:700;line-height:24px;">block1和block2的数据完全相同。</span></span>我们假设block1（也是block2）中的16个字节分别为B0~B15。经过几次刷卡之后发现，只有B0、B1、B15的数据会发生变化（对饮水机卡的研究已经过去很久了，数据都不在了，而我也懒得再出门去刷卡，请大家见谅哈）。经过多次对比卡机上显示的余额，初步确定B0、B1是余额数据（后来觉得B2B3应该也是余额数据的一部分）。然后猜测B14、B15是校验位，当然这是错的→_→。我的Sublime 3自动将2个字节放在一起显示，就像上面给的数据一样。</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">受此影响，我想当然的认为校验的时候是2个字节一组，于是发现校验位的值始终在0x5a00~0x5aff变化，而余额是一直减少的，试了相加、异或甚至MD5，都百思不得其解┬＿┬。于是到这里就算中断了，过一段时间后再看了看数据，发现0x5a是01011010，突然就想试试按字节校验（我也不知道为什么会这么想），结果还真是这样⊙０⊙。正确的数据结构是这样的：</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);"><span style="color:rgb(38,38,38);"><span style="font-weight:700;line-height:24px;">B0~B3是余额，B14固定为0x5a，B15为B0~B14求和后舍去进位的值，猜测B6开始的131106应该是卡首次投入使用的时间</span></span>（饮水机卡是循环使用的）。以上面的数据为例，余额是4.63元。对B0~B14求和是0×156，因此B15是0×56。</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">这种加了校验的数据相对来说还是比较难分析的，但也并不安全。</p>
  <br>
  <p style="text-align:left;">其五（转载）</p>
  <p style="text-align:left;"><span style="font-weight:700;color:rgb(38,38,38);font-size:18px;background-color:rgb(255,255,255);font-family:'微软雅黑';">太阳能水卡数据分析</span></p>
  <p style="text-align:left;"></p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">太阳能卡是在有余额和校验位的基础上又增加了其他数据。下面是存储余额数据的block连续3次刷卡的记录：</p>
  <pre><code class="language-plain"><span class="lit" style="color:rgb(25,95,145);background-color:rgb(255,204,102);">020d</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(255,204,102);">0000</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(255,102,0);">2c06</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">5c09</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(0,204,204);">1500</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(255,102,102);">2c06</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">4900</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(255,204,51);">5a90</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);"> f60c&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">0000</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">2f06</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">5d09</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(0,204,204);">1500</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">2f06</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">4a00</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">5a8b</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);"> ea0c&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">0000</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">3206</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">5e09</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);background-color:rgb(51,204,255);">1500</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">3206</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">4b00</span><span class="pln" style="background-color:rgb(247,247,249);color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="background-color:rgb(247,247,249);color:rgb(25,95,145);">5a87</span></code></pre>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">从以上刷卡数据中，结合饮水机卡中的分析，经过计算可以确定：</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);"><span style="font-weight:700;line-height:24px;"><span style="color:rgb(38,38,38);">1、B0~B3为卡的余额，B14为固定的0x5a，B15为求和校验位；</span></span></p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">2、B13B12和B7B6的数据每次刷卡会加一，所以我们猜测其中一个数据可能是刷卡次数，取第一行刷卡的数据，0x095c（B7B6）是十进制2396，不可能是这么多，所以<span style="color:rgb(38,38,38);"><span style="font-weight:700;line-height:24px;">B13B12是刷卡次数</span></span>，而<span style="color:rgb(38,38,38);"><span style="font-weight:700;line-height:24px;">B7B6的初始值为 0x095c-0×0049=0×0913</span>；</span></p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">3、<span style="color:rgb(38,38,38);"><span style="font-weight:700;line-height:24px;">B8B9的值固定不变为0×1500</span></span>，试试看<span style="color:rgb(38,38,38);"><span style="font-weight:700;line-height:24px;">B6B7的初始值和B8组合的结果——是130915</span>，</span>觉得熟悉吗？是的，是日期（好机智的设计有木有！）。</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">4、B4B5和B10B11的值是相同的，而它们也在增加。你发现了吗？它们每次增加3，也就是刷卡次数的3倍。据此我们能够计算出B5B4的初始值=0x062c-3*0×0049=0×0551。</p>
  <p style="font-size:15px;color:rgb(88,88,88);font-family:'微软雅黑';background-color:rgb(255,255,255);">现在，所有的数据都搞清楚了，我们要改写它的数据，让它的余额变成100元，也就是刚刚买到时候的余额。可以构造出这个block的数据为：</p>
  <pre><code class="language-plain"><span class="lit" style="color:rgb(25,95,145);">1027</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">0000</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">5105</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">1309</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">1500</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">5105</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">0000</span><span class="pln" style="color:rgb(72,72,76);">&nbsp;</span><span class="lit" style="color:rgb(25,95,145);">5a6e</span></code></pre>
  <br>
  <p style="text-align:left;">其六</p>
  <p style="text-align:center;"><img src="https://blog.uzzz.org/_p?https://img-blog.csdn.net/20180314131452411?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3VnbHlfZ2lybA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
  <p style="text-align:left;"><span style="color:#ff0000;">其七（安师水卡 竹园）</span></p>
  <p style="text-align:left;">卡一：</p>
  <p style="text-align:left;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0100 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;0F27 &nbsp;0000 &nbsp;FFFF &nbsp;29D6 &nbsp; &nbsp;0.01￥<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8813 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8813 &nbsp;0000 &nbsp;FFFF &nbsp;00FF &nbsp; &nbsp;50.00￥<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8713 &nbsp;0000 &nbsp;FFFF &nbsp;FFFF &nbsp;8913 &nbsp;0000 &nbsp;FFFF &nbsp;0EF1 &nbsp; &nbsp;49.00$<br><span> </span>&nbsp;分析得：1388 + 1388 = 2710 = (10000)10进制<br></p>
  <p>卡二： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;0100 &nbsp; 0000 &nbsp; FFFFFFFF &nbsp; 1F4E &nbsp; &nbsp;0000 &nbsp; FFFF &nbsp;50AF</p>
  <span> </span>&nbsp;分析得：
  <span style="text-align:left;">0001 + 4E1F = 4E20 &nbsp;= (20000)10进制</span>
  <br>
  <p><br></p>
  <p>校验位分析：经过卡一和卡二的对比，数据的后四位都可解析如下：</p>
  <p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>设数据位以字节进行分组，名称分别由b0~b15.</p>
  <p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>我们容易发现b0b1 与 b8b9 有此消彼长的规律，b14和b15也存在这样的规律，且</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b0b1 + b8b9 恒等于 2*充值数据（即<span style="text-align:left;">1388 + 1388 = 2710 = (10000)10进制</span>）；<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;b14 + b15 恒等于 FF（即29+D6 = FF）<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;由此我们可以完全破解数据，充值如下：</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:100.00$
  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 0000 FFFF FFFF 1027 0000 FFFF 00FF
  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:200.00$
  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E 0000 FFFF FFFF 204E 0000 FFFF 00FF
  <br>
  <p style="text-align:left;"><br></p>
  <p style="text-align:left;"><span style="color:#ff0000;">其八（安师澡卡 竹园）5扇区</span></p>
  <p style="text-align:left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9601 &nbsp; 00C8 &nbsp; 0100 &nbsp; 1203 &nbsp;1E0C &nbsp; 080B &nbsp;3602 &nbsp; 00EA &nbsp; &nbsp; &nbsp; 406￥<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8801 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 060D &nbsp; 2904 &nbsp;3702 &nbsp; 0026 &nbsp; &nbsp; &nbsp; 392￥<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7A01 &nbsp; 000E &nbsp; 0000 &nbsp; 1204 &nbsp; 0C0B &nbsp;180D &nbsp;3802 &nbsp; 0015 &nbsp; &nbsp; &nbsp; 378￥</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 以上为连续三次数据变化&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设数据位以字节进行分组，名称分别由b0~b15.<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 数据位：b0b1<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 固定位：b2,b5<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 校验位：b15(b0~b14的和)<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 时间： &nbsp; b6 ~b11（年月日时分秒）<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 刷卡次数：b12b13<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 本次刷卡消费金额：b3b4<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 由此充值如下：<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eg:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1027 &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00A8 &nbsp; 100.00￥<br></p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204E &nbsp;000E &nbsp;0000 &nbsp; &nbsp;1204 &nbsp;0F0C &nbsp;0000 &nbsp; 3002 &nbsp;00DF &nbsp; 200.00￥</p>
  <p>注意：该卡的区块三中有</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;ff078069 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥a解密</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; ：秘钥a &nbsp; &nbsp; &nbsp;7F0788DA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;秘钥b &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;使用秘钥b解密<br></p>
  <p style="text-align:left;">其九</p>
  <p style="text-align:left;">其十</p>
  <p style="text-align:center;"><br></p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ugly_girl/article/details/79532773,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/ugly_girl/article/details/79532773,&quot;}">阅读更多</a> 
 <!-- <a class="btn" href="https://passport.csdn.net/account/login?utm_source=csdn_blog_pc_more_login" target="_self" id="btn-lobinreadmore" data-track-view='{"mod":"popu_557","con":",https://blog.csdn.net/ugly_girl/article/details/79532773,"}' data-track-click='{"mod":"popu_557","con":",https://blog.csdn.net/ugly_girl/article/details/79532773,"}'>登录后自动展开</a> --> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
