<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>geth以太坊私有环境部署智能合约 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="geth以太坊私有环境部署智能合约" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，转载请务必注明出处，否则追究法律责任 https://blog.csdn.net/pony_maggie/article/details/79549879 环境 ubuntu 16.04， 64位 安装环境的过程省略。 将智能合约部署到 Geth 私有链 搭建geth私有网络 geth的全称是Go-ethereum,是一个以太坊客户端，用go语言编写，是目前最常用的客户端。 在home目录下新建一个geth目录(目录都可以自己定义)。然后进入该目录创建创世区块genesis.json文件，然后建一个chain目录，内容如下: { &quot;config&quot;: { &quot;chainId&quot;: 10, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;coinbase&quot; : &quot;0x0000000000000000000000000000000000000000&quot;, &quot;difficulty&quot; : &quot;0x4000&quot;, &quot;extraData&quot; : &quot;&quot;, &quot;gasLimit&quot; : &quot;0x8000000&quot;, &quot;nonce&quot; : &quot;0x0000000000000042&quot;, &quot;mixhash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;parentHash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;timestamp&quot; : &quot;0x00&quot;, &quot;alloc&quot;: {} } 释一下各个参数的作用： mixhash 与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。. nonce nonce就是一个64位随机数，用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 difficulty 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度（还可以试试0x400） alloc 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以。 coinbase 矿工的账号，随便填 timestamp 设置创世块的时间戳 parentHash 上一个区块的hash值，因为是创世块，所以这个值是0 extraData 附加信息，随便填，可以填你的个性信息 gasLimit 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。 geth新版本(1.5以上)要求创世区块一定要有”config”{}项啊，不然会报错 初始化创世块， pony@pony-virtual-machine:~/geth$ sudo geth init ./genesis.json --datadir &quot;./chain&quot; WARN [12-27|09:45:23] No etherbase set and no accounts found as default INFO [12-27|09:45:23] Allocated cache and file handles database=/home/pony/geth/geth/chaindata cache=16 handles=16 INFO [12-27|09:45:23] Writing custom genesis block INFO [12-27|09:45:23] Successfully wrote genesis state database=chaindata hash=ecf271…5269d6 INFO [12-27|09:45:23] Allocated cache and file handles database=/home/pony/geth/geth/lightchaindata cache=16 handles=16 INFO [12-27|09:45:23] Writing custom genesis block INFO [12-27|09:45:23] Successfully wrote genesis state database=lightchaindata hash=ecf271…5269d6 执行成功后，在chain目录下会新增出两个文件夹geth和keystore，geth中保存的是区块链的相关数据，keystore中保存的是该链条中的用户信息。 除了init命令，geth还支持一下命令: 命令: account 管理账户 attach 启动交互式JavaScript环境（连接到节点） bug 上报bug Issues console 启动交互式JavaScript环境 copydb 从文件夹创建本地链 dump Dump（分析）一个特定的块存储 dumpconfig 显示配置值 export 导出区块链到文件 import 导入一个区块链文件 init 启动并初始化一个新的创世纪块 js 执行指定的JavaScript文件(多个) license 显示许可信息 makecache 生成ethash验证缓存(用于测试) makedag 生成ethash 挖矿DAG(用于测试) monitor 监控和可视化节点指标 removedb 删除区块链和状态数据库 version 打印版本号 wallet 管理Ethereum预售钱包 help,h 显示一个命令或帮助一个命令列表 好，接着说正题，启动日志上提示我们没有默认账号，一会在新建。 启动控制台 pony@pony-virtual-machine:~/ethereum$ sudo geth --datadir &quot;./chain&quot; --networkid 15 --nodiscover --maxpeers 0 console WARN [01-02|17:03:01] No etherbase set and no accounts found as default INFO [01-02|17:03:01] Starting peer-to-peer node instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9 INFO [01-02|17:03:01] Allocated cache and file handles database=/home/pony/ethereum/chain/geth/chaindata cache=128 handles=1024 WARN [01-02|17:03:01] Upgrading database to use lookup entries INFO [01-02|17:03:01] Database deduplication successful deduped=0 INFO [01-02|17:03:01] Initialised chain configuration config=&quot;{ChainID: 10 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}&quot; INFO [01-02|17:03:01] Disk storage enabled for ethash caches dir=/home/pony/ethereum/chain/geth/ethash count=3 INFO [01-02|17:03:01] Disk storage enabled for ethash DAGs dir=/home/pony/.ethash count=2 INFO [01-02|17:03:01] Initialising Ethereum protocol versions=&quot;[63 62]&quot; network=15 INFO [01-02|17:03:01] Loaded most recent local header number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Loaded most recent local full block number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Loaded most recent local fast block number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Regenerated local transaction journal transactions=0 accounts=0 INFO [01-02|17:03:01] Starting P2P networking INFO [01-02|17:03:03] UDP listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:30303 INFO [01-02|17:03:03] RLPx listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:30303 INFO [01-02|17:03:03] IPC endpoint opened: /home/pony/ethereum/chain/geth.ipc Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 &gt; 如果觉得日志显示比较乱，可以把日志重定向输出到文件中，命令改成如下即可： sudo geth --datadir &quot;./chain&quot; --networkid 15 --nodiscover --maxpeers 0 console 2&gt;&gt;geth.log nodiscover表示禁用同伴发现。 maxpeers 设置为 0禁用网络。 启动后，会发现30303端口启动监听了。这里也可以用–port指定其它端口，因为后面mist连接私有链启动的时候用的也是30303，避免端口冲突。 另外，这个端口一定要记得，比方说你重启环境后，要确保 另外从启动信息可以看出，启动后会用到两个磁盘位置: INFO [02-19|21:06:47] Disk storage enabled for ethash caches dir=/home/pony/ethereum/chain/geth/ethash count=3 INFO [02-19|21:06:47] Disk storage enabled for ethash DAGs dir=/home/pony/.ethash count=2 回头我们重新测试的时候就知道该删除那些目录了。(删除.ethash目录和chain目录下的所有文件) 试试几个命令： 创建一个账号, &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d&quot; 查看当前账号列表 &gt; eth.accounts [&quot;0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d&quot;] 查询余额，发现是0，正常，因为还没有挖矿。 &gt; eth.getBalance(eth.accounts[0]) 0 挖矿，在公有链上，矿工打包平均需要15秒，在私有链上，我们需要自己来做这件事情： &gt; miner.start() INFO [01-02|17:04:11] Updated mining threads threads=0 INFO [01-02|17:04:11] Transaction pool price threshold updated price=18000000000 null &gt; INFO [01-02|17:04:11] Starting mining operation INFO [01-02|17:04:11] Commit new mining work number=1 txs=0 uncles=0 elapsed=207.311µs INFO [01-02|17:04:15] Generating DAG in progress epoch=0 percentage=0 elapsed=3.441s INFO [01-02|17:04:19] Generating DAG in progress epoch=0 percentage=1 elapsed=6.753s INFO [01-02|17:04:22] Generating DAG in progress epoch=0 percentage=2 elapsed=10.141s INFO [01-02|17:04:25] Generating DAG in progress epoch=0 percentage=3 elapsed=13.458s INFO [01-02|17:04:29] Generating DAG in progress epoch=0 percentage=4 elapsed=16.849s INFO [01-02|17:04:32] Generating DAG in progress epoch=0 percentage=5 elapsed=20.200s 这个percenage=100,也就是100%以后.,就差不多完成了，接下来提示: INFO [01-02|17:10:03] Generated ethash verification cache epoch=0 elapsed=5m50.965s INFO [01-02|17:10:10] Successfully sealed new block number=1 hash=6b8e7a…58bbf0 INFO [01-02|17:10:10] ? mined potential block number=1 hash=6b8e7a…58bbf0 INFO [01-02|17:10:10] Commit new mining work number=2 txs=0 uncles=0 elapsed=146.575µs INFO [01-02|17:10:10] Successfully sealed new block number=2 hash=a04334…c62f5c INFO [01-02|17:10:10] ? mined potential block number=2 hash=a04334…c62f5c INFO [01-02|17:10:10] Commit new mining work number=3 txs=0 uncles=0 elapsed=108.343µs 有小锤子的标识。回车输入miner.stop()可以停止挖矿，挖矿挖到的ether币会默认保在第一个账户中，即eth.acccounts[0]中。，然后查询余额: &gt; eth.getBalance(eth.accounts[0]) 95000000000000000000 OK,私有链创建成功。输入exit可以退出控制台。 强调几个注意点： 在挖矿的过程中我们也看到磁盘空间不断的增加，主要都在home目录下的.ethash目录下 挖矿是执行智能合约的基础。如果停止挖矿的话，不仅以太币会停止生成，所有智能合约的调用也会不起作用 阅读更多" />
<meta property="og:description" content="版权声明：本文为博主原创文章，转载请务必注明出处，否则追究法律责任 https://blog.csdn.net/pony_maggie/article/details/79549879 环境 ubuntu 16.04， 64位 安装环境的过程省略。 将智能合约部署到 Geth 私有链 搭建geth私有网络 geth的全称是Go-ethereum,是一个以太坊客户端，用go语言编写，是目前最常用的客户端。 在home目录下新建一个geth目录(目录都可以自己定义)。然后进入该目录创建创世区块genesis.json文件，然后建一个chain目录，内容如下: { &quot;config&quot;: { &quot;chainId&quot;: 10, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;coinbase&quot; : &quot;0x0000000000000000000000000000000000000000&quot;, &quot;difficulty&quot; : &quot;0x4000&quot;, &quot;extraData&quot; : &quot;&quot;, &quot;gasLimit&quot; : &quot;0x8000000&quot;, &quot;nonce&quot; : &quot;0x0000000000000042&quot;, &quot;mixhash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;parentHash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;timestamp&quot; : &quot;0x00&quot;, &quot;alloc&quot;: {} } 释一下各个参数的作用： mixhash 与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。. nonce nonce就是一个64位随机数，用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 difficulty 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度（还可以试试0x400） alloc 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以。 coinbase 矿工的账号，随便填 timestamp 设置创世块的时间戳 parentHash 上一个区块的hash值，因为是创世块，所以这个值是0 extraData 附加信息，随便填，可以填你的个性信息 gasLimit 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。 geth新版本(1.5以上)要求创世区块一定要有”config”{}项啊，不然会报错 初始化创世块， pony@pony-virtual-machine:~/geth$ sudo geth init ./genesis.json --datadir &quot;./chain&quot; WARN [12-27|09:45:23] No etherbase set and no accounts found as default INFO [12-27|09:45:23] Allocated cache and file handles database=/home/pony/geth/geth/chaindata cache=16 handles=16 INFO [12-27|09:45:23] Writing custom genesis block INFO [12-27|09:45:23] Successfully wrote genesis state database=chaindata hash=ecf271…5269d6 INFO [12-27|09:45:23] Allocated cache and file handles database=/home/pony/geth/geth/lightchaindata cache=16 handles=16 INFO [12-27|09:45:23] Writing custom genesis block INFO [12-27|09:45:23] Successfully wrote genesis state database=lightchaindata hash=ecf271…5269d6 执行成功后，在chain目录下会新增出两个文件夹geth和keystore，geth中保存的是区块链的相关数据，keystore中保存的是该链条中的用户信息。 除了init命令，geth还支持一下命令: 命令: account 管理账户 attach 启动交互式JavaScript环境（连接到节点） bug 上报bug Issues console 启动交互式JavaScript环境 copydb 从文件夹创建本地链 dump Dump（分析）一个特定的块存储 dumpconfig 显示配置值 export 导出区块链到文件 import 导入一个区块链文件 init 启动并初始化一个新的创世纪块 js 执行指定的JavaScript文件(多个) license 显示许可信息 makecache 生成ethash验证缓存(用于测试) makedag 生成ethash 挖矿DAG(用于测试) monitor 监控和可视化节点指标 removedb 删除区块链和状态数据库 version 打印版本号 wallet 管理Ethereum预售钱包 help,h 显示一个命令或帮助一个命令列表 好，接着说正题，启动日志上提示我们没有默认账号，一会在新建。 启动控制台 pony@pony-virtual-machine:~/ethereum$ sudo geth --datadir &quot;./chain&quot; --networkid 15 --nodiscover --maxpeers 0 console WARN [01-02|17:03:01] No etherbase set and no accounts found as default INFO [01-02|17:03:01] Starting peer-to-peer node instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9 INFO [01-02|17:03:01] Allocated cache and file handles database=/home/pony/ethereum/chain/geth/chaindata cache=128 handles=1024 WARN [01-02|17:03:01] Upgrading database to use lookup entries INFO [01-02|17:03:01] Database deduplication successful deduped=0 INFO [01-02|17:03:01] Initialised chain configuration config=&quot;{ChainID: 10 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}&quot; INFO [01-02|17:03:01] Disk storage enabled for ethash caches dir=/home/pony/ethereum/chain/geth/ethash count=3 INFO [01-02|17:03:01] Disk storage enabled for ethash DAGs dir=/home/pony/.ethash count=2 INFO [01-02|17:03:01] Initialising Ethereum protocol versions=&quot;[63 62]&quot; network=15 INFO [01-02|17:03:01] Loaded most recent local header number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Loaded most recent local full block number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Loaded most recent local fast block number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Regenerated local transaction journal transactions=0 accounts=0 INFO [01-02|17:03:01] Starting P2P networking INFO [01-02|17:03:03] UDP listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:30303 INFO [01-02|17:03:03] RLPx listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:30303 INFO [01-02|17:03:03] IPC endpoint opened: /home/pony/ethereum/chain/geth.ipc Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 &gt; 如果觉得日志显示比较乱，可以把日志重定向输出到文件中，命令改成如下即可： sudo geth --datadir &quot;./chain&quot; --networkid 15 --nodiscover --maxpeers 0 console 2&gt;&gt;geth.log nodiscover表示禁用同伴发现。 maxpeers 设置为 0禁用网络。 启动后，会发现30303端口启动监听了。这里也可以用–port指定其它端口，因为后面mist连接私有链启动的时候用的也是30303，避免端口冲突。 另外，这个端口一定要记得，比方说你重启环境后，要确保 另外从启动信息可以看出，启动后会用到两个磁盘位置: INFO [02-19|21:06:47] Disk storage enabled for ethash caches dir=/home/pony/ethereum/chain/geth/ethash count=3 INFO [02-19|21:06:47] Disk storage enabled for ethash DAGs dir=/home/pony/.ethash count=2 回头我们重新测试的时候就知道该删除那些目录了。(删除.ethash目录和chain目录下的所有文件) 试试几个命令： 创建一个账号, &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d&quot; 查看当前账号列表 &gt; eth.accounts [&quot;0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d&quot;] 查询余额，发现是0，正常，因为还没有挖矿。 &gt; eth.getBalance(eth.accounts[0]) 0 挖矿，在公有链上，矿工打包平均需要15秒，在私有链上，我们需要自己来做这件事情： &gt; miner.start() INFO [01-02|17:04:11] Updated mining threads threads=0 INFO [01-02|17:04:11] Transaction pool price threshold updated price=18000000000 null &gt; INFO [01-02|17:04:11] Starting mining operation INFO [01-02|17:04:11] Commit new mining work number=1 txs=0 uncles=0 elapsed=207.311µs INFO [01-02|17:04:15] Generating DAG in progress epoch=0 percentage=0 elapsed=3.441s INFO [01-02|17:04:19] Generating DAG in progress epoch=0 percentage=1 elapsed=6.753s INFO [01-02|17:04:22] Generating DAG in progress epoch=0 percentage=2 elapsed=10.141s INFO [01-02|17:04:25] Generating DAG in progress epoch=0 percentage=3 elapsed=13.458s INFO [01-02|17:04:29] Generating DAG in progress epoch=0 percentage=4 elapsed=16.849s INFO [01-02|17:04:32] Generating DAG in progress epoch=0 percentage=5 elapsed=20.200s 这个percenage=100,也就是100%以后.,就差不多完成了，接下来提示: INFO [01-02|17:10:03] Generated ethash verification cache epoch=0 elapsed=5m50.965s INFO [01-02|17:10:10] Successfully sealed new block number=1 hash=6b8e7a…58bbf0 INFO [01-02|17:10:10] ? mined potential block number=1 hash=6b8e7a…58bbf0 INFO [01-02|17:10:10] Commit new mining work number=2 txs=0 uncles=0 elapsed=146.575µs INFO [01-02|17:10:10] Successfully sealed new block number=2 hash=a04334…c62f5c INFO [01-02|17:10:10] ? mined potential block number=2 hash=a04334…c62f5c INFO [01-02|17:10:10] Commit new mining work number=3 txs=0 uncles=0 elapsed=108.343µs 有小锤子的标识。回车输入miner.stop()可以停止挖矿，挖矿挖到的ether币会默认保在第一个账户中，即eth.acccounts[0]中。，然后查询余额: &gt; eth.getBalance(eth.accounts[0]) 95000000000000000000 OK,私有链创建成功。输入exit可以退出控制台。 强调几个注意点： 在挖矿的过程中我们也看到磁盘空间不断的增加，主要都在home目录下的.ethash目录下 挖矿是执行智能合约的基础。如果停止挖矿的话，不仅以太币会停止生成，所有智能合约的调用也会不起作用 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/03/14/dbe56b1843e5056ab13d2b77ee69b518.html" />
<meta property="og:url" content="https://mlh.app/2018/03/14/dbe56b1843e5056ab13d2b77ee69b518.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-14T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，转载请务必注明出处，否则追究法律责任 https://blog.csdn.net/pony_maggie/article/details/79549879 环境 ubuntu 16.04， 64位 安装环境的过程省略。 将智能合约部署到 Geth 私有链 搭建geth私有网络 geth的全称是Go-ethereum,是一个以太坊客户端，用go语言编写，是目前最常用的客户端。 在home目录下新建一个geth目录(目录都可以自己定义)。然后进入该目录创建创世区块genesis.json文件，然后建一个chain目录，内容如下: { &quot;config&quot;: { &quot;chainId&quot;: 10, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;coinbase&quot; : &quot;0x0000000000000000000000000000000000000000&quot;, &quot;difficulty&quot; : &quot;0x4000&quot;, &quot;extraData&quot; : &quot;&quot;, &quot;gasLimit&quot; : &quot;0x8000000&quot;, &quot;nonce&quot; : &quot;0x0000000000000042&quot;, &quot;mixhash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;parentHash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;timestamp&quot; : &quot;0x00&quot;, &quot;alloc&quot;: {} } 释一下各个参数的作用： mixhash 与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。. nonce nonce就是一个64位随机数，用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 difficulty 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度（还可以试试0x400） alloc 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以。 coinbase 矿工的账号，随便填 timestamp 设置创世块的时间戳 parentHash 上一个区块的hash值，因为是创世块，所以这个值是0 extraData 附加信息，随便填，可以填你的个性信息 gasLimit 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。 geth新版本(1.5以上)要求创世区块一定要有”config”{}项啊，不然会报错 初始化创世块， pony@pony-virtual-machine:~/geth$ sudo geth init ./genesis.json --datadir &quot;./chain&quot; WARN [12-27|09:45:23] No etherbase set and no accounts found as default INFO [12-27|09:45:23] Allocated cache and file handles database=/home/pony/geth/geth/chaindata cache=16 handles=16 INFO [12-27|09:45:23] Writing custom genesis block INFO [12-27|09:45:23] Successfully wrote genesis state database=chaindata hash=ecf271…5269d6 INFO [12-27|09:45:23] Allocated cache and file handles database=/home/pony/geth/geth/lightchaindata cache=16 handles=16 INFO [12-27|09:45:23] Writing custom genesis block INFO [12-27|09:45:23] Successfully wrote genesis state database=lightchaindata hash=ecf271…5269d6 执行成功后，在chain目录下会新增出两个文件夹geth和keystore，geth中保存的是区块链的相关数据，keystore中保存的是该链条中的用户信息。 除了init命令，geth还支持一下命令: 命令: account 管理账户 attach 启动交互式JavaScript环境（连接到节点） bug 上报bug Issues console 启动交互式JavaScript环境 copydb 从文件夹创建本地链 dump Dump（分析）一个特定的块存储 dumpconfig 显示配置值 export 导出区块链到文件 import 导入一个区块链文件 init 启动并初始化一个新的创世纪块 js 执行指定的JavaScript文件(多个) license 显示许可信息 makecache 生成ethash验证缓存(用于测试) makedag 生成ethash 挖矿DAG(用于测试) monitor 监控和可视化节点指标 removedb 删除区块链和状态数据库 version 打印版本号 wallet 管理Ethereum预售钱包 help,h 显示一个命令或帮助一个命令列表 好，接着说正题，启动日志上提示我们没有默认账号，一会在新建。 启动控制台 pony@pony-virtual-machine:~/ethereum$ sudo geth --datadir &quot;./chain&quot; --networkid 15 --nodiscover --maxpeers 0 console WARN [01-02|17:03:01] No etherbase set and no accounts found as default INFO [01-02|17:03:01] Starting peer-to-peer node instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9 INFO [01-02|17:03:01] Allocated cache and file handles database=/home/pony/ethereum/chain/geth/chaindata cache=128 handles=1024 WARN [01-02|17:03:01] Upgrading database to use lookup entries INFO [01-02|17:03:01] Database deduplication successful deduped=0 INFO [01-02|17:03:01] Initialised chain configuration config=&quot;{ChainID: 10 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}&quot; INFO [01-02|17:03:01] Disk storage enabled for ethash caches dir=/home/pony/ethereum/chain/geth/ethash count=3 INFO [01-02|17:03:01] Disk storage enabled for ethash DAGs dir=/home/pony/.ethash count=2 INFO [01-02|17:03:01] Initialising Ethereum protocol versions=&quot;[63 62]&quot; network=15 INFO [01-02|17:03:01] Loaded most recent local header number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Loaded most recent local full block number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Loaded most recent local fast block number=0 hash=4b7556…13cf12 td=16384 INFO [01-02|17:03:01] Regenerated local transaction journal transactions=0 accounts=0 INFO [01-02|17:03:01] Starting P2P networking INFO [01-02|17:03:03] UDP listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:30303 INFO [01-02|17:03:03] RLPx listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:30303 INFO [01-02|17:03:03] IPC endpoint opened: /home/pony/ethereum/chain/geth.ipc Welcome to the Geth JavaScript console! instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 &gt; 如果觉得日志显示比较乱，可以把日志重定向输出到文件中，命令改成如下即可： sudo geth --datadir &quot;./chain&quot; --networkid 15 --nodiscover --maxpeers 0 console 2&gt;&gt;geth.log nodiscover表示禁用同伴发现。 maxpeers 设置为 0禁用网络。 启动后，会发现30303端口启动监听了。这里也可以用–port指定其它端口，因为后面mist连接私有链启动的时候用的也是30303，避免端口冲突。 另外，这个端口一定要记得，比方说你重启环境后，要确保 另外从启动信息可以看出，启动后会用到两个磁盘位置: INFO [02-19|21:06:47] Disk storage enabled for ethash caches dir=/home/pony/ethereum/chain/geth/ethash count=3 INFO [02-19|21:06:47] Disk storage enabled for ethash DAGs dir=/home/pony/.ethash count=2 回头我们重新测试的时候就知道该删除那些目录了。(删除.ethash目录和chain目录下的所有文件) 试试几个命令： 创建一个账号, &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d&quot; 查看当前账号列表 &gt; eth.accounts [&quot;0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d&quot;] 查询余额，发现是0，正常，因为还没有挖矿。 &gt; eth.getBalance(eth.accounts[0]) 0 挖矿，在公有链上，矿工打包平均需要15秒，在私有链上，我们需要自己来做这件事情： &gt; miner.start() INFO [01-02|17:04:11] Updated mining threads threads=0 INFO [01-02|17:04:11] Transaction pool price threshold updated price=18000000000 null &gt; INFO [01-02|17:04:11] Starting mining operation INFO [01-02|17:04:11] Commit new mining work number=1 txs=0 uncles=0 elapsed=207.311µs INFO [01-02|17:04:15] Generating DAG in progress epoch=0 percentage=0 elapsed=3.441s INFO [01-02|17:04:19] Generating DAG in progress epoch=0 percentage=1 elapsed=6.753s INFO [01-02|17:04:22] Generating DAG in progress epoch=0 percentage=2 elapsed=10.141s INFO [01-02|17:04:25] Generating DAG in progress epoch=0 percentage=3 elapsed=13.458s INFO [01-02|17:04:29] Generating DAG in progress epoch=0 percentage=4 elapsed=16.849s INFO [01-02|17:04:32] Generating DAG in progress epoch=0 percentage=5 elapsed=20.200s 这个percenage=100,也就是100%以后.,就差不多完成了，接下来提示: INFO [01-02|17:10:03] Generated ethash verification cache epoch=0 elapsed=5m50.965s INFO [01-02|17:10:10] Successfully sealed new block number=1 hash=6b8e7a…58bbf0 INFO [01-02|17:10:10] ? mined potential block number=1 hash=6b8e7a…58bbf0 INFO [01-02|17:10:10] Commit new mining work number=2 txs=0 uncles=0 elapsed=146.575µs INFO [01-02|17:10:10] Successfully sealed new block number=2 hash=a04334…c62f5c INFO [01-02|17:10:10] ? mined potential block number=2 hash=a04334…c62f5c INFO [01-02|17:10:10] Commit new mining work number=3 txs=0 uncles=0 elapsed=108.343µs 有小锤子的标识。回车输入miner.stop()可以停止挖矿，挖矿挖到的ether币会默认保在第一个账户中，即eth.acccounts[0]中。，然后查询余额: &gt; eth.getBalance(eth.accounts[0]) 95000000000000000000 OK,私有链创建成功。输入exit可以退出控制台。 强调几个注意点： 在挖矿的过程中我们也看到磁盘空间不断的增加，主要都在home目录下的.ethash目录下 挖矿是执行智能合约的基础。如果停止挖矿的话，不仅以太币会停止生成，所有智能合约的调用也会不起作用 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/03/14/dbe56b1843e5056ab13d2b77ee69b518.html","headline":"geth以太坊私有环境部署智能合约","dateModified":"2018-03-14T00:00:00+08:00","datePublished":"2018-03-14T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/03/14/dbe56b1843e5056ab13d2b77ee69b518.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>geth以太坊私有环境部署智能合约</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，转载请务必注明出处，否则追究法律责任 https://blog.csdn.net/pony_maggie/article/details/79549879 
 </div> 
 <div class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p><strong>环境</strong></p> 
  <p>ubuntu 16.04， 64位</p> 
  <p>安装环境的过程省略。</p> 
  <hr> 
  <h2 id="将智能合约部署到-geth-私有链">将智能合约部署到 Geth 私有链</h2> 
  <h3 id="搭建geth私有网络">搭建geth私有网络</h3> 
  <p>geth的全称是Go-ethereum,是一个以太坊客户端，用go语言编写，是目前最常用的客户端。</p> 
  <p>在home目录下新建一个geth目录(目录都可以自己定义)。然后进入该目录创建创世区块genesis.json文件，然后建一个chain目录，内容如下:</p> 
  <pre class="prettyprint"><code class=" hljs json">{
"<span class="hljs-attribute">config</span>": <span class="hljs-value">{ "<span class="hljs-attribute">chainId</span>": <span class="hljs-value"><span class="hljs-number">10</span></span>, "<span class="hljs-attribute">homesteadBlock</span>": <span class="hljs-value"><span class="hljs-number">0</span></span>, "<span class="hljs-attribute">eip155Block</span>": <span class="hljs-value"><span class="hljs-number">0</span></span>, "<span class="hljs-attribute">eip158Block</span>": <span class="hljs-value"><span class="hljs-number">0</span> </span>}</span>,
  "<span class="hljs-attribute">coinbase</span>"   : <span class="hljs-value"><span class="hljs-string">"0x0000000000000000000000000000000000000000"</span></span>,
  "<span class="hljs-attribute">difficulty</span>" : <span class="hljs-value"><span class="hljs-string">"0x4000"</span></span>,
  "<span class="hljs-attribute">extraData</span>"  : <span class="hljs-value"><span class="hljs-string">""</span></span>,
  "<span class="hljs-attribute">gasLimit</span>"   : <span class="hljs-value"><span class="hljs-string">"0x8000000"</span></span>,
  "<span class="hljs-attribute">nonce</span>"      : <span class="hljs-value"><span class="hljs-string">"0x0000000000000042"</span></span>,
  "<span class="hljs-attribute">mixhash</span>"    : <span class="hljs-value"><span class="hljs-string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span></span>,
  "<span class="hljs-attribute">parentHash</span>" : <span class="hljs-value"><span class="hljs-string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span></span>,
  "<span class="hljs-attribute">timestamp</span>"  : <span class="hljs-value"><span class="hljs-string">"0x00"</span></span>,
  "<span class="hljs-attribute">alloc</span>": <span class="hljs-value">{} </span>}</code></pre> 
  <p>释一下各个参数的作用：</p> 
  <pre class="prettyprint"><code class=" hljs mathematica">mixhash
与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的<span class="hljs-keyword">Yellow</span> paper, <span class="hljs-number">4.3</span><span class="hljs-number">.4</span>. <span class="hljs-keyword">Block</span> Header Validity, (<span class="hljs-number">44</span>)章节所描述的条件。.
nonce
nonce就是一个<span class="hljs-number">64</span>位随机数，用于挖矿，注意他和mixhash的设置需要满足以太坊的<span class="hljs-keyword">Yellow</span> paper, <span class="hljs-number">4.3</span><span class="hljs-number">.4</span>. <span class="hljs-keyword">Block</span> Header Validity, (<span class="hljs-number">44</span>)章节所描述的条件。
difficulty
设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度（还可以试试<span class="hljs-number">0x400</span>）
alloc
用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以。
coinbase
矿工的账号，随便填
timestamp
设置创世块的时间戳
parentHash
上一个区块的hash值，因为是创世块，所以这个值是<span class="hljs-number">0</span>
extraData
附加信息，随便填，可以填你的个性信息
gasLimit
该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。
</code></pre> 
  <p><strong>geth新版本(1.5以上)要求创世区块一定要有”config”{}项啊，不然会报错</strong></p> 
  <p>初始化创世块，</p> 
  <pre class="prettyprint"><code class=" hljs sql">pony@pony-virtual-machine:~/geth$ sudo geth init ./genesis.json <span class="hljs-comment">--datadir "./chain"</span>
WARN [12-27|09:45:23] No etherbase <span class="hljs-operator"><span class="hljs-keyword">set</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">no</span> accounts <span class="hljs-keyword">found</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">default</span> INFO [<span class="hljs-number">12</span>-<span class="hljs-number">27</span>|<span class="hljs-number">09</span>:<span class="hljs-number">45</span>:<span class="hljs-number">23</span>] Allocated cache <span class="hljs-keyword">and</span> file handles <span class="hljs-keyword">database</span>=/home/pony/geth/geth/chaindata cache=<span class="hljs-number">16</span> handles=<span class="hljs-number">16</span> INFO [<span class="hljs-number">12</span>-<span class="hljs-number">27</span>|<span class="hljs-number">09</span>:<span class="hljs-number">45</span>:<span class="hljs-number">23</span>] Writing custom genesis block INFO [<span class="hljs-number">12</span>-<span class="hljs-number">27</span>|<span class="hljs-number">09</span>:<span class="hljs-number">45</span>:<span class="hljs-number">23</span>] Successfully wrote genesis state <span class="hljs-keyword">database</span>=chaindata hash=ecf271…<span class="hljs-number">5269</span>d6 INFO [<span class="hljs-number">12</span>-<span class="hljs-number">27</span>|<span class="hljs-number">09</span>:<span class="hljs-number">45</span>:<span class="hljs-number">23</span>] Allocated cache <span class="hljs-keyword">and</span> file handles <span class="hljs-keyword">database</span>=/home/pony/geth/geth/lightchaindata cache=<span class="hljs-number">16</span> handles=<span class="hljs-number">16</span> INFO [<span class="hljs-number">12</span>-<span class="hljs-number">27</span>|<span class="hljs-number">09</span>:<span class="hljs-number">45</span>:<span class="hljs-number">23</span>] Writing custom genesis block INFO [<span class="hljs-number">12</span>-<span class="hljs-number">27</span>|<span class="hljs-number">09</span>:<span class="hljs-number">45</span>:<span class="hljs-number">23</span>] Successfully wrote genesis state <span class="hljs-keyword">database</span>=lightchaindata hash=ecf271…<span class="hljs-number">5269</span>d6 </span></code></pre> 
  <p>执行成功后，在chain目录下会新增出两个文件夹geth和keystore，geth中保存的是区块链的相关数据，keystore中保存的是该链条中的用户信息。</p> 
  <p>除了init命令，geth还支持一下命令:</p> 
  <pre class="prettyprint"><code class=" hljs d">
命令:

account    管理账户
attach     启动交互式JavaScript环境（连接到节点）
bug        上报bug Issues
console    启动交互式JavaScript环境
copydb     从文件夹创建本地链
dump       Dump（分析）一个特定的块存储
dumpconfig 显示配置值
<span class="hljs-keyword">export</span>     导出区块链到文件
<span class="hljs-keyword">import</span>     导入一个区块链文件
init       启动并初始化一个新的创世纪块
js         执行指定的JavaScript文件(多个)
license    显示许可信息
makecache  生成ethash验证缓存(用于测试)
makedag    生成ethash 挖矿DAG(用于测试)
monitor    监控和可视化节点指标
removedb   删除区块链和状态数据库
<span class="hljs-keyword">version</span>    打印版本号
wallet     管理Ethereum预售钱包
help,h     显示一个命令或帮助一个命令列表
</code></pre> 
  <p>好，接着说正题，启动日志上提示我们没有默认账号，一会在新建。</p> 
  <p>启动控制台</p> 
  <pre class="prettyprint"><code class=" hljs sql">
pony@pony-virtual-machine:~/ethereum$ sudo geth <span class="hljs-comment">--datadir "./chain" --networkid 15 --nodiscover --maxpeers 0 console</span>
WARN [01-02|17:03:01] No etherbase <span class="hljs-operator"><span class="hljs-keyword">set</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">no</span> accounts <span class="hljs-keyword">found</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">default</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Starting peer-<span class="hljs-keyword">to</span>-peer node instance=Geth/v1<span class="hljs-number">.7</span><span class="hljs-number">.3</span>-stable-<span class="hljs-number">4</span>bb3c89d/linux-amd64/go1<span class="hljs-number">.9</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Allocated cache <span class="hljs-keyword">and</span> file handles <span class="hljs-keyword">database</span>=/home/pony/ethereum/chain/geth/chaindata cache=<span class="hljs-number">128</span> handles=<span class="hljs-number">1024</span> WARN [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Upgrading <span class="hljs-keyword">database</span> <span class="hljs-keyword">to</span> use lookup entries INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] <span class="hljs-keyword">Database</span> deduplication successful deduped=<span class="hljs-number">0</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Initialised chain configuration config=<span class="hljs-string">"{ChainID: 10 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}"</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Disk storage enabled <span class="hljs-keyword">for</span> ethash caches dir=/home/pony/ethereum/chain/geth/ethash <span class="hljs-aggregate">count</span>=<span class="hljs-number">3</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Disk storage enabled <span class="hljs-keyword">for</span> ethash DAGs dir=/home/pony/.ethash <span class="hljs-aggregate">count</span>=<span class="hljs-number">2</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Initialising Ethereum protocol versions=<span class="hljs-string">"[63 62]"</span> network=<span class="hljs-number">15</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Loaded most recent <span class="hljs-keyword">local</span> header <span class="hljs-keyword">number</span>=<span class="hljs-number">0</span> hash=<span class="hljs-number">4</span>b7556…<span class="hljs-number">13</span>cf12 td=<span class="hljs-number">16384</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Loaded most recent <span class="hljs-keyword">local</span> <span class="hljs-keyword">full</span> block <span class="hljs-keyword">number</span>=<span class="hljs-number">0</span> hash=<span class="hljs-number">4</span>b7556…<span class="hljs-number">13</span>cf12 td=<span class="hljs-number">16384</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Loaded most recent <span class="hljs-keyword">local</span> fast block <span class="hljs-keyword">number</span>=<span class="hljs-number">0</span> hash=<span class="hljs-number">4</span>b7556…<span class="hljs-number">13</span>cf12 td=<span class="hljs-number">16384</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Regenerated <span class="hljs-keyword">local</span> <span class="hljs-keyword">transaction</span> journal transactions=<span class="hljs-number">0</span> accounts=<span class="hljs-number">0</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">01</span>] Starting P2P networking INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">03</span>] UDP listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:<span class="hljs-number">30303</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">03</span>] RLPx listener up self=enode://a8c6eeda2bd1327548e367f4f6a5cf1df3e91e4a341e9a543a74d69e28a4a2ea4c4d0708bdeb6bd2bcef228ec0e3aa3b5a926e2801db503193b1eca4032908a5@[::]:<span class="hljs-number">30303</span> INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">03</span>:<span class="hljs-number">03</span>] IPC endpoint opened: /home/pony/ethereum/chain/geth.ipc Welcome <span class="hljs-keyword">to</span> the Geth JavaScript console! instance: Geth/v1<span class="hljs-number">.7</span><span class="hljs-number">.3</span>-stable-<span class="hljs-number">4</span>bb3c89d/linux-amd64/go1<span class="hljs-number">.9</span> modules: admin:<span class="hljs-number">1.0</span> debug:<span class="hljs-number">1.0</span> eth:<span class="hljs-number">1.0</span> miner:<span class="hljs-number">1.0</span> net:<span class="hljs-number">1.0</span> personal:<span class="hljs-number">1.0</span> rpc:<span class="hljs-number">1.0</span> txpool:<span class="hljs-number">1.0</span> web3:<span class="hljs-number">1.0</span> &gt; </span></code></pre> 
  <p><strong>如果觉得日志显示比较乱，可以把日志重定向输出到文件中，命令改成如下即可：</strong></p> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">sudo</span> <span class="hljs-comment">geth</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">datadir</span> <span class="hljs-comment">"</span><span class="hljs-string">.</span><span class="hljs-comment">/chain"</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">networkid</span> <span class="hljs-comment">15</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">nodiscover</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">maxpeers</span> <span class="hljs-comment">0</span> <span class="hljs-comment">console</span> <span class="hljs-comment">2</span>&gt;&gt;<span class="hljs-comment">geth</span><span class="hljs-string">.</span><span class="hljs-comment">log</span></code></pre> 
  <ul> 
   <li>nodiscover表示禁用同伴发现。</li> 
   <li>maxpeers 设置为 0禁用网络。</li> 
  </ul> 
  <p>启动后，会发现30303端口启动监听了。这里也可以用–port指定其它端口，因为后面mist连接私有链启动的时候用的也是30303，避免端口冲突。</p> 
  <p>另外，这个端口一定要记得，比方说你重启环境后，要确保</p> 
  <p>另外从启动信息可以看出，启动后会用到两个磁盘位置:</p> 
  <pre class="prettyprint"><code class=" hljs rust">INFO [<span class="hljs-number">02</span>-<span class="hljs-number">19</span>|<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">47</span>] Disk storage enabled <span class="hljs-keyword">for</span> ethash caches   <span class="hljs-keyword">dir</span>=/home/pony/ethereum/chain/geth/ethash count=<span class="hljs-number">3</span>
INFO [<span class="hljs-number">02</span>-<span class="hljs-number">19</span>|<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">47</span>] Disk storage enabled <span class="hljs-keyword">for</span> ethash DAGs     <span class="hljs-keyword">dir</span>=/home/pony/.ethash                    count=<span class="hljs-number">2</span>
</code></pre> 
  <p>回头我们重新测试的时候就知道该删除那些目录了。(删除.ethash目录和chain目录下的所有文件)</p> 
  <p>试试几个命令：</p> 
  <p>创建一个账号,</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; personal<span class="hljs-preprocessor">.newAccount</span>()
<span class="hljs-label">Passphrase:</span> 
Repeat passphrase: 
<span class="hljs-string">"0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d"</span></code></pre> 
  <p>查看当前账号列表</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; eth<span class="hljs-preprocessor">.accounts</span>
[<span class="hljs-string">"0xdec60d1eaf07362e011d83a4fde88da1ed5eaf7d"</span>]
</code></pre> 
  <p>查询余额，发现是0，正常，因为还没有挖矿。</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">0</span></code></pre> 
  <p>挖矿，在公有链上，矿工打包平均需要15秒，在私有链上，我们需要自己来做这件事情：</p> 
  <pre class="prettyprint"><code class=" hljs 1c">&gt; miner.start()
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:11] Updated mining threads threads=0</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:11] Transaction pool price threshold updated price=18000000000</span>
null
&gt; INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:11] Starting mining operation </span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:11] Commit new mining work number=1 txs=0 uncles=0 elapsed=207.311µs</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:15] Generating DAG in progress epoch=0 percentage=0 elapsed=3.441s</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:19] Generating DAG in progress epoch=0 percentage=1 elapsed=6.753s</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:22] Generating DAG in progress epoch=0 percentage=2 elapsed=10.141s</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:25] Generating DAG in progress epoch=0 percentage=3 elapsed=13.458s</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:29] Generating DAG in progress epoch=0 percentage=4 elapsed=16.849s</span>
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span><span class="hljs-string">|17:04:32] Generating DAG in progress epoch=0 percentage=5 elapsed=20.200s</span>
</code></pre> 
  <p>这个percenage=100,也就是100%以后.,就差不多完成了，接下来提示:</p> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">03</span>] Generated ethash verification cache      epoch=<span class="hljs-number">0</span> elapsed=<span class="hljs-number">5</span>m50<span class="hljs-number">.965</span>s
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span>] Successfully sealed <span class="hljs-built_in">new</span> block            <span class="hljs-built_in">number</span>=<span class="hljs-number">1</span> hash=<span class="hljs-number">6</span>b8e7a…<span class="hljs-number">58</span>bbf0
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span>] ? mined potential block                  <span class="hljs-built_in">number</span>=<span class="hljs-number">1</span> hash=<span class="hljs-number">6</span>b8e7a…<span class="hljs-number">58</span>bbf0
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span>] Commit <span class="hljs-built_in">new</span> mining work                   <span class="hljs-built_in">number</span>=<span class="hljs-number">2</span> txs=<span class="hljs-number">0</span> uncles=<span class="hljs-number">0</span> elapsed=<span class="hljs-number">146.575</span>µs
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span>] Successfully sealed <span class="hljs-built_in">new</span> block            <span class="hljs-built_in">number</span>=<span class="hljs-number">2</span> hash=a04334…c62f5c
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span>] ? mined potential block                  <span class="hljs-built_in">number</span>=<span class="hljs-number">2</span> hash=a04334…c62f5c
INFO [<span class="hljs-number">01</span>-<span class="hljs-number">02</span>|<span class="hljs-number">17</span>:<span class="hljs-number">10</span>:<span class="hljs-number">10</span>] Commit <span class="hljs-built_in">new</span> mining work                   <span class="hljs-built_in">number</span>=<span class="hljs-number">3</span> txs=<span class="hljs-number">0</span> uncles=<span class="hljs-number">0</span> elapsed=<span class="hljs-number">108.343</span>µs
</code></pre> 
  <p>有小锤子的标识。回车输入miner.stop()可以停止挖矿，挖矿挖到的ether币会默认保在第一个账户中，即eth.acccounts[0]中。，然后查询余额:</p> 
  <pre class="prettyprint"><code class=" hljs avrasm">&gt; eth<span class="hljs-preprocessor">.getBalance</span>(eth<span class="hljs-preprocessor">.accounts</span>[<span class="hljs-number">0</span>])
<span class="hljs-number">95000000000000000000</span>
</code></pre> 
  <p>OK,私有链创建成功。输入exit可以退出控制台。</p> 
  <p>强调几个注意点：</p> 
  <p><strong>在挖矿的过程中我们也看到磁盘空间不断的增加，主要都在home目录下的.ethash目录下</strong></p> 
  <p><strong>挖矿是执行智能合约的基础。如果停止挖矿的话，不仅以太币会停止生成，所有智能合约的调用也会不起作用</strong></p> 
  <hr> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7f770a53f2.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/pony_maggie/article/details/79549879,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/pony_maggie/article/details/79549879,&quot;}">阅读更多</a> 
</div> 
<script>
						(function(){
							function setArticleH(btnReadmore,posi){
								var winH = $(window).height();
								var articleBox = $("div.article_content");
								var artH = articleBox.height();
								if(artH > winH*posi){
									articleBox.css({
										'height':winH*posi+'px',
										'overflow':'hidden'
									})
									btnReadmore.click(function(){
										articleBox.removeAttr("style");
										$(this).parent().remove();
									})
								}else{
									btnReadmore.parent().remove();
								}
							}
							var btnReadmore = $("#btn-readmore");
							if(btnReadmore.length>0){
								if(currentUserName){
									setArticleH(btnReadmore,3);
								}else{
									setArticleH(btnReadmore,1.2);
								}
							}
						})()
					</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
