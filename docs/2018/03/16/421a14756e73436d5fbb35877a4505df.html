<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>如何搭建以太坊私链——小白入门 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="如何搭建以太坊私链——小白入门" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="&nbsp;&nbsp;&nbsp;&nbsp;“区块链”这个词近几个月的社会出现频率越来越高，虽然很多人是冲着币圈去的，但是还是有很多技术宅是真正在研究区块链技术的。 &nbsp;&nbsp;&nbsp;&nbsp;今天老林就来给大家唠唠怎么搭建以太坊的私有链，小白入门级别的，大神请略过。 说明 一、为什么用到私有链？ 在以太坊的共有链上部署智能合约、发起交易需要花费以太币。而通过修改配置，可以在本机搭建一套以太坊私有链，因为与公有链没关系，既不用同步公有链庞大的数据，也不用花钱购买以太币，很好地满足了智能合约开发和测试的要求，开发好的智能合约也可以很容易地切换接口部署到以太坊公有链上。 二、需要用到哪些工具？ 以太坊客户端以太坊客户端用于接入以太坊网络，进行账户管理、交易、挖矿、智能合约相关的操作。目前有多种语言实现的客户端，常用的有 Go 语言实现的 go-ethereum 客户端 Geth，支持接入以太坊网络并成为一个完整节点，也可作为一个 HTTP-RPC 服务器对外提供 JSON-RPC 接口。其他的客户端有： Parity：Rust 语言实现； cpp-ethereum：C++ 语言实现； ethereumjs-lib：JavaScript 语言实现； Ethereum(J)：Java 语言实现； ethereumH：Haskell 语言实现； pyethapp： Python 语言实现； ruby-ethereum：Ruby 语言实现； 智能合约编译器以太坊支持两种智能合约的编程语言：Solidity 和 Serpent。Serpent 语言面临一些安全问题，现在已经不推荐使用了。Solidity 语法类似 JavaScript，它编译器 solc 可以把智能合约源码编译成以太坊虚拟机 EVM 可以执行的二进制码。现在以太坊提供更方便的在线 IDE —— Remix&nbsp;https://remix.ethereum.org&nbsp;使用 Remix，免去了安装 solc 和编译过程，它可以直接提供部署合约所需的二进制码和 ABI。 以太坊钱包以太坊提供了图形界面的钱包 Ethereum Wallet 和 Mist Dapp 浏览器。钱包的功能是 Mist 的一个子集，可用于管理账户和交易；Mist 在钱包基础上，还能操作智能合约。为了演示合约部署过程，本文使用了 Geth console 操作，没有用到 Mist，当然，使用 Mist 会更简单。 安装环境 这里以 Ubuntu 16.04 为例进行介绍。 一、安装以太坊客户端 两种方式可选：PPA 直接安装、源码编译安装。 PPA 直接安装安装必要的工具包： 1 apt install software-properties-common 添加以太坊源： 1 2 add-apt-repository -y ppa:ethereum/ethereum apt update 安装 go-ethereum： 1 apt install ethereum 安装完成后，可以使用&nbsp;geth version&nbsp;命令查看是否安装成功。 源码安装因为 go-ethereum 使用 Go 语言编写，编译源码前需要配置好 Go 环境。配置 Go 语言环境参照&nbsp;https://golang.org/doc/install简单地，以安装 go 1.9 为例： 1 2 wget https://storage.googleapis.com/golang/go1.9.linux-amd64.tar.gz tar -C /usr/local -xzf go1.9.linux-amd64.tar.gz 编辑&nbsp;/etc/profile&nbsp;或&nbsp;$HOME/.profile，在文件最后添加环境变量： 1 export PATH=$PATH:/usr/local/go/bin 编辑&nbsp;$HOME/profile&nbsp;或&nbsp;$HOME/.bashrc，添加 go 工作目录环境变量： 1 export GOPATH=$HOME/gopath 下载和编译 Geth安装 C 编译器： 1 apt install -y build-essential 下载最新源码： 1 git clone https://github.com/ethereum/go-ethereum 编译安装： 1 2 cd go-ethereum make geth 安装完成后，可以使用&nbsp;geth version&nbsp;命令查看是否安装成功。记得把生成的 geth 加入到系统的环境变量中。 我在这里用的是第一种方式，最后使用geth version 得到的结果是：root@daniel-Aspire-E5-572G:/home/daniel# geth version Geth Version: 1.8.2-stable Git Commit: b8b9f7f4476a30a0aaf6077daade6ae77f969960 Architecture: amd64 Protocol Versions: [63 62] Network Id: 1 Go Version: go1.9.4 Operating System: linux GOPATH= GOROOT=/usr/lib/go-1.9 二、安装 Solidity 编译器 Solidity 编译器也有多种方法安装，参照&nbsp;http://solidity.readthedocs.io/en/latest/installing-solidity.html&nbsp;这里介绍最简单快捷的安装方式：PPA 直接安装。 PPA 直接安装 1 2 3 add-apt-repository ppa:ethereum/ethereum apt update apt install solc 官方推荐使用基于浏览器的 IDE 环境：Remix&nbsp;https://remix.ethereum.org 私有链搭建 一、配置初始状态 要运行以太坊私有链，需要定义自己的创世区块，创世区块信息写在一个 JSON 格式的配置文件中。首先将下面的内容保存到一个 JSON 文件中，例如&nbsp;genesis.json。 { &quot;config&quot;: { &quot;chainID&quot;: 1909, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;alloc&quot;: {}, &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000001&quot;, &quot;difficulty&quot;: &quot;0x400&quot;, &quot;extraData&quot;: &quot;0x888&quot;, &quot;gasLimit&quot;: &quot;0xffffffff&quot;, &quot;nonce&quot;: &quot;0x1909201819092018&quot;, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;timestamp&quot;: &quot;0x00&quot; } chainID:指定了独立的区块链网络 ID。网络 ID 在连接到其他节点的时候会用到，以太坊公网的网络 ID 是 1，为了不与公有链网络冲突，运行私有链节点的时候要指定自己的网络 ID。不同 ID 网络的节点无法相互连接。 alloc: 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以，默认为空即可。 coinbase: 矿工的账号，随便填即可。 difficulty: 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度。 extraData: 附加信息。这里要注意一下，新版本该值需要为16进制数据，以0x 开头。 gasLimit: 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们要做的是私有链，所以此处填最大。 nonce: nonce就是一个64位随机数(0x后一位为4个二进制位，故有16位），用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 mixhash：与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 parentHash: 上一个区块的hash值，因为是创世块，所以这个值是0。 timestamp: 设置创世块的时间戳。 在 Geth 1.6+ 中，以太坊提供了一个生成创世块的向导工具：puppeth。并且提供了更适合在私有链中使用的 Clique POA 共识算法。puppeth 的使用，可以参照《利用puppeth搭建POA共识的以太坊私链网络》。 二、初始化：写入创世区块 准备好创世区块配置文件后，需要初始化区块链，将上面的创世区块信息写入到区块链中。首先要新建一个目录用来存放区块链数据，假设新建的数据目录为&nbsp;~/315私有链/data0，genesis.json&nbsp;保存在&nbsp;~/315私有链&nbsp;中，此时目录结构应该是这样的： 1 2 3 315私有链 ├── data0 └── genesis.json 接下来进入 “315私有链” 中，执行初始化命令： 1 2 cd 315私有链 geth --datadir data0 init genesis.json 上面的命令的主体是&nbsp;geth init，表示初始化区块链，命令可以带有选项和参数，其中&nbsp;--datadir&nbsp;选项后面跟一个目录名，这里为 data0，表示指定数据存放目录为 data0，genesis.json 是&nbsp;init&nbsp;命令的参数。 运行上面的命令，会读取&nbsp;genesis.json&nbsp;文件，根据其中的内容，将创世区块写入到区块链中。如果看到以下的输出内容，说明初始化成功了。 INFO [03-15|21:09:45] Maximum peer count ETH=25 LES=0 total=25 INFO [03-15|21:09:45] Allocated cache and file handles database=/home/daniel/315私有链/data0/geth/chaindata cache=16 handles=16 INFO [03-15|21:09:45] Writing custom genesis block INFO [03-15|21:09:45] Persisted trie from memory database nodes=0 size=0.00B time=3.869µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B INFO [03-15|21:09:45] Successfully wrote genesis state database=chaindata hash=51a849…59f068 INFO [03-15|21:09:45] Allocated cache and file handles database=/home/daniel/315私有链/data0/geth/lightchaindata cache=16 handles=16 INFO [03-15|21:09:45] Writing custom genesis block INFO [03-15|21:09:45] Persisted trie from memory database nodes=0 size=0.00B time=7.307µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B INFO [03-15|21:09:45] Successfully wrote genesis state database=lightchaindata hash=51a849…59f068 初始化成功后，会在数据目录 data0 中生成&nbsp; geth &nbsp;和&nbsp; keystore &nbsp;两个文件夹，此时目录结构如下： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 315私有链 ├── data0 │&nbsp;&nbsp; ├── geth │&nbsp;&nbsp; │&nbsp;&nbsp; ├── chaindata │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000 │&nbsp;&nbsp; │&nbsp;&nbsp; └── lightchaindata │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000 │&nbsp;&nbsp; └── keystore └── genesis.json 其中&nbsp;geth/chaindata&nbsp;中存放的是区块数据，keystore&nbsp;中存放的是账户数据。 三、启动私有链节点 初始化完成后，就有了一条自己的私有链，之后就可以启动自己的私有链节点并做一些操作，在终端中输入以下命令即可启动节点： 1 geth --identity &quot;SCAU&quot; --rpc --rpcport &quot;8545&quot; --datadir data0 --port &quot;30303&quot; -- rpcapi &quot;db,eth,net,web3&quot;--networkid 65534--nodiscover console 上面命令的主体是&nbsp;geth console，表示启动节点并进入交互式控制台。各选项含义如下： –identity：指定节点，用于标示目前网络的名字； –rpc：表示开启 HTTP-RPC 服务； –rpcport：指定 HTTP-RPC 服务监听端口号（默认为 8545）； –datadir：指定区块链数据的存储位置； –port：指定和其他节点连接所用的端口号（默认为 30303）； –rpcapi： 设置允许连接的rpc的客户端，一般为db,eth,net,web3； –networkid： 设置当前区块链的网络ID，用于区分不同的网络，是一个数字； –nodiscover：关闭节点发现机制，防止加入有同样初始配置的陌生节点； –maxpeers : 如果你不希望其他人连接到你的测试链，可以使用maxpeers 0。反之，如果你确切知道希望多少人连接到你的节点，你也可以通过调整数字来实现； –rpccorsdomain : 这个可以指示什么URL能连接到你的节点来执行RPC定制端任务。务必谨慎，输入一个特定的URL而不是wildcard ( * )，后者会使所有的URL都能连接到你的RPC实例； –console：启动命令行模式，可以在Geth中执行命令。 注意： 1.上面蓝色字体的参数为非必须的，必要时才写入； 2.如果想将Ubuntu作为永久区块链节点使用，当使用nohup命令时，Geth启动参数console必须去掉，否则Geth会自动停止。 运行上面的命令后，就启动了区块链节点并进入了该节点的控制台： 1 2 3 4 5 ... Welcome to the Geth JavaScript console! instance: Geth/TestNode/v1.6.7-stable-ab5646c5/linux-amd64/go1.8.1 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 这是一个交互式的 JavaScript 执行环境，在这里面可以执行 JavaScript 代码，其中&nbsp;&gt;&nbsp;是命令提示符。在这个环境里也内置了一些用来操作以太坊的 JavaScript 对象，可以直接使用这些对象。这些对象主要包括： eth：包含一些跟操作区块链相关的方法； net：包含一些查看p2p网络状态的方法； admin：包含一些与管理节点相关的方法； miner：包含启动&amp;停止挖矿的一些方法； personal：主要包含一些管理账户的方法； txpool：包含一些查看交易内存池的方法； web3：包含了以上对象，还包含一些单位换算的方法。 控制台操作 进入以太坊 Javascript Console 后，就可以使用里面的内置对象做一些操作，这些内置对象提供的功能很丰富，比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。 常用命令有： personal.newAccount()：创建账户； personal.unlockAccount()：解锁账户； eth.accounts：枚举系统中的账户； eth.getBalance()：查看账户余额，返回值的单位是 Wei（Wei 是以太坊中最小货币面额单位，类似比特币中的聪，1 ether = 10^18 Wei）； eth.blockNumber：列出区块总数； eth.getTransaction()：获取交易； eth.getBlock()：获取区块； miner.start()：开始挖矿； miner.stop()：停止挖矿； web3.fromWei()：Wei 换算成以太币； web3.toWei()：以太币换算成 Wei； txpool.status：交易池中的状态； admin.addPeer()：连接到其他节点； 这些命令支持&nbsp;Tab&nbsp;键自动补全，具体用法如下。 一、创建账户 1 2 3 4 5 &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot; &gt; INFO [03-16|00:55:44] New wallet appeared url=keystore:///root/work/privatech… status=Locked 输入两遍密码后，会生成账户地址。 再创建一个账户： 1 2 3 4 5 &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot; &gt; INFO [03-16|01:10:45] New wallet appeared url=keystore:///root/work/privatech… status=Locked 查看刚刚创建的两个账户： 1 2 &gt; eth.accounts [&quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot;] 二、查看账户余额 1 2 3 4 &gt; eth.getBalance(eth.accounts[0]) 0 &gt; eth.getBalance(eth.accounts[1]) 0 三、启动&amp;停止挖矿 启动挖矿： 1 &gt; miner.start(1) 其中 start 的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的 DAG 文件，这个过程有点慢，等进度达到 100% 后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。 停止挖矿，在 console 中输入： 1 &gt; miner.stop() 挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做 coinbase，默认情况下 coinbase 是本地账户中的第一个账户，可以通过 miner.setEtherbase() 将其他账户设置成 coinbase。 四、发送交易 目前，账户 0 已经挖到了 3 个块的奖励，账户 1 的余额还是0： 1 2 3 4 &gt; eth.getBalance(eth.accounts[0]) 15000000000000000000 &gt; eth.getBalance(eth.accounts[1]) 0 我们要从账户 0 向账户 1 转账，所以要先解锁账户 0，才能发起交易： 1 2 3 4 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802 Passphrase: true 发送交易，账户 0 -&gt; 账户 1： 1 2 3 4 5 &gt; amount = web3.toWei(5,&#39;ether&#39;) &quot;5000000000000000000&quot; &gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount}) INFO [03-16|01:32:36] Submitted transaction fullhash=0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce recipient=0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62 &quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot; 此时如果没有挖矿，用&nbsp;txpool.status&nbsp;命令可以看到本地交易池中有一个待确认的交易，可以使用&nbsp;eth.getBlock(&quot;pending&quot;, true).transactions&nbsp;查看当前待确认交易。 使用&nbsp;miner.start()&nbsp;命令开始挖矿： 1 &gt; miner.start(1);admin.sleepBlocks(1);miner.stop(); 新区块挖出后，挖矿结束，查看账户 1 的余额，已经收到了账户 0 的以太币： 1 2 &gt; web3.fromWei(eth.getBalance(eth.accounts[1]),&#39;ether&#39;) 5 五、查看交易和区块 查看当前区块总数： 1 2 &gt; eth.blockNumber 4 通过交易 Hash 查看交易（Hash 值包含在上面交易返回值中）： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 &gt; eth.getTransaction(&quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;) { blockHash: &quot;0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d&quot;, blockNumber: 4, from: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, gas: 90000, gasPrice: 18000000000, hash: &quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;, input: &quot;0x&quot;, nonce: 0, r: &quot;0x4214d2d8d92efc3aafb515d2413ecd45ab3695d9bcc30d9c7c06932de829e064&quot;, s: &quot;0x42822033225a2ef662b9b448576e0271b9958e1f4ec912c259e01c84bd1f6681&quot;, to: &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot;, transactionIndex: 0, v: &quot;0x824&quot;, value: 5000000000000000000 } 通过区块号查看区块： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 &gt; eth.getBlock(4) { difficulty: 131072, extraData: &quot;0xd783010607846765746887676f312e382e31856c696e7578&quot;, gasLimit: 3153874, gasUsed: 21000, hash: &quot;0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, mixHash: &quot;0x6df88079cf4fbfae98ad7588926fa30becddf4b8b55f93f0380d82ce0533338c&quot;, nonce: &quot;0x39455ee908666993&quot;, number: 4, parentHash: &quot;0x14fe27755d6fcc704f6b7018d5dc8193f702d89f2c7807bf6f0e402a2b0a29d9&quot;, receiptsRoot: &quot;0xfcb5b5cc322998562d96339418d08ad8e7c5dd87935f9a3321e040344e3fd095&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 651, stateRoot: &quot;0xdd4a0ce76c7e0ff149853dce5bb4f99592fb1bc3c5e87eb07518a0235ffacd8c&quot;, timestamp: 1505202063, totalDifficulty: 525312, transactions: [&quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;], transactionsRoot: &quot;0xbb909845183e037b15d24fe9ad1805fd00350ae04841aa774be6af96e76fdbf9&quot;, uncles: [] } 六、连接到其他节点 可以通过&nbsp;admin.addPeer()&nbsp;方法连接到其他节点，两个节点要要指定相同的 chainID。 假设有两个节点：节点一和节点二，chainID 都是 1024，通过下面的步骤就可以从节点一连接到节点二。 首先要知道节点二的 enode 信息，在节点二的 JavaScript console 中执行下面的命令查看 enode 信息： 1 2 &gt; admin.nodeInfo.enode &quot;enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@[::]:30303&quot; 然后在节点一的 JavaScript console 中执行 admin.addPeer()，就可以连接到节点二： 1 &gt; admin.addPeer(&quot;enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@127.0.0.1:30304&quot;) addPeer() 的参数就是节点二的 enode 信息，注意要把 enode 中的&nbsp;[::]&nbsp;替换成节点二的 IP 地址。连接成功后，节点二就会开始同步节点一的区块，同步完成后，任意一个节点开始挖矿，另一个节点会自动同步区块，向任意一个节点发送交易，另一个节点也会收到该笔交易。 通过&nbsp;admin.peers&nbsp;可以查看连接到的其他节点信息，通过&nbsp;net.peerCount&nbsp;可以查看已连接到的节点数量。 除了上面的方法，也可以在启动节点的时候指定&nbsp;--bootnodes&nbsp;选项连接到其他节点。 智能合约操作 一、创建和编译智能合约 新建一个 Solidity 智能合约文件，命名为&nbsp;testContract.sol，该合约包含一个方法&nbsp;multiply()，将输入的两个数相乘后输出： 1 2 3 4 5 6 7 8 pragma solidity ^0.4.0; contract TestContract { function multiply(uint a, uint b) returns (uint) { return a * b; } } 编译智能合约，获得编译后的 EVM 二进制码： 1 2 3 4 5 $ solc --bin testContract.sol ======= testContract.sol:TestContract ======= Binary: 6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029 再用 solc 获取智能合约的 JSON ABI（Application Binary Interface），其中指定了合约接口，包括可调用的合约方法、变量、事件等： 1 2 3 4 5 $ solc --abi testContract.sol ======= testContract.sol:TestContract ======= Contract JSON ABI [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;a&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;b&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}] 回到 Geth 的控制台，用变量&nbsp;code&nbsp;和&nbsp;abi&nbsp;记录上面两个值，注意在 code 前加上&nbsp;0x&nbsp;前缀： 1 2 &gt; code = &quot;0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029&quot; &gt; abi = [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;a&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;b&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}] 二、部署智能合约 这里使用账户 0 来部署合约，首先解锁账户： 1 2 3 4 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802 Passphrase: true 发送部署合约的交易： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 &gt; myContract = eth.contract(abi) ... &gt; contract = myContract.new({from:eth.accounts[0],data:code,gas:1000000}) INFO [09-12|08:05:19] Submitted contract creation fullhash=0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1 contract=0x7cbe4019e993f9922b8233502d94890099ee59e6 { abi: [{ constant: false, inputs: [{...}, {...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, stateMutability: &quot;nonpayable&quot;, type: &quot;function&quot; }], address: undefined, transactionHash: &quot;0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1&quot; } 此时如果没有挖矿，用&nbsp;txpool.status&nbsp;命令可以看到本地交易池中有一个待确认的交易。使用下面的命令查看当前待确认的交易： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [{ blockHash: &quot;0xfedd6fef9f25e96a5a20b5ffcd152e9fe05d193ae0989c25d6197d2441c2c09b&quot;, blockNumber: 5, from: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, gas: 1000000, gasPrice: 18000000000, hash: &quot;0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1&quot;, input: &quot;0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029&quot;, nonce: 3, r: &quot;0xfe7139a31694a36f946e7182c35c52a21bf31d33994490815f63f6674e84dc93&quot;, s: &quot;0x4701a984ee93d2a323fac55547b31534b11915599de75202a1d62061241fefbf&quot;, to: null, transactionIndex: 0, v: &quot;0x823&quot;, value: 0 }] 使用&nbsp;miner.start()&nbsp;命令开始挖矿，一段时间后交易会被确认，随新区块进入区块链。 三、调用智能合约 使用以下命令发送交易，sendTransaction&nbsp;方法的前几个参数应该与合约中&nbsp;multiply&nbsp;方法的输入参数对应。这种情况下，交易会通过挖矿记录到区块链中： 1 2 3 4 &gt; contract.multiply.sendTransaction(2, 4, {from:eth.accounts[0]}) INFO [03-16|02:54:16] Submitted transaction fullhash=0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2 recipient=0x7cbe4019e993f9922b8233502d94890099ee59e6 &quot;0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2&quot; 如果只是本地运行该方法查看返回结果，可以采用如下方式： 1 2 &gt; contract.multiply.call(2，4) 8 术语说明 术语 &nbsp; 说明 ABI Application Binary Interface，应用二进制接口 其中指定了合约接口，包括可调用的合约方法、变量、事件等。 DApp Decentralized App，去中心化的应用程序 基于智能合约的应用称为去中心化的应用程序。 EVM Ethereum Virtual Machine，以太坊虚拟机 以太坊智能合约的运行环境。 Gas （消耗的）汽油 在以太坊上发起交易、部署合约和调用合约都要消耗一定量的以太币，这些消耗的以太币称为 Gas。 Geth - 以太坊客户端 go-ethereum，使用 Go 语言编写，是最常用的以太坊客户端之一。 Solidity - 以太坊智能合约的一种编程语言，类似 JavaScript。 Remix IDE https://remix.ethereum.org 基于浏览器的 Solidity 集成开发环境，在浏览器中编写和调试智能合约。 参考内容 《区块链——原理、设计与应用》杨保华、陈昌编著，机械工业出版 以太坊学习笔记：私有链搭建操作指南&nbsp;https://my.oschina.net/u/2349981/blog/865256 利用puppeth搭建POA共识的以太坊私链网络&nbsp;https://github.com/xiaoping378/blog/blob/master/posts/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA%E5%88%9D%E6%AD%A5%E5%AE%9E%E8%B7%B5.md 区块链技术指南&nbsp;https://yeasy.gitbooks.io/blockchain_guide/ethereum/install.html Solidity 官方文档&nbsp;http://solidity.readthedocs.io/en/latest/installing-solidity.html Go 官方文档&nbsp;https://golang.org/doc/install 更多区块链资料，请访问&nbsp;https://github.com/gymgle/blockchain-reference 阅读更多" />
<meta property="og:description" content="&nbsp;&nbsp;&nbsp;&nbsp;“区块链”这个词近几个月的社会出现频率越来越高，虽然很多人是冲着币圈去的，但是还是有很多技术宅是真正在研究区块链技术的。 &nbsp;&nbsp;&nbsp;&nbsp;今天老林就来给大家唠唠怎么搭建以太坊的私有链，小白入门级别的，大神请略过。 说明 一、为什么用到私有链？ 在以太坊的共有链上部署智能合约、发起交易需要花费以太币。而通过修改配置，可以在本机搭建一套以太坊私有链，因为与公有链没关系，既不用同步公有链庞大的数据，也不用花钱购买以太币，很好地满足了智能合约开发和测试的要求，开发好的智能合约也可以很容易地切换接口部署到以太坊公有链上。 二、需要用到哪些工具？ 以太坊客户端以太坊客户端用于接入以太坊网络，进行账户管理、交易、挖矿、智能合约相关的操作。目前有多种语言实现的客户端，常用的有 Go 语言实现的 go-ethereum 客户端 Geth，支持接入以太坊网络并成为一个完整节点，也可作为一个 HTTP-RPC 服务器对外提供 JSON-RPC 接口。其他的客户端有： Parity：Rust 语言实现； cpp-ethereum：C++ 语言实现； ethereumjs-lib：JavaScript 语言实现； Ethereum(J)：Java 语言实现； ethereumH：Haskell 语言实现； pyethapp： Python 语言实现； ruby-ethereum：Ruby 语言实现； 智能合约编译器以太坊支持两种智能合约的编程语言：Solidity 和 Serpent。Serpent 语言面临一些安全问题，现在已经不推荐使用了。Solidity 语法类似 JavaScript，它编译器 solc 可以把智能合约源码编译成以太坊虚拟机 EVM 可以执行的二进制码。现在以太坊提供更方便的在线 IDE —— Remix&nbsp;https://remix.ethereum.org&nbsp;使用 Remix，免去了安装 solc 和编译过程，它可以直接提供部署合约所需的二进制码和 ABI。 以太坊钱包以太坊提供了图形界面的钱包 Ethereum Wallet 和 Mist Dapp 浏览器。钱包的功能是 Mist 的一个子集，可用于管理账户和交易；Mist 在钱包基础上，还能操作智能合约。为了演示合约部署过程，本文使用了 Geth console 操作，没有用到 Mist，当然，使用 Mist 会更简单。 安装环境 这里以 Ubuntu 16.04 为例进行介绍。 一、安装以太坊客户端 两种方式可选：PPA 直接安装、源码编译安装。 PPA 直接安装安装必要的工具包： 1 apt install software-properties-common 添加以太坊源： 1 2 add-apt-repository -y ppa:ethereum/ethereum apt update 安装 go-ethereum： 1 apt install ethereum 安装完成后，可以使用&nbsp;geth version&nbsp;命令查看是否安装成功。 源码安装因为 go-ethereum 使用 Go 语言编写，编译源码前需要配置好 Go 环境。配置 Go 语言环境参照&nbsp;https://golang.org/doc/install简单地，以安装 go 1.9 为例： 1 2 wget https://storage.googleapis.com/golang/go1.9.linux-amd64.tar.gz tar -C /usr/local -xzf go1.9.linux-amd64.tar.gz 编辑&nbsp;/etc/profile&nbsp;或&nbsp;$HOME/.profile，在文件最后添加环境变量： 1 export PATH=$PATH:/usr/local/go/bin 编辑&nbsp;$HOME/profile&nbsp;或&nbsp;$HOME/.bashrc，添加 go 工作目录环境变量： 1 export GOPATH=$HOME/gopath 下载和编译 Geth安装 C 编译器： 1 apt install -y build-essential 下载最新源码： 1 git clone https://github.com/ethereum/go-ethereum 编译安装： 1 2 cd go-ethereum make geth 安装完成后，可以使用&nbsp;geth version&nbsp;命令查看是否安装成功。记得把生成的 geth 加入到系统的环境变量中。 我在这里用的是第一种方式，最后使用geth version 得到的结果是：root@daniel-Aspire-E5-572G:/home/daniel# geth version Geth Version: 1.8.2-stable Git Commit: b8b9f7f4476a30a0aaf6077daade6ae77f969960 Architecture: amd64 Protocol Versions: [63 62] Network Id: 1 Go Version: go1.9.4 Operating System: linux GOPATH= GOROOT=/usr/lib/go-1.9 二、安装 Solidity 编译器 Solidity 编译器也有多种方法安装，参照&nbsp;http://solidity.readthedocs.io/en/latest/installing-solidity.html&nbsp;这里介绍最简单快捷的安装方式：PPA 直接安装。 PPA 直接安装 1 2 3 add-apt-repository ppa:ethereum/ethereum apt update apt install solc 官方推荐使用基于浏览器的 IDE 环境：Remix&nbsp;https://remix.ethereum.org 私有链搭建 一、配置初始状态 要运行以太坊私有链，需要定义自己的创世区块，创世区块信息写在一个 JSON 格式的配置文件中。首先将下面的内容保存到一个 JSON 文件中，例如&nbsp;genesis.json。 { &quot;config&quot;: { &quot;chainID&quot;: 1909, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;alloc&quot;: {}, &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000001&quot;, &quot;difficulty&quot;: &quot;0x400&quot;, &quot;extraData&quot;: &quot;0x888&quot;, &quot;gasLimit&quot;: &quot;0xffffffff&quot;, &quot;nonce&quot;: &quot;0x1909201819092018&quot;, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;timestamp&quot;: &quot;0x00&quot; } chainID:指定了独立的区块链网络 ID。网络 ID 在连接到其他节点的时候会用到，以太坊公网的网络 ID 是 1，为了不与公有链网络冲突，运行私有链节点的时候要指定自己的网络 ID。不同 ID 网络的节点无法相互连接。 alloc: 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以，默认为空即可。 coinbase: 矿工的账号，随便填即可。 difficulty: 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度。 extraData: 附加信息。这里要注意一下，新版本该值需要为16进制数据，以0x 开头。 gasLimit: 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们要做的是私有链，所以此处填最大。 nonce: nonce就是一个64位随机数(0x后一位为4个二进制位，故有16位），用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 mixhash：与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 parentHash: 上一个区块的hash值，因为是创世块，所以这个值是0。 timestamp: 设置创世块的时间戳。 在 Geth 1.6+ 中，以太坊提供了一个生成创世块的向导工具：puppeth。并且提供了更适合在私有链中使用的 Clique POA 共识算法。puppeth 的使用，可以参照《利用puppeth搭建POA共识的以太坊私链网络》。 二、初始化：写入创世区块 准备好创世区块配置文件后，需要初始化区块链，将上面的创世区块信息写入到区块链中。首先要新建一个目录用来存放区块链数据，假设新建的数据目录为&nbsp;~/315私有链/data0，genesis.json&nbsp;保存在&nbsp;~/315私有链&nbsp;中，此时目录结构应该是这样的： 1 2 3 315私有链 ├── data0 └── genesis.json 接下来进入 “315私有链” 中，执行初始化命令： 1 2 cd 315私有链 geth --datadir data0 init genesis.json 上面的命令的主体是&nbsp;geth init，表示初始化区块链，命令可以带有选项和参数，其中&nbsp;--datadir&nbsp;选项后面跟一个目录名，这里为 data0，表示指定数据存放目录为 data0，genesis.json 是&nbsp;init&nbsp;命令的参数。 运行上面的命令，会读取&nbsp;genesis.json&nbsp;文件，根据其中的内容，将创世区块写入到区块链中。如果看到以下的输出内容，说明初始化成功了。 INFO [03-15|21:09:45] Maximum peer count ETH=25 LES=0 total=25 INFO [03-15|21:09:45] Allocated cache and file handles database=/home/daniel/315私有链/data0/geth/chaindata cache=16 handles=16 INFO [03-15|21:09:45] Writing custom genesis block INFO [03-15|21:09:45] Persisted trie from memory database nodes=0 size=0.00B time=3.869µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B INFO [03-15|21:09:45] Successfully wrote genesis state database=chaindata hash=51a849…59f068 INFO [03-15|21:09:45] Allocated cache and file handles database=/home/daniel/315私有链/data0/geth/lightchaindata cache=16 handles=16 INFO [03-15|21:09:45] Writing custom genesis block INFO [03-15|21:09:45] Persisted trie from memory database nodes=0 size=0.00B time=7.307µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B INFO [03-15|21:09:45] Successfully wrote genesis state database=lightchaindata hash=51a849…59f068 初始化成功后，会在数据目录 data0 中生成&nbsp; geth &nbsp;和&nbsp; keystore &nbsp;两个文件夹，此时目录结构如下： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 315私有链 ├── data0 │&nbsp;&nbsp; ├── geth │&nbsp;&nbsp; │&nbsp;&nbsp; ├── chaindata │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000 │&nbsp;&nbsp; │&nbsp;&nbsp; └── lightchaindata │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000 │&nbsp;&nbsp; └── keystore └── genesis.json 其中&nbsp;geth/chaindata&nbsp;中存放的是区块数据，keystore&nbsp;中存放的是账户数据。 三、启动私有链节点 初始化完成后，就有了一条自己的私有链，之后就可以启动自己的私有链节点并做一些操作，在终端中输入以下命令即可启动节点： 1 geth --identity &quot;SCAU&quot; --rpc --rpcport &quot;8545&quot; --datadir data0 --port &quot;30303&quot; -- rpcapi &quot;db,eth,net,web3&quot;--networkid 65534--nodiscover console 上面命令的主体是&nbsp;geth console，表示启动节点并进入交互式控制台。各选项含义如下： –identity：指定节点，用于标示目前网络的名字； –rpc：表示开启 HTTP-RPC 服务； –rpcport：指定 HTTP-RPC 服务监听端口号（默认为 8545）； –datadir：指定区块链数据的存储位置； –port：指定和其他节点连接所用的端口号（默认为 30303）； –rpcapi： 设置允许连接的rpc的客户端，一般为db,eth,net,web3； –networkid： 设置当前区块链的网络ID，用于区分不同的网络，是一个数字； –nodiscover：关闭节点发现机制，防止加入有同样初始配置的陌生节点； –maxpeers : 如果你不希望其他人连接到你的测试链，可以使用maxpeers 0。反之，如果你确切知道希望多少人连接到你的节点，你也可以通过调整数字来实现； –rpccorsdomain : 这个可以指示什么URL能连接到你的节点来执行RPC定制端任务。务必谨慎，输入一个特定的URL而不是wildcard ( * )，后者会使所有的URL都能连接到你的RPC实例； –console：启动命令行模式，可以在Geth中执行命令。 注意： 1.上面蓝色字体的参数为非必须的，必要时才写入； 2.如果想将Ubuntu作为永久区块链节点使用，当使用nohup命令时，Geth启动参数console必须去掉，否则Geth会自动停止。 运行上面的命令后，就启动了区块链节点并进入了该节点的控制台： 1 2 3 4 5 ... Welcome to the Geth JavaScript console! instance: Geth/TestNode/v1.6.7-stable-ab5646c5/linux-amd64/go1.8.1 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 这是一个交互式的 JavaScript 执行环境，在这里面可以执行 JavaScript 代码，其中&nbsp;&gt;&nbsp;是命令提示符。在这个环境里也内置了一些用来操作以太坊的 JavaScript 对象，可以直接使用这些对象。这些对象主要包括： eth：包含一些跟操作区块链相关的方法； net：包含一些查看p2p网络状态的方法； admin：包含一些与管理节点相关的方法； miner：包含启动&amp;停止挖矿的一些方法； personal：主要包含一些管理账户的方法； txpool：包含一些查看交易内存池的方法； web3：包含了以上对象，还包含一些单位换算的方法。 控制台操作 进入以太坊 Javascript Console 后，就可以使用里面的内置对象做一些操作，这些内置对象提供的功能很丰富，比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。 常用命令有： personal.newAccount()：创建账户； personal.unlockAccount()：解锁账户； eth.accounts：枚举系统中的账户； eth.getBalance()：查看账户余额，返回值的单位是 Wei（Wei 是以太坊中最小货币面额单位，类似比特币中的聪，1 ether = 10^18 Wei）； eth.blockNumber：列出区块总数； eth.getTransaction()：获取交易； eth.getBlock()：获取区块； miner.start()：开始挖矿； miner.stop()：停止挖矿； web3.fromWei()：Wei 换算成以太币； web3.toWei()：以太币换算成 Wei； txpool.status：交易池中的状态； admin.addPeer()：连接到其他节点； 这些命令支持&nbsp;Tab&nbsp;键自动补全，具体用法如下。 一、创建账户 1 2 3 4 5 &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot; &gt; INFO [03-16|00:55:44] New wallet appeared url=keystore:///root/work/privatech… status=Locked 输入两遍密码后，会生成账户地址。 再创建一个账户： 1 2 3 4 5 &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot; &gt; INFO [03-16|01:10:45] New wallet appeared url=keystore:///root/work/privatech… status=Locked 查看刚刚创建的两个账户： 1 2 &gt; eth.accounts [&quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot;] 二、查看账户余额 1 2 3 4 &gt; eth.getBalance(eth.accounts[0]) 0 &gt; eth.getBalance(eth.accounts[1]) 0 三、启动&amp;停止挖矿 启动挖矿： 1 &gt; miner.start(1) 其中 start 的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的 DAG 文件，这个过程有点慢，等进度达到 100% 后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。 停止挖矿，在 console 中输入： 1 &gt; miner.stop() 挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做 coinbase，默认情况下 coinbase 是本地账户中的第一个账户，可以通过 miner.setEtherbase() 将其他账户设置成 coinbase。 四、发送交易 目前，账户 0 已经挖到了 3 个块的奖励，账户 1 的余额还是0： 1 2 3 4 &gt; eth.getBalance(eth.accounts[0]) 15000000000000000000 &gt; eth.getBalance(eth.accounts[1]) 0 我们要从账户 0 向账户 1 转账，所以要先解锁账户 0，才能发起交易： 1 2 3 4 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802 Passphrase: true 发送交易，账户 0 -&gt; 账户 1： 1 2 3 4 5 &gt; amount = web3.toWei(5,&#39;ether&#39;) &quot;5000000000000000000&quot; &gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount}) INFO [03-16|01:32:36] Submitted transaction fullhash=0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce recipient=0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62 &quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot; 此时如果没有挖矿，用&nbsp;txpool.status&nbsp;命令可以看到本地交易池中有一个待确认的交易，可以使用&nbsp;eth.getBlock(&quot;pending&quot;, true).transactions&nbsp;查看当前待确认交易。 使用&nbsp;miner.start()&nbsp;命令开始挖矿： 1 &gt; miner.start(1);admin.sleepBlocks(1);miner.stop(); 新区块挖出后，挖矿结束，查看账户 1 的余额，已经收到了账户 0 的以太币： 1 2 &gt; web3.fromWei(eth.getBalance(eth.accounts[1]),&#39;ether&#39;) 5 五、查看交易和区块 查看当前区块总数： 1 2 &gt; eth.blockNumber 4 通过交易 Hash 查看交易（Hash 值包含在上面交易返回值中）： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 &gt; eth.getTransaction(&quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;) { blockHash: &quot;0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d&quot;, blockNumber: 4, from: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, gas: 90000, gasPrice: 18000000000, hash: &quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;, input: &quot;0x&quot;, nonce: 0, r: &quot;0x4214d2d8d92efc3aafb515d2413ecd45ab3695d9bcc30d9c7c06932de829e064&quot;, s: &quot;0x42822033225a2ef662b9b448576e0271b9958e1f4ec912c259e01c84bd1f6681&quot;, to: &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot;, transactionIndex: 0, v: &quot;0x824&quot;, value: 5000000000000000000 } 通过区块号查看区块： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 &gt; eth.getBlock(4) { difficulty: 131072, extraData: &quot;0xd783010607846765746887676f312e382e31856c696e7578&quot;, gasLimit: 3153874, gasUsed: 21000, hash: &quot;0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, mixHash: &quot;0x6df88079cf4fbfae98ad7588926fa30becddf4b8b55f93f0380d82ce0533338c&quot;, nonce: &quot;0x39455ee908666993&quot;, number: 4, parentHash: &quot;0x14fe27755d6fcc704f6b7018d5dc8193f702d89f2c7807bf6f0e402a2b0a29d9&quot;, receiptsRoot: &quot;0xfcb5b5cc322998562d96339418d08ad8e7c5dd87935f9a3321e040344e3fd095&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 651, stateRoot: &quot;0xdd4a0ce76c7e0ff149853dce5bb4f99592fb1bc3c5e87eb07518a0235ffacd8c&quot;, timestamp: 1505202063, totalDifficulty: 525312, transactions: [&quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;], transactionsRoot: &quot;0xbb909845183e037b15d24fe9ad1805fd00350ae04841aa774be6af96e76fdbf9&quot;, uncles: [] } 六、连接到其他节点 可以通过&nbsp;admin.addPeer()&nbsp;方法连接到其他节点，两个节点要要指定相同的 chainID。 假设有两个节点：节点一和节点二，chainID 都是 1024，通过下面的步骤就可以从节点一连接到节点二。 首先要知道节点二的 enode 信息，在节点二的 JavaScript console 中执行下面的命令查看 enode 信息： 1 2 &gt; admin.nodeInfo.enode &quot;enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@[::]:30303&quot; 然后在节点一的 JavaScript console 中执行 admin.addPeer()，就可以连接到节点二： 1 &gt; admin.addPeer(&quot;enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@127.0.0.1:30304&quot;) addPeer() 的参数就是节点二的 enode 信息，注意要把 enode 中的&nbsp;[::]&nbsp;替换成节点二的 IP 地址。连接成功后，节点二就会开始同步节点一的区块，同步完成后，任意一个节点开始挖矿，另一个节点会自动同步区块，向任意一个节点发送交易，另一个节点也会收到该笔交易。 通过&nbsp;admin.peers&nbsp;可以查看连接到的其他节点信息，通过&nbsp;net.peerCount&nbsp;可以查看已连接到的节点数量。 除了上面的方法，也可以在启动节点的时候指定&nbsp;--bootnodes&nbsp;选项连接到其他节点。 智能合约操作 一、创建和编译智能合约 新建一个 Solidity 智能合约文件，命名为&nbsp;testContract.sol，该合约包含一个方法&nbsp;multiply()，将输入的两个数相乘后输出： 1 2 3 4 5 6 7 8 pragma solidity ^0.4.0; contract TestContract { function multiply(uint a, uint b) returns (uint) { return a * b; } } 编译智能合约，获得编译后的 EVM 二进制码： 1 2 3 4 5 $ solc --bin testContract.sol ======= testContract.sol:TestContract ======= Binary: 6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029 再用 solc 获取智能合约的 JSON ABI（Application Binary Interface），其中指定了合约接口，包括可调用的合约方法、变量、事件等： 1 2 3 4 5 $ solc --abi testContract.sol ======= testContract.sol:TestContract ======= Contract JSON ABI [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;a&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;b&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}] 回到 Geth 的控制台，用变量&nbsp;code&nbsp;和&nbsp;abi&nbsp;记录上面两个值，注意在 code 前加上&nbsp;0x&nbsp;前缀： 1 2 &gt; code = &quot;0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029&quot; &gt; abi = [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;a&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;b&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}] 二、部署智能合约 这里使用账户 0 来部署合约，首先解锁账户： 1 2 3 4 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802 Passphrase: true 发送部署合约的交易： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 &gt; myContract = eth.contract(abi) ... &gt; contract = myContract.new({from:eth.accounts[0],data:code,gas:1000000}) INFO [09-12|08:05:19] Submitted contract creation fullhash=0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1 contract=0x7cbe4019e993f9922b8233502d94890099ee59e6 { abi: [{ constant: false, inputs: [{...}, {...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, stateMutability: &quot;nonpayable&quot;, type: &quot;function&quot; }], address: undefined, transactionHash: &quot;0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1&quot; } 此时如果没有挖矿，用&nbsp;txpool.status&nbsp;命令可以看到本地交易池中有一个待确认的交易。使用下面的命令查看当前待确认的交易： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [{ blockHash: &quot;0xfedd6fef9f25e96a5a20b5ffcd152e9fe05d193ae0989c25d6197d2441c2c09b&quot;, blockNumber: 5, from: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, gas: 1000000, gasPrice: 18000000000, hash: &quot;0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1&quot;, input: &quot;0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029&quot;, nonce: 3, r: &quot;0xfe7139a31694a36f946e7182c35c52a21bf31d33994490815f63f6674e84dc93&quot;, s: &quot;0x4701a984ee93d2a323fac55547b31534b11915599de75202a1d62061241fefbf&quot;, to: null, transactionIndex: 0, v: &quot;0x823&quot;, value: 0 }] 使用&nbsp;miner.start()&nbsp;命令开始挖矿，一段时间后交易会被确认，随新区块进入区块链。 三、调用智能合约 使用以下命令发送交易，sendTransaction&nbsp;方法的前几个参数应该与合约中&nbsp;multiply&nbsp;方法的输入参数对应。这种情况下，交易会通过挖矿记录到区块链中： 1 2 3 4 &gt; contract.multiply.sendTransaction(2, 4, {from:eth.accounts[0]}) INFO [03-16|02:54:16] Submitted transaction fullhash=0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2 recipient=0x7cbe4019e993f9922b8233502d94890099ee59e6 &quot;0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2&quot; 如果只是本地运行该方法查看返回结果，可以采用如下方式： 1 2 &gt; contract.multiply.call(2，4) 8 术语说明 术语 &nbsp; 说明 ABI Application Binary Interface，应用二进制接口 其中指定了合约接口，包括可调用的合约方法、变量、事件等。 DApp Decentralized App，去中心化的应用程序 基于智能合约的应用称为去中心化的应用程序。 EVM Ethereum Virtual Machine，以太坊虚拟机 以太坊智能合约的运行环境。 Gas （消耗的）汽油 在以太坊上发起交易、部署合约和调用合约都要消耗一定量的以太币，这些消耗的以太币称为 Gas。 Geth - 以太坊客户端 go-ethereum，使用 Go 语言编写，是最常用的以太坊客户端之一。 Solidity - 以太坊智能合约的一种编程语言，类似 JavaScript。 Remix IDE https://remix.ethereum.org 基于浏览器的 Solidity 集成开发环境，在浏览器中编写和调试智能合约。 参考内容 《区块链——原理、设计与应用》杨保华、陈昌编著，机械工业出版 以太坊学习笔记：私有链搭建操作指南&nbsp;https://my.oschina.net/u/2349981/blog/865256 利用puppeth搭建POA共识的以太坊私链网络&nbsp;https://github.com/xiaoping378/blog/blob/master/posts/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA%E5%88%9D%E6%AD%A5%E5%AE%9E%E8%B7%B5.md 区块链技术指南&nbsp;https://yeasy.gitbooks.io/blockchain_guide/ethereum/install.html Solidity 官方文档&nbsp;http://solidity.readthedocs.io/en/latest/installing-solidity.html Go 官方文档&nbsp;https://golang.org/doc/install 更多区块链资料，请访问&nbsp;https://github.com/gymgle/blockchain-reference 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/03/16/421a14756e73436d5fbb35877a4505df.html" />
<meta property="og:url" content="https://mlh.app/2018/03/16/421a14756e73436d5fbb35877a4505df.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-16T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"&nbsp;&nbsp;&nbsp;&nbsp;“区块链”这个词近几个月的社会出现频率越来越高，虽然很多人是冲着币圈去的，但是还是有很多技术宅是真正在研究区块链技术的。 &nbsp;&nbsp;&nbsp;&nbsp;今天老林就来给大家唠唠怎么搭建以太坊的私有链，小白入门级别的，大神请略过。 说明 一、为什么用到私有链？ 在以太坊的共有链上部署智能合约、发起交易需要花费以太币。而通过修改配置，可以在本机搭建一套以太坊私有链，因为与公有链没关系，既不用同步公有链庞大的数据，也不用花钱购买以太币，很好地满足了智能合约开发和测试的要求，开发好的智能合约也可以很容易地切换接口部署到以太坊公有链上。 二、需要用到哪些工具？ 以太坊客户端以太坊客户端用于接入以太坊网络，进行账户管理、交易、挖矿、智能合约相关的操作。目前有多种语言实现的客户端，常用的有 Go 语言实现的 go-ethereum 客户端 Geth，支持接入以太坊网络并成为一个完整节点，也可作为一个 HTTP-RPC 服务器对外提供 JSON-RPC 接口。其他的客户端有： Parity：Rust 语言实现； cpp-ethereum：C++ 语言实现； ethereumjs-lib：JavaScript 语言实现； Ethereum(J)：Java 语言实现； ethereumH：Haskell 语言实现； pyethapp： Python 语言实现； ruby-ethereum：Ruby 语言实现； 智能合约编译器以太坊支持两种智能合约的编程语言：Solidity 和 Serpent。Serpent 语言面临一些安全问题，现在已经不推荐使用了。Solidity 语法类似 JavaScript，它编译器 solc 可以把智能合约源码编译成以太坊虚拟机 EVM 可以执行的二进制码。现在以太坊提供更方便的在线 IDE —— Remix&nbsp;https://remix.ethereum.org&nbsp;使用 Remix，免去了安装 solc 和编译过程，它可以直接提供部署合约所需的二进制码和 ABI。 以太坊钱包以太坊提供了图形界面的钱包 Ethereum Wallet 和 Mist Dapp 浏览器。钱包的功能是 Mist 的一个子集，可用于管理账户和交易；Mist 在钱包基础上，还能操作智能合约。为了演示合约部署过程，本文使用了 Geth console 操作，没有用到 Mist，当然，使用 Mist 会更简单。 安装环境 这里以 Ubuntu 16.04 为例进行介绍。 一、安装以太坊客户端 两种方式可选：PPA 直接安装、源码编译安装。 PPA 直接安装安装必要的工具包： 1 apt install software-properties-common 添加以太坊源： 1 2 add-apt-repository -y ppa:ethereum/ethereum apt update 安装 go-ethereum： 1 apt install ethereum 安装完成后，可以使用&nbsp;geth version&nbsp;命令查看是否安装成功。 源码安装因为 go-ethereum 使用 Go 语言编写，编译源码前需要配置好 Go 环境。配置 Go 语言环境参照&nbsp;https://golang.org/doc/install简单地，以安装 go 1.9 为例： 1 2 wget https://storage.googleapis.com/golang/go1.9.linux-amd64.tar.gz tar -C /usr/local -xzf go1.9.linux-amd64.tar.gz 编辑&nbsp;/etc/profile&nbsp;或&nbsp;$HOME/.profile，在文件最后添加环境变量： 1 export PATH=$PATH:/usr/local/go/bin 编辑&nbsp;$HOME/profile&nbsp;或&nbsp;$HOME/.bashrc，添加 go 工作目录环境变量： 1 export GOPATH=$HOME/gopath 下载和编译 Geth安装 C 编译器： 1 apt install -y build-essential 下载最新源码： 1 git clone https://github.com/ethereum/go-ethereum 编译安装： 1 2 cd go-ethereum make geth 安装完成后，可以使用&nbsp;geth version&nbsp;命令查看是否安装成功。记得把生成的 geth 加入到系统的环境变量中。 我在这里用的是第一种方式，最后使用geth version 得到的结果是：root@daniel-Aspire-E5-572G:/home/daniel# geth version Geth Version: 1.8.2-stable Git Commit: b8b9f7f4476a30a0aaf6077daade6ae77f969960 Architecture: amd64 Protocol Versions: [63 62] Network Id: 1 Go Version: go1.9.4 Operating System: linux GOPATH= GOROOT=/usr/lib/go-1.9 二、安装 Solidity 编译器 Solidity 编译器也有多种方法安装，参照&nbsp;http://solidity.readthedocs.io/en/latest/installing-solidity.html&nbsp;这里介绍最简单快捷的安装方式：PPA 直接安装。 PPA 直接安装 1 2 3 add-apt-repository ppa:ethereum/ethereum apt update apt install solc 官方推荐使用基于浏览器的 IDE 环境：Remix&nbsp;https://remix.ethereum.org 私有链搭建 一、配置初始状态 要运行以太坊私有链，需要定义自己的创世区块，创世区块信息写在一个 JSON 格式的配置文件中。首先将下面的内容保存到一个 JSON 文件中，例如&nbsp;genesis.json。 { &quot;config&quot;: { &quot;chainID&quot;: 1909, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;alloc&quot;: {}, &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000001&quot;, &quot;difficulty&quot;: &quot;0x400&quot;, &quot;extraData&quot;: &quot;0x888&quot;, &quot;gasLimit&quot;: &quot;0xffffffff&quot;, &quot;nonce&quot;: &quot;0x1909201819092018&quot;, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;timestamp&quot;: &quot;0x00&quot; } chainID:指定了独立的区块链网络 ID。网络 ID 在连接到其他节点的时候会用到，以太坊公网的网络 ID 是 1，为了不与公有链网络冲突，运行私有链节点的时候要指定自己的网络 ID。不同 ID 网络的节点无法相互连接。 alloc: 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以，默认为空即可。 coinbase: 矿工的账号，随便填即可。 difficulty: 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度。 extraData: 附加信息。这里要注意一下，新版本该值需要为16进制数据，以0x 开头。 gasLimit: 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们要做的是私有链，所以此处填最大。 nonce: nonce就是一个64位随机数(0x后一位为4个二进制位，故有16位），用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 mixhash：与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。 parentHash: 上一个区块的hash值，因为是创世块，所以这个值是0。 timestamp: 设置创世块的时间戳。 在 Geth 1.6+ 中，以太坊提供了一个生成创世块的向导工具：puppeth。并且提供了更适合在私有链中使用的 Clique POA 共识算法。puppeth 的使用，可以参照《利用puppeth搭建POA共识的以太坊私链网络》。 二、初始化：写入创世区块 准备好创世区块配置文件后，需要初始化区块链，将上面的创世区块信息写入到区块链中。首先要新建一个目录用来存放区块链数据，假设新建的数据目录为&nbsp;~/315私有链/data0，genesis.json&nbsp;保存在&nbsp;~/315私有链&nbsp;中，此时目录结构应该是这样的： 1 2 3 315私有链 ├── data0 └── genesis.json 接下来进入 “315私有链” 中，执行初始化命令： 1 2 cd 315私有链 geth --datadir data0 init genesis.json 上面的命令的主体是&nbsp;geth init，表示初始化区块链，命令可以带有选项和参数，其中&nbsp;--datadir&nbsp;选项后面跟一个目录名，这里为 data0，表示指定数据存放目录为 data0，genesis.json 是&nbsp;init&nbsp;命令的参数。 运行上面的命令，会读取&nbsp;genesis.json&nbsp;文件，根据其中的内容，将创世区块写入到区块链中。如果看到以下的输出内容，说明初始化成功了。 INFO [03-15|21:09:45] Maximum peer count ETH=25 LES=0 total=25 INFO [03-15|21:09:45] Allocated cache and file handles database=/home/daniel/315私有链/data0/geth/chaindata cache=16 handles=16 INFO [03-15|21:09:45] Writing custom genesis block INFO [03-15|21:09:45] Persisted trie from memory database nodes=0 size=0.00B time=3.869µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B INFO [03-15|21:09:45] Successfully wrote genesis state database=chaindata hash=51a849…59f068 INFO [03-15|21:09:45] Allocated cache and file handles database=/home/daniel/315私有链/data0/geth/lightchaindata cache=16 handles=16 INFO [03-15|21:09:45] Writing custom genesis block INFO [03-15|21:09:45] Persisted trie from memory database nodes=0 size=0.00B time=7.307µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B INFO [03-15|21:09:45] Successfully wrote genesis state database=lightchaindata hash=51a849…59f068 初始化成功后，会在数据目录 data0 中生成&nbsp; geth &nbsp;和&nbsp; keystore &nbsp;两个文件夹，此时目录结构如下： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 315私有链 ├── data0 │&nbsp;&nbsp; ├── geth │&nbsp;&nbsp; │&nbsp;&nbsp; ├── chaindata │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000 │&nbsp;&nbsp; │&nbsp;&nbsp; └── lightchaindata │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000 │&nbsp;&nbsp; └── keystore └── genesis.json 其中&nbsp;geth/chaindata&nbsp;中存放的是区块数据，keystore&nbsp;中存放的是账户数据。 三、启动私有链节点 初始化完成后，就有了一条自己的私有链，之后就可以启动自己的私有链节点并做一些操作，在终端中输入以下命令即可启动节点： 1 geth --identity &quot;SCAU&quot; --rpc --rpcport &quot;8545&quot; --datadir data0 --port &quot;30303&quot; -- rpcapi &quot;db,eth,net,web3&quot;--networkid 65534--nodiscover console 上面命令的主体是&nbsp;geth console，表示启动节点并进入交互式控制台。各选项含义如下： –identity：指定节点，用于标示目前网络的名字； –rpc：表示开启 HTTP-RPC 服务； –rpcport：指定 HTTP-RPC 服务监听端口号（默认为 8545）； –datadir：指定区块链数据的存储位置； –port：指定和其他节点连接所用的端口号（默认为 30303）； –rpcapi： 设置允许连接的rpc的客户端，一般为db,eth,net,web3； –networkid： 设置当前区块链的网络ID，用于区分不同的网络，是一个数字； –nodiscover：关闭节点发现机制，防止加入有同样初始配置的陌生节点； –maxpeers : 如果你不希望其他人连接到你的测试链，可以使用maxpeers 0。反之，如果你确切知道希望多少人连接到你的节点，你也可以通过调整数字来实现； –rpccorsdomain : 这个可以指示什么URL能连接到你的节点来执行RPC定制端任务。务必谨慎，输入一个特定的URL而不是wildcard ( * )，后者会使所有的URL都能连接到你的RPC实例； –console：启动命令行模式，可以在Geth中执行命令。 注意： 1.上面蓝色字体的参数为非必须的，必要时才写入； 2.如果想将Ubuntu作为永久区块链节点使用，当使用nohup命令时，Geth启动参数console必须去掉，否则Geth会自动停止。 运行上面的命令后，就启动了区块链节点并进入了该节点的控制台： 1 2 3 4 5 ... Welcome to the Geth JavaScript console! instance: Geth/TestNode/v1.6.7-stable-ab5646c5/linux-amd64/go1.8.1 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0 这是一个交互式的 JavaScript 执行环境，在这里面可以执行 JavaScript 代码，其中&nbsp;&gt;&nbsp;是命令提示符。在这个环境里也内置了一些用来操作以太坊的 JavaScript 对象，可以直接使用这些对象。这些对象主要包括： eth：包含一些跟操作区块链相关的方法； net：包含一些查看p2p网络状态的方法； admin：包含一些与管理节点相关的方法； miner：包含启动&amp;停止挖矿的一些方法； personal：主要包含一些管理账户的方法； txpool：包含一些查看交易内存池的方法； web3：包含了以上对象，还包含一些单位换算的方法。 控制台操作 进入以太坊 Javascript Console 后，就可以使用里面的内置对象做一些操作，这些内置对象提供的功能很丰富，比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。 常用命令有： personal.newAccount()：创建账户； personal.unlockAccount()：解锁账户； eth.accounts：枚举系统中的账户； eth.getBalance()：查看账户余额，返回值的单位是 Wei（Wei 是以太坊中最小货币面额单位，类似比特币中的聪，1 ether = 10^18 Wei）； eth.blockNumber：列出区块总数； eth.getTransaction()：获取交易； eth.getBlock()：获取区块； miner.start()：开始挖矿； miner.stop()：停止挖矿； web3.fromWei()：Wei 换算成以太币； web3.toWei()：以太币换算成 Wei； txpool.status：交易池中的状态； admin.addPeer()：连接到其他节点； 这些命令支持&nbsp;Tab&nbsp;键自动补全，具体用法如下。 一、创建账户 1 2 3 4 5 &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot; &gt; INFO [03-16|00:55:44] New wallet appeared url=keystore:///root/work/privatech… status=Locked 输入两遍密码后，会生成账户地址。 再创建一个账户： 1 2 3 4 5 &gt; personal.newAccount() Passphrase: Repeat passphrase: &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot; &gt; INFO [03-16|01:10:45] New wallet appeared url=keystore:///root/work/privatech… status=Locked 查看刚刚创建的两个账户： 1 2 &gt; eth.accounts [&quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot;] 二、查看账户余额 1 2 3 4 &gt; eth.getBalance(eth.accounts[0]) 0 &gt; eth.getBalance(eth.accounts[1]) 0 三、启动&amp;停止挖矿 启动挖矿： 1 &gt; miner.start(1) 其中 start 的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的 DAG 文件，这个过程有点慢，等进度达到 100% 后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。 停止挖矿，在 console 中输入： 1 &gt; miner.stop() 挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做 coinbase，默认情况下 coinbase 是本地账户中的第一个账户，可以通过 miner.setEtherbase() 将其他账户设置成 coinbase。 四、发送交易 目前，账户 0 已经挖到了 3 个块的奖励，账户 1 的余额还是0： 1 2 3 4 &gt; eth.getBalance(eth.accounts[0]) 15000000000000000000 &gt; eth.getBalance(eth.accounts[1]) 0 我们要从账户 0 向账户 1 转账，所以要先解锁账户 0，才能发起交易： 1 2 3 4 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802 Passphrase: true 发送交易，账户 0 -&gt; 账户 1： 1 2 3 4 5 &gt; amount = web3.toWei(5,&#39;ether&#39;) &quot;5000000000000000000&quot; &gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount}) INFO [03-16|01:32:36] Submitted transaction fullhash=0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce recipient=0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62 &quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot; 此时如果没有挖矿，用&nbsp;txpool.status&nbsp;命令可以看到本地交易池中有一个待确认的交易，可以使用&nbsp;eth.getBlock(&quot;pending&quot;, true).transactions&nbsp;查看当前待确认交易。 使用&nbsp;miner.start()&nbsp;命令开始挖矿： 1 &gt; miner.start(1);admin.sleepBlocks(1);miner.stop(); 新区块挖出后，挖矿结束，查看账户 1 的余额，已经收到了账户 0 的以太币： 1 2 &gt; web3.fromWei(eth.getBalance(eth.accounts[1]),&#39;ether&#39;) 5 五、查看交易和区块 查看当前区块总数： 1 2 &gt; eth.blockNumber 4 通过交易 Hash 查看交易（Hash 值包含在上面交易返回值中）： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 &gt; eth.getTransaction(&quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;) { blockHash: &quot;0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d&quot;, blockNumber: 4, from: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, gas: 90000, gasPrice: 18000000000, hash: &quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;, input: &quot;0x&quot;, nonce: 0, r: &quot;0x4214d2d8d92efc3aafb515d2413ecd45ab3695d9bcc30d9c7c06932de829e064&quot;, s: &quot;0x42822033225a2ef662b9b448576e0271b9958e1f4ec912c259e01c84bd1f6681&quot;, to: &quot;0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62&quot;, transactionIndex: 0, v: &quot;0x824&quot;, value: 5000000000000000000 } 通过区块号查看区块： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 &gt; eth.getBlock(4) { difficulty: 131072, extraData: &quot;0xd783010607846765746887676f312e382e31856c696e7578&quot;, gasLimit: 3153874, gasUsed: 21000, hash: &quot;0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d&quot;, logsBloom: &quot;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;, miner: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, mixHash: &quot;0x6df88079cf4fbfae98ad7588926fa30becddf4b8b55f93f0380d82ce0533338c&quot;, nonce: &quot;0x39455ee908666993&quot;, number: 4, parentHash: &quot;0x14fe27755d6fcc704f6b7018d5dc8193f702d89f2c7807bf6f0e402a2b0a29d9&quot;, receiptsRoot: &quot;0xfcb5b5cc322998562d96339418d08ad8e7c5dd87935f9a3321e040344e3fd095&quot;, sha3Uncles: &quot;0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347&quot;, size: 651, stateRoot: &quot;0xdd4a0ce76c7e0ff149853dce5bb4f99592fb1bc3c5e87eb07518a0235ffacd8c&quot;, timestamp: 1505202063, totalDifficulty: 525312, transactions: [&quot;0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce&quot;], transactionsRoot: &quot;0xbb909845183e037b15d24fe9ad1805fd00350ae04841aa774be6af96e76fdbf9&quot;, uncles: [] } 六、连接到其他节点 可以通过&nbsp;admin.addPeer()&nbsp;方法连接到其他节点，两个节点要要指定相同的 chainID。 假设有两个节点：节点一和节点二，chainID 都是 1024，通过下面的步骤就可以从节点一连接到节点二。 首先要知道节点二的 enode 信息，在节点二的 JavaScript console 中执行下面的命令查看 enode 信息： 1 2 &gt; admin.nodeInfo.enode &quot;enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@[::]:30303&quot; 然后在节点一的 JavaScript console 中执行 admin.addPeer()，就可以连接到节点二： 1 &gt; admin.addPeer(&quot;enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@127.0.0.1:30304&quot;) addPeer() 的参数就是节点二的 enode 信息，注意要把 enode 中的&nbsp;[::]&nbsp;替换成节点二的 IP 地址。连接成功后，节点二就会开始同步节点一的区块，同步完成后，任意一个节点开始挖矿，另一个节点会自动同步区块，向任意一个节点发送交易，另一个节点也会收到该笔交易。 通过&nbsp;admin.peers&nbsp;可以查看连接到的其他节点信息，通过&nbsp;net.peerCount&nbsp;可以查看已连接到的节点数量。 除了上面的方法，也可以在启动节点的时候指定&nbsp;--bootnodes&nbsp;选项连接到其他节点。 智能合约操作 一、创建和编译智能合约 新建一个 Solidity 智能合约文件，命名为&nbsp;testContract.sol，该合约包含一个方法&nbsp;multiply()，将输入的两个数相乘后输出： 1 2 3 4 5 6 7 8 pragma solidity ^0.4.0; contract TestContract { function multiply(uint a, uint b) returns (uint) { return a * b; } } 编译智能合约，获得编译后的 EVM 二进制码： 1 2 3 4 5 $ solc --bin testContract.sol ======= testContract.sol:TestContract ======= Binary: 6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029 再用 solc 获取智能合约的 JSON ABI（Application Binary Interface），其中指定了合约接口，包括可调用的合约方法、变量、事件等： 1 2 3 4 5 $ solc --abi testContract.sol ======= testContract.sol:TestContract ======= Contract JSON ABI [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;a&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;b&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}] 回到 Geth 的控制台，用变量&nbsp;code&nbsp;和&nbsp;abi&nbsp;记录上面两个值，注意在 code 前加上&nbsp;0x&nbsp;前缀： 1 2 &gt; code = &quot;0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029&quot; &gt; abi = [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;a&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;b&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;}] 二、部署智能合约 这里使用账户 0 来部署合约，首先解锁账户： 1 2 3 4 &gt; personal.unlockAccount(eth.accounts[0]) Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802 Passphrase: true 发送部署合约的交易： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 &gt; myContract = eth.contract(abi) ... &gt; contract = myContract.new({from:eth.accounts[0],data:code,gas:1000000}) INFO [09-12|08:05:19] Submitted contract creation fullhash=0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1 contract=0x7cbe4019e993f9922b8233502d94890099ee59e6 { abi: [{ constant: false, inputs: [{...}, {...}], name: &quot;multiply&quot;, outputs: [{...}], payable: false, stateMutability: &quot;nonpayable&quot;, type: &quot;function&quot; }], address: undefined, transactionHash: &quot;0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1&quot; } 此时如果没有挖矿，用&nbsp;txpool.status&nbsp;命令可以看到本地交易池中有一个待确认的交易。使用下面的命令查看当前待确认的交易： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [{ blockHash: &quot;0xfedd6fef9f25e96a5a20b5ffcd152e9fe05d193ae0989c25d6197d2441c2c09b&quot;, blockNumber: 5, from: &quot;0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802&quot;, gas: 1000000, gasPrice: 18000000000, hash: &quot;0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1&quot;, input: &quot;0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029&quot;, nonce: 3, r: &quot;0xfe7139a31694a36f946e7182c35c52a21bf31d33994490815f63f6674e84dc93&quot;, s: &quot;0x4701a984ee93d2a323fac55547b31534b11915599de75202a1d62061241fefbf&quot;, to: null, transactionIndex: 0, v: &quot;0x823&quot;, value: 0 }] 使用&nbsp;miner.start()&nbsp;命令开始挖矿，一段时间后交易会被确认，随新区块进入区块链。 三、调用智能合约 使用以下命令发送交易，sendTransaction&nbsp;方法的前几个参数应该与合约中&nbsp;multiply&nbsp;方法的输入参数对应。这种情况下，交易会通过挖矿记录到区块链中： 1 2 3 4 &gt; contract.multiply.sendTransaction(2, 4, {from:eth.accounts[0]}) INFO [03-16|02:54:16] Submitted transaction fullhash=0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2 recipient=0x7cbe4019e993f9922b8233502d94890099ee59e6 &quot;0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2&quot; 如果只是本地运行该方法查看返回结果，可以采用如下方式： 1 2 &gt; contract.multiply.call(2，4) 8 术语说明 术语 &nbsp; 说明 ABI Application Binary Interface，应用二进制接口 其中指定了合约接口，包括可调用的合约方法、变量、事件等。 DApp Decentralized App，去中心化的应用程序 基于智能合约的应用称为去中心化的应用程序。 EVM Ethereum Virtual Machine，以太坊虚拟机 以太坊智能合约的运行环境。 Gas （消耗的）汽油 在以太坊上发起交易、部署合约和调用合约都要消耗一定量的以太币，这些消耗的以太币称为 Gas。 Geth - 以太坊客户端 go-ethereum，使用 Go 语言编写，是最常用的以太坊客户端之一。 Solidity - 以太坊智能合约的一种编程语言，类似 JavaScript。 Remix IDE https://remix.ethereum.org 基于浏览器的 Solidity 集成开发环境，在浏览器中编写和调试智能合约。 参考内容 《区块链——原理、设计与应用》杨保华、陈昌编著，机械工业出版 以太坊学习笔记：私有链搭建操作指南&nbsp;https://my.oschina.net/u/2349981/blog/865256 利用puppeth搭建POA共识的以太坊私链网络&nbsp;https://github.com/xiaoping378/blog/blob/master/posts/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA%E5%88%9D%E6%AD%A5%E5%AE%9E%E8%B7%B5.md 区块链技术指南&nbsp;https://yeasy.gitbooks.io/blockchain_guide/ethereum/install.html Solidity 官方文档&nbsp;http://solidity.readthedocs.io/en/latest/installing-solidity.html Go 官方文档&nbsp;https://golang.org/doc/install 更多区块链资料，请访问&nbsp;https://github.com/gymgle/blockchain-reference 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/03/16/421a14756e73436d5fbb35877a4505df.html","headline":"如何搭建以太坊私链——小白入门","dateModified":"2018-03-16T00:00:00+08:00","datePublished":"2018-03-16T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/03/16/421a14756e73436d5fbb35877a4505df.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>如何搭建以太坊私链——小白入门</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>&nbsp;&nbsp;&nbsp;&nbsp;“区块链”这个词近几个月的社会出现频率越来越高，虽然很多人是冲着币圈去的，但是还是有很多技术宅是真正在研究区块链技术的。</p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;今天老林就来给大家唠唠怎么搭建以太坊的私有链，小白入门级别的，大神请略过。</p>
  <p></p>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);">说明</h2>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%80%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8%E5%88%B0%E7%A7%81%E6%9C%89%E9%93%BE%EF%BC%9F" rel="nofollow" class="headerlink" title="一、为什么用到私有链？" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>一、为什么用到私有链？</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">在以太坊的共有链上部署智能合约、发起交易需要花费以太币。而通过修改配置，可以在本机搭建一套以太坊私有链，因为与公有链没关系，既不用同步公有链庞大的数据，也不用花钱购买以太币，很好地满足了智能合约开发和测试的要求，开发好的智能合约也可以很容易地切换接口部署到以太坊公有链上。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%BA%8C%E3%80%81%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E5%93%AA%E4%BA%9B%E5%B7%A5%E5%85%B7%EF%BC%9F" rel="nofollow" class="headerlink" title="二、需要用到哪些工具？" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>二、需要用到哪些工具？</h3>
  <ol style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li>以太坊客户端<br>以太坊客户端用于接入以太坊网络，进行账户管理、交易、挖矿、智能合约相关的操作。目前有多种语言实现的客户端，常用的有 Go 语言实现的 go-ethereum 客户端 Geth，支持接入以太坊网络并成为一个完整节点，也可作为一个 HTTP-RPC 服务器对外提供 JSON-RPC 接口。<br>其他的客户端有：
    <ul style="list-style:none;">
     <li style="list-style:circle;">Parity：Rust 语言实现；</li>
     <li style="list-style:circle;">cpp-ethereum：C++ 语言实现；</li>
     <li style="list-style:circle;">ethereumjs-lib：JavaScript 语言实现；</li>
     <li style="list-style:circle;">Ethereum(J)：Java 语言实现；</li>
     <li style="list-style:circle;">ethereumH：Haskell 语言实现；</li>
     <li style="list-style:circle;">pyethapp： Python 语言实现；</li>
     <li style="list-style:circle;">ruby-ethereum：Ruby 语言实现；</li>
    </ul></li>
   <li>智能合约编译器<br>以太坊支持两种智能合约的编程语言：Solidity 和 Serpent。Serpent 语言面临一些安全问题，现在已经不推荐使用了。Solidity 语法类似 JavaScript，它编译器 solc 可以把智能合约源码编译成以太坊虚拟机 EVM 可以执行的二进制码。<br>现在以太坊提供更方便的在线 IDE —— Remix&nbsp;<a href="https://remix.ethereum.org/" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://remix.ethereum.org</a>&nbsp;使用 Remix，免去了安装 solc 和编译过程，它可以直接提供部署合约所需的二进制码和 ABI。</li>
   <li>以太坊钱包<br>以太坊提供了图形界面的钱包 Ethereum Wallet 和 Mist Dapp 浏览器。钱包的功能是 Mist 的一个子集，可用于管理账户和交易；Mist 在钱包基础上，还能操作智能合约。为了演示合约部署过程，本文使用了 Geth console 操作，没有用到 Mist，当然，使用 Mist 会更简单。</li>
  </ol>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);">安装环境</h2>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">这里以 Ubuntu 16.04 为例进行介绍。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%80%E3%80%81%E5%AE%89%E8%A3%85%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AE%A2%E6%88%B7%E7%AB%AF" rel="nofollow" class="headerlink" title="一、安装以太坊客户端" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>一、安装以太坊客户端</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">两种方式可选：PPA 直接安装、源码编译安装。</p>
  <ol style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li><p>PPA 直接安装<br>安装必要的工具包：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">apt install software-properties-common</span>
</pre></td>
      </tr>
     </tbody>
    </table><p style="text-align:left;">添加以太坊源：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">add-apt-repository -y ppa:ethereum/ethereum</span>
<span class="line">apt update</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>安装 go-ethereum：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">apt install ethereum</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>安装完成后，可以使用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">geth version</code>&nbsp;命令查看是否安装成功。</p></li>
   <li><p>源码安装<br>因为 go-ethereum 使用 Go 语言编写，编译源码前需要配置好 Go 环境。</p><p><strong>配置 Go 语言环境</strong><br>参照&nbsp;<a href="https://golang.org/doc/install" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://golang.org/doc/install</a><br>简单地，以安装 go 1.9 为例：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">wget https://storage.googleapis.com/golang/go1.9.linux-amd64.tar.gz</span>
<span class="line">tar -C /usr/local -xzf go1.9.linux-amd64.tar.gz</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>编辑&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">/etc/profile</code>&nbsp;或&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">$HOME/.profile</code>，在文件最后添加环境变量：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">export PATH=$PATH:/usr/local/go/bin</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>编辑&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">$HOME/profile</code>&nbsp;或&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">$HOME/.bashrc</code>，添加 go 工作目录环境变量：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">export GOPATH=$HOME/gopath</span>
</pre></td>
      </tr>
     </tbody>
    </table><p><strong>下载和编译 Geth</strong><br>安装 C 编译器：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">apt install -y build-essential</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>下载最新源码：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">git clone https://github.com/ethereum/go-ethereum</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>编译安装：</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">cd go-ethereum</span>
<span class="line">make geth</span>
</pre></td>
      </tr>
     </tbody>
    </table><p>安装完成后，可以使用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">geth version</code>&nbsp;命令查看是否安装成功。记得把生成的 geth 加入到系统的环境变量中。</p></li>
  </ol>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:rgb(85,85,85);background-color:rgb(255,255,255);"><span style="font-size:16px;">我在这里用的是第一种方式，最后使用geth version 得到的结果是：</span></h3>root@daniel-Aspire-E5-572G:/home/daniel# geth version
  <br>Geth
  <br>Version: 1.8.2-stable
  <br>Git Commit: b8b9f7f4476a30a0aaf6077daade6ae77f969960
  <br>Architecture: amd64
  <br>Protocol Versions: [63 62]
  <br>Network Id: 1
  <br>Go Version: go1.9.4
  <br>Operating System: linux
  <br>GOPATH=
  <br>GOROOT=/usr/lib/go-1.9
  <p></p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85-Solidity-%E7%BC%96%E8%AF%91%E5%99%A8" rel="nofollow" class="headerlink" title="二、安装 Solidity 编译器" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>二、安装 Solidity 编译器</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">Solidity 编译器也有多种方法安装，参照&nbsp;<span style="border-bottom:1px solid rgb(204,204,204);"></span><a href="http://solidity.readthedocs.io/en/latest/installing-solidity.html" rel="nofollow"><span style="border-bottom:1px solid rgb(204,204,204);">http://solidity.readthedocs.io/en/latest/installing-solidity.html</span>&nbsp;</a>这里介绍最简单快捷的安装方式：PPA 直接安装。</p>
  <ol style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li><p>PPA 直接安装</p>
    <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
     <tbody>
      <tr style="background-color:rgb(249,249,249);">
       <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
</pre></td>
       <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">add-apt-repository ppa:ethereum/ethereum</span>
<span class="line">apt update</span>
<span class="line">apt install solc</span>
</pre></td>
      </tr>
     </tbody>
    </table></li>
   <li><p>官方推荐使用基于浏览器的 IDE 环境：Remix&nbsp;<a href="https://remix.ethereum.org" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://remix.ethereum.org</a></p></li>
  </ol>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA" rel="nofollow" class="headerlink" title="私有链搭建" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>私有链搭建</h2>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%80%E3%80%81%E9%85%8D%E7%BD%AE%E5%88%9D%E5%A7%8B%E7%8A%B6%E6%80%81" rel="nofollow" class="headerlink" title="一、配置初始状态" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>一、配置初始状态</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">要运行以太坊私有链，需要定义自己的创世区块，创世区块信息写在一个 JSON 格式的配置文件中。首先将下面的内容保存到一个 JSON 文件中，例如&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">genesis.json</code>。</p>
  <pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;text-align:left;"></pre>
  <pre><code class="language-html">{
  "config": {
    "chainID": 1909,
    "homesteadBlock": 0,
    "eip155Block": 0,
    "eip158Block": 0
  },
  "alloc": {},
  "coinbase": "0x0000000000000000000000000000000000000001",
  "difficulty": "0x400",
  "extraData": "0x888",
  "gasLimit": "0xffffffff",
  "nonce": "0x1909201819092018",
  "mixhash": "0x0000000000000000000000000000000000000000000000000000000000000000",
  "parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
  "timestamp": "0x00"
}</code></pre>
  <br>
  <br>
  <p></p>
  <p></p>
  <ul>
   <li><span style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;color:#4d4d4c;"><span style="font-size:13px;background-color:rgb(247,247,247);">chainID:</span></span><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:#555555;"><span style="background-color:rgb(255,255,255);">指定了独立的区块链网络 ID。网络 ID 在连接到其他节点的时候会用到，以太坊公网的网络 ID 是 1，为了不与公有链网络冲突，运行私有链节点的时候要指定自己的网络 ID。不同 ID 网络的节点无法相互连接。</span></span></li>
   <li><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:#555555;"><span style="background-color:rgb(255,255,255);">alloc: 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以，默认为空即可。<br></span></span></li>
   <li><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:#555555;"><span style="background-color:rgb(255,255,255);">coinbase: 矿工的账号，随便填即可。<br></span></span></li>
   <li><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:#555555;"><span style="background-color:rgb(255,255,255);">difficulty: 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度。<br></span></span></li>
   <li><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:#555555;"><span style="background-color:rgb(255,255,255);">extraData: 附加信息。这里要注意一下，新版本该值需要为16进制数据，以0x 开头。<br></span></span></li>
   <li><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;color:#555555;"><span style="background-color:rgb(255,255,255);">gasLimit: 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们要做的是私有链，所以此处填最大。<br></span></span></li>
   <li style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">nonce: nonce就是一个64位随机数(0x后一位为4个二进制位，故有16位），用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。<br></li>
   <li style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">mixhash：与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。<br></li>
   <li style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">parentHash: 上一个区块的hash值，因为是创世块，所以这个值是0。</li>
   <li style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">timestamp: 设置创世块的时间戳。<br></li>
  </ul>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">在 Geth 1.6+ 中，以太坊提供了一个生成创世块的向导工具：puppeth。并且提供了更适合在私有链中使用的 Clique POA 共识算法。puppeth 的使用，可以参照《<a href="https://github.com/xiaoping378/blog/blob/master/posts/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA%E5%88%9D%E6%AD%A5%E5%AE%9E%E8%B7%B5.md" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">利用puppeth搭建POA共识的以太坊私链网络</a>》。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%BA%8C%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%E5%86%99%E5%85%A5%E5%88%9B%E4%B8%96%E5%8C%BA%E5%9D%97" rel="nofollow" class="headerlink" title="二、初始化：写入创世区块" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>二、初始化：写入创世区块</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">准备好创世区块配置文件后，需要初始化区块链，将上面的创世区块信息写入到区块链中。首先要新建一个目录用来存放区块链数据，假设新建的数据目录为&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">~/315私有链/data0</code>，<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">genesis.json</code>&nbsp;保存在&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">~/315私有链</code>&nbsp;中，此时目录结构应该是这样的：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">315私有链</span>
<span class="line">├── data0</span>
<span class="line">└── genesis.json</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">接下来进入 “315私有链” 中，执行初始化命令：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">cd 315私有链</span>
<span class="line">geth --datadir data0 init genesis.json</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">上面的命令的主体是&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">geth init</code>，表示初始化区块链，命令可以带有选项和参数，其中&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">--datadir</code>&nbsp;选项后面跟一个目录名，这里为 data0，表示指定数据存放目录为 data0，genesis.json 是&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">init</code>&nbsp;命令的参数。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">运行上面的命令，会读取&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">genesis.json</code>&nbsp;文件，根据其中的内容，将创世区块写入到区块链中。如果看到以下的输出内容，说明初始化成功了。</p>
  <pre><code class="language-html">INFO [03-15|21:09:45] Maximum peer count                       ETH=25 LES=0 total=25
INFO [03-15|21:09:45] Allocated cache and file handles         database=/home/daniel/315私有链/data0/geth/chaindata cache=16 handles=16
INFO [03-15|21:09:45] Writing custom genesis block 
INFO [03-15|21:09:45] Persisted trie from memory database      nodes=0 size=0.00B time=3.869µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
INFO [03-15|21:09:45] Successfully wrote genesis state         database=chaindata                                hash=51a849…59f068
INFO [03-15|21:09:45] Allocated cache and file handles         database=/home/daniel/315私有链/data0/geth/lightchaindata cache=16 handles=16
INFO [03-15|21:09:45] Writing custom genesis block 
INFO [03-15|21:09:45] Persisted trie from memory database      nodes=0 size=0.00B time=7.307µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
INFO [03-15|21:09:45] Successfully wrote genesis state         database=lightchaindata                                hash=51a849…59f068
</code></pre>
  <br>
  <span style="background-color:rgb(255,255,255);color:rgb(85,85,85);font-size:16px;">初始化成功后，会在数据目录 data0 中生成&nbsp;</span>
  <code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">geth</code>
  <span style="background-color:rgb(255,255,255);color:rgb(85,85,85);font-size:16px;">&nbsp;和&nbsp;</span>
  <code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">keystore</code>
  <span style="background-color:rgb(255,255,255);color:rgb(85,85,85);font-size:16px;">&nbsp;两个文件夹，此时目录结构如下：</span>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">315私有链</span>
<span class="line">├── data0</span>
<span class="line">│&nbsp;&nbsp; ├── geth</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chaindata</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 000001.log</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── CURRENT</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOCK</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── LOG</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── MANIFEST-000000</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp; └── lightchaindata</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp;     ├── 000001.log</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp;     ├── CURRENT</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp;     ├── LOCK</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp;     ├── LOG</span>
<span class="line">│&nbsp;&nbsp; │&nbsp;&nbsp;     └── MANIFEST-000000</span>
<span class="line">│&nbsp;&nbsp; └── keystore</span>
<span class="line">└── genesis.json</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">其中&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">geth/chaindata</code>&nbsp;中存放的是区块数据，<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">keystore</code>&nbsp;中存放的是账户数据。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%89%E3%80%81%E5%90%AF%E5%8A%A8%E7%A7%81%E6%9C%89%E9%93%BE%E8%8A%82%E7%82%B9" rel="nofollow" class="headerlink" title="三、启动私有链节点" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>三、启动私有链节点</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">初始化完成后，就有了一条自己的私有链，之后就可以启动自己的私有链节点并做一些操作，在终端中输入以下命令即可启动节点：</p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">geth --identity "SCAU" --rpc --rpcport "8545" --datadir data0 --port "30303" -- rpcapi "db,eth,net,web3"--networkid 65534--nodiscover console</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">上面命令的主体是&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">geth console</code>，表示启动节点并进入交互式控制台。<br>各选项含义如下：</p>
  <ul style="list-style:none;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li style="color:rgb(85,85,85);list-style:circle;">–identity：指定节点，用于标示目前网络的名字；</li>
   <li style="color:rgb(85,85,85);list-style:circle;">–rpc：表示开启 HTTP-RPC 服务；</li>
   <li style="color:rgb(85,85,85);list-style:circle;">–rpcport：指定 HTTP-RPC 服务监听端口号（默认为 8545）；</li>
   <li style="color:rgb(85,85,85);list-style:circle;">–datadir：指定区块链数据的存储位置；</li>
   <li style="color:rgb(85,85,85);list-style:circle;">–port：指定和其他节点连接所用的端口号（默认为 30303）；</li>
   <li style="list-style:circle;"><span style="color:#33ccff;"><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">–</span>rpcapi： 设置允许连接的rpc的客户端，一般为db,eth,net,web3；<br></span></li>
   <li style="list-style:circle;"><span style="color:#33ccff;"><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">–</span>networkid： 设置当前区块链的网络ID，用于区分不同的网络，是一个数字；</span><br></li>
   <li style="color:rgb(85,85,85);list-style:circle;">–nodiscover：关闭节点发现机制，防止加入有同样初始配置的陌生节点；</li>
   <li style="list-style:circle;"><span style="color:#33ccff;"><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">–</span>maxpeers : 如果你不希望其他人连接到你的测试链，可以使用maxpeers 0。反之，如果你确切知道希望多少人连接到你的节点，你也可以通过调整数字来实现；<br></span></li>
   <li style="list-style:circle;"><span style="color:#33ccff;"><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">–</span>rpccorsdomain : 这个可以指示什么URL能连接到你的节点来执行RPC定制端任务。务必谨慎，输入一个特定的URL而不是wildcard ( * )，后者会使所有的URL都能连接到你的RPC实例；</span><br></li>
   <li style="list-style:circle;"><span style="color:#000000;"><span style="font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">–</span>console：启动命令行模式，可以在Geth中执行命令。</span></li>
  </ul>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"><span style="color:rgb(153,153,153);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(238,240,244);">注意：</span></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"><span style="color:rgb(153,153,153);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(238,240,244);">1.上面蓝色字体的参数为非必须的，必要时才写入；</span></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"><span style="color:rgb(153,153,153);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(238,240,244);">2.如果想将Ubuntu作为永久区块链节点使用，当使用</span><code style="font-size:14px;line-height:22px;">nohup</code><span style="color:rgb(153,153,153);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(238,240,244);">命令时，Geth启动参数</span><code style="font-size:14px;line-height:22px;">console</code><span style="color:rgb(153,153,153);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;font-size:14px;background-color:rgb(238,240,244);">必须去掉，否则Geth会自动停止。</span><br></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">运行上面的命令后，就启动了区块链节点并进入了该节点的控制台：</p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">...</span>
<span class="line">Welcome to the Geth JavaScript console!</span>
<span class="line"></span>
<span class="line">instance: Geth/TestNode/v1.6.7-stable-ab5646c5/linux-amd64/go1.8.1</span>
<span class="line"> modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">这是一个交互式的 JavaScript 执行环境，在这里面可以执行 JavaScript 代码，其中&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">&gt;</code>&nbsp;是命令提示符。在这个环境里也内置了一些用来操作以太坊的 JavaScript 对象，可以直接使用这些对象。这些对象主要包括：</p>
  <ul style="list-style:none;color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li style="list-style:circle;">eth：包含一些跟操作区块链相关的方法；</li>
   <li style="list-style:circle;">net：包含一些查看p2p网络状态的方法；</li>
   <li style="list-style:circle;">admin：包含一些与管理节点相关的方法；</li>
   <li style="list-style:circle;">miner：包含启动&amp;停止挖矿的一些方法；</li>
   <li style="list-style:circle;">personal：主要包含一些管理账户的方法；</li>
   <li style="list-style:circle;">txpool：包含一些查看交易内存池的方法；</li>
   <li style="list-style:circle;">web3：包含了以上对象，还包含一些单位换算的方法。</li>
  </ul>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%93%8D%E4%BD%9C" rel="nofollow" class="headerlink" title="控制台操作" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>控制台操作</h2>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">进入以太坊 Javascript Console 后，就可以使用里面的内置对象做一些操作，这些内置对象提供的功能很丰富，比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">常用命令有：</p>
  <ul style="list-style:none;color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li style="list-style:circle;">personal.newAccount()：创建账户；</li>
   <li style="list-style:circle;">personal.unlockAccount()：解锁账户；</li>
   <li style="list-style:circle;">eth.accounts：枚举系统中的账户；</li>
   <li style="list-style:circle;">eth.getBalance()：查看账户余额，返回值的单位是 Wei（Wei 是以太坊中最小货币面额单位，类似比特币中的<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">聪</code>，1 ether = 10^18 Wei）；</li>
   <li style="list-style:circle;">eth.blockNumber：列出区块总数；</li>
   <li style="list-style:circle;">eth.getTransaction()：获取交易；</li>
   <li style="list-style:circle;">eth.getBlock()：获取区块；</li>
   <li style="list-style:circle;">miner.start()：开始挖矿；</li>
   <li style="list-style:circle;">miner.stop()：停止挖矿；</li>
   <li style="list-style:circle;">web3.fromWei()：Wei 换算成以太币；</li>
   <li style="list-style:circle;">web3.toWei()：以太币换算成 Wei；</li>
   <li style="list-style:circle;">txpool.status：交易池中的状态；</li>
   <li style="list-style:circle;">admin.addPeer()：连接到其他节点；</li>
  </ul>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">这些命令支持&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">Tab</code>&nbsp;键自动补全，具体用法如下。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%80%E3%80%81%E5%88%9B%E5%BB%BA%E8%B4%A6%E6%88%B7" rel="nofollow" class="headerlink" title="一、创建账户" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>一、创建账户</h3>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; personal.newAccount()</span>
<span class="line">Passphrase:</span>
<span class="line">Repeat passphrase:</span>
<span class="line">"0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802"</span>
<span class="line">&gt; INFO [03-16|00:55:44] New wallet appeared                     url=keystore:///root/work/privatech… status=Locked</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">输入两遍密码后，会生成账户地址。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">再创建一个账户：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; personal.newAccount()</span>
<span class="line">Passphrase:</span>
<span class="line">Repeat passphrase:</span>
<span class="line">"0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62"</span>
<span class="line">&gt; INFO [03-16|01:10:45] New wallet appeared                     url=keystore:///root/work/privatech… status=Locked</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">查看刚刚创建的两个账户：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; eth.accounts</span>
<span class="line">["0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802", "0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62"]</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%BA%8C%E3%80%81%E6%9F%A5%E7%9C%8B%E8%B4%A6%E6%88%B7%E4%BD%99%E9%A2%9D" rel="nofollow" class="headerlink" title="二、查看账户余额" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>二、查看账户余额</h3>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; eth.getBalance(eth.accounts[0])</span>
<span class="line">0</span>
<span class="line">&gt; eth.getBalance(eth.accounts[1])</span>
<span class="line">0</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%89%E3%80%81%E5%90%AF%E5%8A%A8-amp-%E5%81%9C%E6%AD%A2%E6%8C%96%E7%9F%BF" rel="nofollow" class="headerlink" title="三、启动&amp;停止挖矿" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>三、启动&amp;停止挖矿</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">启动挖矿：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; miner.start(1)</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">其中 start 的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的 DAG 文件，这个过程有点慢，等进度达到 100% 后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">停止挖矿，在 console 中输入：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; miner.stop()</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做 coinbase，默认情况下 coinbase 是本地账户中的第一个账户，可以通过 miner.setEtherbase() 将其他账户设置成 coinbase。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E5%9B%9B%E3%80%81%E5%8F%91%E9%80%81%E4%BA%A4%E6%98%93" rel="nofollow" class="headerlink" title="四、发送交易" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>四、发送交易</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">目前，账户 0 已经挖到了 3 个块的奖励，账户 1 的余额还是0：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; eth.getBalance(eth.accounts[0])</span>
<span class="line">15000000000000000000</span>
<span class="line">&gt; eth.getBalance(eth.accounts[1])</span>
<span class="line">0</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">我们要从账户 0 向账户 1 转账，所以要先解锁账户 0，才能发起交易：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; personal.unlockAccount(eth.accounts[0])</span>
<span class="line">Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802</span>
<span class="line">Passphrase: </span>
<span class="line">true</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">发送交易，账户 0 -&gt; 账户 1：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; amount = web3.toWei(5,'ether')</span>
<span class="line">"5000000000000000000"</span>
<span class="line">&gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount})</span>
<span class="line">INFO [03-16|01:32:36] Submitted transaction                    fullhash=0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce recipient=0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62</span>
<span class="line">"0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce"</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">此时如果没有挖矿，用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">txpool.status</code>&nbsp;命令可以看到本地交易池中有一个待确认的交易，可以使用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">eth.getBlock("pending", true).transactions</code>&nbsp;查看当前待确认交易。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">使用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">miner.start()</code>&nbsp;命令开始挖矿：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; miner.start(1);admin.sleepBlocks(1);miner.stop();</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">新区块挖出后，挖矿结束，查看账户 1 的余额，已经收到了账户 0 的以太币：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),'ether')</span>
<span class="line">5</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%BA%94%E3%80%81%E6%9F%A5%E7%9C%8B%E4%BA%A4%E6%98%93%E5%92%8C%E5%8C%BA%E5%9D%97" rel="nofollow" class="headerlink" title="五、查看交易和区块" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>五、查看交易和区块</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">查看当前区块总数：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; eth.blockNumber</span>
<span class="line">4</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">通过交易 Hash 查看交易（Hash 值包含在上面交易返回值中）：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; eth.getTransaction("0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce")</span>
<span class="line">{</span>
<span class="line">  blockHash: "0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d",</span>
<span class="line">  blockNumber: 4,</span>
<span class="line">  from: "0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802",</span>
<span class="line">  gas: 90000,</span>
<span class="line">  gasPrice: 18000000000,</span>
<span class="line">  hash: "0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce",</span>
<span class="line">  input: "0x",</span>
<span class="line">  nonce: 0,</span>
<span class="line">  r: "0x4214d2d8d92efc3aafb515d2413ecd45ab3695d9bcc30d9c7c06932de829e064",</span>
<span class="line">  s: "0x42822033225a2ef662b9b448576e0271b9958e1f4ec912c259e01c84bd1f6681",</span>
<span class="line">  to: "0x02bee2a1582bbf58c42bbdfe7b8db4685d4d4c62",</span>
<span class="line">  transactionIndex: 0,</span>
<span class="line">  v: "0x824",</span>
<span class="line">  value: 5000000000000000000</span>
<span class="line">}</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">通过区块号查看区块：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; eth.getBlock(4)</span>
<span class="line">{</span>
<span class="line">  difficulty: 131072,</span>
<span class="line">  extraData: "0xd783010607846765746887676f312e382e31856c696e7578",</span>
<span class="line">  gasLimit: 3153874,</span>
<span class="line">  gasUsed: 21000,</span>
<span class="line">  hash: "0xdc1fb4469bf4613821c303891a71ff0d1f5af9af8c10efdd8bcd8b518533ee7d",</span>
<span class="line">  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",</span>
<span class="line">  miner: "0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802",</span>
<span class="line">  mixHash: "0x6df88079cf4fbfae98ad7588926fa30becddf4b8b55f93f0380d82ce0533338c",</span>
<span class="line">  nonce: "0x39455ee908666993",</span>
<span class="line">  number: 4,</span>
<span class="line">  parentHash: "0x14fe27755d6fcc704f6b7018d5dc8193f702d89f2c7807bf6f0e402a2b0a29d9",</span>
<span class="line">  receiptsRoot: "0xfcb5b5cc322998562d96339418d08ad8e7c5dd87935f9a3321e040344e3fd095",</span>
<span class="line">  sha3Uncles: "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",</span>
<span class="line">  size: 651,</span>
<span class="line">  stateRoot: "0xdd4a0ce76c7e0ff149853dce5bb4f99592fb1bc3c5e87eb07518a0235ffacd8c",</span>
<span class="line">  timestamp: 1505202063,</span>
<span class="line">  totalDifficulty: 525312,</span>
<span class="line">  transactions: ["0x9f5e61f3d686f793e2df6378d1633d7a9d1df8ec8c597441e1355112d102a6ce"],</span>
<span class="line">  transactionsRoot: "0xbb909845183e037b15d24fe9ad1805fd00350ae04841aa774be6af96e76fdbf9",</span>
<span class="line">  uncles: []</span>
<span class="line">}</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E5%85%AD%E3%80%81%E8%BF%9E%E6%8E%A5%E5%88%B0%E5%85%B6%E4%BB%96%E8%8A%82%E7%82%B9" rel="nofollow" class="headerlink" title="六、连接到其他节点" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>六、连接到其他节点</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">可以通过&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">admin.addPeer()</code>&nbsp;方法连接到其他节点，两个节点要要指定相同的 chainID。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">假设有两个节点：节点一和节点二，chainID 都是 1024，通过下面的步骤就可以从节点一连接到节点二。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">首先要知道节点二的 enode 信息，在节点二的 JavaScript console 中执行下面的命令查看 enode 信息：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; admin.nodeInfo.enode</span>
<span class="line">"enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@[::]:30303"</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">然后在节点一的 JavaScript console 中执行 admin.addPeer()，就可以连接到节点二：</p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; admin.addPeer("enode://d465bcbd5c34da7f4b8e00cbf9dd18e7e2c38fbd6642b7435f340c7d5168947ff2b822146e1dc1b07e02f7c15d5ca09249a92f1d0caa34587c9b2743172259ee@127.0.0.1:30304")</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">addPeer() 的参数就是节点二的 enode 信息，注意要把 enode 中的&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">[::]</code>&nbsp;替换成节点二的 IP 地址。连接成功后，节点二就会开始同步节点一的区块，同步完成后，任意一个节点开始挖矿，另一个节点会自动同步区块，向任意一个节点发送交易，另一个节点也会收到该笔交易。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">通过&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">admin.peers</code>&nbsp;可以查看连接到的其他节点信息，通过&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">net.peerCount</code>&nbsp;可以查看已连接到的节点数量。</p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">除了上面的方法，也可以在启动节点的时候指定&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">--bootnodes</code>&nbsp;选项连接到其他节点。</p>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E6%93%8D%E4%BD%9C" rel="nofollow" class="headerlink" title="智能合约操作" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>智能合约操作</h2>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%80%E3%80%81%E5%88%9B%E5%BB%BA%E5%92%8C%E7%BC%96%E8%AF%91%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6" rel="nofollow" class="headerlink" title="一、创建和编译智能合约" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>一、创建和编译智能合约</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">新建一个 Solidity 智能合约文件，命名为&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">testContract.sol</code>，该合约包含一个方法&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">multiply()</code>，将输入的两个数相乘后输出：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">pragma solidity ^0.4.0;</span>
<span class="line">contract TestContract</span>
<span class="line">{</span>
<span class="line">    function multiply(uint a, uint b) returns (uint)</span>
<span class="line">    {</span>
<span class="line">        return a * b;</span>
<span class="line">    }</span>
<span class="line">}</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">编译智能合约，获得编译后的 EVM 二进制码：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">$ solc --bin testContract.sol</span>
<span class="line"></span>
<span class="line">======= testContract.sol:TestContract =======</span>
<span class="line">Binary:</span>
<span class="line">6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">再用 solc 获取智能合约的 JSON ABI（Application Binary Interface），其中指定了合约接口，包括可调用的合约方法、变量、事件等：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">$ solc --abi testContract.sol</span>
<span class="line"></span>
<span class="line">======= testContract.sol:TestContract =======</span>
<span class="line">Contract JSON ABI</span>
<span class="line">[{"constant":false,"inputs":[{"name":"a","type":"uint256"},{"name":"b","type":"uint256"}],"name":"multiply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"}]</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">回到 Geth 的控制台，用变量&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">code</code>&nbsp;和&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">abi</code>&nbsp;记录上面两个值，注意在 code 前加上&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">0x</code>&nbsp;前缀：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; code = "0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029"</span>
<span class="line">&gt; abi = [{"constant":false,"inputs":[{"name":"a","type":"uint256"},{"name":"b","type":"uint256"}],"name":"multiply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"}]</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%BA%8C%E3%80%81%E9%83%A8%E7%BD%B2%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6" rel="nofollow" class="headerlink" title="二、部署智能合约" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>二、部署智能合约</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">这里使用账户 0 来部署合约，首先解锁账户：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; personal.unlockAccount(eth.accounts[0])</span>
<span class="line">Unlock account 0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802</span>
<span class="line">Passphrase:</span>
<span class="line">true</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">发送部署合约的交易：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; myContract = eth.contract(abi)</span>
<span class="line">...</span>
<span class="line">&gt; contract = myContract.new({from:eth.accounts[0],data:code,gas:1000000})</span>
<span class="line"></span>
<span class="line">INFO [09-12|08:05:19] Submitted contract creation              fullhash=0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1 contract=0x7cbe4019e993f9922b8233502d94890099ee59e6</span>
<span class="line">{</span>
<span class="line">  abi: [{</span>
<span class="line">      constant: false,</span>
<span class="line">      inputs: [{...}, {...}],</span>
<span class="line">      name: "multiply",</span>
<span class="line">      outputs: [{...}],</span>
<span class="line">      payable: false,</span>
<span class="line">      stateMutability: "nonpayable",</span>
<span class="line">      type: "function"</span>
<span class="line">  }],</span>
<span class="line">  address: undefined,</span>
<span class="line">  transactionHash: "0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1"</span>
<span class="line">}</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">此时如果没有挖矿，用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">txpool.status</code>&nbsp;命令可以看到本地交易池中有一个待确认的交易。使用下面的命令查看当前待确认的交易：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">[{</span>
<span class="line">    blockHash: "0xfedd6fef9f25e96a5a20b5ffcd152e9fe05d193ae0989c25d6197d2441c2c09b",</span>
<span class="line">    blockNumber: 5,</span>
<span class="line">    from: "0x3443ffb2a5ce3f4b80080791e0fde16a3fac2802",</span>
<span class="line">    gas: 1000000,</span>
<span class="line">    gasPrice: 18000000000,</span>
<span class="line">    hash: "0x0a7dfa9cac7ef836a72ed1d5bbfa65c0220347cde4efb067a0b03b15fb70bce1",</span>
<span class="line">    input: "0x6060604052341561000f57600080fd5b5b60b48061001e6000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063165c4a1614603d575b600080fd5b3415604757600080fd5b60646004808035906020019091908035906020019091905050607a565b6040518082815260200191505060405180910390f35b600081830290505b929150505600a165627a7a72305820b494a4b3879b3810accf64d4cc3e1be55f2f4a86f49590b8a9b8d7009090a5d30029",</span>
<span class="line">    nonce: 3,</span>
<span class="line">    r: "0xfe7139a31694a36f946e7182c35c52a21bf31d33994490815f63f6674e84dc93",</span>
<span class="line">    s: "0x4701a984ee93d2a323fac55547b31534b11915599de75202a1d62061241fefbf",</span>
<span class="line">    to: null,</span>
<span class="line">    transactionIndex: 0,</span>
<span class="line">    v: "0x823",</span>
<span class="line">    value: 0</span>
<span class="line">}]</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">使用&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">miner.start()</code>&nbsp;命令开始挖矿，一段时间后交易会被确认，随新区块进入区块链。</p>
  <h3 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:20px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E4%B8%89%E3%80%81%E8%B0%83%E7%94%A8%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6" rel="nofollow" class="headerlink" title="三、调用智能合约" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>三、调用智能合约</h3>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">使用以下命令发送交易，<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">sendTransaction</code>&nbsp;方法的前几个参数应该与合约中&nbsp;<code style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);">multiply</code>&nbsp;方法的输入参数对应。这种情况下，交易会通过挖矿记录到区块链中：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; contract.multiply.sendTransaction(2, 4, {from:eth.accounts[0]})</span>
<span class="line"></span>
<span class="line">INFO [03-16|02:54:16] Submitted transaction                    fullhash=0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2 recipient=0x7cbe4019e993f9922b8233502d94890099ee59e6</span>
<span class="line">"0x29b47d580ba6ccb2445aa3ebdcb14567bd5cbc6004edef7a4064c36e0606bca2"</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">如果只是本地运行该方法查看返回结果，可以采用如下方式：<br></p>
  <table style="border-spacing:0px;border:none;font-size:14px;table-layout:fixed;">
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td class="gutter" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(134,145,148);background:rgb(239,242,243);line-height:1.6;border:none;text-align:right;"><span class="line">1</span>
<span class="line">2</span>
</pre></td>
     <td class="code" style="vertical-align:middle;border-style:none;"><pre style="font-family:consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size:13px;color:rgb(77,77,76);background:rgb(247,247,247);line-height:1.6;border:none;"><span class="line">&gt; contract.multiply.call(2，4)</span>
<span class="line">8</span>
</pre></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></p>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E6%9C%AF%E8%AF%AD%E8%AF%B4%E6%98%8E" rel="nofollow" class="headerlink" title="术语说明" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>术语说明</h2>
  <table style="border-spacing:0px;border:1px solid rgb(221,221,221);font-size:14px;table-layout:fixed;color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;text-align:justify;background-color:rgb(255,255,255);">
   <thead>
    <tr>
     <th style="vertical-align:middle;border-bottom-width:3px;border-right-color:rgb(238,238,238);">术语</th>
     <th style="vertical-align:middle;border-bottom-width:3px;border-right-color:rgb(238,238,238);">&nbsp;</th>
     <th style="vertical-align:middle;border-bottom-width:3px;border-right-color:rgb(238,238,238);">说明</th>
    </tr>
   </thead>
   <tbody>
    <tr style="background-color:rgb(249,249,249);">
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">ABI</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Application Binary Interface，应用二进制接口</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">其中指定了合约接口，包括可调用的合约方法、变量、事件等。</td>
    </tr>
    <tr>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">DApp</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Decentralized App，去中心化的应用程序</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">基于智能合约的应用称为去中心化的应用程序。</td>
    </tr>
    <tr style="background-color:rgb(249,249,249);">
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">EVM</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Ethereum Virtual Machine，以太坊虚拟机</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">以太坊智能合约的运行环境。</td>
    </tr>
    <tr>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Gas</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">（消耗的）汽油</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">在以太坊上发起交易、部署合约和调用合约都要消耗一定量的以太币，这些消耗的以太币称为 Gas。</td>
    </tr>
    <tr style="background-color:rgb(245,245,245);">
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Geth</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">-</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">以太坊客户端 go-ethereum，使用 Go 语言编写，是最常用的以太坊客户端之一。</td>
    </tr>
    <tr>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Solidity</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">-</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">以太坊智能合约的一种编程语言，类似 JavaScript。</td>
    </tr>
    <tr style="background-color:rgb(249,249,249);">
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">Remix IDE</td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);"><a href="https://remix.ethereum.org/" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://remix.ethereum.org</a></td>
     <td style="vertical-align:middle;border-right-color:rgb(238,238,238);">基于浏览器的 Solidity 集成开发环境，在浏览器中编写和调试智能合约。</td>
    </tr>
   </tbody>
  </table>
  <h2 style="line-height:1.5;font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;font-size:22px;color:rgb(85,85,85);background-color:rgb(255,255,255);"><a href="https://g2ex.github.io/2017/09/12/ethereum-guidance/#%E5%8F%82%E8%80%83%E5%86%85%E5%AE%B9" rel="nofollow" class="headerlink" title="参考内容" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);"></a>参考内容</h2>
  <ul style="list-style:none;color:rgb(85,85,85);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">
   <li style="list-style:circle;">《区块链——原理、设计与应用》杨保华、陈昌编著，机械工业出版</li>
   <li style="list-style:circle;">以太坊学习笔记：私有链搭建操作指南&nbsp;<a href="https://my.oschina.net/u/2349981/blog/865256" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://my.oschina.net/u/2349981/blog/865256</a></li>
   <li style="list-style:circle;">利用puppeth搭建POA共识的以太坊私链网络&nbsp;<a href="https://github.com/xiaoping378/blog/blob/master/posts/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA%E5%88%9D%E6%AD%A5%E5%AE%9E%E8%B7%B5.md" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://github.com/xiaoping378/blog/blob/master/posts/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA%E5%88%9D%E6%AD%A5%E5%AE%9E%E8%B7%B5.md</a></li>
   <li style="list-style:circle;">区块链技术指南&nbsp;<a href="https://yeasy.gitbooks.io/blockchain_guide/ethereum/install.html" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://yeasy.gitbooks.io/blockchain_guide/ethereum/install.html</a></li>
   <li style="list-style:circle;">Solidity 官方文档&nbsp;<a href="http://solidity.readthedocs.io/en/latest/installing-solidity.html" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">http://solidity.readthedocs.io/en/latest/installing-solidity.html</a></li>
   <li style="list-style:circle;">Go 官方文档&nbsp;<a href="https://golang.org/doc/install" rel="nofollow" style="background-color:transparent;color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);">https://golang.org/doc/install</a></li>
   <li style="list-style:circle;"><span style="color:rgb(102,102,102);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);">更多区块链资料，请访问&nbsp;</span><a href="https://github.com/gymgle/blockchain-reference" rel="nofollow" style="background-color:rgb(255,255,255);color:rgb(85,85,85);border-bottom:1px solid rgb(204,204,204);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;">https://github.com/gymgle/blockchain-reference</a><br></li>
  </ul>
  <blockquote style="color:rgb(102,102,102);border-left:4px solid rgb(221,221,221);font-family:Lato, 'PingFang SC', 'Microsoft YaHei', sans-serif;background-color:rgb(255,255,255);"></blockquote>
  <pre class="plain"></pre> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/scau_lth/article/details/79570886,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/scau_lth/article/details/79570886,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
