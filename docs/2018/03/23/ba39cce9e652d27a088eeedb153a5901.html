<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Python抓取股票数据，如何用python编程赚取第一桶金？ | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Python抓取股票数据，如何用python编程赚取第一桶金？" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Python开发的一个快速,高层次的屏幕抓取和web抓取框架，用于抓取web站点并从页面中提取结构化的数据。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试。 Scrapy吸引人的地方在于它是一个框架，任何人都可以根据需求方便的修改。它也提供了多种类型爬虫的基类，如BaseSpider、sitemap爬虫等，最新版本又提供了web2.0爬虫的支持。 Scratch，是抓取的意思，这个Python的爬虫框架叫Scrapy，大概也是这个意思吧，就叫它：小刮刮吧。 这里还是要推荐下小编的Python学习群:483546416，不管你是小白还是大牛，小编我都欢迎，不定期分享干货，包括小编自己整理的一份2017最新的Python资料和0基础入门教程，欢迎初学和进阶中的小伙伴。在不忙的时间我会给大家解惑。 Scrapy 使用了 Twisted异步网络库来处理网络通讯。整体架构大致如下 爬虫(Spiders)爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面下面用python用Python来可视化股票数据，比如绘制K线图，并且探究各项指标的含义和关系最后使用移动平均线方法初探投资策略。 数据导入 这里将股票数据存储在stockData.txt文本文件中，我们使用pandas.read_table()函数将文件数据读入成DataFrame格式。 其中参数usecols=range(15)限制只读取前15列数据，parse_dates=[0]表示将第一列数据解析成时间格式，index_col=0则将第一列数据指定为索引。 其中参数usecols=range(15)限制只读取前15列数据，parse_dates=[0]表示将第一列数据解析成时间格式，index_col=0则将第一列数据指定为索引。 12345678910111213141516 import pandas aspdimport numpy asnpimport matplotlib.pyplot asplt%matplotlibinline%configInlineBackend.figure_format=&#39;retina&#39;%pylabinlinepylab.rcParams[&#39;figure.figsize&#39;]=(10,6)#设置绘图尺寸#读取数据stock=pd.read_table(&#39;stockData.txt&#39;,usecols=range(15),parse_dates=[0],index_col=0)stock=stock[::-1]#逆序排列stock.head() 以上显示了前5行数据，要得到数据的更多信息，可以使用.info()方法。它告诉我们该数据一共有20行，索引是时间格式，日期从2015年1月5日到2015年1月30日。总共有14列，并列出了每一列的名称和数据格式，并且没有缺失值。 1 stock.info() Python 12345678910111213141516171819 &lt;class&#39;pandas.core.frame.DataFrame&#39;&gt;DatetimeIndex:20entries,2015-01-05to2015-01-30Data columns(total14columns):open20non-null float64high20non-null float64close20non-null float64low20non-null float64volume20non-null float64price_change20non-null float64p_change20non-null float64ma520non-null float64ma1020non-null float64ma2020non-null float64v_ma520non-null float64v_ma1020non-null float64v_ma2020non-null float64turnover20non-null float64dtypes:float64(14)memory usage:2.3KB 在观察每一列的名称时，我们发现’open’的列名前面似乎与其它列名不太一样，为了更清楚地查看，使用.columns得到该数据所有的列名如下： 1 stock.columns 1234 Index([&#39; open&#39;,&#39;high&#39;,&#39;close&#39;,&#39;low&#39;,&#39;volume&#39;,&#39;price_change&#39;,&#39;p_change&#39;,&#39;ma5&#39;,&#39;ma10&#39;,&#39;ma20&#39;,&#39;v_ma5&#39;,&#39;v_ma10&#39;,&#39;v_ma20&#39;,&#39;turnover&#39;],dtype=&#39;object&#39;) 于是发现’open’列名前存在多余的空格，我们使用如下方法修正列名。 1 stock.rename(columns={&#39; open&#39;:&#39;open&#39;},inplace=True) 至此，我们完成了股票数据的导入和清洗工作，接下来将使用可视化的方法来观察这些数据。 数据观察 首先，我们观察数据的列名，其含义对应如下： open high colse low volume price_change p_change 开盘价 最高价 收盘价 最低价 成交量 价格变动 涨跌幅 ma5 ma10 ma20 v_ma5 v_ma10 v_ma20 turnover 5日均价 10日均价 20日均价 5日均量 10日均量 20日均量 换手率 这些指标总体可分为两类： 价格相关指标 当日价格：开盘、收盘价，最高、最低价 价格变化：价格变动和涨跌幅 均价：5、10、20日均价 成交量相关指标 成交量 换手率：成交量/发行总股数×100% 成交量均量：5、10、20日均量 由于这些指标都是随时间变化的，所以让我们先来观察它们的时间序列图。 相对变化量 股票中关注的不是价格的绝对值，而是相对变化量。有多种方式可以衡量股价的相对值，最简单的方法就是将股价除以初始时的价格。 12 stock[&#39;return&#39;]=stock[&#39;close&#39;]/stock.close.iloc[0]stock[&#39;return&#39;].plot(grid=True) 第二种方法是计算每天的涨跌幅，但计算方式有两种： 这两者可能导致不同的分析结果，样例数据中的涨跌幅使用的是第一个公式，并乘上了100%。 1 stock[&#39;p_change&#39;].plot(grid=True).axhline(y=0,color=&#39;black&#39;,lw=2) 为了解决第二种方法中的两难选择，我们引入第三种方法，就是计算价格的对数之差，公式如下： 123 close_price=stock[&#39;close&#39;]log_change=np.log(close_price)-np.log(close_price.shift(1))log_change.plot(grid=True).axhline(y=0,color=&#39;black&#39;,lw=2) K线图 相传K线图起源于日本德川幕府时代，当时的商人用此图来记录米市的行情和价格波动，后来K线图被引入到股票市场。每天的四项指标数据用如下蜡烛形状的图形来记录，不同的颜色代表涨跌情况。 图片来源：http://wiki.mbalib.com/wiki/K线理论 Matplotlib.finance模块提供了绘制K线图的函数candlestick_ohlc()，但如果要绘制比较美观的K线图还是要下点功夫的。下面定义了pandas_candlestick_ohlc()函数来绘制适用于本文数据的K线图，其中大部分代码都是在设置坐标轴的格式。 Python 123456789101112131415161718192021222324252627282930313233343536373839 frommatplotlib.finance importcandlestick_ohlcfrommatplotlib.dates importDateFormatter,WeekdayLocator,DayLocator,MONDAYdefpandas_candlestick_ohlc(stock_data,otherseries=None):# 设置绘图参数，主要是坐标轴mondays=WeekdayLocator(MONDAY)alldays=DayLocator()dayFormatter=DateFormatter(&#39;%d&#39;)fig,ax=plt.subplots()fig.subplots_adjust(bottom=0.2)ifstock_data.index[-1]-stock_data.index[0]&lt;pd.Timedelta(&#39;730 days&#39;):weekFormatter=DateFormatter(&#39;%b %d&#39;)ax.xaxis.set_major_locator(mondays)ax.xaxis.set_minor_locator(alldays)else:weekFormatter=DateFormatter(&#39;%b %d, %Y&#39;)ax.xaxis.set_major_formatter(weekFormatter)ax.grid(True)# 创建K线图stock_array=np.array(stock_data.reset_index()[[&#39;date&#39;,&#39;open&#39;,&#39;high&#39;,&#39;low&#39;,&#39;close&#39;]])stock_array[:,0]=date2num(stock_array[:,0])candlestick_ohlc(ax,stock_array,colorup=&quot;red&quot;,colordown=&quot;green&quot;,width=0.4)# 可同时绘制其他折线图ifotherseries isnotNone:foreach inotherseries:plt.plot(stock_data[each],label=each)plt.legend()ax.xaxis_date()ax.autoscale_view()plt.setp(plt.gca().get_xticklabels(),rotation=45,horizontalalignment=&#39;right&#39;)plt.show() 1 pandas_candlestick_ohlc(stock) 这里红色代表上涨，绿色代表下跌。 相关关系 在观察了价格的走势之后，我们来看看各指标之间的关系。下面挑选了部分代表性的指标，并使用pandas.scatter_matrix()函数，将各项指标数据两两关联做散点图，对角线是每个指标数据的直方图。 12 small=stock[[&#39;close&#39;,&#39;price_change&#39;,&#39;ma20&#39;,&#39;volume&#39;,&#39;v_ma20&#39;,&#39;turnover&#39;]]_=pd.scatter_matrix(small) 图中可以明显发现成交量（volume）和换手率（turnover）有非常明显的线性关系，其实换手率的定义就是：成交量除以发行总股数，再乘以100%。所以下面的分析中我们将换手率指标去除，这里使用了相关性关系来实现数据降维。 上面的散点图看着有些眼花缭乱，我们可以使用numpy.corrcof()来直接计算各指标数据间的相关系数。 123 small=stock[[&#39;close&#39;,&#39;price_change&#39;,&#39;ma20&#39;,&#39;volume&#39;,&#39;v_ma20&#39;]]cov=np.corrcoef(small.T)cov 12345 array([[1.,0.30308764,0.10785519,0.91078009,-0.37602193],[0.30308764,1.,-0.45849273,0.3721832,-0.25950305],[0.10785519,-0.45849273,1.,-0.06002202,0.51793654],[0.91078009,0.3721832,-0.06002202,1.,-0.37617624],[-0.37602193,-0.25950305,0.51793654,-0.37617624,1.]]) 如果觉得看数字还是不够方便，我们继续将上述相关性矩阵转换成图形，如下图所示，其中用颜色来代表相关系数。我们发现位于（0，3）位置的相关系数非常大，查看数值达到0.91。这两个强烈正相关的指标是收盘价和成交量。 123 img=plt.matshow(cov,cmap=plt.cm.winter)plt.colorbar(img,ticks=[-1,0,1])plt.show() 以上我们用矩阵图表的方式在多个指标中迅速找到了强相关的指标。接着做出收盘价和成交量的折线图，因为它们的数值差异很大，所以我们采用两套纵坐标体系来做图。 1 stock[[&#39;close&#39;,&#39;volume&#39;]].plot(secondary_y=&#39;volume&#39;,grid=True) 观察这两个指标的走势，在大部分时候股价上涨，成交量也上涨，反之亦然。但个别情况下则不成立，可能是成交量受到前期的惯性影响，或者还有其他因素。 区块链】中国区块链研究全球领先 有待龙头技术企业崛起 近日，IPRdaily中文网与incoPat创新指数研究中心联合发布“2017全球区块链企业专利排行榜（前100名）”显示，中国在区块链研究方面全球领先。 “区块链技术要大规模发展，在底层技术上还要进一步发展，就像移动互联网一样，它就有IOS和安卓两套强大的基础系统。虽然区块链的基础技术研究投入很多，但目前许多研发团队都是各自为战，还未有真正的龙头技术企业崛起。” 未来发展或是局部突破 基于政策鼓励，区块链行业如今迎来了快速发展的风口，各类区块链公司如雨后春笋般纷纷借力生长。同时，区块链概念股开始集体大涨。暴风集团、美图、迅雷等上市公司趁机搭上区块链的风口，其中大多数公司连业务还未落地，股价就已“起飞”。 不久前，真格基金掌舵者徐小平在其内部微信群中表示，“区块链革命已经到来，这是一场顺之者昌、逆之者亡的伟大技术革命。要主动拥抱区块链技术，不要临渊羡鱼，也不要隔岸观火，要冲到这个行业里面去，赶紧研究赶紧行动。” 不过，在众多业内人士看来，目前区块链技术的发展仍然处于初期阶段，它的去中心化特点涉及对传统商业逻辑的颠覆，并非朝夕之间就能实现。余林民向记者表示，“我觉得，区块链要像互联网一样改变人类的生活，需要比较长的时间。未来区块链应用最可能的发展，还是先在局部获得突破。” 2月6日，一份名为《2017全球区块链企业专利排行榜》，让国内BAT的区块链势能浮出水面。前100名中，中国入榜的企业占比49%，其次才是美国，占比33%；其中国内阿里巴巴以49件的总量排名第一，腾讯科技为11件。 这份报告，让阿里在区块链上的占位一时风头无两。阿里巴巴集团学术委员会主席曾鸣此前谈及阿里巴巴的区块链之路时称，早在2015年蚂蚁金服内部便形成一个区块链兴趣小组，2016年开始在公益项目上做尝试。截至目前，阿里的区块链围绕着其电商和新零售业务的优势，布局已经涉及公益、商品溯源、租房场景等领域。 阅读更多" />
<meta property="og:description" content="Python开发的一个快速,高层次的屏幕抓取和web抓取框架，用于抓取web站点并从页面中提取结构化的数据。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试。 Scrapy吸引人的地方在于它是一个框架，任何人都可以根据需求方便的修改。它也提供了多种类型爬虫的基类，如BaseSpider、sitemap爬虫等，最新版本又提供了web2.0爬虫的支持。 Scratch，是抓取的意思，这个Python的爬虫框架叫Scrapy，大概也是这个意思吧，就叫它：小刮刮吧。 这里还是要推荐下小编的Python学习群:483546416，不管你是小白还是大牛，小编我都欢迎，不定期分享干货，包括小编自己整理的一份2017最新的Python资料和0基础入门教程，欢迎初学和进阶中的小伙伴。在不忙的时间我会给大家解惑。 Scrapy 使用了 Twisted异步网络库来处理网络通讯。整体架构大致如下 爬虫(Spiders)爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面下面用python用Python来可视化股票数据，比如绘制K线图，并且探究各项指标的含义和关系最后使用移动平均线方法初探投资策略。 数据导入 这里将股票数据存储在stockData.txt文本文件中，我们使用pandas.read_table()函数将文件数据读入成DataFrame格式。 其中参数usecols=range(15)限制只读取前15列数据，parse_dates=[0]表示将第一列数据解析成时间格式，index_col=0则将第一列数据指定为索引。 其中参数usecols=range(15)限制只读取前15列数据，parse_dates=[0]表示将第一列数据解析成时间格式，index_col=0则将第一列数据指定为索引。 12345678910111213141516 import pandas aspdimport numpy asnpimport matplotlib.pyplot asplt%matplotlibinline%configInlineBackend.figure_format=&#39;retina&#39;%pylabinlinepylab.rcParams[&#39;figure.figsize&#39;]=(10,6)#设置绘图尺寸#读取数据stock=pd.read_table(&#39;stockData.txt&#39;,usecols=range(15),parse_dates=[0],index_col=0)stock=stock[::-1]#逆序排列stock.head() 以上显示了前5行数据，要得到数据的更多信息，可以使用.info()方法。它告诉我们该数据一共有20行，索引是时间格式，日期从2015年1月5日到2015年1月30日。总共有14列，并列出了每一列的名称和数据格式，并且没有缺失值。 1 stock.info() Python 12345678910111213141516171819 &lt;class&#39;pandas.core.frame.DataFrame&#39;&gt;DatetimeIndex:20entries,2015-01-05to2015-01-30Data columns(total14columns):open20non-null float64high20non-null float64close20non-null float64low20non-null float64volume20non-null float64price_change20non-null float64p_change20non-null float64ma520non-null float64ma1020non-null float64ma2020non-null float64v_ma520non-null float64v_ma1020non-null float64v_ma2020non-null float64turnover20non-null float64dtypes:float64(14)memory usage:2.3KB 在观察每一列的名称时，我们发现’open’的列名前面似乎与其它列名不太一样，为了更清楚地查看，使用.columns得到该数据所有的列名如下： 1 stock.columns 1234 Index([&#39; open&#39;,&#39;high&#39;,&#39;close&#39;,&#39;low&#39;,&#39;volume&#39;,&#39;price_change&#39;,&#39;p_change&#39;,&#39;ma5&#39;,&#39;ma10&#39;,&#39;ma20&#39;,&#39;v_ma5&#39;,&#39;v_ma10&#39;,&#39;v_ma20&#39;,&#39;turnover&#39;],dtype=&#39;object&#39;) 于是发现’open’列名前存在多余的空格，我们使用如下方法修正列名。 1 stock.rename(columns={&#39; open&#39;:&#39;open&#39;},inplace=True) 至此，我们完成了股票数据的导入和清洗工作，接下来将使用可视化的方法来观察这些数据。 数据观察 首先，我们观察数据的列名，其含义对应如下： open high colse low volume price_change p_change 开盘价 最高价 收盘价 最低价 成交量 价格变动 涨跌幅 ma5 ma10 ma20 v_ma5 v_ma10 v_ma20 turnover 5日均价 10日均价 20日均价 5日均量 10日均量 20日均量 换手率 这些指标总体可分为两类： 价格相关指标 当日价格：开盘、收盘价，最高、最低价 价格变化：价格变动和涨跌幅 均价：5、10、20日均价 成交量相关指标 成交量 换手率：成交量/发行总股数×100% 成交量均量：5、10、20日均量 由于这些指标都是随时间变化的，所以让我们先来观察它们的时间序列图。 相对变化量 股票中关注的不是价格的绝对值，而是相对变化量。有多种方式可以衡量股价的相对值，最简单的方法就是将股价除以初始时的价格。 12 stock[&#39;return&#39;]=stock[&#39;close&#39;]/stock.close.iloc[0]stock[&#39;return&#39;].plot(grid=True) 第二种方法是计算每天的涨跌幅，但计算方式有两种： 这两者可能导致不同的分析结果，样例数据中的涨跌幅使用的是第一个公式，并乘上了100%。 1 stock[&#39;p_change&#39;].plot(grid=True).axhline(y=0,color=&#39;black&#39;,lw=2) 为了解决第二种方法中的两难选择，我们引入第三种方法，就是计算价格的对数之差，公式如下： 123 close_price=stock[&#39;close&#39;]log_change=np.log(close_price)-np.log(close_price.shift(1))log_change.plot(grid=True).axhline(y=0,color=&#39;black&#39;,lw=2) K线图 相传K线图起源于日本德川幕府时代，当时的商人用此图来记录米市的行情和价格波动，后来K线图被引入到股票市场。每天的四项指标数据用如下蜡烛形状的图形来记录，不同的颜色代表涨跌情况。 图片来源：http://wiki.mbalib.com/wiki/K线理论 Matplotlib.finance模块提供了绘制K线图的函数candlestick_ohlc()，但如果要绘制比较美观的K线图还是要下点功夫的。下面定义了pandas_candlestick_ohlc()函数来绘制适用于本文数据的K线图，其中大部分代码都是在设置坐标轴的格式。 Python 123456789101112131415161718192021222324252627282930313233343536373839 frommatplotlib.finance importcandlestick_ohlcfrommatplotlib.dates importDateFormatter,WeekdayLocator,DayLocator,MONDAYdefpandas_candlestick_ohlc(stock_data,otherseries=None):# 设置绘图参数，主要是坐标轴mondays=WeekdayLocator(MONDAY)alldays=DayLocator()dayFormatter=DateFormatter(&#39;%d&#39;)fig,ax=plt.subplots()fig.subplots_adjust(bottom=0.2)ifstock_data.index[-1]-stock_data.index[0]&lt;pd.Timedelta(&#39;730 days&#39;):weekFormatter=DateFormatter(&#39;%b %d&#39;)ax.xaxis.set_major_locator(mondays)ax.xaxis.set_minor_locator(alldays)else:weekFormatter=DateFormatter(&#39;%b %d, %Y&#39;)ax.xaxis.set_major_formatter(weekFormatter)ax.grid(True)# 创建K线图stock_array=np.array(stock_data.reset_index()[[&#39;date&#39;,&#39;open&#39;,&#39;high&#39;,&#39;low&#39;,&#39;close&#39;]])stock_array[:,0]=date2num(stock_array[:,0])candlestick_ohlc(ax,stock_array,colorup=&quot;red&quot;,colordown=&quot;green&quot;,width=0.4)# 可同时绘制其他折线图ifotherseries isnotNone:foreach inotherseries:plt.plot(stock_data[each],label=each)plt.legend()ax.xaxis_date()ax.autoscale_view()plt.setp(plt.gca().get_xticklabels(),rotation=45,horizontalalignment=&#39;right&#39;)plt.show() 1 pandas_candlestick_ohlc(stock) 这里红色代表上涨，绿色代表下跌。 相关关系 在观察了价格的走势之后，我们来看看各指标之间的关系。下面挑选了部分代表性的指标，并使用pandas.scatter_matrix()函数，将各项指标数据两两关联做散点图，对角线是每个指标数据的直方图。 12 small=stock[[&#39;close&#39;,&#39;price_change&#39;,&#39;ma20&#39;,&#39;volume&#39;,&#39;v_ma20&#39;,&#39;turnover&#39;]]_=pd.scatter_matrix(small) 图中可以明显发现成交量（volume）和换手率（turnover）有非常明显的线性关系，其实换手率的定义就是：成交量除以发行总股数，再乘以100%。所以下面的分析中我们将换手率指标去除，这里使用了相关性关系来实现数据降维。 上面的散点图看着有些眼花缭乱，我们可以使用numpy.corrcof()来直接计算各指标数据间的相关系数。 123 small=stock[[&#39;close&#39;,&#39;price_change&#39;,&#39;ma20&#39;,&#39;volume&#39;,&#39;v_ma20&#39;]]cov=np.corrcoef(small.T)cov 12345 array([[1.,0.30308764,0.10785519,0.91078009,-0.37602193],[0.30308764,1.,-0.45849273,0.3721832,-0.25950305],[0.10785519,-0.45849273,1.,-0.06002202,0.51793654],[0.91078009,0.3721832,-0.06002202,1.,-0.37617624],[-0.37602193,-0.25950305,0.51793654,-0.37617624,1.]]) 如果觉得看数字还是不够方便，我们继续将上述相关性矩阵转换成图形，如下图所示，其中用颜色来代表相关系数。我们发现位于（0，3）位置的相关系数非常大，查看数值达到0.91。这两个强烈正相关的指标是收盘价和成交量。 123 img=plt.matshow(cov,cmap=plt.cm.winter)plt.colorbar(img,ticks=[-1,0,1])plt.show() 以上我们用矩阵图表的方式在多个指标中迅速找到了强相关的指标。接着做出收盘价和成交量的折线图，因为它们的数值差异很大，所以我们采用两套纵坐标体系来做图。 1 stock[[&#39;close&#39;,&#39;volume&#39;]].plot(secondary_y=&#39;volume&#39;,grid=True) 观察这两个指标的走势，在大部分时候股价上涨，成交量也上涨，反之亦然。但个别情况下则不成立，可能是成交量受到前期的惯性影响，或者还有其他因素。 区块链】中国区块链研究全球领先 有待龙头技术企业崛起 近日，IPRdaily中文网与incoPat创新指数研究中心联合发布“2017全球区块链企业专利排行榜（前100名）”显示，中国在区块链研究方面全球领先。 “区块链技术要大规模发展，在底层技术上还要进一步发展，就像移动互联网一样，它就有IOS和安卓两套强大的基础系统。虽然区块链的基础技术研究投入很多，但目前许多研发团队都是各自为战，还未有真正的龙头技术企业崛起。” 未来发展或是局部突破 基于政策鼓励，区块链行业如今迎来了快速发展的风口，各类区块链公司如雨后春笋般纷纷借力生长。同时，区块链概念股开始集体大涨。暴风集团、美图、迅雷等上市公司趁机搭上区块链的风口，其中大多数公司连业务还未落地，股价就已“起飞”。 不久前，真格基金掌舵者徐小平在其内部微信群中表示，“区块链革命已经到来，这是一场顺之者昌、逆之者亡的伟大技术革命。要主动拥抱区块链技术，不要临渊羡鱼，也不要隔岸观火，要冲到这个行业里面去，赶紧研究赶紧行动。” 不过，在众多业内人士看来，目前区块链技术的发展仍然处于初期阶段，它的去中心化特点涉及对传统商业逻辑的颠覆，并非朝夕之间就能实现。余林民向记者表示，“我觉得，区块链要像互联网一样改变人类的生活，需要比较长的时间。未来区块链应用最可能的发展，还是先在局部获得突破。” 2月6日，一份名为《2017全球区块链企业专利排行榜》，让国内BAT的区块链势能浮出水面。前100名中，中国入榜的企业占比49%，其次才是美国，占比33%；其中国内阿里巴巴以49件的总量排名第一，腾讯科技为11件。 这份报告，让阿里在区块链上的占位一时风头无两。阿里巴巴集团学术委员会主席曾鸣此前谈及阿里巴巴的区块链之路时称，早在2015年蚂蚁金服内部便形成一个区块链兴趣小组，2016年开始在公益项目上做尝试。截至目前，阿里的区块链围绕着其电商和新零售业务的优势，布局已经涉及公益、商品溯源、租房场景等领域。 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-23T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"Python开发的一个快速,高层次的屏幕抓取和web抓取框架，用于抓取web站点并从页面中提取结构化的数据。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试。 Scrapy吸引人的地方在于它是一个框架，任何人都可以根据需求方便的修改。它也提供了多种类型爬虫的基类，如BaseSpider、sitemap爬虫等，最新版本又提供了web2.0爬虫的支持。 Scratch，是抓取的意思，这个Python的爬虫框架叫Scrapy，大概也是这个意思吧，就叫它：小刮刮吧。 这里还是要推荐下小编的Python学习群:483546416，不管你是小白还是大牛，小编我都欢迎，不定期分享干货，包括小编自己整理的一份2017最新的Python资料和0基础入门教程，欢迎初学和进阶中的小伙伴。在不忙的时间我会给大家解惑。 Scrapy 使用了 Twisted异步网络库来处理网络通讯。整体架构大致如下 爬虫(Spiders)爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面下面用python用Python来可视化股票数据，比如绘制K线图，并且探究各项指标的含义和关系最后使用移动平均线方法初探投资策略。 数据导入 这里将股票数据存储在stockData.txt文本文件中，我们使用pandas.read_table()函数将文件数据读入成DataFrame格式。 其中参数usecols=range(15)限制只读取前15列数据，parse_dates=[0]表示将第一列数据解析成时间格式，index_col=0则将第一列数据指定为索引。 其中参数usecols=range(15)限制只读取前15列数据，parse_dates=[0]表示将第一列数据解析成时间格式，index_col=0则将第一列数据指定为索引。 12345678910111213141516 import pandas aspdimport numpy asnpimport matplotlib.pyplot asplt%matplotlibinline%configInlineBackend.figure_format=&#39;retina&#39;%pylabinlinepylab.rcParams[&#39;figure.figsize&#39;]=(10,6)#设置绘图尺寸#读取数据stock=pd.read_table(&#39;stockData.txt&#39;,usecols=range(15),parse_dates=[0],index_col=0)stock=stock[::-1]#逆序排列stock.head() 以上显示了前5行数据，要得到数据的更多信息，可以使用.info()方法。它告诉我们该数据一共有20行，索引是时间格式，日期从2015年1月5日到2015年1月30日。总共有14列，并列出了每一列的名称和数据格式，并且没有缺失值。 1 stock.info() Python 12345678910111213141516171819 &lt;class&#39;pandas.core.frame.DataFrame&#39;&gt;DatetimeIndex:20entries,2015-01-05to2015-01-30Data columns(total14columns):open20non-null float64high20non-null float64close20non-null float64low20non-null float64volume20non-null float64price_change20non-null float64p_change20non-null float64ma520non-null float64ma1020non-null float64ma2020non-null float64v_ma520non-null float64v_ma1020non-null float64v_ma2020non-null float64turnover20non-null float64dtypes:float64(14)memory usage:2.3KB 在观察每一列的名称时，我们发现’open’的列名前面似乎与其它列名不太一样，为了更清楚地查看，使用.columns得到该数据所有的列名如下： 1 stock.columns 1234 Index([&#39; open&#39;,&#39;high&#39;,&#39;close&#39;,&#39;low&#39;,&#39;volume&#39;,&#39;price_change&#39;,&#39;p_change&#39;,&#39;ma5&#39;,&#39;ma10&#39;,&#39;ma20&#39;,&#39;v_ma5&#39;,&#39;v_ma10&#39;,&#39;v_ma20&#39;,&#39;turnover&#39;],dtype=&#39;object&#39;) 于是发现’open’列名前存在多余的空格，我们使用如下方法修正列名。 1 stock.rename(columns={&#39; open&#39;:&#39;open&#39;},inplace=True) 至此，我们完成了股票数据的导入和清洗工作，接下来将使用可视化的方法来观察这些数据。 数据观察 首先，我们观察数据的列名，其含义对应如下： open high colse low volume price_change p_change 开盘价 最高价 收盘价 最低价 成交量 价格变动 涨跌幅 ma5 ma10 ma20 v_ma5 v_ma10 v_ma20 turnover 5日均价 10日均价 20日均价 5日均量 10日均量 20日均量 换手率 这些指标总体可分为两类： 价格相关指标 当日价格：开盘、收盘价，最高、最低价 价格变化：价格变动和涨跌幅 均价：5、10、20日均价 成交量相关指标 成交量 换手率：成交量/发行总股数×100% 成交量均量：5、10、20日均量 由于这些指标都是随时间变化的，所以让我们先来观察它们的时间序列图。 相对变化量 股票中关注的不是价格的绝对值，而是相对变化量。有多种方式可以衡量股价的相对值，最简单的方法就是将股价除以初始时的价格。 12 stock[&#39;return&#39;]=stock[&#39;close&#39;]/stock.close.iloc[0]stock[&#39;return&#39;].plot(grid=True) 第二种方法是计算每天的涨跌幅，但计算方式有两种： 这两者可能导致不同的分析结果，样例数据中的涨跌幅使用的是第一个公式，并乘上了100%。 1 stock[&#39;p_change&#39;].plot(grid=True).axhline(y=0,color=&#39;black&#39;,lw=2) 为了解决第二种方法中的两难选择，我们引入第三种方法，就是计算价格的对数之差，公式如下： 123 close_price=stock[&#39;close&#39;]log_change=np.log(close_price)-np.log(close_price.shift(1))log_change.plot(grid=True).axhline(y=0,color=&#39;black&#39;,lw=2) K线图 相传K线图起源于日本德川幕府时代，当时的商人用此图来记录米市的行情和价格波动，后来K线图被引入到股票市场。每天的四项指标数据用如下蜡烛形状的图形来记录，不同的颜色代表涨跌情况。 图片来源：http://wiki.mbalib.com/wiki/K线理论 Matplotlib.finance模块提供了绘制K线图的函数candlestick_ohlc()，但如果要绘制比较美观的K线图还是要下点功夫的。下面定义了pandas_candlestick_ohlc()函数来绘制适用于本文数据的K线图，其中大部分代码都是在设置坐标轴的格式。 Python 123456789101112131415161718192021222324252627282930313233343536373839 frommatplotlib.finance importcandlestick_ohlcfrommatplotlib.dates importDateFormatter,WeekdayLocator,DayLocator,MONDAYdefpandas_candlestick_ohlc(stock_data,otherseries=None):# 设置绘图参数，主要是坐标轴mondays=WeekdayLocator(MONDAY)alldays=DayLocator()dayFormatter=DateFormatter(&#39;%d&#39;)fig,ax=plt.subplots()fig.subplots_adjust(bottom=0.2)ifstock_data.index[-1]-stock_data.index[0]&lt;pd.Timedelta(&#39;730 days&#39;):weekFormatter=DateFormatter(&#39;%b %d&#39;)ax.xaxis.set_major_locator(mondays)ax.xaxis.set_minor_locator(alldays)else:weekFormatter=DateFormatter(&#39;%b %d, %Y&#39;)ax.xaxis.set_major_formatter(weekFormatter)ax.grid(True)# 创建K线图stock_array=np.array(stock_data.reset_index()[[&#39;date&#39;,&#39;open&#39;,&#39;high&#39;,&#39;low&#39;,&#39;close&#39;]])stock_array[:,0]=date2num(stock_array[:,0])candlestick_ohlc(ax,stock_array,colorup=&quot;red&quot;,colordown=&quot;green&quot;,width=0.4)# 可同时绘制其他折线图ifotherseries isnotNone:foreach inotherseries:plt.plot(stock_data[each],label=each)plt.legend()ax.xaxis_date()ax.autoscale_view()plt.setp(plt.gca().get_xticklabels(),rotation=45,horizontalalignment=&#39;right&#39;)plt.show() 1 pandas_candlestick_ohlc(stock) 这里红色代表上涨，绿色代表下跌。 相关关系 在观察了价格的走势之后，我们来看看各指标之间的关系。下面挑选了部分代表性的指标，并使用pandas.scatter_matrix()函数，将各项指标数据两两关联做散点图，对角线是每个指标数据的直方图。 12 small=stock[[&#39;close&#39;,&#39;price_change&#39;,&#39;ma20&#39;,&#39;volume&#39;,&#39;v_ma20&#39;,&#39;turnover&#39;]]_=pd.scatter_matrix(small) 图中可以明显发现成交量（volume）和换手率（turnover）有非常明显的线性关系，其实换手率的定义就是：成交量除以发行总股数，再乘以100%。所以下面的分析中我们将换手率指标去除，这里使用了相关性关系来实现数据降维。 上面的散点图看着有些眼花缭乱，我们可以使用numpy.corrcof()来直接计算各指标数据间的相关系数。 123 small=stock[[&#39;close&#39;,&#39;price_change&#39;,&#39;ma20&#39;,&#39;volume&#39;,&#39;v_ma20&#39;]]cov=np.corrcoef(small.T)cov 12345 array([[1.,0.30308764,0.10785519,0.91078009,-0.37602193],[0.30308764,1.,-0.45849273,0.3721832,-0.25950305],[0.10785519,-0.45849273,1.,-0.06002202,0.51793654],[0.91078009,0.3721832,-0.06002202,1.,-0.37617624],[-0.37602193,-0.25950305,0.51793654,-0.37617624,1.]]) 如果觉得看数字还是不够方便，我们继续将上述相关性矩阵转换成图形，如下图所示，其中用颜色来代表相关系数。我们发现位于（0，3）位置的相关系数非常大，查看数值达到0.91。这两个强烈正相关的指标是收盘价和成交量。 123 img=plt.matshow(cov,cmap=plt.cm.winter)plt.colorbar(img,ticks=[-1,0,1])plt.show() 以上我们用矩阵图表的方式在多个指标中迅速找到了强相关的指标。接着做出收盘价和成交量的折线图，因为它们的数值差异很大，所以我们采用两套纵坐标体系来做图。 1 stock[[&#39;close&#39;,&#39;volume&#39;]].plot(secondary_y=&#39;volume&#39;,grid=True) 观察这两个指标的走势，在大部分时候股价上涨，成交量也上涨，反之亦然。但个别情况下则不成立，可能是成交量受到前期的惯性影响，或者还有其他因素。 区块链】中国区块链研究全球领先 有待龙头技术企业崛起 近日，IPRdaily中文网与incoPat创新指数研究中心联合发布“2017全球区块链企业专利排行榜（前100名）”显示，中国在区块链研究方面全球领先。 “区块链技术要大规模发展，在底层技术上还要进一步发展，就像移动互联网一样，它就有IOS和安卓两套强大的基础系统。虽然区块链的基础技术研究投入很多，但目前许多研发团队都是各自为战，还未有真正的龙头技术企业崛起。” 未来发展或是局部突破 基于政策鼓励，区块链行业如今迎来了快速发展的风口，各类区块链公司如雨后春笋般纷纷借力生长。同时，区块链概念股开始集体大涨。暴风集团、美图、迅雷等上市公司趁机搭上区块链的风口，其中大多数公司连业务还未落地，股价就已“起飞”。 不久前，真格基金掌舵者徐小平在其内部微信群中表示，“区块链革命已经到来，这是一场顺之者昌、逆之者亡的伟大技术革命。要主动拥抱区块链技术，不要临渊羡鱼，也不要隔岸观火，要冲到这个行业里面去，赶紧研究赶紧行动。” 不过，在众多业内人士看来，目前区块链技术的发展仍然处于初期阶段，它的去中心化特点涉及对传统商业逻辑的颠覆，并非朝夕之间就能实现。余林民向记者表示，“我觉得，区块链要像互联网一样改变人类的生活，需要比较长的时间。未来区块链应用最可能的发展，还是先在局部获得突破。” 2月6日，一份名为《2017全球区块链企业专利排行榜》，让国内BAT的区块链势能浮出水面。前100名中，中国入榜的企业占比49%，其次才是美国，占比33%；其中国内阿里巴巴以49件的总量排名第一，腾讯科技为11件。 这份报告，让阿里在区块链上的占位一时风头无两。阿里巴巴集团学术委员会主席曾鸣此前谈及阿里巴巴的区块链之路时称，早在2015年蚂蚁金服内部便形成一个区块链兴趣小组，2016年开始在公益项目上做尝试。截至目前，阿里的区块链围绕着其电商和新零售业务的优势，布局已经涉及公益、商品溯源、租房场景等领域。 阅读更多","@type":"BlogPosting","url":"/2018/03/23/ba39cce9e652d27a088eeedb153a5901.html","headline":"Python抓取股票数据，如何用python编程赚取第一桶金？","dateModified":"2018-03-23T00:00:00+08:00","datePublished":"2018-03-23T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/03/23/ba39cce9e652d27a088eeedb153a5901.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>Python抓取股票数据，如何用python编程赚取第一桶金？</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/4e740001d8a08b7f90c9" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Python开发的一个快速,高层次的屏幕抓取和web抓取框架，用于抓取web站点并从页面中提取结构化的数据。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试。<br></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Scrapy吸引人的地方在于它是一个框架，任何人都可以根据需求方便的修改。它也提供了多种类型爬虫的基类，如BaseSpider、sitemap爬虫等，最新版本又提供了web2.0爬虫的支持。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Scratch，是抓取的意思，这个Python的爬虫框架叫Scrapy，大概也是这个意思吧，就叫它：小刮刮吧。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">这里还是要推荐下小编的Python学习群:483546416，不管你是小白还是大牛，小编我都欢迎，不定期分享干货，包括小编自己整理的一份2017最新的Python资料和0基础入门教程，欢迎初学和进阶中的小伙伴。在不忙的时间我会给大家解惑。<br></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Scrapy 使用了 Twisted异步网络库来处理网络通讯。整体架构大致如下</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/1521797061969edfe0cc94e" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <ul class="list-paddingleft-2" style="list-style:square outside;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">
   <li style="margin-left:0px;list-style:inherit;"><p><span style="font-weight:700;">爬虫(Spiders)</span></p><p>爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面</p><p>下面用python用Python来可视化股票数据，比如绘制K线图，并且探究各项指标的含义和关系最后使用移动平均线方法初探投资策略。</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>数据导入</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>这里将股票数据存储在<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">stockData.txt</code>文本文件中，我们使用<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">pandas.read_table()</code>函数将文件数据读入成DataFrame格式。</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>其中参数<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">usecols=range(15)</code>限制只读取前15列数据，<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">parse_dates=[0]</code>表示将第一列数据解析成时间格式，<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">index_col=0</code>则将第一列数据指定为索引。</p></li>
  </ul>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">其中参数<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">usecols=range(15)</code>限制只读取前15列数据，<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">parse_dates=[0]</code>表示将第一列数据解析成时间格式，<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">index_col=0</code>则将第一列数据指定为索引。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>import pandas aspd</p><p>import numpy asnp</p><p>import matplotlib.pyplot asplt</p><p>%matplotlibinline</p><p>%configInlineBackend.figure_format='retina'</p><p>%pylabinline</p><p>pylab.rcParams['figure.figsize']=(10,6)#设置绘图尺寸</p><p>#读取数据</p><p>stock=pd.read_table('stockData.txt',usecols=range(15),parse_dates=[0],index_col=0)</p><p>stock=stock[::-1]#逆序排列</p><p>stock.head()</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/15217965414611aa47b5aa5" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">以上显示了前5行数据，要得到数据的更多信息，可以使用<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">.info()</code>方法。它告诉我们该数据一共有20行，索引是时间格式，日期从2015年1月5日到2015年1月30日。总共有14列，并列出了每一列的名称和数据格式，并且没有缺失值。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>stock.info()</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Python</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>&lt;class'pandas.core.frame.DataFrame'&gt;</p><p>DatetimeIndex:20entries,2015-01-05to2015-01-30</p><p>Data columns(total14columns):</p><p>open20non-null float64</p><p>high20non-null float64</p><p>close20non-null float64</p><p>low20non-null float64</p><p>volume20non-null float64</p><p>price_change20non-null float64</p><p>p_change20non-null float64</p><p>ma520non-null float64</p><p>ma1020non-null float64</p><p>ma2020non-null float64</p><p>v_ma520non-null float64</p><p>v_ma1020non-null float64</p><p>v_ma2020non-null float64</p><p>turnover20non-null float64</p><p>dtypes:float64(14)</p><p>memory usage:2.3KB</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">在观察每一列的名称时，我们发现’open’的列名前面似乎与其它列名不太一样，为了更清楚地查看，使用<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">.columns</code>得到该数据所有的列名如下：</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>stock.columns</p></td>
    </tr>
   </tbody>
  </table>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p><p>4</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>Index([' open','high','close','low','volume','price_change',</p><p>'p_change','ma5','ma10','ma20','v_ma5','v_ma10','v_ma20',</p><p>'turnover'],</p><p>dtype='object')</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">于是发现’open’列名前存在多余的空格，我们使用如下方法修正列名。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>stock.rename(columns={' open':'open'},inplace=True)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">至此，我们完成了股票数据的导入和清洗工作，接下来将使用可视化的方法来观察这些数据。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">数据观察</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">首先，我们观察数据的列名，其含义对应如下：</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <thead>
    <tr class="firstRow">
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">open</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">high</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">colse</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">low</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">volume</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">price_change</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">p_change</th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">开盘价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">最高价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">收盘价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">最低价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">成交量</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">价格变动</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">涨跌幅</td>
    </tr>
   </tbody>
  </table>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <thead>
    <tr class="firstRow">
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">ma5</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">ma10</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">ma20</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">v_ma5</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">v_ma10</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">v_ma20</th>
     <th style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);font-weight:400;background-color:rgb(244,245,247);">turnover</th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">5日均价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">10日均价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">20日均价</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">5日均量</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">10日均量</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">20日均量</td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);">换手率</td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">这些指标总体可分为两类：</p>
  <blockquote style="line-height:1.5;color:rgb(153,153,153);background:rgb(244,245,246);border:1px solid rgb(232,232,232);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <ul class="list-paddingleft-2" style="list-style:square outside;color:rgb(34,34,34);">
    <li style="margin-left:0px;list-style:inherit;"><p>价格相关指标</p></li>
   </ul>
  </blockquote>
  <ul class="list-paddingleft-2" style="list-style:square outside;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">
   <li style="margin-left:0px;list-style:inherit;"><p>当日价格：开盘、收盘价，最高、最低价</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>价格变化：价格变动和涨跌幅</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>均价：5、10、20日均价</p></li>
  </ul>
  <blockquote style="line-height:1.5;color:rgb(153,153,153);background:rgb(244,245,246);border:1px solid rgb(232,232,232);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <ul class="list-paddingleft-2" style="list-style:square outside;color:rgb(34,34,34);">
    <li style="margin-left:0px;list-style:inherit;"><p>成交量相关指标</p></li>
   </ul>
  </blockquote>
  <ul class="list-paddingleft-2" style="list-style:square outside;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">
   <li style="margin-left:0px;list-style:inherit;"><p>成交量</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>换手率：成交量/发行总股数×100%</p></li>
   <li style="margin-left:0px;list-style:inherit;"><p>成交量均量：5、10、20日均量</p></li>
  </ul>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">由于这些指标都是随时间变化的，所以让我们先来观察它们的时间序列图。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><span style="font-weight:700;">相对变化量</span></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">股票中关注的不是价格的绝对值，而是相对变化量。有多种方式可以衡量股价的相对值，最简单的方法就是将股价除以初始时的价格。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/152179657732097c18419d2" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>stock['return']=stock['close']/stock.close.iloc[0]</p><p>stock['return'].plot(grid=True)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/15217965773528245b7811b" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">第二种方法是计算每天的涨跌幅，但计算方式有两种：</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/1521796577344c337352f06" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">这两者可能导致不同的分析结果，样例数据中的涨跌幅使用的是第一个公式，并乘上了100%。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/1521797360305121659f559" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>stock['p_change'].plot(grid=True).axhline(y=0,color='black',lw=2)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/15217965773511489156b54" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">为了解决第二种方法中的两难选择，我们引入第三种方法，就是计算价格的对数之差，公式如下：</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/1521796577349ae7eabf294" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>close_price=stock['close']</p><p>log_change=np.log(close_price)-np.log(close_price.shift(1))</p><p>log_change.plot(grid=True).axhline(y=0,color='black',lw=2)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p9.pstatp.com/large/pgc-image/15217965773602352bdbf1e" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><span style="font-weight:700;">K线图</span></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">相传K线图起源于日本德川幕府时代，当时的商人用此图来记录米市的行情和价格波动，后来K线图被引入到股票市场。每天的四项指标数据用如下蜡烛形状的图形来记录，不同的颜色代表涨跌情况。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/15217966045929eb9ca19f1" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">图片来源：http://wiki.mbalib.com/wiki/K线理论</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Matplotlib.finance模块提供了绘制K线图的函数<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">candlestick_ohlc()</code>，但如果要绘制比较美观的K线图还是要下点功夫的。下面定义了<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">pandas_candlestick_ohlc()</code>函数来绘制适用于本文数据的K线图，其中大部分代码都是在设置坐标轴的格式。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">Python</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>frommatplotlib.finance importcandlestick_ohlc</p><p>frommatplotlib.dates importDateFormatter,WeekdayLocator,DayLocator,MONDAY</p><p>defpandas_candlestick_ohlc(stock_data,otherseries=None):</p><p># 设置绘图参数，主要是坐标轴</p><p>mondays=WeekdayLocator(MONDAY)</p><p>alldays=DayLocator()</p><p>dayFormatter=DateFormatter('%d')</p><p>fig,ax=plt.subplots()</p><p>fig.subplots_adjust(bottom=0.2)</p><p>ifstock_data.index[-1]-stock_data.index[0]&lt;pd.Timedelta('730 days'):</p><p>weekFormatter=DateFormatter('%b %d')</p><p>ax.xaxis.set_major_locator(mondays)</p><p>ax.xaxis.set_minor_locator(alldays)</p><p>else:</p><p>weekFormatter=DateFormatter('%b %d, %Y')</p><p>ax.xaxis.set_major_formatter(weekFormatter)</p><p>ax.grid(True)</p><p># 创建K线图</p><p>stock_array=np.array(stock_data.reset_index()[['date','open','high','low','close']])</p><p>stock_array[:,0]=date2num(stock_array[:,0])</p><p>candlestick_ohlc(ax,stock_array,colorup="red",colordown="green",width=0.4)</p><p># 可同时绘制其他折线图</p><p>ifotherseries isnotNone:</p><p>foreach inotherseries:</p><p>plt.plot(stock_data[each],label=each)</p><p>plt.legend()</p><p>ax.xaxis_date()</p><p>ax.autoscale_view()</p><p>plt.setp(plt.gca().get_xticklabels(),rotation=45,horizontalalignment='right')</p><p>plt.show()</p></td>
    </tr>
   </tbody>
  </table>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>pandas_candlestick_ohlc(stock)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/1521796604616429dae3682" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">这里红色代表上涨，绿色代表下跌。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">相关关系</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">在观察了价格的走势之后，我们来看看各指标之间的关系。下面挑选了部分代表性的指标，并使用<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">pandas.scatter_matrix()</code>函数，将各项指标数据两两关联做散点图，对角线是每个指标数据的直方图。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>small=stock[['close','price_change','ma20','volume','v_ma20','turnover']]</p><p>_=pd.scatter_matrix(small)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/15217966334480bb0899064" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">图中可以明显发现成交量（volume）和换手率（turnover）有非常明显的线性关系，其实换手率的定义就是：成交量除以发行总股数，再乘以100%。所以下面的分析中我们将换手率指标去除，这里使用了相关性关系来实现数据降维。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">上面的散点图看着有些眼花缭乱，我们可以使用<code style="font-family:Consolas, Menlo, Courier, monospace;font-size:1em;">numpy.corrcof()</code>来直接计算各指标数据间的相关系数。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>small=stock[['close','price_change','ma20','volume','v_ma20']]</p><p>cov=np.corrcoef(small.T)</p><p>cov</p></td>
    </tr>
   </tbody>
  </table>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>array([[1.,0.30308764,0.10785519,0.91078009,-0.37602193],</p><p>[0.30308764,1.,-0.45849273,0.3721832,-0.25950305],</p><p>[0.10785519,-0.45849273,1.,-0.06002202,0.51793654],</p><p>[0.91078009,0.3721832,-0.06002202,1.,-0.37617624],</p><p>[-0.37602193,-0.25950305,0.51793654,-0.37617624,1.]])</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">如果觉得看数字还是不够方便，我们继续将上述相关性矩阵转换成图形，如下图所示，其中用颜色来代表相关系数。我们发现位于（0，3）位置的相关系数非常大，查看数值达到0.91。这两个强烈正相关的指标是收盘价和成交量。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p><p>2</p><p>3</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>img=plt.matshow(cov,cmap=plt.cm.winter)</p><p>plt.colorbar(img,ticks=[-1,0,1])</p><p>plt.show()</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/152179663356641cbcc9cdb" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">以上我们用矩阵图表的方式在多个指标中迅速找到了强相关的指标。接着做出收盘价和成交量的折线图，因为它们的数值差异很大，所以我们采用两套纵坐标体系来做图。</p>
  <table style="width:660px;border-spacing:0px;background-color:rgb(255,255,255);font-size:16px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;">
   <tbody>
    <tr class="firstRow">
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>1</p></td>
     <td style="vertical-align:top;border-color:rgb(238,238,238);color:rgb(101,107,121);"><p>stock[['close','volume']].plot(secondary_y='volume',grid=True)</p></td>
    </tr>
   </tbody>
  </table>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/15217966335152d48dcb2a3" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">观察这两个指标的走势，在大部分时候股价上涨，成交量也上涨，反之亦然。但个别情况下则不成立，可能是成交量受到前期的惯性影响，或者还有其他因素。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p1.pstatp.com/large/pgc-image/15217973938781081765c75" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <h1 style="font-size:24px;line-height:32px;color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">区块链】中国区块链研究全球领先 有待龙头技术企业崛起</h1>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">近日，IPRdaily中文网与incoPat创新指数研究中心联合发布“2017全球区块链企业专利排行榜（前100名）”显示，中国在区块链研究方面全球领先。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">“区块链技术要大规模发展，在底层技术上还要进一步发展，就像移动互联网一样，它就有IOS和安卓两套强大的基础系统。虽然区块链的基础技术研究投入很多，但目前许多研发团队都是各自为战，还未有真正的龙头技术企业崛起。”</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><span style="font-weight:700;">未来发展或是局部突破</span></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">基于政策鼓励，区块链行业如今迎来了快速发展的风口，各类区块链公司如雨后春笋般纷纷借力生长。同时，区块链概念股开始集体大涨。暴风集团、美图、迅雷等上市公司趁机搭上区块链的风口，其中大多数公司连业务还未落地，股价就已“起飞”。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">不久前，真格基金掌舵者徐小平在其内部微信群中表示，“区块链革命已经到来，这是一场顺之者昌、逆之者亡的伟大技术革命。要主动拥抱区块链技术，不要临渊羡鱼，也不要隔岸观火，要冲到这个行业里面去，赶紧研究赶紧行动。”</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);"><img src="http://p3.pstatp.com/large/pgc-image/1521797422807bd704eb3de" alt="Python抓取股票数据，如何用python编程赚取第一桶金？" style="border-style:none;"></p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">不过，在众多业内人士看来，目前区块链技术的发展仍然处于初期阶段，它的去中心化特点涉及对传统商业逻辑的颠覆，并非朝夕之间就能实现。余林民向记者表示，“我觉得，区块链要像互联网一样改变人类的生活，需要比较长的时间。未来区块链应用最可能的发展，还是先在局部获得突破。”</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">2月6日，一份名为《2017全球区块链企业专利排行榜》，让国内BAT的区块链势能浮出水面。前100名中，中国入榜的企业占比49%，其次才是美国，占比33%；其中国内阿里巴巴以49件的总量排名第一，腾讯科技为11件。</p>
  <p style="color:rgb(34,34,34);font-family:'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', 'Helvetica Neue', Arial, sans-serif;background-color:rgb(255,255,255);">这份报告，让阿里在区块链上的占位一时风头无两。阿里巴巴集团学术委员会主席曾鸣此前谈及阿里巴巴的区块链之路时称，早在2015年蚂蚁金服内部便形成一个区块链兴趣小组，2016年开始在公益项目上做尝试。截至目前，阿里的区块链围绕着其电商和新零售业务的优势，布局已经涉及公益、商品溯源、租房场景等领域。</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/qq_41396296/article/details/79671508,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/qq_41396296/article/details/79671508,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
