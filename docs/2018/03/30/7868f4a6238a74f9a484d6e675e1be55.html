<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>(三) 区块链数据结构 – 交易 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="(三) 区块链数据结构 – 交易" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="区块由交易组成。区块体中包含若干项交易数据。 交易 交易主要包含两类数据：交易输入和交易输出。- 交易输入用来指明钱的来源- 交易输出用来指明钱的去向 除了交易输入和交易输出外，交易中还包含版本号和锁定时间。交易数据的存储结构如下： 交易对象中的各个字段含义如下： 字段 大小 描述 version 4个字节 明确该笔交易参考的版本规则 numInputs 1-9个字节 交易中包含的输入数量 inputs 不定长 交易中包含的输入数据 numOutputs 1-9个字节 交易中包含的输出数量 outputs 不定长 交易中包含的输出数据 lockTime 4个字节 交易锁定时间 注：如果锁定时间为0，代表立即执行，无需锁定。如果该值小于5亿，则代表区块链到达该高度前，交易不会被执行，如果该值大于5亿，则该值代表Unix纪元时间戳，交易在该时间之后执行。 核心代码 - 变量定义 // These are bitcoin serialized. private long version; //交易遵循的版本号 private ArrayList&lt;TransactionInput&gt; inputs; //交易的金钱来源 private ArrayList&lt;TransactionOutput&gt; outputs; //交易的金钱去向 private long lockTime; //交易的锁定时间 核心代码 - 数据解析 //解析区块原始字节数据，构造交易对象 @Override protected void parse() throws ProtocolException { cursor = offset; version = readUint32(); //读取版本号 optimalEncodingMessageSize = 4; // First come the inputs. long numInputs = readVarInt(); //读取输入交易量 optimalEncodingMessageSize += VarInt.sizeOf(numInputs); inputs = new ArrayList&lt;&gt;((int) numInputs); //逐一解析输入交易对象 for (long i = 0; i &lt; numInputs; i++) { //构造输入交易对象 TransactionInput input = new TransactionInput(params, this, payload, cursor, serializer); inputs.add(input); long scriptLen = readVarInt(TransactionOutPoint.MESSAGE_LENGTH); optimalEncodingMessageSize += TransactionOutPoint.MESSAGE_LENGTH + VarInt.sizeOf(scriptLen) + scriptLen + 4; cursor += scriptLen + 4; } // Now the outputs long numOutputs = readVarInt(); //读取输出交易量 optimalEncodingMessageSize += VarInt.sizeOf(numOutputs); outputs = new ArrayList&lt;&gt;((int) numOutputs); //逐一解析输出交易对象 for (long i = 0; i &lt; numOutputs; i++) { //构造输出交易对象 TransactionOutput output = new TransactionOutput(params, this, payload, cursor, serializer); outputs.add(output); long scriptLen = readVarInt(8); optimalEncodingMessageSize += 8 + VarInt.sizeOf(scriptLen) + scriptLen; cursor += scriptLen; } lockTime = readUint32(); optimalEncodingMessageSize += 4; length = cursor - offset; } 交易输入 交易输入指明了交易的金钱来源。在比特币系统中，交易的金钱来源，并不来自于某一特定账户，而来自于其他人的输出。比如A和B分别转给C一笔金钱，则当C向D支付时，需要用A和B的输出作为输入。 交易输入中，存储了其关联的交易输出指针，同时还存储了该输出的解锁脚本。 交易输入结构如下： 交易输入中，各个字段的含义如下： 字段 大小 描述 hash 32个字节 关联输出所在的交易Hash地址 index 4个字节 关联输出在其交易输出集合中的索引 scriptLen 1-9个字节 解锁脚本长度 scriptBytes 不定长 解锁脚本数据 sequence 4个字节 序列号，暂未使用 注：只有解锁脚本正确，才能对输出进行消费。解锁脚本需要使用当前用户的秘钥进行签名，因此只有当前用户，能使用别人来的输出。 核心代码 - 变量定义 // Allows for altering transactions after they were broadcast. Values below NO_SEQUENCE-1 mean it can be altered. private long sequence; // Data needed to connect to the output of the transaction we&#39;re gathering coins from. //关联的交易输出 private TransactionOutPoint outpoint; // The &quot;script bytes&quot; might not actually be a script. In coinbase transactions where new coins are minted there // is no input transaction, so instead the scriptBytes contains some extra stuff (like a rollover nonce) that we // don&#39;t care about much. The bytes are turned into a Script object (cached below) on demand via a getter. // 脚本字节数组可能并不是实际的脚本，在创世区块中，没有输入交易，该字段可能存储其他数据。正常情况下，该数据会转换成脚本对象 private byte[] scriptBytes; 核心代码 - 数据解析 //通过区块的原始字节数据，构造输入交易对象 @Override protected void parse() throws ProtocolException { //构造该输入交易对应的输出(接收地址) //解析数据时，会解析出对应输出所在交易的Hash地址以及交易输出对应的索引值 outpoint = new TransactionOutPoint(params, payload, cursor, this, serializer); cursor += outpoint.getMessageSize(); int scriptLen = (int) readVarInt(); //读取脚本长度 length = cursor - offset + scriptLen + 4; scriptBytes = readBytes(scriptLen); //读取解锁脚本数据 sequence = readUint32(); //序列号，目前未使用 } 交易输出 交易输出指明了钱的去向，拥有该输出，并用私钥解密后，方可作为其他交易的输入，进行消费。 交易输出中，存储了支付的金额以及锁定脚本。交易输出的存储结构如下： 交易输出中，各个字段含义如下： 字段 大小 描述 value 8个字节 支付金额（单位为聪） scriptLen 1-9个字节 锁定脚本长度 scriptBytes 1-9个字节 锁定脚本数据 注：只有接收者，通过秘钥加密生成解锁脚本后，方可继续使用该输出作为输入，继续消费。 核心代码 - 变量定义 // The output&#39;s value is kept as a native type in order to save class instances. //支付金额 private long value; // A transaction output has a script used for authenticating that the redeemer is allowed to spend // this output. //锁定脚本 private byte[] scriptBytes; 核心代码 - 数据解析 //解析交易输出数据，包含输出金额和锁定脚本(接收者可以解锁该脚本) @Override protected void parse() throws ProtocolException { value = readInt64(); //获取交易输出的金额 scriptLen = (int) readVarInt(); //锁定脚本的长度 length = cursor - offset + scriptLen; scriptBytes = readBytes(scriptLen); //锁定脚本的内容 } 上一篇：(二) 区块链数据结构-区块 下一篇：(四) 区块链数据结构 – 脚本 阅读更多" />
<meta property="og:description" content="区块由交易组成。区块体中包含若干项交易数据。 交易 交易主要包含两类数据：交易输入和交易输出。- 交易输入用来指明钱的来源- 交易输出用来指明钱的去向 除了交易输入和交易输出外，交易中还包含版本号和锁定时间。交易数据的存储结构如下： 交易对象中的各个字段含义如下： 字段 大小 描述 version 4个字节 明确该笔交易参考的版本规则 numInputs 1-9个字节 交易中包含的输入数量 inputs 不定长 交易中包含的输入数据 numOutputs 1-9个字节 交易中包含的输出数量 outputs 不定长 交易中包含的输出数据 lockTime 4个字节 交易锁定时间 注：如果锁定时间为0，代表立即执行，无需锁定。如果该值小于5亿，则代表区块链到达该高度前，交易不会被执行，如果该值大于5亿，则该值代表Unix纪元时间戳，交易在该时间之后执行。 核心代码 - 变量定义 // These are bitcoin serialized. private long version; //交易遵循的版本号 private ArrayList&lt;TransactionInput&gt; inputs; //交易的金钱来源 private ArrayList&lt;TransactionOutput&gt; outputs; //交易的金钱去向 private long lockTime; //交易的锁定时间 核心代码 - 数据解析 //解析区块原始字节数据，构造交易对象 @Override protected void parse() throws ProtocolException { cursor = offset; version = readUint32(); //读取版本号 optimalEncodingMessageSize = 4; // First come the inputs. long numInputs = readVarInt(); //读取输入交易量 optimalEncodingMessageSize += VarInt.sizeOf(numInputs); inputs = new ArrayList&lt;&gt;((int) numInputs); //逐一解析输入交易对象 for (long i = 0; i &lt; numInputs; i++) { //构造输入交易对象 TransactionInput input = new TransactionInput(params, this, payload, cursor, serializer); inputs.add(input); long scriptLen = readVarInt(TransactionOutPoint.MESSAGE_LENGTH); optimalEncodingMessageSize += TransactionOutPoint.MESSAGE_LENGTH + VarInt.sizeOf(scriptLen) + scriptLen + 4; cursor += scriptLen + 4; } // Now the outputs long numOutputs = readVarInt(); //读取输出交易量 optimalEncodingMessageSize += VarInt.sizeOf(numOutputs); outputs = new ArrayList&lt;&gt;((int) numOutputs); //逐一解析输出交易对象 for (long i = 0; i &lt; numOutputs; i++) { //构造输出交易对象 TransactionOutput output = new TransactionOutput(params, this, payload, cursor, serializer); outputs.add(output); long scriptLen = readVarInt(8); optimalEncodingMessageSize += 8 + VarInt.sizeOf(scriptLen) + scriptLen; cursor += scriptLen; } lockTime = readUint32(); optimalEncodingMessageSize += 4; length = cursor - offset; } 交易输入 交易输入指明了交易的金钱来源。在比特币系统中，交易的金钱来源，并不来自于某一特定账户，而来自于其他人的输出。比如A和B分别转给C一笔金钱，则当C向D支付时，需要用A和B的输出作为输入。 交易输入中，存储了其关联的交易输出指针，同时还存储了该输出的解锁脚本。 交易输入结构如下： 交易输入中，各个字段的含义如下： 字段 大小 描述 hash 32个字节 关联输出所在的交易Hash地址 index 4个字节 关联输出在其交易输出集合中的索引 scriptLen 1-9个字节 解锁脚本长度 scriptBytes 不定长 解锁脚本数据 sequence 4个字节 序列号，暂未使用 注：只有解锁脚本正确，才能对输出进行消费。解锁脚本需要使用当前用户的秘钥进行签名，因此只有当前用户，能使用别人来的输出。 核心代码 - 变量定义 // Allows for altering transactions after they were broadcast. Values below NO_SEQUENCE-1 mean it can be altered. private long sequence; // Data needed to connect to the output of the transaction we&#39;re gathering coins from. //关联的交易输出 private TransactionOutPoint outpoint; // The &quot;script bytes&quot; might not actually be a script. In coinbase transactions where new coins are minted there // is no input transaction, so instead the scriptBytes contains some extra stuff (like a rollover nonce) that we // don&#39;t care about much. The bytes are turned into a Script object (cached below) on demand via a getter. // 脚本字节数组可能并不是实际的脚本，在创世区块中，没有输入交易，该字段可能存储其他数据。正常情况下，该数据会转换成脚本对象 private byte[] scriptBytes; 核心代码 - 数据解析 //通过区块的原始字节数据，构造输入交易对象 @Override protected void parse() throws ProtocolException { //构造该输入交易对应的输出(接收地址) //解析数据时，会解析出对应输出所在交易的Hash地址以及交易输出对应的索引值 outpoint = new TransactionOutPoint(params, payload, cursor, this, serializer); cursor += outpoint.getMessageSize(); int scriptLen = (int) readVarInt(); //读取脚本长度 length = cursor - offset + scriptLen + 4; scriptBytes = readBytes(scriptLen); //读取解锁脚本数据 sequence = readUint32(); //序列号，目前未使用 } 交易输出 交易输出指明了钱的去向，拥有该输出，并用私钥解密后，方可作为其他交易的输入，进行消费。 交易输出中，存储了支付的金额以及锁定脚本。交易输出的存储结构如下： 交易输出中，各个字段含义如下： 字段 大小 描述 value 8个字节 支付金额（单位为聪） scriptLen 1-9个字节 锁定脚本长度 scriptBytes 1-9个字节 锁定脚本数据 注：只有接收者，通过秘钥加密生成解锁脚本后，方可继续使用该输出作为输入，继续消费。 核心代码 - 变量定义 // The output&#39;s value is kept as a native type in order to save class instances. //支付金额 private long value; // A transaction output has a script used for authenticating that the redeemer is allowed to spend // this output. //锁定脚本 private byte[] scriptBytes; 核心代码 - 数据解析 //解析交易输出数据，包含输出金额和锁定脚本(接收者可以解锁该脚本) @Override protected void parse() throws ProtocolException { value = readInt64(); //获取交易输出的金额 scriptLen = (int) readVarInt(); //锁定脚本的长度 length = cursor - offset + scriptLen; scriptBytes = readBytes(scriptLen); //锁定脚本的内容 } 上一篇：(二) 区块链数据结构-区块 下一篇：(四) 区块链数据结构 – 脚本 阅读更多" />
<link rel="canonical" href="https://mlh.app/2018/03/30/7868f4a6238a74f9a484d6e675e1be55.html" />
<meta property="og:url" content="https://mlh.app/2018/03/30/7868f4a6238a74f9a484d6e675e1be55.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-30T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"区块由交易组成。区块体中包含若干项交易数据。 交易 交易主要包含两类数据：交易输入和交易输出。- 交易输入用来指明钱的来源- 交易输出用来指明钱的去向 除了交易输入和交易输出外，交易中还包含版本号和锁定时间。交易数据的存储结构如下： 交易对象中的各个字段含义如下： 字段 大小 描述 version 4个字节 明确该笔交易参考的版本规则 numInputs 1-9个字节 交易中包含的输入数量 inputs 不定长 交易中包含的输入数据 numOutputs 1-9个字节 交易中包含的输出数量 outputs 不定长 交易中包含的输出数据 lockTime 4个字节 交易锁定时间 注：如果锁定时间为0，代表立即执行，无需锁定。如果该值小于5亿，则代表区块链到达该高度前，交易不会被执行，如果该值大于5亿，则该值代表Unix纪元时间戳，交易在该时间之后执行。 核心代码 - 变量定义 // These are bitcoin serialized. private long version; //交易遵循的版本号 private ArrayList&lt;TransactionInput&gt; inputs; //交易的金钱来源 private ArrayList&lt;TransactionOutput&gt; outputs; //交易的金钱去向 private long lockTime; //交易的锁定时间 核心代码 - 数据解析 //解析区块原始字节数据，构造交易对象 @Override protected void parse() throws ProtocolException { cursor = offset; version = readUint32(); //读取版本号 optimalEncodingMessageSize = 4; // First come the inputs. long numInputs = readVarInt(); //读取输入交易量 optimalEncodingMessageSize += VarInt.sizeOf(numInputs); inputs = new ArrayList&lt;&gt;((int) numInputs); //逐一解析输入交易对象 for (long i = 0; i &lt; numInputs; i++) { //构造输入交易对象 TransactionInput input = new TransactionInput(params, this, payload, cursor, serializer); inputs.add(input); long scriptLen = readVarInt(TransactionOutPoint.MESSAGE_LENGTH); optimalEncodingMessageSize += TransactionOutPoint.MESSAGE_LENGTH + VarInt.sizeOf(scriptLen) + scriptLen + 4; cursor += scriptLen + 4; } // Now the outputs long numOutputs = readVarInt(); //读取输出交易量 optimalEncodingMessageSize += VarInt.sizeOf(numOutputs); outputs = new ArrayList&lt;&gt;((int) numOutputs); //逐一解析输出交易对象 for (long i = 0; i &lt; numOutputs; i++) { //构造输出交易对象 TransactionOutput output = new TransactionOutput(params, this, payload, cursor, serializer); outputs.add(output); long scriptLen = readVarInt(8); optimalEncodingMessageSize += 8 + VarInt.sizeOf(scriptLen) + scriptLen; cursor += scriptLen; } lockTime = readUint32(); optimalEncodingMessageSize += 4; length = cursor - offset; } 交易输入 交易输入指明了交易的金钱来源。在比特币系统中，交易的金钱来源，并不来自于某一特定账户，而来自于其他人的输出。比如A和B分别转给C一笔金钱，则当C向D支付时，需要用A和B的输出作为输入。 交易输入中，存储了其关联的交易输出指针，同时还存储了该输出的解锁脚本。 交易输入结构如下： 交易输入中，各个字段的含义如下： 字段 大小 描述 hash 32个字节 关联输出所在的交易Hash地址 index 4个字节 关联输出在其交易输出集合中的索引 scriptLen 1-9个字节 解锁脚本长度 scriptBytes 不定长 解锁脚本数据 sequence 4个字节 序列号，暂未使用 注：只有解锁脚本正确，才能对输出进行消费。解锁脚本需要使用当前用户的秘钥进行签名，因此只有当前用户，能使用别人来的输出。 核心代码 - 变量定义 // Allows for altering transactions after they were broadcast. Values below NO_SEQUENCE-1 mean it can be altered. private long sequence; // Data needed to connect to the output of the transaction we&#39;re gathering coins from. //关联的交易输出 private TransactionOutPoint outpoint; // The &quot;script bytes&quot; might not actually be a script. In coinbase transactions where new coins are minted there // is no input transaction, so instead the scriptBytes contains some extra stuff (like a rollover nonce) that we // don&#39;t care about much. The bytes are turned into a Script object (cached below) on demand via a getter. // 脚本字节数组可能并不是实际的脚本，在创世区块中，没有输入交易，该字段可能存储其他数据。正常情况下，该数据会转换成脚本对象 private byte[] scriptBytes; 核心代码 - 数据解析 //通过区块的原始字节数据，构造输入交易对象 @Override protected void parse() throws ProtocolException { //构造该输入交易对应的输出(接收地址) //解析数据时，会解析出对应输出所在交易的Hash地址以及交易输出对应的索引值 outpoint = new TransactionOutPoint(params, payload, cursor, this, serializer); cursor += outpoint.getMessageSize(); int scriptLen = (int) readVarInt(); //读取脚本长度 length = cursor - offset + scriptLen + 4; scriptBytes = readBytes(scriptLen); //读取解锁脚本数据 sequence = readUint32(); //序列号，目前未使用 } 交易输出 交易输出指明了钱的去向，拥有该输出，并用私钥解密后，方可作为其他交易的输入，进行消费。 交易输出中，存储了支付的金额以及锁定脚本。交易输出的存储结构如下： 交易输出中，各个字段含义如下： 字段 大小 描述 value 8个字节 支付金额（单位为聪） scriptLen 1-9个字节 锁定脚本长度 scriptBytes 1-9个字节 锁定脚本数据 注：只有接收者，通过秘钥加密生成解锁脚本后，方可继续使用该输出作为输入，继续消费。 核心代码 - 变量定义 // The output&#39;s value is kept as a native type in order to save class instances. //支付金额 private long value; // A transaction output has a script used for authenticating that the redeemer is allowed to spend // this output. //锁定脚本 private byte[] scriptBytes; 核心代码 - 数据解析 //解析交易输出数据，包含输出金额和锁定脚本(接收者可以解锁该脚本) @Override protected void parse() throws ProtocolException { value = readInt64(); //获取交易输出的金额 scriptLen = (int) readVarInt(); //锁定脚本的长度 length = cursor - offset + scriptLen; scriptBytes = readBytes(scriptLen); //锁定脚本的内容 } 上一篇：(二) 区块链数据结构-区块 下一篇：(四) 区块链数据结构 – 脚本 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2018/03/30/7868f4a6238a74f9a484d6e675e1be55.html","headline":"(三) 区块链数据结构 – 交易","dateModified":"2018-03-30T00:00:00+08:00","datePublished":"2018-03-30T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2018/03/30/7868f4a6238a74f9a484d6e675e1be55.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>(三) 区块链数据结构 – 交易</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">区块由交易组成。区块体中包含若干项交易数据。</p>
  <hr style="border-top:0px solid rgb(204,204,204);border-right:0px solid rgb(204,204,204);border-left:0px solid rgb(204,204,204);border-bottom-color:rgb(204,204,204);background-color:rgb(239,239,239);color:rgb(51,51,51);font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;">
  <h3 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:24px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易</h3>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易主要包含两类数据：交易输入和交易输出。<br>- 交易输入用来指明钱的来源<br>- 交易输出用来指明钱的去向</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">除了交易输入和交易输出外，交易中还包含版本号和锁定时间。交易数据的存储结构如下：</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);"><img src="http://www.insideai.cn/wp-content/uploads/2018/03/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E4%BA%A4%E6%98%93%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F.gif" alt="交易数据存储格式" title="交易数据存储格式"></p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易对象中的各个字段含义如下：</p>
  <table style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;border-collapse:separate;border-spacing:0px;width:650px;color:rgb(51,51,51);background-color:rgb(255,255,255);">
   <thead style="border:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">字段</th>
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">大小</th>
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">描述</th>
    </tr>
   </thead>
   <tbody style="font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">version</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">4个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">明确该笔交易参考的版本规则</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">numInputs</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">1-9个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">交易中包含的输入数量</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">inputs</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">不定长</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">交易中包含的输入数据</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">numOutputs</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">1-9个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">交易中包含的输出数量</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">outputs</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">不定长</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">交易中包含的输出数据</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">lockTime</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">4个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">交易锁定时间</td>
    </tr>
   </tbody>
  </table>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="border:0px;font-family:inherit;font-weight:inherit;vertical-align:baseline;">注：如果锁定时间为0，代表立即执行，无需锁定。如果该值小于5亿，则代表区块链到达该高度前，交易不会被执行，如果该值大于5亿，则该值代表Unix纪元时间戳，交易在该时间之后执行。</span></p>
  <h4 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">核心代码 - 变量定义</h4>
  <pre class="line-numbers prism-highlight" style="border:0px;font-family:'Courier 10 Pitch', Courier, monospace;font-size:.8125em;vertical-align:baseline;background:rgba(0,0,0,.03);line-height:1.96923em;color:rgb(51,51,51);"><code class="language-java" style="border:0px;font-family:Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;font-size:.8125em;vertical-align:baseline;line-height:1.96923em;">    // These are bitcoin serialized.
    private long version;                           //交易遵循的版本号
    private ArrayList&lt;TransactionInput&gt; inputs;     //交易的金钱来源
    private ArrayList&lt;TransactionOutput&gt; outputs;   //交易的金钱去向

    private long lockTime;                          //交易的锁定时间
</code></pre>
  <h4 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">核心代码 - 数据解析</h4>
  <pre class="line-numbers prism-highlight" style="border:0px;font-family:'Courier 10 Pitch', Courier, monospace;font-size:.8125em;vertical-align:baseline;background:rgba(0,0,0,.03);line-height:1.96923em;color:rgb(51,51,51);"><code class="language-java" style="border:0px;font-family:Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;font-size:.8125em;vertical-align:baseline;line-height:1.96923em;">    //解析区块原始字节数据，构造交易对象
    @Override
    protected void parse() throws ProtocolException {
        cursor = offset;

        version = readUint32();         //读取版本号
        optimalEncodingMessageSize = 4;

        // First come the inputs.
        long numInputs = readVarInt();  //读取输入交易量
        optimalEncodingMessageSize += VarInt.sizeOf(numInputs);

        inputs = new ArrayList&lt;&gt;((int) numInputs);

        //逐一解析输入交易对象
        for (long i = 0; i &lt; numInputs; i++) {
            //构造输入交易对象
            TransactionInput input = new TransactionInput(params, this, payload, cursor, serializer);
            inputs.add(input);
            long scriptLen = readVarInt(TransactionOutPoint.MESSAGE_LENGTH);
            optimalEncodingMessageSize += TransactionOutPoint.MESSAGE_LENGTH + VarInt.sizeOf(scriptLen) + scriptLen + 4;
            cursor += scriptLen + 4;
        }

        // Now the outputs
        long numOutputs = readVarInt(); //读取输出交易量
        optimalEncodingMessageSize += VarInt.sizeOf(numOutputs);
        outputs = new ArrayList&lt;&gt;((int) numOutputs);

        //逐一解析输出交易对象
        for (long i = 0; i &lt; numOutputs; i++) {
            //构造输出交易对象
            TransactionOutput output = new TransactionOutput(params, this, payload, cursor, serializer);
            outputs.add(output);
            long scriptLen = readVarInt(8);
            optimalEncodingMessageSize += 8 + VarInt.sizeOf(scriptLen) + scriptLen;
            cursor += scriptLen;
        }
        lockTime = readUint32();
        optimalEncodingMessageSize += 4;
        length = cursor - offset;
    }
</code></pre>
  <h3 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:24px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输入</h3>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输入指明了交易的金钱来源。在比特币系统中，交易的金钱来源，并不来自于某一特定账户，而来自于其他人的输出。<br>比如A和B分别转给C一笔金钱，则当C向D支付时，需要用A和B的输出作为输入。</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输入中，存储了其关联的交易输出指针，同时还存储了该输出的解锁脚本。</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输入结构如下：</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);"><img src="http://www.insideai.cn/wp-content/uploads/2018/03/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E4%BA%A4%E6%98%93%E8%BE%93%E5%85%A5%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F.gif" alt="交易输入存储格式" title="交易输入存储格式"></p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输入中，各个字段的含义如下：</p>
  <table style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;border-collapse:separate;border-spacing:0px;width:650px;color:rgb(51,51,51);background-color:rgb(255,255,255);">
   <thead style="border:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">字段</th>
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">大小</th>
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">描述</th>
    </tr>
   </thead>
   <tbody style="font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">hash</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">32个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">关联输出所在的交易Hash地址</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">index</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">4个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">关联输出在其交易输出集合中的索引</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">scriptLen</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">1-9个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">解锁脚本长度</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">scriptBytes</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">不定长</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">解锁脚本数据</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">sequence</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">4个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">序列号，暂未使用</td>
    </tr>
   </tbody>
  </table>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="border:0px;font-family:inherit;font-weight:inherit;vertical-align:baseline;">注：只有解锁脚本正确，才能对输出进行消费。解锁脚本需要使用当前用户的秘钥进行签名，因此只有当前用户，能使用别人来的输出。</span></p>
  <h4 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">核心代码 - 变量定义</h4>
  <pre class="line-numbers prism-highlight" style="border:0px;font-family:'Courier 10 Pitch', Courier, monospace;font-size:.8125em;vertical-align:baseline;background:rgba(0,0,0,.03);line-height:1.96923em;color:rgb(51,51,51);"><code class="language-java" style="border:0px;font-family:Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;font-size:.8125em;vertical-align:baseline;line-height:1.96923em;">    // Allows for altering transactions after they were broadcast. Values below NO_SEQUENCE-1 mean it can be altered.
    private long sequence;
    // Data needed to connect to the output of the transaction we're gathering coins from.
    //关联的交易输出
    private TransactionOutPoint outpoint;
    // The "script bytes" might not actually be a script. In coinbase transactions where new coins are minted there
    // is no input transaction, so instead the scriptBytes contains some extra stuff (like a rollover nonce) that we
    // don't care about much. The bytes are turned into a Script object (cached below) on demand via a getter.
    // 脚本字节数组可能并不是实际的脚本，在创世区块中，没有输入交易，该字段可能存储其他数据。正常情况下，该数据会转换成脚本对象
    private byte[] scriptBytes;
</code></pre>
  <h4 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">核心代码 - 数据解析</h4>
  <pre class="line-numbers prism-highlight" style="border:0px;font-family:'Courier 10 Pitch', Courier, monospace;font-size:.8125em;vertical-align:baseline;background:rgba(0,0,0,.03);line-height:1.96923em;color:rgb(51,51,51);"><code class="language-java" style="border:0px;font-family:Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;font-size:.8125em;vertical-align:baseline;line-height:1.96923em;">    //通过区块的原始字节数据，构造输入交易对象
    @Override
    protected void parse() throws ProtocolException {
        //构造该输入交易对应的输出(接收地址)
        //解析数据时，会解析出对应输出所在交易的Hash地址以及交易输出对应的索引值
        outpoint = new TransactionOutPoint(params, payload, cursor, this, serializer);
        cursor += outpoint.getMessageSize();
        int scriptLen = (int) readVarInt(); //读取脚本长度
        length = cursor - offset + scriptLen + 4;

        scriptBytes = readBytes(scriptLen); //读取解锁脚本数据
        sequence = readUint32();            //序列号，目前未使用
    }
</code></pre>
  <h3 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:24px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输出</h3>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输出指明了钱的去向，拥有该输出，并用私钥解密后，方可作为其他交易的输入，进行消费。</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输出中，存储了支付的金额以及锁定脚本。交易输出的存储结构如下：</p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);"><img src="http://www.insideai.cn/wp-content/uploads/2018/03/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E4%BA%A4%E6%98%93%E8%BE%93%E5%87%BA%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F.gif" alt="交易输出存储格式" title="交易输出存储格式"></p>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);">交易输出中，各个字段含义如下：</p>
  <table style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;border-collapse:separate;border-spacing:0px;width:650px;color:rgb(51,51,51);background-color:rgb(255,255,255);">
   <thead style="border:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">字段</th>
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">大小</th>
     <th style="border-width:0px 0px 4px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">描述</th>
    </tr>
   </thead>
   <tbody style="font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">value</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">8个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">支付金额（单位为聪）</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">scriptLen</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">1-9个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">锁定脚本长度</td>
    </tr>
    <tr style="border-top:0px;font-family:inherit;font-style:inherit;font-weight:inherit;vertical-align:baseline;">
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">scriptBytes</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">1-9个字节</td>
     <td style="border-top:0px;border-right:0px;border-left:0px;border-bottom-color:rgb(239,239,239);font-family:inherit;font-size:16px;font-style:inherit;vertical-align:baseline;border-collapse:collapse;">锁定脚本数据</td>
    </tr>
   </tbody>
  </table>
  <p style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;vertical-align:baseline;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="border:0px;font-family:inherit;font-weight:inherit;vertical-align:baseline;">注：只有接收者，通过秘钥加密生成解锁脚本后，方可继续使用该输出作为输入，继续消费。</span></p>
  <h4 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">核心代码 - 变量定义</h4>
  <pre class="line-numbers prism-highlight" style="border:0px;font-family:'Courier 10 Pitch', Courier, monospace;font-size:.8125em;vertical-align:baseline;background:rgba(0,0,0,.03);line-height:1.96923em;color:rgb(51,51,51);"><code class="language-java" style="border:0px;font-family:Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;font-size:.8125em;vertical-align:baseline;line-height:1.96923em;">    // The output's value is kept as a native type in order to save class instances.
    //支付金额
    private long value;

    // A transaction output has a script used for authenticating that the redeemer is allowed to spend
    // this output.
    //锁定脚本
    private byte[] scriptBytes;
</code></pre>
  <h4 style="border:0px;font-family:'Source Sans Pro', Helvetica, Arial, sans-serif;font-size:16px;vertical-align:baseline;clear:both;line-height:1;color:rgb(51,51,51);background-color:rgb(255,255,255);">核心代码 - 数据解析</h4>
  <pre class="line-numbers prism-highlight" style="border:0px;font-family:'Courier 10 Pitch', Courier, monospace;font-size:.8125em;vertical-align:baseline;background:rgba(0,0,0,.03);line-height:1.96923em;color:rgb(51,51,51);"><code class="language-java" style="border:0px;font-family:Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;font-size:.8125em;vertical-align:baseline;line-height:1.96923em;">    //解析交易输出数据，包含输出金额和锁定脚本(接收者可以解锁该脚本)
    @Override
    protected void parse() throws ProtocolException {
        value = readInt64();                    //获取交易输出的金额
        scriptLen = (int) readVarInt();         //锁定脚本的长度
        length = cursor - offset + scriptLen;
        scriptBytes = readBytes(scriptLen);     //锁定脚本的内容
    }</code></pre>
  <p>上一篇：<a href="http://www.insideai.cn/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%8C%BA%E5%9D%97/" rel="nofollow">(二) 区块链数据结构-区块</a></p>
  <p>下一篇：<a href="http://www.insideai.cn/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E8%84%9A%E6%9C%AC/" rel="nofollow">(四) 区块链数据结构 – 脚本</a></p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/maerdym/article/details/79753617,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/maerdym/article/details/79753617,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
