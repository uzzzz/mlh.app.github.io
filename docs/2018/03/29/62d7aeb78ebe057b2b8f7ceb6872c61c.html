<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>从零构建基于以太坊（Ethereum）钱包Parity联盟链 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="从零构建基于以太坊（Ethereum）钱包Parity联盟链" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="孔壹学院：国内区块链职业教育领先品牌 作者：黎跃春，区块链、高可用架构工程师 微信：liyc1215 QQ群：348924182 博客：http://liyuechun.org 什么情况下可以建立自己测试用的PoA chain？ PoA Chain特点有 大纲 一、Parity钱包下载安装 1、Getting Homebrew 2、Adding Parity to your list of Homebrew ‘kegs’ 3、Installing Parity 4、查看安装版本 二、设置chain spec 三、设置两个节点 四、设置账号(Account) 第一步：首先启动node0 : parity --config node0.toml 第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。 第三步：将Authority account 写入 demo-spec.json 文件 五、启动Authority node 1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下： 2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下： 3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下： 4、第四步，Step 4 分別启动两个node 六、连接两个节点 1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料 2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 ) 七、发送交易 八、分享给其他节点 技术交流 什么情况下可以建立自己测试用的PoA chain？ 公司内网或无对外网络，无法同步区块 降低测试时等待区块的时间 不想碰到testrpc各种雷 PoA Chain特点有 有别于PoW（Proof-of-Work）需要解数学难题来产生block，PoA是依靠预设好的Authority nodes，负责产生block。 可依照需求设定Authority node数量。 可指定产生block的时间，例如收到交易的5秒后产生block。 一般的Ethereum node也可以连接到PoA Chain，正常发起transactions，contracts等。 大纲 Parity钱包下载安装 设置chain spec 设置两个节点 设置账号(Account) 启动Authority node 连接两个节点 发送交易 分享给其他节点 一、Parity钱包下载安装 之前的教程中我们讲解了Mist钱包、MetaMask、myetherwallet钱包，这篇教程中，我们系统介绍一下Parity钱包的使用，为下一篇文章中联盟链搭建做铺垫。 Parity钱包下载安装https://parity.io。 如官网所示，The fastest and most secure way of interacting with the Ethereum blockchainParity是最快最安全的钱包。 打开官网，我们看到有三种安装方式，第一种，直接下载安装，第二种，Brew安装，第三种，Docker安装。 在我们案例中，我们通过Brew来进行安装。 1、Getting Homebrew /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; 2、Adding Parity to your list of Homebrew ‘kegs’ 打开终端，输入下面的命令，按enter。 brew tap paritytech/paritytech 3、Installing Parity 稳定版 brew install parity --stable 最新版 brew install parity 最新开发版 brew install parity --master 更新最新版本 brew update &amp;&amp; brew upgrade parity and brew reinstall parity 4、查看安装版本 liyuechun:~ yuechunli$ parity --version Parity version Parity/v1.8.2-beta-1b6588c-20171025/x86_64-macos/rustc1.21.0 Copyright 2015, 2016, 2017 Parity Technologies (UK) Ltd License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;. This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. By Wood/Paronyan/Kotewicz/Drwięga/Volf Habermeier/Czaban/Greeff/Gotchac/Redmann liyuechun:~ yuechunli$ 二、设置chain spec PoA chain 需要设置一个创世区块。 { &quot;name&quot;: &quot;DemoPoA&quot;, &quot;engine&quot;: { &quot;authorityRound&quot;: { &quot;params&quot;: { &quot;stepDuration&quot;: &quot;5&quot;, &quot;validators&quot;: { &quot;list&quot;: [ ] } } } }, &quot;params&quot;: { &quot;gasLimitBoundDivisor&quot;: &quot;0x0400&quot;, &quot;maximumExtraDataSize&quot;: &quot;0x20&quot;, &quot;minGasLimit&quot;: &quot;0x1388&quot;, &quot;networkID&quot;: &quot;0x2323&quot; }, &quot;genesis&quot;: { &quot;seal&quot;: { &quot;authorityRound&quot;: { &quot;step&quot;: &quot;0x0&quot;, &quot;signature&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; } }, &quot;difficulty&quot;: &quot;0x20000&quot;, &quot;gasLimit&quot;: &quot;0x5B8D80&quot; }, &quot;accounts&quot;: { &quot;0x0000000000000000000000000000000000000001&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ecrecover&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 3000, &quot;word&quot;: 0 } } } }, &quot;0x0000000000000000000000000000000000000002&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;sha256&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 60, &quot;word&quot;: 12 } } } }, &quot;0x0000000000000000000000000000000000000003&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ripemd160&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 600, &quot;word&quot;: 120 } } } }, &quot;0x0000000000000000000000000000000000000004&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;identity&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 15, &quot;word&quot;: 3 } } } } } } stepDuration 设定成5秒产生一个区块。 validators 设定Authority的地方，目前先空著，后面创建account之后再回来填入。 将上面的文件保存到桌面的一个文件中，保存为demo-spec.json。 三、设置两个节点 在我们这篇文章中，我们在同一台电脑设置两个节点，跟我们讲解以太坊私网建立 (2) - 同一台电脑／不同电脑运行多个节点时，如果在同一台电脑设置两个节点，需要将rpcport和port设置为不同的值，否则就会发生冲突，POA chain中也是一样，需要将一些参数设置为不同的值。 -d：指定存储资料与账号的目录 --dport：指定Parity的network port，可用来让其他node连接 --jsonrpc-port：这是JSON RPC port，使用web3.js时会需要 ui-port：Parity提供的Web-based UI port 可以用下列指令启动Parity node。 parity --chain demo-spec.json -d parity0 --port 30300 --ui-port 8180 --jsonrpc-port 8540 --jsonrpc-apis web3,eth,net,personal,parity,parity_set,traces,rpc,parity_accounts 除了打一长串的指令外，Parity也提供更为简洁的config档案设定方式，使用 --config 即可引用配置文件。 node0 使用如下配置文件 node0.toml： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8180 [websockets] port = 8456 node1 使用如下配置文件 node1.toml： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 四、设置账号(Account) 我们总共需要设置三个账号，两个Authority和一个user账号。 第一步：首先启动node0 : parity --config node0.toml 打开网页http://localhost:8180，按照步骤创建一个用户账号。 新增Authority account，使用Restore功能，为了示范一致性，我们使用 node0 当作 pass phrase。 到目前为止我们已经完成node0的账号设置。 Authority account：0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e User account：0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC 第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。 这样就完成了node1的账号设置。 Authority account:0x00F9B30838ca40c8A53c672840acbDec6fCDb180 第三步：将Authority account 写入 demo-spec.json 文件 &quot;validators&quot;: { &quot;list&quot;: [ &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot;, &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; ] } 再将user account加入accounts，並给一些balance，后续可以使用。 &quot;0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC&quot;: { &quot;balance&quot;: &quot;10000000000000000000000&quot; } 完成后的demo-spec.json如下： { &quot;name&quot;: &quot;DemoPoA&quot;, &quot;engine&quot;: { &quot;authorityRound&quot;: { &quot;params&quot;: { &quot;stepDuration&quot;: &quot;5&quot;, &quot;validators&quot;: { &quot;list&quot;: [ &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot;, &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; ] } } } }, &quot;params&quot;: { &quot;gasLimitBoundDivisor&quot;: &quot;0x0400&quot;, &quot;maximumExtraDataSize&quot;: &quot;0x20&quot;, &quot;minGasLimit&quot;: &quot;0x1388&quot;, &quot;networkID&quot;: &quot;0x2323&quot; }, &quot;genesis&quot;: { &quot;seal&quot;: { &quot;authorityRound&quot;: { &quot;step&quot;: &quot;0x0&quot;, &quot;signature&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; } }, &quot;difficulty&quot;: &quot;0x20000&quot;, &quot;gasLimit&quot;: &quot;0x5B8D80&quot; }, &quot;accounts&quot;: { &quot;0x0000000000000000000000000000000000000001&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ecrecover&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 3000, &quot;word&quot;: 0 } } } }, &quot;0x0000000000000000000000000000000000000002&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;sha256&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 60, &quot;word&quot;: 12 } } } }, &quot;0x0000000000000000000000000000000000000003&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ripemd160&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 600, &quot;word&quot;: 120 } } } }, &quot;0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC&quot;: { &quot;balance&quot;: &quot;10000000000000000000000&quot; }, &quot;0x0000000000000000000000000000000000000004&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;identity&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 15, &quot;word&quot;: 3 } } } } } } 五、启动Authority node 为了启动Authority node来产生区块，我们必须设定负责产生block的signer，分別是 node0 和 node1 account。 1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下： node0 node1 2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8180 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; reseal_on_txs = &quot;none&quot; 3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot; reseal_on_txs = &quot;none&quot; 4、第四步，Step 4 分別启动两个node parity --config node0.toml parity --config node1.toml 六、连接两个节点 使用Postman透过JSON RPC来测试。 1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料 { &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;parity_enode&quot;, &quot;params&quot;:[], &quot;id&quot;:0 } 获取到的数据如下： { &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;result&quot;: &quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;, &quot;id&quot;: 0 } &quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;是node0的标识。下一步中我们将将它加入到node1中以实现两个节点之间的连接。 2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 ) { &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;parity_addReservedPeer&quot;, &quot;params&quot;:[&quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;], &quot;id&quot;:0 } 返回的数据如下，result为true，说明连接成功： { &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;result&quot;: true, &quot;id&quot;: 0 } 再切换到node1的终端，会看到下面的数据： 1/25 peers 13 KiB chain 11 KiB db 0 bytes queue 10 KiB sync RPC: 0 conn, 0 req/s, 24 µs 如上图所示，表示连接成功。 七、发送交易 在我们这个案例中，我们一个创建了三个账号，一个用户账号，两个POA账号，刚开始的时候我们为用户账号初始化了10000 ETH。如下图所示，账号与账号之间可以相互转账。 八、分享给其他节点 在开发时通常会将node跑在server上，让其他人可以通过JSON RPC port连接上去使用，此时只要在config文件里面加入 [interface] 设置即可。 假设server ip为192.168.1.5，将 node0.toml 修改如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] interface = &quot;192.168.1.5&quot; [ui] port = 8180 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; reseal_on_txs = &quot;none&quot; node1.toml 修改如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] interface = &quot;192.168.1.5&quot; cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot; reseal_on_txs = &quot;none&quot; 技术交流 区块链技术交流QQ群：348924182 「区块链部落」官方公众号 阅读更多" />
<meta property="og:description" content="孔壹学院：国内区块链职业教育领先品牌 作者：黎跃春，区块链、高可用架构工程师 微信：liyc1215 QQ群：348924182 博客：http://liyuechun.org 什么情况下可以建立自己测试用的PoA chain？ PoA Chain特点有 大纲 一、Parity钱包下载安装 1、Getting Homebrew 2、Adding Parity to your list of Homebrew ‘kegs’ 3、Installing Parity 4、查看安装版本 二、设置chain spec 三、设置两个节点 四、设置账号(Account) 第一步：首先启动node0 : parity --config node0.toml 第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。 第三步：将Authority account 写入 demo-spec.json 文件 五、启动Authority node 1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下： 2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下： 3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下： 4、第四步，Step 4 分別启动两个node 六、连接两个节点 1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料 2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 ) 七、发送交易 八、分享给其他节点 技术交流 什么情况下可以建立自己测试用的PoA chain？ 公司内网或无对外网络，无法同步区块 降低测试时等待区块的时间 不想碰到testrpc各种雷 PoA Chain特点有 有别于PoW（Proof-of-Work）需要解数学难题来产生block，PoA是依靠预设好的Authority nodes，负责产生block。 可依照需求设定Authority node数量。 可指定产生block的时间，例如收到交易的5秒后产生block。 一般的Ethereum node也可以连接到PoA Chain，正常发起transactions，contracts等。 大纲 Parity钱包下载安装 设置chain spec 设置两个节点 设置账号(Account) 启动Authority node 连接两个节点 发送交易 分享给其他节点 一、Parity钱包下载安装 之前的教程中我们讲解了Mist钱包、MetaMask、myetherwallet钱包，这篇教程中，我们系统介绍一下Parity钱包的使用，为下一篇文章中联盟链搭建做铺垫。 Parity钱包下载安装https://parity.io。 如官网所示，The fastest and most secure way of interacting with the Ethereum blockchainParity是最快最安全的钱包。 打开官网，我们看到有三种安装方式，第一种，直接下载安装，第二种，Brew安装，第三种，Docker安装。 在我们案例中，我们通过Brew来进行安装。 1、Getting Homebrew /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; 2、Adding Parity to your list of Homebrew ‘kegs’ 打开终端，输入下面的命令，按enter。 brew tap paritytech/paritytech 3、Installing Parity 稳定版 brew install parity --stable 最新版 brew install parity 最新开发版 brew install parity --master 更新最新版本 brew update &amp;&amp; brew upgrade parity and brew reinstall parity 4、查看安装版本 liyuechun:~ yuechunli$ parity --version Parity version Parity/v1.8.2-beta-1b6588c-20171025/x86_64-macos/rustc1.21.0 Copyright 2015, 2016, 2017 Parity Technologies (UK) Ltd License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;. This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. By Wood/Paronyan/Kotewicz/Drwięga/Volf Habermeier/Czaban/Greeff/Gotchac/Redmann liyuechun:~ yuechunli$ 二、设置chain spec PoA chain 需要设置一个创世区块。 { &quot;name&quot;: &quot;DemoPoA&quot;, &quot;engine&quot;: { &quot;authorityRound&quot;: { &quot;params&quot;: { &quot;stepDuration&quot;: &quot;5&quot;, &quot;validators&quot;: { &quot;list&quot;: [ ] } } } }, &quot;params&quot;: { &quot;gasLimitBoundDivisor&quot;: &quot;0x0400&quot;, &quot;maximumExtraDataSize&quot;: &quot;0x20&quot;, &quot;minGasLimit&quot;: &quot;0x1388&quot;, &quot;networkID&quot;: &quot;0x2323&quot; }, &quot;genesis&quot;: { &quot;seal&quot;: { &quot;authorityRound&quot;: { &quot;step&quot;: &quot;0x0&quot;, &quot;signature&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; } }, &quot;difficulty&quot;: &quot;0x20000&quot;, &quot;gasLimit&quot;: &quot;0x5B8D80&quot; }, &quot;accounts&quot;: { &quot;0x0000000000000000000000000000000000000001&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ecrecover&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 3000, &quot;word&quot;: 0 } } } }, &quot;0x0000000000000000000000000000000000000002&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;sha256&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 60, &quot;word&quot;: 12 } } } }, &quot;0x0000000000000000000000000000000000000003&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ripemd160&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 600, &quot;word&quot;: 120 } } } }, &quot;0x0000000000000000000000000000000000000004&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;identity&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 15, &quot;word&quot;: 3 } } } } } } stepDuration 设定成5秒产生一个区块。 validators 设定Authority的地方，目前先空著，后面创建account之后再回来填入。 将上面的文件保存到桌面的一个文件中，保存为demo-spec.json。 三、设置两个节点 在我们这篇文章中，我们在同一台电脑设置两个节点，跟我们讲解以太坊私网建立 (2) - 同一台电脑／不同电脑运行多个节点时，如果在同一台电脑设置两个节点，需要将rpcport和port设置为不同的值，否则就会发生冲突，POA chain中也是一样，需要将一些参数设置为不同的值。 -d：指定存储资料与账号的目录 --dport：指定Parity的network port，可用来让其他node连接 --jsonrpc-port：这是JSON RPC port，使用web3.js时会需要 ui-port：Parity提供的Web-based UI port 可以用下列指令启动Parity node。 parity --chain demo-spec.json -d parity0 --port 30300 --ui-port 8180 --jsonrpc-port 8540 --jsonrpc-apis web3,eth,net,personal,parity,parity_set,traces,rpc,parity_accounts 除了打一长串的指令外，Parity也提供更为简洁的config档案设定方式，使用 --config 即可引用配置文件。 node0 使用如下配置文件 node0.toml： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8180 [websockets] port = 8456 node1 使用如下配置文件 node1.toml： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 四、设置账号(Account) 我们总共需要设置三个账号，两个Authority和一个user账号。 第一步：首先启动node0 : parity --config node0.toml 打开网页http://localhost:8180，按照步骤创建一个用户账号。 新增Authority account，使用Restore功能，为了示范一致性，我们使用 node0 当作 pass phrase。 到目前为止我们已经完成node0的账号设置。 Authority account：0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e User account：0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC 第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。 这样就完成了node1的账号设置。 Authority account:0x00F9B30838ca40c8A53c672840acbDec6fCDb180 第三步：将Authority account 写入 demo-spec.json 文件 &quot;validators&quot;: { &quot;list&quot;: [ &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot;, &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; ] } 再将user account加入accounts，並给一些balance，后续可以使用。 &quot;0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC&quot;: { &quot;balance&quot;: &quot;10000000000000000000000&quot; } 完成后的demo-spec.json如下： { &quot;name&quot;: &quot;DemoPoA&quot;, &quot;engine&quot;: { &quot;authorityRound&quot;: { &quot;params&quot;: { &quot;stepDuration&quot;: &quot;5&quot;, &quot;validators&quot;: { &quot;list&quot;: [ &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot;, &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; ] } } } }, &quot;params&quot;: { &quot;gasLimitBoundDivisor&quot;: &quot;0x0400&quot;, &quot;maximumExtraDataSize&quot;: &quot;0x20&quot;, &quot;minGasLimit&quot;: &quot;0x1388&quot;, &quot;networkID&quot;: &quot;0x2323&quot; }, &quot;genesis&quot;: { &quot;seal&quot;: { &quot;authorityRound&quot;: { &quot;step&quot;: &quot;0x0&quot;, &quot;signature&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; } }, &quot;difficulty&quot;: &quot;0x20000&quot;, &quot;gasLimit&quot;: &quot;0x5B8D80&quot; }, &quot;accounts&quot;: { &quot;0x0000000000000000000000000000000000000001&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ecrecover&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 3000, &quot;word&quot;: 0 } } } }, &quot;0x0000000000000000000000000000000000000002&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;sha256&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 60, &quot;word&quot;: 12 } } } }, &quot;0x0000000000000000000000000000000000000003&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ripemd160&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 600, &quot;word&quot;: 120 } } } }, &quot;0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC&quot;: { &quot;balance&quot;: &quot;10000000000000000000000&quot; }, &quot;0x0000000000000000000000000000000000000004&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;identity&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 15, &quot;word&quot;: 3 } } } } } } 五、启动Authority node 为了启动Authority node来产生区块，我们必须设定负责产生block的signer，分別是 node0 和 node1 account。 1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下： node0 node1 2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8180 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; reseal_on_txs = &quot;none&quot; 3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot; reseal_on_txs = &quot;none&quot; 4、第四步，Step 4 分別启动两个node parity --config node0.toml parity --config node1.toml 六、连接两个节点 使用Postman透过JSON RPC来测试。 1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料 { &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;parity_enode&quot;, &quot;params&quot;:[], &quot;id&quot;:0 } 获取到的数据如下： { &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;result&quot;: &quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;, &quot;id&quot;: 0 } &quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;是node0的标识。下一步中我们将将它加入到node1中以实现两个节点之间的连接。 2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 ) { &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;parity_addReservedPeer&quot;, &quot;params&quot;:[&quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;], &quot;id&quot;:0 } 返回的数据如下，result为true，说明连接成功： { &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;result&quot;: true, &quot;id&quot;: 0 } 再切换到node1的终端，会看到下面的数据： 1/25 peers 13 KiB chain 11 KiB db 0 bytes queue 10 KiB sync RPC: 0 conn, 0 req/s, 24 µs 如上图所示，表示连接成功。 七、发送交易 在我们这个案例中，我们一个创建了三个账号，一个用户账号，两个POA账号，刚开始的时候我们为用户账号初始化了10000 ETH。如下图所示，账号与账号之间可以相互转账。 八、分享给其他节点 在开发时通常会将node跑在server上，让其他人可以通过JSON RPC port连接上去使用，此时只要在config文件里面加入 [interface] 设置即可。 假设server ip为192.168.1.5，将 node0.toml 修改如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] interface = &quot;192.168.1.5&quot; [ui] port = 8180 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; reseal_on_txs = &quot;none&quot; node1.toml 修改如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] interface = &quot;192.168.1.5&quot; cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot; reseal_on_txs = &quot;none&quot; 技术交流 区块链技术交流QQ群：348924182 「区块链部落」官方公众号 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-29T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"孔壹学院：国内区块链职业教育领先品牌 作者：黎跃春，区块链、高可用架构工程师 微信：liyc1215 QQ群：348924182 博客：http://liyuechun.org 什么情况下可以建立自己测试用的PoA chain？ PoA Chain特点有 大纲 一、Parity钱包下载安装 1、Getting Homebrew 2、Adding Parity to your list of Homebrew ‘kegs’ 3、Installing Parity 4、查看安装版本 二、设置chain spec 三、设置两个节点 四、设置账号(Account) 第一步：首先启动node0 : parity --config node0.toml 第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。 第三步：将Authority account 写入 demo-spec.json 文件 五、启动Authority node 1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下： 2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下： 3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下： 4、第四步，Step 4 分別启动两个node 六、连接两个节点 1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料 2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 ) 七、发送交易 八、分享给其他节点 技术交流 什么情况下可以建立自己测试用的PoA chain？ 公司内网或无对外网络，无法同步区块 降低测试时等待区块的时间 不想碰到testrpc各种雷 PoA Chain特点有 有别于PoW（Proof-of-Work）需要解数学难题来产生block，PoA是依靠预设好的Authority nodes，负责产生block。 可依照需求设定Authority node数量。 可指定产生block的时间，例如收到交易的5秒后产生block。 一般的Ethereum node也可以连接到PoA Chain，正常发起transactions，contracts等。 大纲 Parity钱包下载安装 设置chain spec 设置两个节点 设置账号(Account) 启动Authority node 连接两个节点 发送交易 分享给其他节点 一、Parity钱包下载安装 之前的教程中我们讲解了Mist钱包、MetaMask、myetherwallet钱包，这篇教程中，我们系统介绍一下Parity钱包的使用，为下一篇文章中联盟链搭建做铺垫。 Parity钱包下载安装https://parity.io。 如官网所示，The fastest and most secure way of interacting with the Ethereum blockchainParity是最快最安全的钱包。 打开官网，我们看到有三种安装方式，第一种，直接下载安装，第二种，Brew安装，第三种，Docker安装。 在我们案例中，我们通过Brew来进行安装。 1、Getting Homebrew /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; 2、Adding Parity to your list of Homebrew ‘kegs’ 打开终端，输入下面的命令，按enter。 brew tap paritytech/paritytech 3、Installing Parity 稳定版 brew install parity --stable 最新版 brew install parity 最新开发版 brew install parity --master 更新最新版本 brew update &amp;&amp; brew upgrade parity and brew reinstall parity 4、查看安装版本 liyuechun:~ yuechunli$ parity --version Parity version Parity/v1.8.2-beta-1b6588c-20171025/x86_64-macos/rustc1.21.0 Copyright 2015, 2016, 2017 Parity Technologies (UK) Ltd License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;. This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. By Wood/Paronyan/Kotewicz/Drwięga/Volf Habermeier/Czaban/Greeff/Gotchac/Redmann liyuechun:~ yuechunli$ 二、设置chain spec PoA chain 需要设置一个创世区块。 { &quot;name&quot;: &quot;DemoPoA&quot;, &quot;engine&quot;: { &quot;authorityRound&quot;: { &quot;params&quot;: { &quot;stepDuration&quot;: &quot;5&quot;, &quot;validators&quot;: { &quot;list&quot;: [ ] } } } }, &quot;params&quot;: { &quot;gasLimitBoundDivisor&quot;: &quot;0x0400&quot;, &quot;maximumExtraDataSize&quot;: &quot;0x20&quot;, &quot;minGasLimit&quot;: &quot;0x1388&quot;, &quot;networkID&quot;: &quot;0x2323&quot; }, &quot;genesis&quot;: { &quot;seal&quot;: { &quot;authorityRound&quot;: { &quot;step&quot;: &quot;0x0&quot;, &quot;signature&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; } }, &quot;difficulty&quot;: &quot;0x20000&quot;, &quot;gasLimit&quot;: &quot;0x5B8D80&quot; }, &quot;accounts&quot;: { &quot;0x0000000000000000000000000000000000000001&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ecrecover&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 3000, &quot;word&quot;: 0 } } } }, &quot;0x0000000000000000000000000000000000000002&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;sha256&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 60, &quot;word&quot;: 12 } } } }, &quot;0x0000000000000000000000000000000000000003&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ripemd160&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 600, &quot;word&quot;: 120 } } } }, &quot;0x0000000000000000000000000000000000000004&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;identity&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 15, &quot;word&quot;: 3 } } } } } } stepDuration 设定成5秒产生一个区块。 validators 设定Authority的地方，目前先空著，后面创建account之后再回来填入。 将上面的文件保存到桌面的一个文件中，保存为demo-spec.json。 三、设置两个节点 在我们这篇文章中，我们在同一台电脑设置两个节点，跟我们讲解以太坊私网建立 (2) - 同一台电脑／不同电脑运行多个节点时，如果在同一台电脑设置两个节点，需要将rpcport和port设置为不同的值，否则就会发生冲突，POA chain中也是一样，需要将一些参数设置为不同的值。 -d：指定存储资料与账号的目录 --dport：指定Parity的network port，可用来让其他node连接 --jsonrpc-port：这是JSON RPC port，使用web3.js时会需要 ui-port：Parity提供的Web-based UI port 可以用下列指令启动Parity node。 parity --chain demo-spec.json -d parity0 --port 30300 --ui-port 8180 --jsonrpc-port 8540 --jsonrpc-apis web3,eth,net,personal,parity,parity_set,traces,rpc,parity_accounts 除了打一长串的指令外，Parity也提供更为简洁的config档案设定方式，使用 --config 即可引用配置文件。 node0 使用如下配置文件 node0.toml： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8180 [websockets] port = 8456 node1 使用如下配置文件 node1.toml： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 四、设置账号(Account) 我们总共需要设置三个账号，两个Authority和一个user账号。 第一步：首先启动node0 : parity --config node0.toml 打开网页http://localhost:8180，按照步骤创建一个用户账号。 新增Authority account，使用Restore功能，为了示范一致性，我们使用 node0 当作 pass phrase。 到目前为止我们已经完成node0的账号设置。 Authority account：0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e User account：0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC 第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。 这样就完成了node1的账号设置。 Authority account:0x00F9B30838ca40c8A53c672840acbDec6fCDb180 第三步：将Authority account 写入 demo-spec.json 文件 &quot;validators&quot;: { &quot;list&quot;: [ &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot;, &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; ] } 再将user account加入accounts，並给一些balance，后续可以使用。 &quot;0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC&quot;: { &quot;balance&quot;: &quot;10000000000000000000000&quot; } 完成后的demo-spec.json如下： { &quot;name&quot;: &quot;DemoPoA&quot;, &quot;engine&quot;: { &quot;authorityRound&quot;: { &quot;params&quot;: { &quot;stepDuration&quot;: &quot;5&quot;, &quot;validators&quot;: { &quot;list&quot;: [ &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot;, &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; ] } } } }, &quot;params&quot;: { &quot;gasLimitBoundDivisor&quot;: &quot;0x0400&quot;, &quot;maximumExtraDataSize&quot;: &quot;0x20&quot;, &quot;minGasLimit&quot;: &quot;0x1388&quot;, &quot;networkID&quot;: &quot;0x2323&quot; }, &quot;genesis&quot;: { &quot;seal&quot;: { &quot;authorityRound&quot;: { &quot;step&quot;: &quot;0x0&quot;, &quot;signature&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot; } }, &quot;difficulty&quot;: &quot;0x20000&quot;, &quot;gasLimit&quot;: &quot;0x5B8D80&quot; }, &quot;accounts&quot;: { &quot;0x0000000000000000000000000000000000000001&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ecrecover&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 3000, &quot;word&quot;: 0 } } } }, &quot;0x0000000000000000000000000000000000000002&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;sha256&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 60, &quot;word&quot;: 12 } } } }, &quot;0x0000000000000000000000000000000000000003&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;ripemd160&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 600, &quot;word&quot;: 120 } } } }, &quot;0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC&quot;: { &quot;balance&quot;: &quot;10000000000000000000000&quot; }, &quot;0x0000000000000000000000000000000000000004&quot;: { &quot;balance&quot;: &quot;1&quot;, &quot;builtin&quot;: { &quot;name&quot;: &quot;identity&quot;, &quot;pricing&quot;: { &quot;linear&quot;: { &quot;base&quot;: 15, &quot;word&quot;: 3 } } } } } } 五、启动Authority node 为了启动Authority node来产生区块，我们必须设定负责产生block的signer，分別是 node0 和 node1 account。 1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下： node0 node1 2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8180 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; reseal_on_txs = &quot;none&quot; 3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot; reseal_on_txs = &quot;none&quot; 4、第四步，Step 4 分別启动两个node parity --config node0.toml parity --config node1.toml 六、连接两个节点 使用Postman透过JSON RPC来测试。 1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料 { &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;parity_enode&quot;, &quot;params&quot;:[], &quot;id&quot;:0 } 获取到的数据如下： { &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;result&quot;: &quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;, &quot;id&quot;: 0 } &quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;是node0的标识。下一步中我们将将它加入到node1中以实现两个节点之间的连接。 2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 ) { &quot;jsonrpc&quot;:&quot;2.0&quot;, &quot;method&quot;:&quot;parity_addReservedPeer&quot;, &quot;params&quot;:[&quot;enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300&quot;], &quot;id&quot;:0 } 返回的数据如下，result为true，说明连接成功： { &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;result&quot;: true, &quot;id&quot;: 0 } 再切换到node1的终端，会看到下面的数据： 1/25 peers 13 KiB chain 11 KiB db 0 bytes queue 10 KiB sync RPC: 0 conn, 0 req/s, 24 µs 如上图所示，表示连接成功。 七、发送交易 在我们这个案例中，我们一个创建了三个账号，一个用户账号，两个POA账号，刚开始的时候我们为用户账号初始化了10000 ETH。如下图所示，账号与账号之间可以相互转账。 八、分享给其他节点 在开发时通常会将node跑在server上，让其他人可以通过JSON RPC port连接上去使用，此时只要在config文件里面加入 [interface] 设置即可。 假设server ip为192.168.1.5，将 node0.toml 修改如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity0&quot; [network] port = 30300 [rpc] port = 8540 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] cors = [&quot;*&quot;] interface = &quot;192.168.1.5&quot; [ui] port = 8180 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e&quot; reseal_on_txs = &quot;none&quot; node1.toml 修改如下： [parity] chain = &quot;demo-spec.json&quot; base_path = &quot;parity1&quot; [network] port = 30301 [rpc] port = 8541 apis = [&quot;web3&quot;, &quot;eth&quot;, &quot;net&quot;, &quot;personal&quot;, &quot;parity&quot;, &quot;parity_set&quot;, &quot;traces&quot;, &quot;rpc&quot;, &quot;parity_accounts&quot;] interface = &quot;192.168.1.5&quot; cors = [&quot;*&quot;] [ui] port = 8181 [websockets] port = 8457 [account] password = [&quot;node.pwds&quot;] [mining] engine_signer = &quot;0x00F9B30838ca40c8A53c672840acbDec6fCDb180&quot; reseal_on_txs = &quot;none&quot; 技术交流 区块链技术交流QQ群：348924182 「区块链部落」官方公众号 阅读更多","@type":"BlogPosting","url":"/2018/03/29/62d7aeb78ebe057b2b8f7ceb6872c61c.html","headline":"从零构建基于以太坊（Ethereum）钱包Parity联盟链","dateModified":"2018-03-29T00:00:00+08:00","datePublished":"2018-03-29T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/03/29/62d7aeb78ebe057b2b8f7ceb6872c61c.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>从零构建基于以太坊（Ethereum）钱包Parity联盟链</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <blockquote> 
   <p><a href="http://www.kongyixueyuan.com" rel="nofollow">孔壹学院：国内区块链职业教育领先品牌</a></p> 
   <p>作者：黎跃春，区块链、高可用架构工程师 <br> 微信：liyc1215 QQ群：348924182 博客：<a href="http://liyuechun.org" rel="nofollow">http://liyuechun.org</a></p> 
  </blockquote> 
  <p></p>
  <div class="toc"> 
   <ul> 
    <li>
     <ul> 
      <li><a href="#什么情况下可以建立自己测试用的poa-chain" rel="nofollow">什么情况下可以建立自己测试用的PoA chain？</a></li> 
      <li><a href="#poa-chain特点有" rel="nofollow">PoA Chain特点有</a></li> 
      <li><a href="#大纲" rel="nofollow">大纲</a></li> 
      <li><a href="#一parity钱包下载安装" rel="nofollow">一、Parity钱包下载安装</a>
       <ul> 
        <li><a href="#1getting-homebrew" rel="nofollow">1、Getting Homebrew</a></li> 
        <li><a href="#2adding-parity-to-your-list-of-homebrew-kegs" rel="nofollow">2、Adding Parity to your list of Homebrew ‘kegs’</a></li> 
        <li><a href="#3installing-parity" rel="nofollow">3、Installing Parity</a></li> 
        <li><a href="#4查看安装版本" rel="nofollow">4、查看安装版本</a></li> 
       </ul> </li> 
      <li><a href="#二设置chain-spec" rel="nofollow">二、设置chain spec</a></li> 
      <li><a href="#三设置两个节点" rel="nofollow">三、设置两个节点</a></li> 
      <li><a href="#四设置账号account" rel="nofollow">四、设置账号(Account)</a>
       <ul> 
        <li><a href="#第一步首先启动node0-parity-config-node0toml" rel="nofollow">第一步：首先启动node0 : parity --config node0.toml</a></li> 
        <li><a href="#第二步设置node1的账号启动parity-config-node1toml步骤相同连接到-httplocalhost8181-pass-phrase使用-node1" rel="nofollow">第二步：设置node1的账号，启动parity --config node1.toml。步骤相同，连接到 http://localhost:8181 ，pass phrase使用 node1。</a></li> 
        <li><a href="#第三步将authority-account-写入-demo-specjson-文件" rel="nofollow">第三步：将Authority account 写入 demo-spec.json 文件</a></li> 
       </ul> </li> 
      <li><a href="#五启动authority-node" rel="nofollow">五、启动Authority node</a>
       <ul> 
        <li><a href="#1第一步创建一个nodepwds文件写入node0与node1的password内容如下" rel="nofollow">1、第一步，创建一个node.pwds文件，写入node0与node1的password，内容如下：</a></li> 
        <li><a href="#2第二步在node0toml文件中加入account及mining设置如下" rel="nofollow">2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下：</a></li> 
        <li><a href="#3第三步在node1toml文件中加入account及mining设置如下" rel="nofollow">3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下：</a></li> 
        <li><a href="#4第四步step-4-分別启动两个node" rel="nofollow">4、第四步，Step 4 分別启动两个node</a></li> 
       </ul> </li> 
      <li><a href="#六连接两个节点" rel="nofollow">六、连接两个节点</a>
       <ul> 
        <li><a href="#1第一步post下列json数据至-httplocalhost8540-以取得-node0-的enode资料" rel="nofollow">1、第一步，Post下列JSON数据至 http://localhost:8540 以取得 node0 的enode资料</a></li> 
        <li><a href="#2第二步将-node0-的enode加入-node1-post下列jsons数据至node1-httplocalhost8541" rel="nofollow">2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (http://localhost:8541 )</a></li> 
       </ul> </li> 
      <li><a href="#七发送交易" rel="nofollow">七、发送交易</a></li> 
      <li><a href="#八分享给其他节点" rel="nofollow">八、分享给其他节点</a></li> 
      <li><a href="#技术交流" rel="nofollow">技术交流</a></li> 
     </ul> </li> 
   </ul> 
  </div> 
  <p></p> 
  <h2 id="什么情况下可以建立自己测试用的poa-chain">什么情况下可以建立自己测试用的PoA chain？</h2> 
  <ul> 
   <li>公司内网或无对外网络，无法同步区块</li> 
   <li>降低测试时等待区块的时间</li> 
   <li>不想碰到testrpc各种雷</li> 
  </ul> 
  <h2 id="poa-chain特点有">PoA Chain特点有</h2> 
  <ul> 
   <li>有别于<code>PoW（Proof-of-Work）</code>需要解数学难题来产生<code>block</code>，<code>PoA</code>是依靠预设好的<code>Authority nodes</code>，负责产生<code>block</code>。</li> 
   <li>可依照需求设定<code>Authority node</code>数量。</li> 
   <li>可指定产生<code>block</code>的时间，例如收到交易的<code>5</code>秒后产生<code>block</code>。</li> 
   <li>一般的<code>Ethereum node</code>也可以连接到<code>PoA Chain</code>，正常发起<code>transactions</code>，<code>contracts</code>等。</li> 
  </ul> 
  <h2 id="大纲">大纲</h2> 
  <ol> 
   <li>Parity钱包下载安装</li> 
   <li>设置chain spec</li> 
   <li>设置两个节点</li> 
   <li>设置账号(Account)</li> 
   <li>启动Authority node</li> 
   <li>连接两个节点</li> 
   <li>发送交易</li> 
   <li>分享给其他节点</li> 
  </ol> 
  <h2 id="一parity钱包下载安装">一、Parity钱包下载安装</h2> 
  <p>之前的教程中我们讲解了Mist钱包、MetaMask、myetherwallet钱包，这篇教程中，我们系统介绍一下Parity钱包的使用，为下一篇文章中联盟链搭建做铺垫。</p> 
  <p>Parity钱包下载安装<a href="https://parity.io/" rel="nofollow">https://parity.io</a>。</p> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_4.png" alt="孔壹学院" title=""></p> 
  <p>如官网所示，<strong>The fastest and most secure way of interacting with the Ethereum blockchain</strong><code>Parity</code>是最快最安全的钱包。</p> 
  <p>打开官网，我们看到有三种安装方式，第一种，直接下载安装，第二种，<code>Brew</code>安装，第三种，<code>Docker</code>安装。</p> 
  <p>在我们案例中，我们通过<code>Brew</code>来进行安装。</p> 
  <h3 id="1getting-homebrew">1、Getting Homebrew</h3> 
  <pre class="prettyprint"><code class=" hljs bash">/usr/bin/ruby <span class="hljs-operator">-e</span> <span class="hljs-string">"<span class="hljs-variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></code></pre> 
  <h3 id="2adding-parity-to-your-list-of-homebrew-kegs">2、Adding Parity to your list of Homebrew ‘kegs’</h3> 
  <p>打开终端，输入下面的命令，按enter。</p> 
  <pre class="prettyprint"><code class=" hljs ">brew tap paritytech/paritytech</code></pre> 
  <h3 id="3installing-parity">3、Installing Parity</h3> 
  <ul> 
   <li>稳定版</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">brew</span> <span class="hljs-comment">install</span> <span class="hljs-comment">parity</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">stable</span></code></pre> 
  <ul> 
   <li>最新版</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs cmake">brew <span class="hljs-keyword">install</span> parity</code></pre> 
  <ul> 
   <li>最新开发版</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">brew</span> <span class="hljs-comment">install</span> <span class="hljs-comment">parity</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">master</span></code></pre> 
  <ul> 
   <li>更新最新版本</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs sql">brew <span class="hljs-operator"><span class="hljs-keyword">update</span> &amp;&amp; brew upgrade parity</span></code></pre> 
  <p>and</p> 
  <pre class="prettyprint"><code class=" hljs ">brew reinstall parity</code></pre> 
  <h3 id="4查看安装版本">4、查看安装版本</h3> 
  <pre class="prettyprint"><code class=" hljs livecodeserver">liyuechun:~ yuechunli$ parity <span class="hljs-comment">--version</span>
Parity
  <span class="hljs-built_in">version</span> Parity/v1<span class="hljs-number">.8</span><span class="hljs-number">.2</span>-beta-<span class="hljs-number">1</span>b6588c-<span class="hljs-number">20171025</span>/x86_64-macos/rustc1<span class="hljs-number">.21</span><span class="hljs-number">.0</span>
Copyright <span class="hljs-number">2015</span>, <span class="hljs-number">2016</span>, <span class="hljs-number">2017</span> Parity Technologies (UK) Ltd
License GPLv3+: GNU GPL <span class="hljs-built_in">version</span> <span class="hljs-number">3</span> <span class="hljs-operator">or</span> later &lt;<span class="hljs-keyword">http</span>://gnu.org/licenses/gpl.html&gt;.
This is free software: you are free <span class="hljs-built_in">to</span> change <span class="hljs-operator">and</span> redistribute <span class="hljs-keyword">it</span>.
There is NO WARRANTY, <span class="hljs-built_in">to</span> <span class="hljs-operator">the</span> extent permitted <span class="hljs-keyword">by</span> law.

By Wood/Paronyan/Kotewicz/Drwięga/Volf
   Habermeier/Czaban/Greeff/Gotchac/Redmann

liyuechun:~ yuechunli$ </code></pre> 
  <h2 id="二设置chain-spec">二、设置chain spec</h2> 
  <p>PoA chain 需要设置一个创世区块。</p> 
  <pre class="prettyprint"><code class=" hljs json">{
  "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"DemoPoA"</span></span>,
  "<span class="hljs-attribute">engine</span>": <span class="hljs-value">{ "<span class="hljs-attribute">authorityRound</span>": <span class="hljs-value">{ "<span class="hljs-attribute">params</span>": <span class="hljs-value">{ "<span class="hljs-attribute">stepDuration</span>": <span class="hljs-value"><span class="hljs-string">"5"</span></span>, "<span class="hljs-attribute">validators</span>": <span class="hljs-value">{ "<span class="hljs-attribute">list</span>": <span class="hljs-value">[ ] </span>} </span>} </span>} </span>}</span>,
  "<span class="hljs-attribute">params</span>": <span class="hljs-value">{ "<span class="hljs-attribute">gasLimitBoundDivisor</span>": <span class="hljs-value"><span class="hljs-string">"0x0400"</span></span>, "<span class="hljs-attribute">maximumExtraDataSize</span>": <span class="hljs-value"><span class="hljs-string">"0x20"</span></span>, "<span class="hljs-attribute">minGasLimit</span>": <span class="hljs-value"><span class="hljs-string">"0x1388"</span></span>, "<span class="hljs-attribute">networkID</span>": <span class="hljs-value"><span class="hljs-string">"0x2323"</span> </span>}</span>,
  "<span class="hljs-attribute">genesis</span>": <span class="hljs-value">{ "<span class="hljs-attribute">seal</span>": <span class="hljs-value">{ "<span class="hljs-attribute">authorityRound</span>": <span class="hljs-value">{ "<span class="hljs-attribute">step</span>": <span class="hljs-value"><span class="hljs-string">"0x0"</span></span>, "<span class="hljs-attribute">signature</span>": <span class="hljs-value"><span class="hljs-string">"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span> </span>} </span>}</span>, "<span class="hljs-attribute">difficulty</span>": <span class="hljs-value"><span class="hljs-string">"0x20000"</span></span>, "<span class="hljs-attribute">gasLimit</span>": <span class="hljs-value"><span class="hljs-string">"0x5B8D80"</span> </span>}</span>,
  "<span class="hljs-attribute">accounts</span>": <span class="hljs-value">{ "<span class="hljs-attribute">0x0000000000000000000000000000000000000001</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"ecrecover"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">3000</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">0</span> </span>} </span>} </span>} </span>}</span>, "<span class="hljs-attribute">0x0000000000000000000000000000000000000002</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"sha256"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">60</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">12</span> </span>} </span>} </span>} </span>}</span>, "<span class="hljs-attribute">0x0000000000000000000000000000000000000003</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"ripemd160"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">600</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">120</span> </span>} </span>} </span>} </span>}</span>, "<span class="hljs-attribute">0x0000000000000000000000000000000000000004</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"identity"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">15</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">3</span> </span>} </span>} </span>} </span>} </span>} </span>}</code></pre> 
  <ul> 
   <li><code>stepDuration</code> 设定成5秒产生一个区块。</li> 
   <li><code>validators</code> 设定<code>Authority</code>的地方，目前先空著，后面创建<code>account</code>之后再回来填入。</li> 
  </ul> 
  <p>将上面的文件保存到桌面的一个文件中，保存为<code>demo-spec.json</code>。</p> 
  <h2 id="三设置两个节点">三、设置两个节点</h2> 
  <p>在我们这篇文章中，我们在同一台电脑设置两个节点，跟我们讲解<a href="http://liyuechun.org/2017/10/15/eth-private-blockchain/" rel="nofollow">以太坊私网建立 (2) - 同一台电脑／不同电脑运行多个节点</a>时，如果在同一台电脑设置两个节点，需要将<code>rpcport</code>和<code>port</code>设置为不同的值，否则就会发生冲突，POA chain中也是一样，需要将一些参数设置为不同的值。</p> 
  <ul> 
   <li><code>-d</code>：指定存储资料与账号的目录</li> 
   <li><code>--dport</code>：指定<strong>Parity</strong>的<strong>network port</strong>，可用来让其他<strong>node</strong>连接</li> 
   <li><code>--jsonrpc-port</code>：这是<strong>JSON RPC port</strong>，使用<strong>web3.js</strong>时会需要</li> 
   <li><code>ui-port</code>：<strong>Parity</strong>提供的<strong>Web-based UI port</strong></li> 
  </ul> 
  <p>可以用下列指令启动<code>Parity node</code>。</p> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">parity</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">chain</span> <span class="hljs-comment">demo</span><span class="hljs-literal">-</span><span class="hljs-comment">spec</span><span class="hljs-string">.</span><span class="hljs-comment">json</span> <span class="hljs-literal">-</span><span class="hljs-comment">d</span> <span class="hljs-comment">parity0</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">port</span> <span class="hljs-comment">30300</span>  <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">ui</span><span class="hljs-literal">-</span><span class="hljs-comment">port</span> <span class="hljs-comment">8180</span>  <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">jsonrpc</span><span class="hljs-literal">-</span><span class="hljs-comment">port</span> <span class="hljs-comment">8540</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">jsonrpc</span><span class="hljs-literal">-</span><span class="hljs-comment">apis</span> <span class="hljs-comment">web3</span><span class="hljs-string">,</span><span class="hljs-comment">eth</span><span class="hljs-string">,</span><span class="hljs-comment">net</span><span class="hljs-string">,</span><span class="hljs-comment">personal</span><span class="hljs-string">,</span><span class="hljs-comment">parity</span><span class="hljs-string">,</span><span class="hljs-comment">parity_set</span><span class="hljs-string">,</span><span class="hljs-comment">traces</span><span class="hljs-string">,</span><span class="hljs-comment">rpc</span><span class="hljs-string">,</span><span class="hljs-comment">parity_accounts</span></code></pre> 
  <p>除了打一长串的指令外，<code>Parity</code>也提供更为简洁的<code>config</code>档案设定方式，使用 <code>--config</code> 即可引用配置文件。</p> 
  <ul> 
   <li><code>node0</code> 使用如下配置文件 <code>node0.toml</code>：</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[parity]</span>
<span class="hljs-setting">chain = <span class="hljs-value"><span class="hljs-string">"demo-spec.json"</span></span></span>
<span class="hljs-setting">base_path = <span class="hljs-value"><span class="hljs-string">"parity0"</span></span></span>
<span class="hljs-title">[network]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">30300</span></span></span>
<span class="hljs-title">[rpc]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8540</span></span></span>
<span class="hljs-setting">apis = <span class="hljs-value">[<span class="hljs-string">"web3"</span>, <span class="hljs-string">"eth"</span>, <span class="hljs-string">"net"</span>, <span class="hljs-string">"personal"</span>, <span class="hljs-string">"parity"</span>, <span class="hljs-string">"parity_set"</span>, <span class="hljs-string">"traces"</span>, <span class="hljs-string">"rpc"</span>, <span class="hljs-string">"parity_accounts"</span>]</span></span>
<span class="hljs-setting">cors = <span class="hljs-value">[<span class="hljs-string">"*"</span>]</span></span>
<span class="hljs-title">[ui]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8180</span></span></span>
<span class="hljs-title">[websockets]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8456</span></span></span></code></pre> 
  <ul> 
   <li><code>node1</code> 使用如下配置文件 <code>node1.toml</code>：</li> 
  </ul> 
  <pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[parity]</span>
<span class="hljs-setting">chain = <span class="hljs-value"><span class="hljs-string">"demo-spec.json"</span></span></span>
<span class="hljs-setting">base_path = <span class="hljs-value"><span class="hljs-string">"parity1"</span></span></span>
<span class="hljs-title">[network]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">30301</span></span></span>
<span class="hljs-title">[rpc]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8541</span></span></span>
<span class="hljs-setting">apis = <span class="hljs-value">[<span class="hljs-string">"web3"</span>, <span class="hljs-string">"eth"</span>, <span class="hljs-string">"net"</span>, <span class="hljs-string">"personal"</span>, <span class="hljs-string">"parity"</span>, <span class="hljs-string">"parity_set"</span>, <span class="hljs-string">"traces"</span>, <span class="hljs-string">"rpc"</span>, <span class="hljs-string">"parity_accounts"</span>]</span></span>
<span class="hljs-setting">cors = <span class="hljs-value">[<span class="hljs-string">"*"</span>]</span></span>
<span class="hljs-title">[ui]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8181</span></span></span>
<span class="hljs-title">[websockets]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8457</span></span></span></code></pre> 
  <h2 id="四设置账号account">四、设置账号(Account)</h2> 
  <p>我们总共需要设置三个账号，两个<code>Authority</code>和一个<code>user</code>账号。</p> 
  <h3 id="第一步首先启动node0-parity-config-node0toml"><strong>第一步：</strong>首先启动<code>node0</code> : <code>parity --config node0.toml</code></h3> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/node0.gif" alt="启动 parity node0" title=""></p> 
  <p>打开网页<a href="http://localhost:8180" rel="nofollow">http://localhost:8180</a>，按照步骤创建一个用户账号。</p> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_7.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_8.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_9.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_10.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_12.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_13.png" alt="" title=""></p> 
  <ul> 
   <li>新增<code>Authority account</code>，使用<code>Restore</code>功能，为了示范一致性，我们使用 <code>node0</code> 当作 <code>pass phrase</code>。</li> 
  </ul> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_14.png" alt="Recover account from recovery phrase" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_15.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_16.png" alt="" title=""></p> 
  <p>到目前为止我们已经完成<code>node0</code>的账号设置。</p> 
  <ul> 
   <li><strong>Authority account：</strong><code>0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e</code></li> 
   <li><strong>User account：</strong><code>0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC</code></li> 
  </ul> 
  <h3 id="第二步设置node1的账号启动parity-config-node1toml步骤相同连接到-httplocalhost8181-pass-phrase使用-node1"><strong>第二步：</strong>设置<code>node1</code>的账号，启动<code>parity --config node1.toml</code>。步骤相同，连接到 <a href="http://localhost:8181" rel="nofollow">http://localhost:8181</a> ，<code>pass phrase</code>使用 <code>node1</code>。</h3> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_17.png" alt="启动 node1" title=""></p> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_21.png" alt="parity node1" title=""></p> 
  <p>这样就完成了<code>node1</code>的账号设置。</p> 
  <ul> 
   <li><strong>Authority account:</strong><code>0x00F9B30838ca40c8A53c672840acbDec6fCDb180</code></li> 
  </ul> 
  <h3 id="第三步将authority-account-写入-demo-specjson-文件"><strong>第三步：</strong>将Authority account 写入 demo-spec.json 文件</h3> 
  <pre class="prettyprint"><code class=" hljs bash"><span class="hljs-string">"validators"</span>: {
  <span class="hljs-string">"list"</span>: [
    <span class="hljs-string">"0x00F9B30838ca40c8A53c672840acbDec6fCDb180"</span>,
    <span class="hljs-string">"0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e"</span>
  ]
}</code></pre> 
  <p>再将<code>user account</code>加入<code>accounts</code>，並给一些<code>balance</code>，后续可以使用。</p> 
  <pre class="prettyprint"><code class=" hljs bash"><span class="hljs-string">"0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC"</span>: {
  <span class="hljs-string">"balance"</span>: <span class="hljs-string">"10000000000000000000000"</span>
}</code></pre> 
  <p>完成后的<code>demo-spec.json</code>如下：</p> 
  <pre class="prettyprint"><code class=" hljs json">{
  "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"DemoPoA"</span></span>,
  "<span class="hljs-attribute">engine</span>": <span class="hljs-value">{ "<span class="hljs-attribute">authorityRound</span>": <span class="hljs-value">{ "<span class="hljs-attribute">params</span>": <span class="hljs-value">{ "<span class="hljs-attribute">stepDuration</span>": <span class="hljs-value"><span class="hljs-string">"5"</span></span>, "<span class="hljs-attribute">validators</span>": <span class="hljs-value">{ "<span class="hljs-attribute">list</span>": <span class="hljs-value">[ <span class="hljs-string">"0x00F9B30838ca40c8A53c672840acbDec6fCDb180"</span>, <span class="hljs-string">"0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e"</span> ] </span>} </span>} </span>} </span>}</span>,
  "<span class="hljs-attribute">params</span>": <span class="hljs-value">{ "<span class="hljs-attribute">gasLimitBoundDivisor</span>": <span class="hljs-value"><span class="hljs-string">"0x0400"</span></span>, "<span class="hljs-attribute">maximumExtraDataSize</span>": <span class="hljs-value"><span class="hljs-string">"0x20"</span></span>, "<span class="hljs-attribute">minGasLimit</span>": <span class="hljs-value"><span class="hljs-string">"0x1388"</span></span>, "<span class="hljs-attribute">networkID</span>": <span class="hljs-value"><span class="hljs-string">"0x2323"</span> </span>}</span>,
  "<span class="hljs-attribute">genesis</span>": <span class="hljs-value">{ "<span class="hljs-attribute">seal</span>": <span class="hljs-value">{ "<span class="hljs-attribute">authorityRound</span>": <span class="hljs-value">{ "<span class="hljs-attribute">step</span>": <span class="hljs-value"><span class="hljs-string">"0x0"</span></span>, "<span class="hljs-attribute">signature</span>": <span class="hljs-value"><span class="hljs-string">"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span> </span>} </span>}</span>, "<span class="hljs-attribute">difficulty</span>": <span class="hljs-value"><span class="hljs-string">"0x20000"</span></span>, "<span class="hljs-attribute">gasLimit</span>": <span class="hljs-value"><span class="hljs-string">"0x5B8D80"</span> </span>}</span>,
  "<span class="hljs-attribute">accounts</span>": <span class="hljs-value">{ "<span class="hljs-attribute">0x0000000000000000000000000000000000000001</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"ecrecover"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">3000</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">0</span> </span>} </span>} </span>} </span>}</span>, "<span class="hljs-attribute">0x0000000000000000000000000000000000000002</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"sha256"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">60</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">12</span> </span>} </span>} </span>} </span>}</span>, "<span class="hljs-attribute">0x0000000000000000000000000000000000000003</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"ripemd160"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">600</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">120</span> </span>} </span>} </span>} </span>}</span>, "<span class="hljs-attribute">0x0064B0999c0142eE99aB0ceC054BAb53fe0a3EcC</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"10000000000000000000000"</span> </span>}</span>, "<span class="hljs-attribute">0x0000000000000000000000000000000000000004</span>": <span class="hljs-value">{ "<span class="hljs-attribute">balance</span>": <span class="hljs-value"><span class="hljs-string">"1"</span></span>, "<span class="hljs-attribute">builtin</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"identity"</span></span>, "<span class="hljs-attribute">pricing</span>": <span class="hljs-value">{ "<span class="hljs-attribute">linear</span>": <span class="hljs-value">{ "<span class="hljs-attribute">base</span>": <span class="hljs-value"><span class="hljs-number">15</span></span>, "<span class="hljs-attribute">word</span>": <span class="hljs-value"><span class="hljs-number">3</span> </span>} </span>} </span>} </span>} </span>} </span>}</code></pre> 
  <h2 id="五启动authority-node">五、启动Authority node</h2> 
  <p>为了启动<code>Authority node</code>来产生区块，我们必须设定负责产生<code>block</code>的<code>signer</code>，分別是 <code>node0</code> 和 <code>node1 account</code>。</p> 
  <h3 id="1第一步创建一个nodepwds文件写入node0与node1的password内容如下">1、第一步，创建一个<code>node.pwds</code>文件，写入<code>node0</code>与<code>node1</code>的<code>password</code>，内容如下：</h3> 
  <pre class="prettyprint"><code class=" hljs ">node0
node1</code></pre> 
  <h3 id="2第二步在node0toml文件中加入account及mining设置如下">2、第二步，在node0.toml文件中加入[account]及[mining]设置，如下：</h3> 
  <pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[parity]</span>
<span class="hljs-setting">chain = <span class="hljs-value"><span class="hljs-string">"demo-spec.json"</span></span></span>
<span class="hljs-setting">base_path = <span class="hljs-value"><span class="hljs-string">"parity0"</span></span></span>
<span class="hljs-title">[network]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">30300</span></span></span>
<span class="hljs-title">[rpc]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8540</span></span></span>
<span class="hljs-setting">apis = <span class="hljs-value">[<span class="hljs-string">"web3"</span>, <span class="hljs-string">"eth"</span>, <span class="hljs-string">"net"</span>, <span class="hljs-string">"personal"</span>, <span class="hljs-string">"parity"</span>, <span class="hljs-string">"parity_set"</span>, <span class="hljs-string">"traces"</span>, <span class="hljs-string">"rpc"</span>, <span class="hljs-string">"parity_accounts"</span>]</span></span>
<span class="hljs-setting">cors = <span class="hljs-value">[<span class="hljs-string">"*"</span>]</span></span>
<span class="hljs-title">[ui]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8180</span></span></span>
<span class="hljs-title">[account]</span>
<span class="hljs-setting">password = <span class="hljs-value">[<span class="hljs-string">"node.pwds"</span>]</span></span>
<span class="hljs-title">[mining]</span>
<span class="hljs-setting">engine_signer = <span class="hljs-value"><span class="hljs-string">"0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e"</span></span></span>
<span class="hljs-setting">reseal_on_txs = <span class="hljs-value"><span class="hljs-string">"none"</span></span></span></code></pre> 
  <h3 id="3第三步在node1toml文件中加入account及mining设置如下">3、第三步，在node1.toml文件中加入[account]及[mining]设置，如下：</h3> 
  <pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[parity]</span>
<span class="hljs-setting">chain = <span class="hljs-value"><span class="hljs-string">"demo-spec.json"</span></span></span>
<span class="hljs-setting">base_path = <span class="hljs-value"><span class="hljs-string">"parity1"</span></span></span>
<span class="hljs-title">[network]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">30301</span></span></span>
<span class="hljs-title">[rpc]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8541</span></span></span>
<span class="hljs-setting">apis = <span class="hljs-value">[<span class="hljs-string">"web3"</span>, <span class="hljs-string">"eth"</span>, <span class="hljs-string">"net"</span>, <span class="hljs-string">"personal"</span>, <span class="hljs-string">"parity"</span>, <span class="hljs-string">"parity_set"</span>, <span class="hljs-string">"traces"</span>, <span class="hljs-string">"rpc"</span>, <span class="hljs-string">"parity_accounts"</span>]</span></span>
<span class="hljs-setting">cors = <span class="hljs-value">[<span class="hljs-string">"*"</span>]</span></span>
<span class="hljs-title">[ui]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8181</span></span></span>
<span class="hljs-title">[websockets]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8457</span></span></span>
<span class="hljs-title">[account]</span>
<span class="hljs-setting">password = <span class="hljs-value">[<span class="hljs-string">"node.pwds"</span>]</span></span>
<span class="hljs-title">[mining]</span>
<span class="hljs-setting">engine_signer = <span class="hljs-value"><span class="hljs-string">"0x00F9B30838ca40c8A53c672840acbDec6fCDb180"</span></span></span>
<span class="hljs-setting">reseal_on_txs = <span class="hljs-value"><span class="hljs-string">"none"</span></span></span></code></pre> 
  <h3 id="4第四步step-4-分別启动两个node">4、第四步，Step 4 分別启动两个node</h3> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">parity</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">config</span> <span class="hljs-comment">node0</span><span class="hljs-string">.</span><span class="hljs-comment">toml</span></code></pre> 
  <pre class="prettyprint"><code class=" hljs brainfuck"><span class="hljs-comment">parity</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">config</span> <span class="hljs-comment">node1</span><span class="hljs-string">.</span><span class="hljs-comment">toml</span></code></pre> 
  <h2 id="六连接两个节点">六、连接两个节点</h2> 
  <p>使用<code>Postman</code>透过<code>JSON RPC</code>来测试。</p> 
  <h3 id="1第一步post下列json数据至-httplocalhost8540-以取得-node0-的enode资料">1、第一步，Post下列JSON数据至 <a href="http://localhost:8540" rel="nofollow">http://localhost:8540</a> 以取得 node0 的enode资料</h3> 
  <pre class="prettyprint"><code class=" hljs json">{
 "<span class="hljs-attribute">jsonrpc</span>":<span class="hljs-value"><span class="hljs-string">"2.0"</span></span>,
 "<span class="hljs-attribute">method</span>":<span class="hljs-value"><span class="hljs-string">"parity_enode"</span></span>,
 "<span class="hljs-attribute">params</span>":<span class="hljs-value">[]</span>,
 "<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-number">0</span> </span>}</code></pre> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_22.png" alt="" title=""></p> 
  <p>获取到的数据如下：</p> 
  <pre class="prettyprint"><code class=" hljs json">{
    "<span class="hljs-attribute">jsonrpc</span>": <span class="hljs-value"><span class="hljs-string">"2.0"</span></span>,
    "<span class="hljs-attribute">result</span>": <span class="hljs-value"><span class="hljs-string">"enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300"</span></span>,
    "<span class="hljs-attribute">id</span>": <span class="hljs-value"><span class="hljs-number">0</span> </span>}</code></pre> 
  <p><code>"enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300"</code>是<code>node0</code>的标识。下一步中我们将将它加入到<code>node1</code>中以实现两个节点之间的连接。</p> 
  <h3 id="2第二步将-node0-的enode加入-node1-post下列jsons数据至node1-httplocalhost8541">2、第二步，将 node0 的enode加入 node1 ，Post下列JSONs数据至node1 (<a href="http://localhost:8541" rel="nofollow">http://localhost:8541</a> )</h3> 
  <pre class="prettyprint"><code class=" hljs json">{
 "<span class="hljs-attribute">jsonrpc</span>":<span class="hljs-value"><span class="hljs-string">"2.0"</span></span>,
 "<span class="hljs-attribute">method</span>":<span class="hljs-value"><span class="hljs-string">"parity_addReservedPeer"</span></span>,
 "<span class="hljs-attribute">params</span>":<span class="hljs-value">[<span class="hljs-string">"enode://cfb3af513da3a7a8138450f0dc01fa38cb2ac837744dc645038940287f4dce3f416f0e7e17fd10619a263c360d9324fd2dcd8753c4500fcc54cf84e076b39cd6@192.168.10.101:30300"</span>]</span>,
 "<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-number">0</span> </span>}</code></pre> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_23.png" alt="" title=""></p> 
  <p>返回的数据如下，<code>result</code>为true，说明连接成功：</p> 
  <pre class="prettyprint"><code class=" hljs json">{
    "<span class="hljs-attribute">jsonrpc</span>": <span class="hljs-value"><span class="hljs-string">"2.0"</span></span>,
    "<span class="hljs-attribute">result</span>": <span class="hljs-value"><span class="hljs-literal">true</span></span>,
    "<span class="hljs-attribute">id</span>": <span class="hljs-value"><span class="hljs-number">0</span> </span>}</code></pre> 
  <p>再切换到<code>node1</code>的终端，会看到下面的数据：</p> 
  <pre class="prettyprint"><code class=" hljs lasso"><span class="hljs-number">1</span>/<span class="hljs-number">25</span> peers   <span class="hljs-number">13</span> KiB chain <span class="hljs-number">11</span> KiB db <span class="hljs-number">0</span> <span class="hljs-built_in">bytes</span> <span class="hljs-built_in">queue</span> <span class="hljs-number">10</span> KiB sync  RPC:  <span class="hljs-number">0</span> conn,  <span class="hljs-number">0</span> req/s,  <span class="hljs-number">24</span> µs</code></pre> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_25.png" alt="" title=""></p> 
  <p><strong>如上图所示，表示连接成功。</strong></p> 
  <h2 id="七发送交易">七、发送交易</h2> 
  <p>在我们这个案例中，我们一个创建了三个账号，一个用户账号，两个<code>POA</code>账号，刚开始的时候我们为用户账号初始化了<code>10000 ETH</code>。如下图所示，账号与账号之间可以相互转账。</p> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_26.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_27.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_28.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_30.png" alt="" title=""> <br> <img src="http://om1c35wrq.bkt.clouddn.com/Snip20171102_31.png" alt="" title=""></p> 
  <h2 id="八分享给其他节点">八、分享给其他节点</h2> 
  <p>在开发时通常会将node跑在server上，让其他人可以通过<code>JSON RPC port</code>连接上去使用，此时只要在<code>config</code>文件里面加入 <code>[interface]</code> 设置即可。</p> 
  <p>假设<code>server ip</code>为<code>192.168.1.5</code>，将 <code>node0.toml</code> 修改如下：</p> 
  <pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[parity]</span>
<span class="hljs-setting">chain = <span class="hljs-value"><span class="hljs-string">"demo-spec.json"</span></span></span>
<span class="hljs-setting">base_path = <span class="hljs-value"><span class="hljs-string">"parity0"</span></span></span>
<span class="hljs-title">[network]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">30300</span></span></span>
<span class="hljs-title">[rpc]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8540</span></span></span>
<span class="hljs-setting">apis = <span class="hljs-value">[<span class="hljs-string">"web3"</span>, <span class="hljs-string">"eth"</span>, <span class="hljs-string">"net"</span>, <span class="hljs-string">"personal"</span>, <span class="hljs-string">"parity"</span>, <span class="hljs-string">"parity_set"</span>, <span class="hljs-string">"traces"</span>, <span class="hljs-string">"rpc"</span>, <span class="hljs-string">"parity_accounts"</span>]</span></span>
<span class="hljs-setting">cors = <span class="hljs-value">[<span class="hljs-string">"*"</span>]</span></span>
<span class="hljs-setting">interface = <span class="hljs-value"><span class="hljs-string">"192.168.1.5"</span></span></span>
<span class="hljs-title">[ui]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8180</span></span></span>
<span class="hljs-title">[account]</span>
<span class="hljs-setting">password = <span class="hljs-value">[<span class="hljs-string">"node.pwds"</span>]</span></span>
<span class="hljs-title">[mining]</span>
<span class="hljs-setting">engine_signer = <span class="hljs-value"><span class="hljs-string">"0x00Bd138aBD70e2F00903268F3Db08f2D25677C9e"</span></span></span>
<span class="hljs-setting">reseal_on_txs = <span class="hljs-value"><span class="hljs-string">"none"</span></span></span></code></pre> 
  <p><code>node1.toml</code> 修改如下：</p> 
  <pre class="prettyprint"><code class=" hljs ini"><span class="hljs-title">[parity]</span>
<span class="hljs-setting">chain = <span class="hljs-value"><span class="hljs-string">"demo-spec.json"</span></span></span>
<span class="hljs-setting">base_path = <span class="hljs-value"><span class="hljs-string">"parity1"</span></span></span>
<span class="hljs-title">[network]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">30301</span></span></span>
<span class="hljs-title">[rpc]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8541</span></span></span>
<span class="hljs-setting">apis = <span class="hljs-value">[<span class="hljs-string">"web3"</span>, <span class="hljs-string">"eth"</span>, <span class="hljs-string">"net"</span>, <span class="hljs-string">"personal"</span>, <span class="hljs-string">"parity"</span>, <span class="hljs-string">"parity_set"</span>, <span class="hljs-string">"traces"</span>, <span class="hljs-string">"rpc"</span>, <span class="hljs-string">"parity_accounts"</span>]</span></span>
<span class="hljs-setting">interface = <span class="hljs-value"><span class="hljs-string">"192.168.1.5"</span></span></span>
<span class="hljs-setting">cors = <span class="hljs-value">[<span class="hljs-string">"*"</span>]</span></span>
<span class="hljs-title">[ui]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8181</span></span></span>
<span class="hljs-title">[websockets]</span>
<span class="hljs-setting">port = <span class="hljs-value"><span class="hljs-number">8457</span></span></span>
<span class="hljs-title">[account]</span>
<span class="hljs-setting">password = <span class="hljs-value">[<span class="hljs-string">"node.pwds"</span>]</span></span>
<span class="hljs-title">[mining]</span>
<span class="hljs-setting">engine_signer = <span class="hljs-value"><span class="hljs-string">"0x00F9B30838ca40c8A53c672840acbDec6fCDb180"</span></span></span>
<span class="hljs-setting">reseal_on_txs = <span class="hljs-value"><span class="hljs-string">"none"</span></span></span></code></pre> 
  <h2 id="技术交流">技术交流</h2> 
  <ul> 
   <li><p>区块链技术交流QQ群：348924182</p></li> 
   <li><p>「区块链部落」官方公众号</p></li> 
  </ul> 
  <p><img src="http://om1c35wrq.bkt.clouddn.com/%E5%8C%BA%E5%9D%97%E9%93%BE%E9%83%A8%E8%90%BD.png" alt="" title=""></p> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/liyuechun520/article/details/79747215,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/liyuechun520/article/details/79747215,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
