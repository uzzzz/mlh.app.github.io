<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>以太坊部署调用合约 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="以太坊部署调用合约" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/scylhy/article/details/83450156 以太坊实验 在自己的电脑上安装配置以太坊开发环境，搭建以太坊私有链，编写一个简单的智能合约，通过以太坊JSON RPC 和JavaScript API编程接口将其部署到所创建的以太坊私有链，并可调用合约获得正确的合约执行结果。 本次作业的最终提交物是一个描述上述过程的完整文档，请把整个过程用文字和截图描述清楚。 本机已经安装go 安装以太坊Ethereum brew update brew upgrade brew tap ethereum/ethereum brew install ethereum 安装solc编译器 npm install solc 创建账户 geth account new 编写创始块文件 { &quot;config&quot;: { &quot;chainId&quot;: 10, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;nonce&quot;: &quot;0x0000000000000042&quot;, &quot;difficulty&quot;: &quot;0x1&quot;, &quot;alloc&quot;: { &quot;14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;:{ &quot;balance&quot;: &quot;20000009800000000000000000000&quot; }, &quot;aa25a7b683fe0564fe6b2a2574e10dc886ecb3ce&quot;:{ &quot;balance&quot;: &quot;20000009800000000000000000000&quot; } }, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000000&quot;, &quot;timestamp&quot;: &quot;0x00&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;extraData&quot;: &quot;0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa&quot;, &quot;gasLimit&quot;: &quot;0xb2d05e00&quot; } 配置自动解锁账户的脚本 在~/Library/Ethereum下创建password文件内容为创建账户的密码 编写启动脚本 #!/bin/bash geth --rpc --rpcaddr=&quot;0.0.0.0&quot; --rpcport &quot;8545&quot; --rpccorsdomain=&quot;*&quot; --unlock &#39;0,1&#39; --password ~/Library/Ethereum/password --nodiscover --maxpeers &#39;5&#39; --n etworkid &#39;123&#39; --datadir &#39;~/Library/Ethereum&#39; console --rpcapi &quot;db,eth,net,web3,personal,admin,miner&quot; 启动网络 ./start.sh 通过JRPC与网络交互（均编写在脚本中，方便下次使用） curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_getBalance&quot;,&quot;params&quot;:[&quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac7 0c&quot;,&quot;latest&quot;],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 返回的结果 localhost:eth liu$ ./curlexample.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x409f9fadbc2695e2f02d4a82&quot;} 测试合约，后续需需要通过event的返回log的方式查看调用结果信息 localhost:eth liu$ cat Hello.sol pragma solidity ^0.4.17; contract Hello { event Print(uint); function multiply(uint input)public returns (uint) { emit Print(input * 7); return input * 7; } //print name function print(string name) public pure returns (string) { return name; } } solc编译合约，出现问题,但不影响后续的操作 localhost:eth liu$ solc Hello.sol (node:1915) [DEP0013] DeprecationWarning: Calling an asynchronous function without callback is deprecated. (node:1915) [DEP0013] DeprecationWarning: Calling an asynchronous function without callback is deprecated. localhost:eth liu$ cat contracts/Hello.sol\:Hello.bin 608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029 localhost:eth liu$ localhost:eth liu$ cat contracts/Hello.sol\:Hello.abi [{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;name&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;print&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;input&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Print&quot;,&quot;type&quot;:&quot;event&quot;}]localhost:eth liu$ 部署调用合约 localhost:eth liu$ cat curlsend.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_sendTransaction&quot;,&quot;params&quot;:[{ &quot;from&quot;: &quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;, &quot;gas&quot;: &quot;0x76c000&quot;, &quot;data&quot;: &quot;0x608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029&quot; }],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ 调用 localhost:eth liu$ ./curlsend.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x649cddcacd03f12d860a37b21b47af0ec90375e2eed81c132dc8d451bb09c8e2&quot;} geth客户端,产生提交的合约地址，后续调用合约要用 合约地址0x234C5DB1913e7a046387222eF3960576D22A90c3 &gt; INFO [10-27|21:15:22.779] Submitted contract creation fullhash=0x994e4af5dee931bdec20c422c06b9c58e11a2aa22377b704ea4cb669b230e0ce contract=0x234C5DB1913e7a046387222eF3960576D22A90c3 &gt; txpool.status { pending: 1, queued: 0 } &gt; 启动挖矿，确认交易 &gt; miner.start() &gt; txpool.status { pending: 0, queued: 0 } 调用合约，脚本中to对应的value为合约地址，获得交易的hash值，需要挖矿确认交易 合约地址：0x234C5DB1913e7a046387222eF3960576D22A90c3 调用脚本中的data，为调用合约的签名信息(hash值)， web3.sha3(&quot;multiply(uint256)&quot;).substring(0, 8)确定前4字节的数据：0xc6888f 接着需要输入4字节的输入参数数据，假设传入6对应uint256数据为 0000000000000000000000000000000000000000000000000000000000000006 两组hash值拼接即为data数据 localhost:eth liu$ cat curlcall.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_sendTransaction&quot;,&quot;params&quot;:[{ &quot;from&quot;: &quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;, &quot;to&quot;: &quot;0x234C5DB1913e7a046387222eF3960576D22A90c3&quot;, &quot;data&quot;: &quot;0xc6888fa10000000000000000000000000000000000000000000000000000000000000006&quot; }],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ ./curlcall.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;} 通过交易的hash值获取交易信息 交易的hash值: 0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22 localhost:eth liu$ cat curlget.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_getTransactionReceipt&quot;,&quot;params&quot;:[ &quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot; ],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ 查看交易，从logs.data中可以看到结果，该log是通过event的方式返回42(6*7) 0x000000000000000000000000000000000000000000000000000000000000002a localhost:eth liu$ ./curlget.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:{&quot;blockHash&quot;:&quot;0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e&quot;,&quot;blockNumber&quot;:&quot;0x3ab&quot;,&quot;contractAddress&quot;:null,&quot;cumulativeGasUsed&quot;:&quot;0x592a&quot;,&quot;from&quot;:&quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;,&quot;gasUsed&quot;:&quot;0x592a&quot;,&quot;logs&quot;:[{&quot;address&quot;:&quot;0x234c5db1913e7a046387222ef3960576d22a90c3&quot;,&quot;topics&quot;:[&quot;0x24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da&quot;],&quot;data&quot;:&quot;0x000000000000000000000000000000000000000000000000000000000000002a&quot;,&quot;blockNumber&quot;:&quot;0x3ab&quot;,&quot;transactionHash&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;,&quot;transactionIndex&quot;:&quot;0x0&quot;,&quot;blockHash&quot;:&quot;0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e&quot;,&quot;logIndex&quot;:&quot;0x0&quot;,&quot;removed&quot;:false}],&quot;logsBloom&quot;:&quot;0x00000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000200000000000000000000000002000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;root&quot;:&quot;0x00ad10c4db648a69a37fdf87d3cdc29228807e00d9cd7d5d30b957f6303f2e27&quot;,&quot;to&quot;:&quot;0x234c5db1913e7a046387222ef3960576d22a90c3&quot;,&quot;transactionHash&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;,&quot;transactionIndex&quot;:&quot;0x0&quot;}} localhost:eth liu$ 在实验中发现，一些因版本更新造成API发生变化的问题，以及solidity部分语法变化。 阅读更多" />
<meta property="og:description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/scylhy/article/details/83450156 以太坊实验 在自己的电脑上安装配置以太坊开发环境，搭建以太坊私有链，编写一个简单的智能合约，通过以太坊JSON RPC 和JavaScript API编程接口将其部署到所创建的以太坊私有链，并可调用合约获得正确的合约执行结果。 本次作业的最终提交物是一个描述上述过程的完整文档，请把整个过程用文字和截图描述清楚。 本机已经安装go 安装以太坊Ethereum brew update brew upgrade brew tap ethereum/ethereum brew install ethereum 安装solc编译器 npm install solc 创建账户 geth account new 编写创始块文件 { &quot;config&quot;: { &quot;chainId&quot;: 10, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;nonce&quot;: &quot;0x0000000000000042&quot;, &quot;difficulty&quot;: &quot;0x1&quot;, &quot;alloc&quot;: { &quot;14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;:{ &quot;balance&quot;: &quot;20000009800000000000000000000&quot; }, &quot;aa25a7b683fe0564fe6b2a2574e10dc886ecb3ce&quot;:{ &quot;balance&quot;: &quot;20000009800000000000000000000&quot; } }, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000000&quot;, &quot;timestamp&quot;: &quot;0x00&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;extraData&quot;: &quot;0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa&quot;, &quot;gasLimit&quot;: &quot;0xb2d05e00&quot; } 配置自动解锁账户的脚本 在~/Library/Ethereum下创建password文件内容为创建账户的密码 编写启动脚本 #!/bin/bash geth --rpc --rpcaddr=&quot;0.0.0.0&quot; --rpcport &quot;8545&quot; --rpccorsdomain=&quot;*&quot; --unlock &#39;0,1&#39; --password ~/Library/Ethereum/password --nodiscover --maxpeers &#39;5&#39; --n etworkid &#39;123&#39; --datadir &#39;~/Library/Ethereum&#39; console --rpcapi &quot;db,eth,net,web3,personal,admin,miner&quot; 启动网络 ./start.sh 通过JRPC与网络交互（均编写在脚本中，方便下次使用） curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_getBalance&quot;,&quot;params&quot;:[&quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac7 0c&quot;,&quot;latest&quot;],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 返回的结果 localhost:eth liu$ ./curlexample.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x409f9fadbc2695e2f02d4a82&quot;} 测试合约，后续需需要通过event的返回log的方式查看调用结果信息 localhost:eth liu$ cat Hello.sol pragma solidity ^0.4.17; contract Hello { event Print(uint); function multiply(uint input)public returns (uint) { emit Print(input * 7); return input * 7; } //print name function print(string name) public pure returns (string) { return name; } } solc编译合约，出现问题,但不影响后续的操作 localhost:eth liu$ solc Hello.sol (node:1915) [DEP0013] DeprecationWarning: Calling an asynchronous function without callback is deprecated. (node:1915) [DEP0013] DeprecationWarning: Calling an asynchronous function without callback is deprecated. localhost:eth liu$ cat contracts/Hello.sol\:Hello.bin 608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029 localhost:eth liu$ localhost:eth liu$ cat contracts/Hello.sol\:Hello.abi [{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;name&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;print&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;input&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Print&quot;,&quot;type&quot;:&quot;event&quot;}]localhost:eth liu$ 部署调用合约 localhost:eth liu$ cat curlsend.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_sendTransaction&quot;,&quot;params&quot;:[{ &quot;from&quot;: &quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;, &quot;gas&quot;: &quot;0x76c000&quot;, &quot;data&quot;: &quot;0x608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029&quot; }],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ 调用 localhost:eth liu$ ./curlsend.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x649cddcacd03f12d860a37b21b47af0ec90375e2eed81c132dc8d451bb09c8e2&quot;} geth客户端,产生提交的合约地址，后续调用合约要用 合约地址0x234C5DB1913e7a046387222eF3960576D22A90c3 &gt; INFO [10-27|21:15:22.779] Submitted contract creation fullhash=0x994e4af5dee931bdec20c422c06b9c58e11a2aa22377b704ea4cb669b230e0ce contract=0x234C5DB1913e7a046387222eF3960576D22A90c3 &gt; txpool.status { pending: 1, queued: 0 } &gt; 启动挖矿，确认交易 &gt; miner.start() &gt; txpool.status { pending: 0, queued: 0 } 调用合约，脚本中to对应的value为合约地址，获得交易的hash值，需要挖矿确认交易 合约地址：0x234C5DB1913e7a046387222eF3960576D22A90c3 调用脚本中的data，为调用合约的签名信息(hash值)， web3.sha3(&quot;multiply(uint256)&quot;).substring(0, 8)确定前4字节的数据：0xc6888f 接着需要输入4字节的输入参数数据，假设传入6对应uint256数据为 0000000000000000000000000000000000000000000000000000000000000006 两组hash值拼接即为data数据 localhost:eth liu$ cat curlcall.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_sendTransaction&quot;,&quot;params&quot;:[{ &quot;from&quot;: &quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;, &quot;to&quot;: &quot;0x234C5DB1913e7a046387222eF3960576D22A90c3&quot;, &quot;data&quot;: &quot;0xc6888fa10000000000000000000000000000000000000000000000000000000000000006&quot; }],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ ./curlcall.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;} 通过交易的hash值获取交易信息 交易的hash值: 0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22 localhost:eth liu$ cat curlget.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_getTransactionReceipt&quot;,&quot;params&quot;:[ &quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot; ],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ 查看交易，从logs.data中可以看到结果，该log是通过event的方式返回42(6*7) 0x000000000000000000000000000000000000000000000000000000000000002a localhost:eth liu$ ./curlget.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:{&quot;blockHash&quot;:&quot;0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e&quot;,&quot;blockNumber&quot;:&quot;0x3ab&quot;,&quot;contractAddress&quot;:null,&quot;cumulativeGasUsed&quot;:&quot;0x592a&quot;,&quot;from&quot;:&quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;,&quot;gasUsed&quot;:&quot;0x592a&quot;,&quot;logs&quot;:[{&quot;address&quot;:&quot;0x234c5db1913e7a046387222ef3960576d22a90c3&quot;,&quot;topics&quot;:[&quot;0x24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da&quot;],&quot;data&quot;:&quot;0x000000000000000000000000000000000000000000000000000000000000002a&quot;,&quot;blockNumber&quot;:&quot;0x3ab&quot;,&quot;transactionHash&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;,&quot;transactionIndex&quot;:&quot;0x0&quot;,&quot;blockHash&quot;:&quot;0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e&quot;,&quot;logIndex&quot;:&quot;0x0&quot;,&quot;removed&quot;:false}],&quot;logsBloom&quot;:&quot;0x00000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000200000000000000000000000002000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;root&quot;:&quot;0x00ad10c4db648a69a37fdf87d3cdc29228807e00d9cd7d5d30b957f6303f2e27&quot;,&quot;to&quot;:&quot;0x234c5db1913e7a046387222ef3960576d22a90c3&quot;,&quot;transactionHash&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;,&quot;transactionIndex&quot;:&quot;0x0&quot;}} localhost:eth liu$ 在实验中发现，一些因版本更新造成API发生变化的问题，以及solidity部分语法变化。 阅读更多" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-27T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/scylhy/article/details/83450156 以太坊实验 在自己的电脑上安装配置以太坊开发环境，搭建以太坊私有链，编写一个简单的智能合约，通过以太坊JSON RPC 和JavaScript API编程接口将其部署到所创建的以太坊私有链，并可调用合约获得正确的合约执行结果。 本次作业的最终提交物是一个描述上述过程的完整文档，请把整个过程用文字和截图描述清楚。 本机已经安装go 安装以太坊Ethereum brew update brew upgrade brew tap ethereum/ethereum brew install ethereum 安装solc编译器 npm install solc 创建账户 geth account new 编写创始块文件 { &quot;config&quot;: { &quot;chainId&quot;: 10, &quot;homesteadBlock&quot;: 0, &quot;eip155Block&quot;: 0, &quot;eip158Block&quot;: 0 }, &quot;nonce&quot;: &quot;0x0000000000000042&quot;, &quot;difficulty&quot;: &quot;0x1&quot;, &quot;alloc&quot;: { &quot;14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;:{ &quot;balance&quot;: &quot;20000009800000000000000000000&quot; }, &quot;aa25a7b683fe0564fe6b2a2574e10dc886ecb3ce&quot;:{ &quot;balance&quot;: &quot;20000009800000000000000000000&quot; } }, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;coinbase&quot;: &quot;0x0000000000000000000000000000000000000000&quot;, &quot;timestamp&quot;: &quot;0x00&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;extraData&quot;: &quot;0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa&quot;, &quot;gasLimit&quot;: &quot;0xb2d05e00&quot; } 配置自动解锁账户的脚本 在~/Library/Ethereum下创建password文件内容为创建账户的密码 编写启动脚本 #!/bin/bash geth --rpc --rpcaddr=&quot;0.0.0.0&quot; --rpcport &quot;8545&quot; --rpccorsdomain=&quot;*&quot; --unlock &#39;0,1&#39; --password ~/Library/Ethereum/password --nodiscover --maxpeers &#39;5&#39; --n etworkid &#39;123&#39; --datadir &#39;~/Library/Ethereum&#39; console --rpcapi &quot;db,eth,net,web3,personal,admin,miner&quot; 启动网络 ./start.sh 通过JRPC与网络交互（均编写在脚本中，方便下次使用） curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_getBalance&quot;,&quot;params&quot;:[&quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac7 0c&quot;,&quot;latest&quot;],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 返回的结果 localhost:eth liu$ ./curlexample.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x409f9fadbc2695e2f02d4a82&quot;} 测试合约，后续需需要通过event的返回log的方式查看调用结果信息 localhost:eth liu$ cat Hello.sol pragma solidity ^0.4.17; contract Hello { event Print(uint); function multiply(uint input)public returns (uint) { emit Print(input * 7); return input * 7; } //print name function print(string name) public pure returns (string) { return name; } } solc编译合约，出现问题,但不影响后续的操作 localhost:eth liu$ solc Hello.sol (node:1915) [DEP0013] DeprecationWarning: Calling an asynchronous function without callback is deprecated. (node:1915) [DEP0013] DeprecationWarning: Calling an asynchronous function without callback is deprecated. localhost:eth liu$ cat contracts/Hello.sol\\:Hello.bin 608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029 localhost:eth liu$ localhost:eth liu$ cat contracts/Hello.sol\\:Hello.abi [{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;name&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;print&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;pure&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;input&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;multiply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Print&quot;,&quot;type&quot;:&quot;event&quot;}]localhost:eth liu$ 部署调用合约 localhost:eth liu$ cat curlsend.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_sendTransaction&quot;,&quot;params&quot;:[{ &quot;from&quot;: &quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;, &quot;gas&quot;: &quot;0x76c000&quot;, &quot;data&quot;: &quot;0x608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029&quot; }],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ 调用 localhost:eth liu$ ./curlsend.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x649cddcacd03f12d860a37b21b47af0ec90375e2eed81c132dc8d451bb09c8e2&quot;} geth客户端,产生提交的合约地址，后续调用合约要用 合约地址0x234C5DB1913e7a046387222eF3960576D22A90c3 &gt; INFO [10-27|21:15:22.779] Submitted contract creation fullhash=0x994e4af5dee931bdec20c422c06b9c58e11a2aa22377b704ea4cb669b230e0ce contract=0x234C5DB1913e7a046387222eF3960576D22A90c3 &gt; txpool.status { pending: 1, queued: 0 } &gt; 启动挖矿，确认交易 &gt; miner.start() &gt; txpool.status { pending: 0, queued: 0 } 调用合约，脚本中to对应的value为合约地址，获得交易的hash值，需要挖矿确认交易 合约地址：0x234C5DB1913e7a046387222eF3960576D22A90c3 调用脚本中的data，为调用合约的签名信息(hash值)， web3.sha3(&quot;multiply(uint256)&quot;).substring(0, 8)确定前4字节的数据：0xc6888f 接着需要输入4字节的输入参数数据，假设传入6对应uint256数据为 0000000000000000000000000000000000000000000000000000000000000006 两组hash值拼接即为data数据 localhost:eth liu$ cat curlcall.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_sendTransaction&quot;,&quot;params&quot;:[{ &quot;from&quot;: &quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;, &quot;to&quot;: &quot;0x234C5DB1913e7a046387222eF3960576D22A90c3&quot;, &quot;data&quot;: &quot;0xc6888fa10000000000000000000000000000000000000000000000000000000000000006&quot; }],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ ./curlcall.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;} 通过交易的hash值获取交易信息 交易的hash值: 0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22 localhost:eth liu$ cat curlget.sh #!/bin/bash curl -X POST -H &quot;Content-Type: application/json&quot; --data &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_getTransactionReceipt&quot;,&quot;params&quot;:[ &quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot; ],&quot;id&quot;:1}&#39; http://0.0.0.0:8545 localhost:eth liu$ 查看交易，从logs.data中可以看到结果，该log是通过event的方式返回42(6*7) 0x000000000000000000000000000000000000000000000000000000000000002a localhost:eth liu$ ./curlget.sh {&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;result&quot;:{&quot;blockHash&quot;:&quot;0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e&quot;,&quot;blockNumber&quot;:&quot;0x3ab&quot;,&quot;contractAddress&quot;:null,&quot;cumulativeGasUsed&quot;:&quot;0x592a&quot;,&quot;from&quot;:&quot;0x14b1d82b1c851ea9a6623a20d9865677ecdac70c&quot;,&quot;gasUsed&quot;:&quot;0x592a&quot;,&quot;logs&quot;:[{&quot;address&quot;:&quot;0x234c5db1913e7a046387222ef3960576d22a90c3&quot;,&quot;topics&quot;:[&quot;0x24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da&quot;],&quot;data&quot;:&quot;0x000000000000000000000000000000000000000000000000000000000000002a&quot;,&quot;blockNumber&quot;:&quot;0x3ab&quot;,&quot;transactionHash&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;,&quot;transactionIndex&quot;:&quot;0x0&quot;,&quot;blockHash&quot;:&quot;0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e&quot;,&quot;logIndex&quot;:&quot;0x0&quot;,&quot;removed&quot;:false}],&quot;logsBloom&quot;:&quot;0x00000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000200000000000000000000000002000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;root&quot;:&quot;0x00ad10c4db648a69a37fdf87d3cdc29228807e00d9cd7d5d30b957f6303f2e27&quot;,&quot;to&quot;:&quot;0x234c5db1913e7a046387222ef3960576d22a90c3&quot;,&quot;transactionHash&quot;:&quot;0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22&quot;,&quot;transactionIndex&quot;:&quot;0x0&quot;}} localhost:eth liu$ 在实验中发现，一些因版本更新造成API发生变化的问题，以及solidity部分语法变化。 阅读更多","@type":"BlogPosting","url":"/2018/10/27/485559dc212bdcdad8beac985c75c4f8.html","headline":"以太坊部署调用合约","dateModified":"2018-10-27T00:00:00+08:00","datePublished":"2018-10-27T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/10/27/485559dc212bdcdad8beac985c75c4f8.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>以太坊部署调用合约</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/scylhy/article/details/83450156 
 </div> 
 <div class="markdown_views prism-github-gist"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h4><a id="_0"></a>以太坊实验</h4> 
  <pre><code>在自己的电脑上安装配置以太坊开发环境，搭建以太坊私有链，编写一个简单的智能合约，通过以太坊JSON RPC	和JavaScript API编程接口将其部署到所创建的以太坊私有链，并可调用合约获得正确的合约执行结果。
本次作业的最终提交物是一个描述上述过程的完整文档，请把整个过程用文字和截图描述清楚。
</code></pre> 
  <ul> 
   <li>本机已经安装go</li> 
   <li>安装以太坊Ethereum</li> 
  </ul> 
  <pre><code class="prism language-bash">brew update
brew upgrade
brew tap ethereum/ethereum
brew <span class="token function">install</span> ethereum
</code></pre> 
  <ul> 
   <li>安装solc编译器</li> 
  </ul> 
  <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> solc
</code></pre> 
  <ul> 
   <li>创建账户</li> 
  </ul> 
  <pre><code class="prism language-bash">geth account new
</code></pre> 
  <ul> 
   <li>编写创始块文件</li> 
  </ul> 
  <pre><code class="prism language-bash"><span class="token punctuation">{</span>
    <span class="token string">"config"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
        <span class="token string">"chainId"</span><span class="token keyword">:</span> 10, 
        <span class="token string">"homesteadBlock"</span><span class="token keyword">:</span> 0,
        <span class="token string">"eip155Block"</span><span class="token keyword">:</span> 0,
        <span class="token string">"eip158Block"</span><span class="token keyword">:</span> 0
    <span class="token punctuation">}</span>,  
    <span class="token string">"nonce"</span><span class="token keyword">:</span> <span class="token string">"0x0000000000000042"</span>,
    <span class="token string">"difficulty"</span><span class="token keyword">:</span> <span class="token string">"0x1"</span>,
    <span class="token string">"alloc"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
            <span class="token string">"14b1d82b1c851ea9a6623a20d9865677ecdac70c"</span>:<span class="token punctuation">{</span>
            <span class="token string">"balance"</span><span class="token keyword">:</span> <span class="token string">"20000009800000000000000000000"</span>
        <span class="token punctuation">}</span>,  
            <span class="token string">"aa25a7b683fe0564fe6b2a2574e10dc886ecb3ce"</span>:<span class="token punctuation">{</span>
            <span class="token string">"balance"</span><span class="token keyword">:</span> <span class="token string">"20000009800000000000000000000"</span>
        <span class="token punctuation">}</span>   
    <span class="token punctuation">}</span>,  
    <span class="token string">"mixhash"</span><span class="token keyword">:</span> <span class="token string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span>,
    <span class="token string">"coinbase"</span><span class="token keyword">:</span> <span class="token string">"0x0000000000000000000000000000000000000000"</span>,
    <span class="token string">"timestamp"</span><span class="token keyword">:</span> <span class="token string">"0x00"</span>,
    <span class="token string">"parentHash"</span><span class="token keyword">:</span> <span class="token string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span>,
    <span class="token string">"extraData"</span><span class="token keyword">:</span> <span class="token string">"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa"</span>,
    <span class="token string">"gasLimit"</span><span class="token keyword">:</span> <span class="token string">"0xb2d05e00"</span>
<span class="token punctuation">}</span>
</code></pre> 
  <ul> 
   <li> <p>配置自动解锁账户的脚本</p> <pre><code>在~/Library/Ethereum下创建password文件内容为创建账户的密码
</code></pre> </li> 
   <li> <p>编写启动脚本</p> </li> 
  </ul> 
  <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
geth --rpc --rpcaddr<span class="token operator">=</span><span class="token string">"0.0.0.0"</span>  --rpcport <span class="token string">"8545"</span> --rpccorsdomain<span class="token operator">=</span><span class="token string">"*"</span> --unlock <span class="token string">'0,1'</span> --password ~/Library/Ethereum/password --nodiscover --maxpeers <span class="token string">'5'</span> --n    etworkid <span class="token string">'123'</span> --datadir <span class="token string">'~/Library/Ethereum'</span> console --rpcapi <span class="token string">"db,eth,net,web3,personal,admin,miner"</span>
</code></pre> 
  <ul> 
   <li>启动网络</li> 
  </ul> 
  <pre><code class="prism language-bash">./start.sh
</code></pre> 
  <ul> 
   <li>通过JRPC与网络交互（均编写在脚本中，方便下次使用）</li> 
  </ul> 
  <pre><code class="prism language-bash"><span class="token function">curl</span> -X POST  -H <span class="token string">"Content-Type: application/json"</span>   --data 
<span class="token string">'{"jsonrpc":"2.0","method":"eth_getBalance","params":["0x14b1d82b1c851ea9a6623a20d9865677ecdac7 0c","latest"],"id":1}'</span> http://0.0.0.0:8545
</code></pre> 
  <ul> 
   <li>返回的结果</li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ ./curlexample.sh 
<span class="token punctuation">{</span><span class="token string">"jsonrpc"</span><span class="token keyword">:</span><span class="token string">"2.0"</span>,<span class="token string">"id"</span>:1,<span class="token string">"result"</span><span class="token keyword">:</span><span class="token string">"0x409f9fadbc2695e2f02d4a82"</span><span class="token punctuation">}</span>
</code></pre> 
  <ul> 
   <li>测试合约，后续需需要通过event的返回log的方式查看调用结果信息</li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ <span class="token function">cat</span> Hello.sol 
pragma solidity ^0.4.17<span class="token punctuation">;</span>

contract Hello <span class="token punctuation">{</span>

event Print<span class="token punctuation">(</span>uint<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> multiply<span class="token punctuation">(</span>uint input<span class="token punctuation">)</span>public returns <span class="token punctuation">(</span>uint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
emit Print<span class="token punctuation">(</span>input * 7<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> input * 7<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  //print name
  <span class="token keyword">function</span> print<span class="token punctuation">(</span>string name<span class="token punctuation">)</span> public pure returns <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
  <ul> 
   <li>solc编译合约，出现问题,但不影响后续的操作</li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ solc Hello.sol 
<span class="token punctuation">(</span>node:1915<span class="token punctuation">)</span> <span class="token punctuation">[</span>DEP0013<span class="token punctuation">]</span> DeprecationWarning: Calling an asynchronous <span class="token keyword">function</span> without callback is deprecated.
<span class="token punctuation">(</span>node:1915<span class="token punctuation">)</span> <span class="token punctuation">[</span>DEP0013<span class="token punctuation">]</span> DeprecationWarning: Calling an asynchronous <span class="token keyword">function</span> without callback is deprecated.
localhost:eth liu$ <span class="token function">cat</span> contracts/Hello.sol\:Hello.bin 
608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029
localhost:eth liu$ 
localhost:eth liu$ <span class="token function">cat</span> contracts/Hello.sol\:Hello.abi 
<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"constant"</span>:true,<span class="token string">"inputs"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"name"</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"string"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"print"</span>,<span class="token string">"outputs"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">""</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"string"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"payable"</span>:false,<span class="token string">"stateMutability"</span><span class="token keyword">:</span><span class="token string">"pure"</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"function"</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">"constant"</span>:false,<span class="token string">"inputs"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"input"</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"uint256"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"multiply"</span>,<span class="token string">"outputs"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">""</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"uint256"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"payable"</span>:false,<span class="token string">"stateMutability"</span><span class="token keyword">:</span><span class="token string">"nonpayable"</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"function"</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">"anonymous"</span>:false,<span class="token string">"inputs"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"indexed"</span>:false,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">""</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"uint256"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"Print"</span>,<span class="token string">"type"</span><span class="token keyword">:</span><span class="token string">"event"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>localhost:eth liu$ 
</code></pre> 
  <ul> 
   <li>部署调用合约</li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ <span class="token function">cat</span>  curlsend.sh 
<span class="token comment">#!/bin/bash</span>
<span class="token function">curl</span> -X POST -H <span class="token string">"Content-Type: application/json"</span>  --data <span class="token string">'{"jsonrpc":"2.0","method":"eth_sendTransaction","params":[{ "from": "0x14b1d82b1c851ea9a6623a20d9865677ecdac70c", "gas": "0x76c000", "data": "0x608060405234801561001057600080fd5b506101f1806100206000396000f30060806040526004361061004c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806311114af114610051578063c6888fa114610133575b600080fd5b34801561005d57600080fd5b506100b8600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610174565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100f85780820151818401526020810190506100dd565b50505050905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561013f57600080fd5b5061015e6004803603810190808035906020019092919050505061017e565b6040518082815260200191505060405180910390f35b6060819050919050565b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a16007820290509190505600a165627a7a72305820b7dcf3ffc23d38b70328fb068693613965fa00a36d684661ae2f53df694f1e570029" }],"id":1}'</span> http://0.0.0.0:8545
localhost:eth liu$ 
</code></pre> 
  <ul> 
   <li>调用</li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ ./curlsend.sh 
<span class="token punctuation">{</span><span class="token string">"jsonrpc"</span><span class="token keyword">:</span><span class="token string">"2.0"</span>,<span class="token string">"id"</span>:1,<span class="token string">"result"</span><span class="token keyword">:</span><span class="token string">"0x649cddcacd03f12d860a37b21b47af0ec90375e2eed81c132dc8d451bb09c8e2"</span><span class="token punctuation">}</span>
</code></pre> 
  <ul> 
   <li> <p>geth客户端,产生提交的合约地址，后续调用合约要用</p> <pre><code>合约地址0x234C5DB1913e7a046387222eF3960576D22A90c3
</code></pre> </li> 
  </ul> 
  <pre><code class="prism language-bash"><span class="token operator">&gt;</span> INFO <span class="token punctuation">[</span>10-27<span class="token operator">|</span>21:15:22.779<span class="token punctuation">]</span> Submitted contract creation              fullhash<span class="token operator">=</span>0x994e4af5dee931bdec20c422c06b9c58e11a2aa22377b704ea4cb669b230e0ce contract<span class="token operator">=</span>0x234C5DB1913e7a046387222eF3960576D22A90c3
<span class="token operator">&gt;</span> txpool.status
<span class="token punctuation">{</span>
  pending: 1,
  queued: 0
<span class="token punctuation">}</span>
<span class="token operator">&gt;</span> 
</code></pre> 
  <ul> 
   <li>启动挖矿，确认交易</li> 
  </ul> 
  <pre><code class="prism language-bash"><span class="token operator">&gt;</span> miner.start<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> txpool.status
<span class="token punctuation">{</span>
  pending: 0,
  queued: 0
<span class="token punctuation">}</span>
</code></pre> 
  <ul> 
   <li>调用合约，脚本中to对应的value为合约地址，获得交易的hash值，需要挖矿确认交易</li> 
  </ul> 
  <blockquote> 
   <p>合约地址：0x234C5DB1913e7a046387222eF3960576D22A90c3</p> 
  </blockquote> 
  <ul> 
   <li> <p>调用脚本中的data，为调用合约的签名信息(hash值)，</p> <pre><code>web3.sha3("multiply(uint256)").substring(0, 8)确定前4字节的数据：0xc6888f
接着需要输入4字节的输入参数数据，假设传入6对应uint256数据为
0000000000000000000000000000000000000000000000000000000000000006
两组hash值拼接即为data数据
</code></pre> </li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ <span class="token function">cat</span> curlcall.sh 
<span class="token comment">#!/bin/bash</span>
<span class="token function">curl</span> -X POST -H <span class="token string">"Content-Type: application/json"</span>  --data <span class="token string">'{"jsonrpc":"2.0","method":"eth_sendTransaction","params":[{ "from": "0x14b1d82b1c851ea9a6623a20d9865677ecdac70c", "to": "0x234C5DB1913e7a046387222eF3960576D22A90c3", "data": "0xc6888fa10000000000000000000000000000000000000000000000000000000000000006" }],"id":1}'</span> http://0.0.0.0:8545

localhost:eth liu$ ./curlcall.sh 
<span class="token punctuation">{</span><span class="token string">"jsonrpc"</span><span class="token keyword">:</span><span class="token string">"2.0"</span>,<span class="token string">"id"</span>:1,<span class="token string">"result"</span><span class="token keyword">:</span><span class="token string">"0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22"</span><span class="token punctuation">}</span>
</code></pre> 
  <ul> 
   <li> <p>通过交易的hash值获取交易信息</p> <pre><code>交易的hash值:
0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22
</code></pre> </li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ <span class="token function">cat</span> curlget.sh 
<span class="token comment">#!/bin/bash</span>
<span class="token function">curl</span> -X POST -H <span class="token string">"Content-Type: application/json"</span>  --data <span class="token string">'{"jsonrpc":"2.0","method":"eth_getTransactionReceipt","params":[ "0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22" ],"id":1}'</span> http://0.0.0.0:8545
localhost:eth liu$ 
</code></pre> 
  <ul> 
   <li> <p>查看交易，从logs.data中可以看到结果，该log是通过event的方式返回42(6*7)</p> <pre><code>0x000000000000000000000000000000000000000000000000000000000000002a
</code></pre> </li> 
  </ul> 
  <pre><code class="prism language-bash">localhost:eth liu$ ./curlget.sh 
<span class="token punctuation">{</span><span class="token string">"jsonrpc"</span><span class="token keyword">:</span><span class="token string">"2.0"</span>,<span class="token string">"id"</span>:1,<span class="token string">"result"</span>:<span class="token punctuation">{</span><span class="token string">"blockHash"</span><span class="token keyword">:</span><span class="token string">"0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e"</span>,<span class="token string">"blockNumber"</span><span class="token keyword">:</span><span class="token string">"0x3ab"</span>,<span class="token string">"contractAddress"</span>:null,<span class="token string">"cumulativeGasUsed"</span><span class="token keyword">:</span><span class="token string">"0x592a"</span>,<span class="token string">"from"</span><span class="token keyword">:</span><span class="token string">"0x14b1d82b1c851ea9a6623a20d9865677ecdac70c"</span>,<span class="token string">"gasUsed"</span><span class="token keyword">:</span><span class="token string">"0x592a"</span>,<span class="token string">"logs"</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"address"</span><span class="token keyword">:</span><span class="token string">"0x234c5db1913e7a046387222ef3960576d22a90c3"</span>,<span class="token string">"topics"</span>:<span class="token punctuation">[</span><span class="token string">"0x24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da"</span><span class="token punctuation">]</span>,<span class="token string">"data"</span><span class="token keyword">:</span><span class="token string">"0x000000000000000000000000000000000000000000000000000000000000002a"</span>,<span class="token string">"blockNumber"</span><span class="token keyword">:</span><span class="token string">"0x3ab"</span>,<span class="token string">"transactionHash"</span><span class="token keyword">:</span><span class="token string">"0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22"</span>,<span class="token string">"transactionIndex"</span><span class="token keyword">:</span><span class="token string">"0x0"</span>,<span class="token string">"blockHash"</span><span class="token keyword">:</span><span class="token string">"0x40b0928fee368e94adfecb3b33d0e29b12a36e5a525e203fd1b4ae2da58ed19e"</span>,<span class="token string">"logIndex"</span><span class="token keyword">:</span><span class="token string">"0x0"</span>,<span class="token string">"removed"</span>:false<span class="token punctuation">}</span><span class="token punctuation">]</span>,<span class="token string">"logsBloom"</span><span class="token keyword">:</span><span class="token string">"0x00000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000200000000000000000000000002000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>,<span class="token string">"root"</span><span class="token keyword">:</span><span class="token string">"0x00ad10c4db648a69a37fdf87d3cdc29228807e00d9cd7d5d30b957f6303f2e27"</span>,<span class="token string">"to"</span><span class="token keyword">:</span><span class="token string">"0x234c5db1913e7a046387222ef3960576d22a90c3"</span>,<span class="token string">"transactionHash"</span><span class="token keyword">:</span><span class="token string">"0x85dae51f6a405c049c63354f210fd718a043612a2695a65145feaeedac7dec22"</span>,<span class="token string">"transactionIndex"</span><span class="token keyword">:</span><span class="token string">"0x0"</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
localhost:eth liu$ 
</code></pre> 
  <ul> 
   <li>在实验中发现，一些因版本更新造成API发生变化的问题，以及solidity部分语法变化。</li> 
  </ul> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7f770a53f2.css" rel="stylesheet"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/scylhy/article/details/83450156,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/scylhy/article/details/83450156,&quot;}">阅读更多</a> 
</div> 
<script>
						(function(){
							function setArticleH(btnReadmore,posi){
								var winH = $(window).height();
								var articleBox = $("div.article_content");
								var artH = articleBox.height();
								if(artH > winH*posi){
									articleBox.css({
										'height':winH*posi+'px',
										'overflow':'hidden'
									})
									btnReadmore.click(function(){
										articleBox.removeAttr("style");
										$(this).parent().remove();
									})
								}else{
									btnReadmore.parent().remove();
								}
							}
							var btnReadmore = $("#btn-readmore");
							if(btnReadmore.length>0){
								if(currentUserName){
									setArticleH(btnReadmore,3);
								}else{
									setArticleH(btnReadmore,1.2);
								}
							}
						})()
					</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
