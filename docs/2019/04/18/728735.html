<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>以5个数据库为例，用Python实现数据的提取、转换和加载（ETL） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="以5个数据库为例，用Python实现数据的提取、转换和加载（ETL）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="导读：每个数据科学专业人员都必须从不同的数据源中提取、转换和加载（Extract-Transform-Load，ETL）数据。 本文将讨论如何使用Python为选定的流行数据库实现数据的ETL。对于关系数据库，选择MySQL，并将Elasticsearch作为文档数据库的例子展开。对于图形数据库，选择Neo4j。对于NoSQL，可参考此前文章中介绍的MongoDB。 作者：萨扬·穆霍帕迪亚（Sayan Mukhopadhyay） 如需转载请联系大数据（ID：hzdashuju） ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。 Neo4j是一个高性能的,NOSQL图形数据库，它将结构化数据存储在网络上(从数学角度叫做图)而不是表中，是一个嵌入式的、基于磁盘的、具备完全的事务特性的Java持久化引擎。 01 MySQL MySQLdb是在MySQL C接口上面开发的Python API。 1. 如何安装MySQLdb 首先，需要在计算机上安装Python MySQLdb模块。然后运行以下脚本： #!/usr/bin/pythonimport&nbsp;MySQLdb 如果出现导入错误，则表示模块未正确安装。 以下是安装MySQL Python模块的说明： $gunzip&nbsp;MySQL-python-1.2.2.tar.gz$tar&nbsp;–xvf&nbsp;MySQL-python-1.2.2.tar$cd&nbsp;MySQL-python-1.2.2$python&nbsp;setup.py&nbsp;build$python&nbsp;setup.py&nbsp;install 2. 数据库连接 在连接到MySQL数据库之前，请确保有以下内容。 有一个名为TEST的数据库。 在TEST数据库中有一个表STUDENT。 STUDENT表有三个字段：NAME、SUR_NAME和ROLL_NO。 用户对TEST数据库具有完全访问权限。 3. INSERT操作 以下代码执行SQL INSERT语句，以便在STUDENT表中创建记录： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.sql&nbsp;=&nbsp;&quot;&quot;&quot;INSERT&nbsp;INTO&nbsp;STUDENT(NAME,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUR_NAME,&nbsp;ROLL_NO)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;(&#39;Sayan&#39;,&nbsp;&#39;Mukhopadhyay&#39;,&nbsp;1)&quot;&quot;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;database&nbsp;&nbsp;&nbsp;db.commit()except:&nbsp;&nbsp;&nbsp;#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;error&nbsp;&nbsp;&nbsp;db.rollback()#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 4. READ操作 以下代码从STUDENT表中提取数据并打印出来： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.sql&nbsp;=&nbsp;&quot;SELECT&nbsp;*&nbsp;FROM&nbsp;STUDENT&nbsp;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Fetch&nbsp;all&nbsp;the&nbsp;rows&nbsp;in&nbsp;a&nbsp;list&nbsp;of&nbsp;lists.results&nbsp;=&nbsp;cursor.fetchall()for&nbsp;row&nbsp;in&nbsp;results:fname&nbsp;=&nbsp;row[0]lname&nbsp;=&nbsp;row[1]id&nbsp;=&nbsp;row[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Now&nbsp;print&nbsp;fetched&nbsp;resultprint&nbsp;&quot;name=%s,surname=%s,id=%d&quot;&nbsp;%&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fname,&nbsp;lname,&nbsp;id&nbsp;)except:print&nbsp;&quot;Error:&nbsp;unable&nbsp;to&nbsp;fecth&nbsp;data&quot;#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 5. DELETE操作 以下代码从TEST中删除id=1的一行数据： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;test&quot;,&quot;passwd&quot;,&quot;TEST&quot;)#prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;PrepareSQL&nbsp;query&nbsp;to&nbsp;DELETE&nbsp;required&nbsp;recordssql=&quot;DELETE&nbsp;FROM&nbsp;STUDENT&nbsp;WHERE&nbsp;ROLL_NO=1&quot;try:#Execute&nbsp;the&nbsp;SQL&nbsp;command&nbsp;cursor.execute(sql)#Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;databasedb.commit()except:#Roll&nbsp;back&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;errordb.rollback()#disconnect&nbsp;from&nbsp;server&nbsp;db.close() 6. UPDATE操作 以下代码将lastname为Mukhopadhyay的记录更改为Mukherjee： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;usingcursor()&nbsp;method&nbsp;cursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;UPDATE&nbsp;required&nbsp;recordssql&nbsp;=&nbsp;&quot;UPDATE&nbsp;STUDENT&nbsp;SET&nbsp;SUR_NAME=&quot;Mukherjee&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SUR_NAME=&quot;Mukhopadhyay&quot;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;databasedb.commit()except:&nbsp;&nbsp;&nbsp;#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;errordb.rollback()#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 7. COMMIT操作 提交操作提供对数据库完成修改命令，并且在此操作之后，无法将其还原。 8. ROLL-BACK操作 如果不能确认对数据的修改同时想要撤回操作，可以使用roll-back()方法。 以下是通过Python访问MySQL数据的完整示例。它将提供将数据存储为CSV文件或MySQL数据库中的数据的完整描述。 import&nbsp;MySQLdbimport&nbsp;sysout&nbsp;=&nbsp;open(&#39;Config1.txt&#39;,&#39;w&#39;)print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;print&nbsp;&quot;1.&nbsp;MySql&quot;print&nbsp;&quot;2.&nbsp;Text&quot;print&nbsp;&quot;3.&nbsp;Exit&quot;while(1):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data1&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;1):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;begin&quot;+&quot;\n&quot;+&quot;type=mysql\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;ip:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;host=&quot;&nbsp;+&nbsp;ip&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;database&nbsp;name:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;database=&quot;&nbsp;+&nbsp;db&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;user&nbsp;name:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usr&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;user=&quot;&nbsp;+&nbsp;usr&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;password:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwd&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;password=&quot;&nbsp;+&nbsp;passwd&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;MySQLdb.connect(ip,&nbsp;usr,&nbsp;passwd,&nbsp;db)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor&nbsp;=&nbsp;connection.cursor()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;&quot;show&nbsp;tables&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;field&nbsp;in&nbsp;row:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables.append(field.strip())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(tables)):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;i,&nbsp;tables[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb&nbsp;=&nbsp;tables[int(sys.stdin.readline().strip())]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;table=&quot;&nbsp;+&nbsp;tb&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;&quot;describe&nbsp;&quot;&nbsp;+&nbsp;tb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns.append(row[0].strip())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(columns)):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;columns[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Not&nbsp;index&nbsp;choose&nbsp;the&nbsp;exact&nbsp;column&nbsp;names&nbsp;seperated&nbsp;by&nbsp;coma&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;columns=&quot;&nbsp;+&nbsp;cols&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;end&quot;+&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;1.&nbsp;MySql&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;2.&nbsp;Text&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;3.&nbsp;Exit&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;2):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;path&nbsp;of&nbsp;text&nbsp;file:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;=&nbsp;open(path)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;line&nbsp;in&nbsp;file:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;line&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;count&nbsp;&gt;&nbsp;3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;begin&quot;+&quot;\n&quot;+&quot;type=text\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;path=&quot;&nbsp;+&nbsp;path&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;enter&nbsp;delimeter:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dlm&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;dlm=&quot;&nbsp;+&nbsp;dlm&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;enter&nbsp;column&nbsp;indexes&nbsp;seperated&nbsp;by&nbsp;comma:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;columns=&quot;&nbsp;+&nbsp;cols&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;end&quot;+&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;1.&nbsp;MySql&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;2.&nbsp;Text&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;3.&nbsp;Exit&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;3):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit() 02 Elasticsearch Elasticsearch（ES）低级客户端提供从Python到ES REST端点的直接映射。Elasticsearch的一大优势是为数据分析提供了全栈解决方案。Elasticsearch作为数据库，有可配置前端Kibana、数据收集工具Logstash以及企业安全工具Shield。 下例具有称为cat、cluster、indices、ingest、nodes、snapshot和tasks的特征，根据任务分别转换为CatClient、ClusterClient、IndicesClient、IngestClient、NodesClient、SnapshotClient和TasksClient实例。这些实例是访问这些类及其方法的唯一方式。 你可以指定自己的连接类，可以通过提供的connection_class参数来使用。 #&nbsp;create&nbsp;connection&nbsp;to&nbsp;local&nbsp;host&nbsp;using&nbsp;the&nbsp;ThriftConnectionEs1=Elasticsearch(connection_class=ThriftConnection) 如果你想打开sniffing，那么有几个选择： #&nbsp;create&nbsp;connection&nbsp;that&nbsp;will&nbsp;automatically&nbsp;inspect&nbsp;the&nbsp;cluster&nbsp;to&nbsp;get#&nbsp;the&nbsp;list&nbsp;of&nbsp;active&nbsp;nodes.&nbsp;Start&nbsp;with&nbsp;nodes&nbsp;running&nbsp;on&nbsp;&#39;esnode1&#39;&nbsp;and#&nbsp;&#39;esnode2&#39;Es1=Elasticsearch(&nbsp;&nbsp;&nbsp;&nbsp;[&#39;esnode1&#39;,&nbsp;&#39;esnode2&#39;],#&nbsp;sniff&nbsp;before&nbsp;doing&nbsp;anythingsniff_on_start=True,#&nbsp;refresh&nbsp;nodes&nbsp;after&nbsp;a&nbsp;node&nbsp;fails&nbsp;to&nbsp;respondsniff_on_connection_fail=True,#&nbsp;and&nbsp;also&nbsp;every&nbsp;30&nbsp;secondssniffer_timeout=30) 不同的主机可以有不同的参数，你可以为每个节点使用一个字典来指定它们。 #&nbsp;connect&nbsp;to&nbsp;localhost&nbsp;directly&nbsp;and&nbsp;another&nbsp;node&nbsp;using&nbsp;SSL&nbsp;on&nbsp;port&nbsp;443#&nbsp;and&nbsp;an&nbsp;url_prefix.&nbsp;Note&nbsp;that&nbsp;``port``&nbsp;needs&nbsp;to&nbsp;be&nbsp;an&nbsp;int.Es1=Elasticsearch([{&#39;host&#39;:&#39;localhost&#39;},{&#39;host&#39;:&#39;othernode&#39;,&#39;port&#39;:443,&#39;url_prefix&#39;:&#39;es&#39;,&#39;use_ssl&#39;:True},]) 还支持SSL客户端身份验证（有关选项的详细说明，请参阅Urllib3HttpConnection）。 Es1=Elasticsearch([&#39;localhost:443&#39;,&#39;other_host:443&#39;],#&nbsp;turn&nbsp;on&nbsp;SSLuse_ssl=True,#&nbsp;make&nbsp;sure&nbsp;we&nbsp;verify&nbsp;SSL&nbsp;certificates&nbsp;(off&nbsp;by&nbsp;default)verify_certs=True,#&nbsp;provide&nbsp;a&nbsp;path&nbsp;to&nbsp;CA&nbsp;certs&nbsp;on&nbsp;diskca_certs=&#39;path&nbsp;to&nbsp;CA_certs&#39;,#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;certificateclient_cert=&#39;path&nbsp;to&nbsp;clientcert.pem&#39;,#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;keyclient_key=&#39;path&nbsp;to&nbsp;clientkey.pem&#39;) 连接层API 许多类负责处理Elasticsearch集群。这里可以通过将参数传递给Elasticsearch类来忽略正在使用的默认子类。属于客户端的每个参数都将添加到Transport、ConnectionPool和Connection上。 例如，如果你要使用定制的ConnectionSelector类，只需传入selector_class参数即可。 整个API以很高的精确度包装了原始REST API，其中包括区分调用必需参数和可选参数。这意味着代码区分了按排位的参数和关键字参数。建议读者使用关键字参数来保证所有调用的一致性和安全性。 如果Elasticsearch返回2XX，则API调用成功（并将返回响应）。否则，将引发TransportError（或更具体的子类）的实例。你可以在异常中查看其他异常和错误状态。如果你不希望引发异常，可以通过传入ignore参数忽略状态代码或状态代码列表。 from&nbsp;elasticsearch&nbsp;import&nbsp;Elasticsearches=Elasticsearch()#&nbsp;ignore&nbsp;400&nbsp;cause&nbsp;by&nbsp;IndexAlreadyExistsException&nbsp;when&nbsp;creating&nbsp;an&nbsp;indexes.indices.create(index=&#39;test-index&#39;,ignore=400)#&nbsp;ignore&nbsp;404&nbsp;and&nbsp;400es.indices.delete(index=&#39;test-index&#39;,ignore=[400,404]) 03 Neo4j Python驱动 Neo4j支持Neo4j Python驱动，并通过二进制协议与数据库连接。它试图保持简约及Python的惯用方式。 pip&nbsp;install&nbsp;neo4j-driverfrom&nbsp;neo4j.v1&nbsp;import&nbsp;GraphDatabase,&nbsp;basic_authdriver11&nbsp;=&nbsp;GraphDatabase.driver(&quot;bolt://localhost&quot;,&nbsp;auth=basic_auth(&quot;neo4j&quot;,&nbsp;&quot;neo4j&quot;))session11&nbsp;=&nbsp;driver11.session()session11.run(&quot;CREATE&nbsp;(a:Person&nbsp;{name:&#39;Sayan&#39;,title:&#39;Mukhopadhyay&#39;})&quot;)result11=&nbsp;session11.run(&quot;MATCH&nbsp;(a:Person)&nbsp;WHERE&nbsp;a.name&nbsp;=&#39;Sayan&#39;&nbsp;RETURN&nbsp;a.name&nbsp;AS&nbsp;name,&nbsp;a.title&nbsp;AS&nbsp;title&quot;)for&nbsp;recordi&nbsp;n&nbsp;result11:print(&quot;%s&nbsp;%s&quot;%&nbsp;(record[&quot;title&quot;],&nbsp;record[&quot;name&quot;]))session11.close() 04 neo4j-rest-client neo4j-rest-client的主要目标是确保已经使用本地Neo4j的Python程序员通过python-embedded的方式也能够访问Neo4j REST服务器。因此，neo4j-rest-client API的结构与python-embedded完全同步。但是引入了一种新的结构，以达到更加Python化的风格，并通过Neo4j团队引入的新特性来增强API。 05 内存数据库 另一个重要的数据库类是内存数据库。它在RAM中存储和处理数据。因此，对数据库的操作非常快，并且数据是灵活的。SQLite是内存数据库的一个流行范例。在Python中，需要使用sqlalchemy库来操作SQLite。在第1章的Flask和Falcon示例中，展示了如何从SQLite中选择数据。以下将展示如何在SQLite中存储Pandas数据框架： from&nbsp;sqlalchemy&nbsp;import&nbsp;create_engineimport&nbsp;sqlite3conn&nbsp;=&nbsp;sqlite3.connect(&#39;multiplier.db&#39;)conn.execute(&#39;&#39;&#39;CREATE&nbsp;TABLE&nbsp;if&nbsp;not&nbsp;exists&nbsp;multiplier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAR(50),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL);&#39;&#39;&#39;)conn.close()db_name&nbsp;=&nbsp;&quot;sqlite:///&quot;&nbsp;+&nbsp;prop&nbsp;+&nbsp;&quot;_&quot;&nbsp;+&nbsp;domain&nbsp;+&nbsp;str(i)&nbsp;+&nbsp;&quot;.db&quot;disk_engine&nbsp;=&nbsp;create_engine(db_name)df.to_sql(&#39;scores&#39;,&nbsp;disk_engine,&nbsp;if_exists=&#39;replace&#39;) 06 Python版本MongoDB 这部分内容请见此前的文章数据处理入门干货：MongoDB和pandas极简教程。 关于作者：Sayan Mukhopadhyay拥有超过13年的行业经验，并与瑞信、PayPal、CA Technologies、CSC和Mphasis等公司建立了联系。他对投资银行、在线支付、在线广告、IT架构和零售等领域的数据分析应用有着深刻的理解。他的专业领域是在分布式和数据驱动的环境（如实时分析、高频交易等）中，实现高性能计算。 本文摘编自《Python高级数据分析：机器学习、深度学习和NLP实例》，经出版方授权发布。 延伸阅读《Python高级数据分析》 点击上图了解及购买 转载请联系微信：DoctorData 推荐语：本书介绍高级数据分析概念的广泛基础，以及最近的数据库革命，如Neo4j、弹性搜索和MongoDB。本书讨论了如何实现包括局部爬取在内的ETL技术，并应用于高频算法交易和目标导向的对话系统等领域。还有一些机器学习概念的例子，如半监督学习、深度学习和NLP。本书还涵盖了重要的传统数据分析技术，如时间序列和主成分分析等。 你想免费读这本《Python高级数据分析：机器学习、深度学习和NLP实例》吗？ 「大数据」内容合伙人之「鉴书小分队」上线啦！ 最近，你都在读什么书？有哪些心得体会想要跟大家分享？ 数据叔最近搞了个大事——联合优质图书出版商机械工业出版社华章公司发起鉴书活动。 简单说就是：你可以免费读新书，你可以免费读新书的同时，顺手码一篇读书笔记就行。详情请在大数据公众号后台对话框回复合伙人查看。 京东图书大促开始啦！ 每满100-50！满200-100！满300-150！ 长按二维码进入唯一领券入口，领取大数据粉丝专属“200减35”叠加满减券。 是的！你没看错！相当于165块买400块的书！！！（打了多少折你敲敲旁边的计算器……） 长按下方二维码或点击阅读原文 发现更多好书 据统计，99%的大咖都完成了这个神操作 ▼ 更多精彩 在公众号后台对话框输入以下关键词 查看更多优质内容！ PPT&nbsp;|&nbsp;报告&nbsp;|&nbsp;读书&nbsp;|&nbsp;书单&nbsp;|&nbsp;干货&nbsp; 大数据&nbsp;|&nbsp;揭秘&nbsp;|&nbsp;Python&nbsp;|&nbsp;可视化 人工智能&nbsp;|&nbsp;机器学习&nbsp;|&nbsp;深度学习&nbsp;|&nbsp;神经网络 AI&nbsp;|&nbsp;1024&nbsp;|&nbsp;段子&nbsp;|&nbsp;区块链&nbsp;|&nbsp;数学 猜你想看 如果你不想长期996，看看这个 数据采集技术揭秘：手把手教你全埋点技术解决方案 那些“反人类”的用户体验，都错在哪了？ 一文看懂数据挖掘：哪一种方法最好？都需要哪些技术？ Q: 你常用哪些数据库？ 欢迎留言并赢取福利 觉得不错，请把这篇文章分享给你的朋友 转载 / 投稿请联系：baiyu@hzbook.com 更多精彩，请在后台点击“历史文章”查看 点击阅读原文，了解更多" />
<meta property="og:description" content="导读：每个数据科学专业人员都必须从不同的数据源中提取、转换和加载（Extract-Transform-Load，ETL）数据。 本文将讨论如何使用Python为选定的流行数据库实现数据的ETL。对于关系数据库，选择MySQL，并将Elasticsearch作为文档数据库的例子展开。对于图形数据库，选择Neo4j。对于NoSQL，可参考此前文章中介绍的MongoDB。 作者：萨扬·穆霍帕迪亚（Sayan Mukhopadhyay） 如需转载请联系大数据（ID：hzdashuju） ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。 Neo4j是一个高性能的,NOSQL图形数据库，它将结构化数据存储在网络上(从数学角度叫做图)而不是表中，是一个嵌入式的、基于磁盘的、具备完全的事务特性的Java持久化引擎。 01 MySQL MySQLdb是在MySQL C接口上面开发的Python API。 1. 如何安装MySQLdb 首先，需要在计算机上安装Python MySQLdb模块。然后运行以下脚本： #!/usr/bin/pythonimport&nbsp;MySQLdb 如果出现导入错误，则表示模块未正确安装。 以下是安装MySQL Python模块的说明： $gunzip&nbsp;MySQL-python-1.2.2.tar.gz$tar&nbsp;–xvf&nbsp;MySQL-python-1.2.2.tar$cd&nbsp;MySQL-python-1.2.2$python&nbsp;setup.py&nbsp;build$python&nbsp;setup.py&nbsp;install 2. 数据库连接 在连接到MySQL数据库之前，请确保有以下内容。 有一个名为TEST的数据库。 在TEST数据库中有一个表STUDENT。 STUDENT表有三个字段：NAME、SUR_NAME和ROLL_NO。 用户对TEST数据库具有完全访问权限。 3. INSERT操作 以下代码执行SQL INSERT语句，以便在STUDENT表中创建记录： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.sql&nbsp;=&nbsp;&quot;&quot;&quot;INSERT&nbsp;INTO&nbsp;STUDENT(NAME,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUR_NAME,&nbsp;ROLL_NO)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;(&#39;Sayan&#39;,&nbsp;&#39;Mukhopadhyay&#39;,&nbsp;1)&quot;&quot;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;database&nbsp;&nbsp;&nbsp;db.commit()except:&nbsp;&nbsp;&nbsp;#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;error&nbsp;&nbsp;&nbsp;db.rollback()#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 4. READ操作 以下代码从STUDENT表中提取数据并打印出来： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.sql&nbsp;=&nbsp;&quot;SELECT&nbsp;*&nbsp;FROM&nbsp;STUDENT&nbsp;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Fetch&nbsp;all&nbsp;the&nbsp;rows&nbsp;in&nbsp;a&nbsp;list&nbsp;of&nbsp;lists.results&nbsp;=&nbsp;cursor.fetchall()for&nbsp;row&nbsp;in&nbsp;results:fname&nbsp;=&nbsp;row[0]lname&nbsp;=&nbsp;row[1]id&nbsp;=&nbsp;row[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Now&nbsp;print&nbsp;fetched&nbsp;resultprint&nbsp;&quot;name=%s,surname=%s,id=%d&quot;&nbsp;%&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fname,&nbsp;lname,&nbsp;id&nbsp;)except:print&nbsp;&quot;Error:&nbsp;unable&nbsp;to&nbsp;fecth&nbsp;data&quot;#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 5. DELETE操作 以下代码从TEST中删除id=1的一行数据： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;test&quot;,&quot;passwd&quot;,&quot;TEST&quot;)#prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;PrepareSQL&nbsp;query&nbsp;to&nbsp;DELETE&nbsp;required&nbsp;recordssql=&quot;DELETE&nbsp;FROM&nbsp;STUDENT&nbsp;WHERE&nbsp;ROLL_NO=1&quot;try:#Execute&nbsp;the&nbsp;SQL&nbsp;command&nbsp;cursor.execute(sql)#Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;databasedb.commit()except:#Roll&nbsp;back&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;errordb.rollback()#disconnect&nbsp;from&nbsp;server&nbsp;db.close() 6. UPDATE操作 以下代码将lastname为Mukhopadhyay的记录更改为Mukherjee： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;usingcursor()&nbsp;method&nbsp;cursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;UPDATE&nbsp;required&nbsp;recordssql&nbsp;=&nbsp;&quot;UPDATE&nbsp;STUDENT&nbsp;SET&nbsp;SUR_NAME=&quot;Mukherjee&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SUR_NAME=&quot;Mukhopadhyay&quot;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;databasedb.commit()except:&nbsp;&nbsp;&nbsp;#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;errordb.rollback()#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 7. COMMIT操作 提交操作提供对数据库完成修改命令，并且在此操作之后，无法将其还原。 8. ROLL-BACK操作 如果不能确认对数据的修改同时想要撤回操作，可以使用roll-back()方法。 以下是通过Python访问MySQL数据的完整示例。它将提供将数据存储为CSV文件或MySQL数据库中的数据的完整描述。 import&nbsp;MySQLdbimport&nbsp;sysout&nbsp;=&nbsp;open(&#39;Config1.txt&#39;,&#39;w&#39;)print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;print&nbsp;&quot;1.&nbsp;MySql&quot;print&nbsp;&quot;2.&nbsp;Text&quot;print&nbsp;&quot;3.&nbsp;Exit&quot;while(1):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data1&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;1):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;begin&quot;+&quot;\n&quot;+&quot;type=mysql\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;ip:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;host=&quot;&nbsp;+&nbsp;ip&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;database&nbsp;name:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;database=&quot;&nbsp;+&nbsp;db&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;user&nbsp;name:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usr&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;user=&quot;&nbsp;+&nbsp;usr&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;password:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwd&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;password=&quot;&nbsp;+&nbsp;passwd&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;MySQLdb.connect(ip,&nbsp;usr,&nbsp;passwd,&nbsp;db)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor&nbsp;=&nbsp;connection.cursor()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;&quot;show&nbsp;tables&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;field&nbsp;in&nbsp;row:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables.append(field.strip())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(tables)):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;i,&nbsp;tables[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb&nbsp;=&nbsp;tables[int(sys.stdin.readline().strip())]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;table=&quot;&nbsp;+&nbsp;tb&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;&quot;describe&nbsp;&quot;&nbsp;+&nbsp;tb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns.append(row[0].strip())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(columns)):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;columns[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Not&nbsp;index&nbsp;choose&nbsp;the&nbsp;exact&nbsp;column&nbsp;names&nbsp;seperated&nbsp;by&nbsp;coma&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;columns=&quot;&nbsp;+&nbsp;cols&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;end&quot;+&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;1.&nbsp;MySql&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;2.&nbsp;Text&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;3.&nbsp;Exit&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;2):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;path&nbsp;of&nbsp;text&nbsp;file:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;=&nbsp;open(path)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;line&nbsp;in&nbsp;file:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;line&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;count&nbsp;&gt;&nbsp;3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;begin&quot;+&quot;\n&quot;+&quot;type=text\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;path=&quot;&nbsp;+&nbsp;path&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;enter&nbsp;delimeter:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dlm&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;dlm=&quot;&nbsp;+&nbsp;dlm&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;enter&nbsp;column&nbsp;indexes&nbsp;seperated&nbsp;by&nbsp;comma:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;columns=&quot;&nbsp;+&nbsp;cols&nbsp;+&nbsp;&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;end&quot;+&quot;\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;1.&nbsp;MySql&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;2.&nbsp;Text&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;3.&nbsp;Exit&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;3):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit() 02 Elasticsearch Elasticsearch（ES）低级客户端提供从Python到ES REST端点的直接映射。Elasticsearch的一大优势是为数据分析提供了全栈解决方案。Elasticsearch作为数据库，有可配置前端Kibana、数据收集工具Logstash以及企业安全工具Shield。 下例具有称为cat、cluster、indices、ingest、nodes、snapshot和tasks的特征，根据任务分别转换为CatClient、ClusterClient、IndicesClient、IngestClient、NodesClient、SnapshotClient和TasksClient实例。这些实例是访问这些类及其方法的唯一方式。 你可以指定自己的连接类，可以通过提供的connection_class参数来使用。 #&nbsp;create&nbsp;connection&nbsp;to&nbsp;local&nbsp;host&nbsp;using&nbsp;the&nbsp;ThriftConnectionEs1=Elasticsearch(connection_class=ThriftConnection) 如果你想打开sniffing，那么有几个选择： #&nbsp;create&nbsp;connection&nbsp;that&nbsp;will&nbsp;automatically&nbsp;inspect&nbsp;the&nbsp;cluster&nbsp;to&nbsp;get#&nbsp;the&nbsp;list&nbsp;of&nbsp;active&nbsp;nodes.&nbsp;Start&nbsp;with&nbsp;nodes&nbsp;running&nbsp;on&nbsp;&#39;esnode1&#39;&nbsp;and#&nbsp;&#39;esnode2&#39;Es1=Elasticsearch(&nbsp;&nbsp;&nbsp;&nbsp;[&#39;esnode1&#39;,&nbsp;&#39;esnode2&#39;],#&nbsp;sniff&nbsp;before&nbsp;doing&nbsp;anythingsniff_on_start=True,#&nbsp;refresh&nbsp;nodes&nbsp;after&nbsp;a&nbsp;node&nbsp;fails&nbsp;to&nbsp;respondsniff_on_connection_fail=True,#&nbsp;and&nbsp;also&nbsp;every&nbsp;30&nbsp;secondssniffer_timeout=30) 不同的主机可以有不同的参数，你可以为每个节点使用一个字典来指定它们。 #&nbsp;connect&nbsp;to&nbsp;localhost&nbsp;directly&nbsp;and&nbsp;another&nbsp;node&nbsp;using&nbsp;SSL&nbsp;on&nbsp;port&nbsp;443#&nbsp;and&nbsp;an&nbsp;url_prefix.&nbsp;Note&nbsp;that&nbsp;``port``&nbsp;needs&nbsp;to&nbsp;be&nbsp;an&nbsp;int.Es1=Elasticsearch([{&#39;host&#39;:&#39;localhost&#39;},{&#39;host&#39;:&#39;othernode&#39;,&#39;port&#39;:443,&#39;url_prefix&#39;:&#39;es&#39;,&#39;use_ssl&#39;:True},]) 还支持SSL客户端身份验证（有关选项的详细说明，请参阅Urllib3HttpConnection）。 Es1=Elasticsearch([&#39;localhost:443&#39;,&#39;other_host:443&#39;],#&nbsp;turn&nbsp;on&nbsp;SSLuse_ssl=True,#&nbsp;make&nbsp;sure&nbsp;we&nbsp;verify&nbsp;SSL&nbsp;certificates&nbsp;(off&nbsp;by&nbsp;default)verify_certs=True,#&nbsp;provide&nbsp;a&nbsp;path&nbsp;to&nbsp;CA&nbsp;certs&nbsp;on&nbsp;diskca_certs=&#39;path&nbsp;to&nbsp;CA_certs&#39;,#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;certificateclient_cert=&#39;path&nbsp;to&nbsp;clientcert.pem&#39;,#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;keyclient_key=&#39;path&nbsp;to&nbsp;clientkey.pem&#39;) 连接层API 许多类负责处理Elasticsearch集群。这里可以通过将参数传递给Elasticsearch类来忽略正在使用的默认子类。属于客户端的每个参数都将添加到Transport、ConnectionPool和Connection上。 例如，如果你要使用定制的ConnectionSelector类，只需传入selector_class参数即可。 整个API以很高的精确度包装了原始REST API，其中包括区分调用必需参数和可选参数。这意味着代码区分了按排位的参数和关键字参数。建议读者使用关键字参数来保证所有调用的一致性和安全性。 如果Elasticsearch返回2XX，则API调用成功（并将返回响应）。否则，将引发TransportError（或更具体的子类）的实例。你可以在异常中查看其他异常和错误状态。如果你不希望引发异常，可以通过传入ignore参数忽略状态代码或状态代码列表。 from&nbsp;elasticsearch&nbsp;import&nbsp;Elasticsearches=Elasticsearch()#&nbsp;ignore&nbsp;400&nbsp;cause&nbsp;by&nbsp;IndexAlreadyExistsException&nbsp;when&nbsp;creating&nbsp;an&nbsp;indexes.indices.create(index=&#39;test-index&#39;,ignore=400)#&nbsp;ignore&nbsp;404&nbsp;and&nbsp;400es.indices.delete(index=&#39;test-index&#39;,ignore=[400,404]) 03 Neo4j Python驱动 Neo4j支持Neo4j Python驱动，并通过二进制协议与数据库连接。它试图保持简约及Python的惯用方式。 pip&nbsp;install&nbsp;neo4j-driverfrom&nbsp;neo4j.v1&nbsp;import&nbsp;GraphDatabase,&nbsp;basic_authdriver11&nbsp;=&nbsp;GraphDatabase.driver(&quot;bolt://localhost&quot;,&nbsp;auth=basic_auth(&quot;neo4j&quot;,&nbsp;&quot;neo4j&quot;))session11&nbsp;=&nbsp;driver11.session()session11.run(&quot;CREATE&nbsp;(a:Person&nbsp;{name:&#39;Sayan&#39;,title:&#39;Mukhopadhyay&#39;})&quot;)result11=&nbsp;session11.run(&quot;MATCH&nbsp;(a:Person)&nbsp;WHERE&nbsp;a.name&nbsp;=&#39;Sayan&#39;&nbsp;RETURN&nbsp;a.name&nbsp;AS&nbsp;name,&nbsp;a.title&nbsp;AS&nbsp;title&quot;)for&nbsp;recordi&nbsp;n&nbsp;result11:print(&quot;%s&nbsp;%s&quot;%&nbsp;(record[&quot;title&quot;],&nbsp;record[&quot;name&quot;]))session11.close() 04 neo4j-rest-client neo4j-rest-client的主要目标是确保已经使用本地Neo4j的Python程序员通过python-embedded的方式也能够访问Neo4j REST服务器。因此，neo4j-rest-client API的结构与python-embedded完全同步。但是引入了一种新的结构，以达到更加Python化的风格，并通过Neo4j团队引入的新特性来增强API。 05 内存数据库 另一个重要的数据库类是内存数据库。它在RAM中存储和处理数据。因此，对数据库的操作非常快，并且数据是灵活的。SQLite是内存数据库的一个流行范例。在Python中，需要使用sqlalchemy库来操作SQLite。在第1章的Flask和Falcon示例中，展示了如何从SQLite中选择数据。以下将展示如何在SQLite中存储Pandas数据框架： from&nbsp;sqlalchemy&nbsp;import&nbsp;create_engineimport&nbsp;sqlite3conn&nbsp;=&nbsp;sqlite3.connect(&#39;multiplier.db&#39;)conn.execute(&#39;&#39;&#39;CREATE&nbsp;TABLE&nbsp;if&nbsp;not&nbsp;exists&nbsp;multiplier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAR(50),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL);&#39;&#39;&#39;)conn.close()db_name&nbsp;=&nbsp;&quot;sqlite:///&quot;&nbsp;+&nbsp;prop&nbsp;+&nbsp;&quot;_&quot;&nbsp;+&nbsp;domain&nbsp;+&nbsp;str(i)&nbsp;+&nbsp;&quot;.db&quot;disk_engine&nbsp;=&nbsp;create_engine(db_name)df.to_sql(&#39;scores&#39;,&nbsp;disk_engine,&nbsp;if_exists=&#39;replace&#39;) 06 Python版本MongoDB 这部分内容请见此前的文章数据处理入门干货：MongoDB和pandas极简教程。 关于作者：Sayan Mukhopadhyay拥有超过13年的行业经验，并与瑞信、PayPal、CA Technologies、CSC和Mphasis等公司建立了联系。他对投资银行、在线支付、在线广告、IT架构和零售等领域的数据分析应用有着深刻的理解。他的专业领域是在分布式和数据驱动的环境（如实时分析、高频交易等）中，实现高性能计算。 本文摘编自《Python高级数据分析：机器学习、深度学习和NLP实例》，经出版方授权发布。 延伸阅读《Python高级数据分析》 点击上图了解及购买 转载请联系微信：DoctorData 推荐语：本书介绍高级数据分析概念的广泛基础，以及最近的数据库革命，如Neo4j、弹性搜索和MongoDB。本书讨论了如何实现包括局部爬取在内的ETL技术，并应用于高频算法交易和目标导向的对话系统等领域。还有一些机器学习概念的例子，如半监督学习、深度学习和NLP。本书还涵盖了重要的传统数据分析技术，如时间序列和主成分分析等。 你想免费读这本《Python高级数据分析：机器学习、深度学习和NLP实例》吗？ 「大数据」内容合伙人之「鉴书小分队」上线啦！ 最近，你都在读什么书？有哪些心得体会想要跟大家分享？ 数据叔最近搞了个大事——联合优质图书出版商机械工业出版社华章公司发起鉴书活动。 简单说就是：你可以免费读新书，你可以免费读新书的同时，顺手码一篇读书笔记就行。详情请在大数据公众号后台对话框回复合伙人查看。 京东图书大促开始啦！ 每满100-50！满200-100！满300-150！ 长按二维码进入唯一领券入口，领取大数据粉丝专属“200减35”叠加满减券。 是的！你没看错！相当于165块买400块的书！！！（打了多少折你敲敲旁边的计算器……） 长按下方二维码或点击阅读原文 发现更多好书 据统计，99%的大咖都完成了这个神操作 ▼ 更多精彩 在公众号后台对话框输入以下关键词 查看更多优质内容！ PPT&nbsp;|&nbsp;报告&nbsp;|&nbsp;读书&nbsp;|&nbsp;书单&nbsp;|&nbsp;干货&nbsp; 大数据&nbsp;|&nbsp;揭秘&nbsp;|&nbsp;Python&nbsp;|&nbsp;可视化 人工智能&nbsp;|&nbsp;机器学习&nbsp;|&nbsp;深度学习&nbsp;|&nbsp;神经网络 AI&nbsp;|&nbsp;1024&nbsp;|&nbsp;段子&nbsp;|&nbsp;区块链&nbsp;|&nbsp;数学 猜你想看 如果你不想长期996，看看这个 数据采集技术揭秘：手把手教你全埋点技术解决方案 那些“反人类”的用户体验，都错在哪了？ 一文看懂数据挖掘：哪一种方法最好？都需要哪些技术？ Q: 你常用哪些数据库？ 欢迎留言并赢取福利 觉得不错，请把这篇文章分享给你的朋友 转载 / 投稿请联系：baiyu@hzbook.com 更多精彩，请在后台点击“历史文章”查看 点击阅读原文，了解更多" />
<link rel="canonical" href="https://mlh.app/2019/04/18/728735.html" />
<meta property="og:url" content="https://mlh.app/2019/04/18/728735.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-18T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"导读：每个数据科学专业人员都必须从不同的数据源中提取、转换和加载（Extract-Transform-Load，ETL）数据。 本文将讨论如何使用Python为选定的流行数据库实现数据的ETL。对于关系数据库，选择MySQL，并将Elasticsearch作为文档数据库的例子展开。对于图形数据库，选择Neo4j。对于NoSQL，可参考此前文章中介绍的MongoDB。 作者：萨扬·穆霍帕迪亚（Sayan Mukhopadhyay） 如需转载请联系大数据（ID：hzdashuju） ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。 Neo4j是一个高性能的,NOSQL图形数据库，它将结构化数据存储在网络上(从数学角度叫做图)而不是表中，是一个嵌入式的、基于磁盘的、具备完全的事务特性的Java持久化引擎。 01 MySQL MySQLdb是在MySQL C接口上面开发的Python API。 1. 如何安装MySQLdb 首先，需要在计算机上安装Python MySQLdb模块。然后运行以下脚本： #!/usr/bin/pythonimport&nbsp;MySQLdb 如果出现导入错误，则表示模块未正确安装。 以下是安装MySQL Python模块的说明： $gunzip&nbsp;MySQL-python-1.2.2.tar.gz$tar&nbsp;–xvf&nbsp;MySQL-python-1.2.2.tar$cd&nbsp;MySQL-python-1.2.2$python&nbsp;setup.py&nbsp;build$python&nbsp;setup.py&nbsp;install 2. 数据库连接 在连接到MySQL数据库之前，请确保有以下内容。 有一个名为TEST的数据库。 在TEST数据库中有一个表STUDENT。 STUDENT表有三个字段：NAME、SUR_NAME和ROLL_NO。 用户对TEST数据库具有完全访问权限。 3. INSERT操作 以下代码执行SQL INSERT语句，以便在STUDENT表中创建记录： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.sql&nbsp;=&nbsp;&quot;&quot;&quot;INSERT&nbsp;INTO&nbsp;STUDENT(NAME,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUR_NAME,&nbsp;ROLL_NO)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;(&#39;Sayan&#39;,&nbsp;&#39;Mukhopadhyay&#39;,&nbsp;1)&quot;&quot;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;database&nbsp;&nbsp;&nbsp;db.commit()except:&nbsp;&nbsp;&nbsp;#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;error&nbsp;&nbsp;&nbsp;db.rollback()#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 4. READ操作 以下代码从STUDENT表中提取数据并打印出来： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.sql&nbsp;=&nbsp;&quot;SELECT&nbsp;*&nbsp;FROM&nbsp;STUDENT&nbsp;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Fetch&nbsp;all&nbsp;the&nbsp;rows&nbsp;in&nbsp;a&nbsp;list&nbsp;of&nbsp;lists.results&nbsp;=&nbsp;cursor.fetchall()for&nbsp;row&nbsp;in&nbsp;results:fname&nbsp;=&nbsp;row[0]lname&nbsp;=&nbsp;row[1]id&nbsp;=&nbsp;row[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Now&nbsp;print&nbsp;fetched&nbsp;resultprint&nbsp;&quot;name=%s,surname=%s,id=%d&quot;&nbsp;%&nbsp;\\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fname,&nbsp;lname,&nbsp;id&nbsp;)except:print&nbsp;&quot;Error:&nbsp;unable&nbsp;to&nbsp;fecth&nbsp;data&quot;#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 5. DELETE操作 以下代码从TEST中删除id=1的一行数据： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;test&quot;,&quot;passwd&quot;,&quot;TEST&quot;)#prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;methodcursor&nbsp;=&nbsp;db.cursor()#&nbsp;PrepareSQL&nbsp;query&nbsp;to&nbsp;DELETE&nbsp;required&nbsp;recordssql=&quot;DELETE&nbsp;FROM&nbsp;STUDENT&nbsp;WHERE&nbsp;ROLL_NO=1&quot;try:#Execute&nbsp;the&nbsp;SQL&nbsp;command&nbsp;cursor.execute(sql)#Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;databasedb.commit()except:#Roll&nbsp;back&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;errordb.rollback()#disconnect&nbsp;from&nbsp;server&nbsp;db.close() 6. UPDATE操作 以下代码将lastname为Mukhopadhyay的记录更改为Mukherjee： #!/usr/bin/pythonimport&nbsp;MySQLdb#&nbsp;Open&nbsp;database&nbsp;connectiondb&nbsp;=&nbsp;MySQLdb.connect(&quot;localhost&quot;,&quot;user&quot;,&quot;passwd&quot;,&quot;TEST&quot;&nbsp;)#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;usingcursor()&nbsp;method&nbsp;cursor&nbsp;=&nbsp;db.cursor()#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;UPDATE&nbsp;required&nbsp;recordssql&nbsp;=&nbsp;&quot;UPDATE&nbsp;STUDENT&nbsp;SET&nbsp;SUR_NAME=&quot;Mukherjee&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SUR_NAME=&quot;Mukhopadhyay&quot;&quot;try:&nbsp;&nbsp;&nbsp;#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;commandcursor.execute(sql)&nbsp;&nbsp;&nbsp;#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;databasedb.commit()except:&nbsp;&nbsp;&nbsp;#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;errordb.rollback()#&nbsp;disconnect&nbsp;from&nbsp;serverdb.close() 7. COMMIT操作 提交操作提供对数据库完成修改命令，并且在此操作之后，无法将其还原。 8. ROLL-BACK操作 如果不能确认对数据的修改同时想要撤回操作，可以使用roll-back()方法。 以下是通过Python访问MySQL数据的完整示例。它将提供将数据存储为CSV文件或MySQL数据库中的数据的完整描述。 import&nbsp;MySQLdbimport&nbsp;sysout&nbsp;=&nbsp;open(&#39;Config1.txt&#39;,&#39;w&#39;)print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;print&nbsp;&quot;1.&nbsp;MySql&quot;print&nbsp;&quot;2.&nbsp;Text&quot;print&nbsp;&quot;3.&nbsp;Exit&quot;while(1):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data1&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;1):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;begin&quot;+&quot;\\n&quot;+&quot;type=mysql\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;ip:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;host=&quot;&nbsp;+&nbsp;ip&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;database&nbsp;name:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;database=&quot;&nbsp;+&nbsp;db&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;user&nbsp;name:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usr&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;user=&quot;&nbsp;+&nbsp;usr&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;password:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwd&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;password=&quot;&nbsp;+&nbsp;passwd&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;MySQLdb.connect(ip,&nbsp;usr,&nbsp;passwd,&nbsp;db)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor&nbsp;=&nbsp;connection.cursor()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;&quot;show&nbsp;tables&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;field&nbsp;in&nbsp;row:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables.append(field.strip())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(tables)):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;i,&nbsp;tables[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb&nbsp;=&nbsp;tables[int(sys.stdin.readline().strip())]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;table=&quot;&nbsp;+&nbsp;tb&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;&quot;describe&nbsp;&quot;&nbsp;+&nbsp;tb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns.append(row[0].strip())&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(columns)):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;columns[i]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Not&nbsp;index&nbsp;choose&nbsp;the&nbsp;exact&nbsp;column&nbsp;names&nbsp;seperated&nbsp;by&nbsp;coma&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;columns=&quot;&nbsp;+&nbsp;cols&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;end&quot;+&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;1.&nbsp;MySql&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;2.&nbsp;Text&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;3.&nbsp;Exit&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;2):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;path&nbsp;of&nbsp;text&nbsp;file:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;=&nbsp;open(path)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;line&nbsp;in&nbsp;file:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;line&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;count&nbsp;&gt;&nbsp;3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;begin&quot;+&quot;\\n&quot;+&quot;type=text\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;path=&quot;&nbsp;+&nbsp;path&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;enter&nbsp;delimeter:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dlm&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;dlm=&quot;&nbsp;+&nbsp;dlm&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;enter&nbsp;column&nbsp;indexes&nbsp;seperated&nbsp;by&nbsp;comma:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;columns=&quot;&nbsp;+&nbsp;cols&nbsp;+&nbsp;&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(&quot;source&nbsp;end&quot;+&quot;\\n&quot;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;1.&nbsp;MySql&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;2.&nbsp;Text&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;3.&nbsp;Exit&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(int(data1)&nbsp;==&nbsp;3):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit() 02 Elasticsearch Elasticsearch（ES）低级客户端提供从Python到ES REST端点的直接映射。Elasticsearch的一大优势是为数据分析提供了全栈解决方案。Elasticsearch作为数据库，有可配置前端Kibana、数据收集工具Logstash以及企业安全工具Shield。 下例具有称为cat、cluster、indices、ingest、nodes、snapshot和tasks的特征，根据任务分别转换为CatClient、ClusterClient、IndicesClient、IngestClient、NodesClient、SnapshotClient和TasksClient实例。这些实例是访问这些类及其方法的唯一方式。 你可以指定自己的连接类，可以通过提供的connection_class参数来使用。 #&nbsp;create&nbsp;connection&nbsp;to&nbsp;local&nbsp;host&nbsp;using&nbsp;the&nbsp;ThriftConnectionEs1=Elasticsearch(connection_class=ThriftConnection) 如果你想打开sniffing，那么有几个选择： #&nbsp;create&nbsp;connection&nbsp;that&nbsp;will&nbsp;automatically&nbsp;inspect&nbsp;the&nbsp;cluster&nbsp;to&nbsp;get#&nbsp;the&nbsp;list&nbsp;of&nbsp;active&nbsp;nodes.&nbsp;Start&nbsp;with&nbsp;nodes&nbsp;running&nbsp;on&nbsp;&#39;esnode1&#39;&nbsp;and#&nbsp;&#39;esnode2&#39;Es1=Elasticsearch(&nbsp;&nbsp;&nbsp;&nbsp;[&#39;esnode1&#39;,&nbsp;&#39;esnode2&#39;],#&nbsp;sniff&nbsp;before&nbsp;doing&nbsp;anythingsniff_on_start=True,#&nbsp;refresh&nbsp;nodes&nbsp;after&nbsp;a&nbsp;node&nbsp;fails&nbsp;to&nbsp;respondsniff_on_connection_fail=True,#&nbsp;and&nbsp;also&nbsp;every&nbsp;30&nbsp;secondssniffer_timeout=30) 不同的主机可以有不同的参数，你可以为每个节点使用一个字典来指定它们。 #&nbsp;connect&nbsp;to&nbsp;localhost&nbsp;directly&nbsp;and&nbsp;another&nbsp;node&nbsp;using&nbsp;SSL&nbsp;on&nbsp;port&nbsp;443#&nbsp;and&nbsp;an&nbsp;url_prefix.&nbsp;Note&nbsp;that&nbsp;``port``&nbsp;needs&nbsp;to&nbsp;be&nbsp;an&nbsp;int.Es1=Elasticsearch([{&#39;host&#39;:&#39;localhost&#39;},{&#39;host&#39;:&#39;othernode&#39;,&#39;port&#39;:443,&#39;url_prefix&#39;:&#39;es&#39;,&#39;use_ssl&#39;:True},]) 还支持SSL客户端身份验证（有关选项的详细说明，请参阅Urllib3HttpConnection）。 Es1=Elasticsearch([&#39;localhost:443&#39;,&#39;other_host:443&#39;],#&nbsp;turn&nbsp;on&nbsp;SSLuse_ssl=True,#&nbsp;make&nbsp;sure&nbsp;we&nbsp;verify&nbsp;SSL&nbsp;certificates&nbsp;(off&nbsp;by&nbsp;default)verify_certs=True,#&nbsp;provide&nbsp;a&nbsp;path&nbsp;to&nbsp;CA&nbsp;certs&nbsp;on&nbsp;diskca_certs=&#39;path&nbsp;to&nbsp;CA_certs&#39;,#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;certificateclient_cert=&#39;path&nbsp;to&nbsp;clientcert.pem&#39;,#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;keyclient_key=&#39;path&nbsp;to&nbsp;clientkey.pem&#39;) 连接层API 许多类负责处理Elasticsearch集群。这里可以通过将参数传递给Elasticsearch类来忽略正在使用的默认子类。属于客户端的每个参数都将添加到Transport、ConnectionPool和Connection上。 例如，如果你要使用定制的ConnectionSelector类，只需传入selector_class参数即可。 整个API以很高的精确度包装了原始REST API，其中包括区分调用必需参数和可选参数。这意味着代码区分了按排位的参数和关键字参数。建议读者使用关键字参数来保证所有调用的一致性和安全性。 如果Elasticsearch返回2XX，则API调用成功（并将返回响应）。否则，将引发TransportError（或更具体的子类）的实例。你可以在异常中查看其他异常和错误状态。如果你不希望引发异常，可以通过传入ignore参数忽略状态代码或状态代码列表。 from&nbsp;elasticsearch&nbsp;import&nbsp;Elasticsearches=Elasticsearch()#&nbsp;ignore&nbsp;400&nbsp;cause&nbsp;by&nbsp;IndexAlreadyExistsException&nbsp;when&nbsp;creating&nbsp;an&nbsp;indexes.indices.create(index=&#39;test-index&#39;,ignore=400)#&nbsp;ignore&nbsp;404&nbsp;and&nbsp;400es.indices.delete(index=&#39;test-index&#39;,ignore=[400,404]) 03 Neo4j Python驱动 Neo4j支持Neo4j Python驱动，并通过二进制协议与数据库连接。它试图保持简约及Python的惯用方式。 pip&nbsp;install&nbsp;neo4j-driverfrom&nbsp;neo4j.v1&nbsp;import&nbsp;GraphDatabase,&nbsp;basic_authdriver11&nbsp;=&nbsp;GraphDatabase.driver(&quot;bolt://localhost&quot;,&nbsp;auth=basic_auth(&quot;neo4j&quot;,&nbsp;&quot;neo4j&quot;))session11&nbsp;=&nbsp;driver11.session()session11.run(&quot;CREATE&nbsp;(a:Person&nbsp;{name:&#39;Sayan&#39;,title:&#39;Mukhopadhyay&#39;})&quot;)result11=&nbsp;session11.run(&quot;MATCH&nbsp;(a:Person)&nbsp;WHERE&nbsp;a.name&nbsp;=&#39;Sayan&#39;&nbsp;RETURN&nbsp;a.name&nbsp;AS&nbsp;name,&nbsp;a.title&nbsp;AS&nbsp;title&quot;)for&nbsp;recordi&nbsp;n&nbsp;result11:print(&quot;%s&nbsp;%s&quot;%&nbsp;(record[&quot;title&quot;],&nbsp;record[&quot;name&quot;]))session11.close() 04 neo4j-rest-client neo4j-rest-client的主要目标是确保已经使用本地Neo4j的Python程序员通过python-embedded的方式也能够访问Neo4j REST服务器。因此，neo4j-rest-client API的结构与python-embedded完全同步。但是引入了一种新的结构，以达到更加Python化的风格，并通过Neo4j团队引入的新特性来增强API。 05 内存数据库 另一个重要的数据库类是内存数据库。它在RAM中存储和处理数据。因此，对数据库的操作非常快，并且数据是灵活的。SQLite是内存数据库的一个流行范例。在Python中，需要使用sqlalchemy库来操作SQLite。在第1章的Flask和Falcon示例中，展示了如何从SQLite中选择数据。以下将展示如何在SQLite中存储Pandas数据框架： from&nbsp;sqlalchemy&nbsp;import&nbsp;create_engineimport&nbsp;sqlite3conn&nbsp;=&nbsp;sqlite3.connect(&#39;multiplier.db&#39;)conn.execute(&#39;&#39;&#39;CREATE&nbsp;TABLE&nbsp;if&nbsp;not&nbsp;exists&nbsp;multiplier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAR(50),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL);&#39;&#39;&#39;)conn.close()db_name&nbsp;=&nbsp;&quot;sqlite:///&quot;&nbsp;+&nbsp;prop&nbsp;+&nbsp;&quot;_&quot;&nbsp;+&nbsp;domain&nbsp;+&nbsp;str(i)&nbsp;+&nbsp;&quot;.db&quot;disk_engine&nbsp;=&nbsp;create_engine(db_name)df.to_sql(&#39;scores&#39;,&nbsp;disk_engine,&nbsp;if_exists=&#39;replace&#39;) 06 Python版本MongoDB 这部分内容请见此前的文章数据处理入门干货：MongoDB和pandas极简教程。 关于作者：Sayan Mukhopadhyay拥有超过13年的行业经验，并与瑞信、PayPal、CA Technologies、CSC和Mphasis等公司建立了联系。他对投资银行、在线支付、在线广告、IT架构和零售等领域的数据分析应用有着深刻的理解。他的专业领域是在分布式和数据驱动的环境（如实时分析、高频交易等）中，实现高性能计算。 本文摘编自《Python高级数据分析：机器学习、深度学习和NLP实例》，经出版方授权发布。 延伸阅读《Python高级数据分析》 点击上图了解及购买 转载请联系微信：DoctorData 推荐语：本书介绍高级数据分析概念的广泛基础，以及最近的数据库革命，如Neo4j、弹性搜索和MongoDB。本书讨论了如何实现包括局部爬取在内的ETL技术，并应用于高频算法交易和目标导向的对话系统等领域。还有一些机器学习概念的例子，如半监督学习、深度学习和NLP。本书还涵盖了重要的传统数据分析技术，如时间序列和主成分分析等。 你想免费读这本《Python高级数据分析：机器学习、深度学习和NLP实例》吗？ 「大数据」内容合伙人之「鉴书小分队」上线啦！ 最近，你都在读什么书？有哪些心得体会想要跟大家分享？ 数据叔最近搞了个大事——联合优质图书出版商机械工业出版社华章公司发起鉴书活动。 简单说就是：你可以免费读新书，你可以免费读新书的同时，顺手码一篇读书笔记就行。详情请在大数据公众号后台对话框回复合伙人查看。 京东图书大促开始啦！ 每满100-50！满200-100！满300-150！ 长按二维码进入唯一领券入口，领取大数据粉丝专属“200减35”叠加满减券。 是的！你没看错！相当于165块买400块的书！！！（打了多少折你敲敲旁边的计算器……） 长按下方二维码或点击阅读原文 发现更多好书 据统计，99%的大咖都完成了这个神操作 ▼ 更多精彩 在公众号后台对话框输入以下关键词 查看更多优质内容！ PPT&nbsp;|&nbsp;报告&nbsp;|&nbsp;读书&nbsp;|&nbsp;书单&nbsp;|&nbsp;干货&nbsp; 大数据&nbsp;|&nbsp;揭秘&nbsp;|&nbsp;Python&nbsp;|&nbsp;可视化 人工智能&nbsp;|&nbsp;机器学习&nbsp;|&nbsp;深度学习&nbsp;|&nbsp;神经网络 AI&nbsp;|&nbsp;1024&nbsp;|&nbsp;段子&nbsp;|&nbsp;区块链&nbsp;|&nbsp;数学 猜你想看 如果你不想长期996，看看这个 数据采集技术揭秘：手把手教你全埋点技术解决方案 那些“反人类”的用户体验，都错在哪了？ 一文看懂数据挖掘：哪一种方法最好？都需要哪些技术？ Q: 你常用哪些数据库？ 欢迎留言并赢取福利 觉得不错，请把这篇文章分享给你的朋友 转载 / 投稿请联系：baiyu@hzbook.com 更多精彩，请在后台点击“历史文章”查看 点击阅读原文，了解更多","@type":"BlogPosting","url":"https://mlh.app/2019/04/18/728735.html","headline":"以5个数据库为例，用Python实现数据的提取、转换和加载（ETL）","dateModified":"2019-04-18T00:00:00+08:00","datePublished":"2019-04-18T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/04/18/728735.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>以5个数据库为例，用Python实现数据的提取、转换和加载（ETL）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="rich_media_content" id="js_content"> 
   <p style="font-size:16px;"><img style="font-family:Helvetica, Arial, sans-serif;color:rgb(73,59,59);font-size:15px;letter-spacing:.544px;line-height:25.6px;width:558px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/KfLGF0ibu6cLJiaicLnPCqYROg1Y8spzCyZGKg6ra9H53HCaejCGGjuXl9x9VZ0iaQQCSCzibMkS0iciaQpAntVMQibPgQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><br></p>
   <span style="line-height:26.25px;color:rgb(73,59,59);font-size:15px;font-family:'微软雅黑';"></span>
   <p><strong><span style="line-height:26.25px;letter-spacing:0px;">导读：</span></strong><span style="letter-spacing:0px;">每个数据科学专业人员都必须从不同的数据源中提取、转换和加载（Extract-Transform-Load，ETL）数据。</span></p>
   <p style="font-size:16px;letter-spacing:0px;line-height:1.75em;"><br></p>
   <p style="font-size:16px;letter-spacing:0px;line-height:1.75em;"><span style="color:rgb(73,59,59);font-size:15px;">本文将讨论如何使用Python为选定的流行数据库实现数据的ETL。对于关系数据库，选择MySQL，并将Elasticsearch作为文档数据库的例子展开。对于图形数据库，选择Neo4j。对于NoSQL，可参考此前文章中介绍的</span><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODE1NDYyMA==&amp;mid=2653391387&amp;idx=2&amp;sn=397a23a95a74fdbc48e4996b3f8c6a7e&amp;chksm=bd1c32088a6bbb1e03b88d725f8cb079dbe9e90e71ab6fdd070260fbb7d68a462aaab725fd1c&amp;scene=21#wechat_redirect" rel="nofollow" style="color:rgb(73,59,59);text-decoration:underline;font-size:15px;">MongoDB</a><span style="color:rgb(73,59,59);font-size:15px;">。</span></p>
   <p><br></p>
   <p style="font-size:16px;letter-spacing:0px;line-height:1.75em;"><span style="font-size:14px;color:rgb(127,127,127);">作者：萨扬·穆霍帕迪亚（Sayan Mukhopadhyay）</span></p>
   <p style="font-size:16px;letter-spacing:0px;line-height:1.75em;"><span style="font-size:14px;color:rgb(127,127,127);"><span style="font-family:'微软雅黑';letter-spacing:.544px;">如需转载请联系大数据（ID：hzdashuju）</span></span></p>
   <p><br></p>
   <ul class="list-paddingleft-2" style="list-style-type:square;">
    <li><p style="line-height:1.75em;"><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:normal;">ElasticSearch是一个基于Lucene的搜索服务器。</span><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:normal;">它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。</span><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:normal;">Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。</span></p></li>
    <li><p style="line-height:1.75em;"><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:normal;">Neo4j是一个高性能的,NOSQL图形数据库，它将结构化数据存储在网络上(从数学角度叫做图)而不是表中，是一个嵌入式的、基于磁盘的、具备完全的事务特性的Java持久化引擎。</span></p></li>
   </ul>
   <p><br></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="color:#007AAA;font-size:18px;">01 MySQL</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">MySQLdb是在MySQL C接口上面开发的Python API。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">1. 如何安装MySQLdb</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">首先，需要在计算机上安装Python MySQLdb模块。然后运行以下脚本：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="hljs coffeescript" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#!/usr/bin/python</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;MySQLdb<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">如果出现导入错误，则表示模块未正确安装。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">以下是安装MySQL Python模块的说明：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);">$gunzip&nbsp;MySQL-python<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">-1.2.2</span>.tar.gz<br>$tar&nbsp;–xvf&nbsp;MySQL-python<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">-1.2.2</span>.tar<br>$cd&nbsp;MySQL-python<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">-1.2.2</span><br>$python&nbsp;setup.py&nbsp;build<br>$python&nbsp;setup.py&nbsp;install<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">2. 数据库连接</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">在连接到MySQL数据库之前，请确保有以下内容。</span></p>
   <p><br></p>
   <ul class="list-paddingleft-2" style="list-style-type:square;">
    <li><p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">有一个名为TEST的数据库。</span></p></li>
    <li><p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">在TEST数据库中有一个表STUDENT。</span></p></li>
    <li><p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">STUDENT表有三个字段：NAME、SUR_NAME和ROLL_NO。</span></p></li>
    <li><p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">用户对TEST数据库具有完全访问权限。</span></p></li>
   </ul>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">3. INSERT操作</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">以下代码执行SQL INSERT语句，以便在STUDENT表中创建记录：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#!/usr/bin/python</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;MySQLdb<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Open&nbsp;database&nbsp;connection</span><br>db&nbsp;=&nbsp;MySQLdb.connect(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"localhost"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"user"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"passwd"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"TEST"</span>&nbsp;)<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;method</span><br>cursor&nbsp;=&nbsp;db.cursor()<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.</span><br>sql&nbsp;=&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"""INSERT&nbsp;INTO&nbsp;STUDENT(NAME,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUR_NAME,&nbsp;ROLL_NO)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;('Sayan',&nbsp;'Mukhopadhyay',&nbsp;1)"""</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">try</span>:<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;command</span><br>cursor.execute(sql)<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;database</span><br>&nbsp;&nbsp;&nbsp;db.commit()<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">except</span>:<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;error</span><br>&nbsp;&nbsp;&nbsp;db.rollback()<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;disconnect&nbsp;from&nbsp;server</span><br>db.close()<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">4. READ操作</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">以下代码从STUDENT表中提取数据并打印出来：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#!/usr/bin/python</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;MySQLdb<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Open&nbsp;database&nbsp;connection</span><br>db&nbsp;=&nbsp;MySQLdb.connect(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"localhost"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"user"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"passwd"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"TEST"</span>&nbsp;)<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;method</span><br>cursor&nbsp;=&nbsp;db.cursor()<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;INSERT&nbsp;a&nbsp;record&nbsp;into&nbsp;the&nbsp;database.</span><br>sql&nbsp;=&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"SELECT&nbsp;*&nbsp;FROM&nbsp;STUDENT&nbsp;"</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">try</span>:<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;command</span><br>cursor.execute(sql)<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Fetch&nbsp;all&nbsp;the&nbsp;rows&nbsp;in&nbsp;a&nbsp;list&nbsp;of&nbsp;lists.</span><br>results&nbsp;=&nbsp;cursor.fetchall()<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;row&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;results:<br>fname&nbsp;=&nbsp;row[<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">0</span>]<br>lname&nbsp;=&nbsp;row[<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">1</span>]<br>id&nbsp;=&nbsp;row[<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">2</span>]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Now&nbsp;print&nbsp;fetched&nbsp;result</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"name=%s,surname=%s,id=%d"</span>&nbsp;%&nbsp;\<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(fname,&nbsp;lname,&nbsp;id&nbsp;)<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">except</span>:<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Error:&nbsp;unable&nbsp;to&nbsp;fecth&nbsp;data"</span><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;disconnect&nbsp;from&nbsp;server</span><br>db.close()<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">5. DELETE操作</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">以下代码从TEST中删除id=1的一行数据：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#!/usr/bin/python</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;MySQLdb<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Open&nbsp;database&nbsp;connection</span><br>db&nbsp;=&nbsp;MySQLdb.connect(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"localhost"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"test"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"passwd"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"TEST"</span>)<br><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using&nbsp;cursor()&nbsp;method</span><br>cursor&nbsp;=&nbsp;db.cursor()<br><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;PrepareSQL&nbsp;query&nbsp;to&nbsp;DELETE&nbsp;required&nbsp;records</span><br>sql=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"DELETE&nbsp;FROM&nbsp;STUDENT&nbsp;WHERE&nbsp;ROLL_NO=1"</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">try</span>:<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#Execute&nbsp;the&nbsp;SQL&nbsp;command&nbsp;</span><br>cursor.execute(sql)<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;database</span><br>db.commit()<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">except</span>:<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#Roll&nbsp;back&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;error</span><br>db.rollback()<br><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#disconnect&nbsp;from&nbsp;server&nbsp;</span><br>db.close()<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">6. UPDATE操作</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">以下代码将lastname为Mukhopadhyay的记录更改为Mukherjee：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#!/usr/bin/python</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;MySQLdb<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Open&nbsp;database&nbsp;connection</span><br>db&nbsp;=&nbsp;MySQLdb.connect(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"localhost"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"user"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"passwd"</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"TEST"</span>&nbsp;)<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;prepare&nbsp;a&nbsp;cursor&nbsp;object&nbsp;using</span><br>cursor()&nbsp;method&nbsp;cursor&nbsp;=&nbsp;db.cursor()<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Prepare&nbsp;SQL&nbsp;query&nbsp;to&nbsp;UPDATE&nbsp;required&nbsp;records</span><br>sql&nbsp;=&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"UPDATE&nbsp;STUDENT&nbsp;SET&nbsp;SUR_NAME="</span>Mukherjee<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SUR_NAME="</span>Mukhopadhyay<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">""</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">try</span>:<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Execute&nbsp;the&nbsp;SQL&nbsp;command</span><br>cursor.execute(sql)<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Commit&nbsp;your&nbsp;changes&nbsp;in&nbsp;the&nbsp;database</span><br>db.commit()<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">except</span>:<br>&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;Rollback&nbsp;in&nbsp;case&nbsp;there&nbsp;is&nbsp;any&nbsp;error</span><br>db.rollback()<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;disconnect&nbsp;from&nbsp;server</span><br>db.close()<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">7. COMMIT操作</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">提交操作提供对数据库完成修改命令，并且在此操作之后，无法将其还原。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:#007AAA;">8. ROLL-BACK操作</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">如果不能确认对数据的修改同时想要撤回操作，可以使用roll-back()方法。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">以下是通过Python访问MySQL数据的完整示例。它将提供将数据存储为CSV文件或MySQL数据库中的数据的完整描述。</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;MySQLdb<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;sys<br><br>out&nbsp;=&nbsp;open(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'Config1.txt'</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'w'</span>)<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:"</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"1.&nbsp;MySql"</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"2.&nbsp;Text"</span><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"3.&nbsp;Exit"</span><br><br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">while</span>(<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">1</span>):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data1&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">if</span>(int(data1)&nbsp;==&nbsp;<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">1</span>):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"source&nbsp;begin"</span>+<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>+<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"type=mysql\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;ip:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"host="</span>&nbsp;+&nbsp;ip&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;database&nbsp;name:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"database="</span>&nbsp;+&nbsp;db&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;user&nbsp;name:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usr&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"user="</span>&nbsp;+&nbsp;usr&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;password:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;passwd&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"password="</span>&nbsp;+&nbsp;passwd&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection&nbsp;=&nbsp;MySQLdb.connect(ip,&nbsp;usr,&nbsp;passwd,&nbsp;db)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor&nbsp;=&nbsp;connection.cursor()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"show&nbsp;tables"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables&nbsp;=&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;row&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;data:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;field&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;row:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables.append(field.strip())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;i&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;range(len(tables)):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;i,&nbsp;tables[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tb&nbsp;=&nbsp;tables[int(sys.stdin.readline().strip())]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"table="</span>&nbsp;+&nbsp;tb&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;=&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"describe&nbsp;"</span>&nbsp;+&nbsp;tb<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(query)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;cursor.fetchall()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns&nbsp;=&nbsp;[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;row&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;data:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columns.append(row[<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">0</span>].strip())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;i&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;range(len(columns)):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;columns[i]&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Not&nbsp;index&nbsp;choose&nbsp;the&nbsp;exact&nbsp;column&nbsp;names&nbsp;seperated&nbsp;by&nbsp;coma"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"columns="</span>&nbsp;+&nbsp;cols&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cursor.close()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.close()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"source&nbsp;end"</span>+<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"1.&nbsp;MySql"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"2.&nbsp;Text"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"3.&nbsp;Exit"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">if</span>(int(data1)&nbsp;==&nbsp;<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">2</span>):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"path&nbsp;of&nbsp;text&nbsp;file:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;=&nbsp;open(path)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;line&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">in</span>&nbsp;file:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;line<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;count&nbsp;+&nbsp;<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">1</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">if</span>&nbsp;count&nbsp;&gt;&nbsp;<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">3</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">break</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.close()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"source&nbsp;begin"</span>+<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>+<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"type=text\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"path="</span>&nbsp;+&nbsp;path&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"enter&nbsp;delimeter:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dlm&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"dlm="</span>&nbsp;+&nbsp;dlm&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"enter&nbsp;column&nbsp;indexes&nbsp;seperated&nbsp;by&nbsp;comma:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;sys.stdin.readline().strip()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"columns="</span>&nbsp;+&nbsp;cols&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"source&nbsp;end"</span>+<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"\n"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"Enter&nbsp;the&nbsp;Data&nbsp;Source&nbsp;Type:"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"1.&nbsp;MySql"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"2.&nbsp;Text"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">print</span>&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"3.&nbsp;Exit"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">if</span>(int(data1)&nbsp;==&nbsp;<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">3</span>):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.close()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()<br></code></pre>
   <p><br></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="color:#007AAA;font-size:18px;">02 Elasticsearch</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">Elasticsearch（ES）低级客户端提供从Python到ES REST端点的直接映射。Elasticsearch的一大优势是为数据分析提供了全栈解决方案。Elasticsearch作为数据库，有可配置前端Kibana、数据收集工具Logstash以及企业安全工具Shield。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">下例具有称为cat、cluster、indices、ingest、nodes、snapshot和tasks的特征，根据任务分别转换为CatClient、ClusterClient、IndicesClient、IngestClient、NodesClient、SnapshotClient和TasksClient实例。这些实例是访问这些类及其方法的唯一方式。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">你可以指定自己的连接类，可以通过提供的connection_class参数来使用。</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;create&nbsp;connection&nbsp;to&nbsp;local&nbsp;host&nbsp;using&nbsp;the&nbsp;ThriftConnection</span><br>Es1=Elasticsearch(connection_class=ThriftConnection)<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">如果你想打开sniffing，那么有几个选择：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;create&nbsp;connection&nbsp;that&nbsp;will&nbsp;automatically&nbsp;inspect&nbsp;the&nbsp;cluster&nbsp;to&nbsp;get</span><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;the&nbsp;list&nbsp;of&nbsp;active&nbsp;nodes.&nbsp;Start&nbsp;with&nbsp;nodes&nbsp;running&nbsp;on&nbsp;'esnode1'&nbsp;and</span><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;'esnode2'</span><br>Es1=Elasticsearch(<br>&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'esnode1'</span>,&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'esnode2'</span>],<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;sniff&nbsp;before&nbsp;doing&nbsp;anything</span><br>sniff_on_start=<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">True</span>,<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;refresh&nbsp;nodes&nbsp;after&nbsp;a&nbsp;node&nbsp;fails&nbsp;to&nbsp;respond</span><br>sniff_on_connection_fail=<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">True</span>,<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;and&nbsp;also&nbsp;every&nbsp;30&nbsp;seconds</span><br>sniffer_timeout=<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">30</span><br>)<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">不同的主机可以有不同的参数，你可以为每个节点使用一个字典来指定它们。</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;connect&nbsp;to&nbsp;localhost&nbsp;directly&nbsp;and&nbsp;another&nbsp;node&nbsp;using&nbsp;SSL&nbsp;on&nbsp;port&nbsp;443</span><br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;and&nbsp;an&nbsp;url_prefix.&nbsp;Note&nbsp;that&nbsp;``port``&nbsp;needs&nbsp;to&nbsp;be&nbsp;an&nbsp;int.</span><br>Es1=Elasticsearch([<br>{<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'host'</span>:<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'localhost'</span>},<br>{<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'host'</span>:<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'othernode'</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'port'</span>:<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">443</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'url_prefix'</span>:<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'es'</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'use_ssl'</span>:<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">True</span>},<br>])<br></code></pre>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">还支持SSL客户端身份验证（有关选项的详细说明，请参阅Urllib3</span><span style="color:rgb(73,59,59);font-size:15px;letter-spacing:0px;">HttpConnection）。</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);">Es1=Elasticsearch(<br>[<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'localhost:443'</span>,<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'other_host:443'</span>],<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;turn&nbsp;on&nbsp;SSL</span><br>use_ssl=<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">True</span>,<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;make&nbsp;sure&nbsp;we&nbsp;verify&nbsp;SSL&nbsp;certificates&nbsp;(off&nbsp;by&nbsp;default)</span><br>verify_certs=<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">True</span>,<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;provide&nbsp;a&nbsp;path&nbsp;to&nbsp;CA&nbsp;certs&nbsp;on&nbsp;disk</span><br>ca_certs=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'path&nbsp;to&nbsp;CA_certs'</span>,<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;certificate</span><br>client_cert=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'path&nbsp;to&nbsp;clientcert.pem'</span>,<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;PEM&nbsp;formatted&nbsp;SSL&nbsp;client&nbsp;key</span><br>client_key=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'path&nbsp;to&nbsp;clientkey.pem'</span><br>)</code></pre>
   <p><br></p>
   <ul class="list-paddingleft-2" style="list-style-type:square;">
    <li><p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="font-size:15px;color:rgb(0,122,170);">连接层API</span></strong><span style="color:#493B3B;font-size:15px;"></span></p></li>
   </ul>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">许多类负责处理Elasticsearch集群。这里可以通过将参数传递给Elasticsearch类来忽略正在使用的默认子类。属于客户端的每个参数都将添加到Transport、ConnectionPool和Connection上。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">例如，如果你要使用定制的ConnectionSelector类，只需传入selector_class参数即可。</span></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">整个API以很高的精确度包装了原始REST API，其中包括区分调用必需参数和可选参数。这意味着代码区分了按排位的参数和关键字参数。建议读者使用关键字参数来保证所有调用的一致性和安全性。</span></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;"><br></span></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">如果Elasticsearch返回2XX，则API调用成功（并将返回响应）。否则，将引发TransportError（或更具体的子类）的实例。你可以在异常中查看其他异常和错误状态。如果你不希望引发异常，可以通过传入ignore参数忽略状态代码或状态代码列表。</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">from</span>&nbsp;elasticsearch&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;Elasticsearch<br>es=Elasticsearch()<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;ignore&nbsp;400&nbsp;cause&nbsp;by&nbsp;IndexAlreadyExistsException&nbsp;when&nbsp;creating&nbsp;an&nbsp;index</span><br>es.indices.create(index=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'test-index'</span>,ignore=<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">400</span>)<br><span class="hljs-comment" style="font-size:inherit;line-height:inherit;color:rgb(128,128,128);">#&nbsp;ignore&nbsp;404&nbsp;and&nbsp;400</span><br>es.indices.delete(index=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'test-index'</span>,ignore=[<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">400</span>,<span class="hljs-number" style="font-size:inherit;line-height:inherit;color:rgb(174,135,250);">404</span>])<br></code></pre>
   <p><br></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="color:#007AAA;font-size:18px;">03 Neo4j Python驱动</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">Neo4j支持Neo4j Python驱动，并通过二进制协议与数据库连接。它试图保持简约及Python的惯用方式。</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);">pip&nbsp;install&nbsp;neo4j-driver<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">from</span>&nbsp;neo4j.v1&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;GraphDatabase,&nbsp;basic_auth<br>driver11&nbsp;=&nbsp;GraphDatabase.driver(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"bolt://localhost"</span>,&nbsp;auth=basic_auth(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"neo4j"</span>,&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"neo4j"</span>))<br>session11&nbsp;=&nbsp;driver11.session()<br>session11.run(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"CREATE&nbsp;(a:Person&nbsp;{name:'Sayan',title:'Mukhopadhyay'})"</span>)<br>result11=&nbsp;session11.run(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"MATCH&nbsp;(a:Person)&nbsp;WHERE&nbsp;a.name&nbsp;='Sayan'&nbsp;RETURN&nbsp;a.name&nbsp;AS&nbsp;name,&nbsp;a.title&nbsp;AS&nbsp;title"</span>)<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">for</span>&nbsp;recordi&nbsp;n&nbsp;result11:<br>print(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"%s&nbsp;%s"</span>%&nbsp;(record[<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"title"</span>],&nbsp;record[<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"name"</span>]))<br>session11.close()<br></code></pre>
   <p><br></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="color:#007AAA;font-size:18px;">04 neo4j-rest-client</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">neo4j-rest-client的主要目标是确保已经使用本地Neo4j的Python程序员通过python-embedded的方式也能够访问Neo4j REST服务器。因此，neo4j-rest-client API的结构与python-embedded完全同步。但是引入了一种新的结构，以达到更加Python化的风格，并通过Neo4j团队引入的新特性来增强API。</span></p>
   <p><br></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><strong><span style="color:#007AAA;font-size:18px;">05 内存数据库</span></strong></p>
   <p><br></p>
   <p style="letter-spacing:0px;line-height:1.75em;"><span style="color:#493B3B;font-size:15px;">另一个重要的数据库类是内存数据库。它在RAM中存储和处理数据。因此，对数据库的操作非常快，并且数据是灵活的。SQLite是内存数据库的一个流行范例。在Python中，需要使用sqlalchemy库来操作SQLite。在第1章的Flask和Falcon示例中，展示了如何从SQLite中选择数据。以下将展示如何在SQLite中存储Pandas数据框架：</span></p>
   <p><br></p>
   <pre style="font-size:inherit;color:inherit;line-height:inherit;"><code class="python language-python hljs" style="margin-left:2px;line-height:18px;letter-spacing:0px;font-family:Consolas, Inconsolata, Courier, monospace;color:rgb(169,183,198);background:rgb(40,43,46);"><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">from</span>&nbsp;sqlalchemy&nbsp;<span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;create_engine<br><span class="hljs-keyword" style="font-size:inherit;line-height:inherit;color:rgb(248,35,117);">import</span>&nbsp;sqlite3<br>conn&nbsp;=&nbsp;sqlite3.connect(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'multiplier.db'</span>)<br>conn.execute(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'''CREATE&nbsp;TABLE&nbsp;if&nbsp;not&nbsp;exists&nbsp;multiplier<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAR(50),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL);'''</span>)<br>conn.close()<br>db_name&nbsp;=&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"sqlite:///"</span>&nbsp;+&nbsp;prop&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">"_"</span>&nbsp;+&nbsp;domain&nbsp;+&nbsp;str(i)&nbsp;+&nbsp;<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">".db"</span><br>disk_engine&nbsp;=&nbsp;create_engine(db_name)<br>df.to_sql(<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'scores'</span>,&nbsp;disk_engine,&nbsp;if_exists=<span class="hljs-string" style="font-size:inherit;line-height:inherit;color:rgb(238,220,112);">'replace'</span>)<br></code></pre>
   <p><br></p>
   <p><br></p>
   <p><strong style="font-size:16px;"><span style="color:rgb(0,122,170);font-size:18px;">06 Python版本MongoDB</span></strong></p>
   <p><br></p>
   <p><span style="color:#493B3B;font-size:15px;">这部分内容请见此前的文章</span><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODE1NDYyMA==&amp;mid=2653391387&amp;idx=2&amp;sn=397a23a95a74fdbc48e4996b3f8c6a7e&amp;chksm=bd1c32088a6bbb1e03b88d725f8cb079dbe9e90e71ab6fdd070260fbb7d68a462aaab725fd1c&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;"><span style="text-decoration:underline;font-size:15px;color:rgb(73,59,59);">数据处理入门干货：</span><span style="text-decoration:underline;font-size:15px;color:rgb(73,59,59);">MongoDB和pandas极简教程</span></a><span style="color:#493B3B;font-size:15px;">。</span><br></p>
   <p><br></p>
   <p style="font-family:'微软雅黑';font-size:16px;line-height:1.75em;"><span style="color:rgb(127,127,127);font-size:14px;">关于作者：</span><span style="color:rgb(127,127,127);font-size:14px;">Sayan Mukhopadhyay拥有超过13年的行业经验，并与瑞信、PayPal、CA Technologies、CSC和Mphasis等公司建立了联系。他对投资银行、在线支付、在线广告、IT架构和零售等领域的数据分析应用有着深刻的理解。他的专业领域是在分布式和数据驱动的环境（如实时分析、高频交易等）中，实现高性能计算。</span></p>
   <p style="font-family:'微软雅黑';font-size:16px;line-height:1.75em;"><span style="color:rgb(127,127,127);font-size:14px;"><span style="letter-spacing:.544px;">本文摘编自《</span>Python高级数据分析：机器学习、深度学习和NLP实例<span style="letter-spacing:.544px;">》，经出版方授权发布。</span></span></p>
   <p style="font-family:'微软雅黑';font-size:16px;"><br></p>
   <p style="font-family:'微软雅黑';font-size:16px;min-height:1em;text-align:center;line-height:1.75em;"><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:.544px;">延伸阅读《</span><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:.544px;text-align:justify;"><span style="letter-spacing:.544px;"><span style="letter-spacing:.544px;"><span style="letter-spacing:.544px;"><span style="letter-spacing:.544px;"><span style="letter-spacing:.544px;">Python高级数据分析</span></span></span></span></span></span><span style="color:rgb(127,127,127);font-size:14px;letter-spacing:.544px;">》</span></p>
   <p style="font-family:'微软雅黑';min-height:1em;letter-spacing:.544px;text-align:center;font-size:14px;color:rgb(63,63,63);line-height:1.75em;"><span style="color:rgb(127,127,127);"><span style="letter-spacing:.544px;">点击上图了解及购买</span></span></p>
   <p style="font-family:'微软雅黑';min-height:1em;letter-spacing:.544px;font-size:14px;color:rgb(63,63,63);text-align:center;line-height:1.75em;"><span style="color:rgb(127,127,127);">转载请联系微信：DoctorData</span></p>
   <p style="font-family:'微软雅黑';font-size:16px;min-height:1em;letter-spacing:.544px;text-align:center;"><br></p>
   <p style="font-family:'微软雅黑';font-size:16px;min-height:1em;letter-spacing:.544px;line-height:1.75em;"><strong><span style="color:rgb(127,127,127);font-size:14px;">推荐语：</span></strong><span style="color:rgb(127,127,127);font-size:14px;">本书介绍高级数据分析概念的广泛基础，以及最近的数据库革命，如Neo4j、弹性搜索和MongoDB。本书讨论了如何实现包括局部爬取在内的ETL技术，并应用于高频算法交易和目标导向的对话系统等领域。还有一些机器学习概念的例子，如半监督学习、深度学习和NLP。本书还涵盖了重要的传统数据分析技术，如时间序列和主成分分析等。</span></p>
   <p><br></p>
   <p style="text-align:center;"><img title="音符" style="letter-spacing:.544px;line-height:25.6px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/cZV2hRpuAPiaJQXWGyC9wrUzIicibgXayrgibTYarT3A1yzttbtaO0JlV21wMqroGYT3QtPq2C7HMYsvicSB2p7dTBg/640?" alt="640?"></p>
   <p><br></p>
   <p style="text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;color:rgb(0,122,170);">你想免费读这本《Python高级数据分析：机器学习、深度学习和NLP实例》吗？</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;"><br></p>
   <p style="text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;color:rgb(0,122,170);">「大数据」内容合伙人之「鉴书小分队」上线啦！</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;"><br></p>
   <p style="text-align:justify;"><span style="font-size:15px;color:rgb(73,59,59);">最近，你都在读什么书？</span><span style="font-size:15px;color:rgb(73,59,59);">有哪些心得体会想要跟大家分享？</span></p>
   <p><br></p>
   <p style="text-align:justify;"><span style="font-size:15px;color:rgb(73,59,59);">数据叔最近搞了个大事——联合优质图书出版商机械工业出版社华章公司发起鉴书活动。</span></p>
   <p style="text-align:justify;"><br></p>
   <p style="text-align:justify;"><span style="font-size:15px;color:rgb(73,59,59);">简单说就是：</span><strong><span style="font-size:15px;color:rgb(0,122,170);">你可以免费读新书，你可以免费读新书的同时，顺手码一篇读书笔记就行。</span></strong><span style="font-size:15px;color:rgb(73,59,59);">详情请在大数据公众号后台对话框回复<strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">合伙人</span></strong>查看。</span></p>
   <p><br></p>
   <p style="text-align:center;"><img title="音符" style="letter-spacing:.544px;line-height:25.6px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/cZV2hRpuAPiaJQXWGyC9wrUzIicibgXayrgibTYarT3A1yzttbtaO0JlV21wMqroGYT3QtPq2C7HMYsvicSB2p7dTBg/640?" alt="640?"></p>
   <p><br></p>
   <p style="text-align:justify;line-height:1.75em;"><strong><span style="font-size:15px;color:rgb(0,122,170);">京东图书大促开始啦！</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;"><br></p>
   <p style="text-align:justify;line-height:1.75em;"><strong><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(0,122,170);">每满100-50！</span><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(0,122,170);">满200-100！满300-150！</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;"><br></p>
   <p style="text-align:justify;line-height:1.75em;"><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(73,59,59);">长按二维码进入唯一领券入口，领取大数据粉丝专属“</span><strong><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(0,122,170);">200减35</span></strong><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(73,59,59);">”叠加满减券。</span></p>
   <p style="text-align:justify;line-height:1.75em;"><br></p>
   <p><img class="rich_pages" style="width:136px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/KfLGF0ibu6cJE4vD65Z3nUx7PPXUwlaCkWtNx2PIqiaFxOibG7icFvjKAc5Jzib05YkEAIEmOuicRhxyqGmfzC2l4ichQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;"><br></p>
   <p style="text-align:justify;line-height:1.75em;"><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(73,59,59);">是的！你没看错！相当于</span><strong><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(0,122,170);">165块买400块</span></strong><span style="font-family:Helvetica, Arial, sans-serif;font-size:15px;color:rgb(73,59,59);">的书！！！（打了多少折你敲敲旁边的计算器……）</span></p>
   <p><br></p>
   <p style="font-family:'微软雅黑';font-size:16px;text-align:center;"><img title="音符" style="letter-spacing:.544px;line-height:25.6px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/cZV2hRpuAPiaJQXWGyC9wrUzIicibgXayrgibTYarT3A1yzttbtaO0JlV21wMqroGYT3QtPq2C7HMYsvicSB2p7dTBg/640?" alt="640?"></p>
   <p><br></p>
   <p style="text-align:center;"><strong><span style="font-size:14px;color:rgb(0,122,170);">长按下方二维码</span></strong><span style="color:rgb(127,127,127);font-size:14px;">或点击</span><strong><span style="font-size:14px;color:rgb(0,122,170);">阅读原文</span></strong></p>
   <p style="text-align:center;"><span style="color:rgb(127,127,127);font-size:14px;">发现更多好书</span></p>
   <p style="text-align:center;"><br></p>
   <p style="text-align:center;"><img class="rich_pages" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/KfLGF0ibu6cJE4vD65Z3nUx7PPXUwlaCkmJDziaiaRsJyicuw7gHUicHBgTqmunjTx3w3NObuUQkqU33IE3rPhyObYg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p><br></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;line-height:1.75em;"><img title="音符" style="letter-spacing:.544px;line-height:25.6px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz/cZV2hRpuAPiaJQXWGyC9wrUzIicibgXayrgibTYarT3A1yzttbtaO0JlV21wMqroGYT3QtPq2C7HMYsvicSB2p7dTBg/640?" alt="640?"></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;line-height:1.75em;"><br></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;line-height:1.75em;"><span style="font-size:15px;color:rgb(73,59,59);">据统计，99%的大咖都完成了这个神操作</span></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;line-height:1.75em;"><span style="font-size:15px;color:rgb(73,59,59);">▼</span></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;line-height:1.75em;"><br></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;"><img style="width:265px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/KfLGF0ibu6cIEuJZLQqke2icoXk8XyCekEgxlt2oib09qia8s2icIAeb0wIFxnaZicL8EPqmAR4Y1q7jjcyeSaJ024pw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="font-size:16px;font-family:'微软雅黑';text-align:center;line-height:1.75em;"><br></p>
   <p style="min-height:1em;font-family:'-apple-system-font', BlinkMacSystemFont, Arial, sans-serif;font-size:17px;letter-spacing:.5px;line-height:1.75em;"><span style="color:rgb(0,122,170);font-family:'微软雅黑';font-size:20px;">更多精彩</span></p>
   <p style="min-height:1em;font-family:'-apple-system-font', BlinkMacSystemFont, Arial, sans-serif;font-size:17px;letter-spacing:.5px;line-height:1.75em;"><br></p>
   <p style="line-height:1.75em;"><span style="font-size:15px;color:rgb(73,59,59);">在公众号后台对话框输入以下</span><strong><span style="font-size:15px;color:rgb(0,122,170);">关键词</span></strong></p>
   <p style="line-height:1.75em;"><span style="font-size:15px;color:rgb(73,59,59);">查看更多优质内容！</span></p>
   <p style="line-height:1.75em;"><br></p>
   <p style="line-height:1.75em;"><strong style="color:rgb(73,59,59);"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">PPT</span></strong><span>&nbsp;</span></span></strong><span style="font-size:15px;color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;"><span>&nbsp;</span><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">报告</span></strong><span>&nbsp;</span></span></strong><span style="font-size:15px;color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;"><span>&nbsp;</span><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">读书</span></strong><span>&nbsp;</span></span></strong><span style="font-size:15px;color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;">&nbsp;<strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">书单&nbsp;</span></strong></span></strong><span style="font-size:15px;color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">&nbsp;<span style="color:rgb(73,59,59);"><strong style="font-size:16px;"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);"><strong style="color:rgb(73,59,59);"><span><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">干货</span></strong></span></strong></span></strong></span></strong></span><span style="color:rgb(73,59,59);">&nbsp;</span></span></strong></span></strong></p>
   <p style="line-height:1.75em;"><strong style="color:rgb(73,59,59);"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">大数据</span></strong></span></strong><strong style="color:rgb(73,59,59);"><span style="font-size:15px;">&nbsp;</span></strong><span style="font-size:15px;">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;">&nbsp;<strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">揭秘</span></strong><span>&nbsp;</span></span></strong><span style="font-size:15px;color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;">&nbsp;<strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">Python&nbsp;</span></strong></span></strong><span style="font-size:15px;color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">&nbsp;<strong style="color:rgb(73,59,59);font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">可视化</span></strong></span></strong></span></strong></p>
   <p style="line-height:1.75em;"><span style="font-size:15px;"><span><span style="color:rgb(73,59,59);"><strong style="font-size:16px;"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">人工智能&nbsp;</span></strong></span></strong><span>|</span><strong style="font-size:16px;"><span style="font-size:15px;">&nbsp;</span></strong></span><span style="color:rgb(0,122,170);"><strong>机器学习</strong></span></span><span style="color:rgb(73,59,59);">&nbsp;|&nbsp;</span></span><span style="font-size:15px;color:rgb(73,59,59);"><strong style="font-size:16px;"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">深度学习</span></strong></span></strong></span><span style="font-size:15px;color:rgb(73,59,59);">&nbsp;|&nbsp;</span><span style="font-size:15px;color:rgb(73,59,59);"><strong style="font-size:16px;"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">神经网络</span></strong></span></strong></span></p>
   <p style="line-height:1.75em;"><span style="font-size:15px;"><strong style="color:rgb(73,59,59);font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);"><strong style="color:rgb(73,59,59);font-size:16px;"><span style="font-size:15px;"><strong style="font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">AI</span></strong></span></strong><span style="color:rgb(73,59,59);">&nbsp;</span></span></strong><span style="color:rgb(73,59,59);">|</span><strong style="color:rgb(73,59,59);font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);"><span style="color:rgb(73,59,59);">&nbsp;</span>1024&nbsp;</span></strong></span><span style="font-size:15px;color:rgb(73,59,59);">|</span><span style="font-size:15px;"><strong style="color:rgb(73,59,59);font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">&nbsp;段子&nbsp;</span></strong></span><span style="font-size:15px;color:rgb(73,59,59);">|</span><span style="font-size:15px;"><strong style="color:rgb(73,59,59);font-size:16px;"><span style="font-size:15px;color:rgb(0,122,170);">&nbsp;区块链</span></strong><span style="color:rgb(73,59,59);">&nbsp;|&nbsp;</span><span style="color:rgb(0,122,170);"><strong>数学</strong></span></span></p>
   <p style="min-height:1em;font-family:'-apple-system-font', BlinkMacSystemFont, Arial, sans-serif;font-size:17px;letter-spacing:.5px;line-height:1.75em;"><br></p>
   <p><span style="color:rgb(0,122,170);font-size:20px;">猜你想看</span></p>
   <p><br></p>
   <ul class="list-paddingleft-2" style="list-style-type:square;">
    <li><p style="text-align:justify;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODE1NDYyMA==&amp;mid=2653391821&amp;idx=1&amp;sn=643e078a8f390b0ff30a51199d1add13&amp;chksm=bd1c33de8a6bbac88e51241cdaebed36dfeab18b948a126e6aabc9cdb839243b23f4d0ee8b35&amp;scene=21#wechat_redirect" rel="nofollow"><span style="color:rgb(0,128,255);line-height:25.6px;font-size:15px;">如果你不想长期996，看看这个</span></a><br></p></li>
    <li><p style="text-align:justify;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODE1NDYyMA==&amp;mid=2653391772&amp;idx=2&amp;sn=eab8ef30788d055c4d38988cb8550001&amp;chksm=bd1c338f8a6bba991e68d8041cc1efc2dc87a4e6f2a65a557bdffca16aeb49c52a26721452fe&amp;scene=21#wechat_redirect" rel="nofollow"><span style="color:rgb(0,128,255);line-height:25.6px;font-size:15px;">数据采集技术揭秘：手把手教你全埋点技术解决方案</span></a><br></p></li>
    <li><p style="text-align:justify;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODE1NDYyMA==&amp;mid=2653391749&amp;idx=2&amp;sn=3c04644a67e0b5c0ad65dc466a753aa0&amp;chksm=bd1c33968a6bba805dcd5f9b02fef286d231f167e7cee06d640afe25dfde888aa6aede27e1b3&amp;scene=21#wechat_redirect" rel="nofollow"><span style="color:rgb(0,128,255);line-height:25.6px;font-size:15px;">那些“反人类”的用户体验，都错在哪了？</span></a><br></p></li>
    <li><p style="text-align:justify;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5ODE1NDYyMA==&amp;mid=2653391699&amp;idx=2&amp;sn=2a257b249e56d9d6cc7ca436f9b92507&amp;chksm=bd1c33408a6bba5619ff2f53f4bb6a80a6ab42974f2b6b9ca1cc9042132c1b4e7f078e9ffdb9&amp;scene=21#wechat_redirect" rel="nofollow"><span style="color:rgb(0,128,255);line-height:25.6px;font-size:15px;">一文看懂数据挖掘：哪一种方法最好？都需要哪些技术？</span></a><br></p></li>
   </ul>
   <p style="text-align:justify;"><br></p>
   <p style="font-size:16px;"><br></p>
   <p style="font-size:16px;font-family:'微软雅黑';line-height:25.6px;min-height:1em;color:rgb(62,62,62);text-align:center;"><span style="font-size:20px;font-style:italic;text-align:justify;color:rgb(0,122,170);">Q:</span><span style="color:rgb(73,59,59);"> 你常用哪些数据库？</span></p>
   <p style="font-size:16px;font-family:'微软雅黑';line-height:25.6px;min-height:1em;color:rgb(62,62,62);text-align:center;"><span style="color:rgb(73,59,59);">欢迎留言并赢取福利</span></p>
   <p style="font-size:16px;font-family:'微软雅黑';line-height:25.6px;min-height:1em;color:rgb(62,62,62);text-align:center;"><span style="color:rgb(136,136,136);font-size:14px;">觉得不错，请把这篇文章分享给你的朋友</span></p>
   <p style="font-size:16px;font-family:'微软雅黑';line-height:25.6px;min-height:1em;color:rgb(62,62,62);text-align:center;"><span style="color:rgb(136,136,136);font-size:14px;">转载 / 投稿请联系：baiyu@hzbook.com</span></p>
   <p style="font-size:16px;font-family:'微软雅黑';line-height:25.6px;min-height:1em;color:rgb(62,62,62);text-align:center;"><span style="color:rgb(136,136,136);font-size:14px;">更多精彩，请在后台点击“历史文章”查看</span></p>
   <p><img style="line-height:25.6px;width:558px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/KfLGF0ibu6cI6yiax4muuJvS6ywtkAXeVBHj0fiaQ9zOzAvFaEdy6LFmm6SCQSRMcvDu0gJCZlbIOC3gnnKXctkicg/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <p style="text-align:justify;"><img class="__bg_gif" style="font-family:'微软雅黑';font-size:16px;color:rgb(62,62,62);vertical-align:middle;width:32px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/sySibtTNlGDUlOv9qqJgwfWxI9IHPymKm4aYFkJ6WOIVUtZ7ft8bDvrQTtodvXf2nkZ7a8SYL4e6oL8bfhzYdJw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-family:'微软雅黑';color:rgb(62,62,62);font-size:12px;">点击<span style="color:rgb(52,83,145);">阅读原文</span>，了解更多</span></p>
  </div> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
