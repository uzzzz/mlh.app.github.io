<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>个性化推荐系统–逻辑回归模型的背景介绍（8-1） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="个性化推荐系统–逻辑回归模型的背景介绍（8-1）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="一、LR（逻辑回归）背景知识介绍 将会介绍什么是点击率预估、什么是分类模型以及LR模型的基本使用流程、LR模型的基本训练流程，从这几个方面介绍LR的背景知识。 1. 点击率预估与分类模型 什么是点击率预估呢？ 相信点击率的概念大家都知道，在系统中 点击率 = 点击的数目 / 总展现的数目，而点击率预估就是针对特定的用户在当前上下文结合用户当前的特征给出的item可能被点击的概率，预估方法可以是一些简单的规则也可以是使用模型，目的就是得到不同的item在此时应该被展现的顺序关系。 点击率预估在推荐、搜索、广告领域都被广泛使用。 那么什么是分类模型呢？ 用一个简单的例子进行讲解：加入去菜市场买牛肉，这个牛肉可以称之为新鲜或者不新鲜，我们之前的判断就是根据这个肉的时间。假如有一个模型可以再牛肉到来的时候就给出标签，是新鲜或者不新鲜，那么这样的一个模型就是一个分类模型，而且是一个二分类，因为这里的label只有新鲜或者不新鲜。 当然，这个分类模型也可以是多分类，如果说这个label有很多个，那么便是多分类。我们这里讲的点击率预估实际也是一个二分类问题，因为，点了样本就是1，没点就是0。就在这两类之间，我们会给出每一个样本预估出它倾向1的概率，基于次概率的大小决定了此item的展现顺序。 2. 什么是LR？ 假设二维空间中有一些数据点，我们想用一条直线来拟合这些数据点经过的路径，这便是回归。但是，LR是一个分类模型，需要在样本进入模型之后给出分类标签。 所以LR对于回归得到的数值会进行一个处理，使之变成0,1这样的标签。这个梳理就是将得到的数值输入到一个函数中，这个函数就是单位阶跃函数，后面会详细讲解这个函数。 这里说的二维空间是只有一个特征的，用在之前讲解的牛肉是不是新鲜这个案例里，这个特征就是时间。那么如果扩展到三维空间中，可以再加入一个特征，比如说这个牛肉的含水量。那么这个时候，可能就不是用一条直线，而是用一个面来拟合整体样本经过的路径。 3. sigmoid函数：单位阶跃函数 这个函数有一个特点，那就是输入为0的时候，值为0.5，但是输入&gt;0 的部分，很快便逼近于1，输入 &lt; 0 的部分，很快便逼近于0，所以称之为阶跃函数。 这样的函数，很少有在中间的部分，所以可以很容易的分辨出是1还是0，正好符合0、1分辨模型的要求。 4. LR模型的工作流程 前面介绍过LR模型的主体流程是：首先对数据进行一个拟合，不管是二维空间里 y = k * x + b 这样的直线，还是三维空间里y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这样的平面，亦或是更高维度我们需要学习更多的参数。像y = k * x + b 中的k、b，像三维空间里我们用平面&nbsp;y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这里面的a1、b2、c这样的参数都是我们需要学习的。学习完这些参数之后，也就得到了模型。得到模型之后，用参数与输入的特征进行相乘，同时将得到的数值放入前面介绍过的单位阶跃函数中得到类别。 下面用具体的例子，详细介绍一下具体的工作流程： 这里是三个训练数据，训练数据的label就是女朋友是不是开心。我们看到这是一个二分类问题，女朋友开心，label就是1；女朋友不开心，那么label就是0。同时这里每一个训练样本都有三个特征，分别是买礼物、说早安、陪吃饭。 样本1 是买了礼物，说了早安，陪了吃饭，那么女朋友是开心的。 样本2 是没有买礼物，没有说早安，陪了吃饭，女朋友是不开心的。 样本3&nbsp;是买了礼物，说了早安，，没有陪吃饭，女朋友是开心的。 这里的目标是通过这三个样本，学习出一个LR的模型，然后能够通过这个模型，帮助我们预测女朋友是否开心。我们需要学习的参数是什么呢？很明显就是 a * x1 + b * x2 + c * x3，这里的a、b、c这三个参数，在得到了这三个参数之后，在接下来的某一天，我们将买没买礼物，说没说早安，有没有陪吃饭带入到这个公式中，也便能够自己知道女朋友是否开心。 以上就是 5. LR模型的整体训练流程 （1）从log中获取训练样本与特征 在工业界中，样本与特征都不会是处理好的，我们需要自己从日志中，根据需要去提取。比如在推荐系统中，我们可能有展示日志，有点击日志，也有入库时就获得的item info信息。首先，我们需要判断，哪些展现，哪些点击是需要的，也就是样本选择。因为，有很多样本含有脏数据，我们需要去除掉。 其次，我们需要判断我们需要的是用户的哪些特征。比如说用户的年龄、性别，或者是item的哪些特征，比如item的种类、item的title、item的时长等等。这就是特征选择。 （2）模型的参数学习 获取了样本与特征之后，需要决定模型学习的学习率，是否正则化，以及选用哪一种正则化的方式，同样还有学习的方法等等参数设定。 得到了模型之后，同样需要进行离线评估。 这里面包含了模型本身的指标，还有模型应用到测试集中的指标，来看一下模型是否可用。如果模型可用，需要将模型实例化。 （3）模型预测 这里的预测包含可能是将已经实例化的模型录入到内存中提供服务，也可能是基于已经实例化好的模型再搭建一个模型的服务。 预测部分需要将待预测的数据集带入到训练格式去抽取特征，抽取完特征的待预测的样本放入到模型中便能得到预测的结果。 6. LR模型的优缺点 优点：易于理解，计算代价小 这个易于理解是指，我们在建模过程中我们把则认为对结果又影响的特征罗列出来就可以，比如说我们认为哪些因素会影响女朋友开心或不开心呢，那就是买没买礼物，说没说早安，有没有陪吃饭...然后学习这些因素的权重就可以。 在推荐系统中，我们预估这个item能不能被user点击。同样也可以选取一些关键的特征，比如说item的历史点击率，item所属的类型，然后用户喜欢看的类型，这个item的长度等等。 由于LR模型是一个浅层模型，而且需要学习的参数的数目与特征的维度是一一对应的，比如说有100维的特征，那么就需要学习100个参数，所以计算代价是比较小的。 缺点：容易欠拟合，需要特征工程 欠拟合是一个专业术语，解释一下： 欠拟合表示模型没有从训练数据中学习到所有的规律。我们以女朋友是否开心为例，比如说陪吃饭，以及买礼物都不能单独的影响女朋友是否开心，也许这里需要一个交叉特征，比如陪吃饭和买礼物放在一起的一个特征。当这两样同时做了，女朋友才会开心，如果没做或者是只做了一样，女朋友都是不会开心的。 那么在这种情况下，我们发现，由于LR不能主动的去想学习这些交叉特征，所以需要我们大量的构造特征。这也就是说，特征工程来补足模型容易欠拟合的缺点。 二、LR算法数学原理解析 将会介绍LR模型的函数表达式、损失函数以及梯度，并且介绍什么是正则化。 三、样本选择与特征构建 将会介绍模型训练中非常重要的一步，那就是样本的选择、特征的选择与处理。" />
<meta property="og:description" content="一、LR（逻辑回归）背景知识介绍 将会介绍什么是点击率预估、什么是分类模型以及LR模型的基本使用流程、LR模型的基本训练流程，从这几个方面介绍LR的背景知识。 1. 点击率预估与分类模型 什么是点击率预估呢？ 相信点击率的概念大家都知道，在系统中 点击率 = 点击的数目 / 总展现的数目，而点击率预估就是针对特定的用户在当前上下文结合用户当前的特征给出的item可能被点击的概率，预估方法可以是一些简单的规则也可以是使用模型，目的就是得到不同的item在此时应该被展现的顺序关系。 点击率预估在推荐、搜索、广告领域都被广泛使用。 那么什么是分类模型呢？ 用一个简单的例子进行讲解：加入去菜市场买牛肉，这个牛肉可以称之为新鲜或者不新鲜，我们之前的判断就是根据这个肉的时间。假如有一个模型可以再牛肉到来的时候就给出标签，是新鲜或者不新鲜，那么这样的一个模型就是一个分类模型，而且是一个二分类，因为这里的label只有新鲜或者不新鲜。 当然，这个分类模型也可以是多分类，如果说这个label有很多个，那么便是多分类。我们这里讲的点击率预估实际也是一个二分类问题，因为，点了样本就是1，没点就是0。就在这两类之间，我们会给出每一个样本预估出它倾向1的概率，基于次概率的大小决定了此item的展现顺序。 2. 什么是LR？ 假设二维空间中有一些数据点，我们想用一条直线来拟合这些数据点经过的路径，这便是回归。但是，LR是一个分类模型，需要在样本进入模型之后给出分类标签。 所以LR对于回归得到的数值会进行一个处理，使之变成0,1这样的标签。这个梳理就是将得到的数值输入到一个函数中，这个函数就是单位阶跃函数，后面会详细讲解这个函数。 这里说的二维空间是只有一个特征的，用在之前讲解的牛肉是不是新鲜这个案例里，这个特征就是时间。那么如果扩展到三维空间中，可以再加入一个特征，比如说这个牛肉的含水量。那么这个时候，可能就不是用一条直线，而是用一个面来拟合整体样本经过的路径。 3. sigmoid函数：单位阶跃函数 这个函数有一个特点，那就是输入为0的时候，值为0.5，但是输入&gt;0 的部分，很快便逼近于1，输入 &lt; 0 的部分，很快便逼近于0，所以称之为阶跃函数。 这样的函数，很少有在中间的部分，所以可以很容易的分辨出是1还是0，正好符合0、1分辨模型的要求。 4. LR模型的工作流程 前面介绍过LR模型的主体流程是：首先对数据进行一个拟合，不管是二维空间里 y = k * x + b 这样的直线，还是三维空间里y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这样的平面，亦或是更高维度我们需要学习更多的参数。像y = k * x + b 中的k、b，像三维空间里我们用平面&nbsp;y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这里面的a1、b2、c这样的参数都是我们需要学习的。学习完这些参数之后，也就得到了模型。得到模型之后，用参数与输入的特征进行相乘，同时将得到的数值放入前面介绍过的单位阶跃函数中得到类别。 下面用具体的例子，详细介绍一下具体的工作流程： 这里是三个训练数据，训练数据的label就是女朋友是不是开心。我们看到这是一个二分类问题，女朋友开心，label就是1；女朋友不开心，那么label就是0。同时这里每一个训练样本都有三个特征，分别是买礼物、说早安、陪吃饭。 样本1 是买了礼物，说了早安，陪了吃饭，那么女朋友是开心的。 样本2 是没有买礼物，没有说早安，陪了吃饭，女朋友是不开心的。 样本3&nbsp;是买了礼物，说了早安，，没有陪吃饭，女朋友是开心的。 这里的目标是通过这三个样本，学习出一个LR的模型，然后能够通过这个模型，帮助我们预测女朋友是否开心。我们需要学习的参数是什么呢？很明显就是 a * x1 + b * x2 + c * x3，这里的a、b、c这三个参数，在得到了这三个参数之后，在接下来的某一天，我们将买没买礼物，说没说早安，有没有陪吃饭带入到这个公式中，也便能够自己知道女朋友是否开心。 以上就是 5. LR模型的整体训练流程 （1）从log中获取训练样本与特征 在工业界中，样本与特征都不会是处理好的，我们需要自己从日志中，根据需要去提取。比如在推荐系统中，我们可能有展示日志，有点击日志，也有入库时就获得的item info信息。首先，我们需要判断，哪些展现，哪些点击是需要的，也就是样本选择。因为，有很多样本含有脏数据，我们需要去除掉。 其次，我们需要判断我们需要的是用户的哪些特征。比如说用户的年龄、性别，或者是item的哪些特征，比如item的种类、item的title、item的时长等等。这就是特征选择。 （2）模型的参数学习 获取了样本与特征之后，需要决定模型学习的学习率，是否正则化，以及选用哪一种正则化的方式，同样还有学习的方法等等参数设定。 得到了模型之后，同样需要进行离线评估。 这里面包含了模型本身的指标，还有模型应用到测试集中的指标，来看一下模型是否可用。如果模型可用，需要将模型实例化。 （3）模型预测 这里的预测包含可能是将已经实例化的模型录入到内存中提供服务，也可能是基于已经实例化好的模型再搭建一个模型的服务。 预测部分需要将待预测的数据集带入到训练格式去抽取特征，抽取完特征的待预测的样本放入到模型中便能得到预测的结果。 6. LR模型的优缺点 优点：易于理解，计算代价小 这个易于理解是指，我们在建模过程中我们把则认为对结果又影响的特征罗列出来就可以，比如说我们认为哪些因素会影响女朋友开心或不开心呢，那就是买没买礼物，说没说早安，有没有陪吃饭...然后学习这些因素的权重就可以。 在推荐系统中，我们预估这个item能不能被user点击。同样也可以选取一些关键的特征，比如说item的历史点击率，item所属的类型，然后用户喜欢看的类型，这个item的长度等等。 由于LR模型是一个浅层模型，而且需要学习的参数的数目与特征的维度是一一对应的，比如说有100维的特征，那么就需要学习100个参数，所以计算代价是比较小的。 缺点：容易欠拟合，需要特征工程 欠拟合是一个专业术语，解释一下： 欠拟合表示模型没有从训练数据中学习到所有的规律。我们以女朋友是否开心为例，比如说陪吃饭，以及买礼物都不能单独的影响女朋友是否开心，也许这里需要一个交叉特征，比如陪吃饭和买礼物放在一起的一个特征。当这两样同时做了，女朋友才会开心，如果没做或者是只做了一样，女朋友都是不会开心的。 那么在这种情况下，我们发现，由于LR不能主动的去想学习这些交叉特征，所以需要我们大量的构造特征。这也就是说，特征工程来补足模型容易欠拟合的缺点。 二、LR算法数学原理解析 将会介绍LR模型的函数表达式、损失函数以及梯度，并且介绍什么是正则化。 三、样本选择与特征构建 将会介绍模型训练中非常重要的一步，那就是样本的选择、特征的选择与处理。" />
<link rel="canonical" href="https://mlh.app/2019/04/08/728654.html" />
<meta property="og:url" content="https://mlh.app/2019/04/08/728654.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-08T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"一、LR（逻辑回归）背景知识介绍 将会介绍什么是点击率预估、什么是分类模型以及LR模型的基本使用流程、LR模型的基本训练流程，从这几个方面介绍LR的背景知识。 1. 点击率预估与分类模型 什么是点击率预估呢？ 相信点击率的概念大家都知道，在系统中 点击率 = 点击的数目 / 总展现的数目，而点击率预估就是针对特定的用户在当前上下文结合用户当前的特征给出的item可能被点击的概率，预估方法可以是一些简单的规则也可以是使用模型，目的就是得到不同的item在此时应该被展现的顺序关系。 点击率预估在推荐、搜索、广告领域都被广泛使用。 那么什么是分类模型呢？ 用一个简单的例子进行讲解：加入去菜市场买牛肉，这个牛肉可以称之为新鲜或者不新鲜，我们之前的判断就是根据这个肉的时间。假如有一个模型可以再牛肉到来的时候就给出标签，是新鲜或者不新鲜，那么这样的一个模型就是一个分类模型，而且是一个二分类，因为这里的label只有新鲜或者不新鲜。 当然，这个分类模型也可以是多分类，如果说这个label有很多个，那么便是多分类。我们这里讲的点击率预估实际也是一个二分类问题，因为，点了样本就是1，没点就是0。就在这两类之间，我们会给出每一个样本预估出它倾向1的概率，基于次概率的大小决定了此item的展现顺序。 2. 什么是LR？ 假设二维空间中有一些数据点，我们想用一条直线来拟合这些数据点经过的路径，这便是回归。但是，LR是一个分类模型，需要在样本进入模型之后给出分类标签。 所以LR对于回归得到的数值会进行一个处理，使之变成0,1这样的标签。这个梳理就是将得到的数值输入到一个函数中，这个函数就是单位阶跃函数，后面会详细讲解这个函数。 这里说的二维空间是只有一个特征的，用在之前讲解的牛肉是不是新鲜这个案例里，这个特征就是时间。那么如果扩展到三维空间中，可以再加入一个特征，比如说这个牛肉的含水量。那么这个时候，可能就不是用一条直线，而是用一个面来拟合整体样本经过的路径。 3. sigmoid函数：单位阶跃函数 这个函数有一个特点，那就是输入为0的时候，值为0.5，但是输入&gt;0 的部分，很快便逼近于1，输入 &lt; 0 的部分，很快便逼近于0，所以称之为阶跃函数。 这样的函数，很少有在中间的部分，所以可以很容易的分辨出是1还是0，正好符合0、1分辨模型的要求。 4. LR模型的工作流程 前面介绍过LR模型的主体流程是：首先对数据进行一个拟合，不管是二维空间里 y = k * x + b 这样的直线，还是三维空间里y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这样的平面，亦或是更高维度我们需要学习更多的参数。像y = k * x + b 中的k、b，像三维空间里我们用平面&nbsp;y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这里面的a1、b2、c这样的参数都是我们需要学习的。学习完这些参数之后，也就得到了模型。得到模型之后，用参数与输入的特征进行相乘，同时将得到的数值放入前面介绍过的单位阶跃函数中得到类别。 下面用具体的例子，详细介绍一下具体的工作流程： 这里是三个训练数据，训练数据的label就是女朋友是不是开心。我们看到这是一个二分类问题，女朋友开心，label就是1；女朋友不开心，那么label就是0。同时这里每一个训练样本都有三个特征，分别是买礼物、说早安、陪吃饭。 样本1 是买了礼物，说了早安，陪了吃饭，那么女朋友是开心的。 样本2 是没有买礼物，没有说早安，陪了吃饭，女朋友是不开心的。 样本3&nbsp;是买了礼物，说了早安，，没有陪吃饭，女朋友是开心的。 这里的目标是通过这三个样本，学习出一个LR的模型，然后能够通过这个模型，帮助我们预测女朋友是否开心。我们需要学习的参数是什么呢？很明显就是 a * x1 + b * x2 + c * x3，这里的a、b、c这三个参数，在得到了这三个参数之后，在接下来的某一天，我们将买没买礼物，说没说早安，有没有陪吃饭带入到这个公式中，也便能够自己知道女朋友是否开心。 以上就是 5. LR模型的整体训练流程 （1）从log中获取训练样本与特征 在工业界中，样本与特征都不会是处理好的，我们需要自己从日志中，根据需要去提取。比如在推荐系统中，我们可能有展示日志，有点击日志，也有入库时就获得的item info信息。首先，我们需要判断，哪些展现，哪些点击是需要的，也就是样本选择。因为，有很多样本含有脏数据，我们需要去除掉。 其次，我们需要判断我们需要的是用户的哪些特征。比如说用户的年龄、性别，或者是item的哪些特征，比如item的种类、item的title、item的时长等等。这就是特征选择。 （2）模型的参数学习 获取了样本与特征之后，需要决定模型学习的学习率，是否正则化，以及选用哪一种正则化的方式，同样还有学习的方法等等参数设定。 得到了模型之后，同样需要进行离线评估。 这里面包含了模型本身的指标，还有模型应用到测试集中的指标，来看一下模型是否可用。如果模型可用，需要将模型实例化。 （3）模型预测 这里的预测包含可能是将已经实例化的模型录入到内存中提供服务，也可能是基于已经实例化好的模型再搭建一个模型的服务。 预测部分需要将待预测的数据集带入到训练格式去抽取特征，抽取完特征的待预测的样本放入到模型中便能得到预测的结果。 6. LR模型的优缺点 优点：易于理解，计算代价小 这个易于理解是指，我们在建模过程中我们把则认为对结果又影响的特征罗列出来就可以，比如说我们认为哪些因素会影响女朋友开心或不开心呢，那就是买没买礼物，说没说早安，有没有陪吃饭...然后学习这些因素的权重就可以。 在推荐系统中，我们预估这个item能不能被user点击。同样也可以选取一些关键的特征，比如说item的历史点击率，item所属的类型，然后用户喜欢看的类型，这个item的长度等等。 由于LR模型是一个浅层模型，而且需要学习的参数的数目与特征的维度是一一对应的，比如说有100维的特征，那么就需要学习100个参数，所以计算代价是比较小的。 缺点：容易欠拟合，需要特征工程 欠拟合是一个专业术语，解释一下： 欠拟合表示模型没有从训练数据中学习到所有的规律。我们以女朋友是否开心为例，比如说陪吃饭，以及买礼物都不能单独的影响女朋友是否开心，也许这里需要一个交叉特征，比如陪吃饭和买礼物放在一起的一个特征。当这两样同时做了，女朋友才会开心，如果没做或者是只做了一样，女朋友都是不会开心的。 那么在这种情况下，我们发现，由于LR不能主动的去想学习这些交叉特征，所以需要我们大量的构造特征。这也就是说，特征工程来补足模型容易欠拟合的缺点。 二、LR算法数学原理解析 将会介绍LR模型的函数表达式、损失函数以及梯度，并且介绍什么是正则化。 三、样本选择与特征构建 将会介绍模型训练中非常重要的一步，那就是样本的选择、特征的选择与处理。","@type":"BlogPosting","url":"https://mlh.app/2019/04/08/728654.html","headline":"个性化推荐系统–逻辑回归模型的背景介绍（8-1）","dateModified":"2019-04-08T00:00:00+08:00","datePublished":"2019-04-08T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/04/08/728654.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>个性化推荐系统--逻辑回归模型的背景介绍（8-1）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <h3>一、LR（逻辑回归）背景知识介绍</h3> 
  <p style="text-indent:50px;">将会介绍什么是点击率预估、什么是分类模型以及LR模型的基本使用流程、LR模型的基本训练流程，从这几个方面介绍LR的背景知识。</p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;"><strong>1. 点击率预估与分类模型</strong></span></p> 
  <p style="text-indent:50px;"><strong>什么是点击率预估呢？</strong></p> 
  <p style="text-indent:50px;">相信点击率的概念大家都知道，在系统中 <span style="color:#f33b45;">点击率 = 点击的数目 / 总展现的数目</span>，而<span style="color:#f33b45;">点击率预估就是针对特定的用户在当前上下文结合用户当前的特征给出的item可能被点击的概率</span>，预估方法可以是一些简单的规则也可以是使用模型，目的就是得到不同的item在此时应该被展现的顺序关系。</p> 
  <p style="text-indent:50px;">点击率预估在推荐、搜索、广告领域都被广泛使用。</p> 
  <p style="text-indent:50px;"><strong>那么什么是分类模型呢？</strong></p> 
  <p style="text-indent:50px;">用一个简单的例子进行讲解：加入去菜市场买牛肉，这个牛肉可以称之为新鲜或者不新鲜，我们之前的判断就是根据这个肉的时间。假如有一个模型可以再牛肉到来的时候就给出标签，是新鲜或者不新鲜，那么这样的一个模型就是一个分类模型，而且是一个二分类，因为这里的label只有新鲜或者不新鲜。</p> 
  <p style="text-indent:50px;">当然，这个分类模型也可以是多分类，如果说这个label有很多个，那么便是多分类。我们这里讲的点击率预估实际也是一个二分类问题，因为，点了样本就是1，没点就是0。就在这两类之间，我们会<span style="color:#f33b45;">给出每一个样本预估出它倾向1的概率</span>，基于次概率的大小决定了此item的展现顺序。</p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;"><strong>2. 什么是LR？</strong></span></p> 
  <p style="text-indent:50px;">假设二维空间中有一些数据点，我们想用一条直线来拟合这些数据点经过的路径，这便是回归。但是，LR是一个分类模型，需要在样本进入模型之后给出分类标签。</p> 
  <p style="text-indent:50px;">所以LR对于回归得到的数值会进行一个处理，使之变成0,1这样的标签。这个梳理就是将得到的数值输入到一个函数中，这个函数就是单位阶跃函数，后面会详细讲解这个函数。</p> 
  <p style="text-indent:50px;">这里说的二维空间是只有一个特征的，用在之前讲解的牛肉是不是新鲜这个案例里，这个特征就是时间。那么如果扩展到三维空间中，可以再加入一个特征，比如说这个牛肉的含水量。那么这个时候，可能就不是用一条直线，而是用一个面来拟合整体样本经过的路径。</p> 
  <p style="text-indent:50px;"><strong><span style="color:#f33b45;">3. sigmoid函数：单位阶跃函数</span></strong></p> 
  <p style="text-indent:50px;">这个函数有一个特点，那就是输入为0的时候，值为0.5，但是输入&gt;0 的部分，很快便逼近于1，输入 &lt; 0 的部分，很快便逼近于0，所以称之为阶跃函数。</p> 
  <p style="text-indent:50px;">这样的函数，很少有在中间的部分，所以可以很容易的分辨出是1还是0，正好符合0、1分辨模型的要求。</p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;"><strong>4. LR模型的工作流程</strong></span></p> 
  <p style="text-indent:50px;">前面介绍过LR模型的<strong>主体流程</strong>是：首先<span style="color:#f33b45;">对数据进行一个拟合</span>，不管是二维空间里 y = k * x + b 这样的直线，还是三维空间里y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这样的平面，亦或是更高维度我们需要学习更多的参数。像y = k * x + b 中的k、b，像三维空间里我们用平面&nbsp;y = a1&nbsp;* x1 + b2 * x2&nbsp;+ c 这里面的a1、b2、c这样的参数都是我们需要学习的。学习完这些参数之后，也就<span style="color:#f33b45;">得到了模型</span>。得到模型之后，用<span style="color:#f33b45;">参数与输入的特征进行相乘</span>，同时将得到的数值放入前面介绍过的<span style="color:#f33b45;">单位阶跃函数中得到类别</span>。</p> 
  <p style="text-indent:50px;">下面用具体的例子，详细介绍一下具体的工作流程：</p> 
  <p style="text-indent:50px;"><img alt="" class="has" height="150" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019040821141395.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTY0MDU4Mw==,size_16,color_FFFFFF,t_70" width="500"></p> 
  <p style="text-indent:50px;">这里是三个训练数据，训练数据的label就是女朋友是不是开心。我们看到这是一个二分类问题，女朋友开心，label就是1；女朋友不开心，那么label就是0。同时这里每一个训练样本都有三个特征，分别是买礼物、说早安、陪吃饭。</p> 
  <p style="text-indent:50px;">样本1 是买了礼物，说了早安，陪了吃饭，那么女朋友是开心的。</p> 
  <p style="text-indent:50px;">样本2 是没有买礼物，没有说早安，陪了吃饭，女朋友是不开心的。</p> 
  <p style="text-indent:50px;">样本3&nbsp;是买了礼物，说了早安，，没有陪吃饭，女朋友是开心的。</p> 
  <p style="text-indent:50px;">这里的目标是通过这三个样本，学习出一个LR的模型，然后能够通过这个模型，帮助我们预测女朋友是否开心。我们需要学习的参数是什么呢？很明显就是 a * x1 + b * x2 + c * x3，这里的a、b、c这三个参数，在得到了这三个参数之后，在接下来的某一天，我们将买没买礼物，说没说早安，有没有陪吃饭带入到这个公式中，也便能够自己知道女朋友是否开心。</p> 
  <p style="text-indent:50px;">以上就是</p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;"><strong>5. LR模型的整体训练流程</strong></span></p> 
  <p style="text-indent:50px;">（1）<strong>从log中获取训练样本与特征</strong></p> 
  <p style="text-indent:50px;">在工业界中，样本与特征都不会是处理好的，我们需要自己从日志中，根据需要去提取。比如在推荐系统中，我们可能有展示日志，有点击日志，也有入库时就获得的item info信息。首先，我们需要判断，哪些展现，哪些点击是需要的，也就是<span style="color:#f33b45;">样本选择</span>。因为，有很多样本含有脏数据，我们需要去除掉。</p> 
  <p style="text-indent:50px;">其次，我们需要判断我们需要的是用户的哪些特征。比如说用户的年龄、性别，或者是item的哪些特征，比如item的种类、item的title、item的时长等等。这就是<span style="color:#f33b45;">特征选择</span>。</p> 
  <p style="text-indent:50px;">（2）<strong>模型的参数学习</strong></p> 
  <p style="text-indent:50px;">获取了样本与特征之后，需要决定模型学习的学习率，是否正则化，以及选用哪一种正则化的方式，同样还有学习的方法等等参数设定。</p> 
  <p style="text-indent:50px;">得到了模型之后，同样需要进行离线评估。</p> 
  <p style="text-indent:50px;">这里面包含了模型本身的指标，还有模型应用到测试集中的指标，来看一下模型是否可用。如果模型可用，需要将模型实例化。</p> 
  <p style="text-indent:50px;">（3）<strong>模型预测</strong></p> 
  <p style="text-indent:50px;">这里的预测包含可能是将已经实例化的模型录入到内存中提供服务，也可能是基于已经实例化好的模型再搭建一个模型的服务。</p> 
  <p style="text-indent:50px;">预测部分需要将待预测的数据集带入到训练格式去抽取特征，抽取完特征的待预测的样本放入到模型中便能得到预测的结果。</p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;"><strong>6. LR模型的优缺点</strong></span></p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;">优点：易于理解，计算代价小</span></p> 
  <p style="text-indent:50px;">这个易于理解是指，我们在建模过程中我们把则认为对结果又影响的特征罗列出来就可以，比如说我们认为哪些因素会影响女朋友开心或不开心呢，那就是买没买礼物，说没说早安，有没有陪吃饭...然后学习这些因素的权重就可以。</p> 
  <p style="text-indent:50px;">在推荐系统中，我们预估这个item能不能被user点击。同样也可以选取一些关键的特征，比如说item的历史点击率，item所属的类型，然后用户喜欢看的类型，这个item的长度等等。</p> 
  <p style="text-indent:50px;">由于LR模型是一个浅层模型，而且需要学习的参数的数目与特征的维度是一一对应的，比如说有100维的特征，那么就需要学习100个参数，所以计算代价是比较小的。</p> 
  <p style="text-indent:50px;"><span style="color:#f33b45;">缺点：容易欠拟合，需要特征工程</span></p> 
  <p style="text-indent:50px;">欠拟合是一个专业术语，解释一下：</p> 
  <p style="text-indent:50px;">欠拟合表示模型没有从训练数据中学习到所有的规律。我们以女朋友是否开心为例，比如说陪吃饭，以及买礼物都不能单独的影响女朋友是否开心，也许这里需要一个交叉特征，比如陪吃饭和买礼物放在一起的一个特征。当这两样同时做了，女朋友才会开心，如果没做或者是只做了一样，女朋友都是不会开心的。</p> 
  <p style="text-indent:50px;">那么在这种情况下，我们发现，由于LR不能主动的去想学习这些交叉特征，所以需要我们大量的构造特征。这也就是说，特征工程来补足模型容易欠拟合的缺点。</p> 
  <h3>二、LR算法数学原理解析</h3> 
  <p style="text-indent:50px;">将会介绍LR模型的函数表达式、损失函数以及梯度，并且介绍什么是正则化。</p> 
  <h3>三、样本选择与特征构建</h3> 
  <p style="text-indent:50px;">将会介绍模型训练中非常重要的一步，那就是样本的选择、特征的选择与处理。</p> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
