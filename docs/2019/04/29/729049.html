<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Observers：让 ZooKeeper更具可伸缩性 时光机 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Observers：让 ZooKeeper更具可伸缩性 时光机" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="戳蓝字“CSDN云计算”关注我们哦！ 时光机：搭载这部时光机，带您回顾《程序员》大量优秀文章，重温经典技术干货，我们发现硬核技术永不过时，对于get要点、solve难题、提高自我，仍有非凡意义。 作者：Henry Robinson,Henry Robinson在纽约大学获得计算机科学学士学位，在剑桥大学获得语言。 译者：王旭 导读 时光机第02期，带您了解 ZooKeeper更具可伸缩性的优势。云计算时代，软件开发人员面临着越来越多分布式协作方面的问题。ZooKeeper是由Apache出品的一个分布式协作服务，新加入的Observer特性，进一步增强了ZooKeeper的可伸缩性。 ZooKeeper 是 由 Apache 出 品的一个分布式协作服务，用于实现锁和并发事务排队等协作原语。ZooKeeper 的一个优势是可伸缩性（Scalability）。五台或七台机器集群可以满足很多大型应用的需求。 最近我们给ZooKeeper增加了一个新的特性，进一步增强了它的可伸缩性—一种称为Observers的服务器。在这篇文章中，我想介绍一下添加这个特性的缘由，并解释这个服务器如何帮助我们的系统更具有可伸缩性。可伸缩性对不同的人意味着不同的事情，而在这里是说，如果我们的工作负载可以通过给系统分配更多的资源来分担，那么这个系统就是可伸缩的。一个不可伸缩的系统是无法通过增加资源来提升性能的，甚至会在工作负载增加时，性能急剧下降。 要了解Observers为何能影响ZooKeeper的可伸缩性，我们需要首先了解一下这个服务是如何工作的。宽泛地说，ZooKeeper 集群上的任何操作不是读操作就是写操作。ZooKeeper 确保了所有读和写操作在所有客户端看来具有完全相同的顺序，这样他们就不用再为操作的顺序而困惑了。 在提供强一致性保障的同时，ZooKeeper同时给出高可用性承诺，这可以被简单地解释为它可以在多台服务器失效的情况下仍然为客户端提供服务。ZooKeeper使用一个传统的手段来达到可用性——通过将数据读写分布到几台机器上来实现。这样一来如果其中一台机器失效了，其他的可以接管它的服务，而这一切对客户而言是不可见的。然而，一致性和可用性这两个属性是很难同时达到的。 目前，ZooKeeper必须确保集群中的每个副本都对读写操作是顺序性的。它通过一个一致性协议来达到这一目标。简单地说，这个协议由一个选定的领导者将新操作告诉其他服务器， 所有节点投票支持的方式反馈给领导节点。一旦领导节点收集到过半数的投票，它就认为投票已经获得了通过，并将进一步消息传送给服务器，以使它们可以继续工作，将操作提交到内存中。 从始至终的数据流如图1所示。客户进程将一个值提交给它连接的服务器，服务器将消息转送给领导节点，并邮领导节点发起这个一致性协议，一旦最初的服务器从领导节点得到结果，它就可以返回给用户了。Observers的需求源于ZooKeeper服务器在上述协议中实际扮演了两个角色。它们从客户端接受连接与操作请求，之后对操作结果进行投票。这两个职能在 ZooKeeper集群扩展的时候彼此制约。如果我们希望增加ZooKeeper集群服务的客户数量（我们经常考虑到有上万个客户端的情况），那么我们必须增加服务器的数量，来支持这么多的客户端。 然而，从一致性协议的描述可以看到，增加服务器的数量增加了对协议的投票部分的压力。领导节点必须等待集群中过半数的服务器响应投票。于是，节点的增加使得部分计算机运行较慢，从而拖慢整个投票过程的可能性也随之提高，投票操作会随之下降。这正是我们在实际操作中看到的问题——随着ZooKeeper集群变大，投票操作的吞吐量会下降。所以，这让我们不得不在增加客户节点数量的期望和保持较好吞吐性能的期望间进行权衡。 为了打破这一耦合关系，我们引入了不参与投票的服务器，称为Observers。Observers可以接受客户端的连接，将写请求转发给领导节点。但是，领导节点不会要求Observers参加投票，所以，Observers不参与投票过程，而是和其他服务节点一起得到投票结果。 这个简单的扩展给ZooKeeper的可伸缩性带来了全新的景像。我们现在可以加入很多Observers节点，而无须担心严重影响写吞吐量。然而，规模伸缩并非无懈可击——协议中的一步（通知阶段）仍然与服务器的数量呈线性关系。 不过这里的串行开销非常低，我们可以认为在通知服务器阶段的开销无法成为主要瓶颈。图2显示了一个简单评测的结果，纵轴表示我能够从一个单一的客户端发出的每秒钟同步写操作的数量（一个调优的ZooKeeper可以得到更好的每秒钟操作数——这里我们更感兴趣的是相对值），横轴是ZooKeeper集群的尺寸。 蓝色部分表示每个服务器都是Voting服务器的情况，而绿色部分则只有三个是Voting服务器，其它都是Observers。测评结果显示我们扩充Observers，写性能几乎可以保持不变，但如果同时扩展Voting节点的数量的话，性能就会明显下降。Observers的有效性显而易见的，它们给集群带来了很多好处。 Observers同样提升读性能的可伸缩性 增加客户端的数量只是Observers的一个重要用例。作为一个优化，ZooKeeper 服务器可以直接读取它们的本地数据存储，而无须经过投票过程，这面临一定的“时光旅行”风险。可能在读到新值之后又读到老值，但这只在服务器故障时才会发生。事实上，在这种情况下客户端可以请求一个“sync”操作来保证下一个值是最新的。 因此，在大量读操作的工作负载下，Observers是个巨大的性能提升。写操作直接进入标准的投票路径，这样，与客户端可扩展性类似，提高投票服务器数量来承担读操作会影响写 性能。Observers允许我们将读性能和写性能分开。这适用于ZooKeeper的很多应用场景，大部分客户端很少写，但经常读。 Observers提供了广域网能力 Observers对于跨广域网连接的客户端来说是很好的候选方案。这有三个原因：首先，为了获得很好的读性能，有必要让客户端离服务器尽量近，这样往返时延不会太高。然而， 将ZooKeeper集群分散到两个集群是非常不可取的设计，因为良好配置的ZooKeeper 应该让投票服务器间用低时延连接互联——否则我们将会遇到上面提到的低反应速度的问题。 其次，Observers可以被部署在需要访问ZooKeeper的任意数据中心中。这样，投票协议不会受到数据中心间链路的高时延的影响，性能得到提升。投票过程中Observers和领导节点间的消息远少于投票服务器和领导节点间的消息。这有助于在远程数据中心高写负载的情况下降低带宽需求。 最后，由于Observers即使失效也不会影响到投票集群，这样如果数据中心间链路发生故障，也不会影响到服务本身的可用性。这种故障的发生概率要远高于一个数据中心机架间的连接的故障概率，所以不依赖于这种链路是个优点。 如何开始使用Observers O b s e r v e r s 还 没 有 成 为 某 个ZooKeeper release 的一部分，所以要使用它，你需要从 Subversion trunk 获取源代码。 下面的内容提取自Observers用户手册，可以在源代码的d o c s /zooKeeperObservers.html 文件中看到。 如何使用Observers 注意，在ZOOKEEPER-578 解决之前，你必须在每个服务器的配置文件中设置electionAlg=0 。否则当你启动服务的时候会抛出一个异常。 原因：Observers并不参与领导节点的选举，它们依赖于投票 Followers 来获知领导的变动。目前，只有基本 选 举 算 法 启 动 一 个 线 程 来 响 应Observers确定当前领导的请求。其他JIRA 上的工作将会让其他所有的领导选举协议都支持这一功能。 设置ZooKeeper使用Observers非常简单，只需要在配置文件中有两处改动。首先是每个 Observer 的配置文件中都要有这么一行： peerType=observer 这行让服务器作为一个 Observer 来工作。之后，在每个服务器配置文件中，你必须在服务器定义行，给每个 Observer加入observer。比如： server.1:localhost:2181:3181:observer 这让每个其他服务器知道 server.1是一个 Observer，就不会期望它进行投票了。这就是要加入一个 Observer 的时候，所有你需要做的配置。现在可以将它作为一个正常的 Follower 来看待了。可以这样试试： bin/zkCli.sh -server localhost:2181 这里 localhost:2181 是 Observer 在每个配置文件中指定的主机名和端口号。你应该看到命令行提示了，这时就可以查询ZooKeeper服务了。 下一步工作 Observers特性还有很多工作要做。短期内，我们将致力于让Observers与ZooKeeper中的所有领导选举算法完全兼容 —— 我们希望这个可以在未来几天内完成。长期看，我们希望能研究一下进行性能优化，比如基于Observers的集群的批量和离线读取，来更好地利用Observers不像一般ZooKeeper服务器一样严格要求时延的好处。 我们希望Observers能进入明年年初的ZooKeeper3.3.0。此外我们会很高兴能听到你的反馈，不管 是 在 邮 件 列 表 里 还 是 直 接 发 送E-mail。ZooKeeper 长期招募贡献 者，我们有足够多的有趣的问题来解决。 福利 扫描添加小编微信，备注“姓名+公司职位”，加入【云计算学习交流群】，和志同道合的朋友们共同打卡学习！ 推荐阅读： VMware竟然出了一款防火墙 OpenStack网络的下一步原来这么走 | 技术头条 你的 AI 老师已上岗 要成为年薪百万的技术大牛必经历这5个阶段, 收好这份超实用的技术进阶指南 | 技术头条 助力 Android 抗衡 iOS，华为发布方舟编译器！ 程序员的黑砖窑，东南亚博彩骗局详解 售价910元！周志华等人英文新书《演化学习》出炉！ 真香，朕在看了！" />
<meta property="og:description" content="戳蓝字“CSDN云计算”关注我们哦！ 时光机：搭载这部时光机，带您回顾《程序员》大量优秀文章，重温经典技术干货，我们发现硬核技术永不过时，对于get要点、solve难题、提高自我，仍有非凡意义。 作者：Henry Robinson,Henry Robinson在纽约大学获得计算机科学学士学位，在剑桥大学获得语言。 译者：王旭 导读 时光机第02期，带您了解 ZooKeeper更具可伸缩性的优势。云计算时代，软件开发人员面临着越来越多分布式协作方面的问题。ZooKeeper是由Apache出品的一个分布式协作服务，新加入的Observer特性，进一步增强了ZooKeeper的可伸缩性。 ZooKeeper 是 由 Apache 出 品的一个分布式协作服务，用于实现锁和并发事务排队等协作原语。ZooKeeper 的一个优势是可伸缩性（Scalability）。五台或七台机器集群可以满足很多大型应用的需求。 最近我们给ZooKeeper增加了一个新的特性，进一步增强了它的可伸缩性—一种称为Observers的服务器。在这篇文章中，我想介绍一下添加这个特性的缘由，并解释这个服务器如何帮助我们的系统更具有可伸缩性。可伸缩性对不同的人意味着不同的事情，而在这里是说，如果我们的工作负载可以通过给系统分配更多的资源来分担，那么这个系统就是可伸缩的。一个不可伸缩的系统是无法通过增加资源来提升性能的，甚至会在工作负载增加时，性能急剧下降。 要了解Observers为何能影响ZooKeeper的可伸缩性，我们需要首先了解一下这个服务是如何工作的。宽泛地说，ZooKeeper 集群上的任何操作不是读操作就是写操作。ZooKeeper 确保了所有读和写操作在所有客户端看来具有完全相同的顺序，这样他们就不用再为操作的顺序而困惑了。 在提供强一致性保障的同时，ZooKeeper同时给出高可用性承诺，这可以被简单地解释为它可以在多台服务器失效的情况下仍然为客户端提供服务。ZooKeeper使用一个传统的手段来达到可用性——通过将数据读写分布到几台机器上来实现。这样一来如果其中一台机器失效了，其他的可以接管它的服务，而这一切对客户而言是不可见的。然而，一致性和可用性这两个属性是很难同时达到的。 目前，ZooKeeper必须确保集群中的每个副本都对读写操作是顺序性的。它通过一个一致性协议来达到这一目标。简单地说，这个协议由一个选定的领导者将新操作告诉其他服务器， 所有节点投票支持的方式反馈给领导节点。一旦领导节点收集到过半数的投票，它就认为投票已经获得了通过，并将进一步消息传送给服务器，以使它们可以继续工作，将操作提交到内存中。 从始至终的数据流如图1所示。客户进程将一个值提交给它连接的服务器，服务器将消息转送给领导节点，并邮领导节点发起这个一致性协议，一旦最初的服务器从领导节点得到结果，它就可以返回给用户了。Observers的需求源于ZooKeeper服务器在上述协议中实际扮演了两个角色。它们从客户端接受连接与操作请求，之后对操作结果进行投票。这两个职能在 ZooKeeper集群扩展的时候彼此制约。如果我们希望增加ZooKeeper集群服务的客户数量（我们经常考虑到有上万个客户端的情况），那么我们必须增加服务器的数量，来支持这么多的客户端。 然而，从一致性协议的描述可以看到，增加服务器的数量增加了对协议的投票部分的压力。领导节点必须等待集群中过半数的服务器响应投票。于是，节点的增加使得部分计算机运行较慢，从而拖慢整个投票过程的可能性也随之提高，投票操作会随之下降。这正是我们在实际操作中看到的问题——随着ZooKeeper集群变大，投票操作的吞吐量会下降。所以，这让我们不得不在增加客户节点数量的期望和保持较好吞吐性能的期望间进行权衡。 为了打破这一耦合关系，我们引入了不参与投票的服务器，称为Observers。Observers可以接受客户端的连接，将写请求转发给领导节点。但是，领导节点不会要求Observers参加投票，所以，Observers不参与投票过程，而是和其他服务节点一起得到投票结果。 这个简单的扩展给ZooKeeper的可伸缩性带来了全新的景像。我们现在可以加入很多Observers节点，而无须担心严重影响写吞吐量。然而，规模伸缩并非无懈可击——协议中的一步（通知阶段）仍然与服务器的数量呈线性关系。 不过这里的串行开销非常低，我们可以认为在通知服务器阶段的开销无法成为主要瓶颈。图2显示了一个简单评测的结果，纵轴表示我能够从一个单一的客户端发出的每秒钟同步写操作的数量（一个调优的ZooKeeper可以得到更好的每秒钟操作数——这里我们更感兴趣的是相对值），横轴是ZooKeeper集群的尺寸。 蓝色部分表示每个服务器都是Voting服务器的情况，而绿色部分则只有三个是Voting服务器，其它都是Observers。测评结果显示我们扩充Observers，写性能几乎可以保持不变，但如果同时扩展Voting节点的数量的话，性能就会明显下降。Observers的有效性显而易见的，它们给集群带来了很多好处。 Observers同样提升读性能的可伸缩性 增加客户端的数量只是Observers的一个重要用例。作为一个优化，ZooKeeper 服务器可以直接读取它们的本地数据存储，而无须经过投票过程，这面临一定的“时光旅行”风险。可能在读到新值之后又读到老值，但这只在服务器故障时才会发生。事实上，在这种情况下客户端可以请求一个“sync”操作来保证下一个值是最新的。 因此，在大量读操作的工作负载下，Observers是个巨大的性能提升。写操作直接进入标准的投票路径，这样，与客户端可扩展性类似，提高投票服务器数量来承担读操作会影响写 性能。Observers允许我们将读性能和写性能分开。这适用于ZooKeeper的很多应用场景，大部分客户端很少写，但经常读。 Observers提供了广域网能力 Observers对于跨广域网连接的客户端来说是很好的候选方案。这有三个原因：首先，为了获得很好的读性能，有必要让客户端离服务器尽量近，这样往返时延不会太高。然而， 将ZooKeeper集群分散到两个集群是非常不可取的设计，因为良好配置的ZooKeeper 应该让投票服务器间用低时延连接互联——否则我们将会遇到上面提到的低反应速度的问题。 其次，Observers可以被部署在需要访问ZooKeeper的任意数据中心中。这样，投票协议不会受到数据中心间链路的高时延的影响，性能得到提升。投票过程中Observers和领导节点间的消息远少于投票服务器和领导节点间的消息。这有助于在远程数据中心高写负载的情况下降低带宽需求。 最后，由于Observers即使失效也不会影响到投票集群，这样如果数据中心间链路发生故障，也不会影响到服务本身的可用性。这种故障的发生概率要远高于一个数据中心机架间的连接的故障概率，所以不依赖于这种链路是个优点。 如何开始使用Observers O b s e r v e r s 还 没 有 成 为 某 个ZooKeeper release 的一部分，所以要使用它，你需要从 Subversion trunk 获取源代码。 下面的内容提取自Observers用户手册，可以在源代码的d o c s /zooKeeperObservers.html 文件中看到。 如何使用Observers 注意，在ZOOKEEPER-578 解决之前，你必须在每个服务器的配置文件中设置electionAlg=0 。否则当你启动服务的时候会抛出一个异常。 原因：Observers并不参与领导节点的选举，它们依赖于投票 Followers 来获知领导的变动。目前，只有基本 选 举 算 法 启 动 一 个 线 程 来 响 应Observers确定当前领导的请求。其他JIRA 上的工作将会让其他所有的领导选举协议都支持这一功能。 设置ZooKeeper使用Observers非常简单，只需要在配置文件中有两处改动。首先是每个 Observer 的配置文件中都要有这么一行： peerType=observer 这行让服务器作为一个 Observer 来工作。之后，在每个服务器配置文件中，你必须在服务器定义行，给每个 Observer加入observer。比如： server.1:localhost:2181:3181:observer 这让每个其他服务器知道 server.1是一个 Observer，就不会期望它进行投票了。这就是要加入一个 Observer 的时候，所有你需要做的配置。现在可以将它作为一个正常的 Follower 来看待了。可以这样试试： bin/zkCli.sh -server localhost:2181 这里 localhost:2181 是 Observer 在每个配置文件中指定的主机名和端口号。你应该看到命令行提示了，这时就可以查询ZooKeeper服务了。 下一步工作 Observers特性还有很多工作要做。短期内，我们将致力于让Observers与ZooKeeper中的所有领导选举算法完全兼容 —— 我们希望这个可以在未来几天内完成。长期看，我们希望能研究一下进行性能优化，比如基于Observers的集群的批量和离线读取，来更好地利用Observers不像一般ZooKeeper服务器一样严格要求时延的好处。 我们希望Observers能进入明年年初的ZooKeeper3.3.0。此外我们会很高兴能听到你的反馈，不管 是 在 邮 件 列 表 里 还 是 直 接 发 送E-mail。ZooKeeper 长期招募贡献 者，我们有足够多的有趣的问题来解决。 福利 扫描添加小编微信，备注“姓名+公司职位”，加入【云计算学习交流群】，和志同道合的朋友们共同打卡学习！ 推荐阅读： VMware竟然出了一款防火墙 OpenStack网络的下一步原来这么走 | 技术头条 你的 AI 老师已上岗 要成为年薪百万的技术大牛必经历这5个阶段, 收好这份超实用的技术进阶指南 | 技术头条 助力 Android 抗衡 iOS，华为发布方舟编译器！ 程序员的黑砖窑，东南亚博彩骗局详解 售价910元！周志华等人英文新书《演化学习》出炉！ 真香，朕在看了！" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-29T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"戳蓝字“CSDN云计算”关注我们哦！ 时光机：搭载这部时光机，带您回顾《程序员》大量优秀文章，重温经典技术干货，我们发现硬核技术永不过时，对于get要点、solve难题、提高自我，仍有非凡意义。 作者：Henry Robinson,Henry Robinson在纽约大学获得计算机科学学士学位，在剑桥大学获得语言。 译者：王旭 导读 时光机第02期，带您了解 ZooKeeper更具可伸缩性的优势。云计算时代，软件开发人员面临着越来越多分布式协作方面的问题。ZooKeeper是由Apache出品的一个分布式协作服务，新加入的Observer特性，进一步增强了ZooKeeper的可伸缩性。 ZooKeeper 是 由 Apache 出 品的一个分布式协作服务，用于实现锁和并发事务排队等协作原语。ZooKeeper 的一个优势是可伸缩性（Scalability）。五台或七台机器集群可以满足很多大型应用的需求。 最近我们给ZooKeeper增加了一个新的特性，进一步增强了它的可伸缩性—一种称为Observers的服务器。在这篇文章中，我想介绍一下添加这个特性的缘由，并解释这个服务器如何帮助我们的系统更具有可伸缩性。可伸缩性对不同的人意味着不同的事情，而在这里是说，如果我们的工作负载可以通过给系统分配更多的资源来分担，那么这个系统就是可伸缩的。一个不可伸缩的系统是无法通过增加资源来提升性能的，甚至会在工作负载增加时，性能急剧下降。 要了解Observers为何能影响ZooKeeper的可伸缩性，我们需要首先了解一下这个服务是如何工作的。宽泛地说，ZooKeeper 集群上的任何操作不是读操作就是写操作。ZooKeeper 确保了所有读和写操作在所有客户端看来具有完全相同的顺序，这样他们就不用再为操作的顺序而困惑了。 在提供强一致性保障的同时，ZooKeeper同时给出高可用性承诺，这可以被简单地解释为它可以在多台服务器失效的情况下仍然为客户端提供服务。ZooKeeper使用一个传统的手段来达到可用性——通过将数据读写分布到几台机器上来实现。这样一来如果其中一台机器失效了，其他的可以接管它的服务，而这一切对客户而言是不可见的。然而，一致性和可用性这两个属性是很难同时达到的。 目前，ZooKeeper必须确保集群中的每个副本都对读写操作是顺序性的。它通过一个一致性协议来达到这一目标。简单地说，这个协议由一个选定的领导者将新操作告诉其他服务器， 所有节点投票支持的方式反馈给领导节点。一旦领导节点收集到过半数的投票，它就认为投票已经获得了通过，并将进一步消息传送给服务器，以使它们可以继续工作，将操作提交到内存中。 从始至终的数据流如图1所示。客户进程将一个值提交给它连接的服务器，服务器将消息转送给领导节点，并邮领导节点发起这个一致性协议，一旦最初的服务器从领导节点得到结果，它就可以返回给用户了。Observers的需求源于ZooKeeper服务器在上述协议中实际扮演了两个角色。它们从客户端接受连接与操作请求，之后对操作结果进行投票。这两个职能在 ZooKeeper集群扩展的时候彼此制约。如果我们希望增加ZooKeeper集群服务的客户数量（我们经常考虑到有上万个客户端的情况），那么我们必须增加服务器的数量，来支持这么多的客户端。 然而，从一致性协议的描述可以看到，增加服务器的数量增加了对协议的投票部分的压力。领导节点必须等待集群中过半数的服务器响应投票。于是，节点的增加使得部分计算机运行较慢，从而拖慢整个投票过程的可能性也随之提高，投票操作会随之下降。这正是我们在实际操作中看到的问题——随着ZooKeeper集群变大，投票操作的吞吐量会下降。所以，这让我们不得不在增加客户节点数量的期望和保持较好吞吐性能的期望间进行权衡。 为了打破这一耦合关系，我们引入了不参与投票的服务器，称为Observers。Observers可以接受客户端的连接，将写请求转发给领导节点。但是，领导节点不会要求Observers参加投票，所以，Observers不参与投票过程，而是和其他服务节点一起得到投票结果。 这个简单的扩展给ZooKeeper的可伸缩性带来了全新的景像。我们现在可以加入很多Observers节点，而无须担心严重影响写吞吐量。然而，规模伸缩并非无懈可击——协议中的一步（通知阶段）仍然与服务器的数量呈线性关系。 不过这里的串行开销非常低，我们可以认为在通知服务器阶段的开销无法成为主要瓶颈。图2显示了一个简单评测的结果，纵轴表示我能够从一个单一的客户端发出的每秒钟同步写操作的数量（一个调优的ZooKeeper可以得到更好的每秒钟操作数——这里我们更感兴趣的是相对值），横轴是ZooKeeper集群的尺寸。 蓝色部分表示每个服务器都是Voting服务器的情况，而绿色部分则只有三个是Voting服务器，其它都是Observers。测评结果显示我们扩充Observers，写性能几乎可以保持不变，但如果同时扩展Voting节点的数量的话，性能就会明显下降。Observers的有效性显而易见的，它们给集群带来了很多好处。 Observers同样提升读性能的可伸缩性 增加客户端的数量只是Observers的一个重要用例。作为一个优化，ZooKeeper 服务器可以直接读取它们的本地数据存储，而无须经过投票过程，这面临一定的“时光旅行”风险。可能在读到新值之后又读到老值，但这只在服务器故障时才会发生。事实上，在这种情况下客户端可以请求一个“sync”操作来保证下一个值是最新的。 因此，在大量读操作的工作负载下，Observers是个巨大的性能提升。写操作直接进入标准的投票路径，这样，与客户端可扩展性类似，提高投票服务器数量来承担读操作会影响写 性能。Observers允许我们将读性能和写性能分开。这适用于ZooKeeper的很多应用场景，大部分客户端很少写，但经常读。 Observers提供了广域网能力 Observers对于跨广域网连接的客户端来说是很好的候选方案。这有三个原因：首先，为了获得很好的读性能，有必要让客户端离服务器尽量近，这样往返时延不会太高。然而， 将ZooKeeper集群分散到两个集群是非常不可取的设计，因为良好配置的ZooKeeper 应该让投票服务器间用低时延连接互联——否则我们将会遇到上面提到的低反应速度的问题。 其次，Observers可以被部署在需要访问ZooKeeper的任意数据中心中。这样，投票协议不会受到数据中心间链路的高时延的影响，性能得到提升。投票过程中Observers和领导节点间的消息远少于投票服务器和领导节点间的消息。这有助于在远程数据中心高写负载的情况下降低带宽需求。 最后，由于Observers即使失效也不会影响到投票集群，这样如果数据中心间链路发生故障，也不会影响到服务本身的可用性。这种故障的发生概率要远高于一个数据中心机架间的连接的故障概率，所以不依赖于这种链路是个优点。 如何开始使用Observers O b s e r v e r s 还 没 有 成 为 某 个ZooKeeper release 的一部分，所以要使用它，你需要从 Subversion trunk 获取源代码。 下面的内容提取自Observers用户手册，可以在源代码的d o c s /zooKeeperObservers.html 文件中看到。 如何使用Observers 注意，在ZOOKEEPER-578 解决之前，你必须在每个服务器的配置文件中设置electionAlg=0 。否则当你启动服务的时候会抛出一个异常。 原因：Observers并不参与领导节点的选举，它们依赖于投票 Followers 来获知领导的变动。目前，只有基本 选 举 算 法 启 动 一 个 线 程 来 响 应Observers确定当前领导的请求。其他JIRA 上的工作将会让其他所有的领导选举协议都支持这一功能。 设置ZooKeeper使用Observers非常简单，只需要在配置文件中有两处改动。首先是每个 Observer 的配置文件中都要有这么一行： peerType=observer 这行让服务器作为一个 Observer 来工作。之后，在每个服务器配置文件中，你必须在服务器定义行，给每个 Observer加入observer。比如： server.1:localhost:2181:3181:observer 这让每个其他服务器知道 server.1是一个 Observer，就不会期望它进行投票了。这就是要加入一个 Observer 的时候，所有你需要做的配置。现在可以将它作为一个正常的 Follower 来看待了。可以这样试试： bin/zkCli.sh -server localhost:2181 这里 localhost:2181 是 Observer 在每个配置文件中指定的主机名和端口号。你应该看到命令行提示了，这时就可以查询ZooKeeper服务了。 下一步工作 Observers特性还有很多工作要做。短期内，我们将致力于让Observers与ZooKeeper中的所有领导选举算法完全兼容 —— 我们希望这个可以在未来几天内完成。长期看，我们希望能研究一下进行性能优化，比如基于Observers的集群的批量和离线读取，来更好地利用Observers不像一般ZooKeeper服务器一样严格要求时延的好处。 我们希望Observers能进入明年年初的ZooKeeper3.3.0。此外我们会很高兴能听到你的反馈，不管 是 在 邮 件 列 表 里 还 是 直 接 发 送E-mail。ZooKeeper 长期招募贡献 者，我们有足够多的有趣的问题来解决。 福利 扫描添加小编微信，备注“姓名+公司职位”，加入【云计算学习交流群】，和志同道合的朋友们共同打卡学习！ 推荐阅读： VMware竟然出了一款防火墙 OpenStack网络的下一步原来这么走 | 技术头条 你的 AI 老师已上岗 要成为年薪百万的技术大牛必经历这5个阶段, 收好这份超实用的技术进阶指南 | 技术头条 助力 Android 抗衡 iOS，华为发布方舟编译器！ 程序员的黑砖窑，东南亚博彩骗局详解 售价910元！周志华等人英文新书《演化学习》出炉！ 真香，朕在看了！","@type":"BlogPosting","url":"/2019/04/29/729049.html","headline":"Observers：让 ZooKeeper更具可伸缩性 时光机","dateModified":"2019-04-29T00:00:00+08:00","datePublished":"2019-04-29T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/04/29/729049.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>Observers：让 ZooKeeper更具可伸缩性 | 时光机</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <h2 style="white-space: normal;max-width: 100%;letter-spacing: 0.544px;widows: 1;text-align: right;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;" data-mpa-powered-by="yiban.io"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(171, 25, 66);"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;letter-spacing: 0.544px;color: rgb(121, 121, 121);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">戳蓝字“</span></strong></span><span style="max-width: 100%;color: rgb(0, 128, 255);"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;letter-spacing: 0.544px;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">CSDN云计算</span></strong></span><span style="max-width: 100%;color: rgb(171, 25, 66);"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="max-width: 100%;letter-spacing: 0.544px;color: rgb(121, 121, 121);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">”关注我们哦！</span></strong></span></span><br></h2> 
<p style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages" data-copyright="0" data-ratio="0.68359375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28Sic0715bLOrcIyic4iarQX3UpMNyx29u4OIzM1K6PS4QKtO9vv4BZw9C6NFG2AmdAiaGicAoPJEIO7tag/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" style="" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28Sic0715bLOrcIyic4iarQX3UpMNyx29u4OIzM1K6PS4QKtO9vv4BZw9C6NFG2AmdAiaGicAoPJEIO7tag/640?wx_fmt=jpeg"></p> 
<section powered-by="xiumi.us" style="white-space: normal;box-sizing: border-box;line-height: 30px;widows: 1;background-color: rgb(255, 255, 255);max-width: 100%;letter-spacing: 0.54px;font-size: 15px;word-wrap: break-word !important;"> 
 <section style="box-sizing: border-box;max-width: 100%;word-wrap: break-word !important;"> 
  <section> 
   <section powered-by="xiumi.us" style="box-sizing: border-box;line-height: 30px;max-width: 100%;letter-spacing: 0.54px;word-wrap: break-word !important;"> 
    <section style="box-sizing: border-box;max-width: 100%;word-wrap: break-word !important;"> 
     <section> 
      <section powered-by="xiumi.us" style="box-sizing: border-box;line-height: 30px;max-width: 100%;letter-spacing: 0.54px;word-wrap: break-word !important;"> 
       <section style="box-sizing: border-box;max-width: 100%;word-wrap: break-word !important;"> 
        <section> 
         <blockquote style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
          <p style="margin-right: 8px;margin-bottom: 15px;margin-left: 8px;line-height: 1.75em;min-height: 1em;max-width: 100%;letter-spacing: 1px;box-sizing: border-box !important;word-wrap: break-word !important;"><strong><span style="letter-spacing: 0.54px;color: rgb(0, 82, 255);">时光机：搭载这部时光机，带您回顾《程序员》大量优秀文章，重温经典技术干货，我们发现硬核技术永不过时，对于get要点、solve难题、提高自我，仍有非凡意义。</span></strong></p> 
         </blockquote> 
        </section> 
       </section> 
      </section> 
     </section> 
    </section> 
   </section> 
  </section> 
 </section> 
 <br> 
</section> 
<p style="max-width: 100%;min-height: 1em;letter-spacing: 0.544px;line-height: 27.2px;white-space: normal;widows: 1;background-color: rgb(255, 255, 255);margin-left: 8px;margin-right: 8px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="font-size: 14px;color: rgb(136, 136, 136);">作者：Henry Robinson,Henry Robinson在纽约大学获得计算机科学学士学位，在剑桥大学获得语言。</span><strong><span style="color: rgb(35, 31, 32);font-size: 13px;font-family: 宋体;"></span></strong></p> 
<p style="max-width: 100%;min-height: 1em;letter-spacing: 0.544px;line-height: 27.2px;white-space: normal;widows: 1;background-color: rgb(255, 255, 255);margin-left: 8px;margin-right: 8px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="font-size: 14px;color: rgb(136, 136, 136);">译者：王旭</span><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 14px;"></span></p> 
<p style="max-width: 100%;min-height: 1em;letter-spacing: 0.544px;line-height: 27.2px;white-space: normal;widows: 1;background-color: rgb(255, 255, 255);margin-left: 8px;margin-right: 8px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p> 
<section powered-by="xiumi.us" style="white-space: normal;max-width: 100%;box-sizing: border-box;color: rgb(63, 63, 63);font-size: 15px;letter-spacing: 0.544px;line-height: 30px;widows: 1;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"> 
 <section style="padding: 0.1em 0.3em;max-width: 100%;box-sizing: border-box;display: inline-block;border-width: 2px;border-style: solid;border-color: rgba(255, 255, 255, 0);color: rgb(255, 255, 255);font-size: 14px;line-height: 1.8;background-color: rgb(83, 122, 195);word-wrap: break-word !important;"> 
  <p style="max-width: 100%;box-sizing: border-box;min-height: 1em;word-wrap: break-word !important;">导读</p> 
 </section> 
</section> 
<section powered-by="xiumi.us" style="white-space: normal;max-width: 100%;box-sizing: border-box;color: rgb(63, 63, 63);font-size: 15px;letter-spacing: 0.544px;line-height: 30px;widows: 1;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"> 
 <section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"> 
  <section style="max-width: 100%;box-sizing: border-box;color: rgb(62, 62, 62);line-height: 1.8;word-wrap: break-word !important;"> 
   <p style="max-width: 100%;box-sizing: border-box;min-height: 1em;text-align: justify;margin-left: 8px;margin-right: 8px;word-wrap: break-word !important;"><span style="max-width: 100%;color: rgb(136, 136, 136);font-family: 微软雅黑;font-size: 14px;box-sizing: border-box !important;word-wrap: break-word !important;">时光机第02期，带您了解 ZooKeeper更具可伸缩性的优势。云计算时代，软件开发人员面临着越来越多分布式协作方面的问题。ZooKeeper是由Apache出品的一个分布式协作服务，新加入的Observer特性，进一步增强了ZooKeeper的可伸缩性。</span><span style="max-width: 100%;color: rgb(136, 136, 136);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="white-space: normal;"><span style="font-family: 微软雅黑;font-size: 14px;"></span></strong></span></p> 
  </section> 
 </section> 
</section> 
<section powered-by="xiumi.us" style="white-space: normal;max-width: 100%;box-sizing: border-box;color: rgb(63, 63, 63);font-size: 15px;letter-spacing: 0.544px;line-height: 30px;widows: 1;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"> 
 <section style="margin-top: 8px;margin-bottom: 10px;max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"> 
  <section style="max-width: 100%;box-sizing: border-box;height: 1px;background-color: rgb(105, 143, 187);word-wrap: break-word !important;"></section> 
 </section> 
</section> 
<p style="max-width: 100%;min-height: 1em;letter-spacing: 0.544px;line-height: 27.2px;white-space: normal;widows: 1;background-color: rgb(255, 255, 255);text-align: justify;margin-left: 8px;margin-right: 8px;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">ZooKeeper 是 由 Apache 出 品的一个分布式协作服务，用于实现锁和并发事务排队等</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">协作原语。</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">ZooKeeper 的一个优势是可伸缩性（Scalability）。</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">五台或七台机器集群可以满足很多大型应用的需求。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">最近我们给ZooKeeper增加了一个新的特性，进一步增强了它的可伸缩性—一种称为Observers的服务器。在这篇文章中，我想介绍一下添加这个特性的缘由，并解释这个服务器如何帮助我们的系统更具有可伸缩性。可伸缩性对不同的人意味着不同的事情，而在这里是说，如果我们的工作负载可以通过给系统分配更多的资源来分担，那么这个系统就是可伸缩的。一个不可伸缩的系统是无法通过增加资源来提升性能的，甚至会在工作负载增加时，性能急剧下降。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">要了解Observers为何能影响ZooKeeper的可伸缩性，我们需要首先了解一下这个服务是如何工作的。宽泛地说，ZooKeeper 集群上的任何操作不是读操作就是写操作。ZooKeeper 确保了所有读和写操作在所有客户端看来具有完全相同的顺序，这样他们就不用再为操作的顺序而困惑了。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">在提供强一致性保障的同时，ZooKeeper同时给出高可用性承诺，这可以被简单地解释为它可以在多台服务器失效的情况下仍然为客户端提供服务。ZooKeeper使用一个传统的手段来达到可用性——通过将数据读写分布到几台机器上来实现。这样一来如果其中一台机器失效了，其他的可以接管它的服务，而这一切对</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">客户而言是不可见的。然而，一致性和可用性这两个属性是很难同时达到的。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">目前，ZooKeeper必须确保集群中的每个副本都对读写操作是顺序性的。它通过一个一致性协议来达到这一目标。简单地说，这个协议由一个选定的领导者将新操作告诉其他服务器， 所有节点投票支持的方式反馈给领导节点。一旦领导节点收集到过半数的投票，它就认为投票已经获得了通过，并将进一步消息传送给服务器，以使它们可以继续工作，将操作提交到内存中。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><img class="rich_pages" data-copyright="0" data-ratio="1.3515625" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28Rgsx8NgO9y2ib4ib65411IbHNhVyxqDLJPziaPMt6KicQwy6gmyVD2cL3LdBt0hq3QLz8o2DaKCqqoRQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" style="" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28Rgsx8NgO9y2ib4ib65411IbHNhVyxqDLJPziaPMt6KicQwy6gmyVD2cL3LdBt0hq3QLz8o2DaKCqqoRQ/640?wx_fmt=jpeg"></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"></span><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-size: 10.5pt;font-family: 微软雅黑;"></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">从始至终的数据流如图</span>1所示。客户进程将一个值提交给它连接的服务器，服务器将消息转</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">送给领导节点，并邮领导节点发起这个一致性协议，一旦最初的服务器从领导节点得到结果，它就可以返回给用户了。</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">Observers的需求源于ZooKeeper服务器在上述协议中实际扮演了两个角色。</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">它们从客户端接受连接与操作请求，之后对操作结果进行投票。</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">这两个职能在 ZooKeeper集群扩展的时候彼此制约。</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">如果我们希望增加ZooKeeper集群服务的客户数量（我们经常考虑到有上万个客户端的情况），那么我们必须增加服务器的数量，来支持这么多的客户端。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">然而，从一致性协议的描述可以看到，增加服务器的数量增加了对协议的投票部分的压力。领导节点必须等待集群中过半数的服务器响应投票。于是，节点的增加使得部分计算机运</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">行较慢，从而拖慢整个投票过程的可能性也随之提高，投票操作会随之下降。这正是我们在实际操作中看到的问题——随着ZooKeeper集群变大，投票操作的吞吐量会下降。所以，这让我们不得不在增加客户节点数量的期望和保持较好吞吐性能的期望间进行权衡。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"></span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">为了打破这一耦合关系，我们引入了不参与投票的服务器，称为Observers。Observers可以接受客户端的连接，将写请求转发给领导节点。但是，领导节点不会要求Observers参加投票，所以，Observers不参与投票过程，而是和其他服务节点一起得到投票结果。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">这个简单的扩展给</span>ZooKeeper的可伸缩性带来了全新的景像。我们现在可以加入很多Observers节点，而无须担心严重影响写吞吐量。然而，规模伸缩并非无懈可击——协议中的一步（通知阶段）仍然与服务器的数量呈线性关系。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><img class="rich_pages" data-copyright="0" data-ratio="0.67265625" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28Rgsx8NgO9y2ib4ib65411IbHBv7MTxFrO0HlzwKmYDrlAAZwTOeX3PuqgqGBLRjfsmrckficFLjZJCw/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" style="" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28Rgsx8NgO9y2ib4ib65411IbHBv7MTxFrO0HlzwKmYDrlAAZwTOeX3PuqgqGBLRjfsmrckficFLjZJCw/640?wx_fmt=jpeg"></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">不过这里的串行开销非常低，我们可以认为在通知服务器阶段的开销无法成为主要瓶颈。图2显示了一个简单评测的结果，纵轴表示我能够从一个单一的客户端发出的每秒钟同步写操作的数量（一个调优的ZooKeeper可以得到更好的每秒钟操作数——这里我们更感兴趣的是相对值），横轴是ZooKeeper集</span><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">群的尺寸。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">蓝色部分表示每个服务器都是Voting服务器的情况，而绿色部分则只有三个是Voting服务器，其它都是Observers。测评结果显示我们扩充Observers，写性能几乎可以保持不变，但如果同时扩展Voting节点的数量的话，性能就会明显下降。Observers的有效性显而易见的，它们给集群带来了很多好处。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><strong><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 14pt;">Observers同样提升读性能的可伸缩性</span></strong></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 14pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">增加客户端的数量只是</span>Observers的一个重要用例。作为一个优化，ZooKeeper 服务器可以直接读取它们的本地数据存储，而无须经过投票过程，这面临一定的“时光旅行”风险。可能在读到新值之后又读到老值，但这只在服务器故障时才会发生。事实上，在这种情况下客户端可以请求一个“sync”操作来保证下一个值是最新的。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">因此，在大量读操作的工作负载下，</span>Observers是个巨大的性能提升。写操作直接进入标准的投票路径，这样，与客户端可扩展性类似，提高投票服务器数量来承担读操作会影响写</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">性能。</span>Observers允许我们将读性能和写性能分开。这适用于ZooKeeper的很多应用场景，大部分客户端很少写，但经常读。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><strong><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 14pt;">Observers提供了广域网能力</span></strong></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 14pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">Observers对于跨广域网连接的客户端来说是很好的候选方案。这有三个原因：首先，为了获得很好的读性能，有必要让客户端离服务器尽量近，这样往返时延不会太高。然而，</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">将</span>ZooKeeper集群分散到两个集群是非常不可取的设计，因为良好配置的ZooKeeper 应该让投票服务器间用低时延连接互联——否则我们将会遇到上面提到的低反应速度的问题。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">其次，</span>Observers可以被部署在需要访问ZooKeeper的任意数据中心中。这样，投票协议不会受到数据中心间链路的高时延的影响，性能得到提升。投票过程中Observers和领导节点间的消息远少于投票服务器和领导节点间的消息。这有助于在远程数据中心高写负载的情况下降低带宽需求。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">最后，由于Observers即使失效也不会影响到投票集群，这样如果数据中心间链路发生故障，也不会影响到服务本身的可用性。这种故障的发生概率要远高于一个数据中心机架间的连接的故障概率，所以不依赖于这种链路是个优点。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><strong><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 14pt;"><span style="font-family:微软雅黑;">如何开始使用</span>Observers</span></strong></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 14pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">O b s e r v e r s 还 没 有 成 为 某 个ZooKeeper release 的一部分，所以要使用它，你需要从 Subversion trunk 获取源代码。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">下面的内容提取自</span>Observers用户手册，可以在源代码的d o c s /zooKeeperObservers.html 文件中看到。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><strong><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 12pt;"><span style="font-family:微软雅黑;">如何使用</span>Observers</span></strong><strong><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 12pt;"></span></strong></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(0, 174, 239);font-size: 12pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">注意，在</span>ZOOKEEPER-578 解决之前，你必须在每个服务器的配置文件中设置electionAlg=0 。否则当你启动服务的时候会抛出一个异常。</span></p> 
<p class="p"><br></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;">原因：Observers并不参与领导节点的选举，它们依赖于投票 Followers 来获知领导的变动。目前，只有基本 选 举 算 法 启 动 一 个 线 程 来 响 应Observers确定当前领导的请求。其他JIRA 上的工作将会让其他所有的领导选举协议都支持这一功能。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-family: 微软雅黑;font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">设置</span>ZooKeeper使用Observers非常简单，只需要在配置文件中有两处改动。首先是每个 Observer 的配置文件中都要有这么一行：</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(136, 136, 136);font-family: 微软雅黑;font-size: 14px;">peerType=observer</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 8pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">这行让服务器作为一个</span> Observer 来工作。之后，在每个服务器配置文件中，你必须在服务器定义行，给每个 Observer加入observer。比如：</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(136, 136, 136);font-family: 微软雅黑;font-size: 14px;">server.1:localhost:2181:3181:observer</span><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 8pt;"></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 8pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">这让每个其他服务器知道</span> server.1是一个 Observer，就不会期望它进行投票了。这就是要加入一个 Observer 的时候，所有你需要做的配置。现在可以将它作为一个正常的 Follower 来看待了。可以这样试试：</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;font-size: 14px;color: rgb(136, 136, 136);">bin/zkCli.sh -server</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;font-size: 14px;color: rgb(136, 136, 136);">localhost:2181</span><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 8pt;"></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 8pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">这里</span> localhost:2181 是 Observer 在每个配置文件中指定的主机名和端口号。你应该看到命令行提示了，这时就可以查询ZooKeeper服务了。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(0, 128, 255);"><strong><span style="font-size: 14pt;font-family: 微软雅黑;">下一步工作</span></strong></span><span style="color: rgb(0, 82, 255);"><strong><span style="font-size: 14pt;font-family: 微软雅黑;"></span></strong></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(0, 174, 239);font-size: 14pt;font-family: 微软雅黑;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;">Observers特性还有很多工作要做。短期内，我们将致力于让Observers与ZooKeeper中的所有领导选举算法完全兼容 —— 我们希望这个可以在未来几天内完成。长期看，我们希望能研究一下进行性能优化，比如基于Observers的集群的批量和离线读取，来更好地利用Observers不像一般ZooKeeper服务器一样严格要求时延的好处。</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><br></span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-family: 微软雅黑;color: rgb(35, 31, 32);font-size: 10.5pt;"><span style="font-family:微软雅黑;">我们希望</span>Observers能进入明年年初的ZooKeeper3.3.0。此外我们会很高兴能听到你的反馈，不管 是 在 邮 件 列 表 里 还 是 直 接 发 送E-mail。ZooKeeper 长期招募贡献</span></p> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="color: rgb(35, 31, 32);font-size: 10.5pt;font-family: 微软雅黑;">者，我们有足够多的有趣的问题来解决。</span></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;min-height: 1em;line-height: 27.2px;text-align: center;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><br></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;min-height: 1em;line-height: 27.2px;text-align: center;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><img class="" data-copyright="0" data-ratio="0.04523809523809524" data-s="300,640" data-type="png" data-w="420" data-src="https://mmbiz.qpic.cn/mmbiz_png/1hReHaqafafJYoFH7OAhmUdTjo35vvJTy1lRVjG2CzFP3arfVRDqI7a8PSS6Sx5LialaFTE1HFu2N4OIhL8jP9g/640?wx_fmt=png" style="letter-spacing: 0.544px;line-height: 29.75px;box-sizing: border-box !important;word-wrap: break-word !important;width: 420px !important;visibility: visible !important;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_png/1hReHaqafafJYoFH7OAhmUdTjo35vvJTy1lRVjG2CzFP3arfVRDqI7a8PSS6Sx5LialaFTE1HFu2N4OIhL8jP9g/640?wx_fmt=png"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;min-height: 1em;line-height: 27.2px;text-align: center;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><br></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;min-height: 1em;line-height: 1.4;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="padding: 0.2em 0.5em;max-width: 100%;border-radius: 0.3em;color: white;font-size: 1em;font-family: inherit;font-weight: inherit;text-align: inherit;text-decoration: inherit;background-color: rgb(255, 105, 31);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">福利</span></strong></p> 
<section class="" style="margin-top: -0.7em;font-size: 1em;white-space: normal;letter-spacing: 0.544px;widows: 1;max-width: 100%;line-height: 27.2px;border-width: 1px;border-style: solid;border-color: rgb(255, 105, 31);border-radius: 0.4em;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"> 
 <section style="padding: 1.4em 1em 1em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"> 
  <section style="max-width: 100%;font-size: 1em;font-family: inherit;text-align: inherit;text-decoration: inherit;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"> 
   <p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">扫描添加小编微信，备注“</span></strong><span style="max-width: 100%;color: rgb(255, 104, 39);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">姓名+公司职位</span></strong></span><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">”，加入【</span></strong><span style="max-width: 100%;color: rgb(255, 104, 39);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">云计算学习交流群</span></strong></span><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">】，和志同道合的朋友们共同打卡学习！</span></strong></p> 
   <p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p> 
   <p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.005813953488372" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28QDZW3ZeMemRs5PPyI20qxP8zicUCD67ia0kT4tk9BTQ6OaiaGTrvMQzl6sfmlRmFhKBcuibvRsxg3ktA/640?wx_fmt=jpeg" data-type="jpeg" data-w="516" style="height: 156px;width: 155px;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28QDZW3ZeMemRs5PPyI20qxP8zicUCD67ia0kT4tk9BTQ6OaiaGTrvMQzl6sfmlRmFhKBcuibvRsxg3ktA/640?wx_fmt=jpeg"></p> 
  </section> 
 </section> 
</section> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;min-height: 1em;line-height: 1.75em;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;min-height: 1em;line-height: 1.75em;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;text-indent: 28px;font-family: arial, 宋体, sans-serif;letter-spacing: 1px;overflow-wrap: break-word;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;letter-spacing: 0.5px;overflow-wrap: break-word;box-sizing: border-box !important;word-wrap: break-word !important;">推荐阅读：</span></strong></p> 
<ul class=" list-paddingleft-2" style="margin-left: 8px;margin-right: 8px;"> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzA3MjY1MTQwNQ==&amp;mid=2649827174&amp;idx=2&amp;sn=4f88b8e74b46cba88417d428a67240af&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">VMware竟然出了一款防火墙</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzA3MjY1MTQwNQ==&amp;mid=2649827174&amp;idx=1&amp;sn=c9e9045a7d8bfb547ee08424e64ea073&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">OpenStack网络的下一步原来这么走 | 技术头条</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=Mzg3MDA4NDkxMQ==&amp;mid=2247483862&amp;idx=1&amp;sn=17a6e29b14b3a32ee54745ffb1526b4f&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">你的 AI 老师已上岗</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247494382&amp;idx=1&amp;sn=c52199e337caaf1c8d2ac8f6e47ffd40&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">要成为年薪百万的技术大牛必经历这5个阶段, 收好这份超实用的技术进阶指南 | 技术头条</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MjM5MjAwODM4MA==&amp;mid=2650718298&amp;idx=1&amp;sn=e1d6e4ac62ffb6ba1b3699126ed1114a&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">助力 Android 抗衡 iOS，华为发布方舟编译器！</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzA5MzY4NTQwMA==&amp;mid=2651010270&amp;idx=1&amp;sn=8eaff3374818df60301b9a792579b49b&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">程序员的黑砖窑，东南亚博彩骗局详解</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzI0ODcxODk5OA==&amp;mid=2247504435&amp;idx=1&amp;sn=0786d6ddcaa81d2076217ec6561d32fa&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;font-size: 15px;" data-linktype="2">售价910元！周志华等人英文新书《演化学习》出炉！</a><br></h2></li> 
</ul> 
<section data-role="outer" label="Powered by 135editor.com" style="white-space: normal;font-size: 15px;letter-spacing: 0.544px;widows: 1;max-width: 100%;line-height: 27.2px;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"> 
 <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
  <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
   <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
    <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
     <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
      <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
       <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
        <section style="max-width: 100%;text-align: right;box-sizing: border-box !important;word-wrap: break-word !important;"> 
         <br> 
        </section> 
        <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
         <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
          <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
           <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
            <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
             <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
              <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
               <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
                <section style="max-width: 100%;text-align: right;box-sizing: border-box !important;word-wrap: break-word !important;"> 
                 <section style="margin-top: -6.4px;margin-left: -16px;max-width: 197px;font-family: 微软雅黑;font-size: 16px;letter-spacing: 0.544px;line-height: 25.6px;float: right;transform: matrix(1, 0, 0, 1, 0, 0);width: 16px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
                  <img class="" data-ratio="1" data-type="png" data-w="23" data-width="100%" data-src="https://mmbiz.qpic.cn/mmbiz_png/Pn4Sm0RsAujO0pvtNCLzZCiaWxGBfq2xaPwze1NRLTSQZYbzWNnTJwDwsReHiam91Wojzvw3RLibjicWkLWJjicgsvw/640?wx_fmt=png" style="max-width: 16px;display: block;box-sizing: border-box !important;word-wrap: break-word !important;visibility: visible !important;width: 15.99px !important;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_png/Pn4Sm0RsAujO0pvtNCLzZCiaWxGBfq2xaPwze1NRLTSQZYbzWNnTJwDwsReHiam91Wojzvw3RLibjicWkLWJjicgsvw/640?wx_fmt=png"> 
                 </section> 
                 <section data-brushtype="text" style="padding: 10px 16px;max-width: 197px;font-family: 微软雅黑;font-size: 16px;line-height: 25.6px;border-radius: 10px;color: rgb(73, 73, 72);display: inline-block;font-weight: 700;letter-spacing: 1.5px;text-align: center;background: none 0% 0% / auto repeat scroll padding-box border-box rgb(253, 245, 13);box-sizing: border-box !important;word-wrap: break-word !important;"> 
                  <span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">真香，朕在看了！</span> 
                 </section> 
                </section> 
               </section> 
              </section> 
             </section> 
            </section> 
           </section> 
          </section> 
         </section> 
        </section> 
       </section> 
      </section> 
     </section> 
    </section> 
   </section> 
  </section> 
 </section> 
</section>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
