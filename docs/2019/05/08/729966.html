<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>5分钟带你了解Kafka的技术架构   技术头条 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="5分钟带你了解Kafka的技术架构   技术头条" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="戳蓝字“CSDN云计算”关注我们哦！ 技术头条：干货、简洁、多维全面。更多云计算精华知识尽在眼前，get要点、solve难题，统统不在话下！ 大家都知道 Kafka 是一个非常牛逼的消息队列框架，阿里的 RocketMQ 也是在 Kafka 的基础上进行改进的。对于初学者来说，一开始面对这么一个庞然大物会不知道怎么入手。那么这篇文章就带你先了解一下 Kafka 的技术架构，让你从全局的视野认识 Kafka。了解了 Kafka 的整体架构和消息流程之后，脑海里就会有一个大致的结构，这时候再去学习每个部分就容易得多了。 我们先来看一下 Kafka 的整体架构图： Kafka 的架构图可以分为四个部分： Producer Cluster：生产者集群。一般由许多个实际的业务项目组成，其不断地往 Kafka 集群中写入数据。 Kafka Cluster：Kafka 服务器集群。这里就是 Kafka 作为重要的一部分，这里负责接收生产者写入的数据，并将其持久化到文件里，最终将消息提供给 Consumer Cluster。 Zookeeper Cluster：Zookeeper 集群。Zookeeper 负责维护整个 Kafka 集群的 Topic 信息、Kafka Controller 等信息。 Consumer Cluster：消费者集群。与 Producer Cluster 一样，其一般是由许多个实际的业务项目组成，不断地从 Kafka Cluster 中读取数据。 了解了 Kafka 的整体架构，那一个消息是怎么从生产者到 Kafka Server，又是如何从 Kafka Server 到消费者的呢？一般来说，一个消息的流转可以分为下面几个阶段： 服务器启动阶段 生产者发送消息阶段 Kafka存储消息阶段 消费者拉取消息阶段 服务器启动阶段 首先，我们会启动 Zookeeper 服务器，作为集群管理服务器。接着，启动 Kafka Server。Kafka Server 会向 Zookeeper 服务器注册信息，接着启动线程池监听客户端的连接请求。最后，启动生产者和消费者，连接到 Zookeeper 服务器，从 Zookeeper 服务器获取到对应的 Kafka Server 信息[1]。 生产者发送消息阶段 当需要将消息存入消息队列中时，生产者根据配置的分片算法，选择分到哪一个 partition 中。在发送一条消息时，可以指定这条消息的 key，Producer 根据这个 key 和 Partition 机制来判断应该将这条消息发送到哪个 Parition。 Paritition 机制可以通过指定 Producer 的 paritition.class 这一参数来指定，该 class 必须实现 kafka.producer.Partitioner 接口。如果不实现 Partition 接口，那么会使用默认的分区算法，即根据根据 key 哈希后取余[2]。 随后生产者与该 Partition Leader 建立联系，之后将消息发送至该 partition leader。之后生产者会根据设置的 request.required.acks 参数不同，选择等待或或直接发送下一条消息。 request.required.acks = 0 表示 Producer 不等待来自 Leader 的 ACK 确认，直接发送下一条消息。在这种情况下，如果 Leader 分片所在服务器发生宕机，那么这些已经发送的数据会丢失。 request.required.acks = 1 表示 Producer 等待来自 Leader 的 ACK 确认，当收到确认后才发送下一条消息。在这种情况下，消息一定会被写入到 Leader 服务器，但并不保证 Follow 节点已经同步完成。所以如果在消息已经被写入 Leader 分片，但是还未同步到 Follower 节点，此时Leader 分片所在服务器宕机了，那么这条消息也就丢失了，无法被消费到。 request.required.acks = -1 表示 Producer 等待来自 Leader 和所有 Follower 的 ACK 确认之后，才发送下一条消息。在这种情况下，除非 Leader 节点和所有 Follower 节点都宕机了，否则不会发生消息的丢失。 Kafka存储消息阶段 当 Kafka 接收到消息后，其并不直接将消息写入磁盘，而是先写入内存中。之后根据生产者设置参数的不同，选择是否回复 ack 给生产者。之后有一个线程会定期将内存中的数据刷入磁盘，这里有两个参数控制着这个过程： # 数据达到多少条就将消息刷到磁盘 #log.flush.interval.messages=10000 # 多久将累积的消息刷到磁盘，任何一个达到指定值就触发写入 #log.flush.interval.ms=1000 如果我们设置 log.flush.interval.messages=1，那么每次来一条消息，就会刷一次磁盘。通过这种方式，就可以达到消息绝对不丢失的目的，这种情况我们称之为同步刷盘。反之，我们称之为异步刷盘。 于此同时，Kafka 服务器也会进行副本的复制，该 Partition 的 Follower 会从 Leader 节点拉取数据进行保存。然后将数据存储到 Partition 的 Follower 节点中。 消费者拉取消息阶段 在消费者启动时，其会连接到 zk 注册节点，之后根据所连接 topic 的 partition 个数和消费者个数，进行 partition 分配。一个 partition 最多只能被一个线程消费，但一个线程可以消费多个 partition。其分配算法如下： 1. 将目标 topic 下的所有 partirtion 排序，存于PT 2. 对某 consumer group 下所有 consumer 排序，存于 CG，第 i 个consumer 记为 Ci 3. N=size(PT)/size(CG)，向上取整 4. 解除 Ci 对原来分配的 partition 的消费权（i从0开始） 5. 将第i*N到（i+1）*N-1个 partition 分配给 Ci 我们用例子简单描述下这个算法的内容：假设我们连接的 topic 有 8 个 partition，此时有 3 个消费线程。那么 partition 的分配过程大致是这样的： 8/3=2.667，向上取整就是3，也就是说每个consumer分配3个分区。 那么给第一个消费者分配p0/p1/p2三个分区。 给第二个消费者分配p3/p4/p5三个分区。 给第三个消费者分配p6/p7两个分区。 接着消费者连接对应分区的 Kafka Server，并从该分区服务器拉取数据。 总结 这篇文章简单介绍了 Kafka 框架的技术架构以及消息流转过程，并介绍了其中的某些细节。通过这篇文章，相信大家对 Kafka 框架应该有个大致的了解。 参考资料 [1].kafka broker启动流程和server结构 [2].kafka发送消息分区选择策略详解 &nbsp; 福利 扫描添加小编微信，备注“姓名+公司职位”，加入【云计算学习交流群】，和志同道合的朋友们共同打卡学习！ 推荐阅读： Elastic Jeff Yoshimura：开源正在开启新一轮的创新 | 人物志 深入浅出Docker 镜像 | 技术头条 19岁当老板, 20岁ICO失败, 21岁将项目挂到了eBay, 为何初创公司如此艰难? 码二代的出路是什么？ 机器学习萌新必备的三种优化算法 | 选型指南 小程序的侵权“生死局” @996 程序员，ICU 你真的去不起！ 真香，朕在看了！" />
<meta property="og:description" content="戳蓝字“CSDN云计算”关注我们哦！ 技术头条：干货、简洁、多维全面。更多云计算精华知识尽在眼前，get要点、solve难题，统统不在话下！ 大家都知道 Kafka 是一个非常牛逼的消息队列框架，阿里的 RocketMQ 也是在 Kafka 的基础上进行改进的。对于初学者来说，一开始面对这么一个庞然大物会不知道怎么入手。那么这篇文章就带你先了解一下 Kafka 的技术架构，让你从全局的视野认识 Kafka。了解了 Kafka 的整体架构和消息流程之后，脑海里就会有一个大致的结构，这时候再去学习每个部分就容易得多了。 我们先来看一下 Kafka 的整体架构图： Kafka 的架构图可以分为四个部分： Producer Cluster：生产者集群。一般由许多个实际的业务项目组成，其不断地往 Kafka 集群中写入数据。 Kafka Cluster：Kafka 服务器集群。这里就是 Kafka 作为重要的一部分，这里负责接收生产者写入的数据，并将其持久化到文件里，最终将消息提供给 Consumer Cluster。 Zookeeper Cluster：Zookeeper 集群。Zookeeper 负责维护整个 Kafka 集群的 Topic 信息、Kafka Controller 等信息。 Consumer Cluster：消费者集群。与 Producer Cluster 一样，其一般是由许多个实际的业务项目组成，不断地从 Kafka Cluster 中读取数据。 了解了 Kafka 的整体架构，那一个消息是怎么从生产者到 Kafka Server，又是如何从 Kafka Server 到消费者的呢？一般来说，一个消息的流转可以分为下面几个阶段： 服务器启动阶段 生产者发送消息阶段 Kafka存储消息阶段 消费者拉取消息阶段 服务器启动阶段 首先，我们会启动 Zookeeper 服务器，作为集群管理服务器。接着，启动 Kafka Server。Kafka Server 会向 Zookeeper 服务器注册信息，接着启动线程池监听客户端的连接请求。最后，启动生产者和消费者，连接到 Zookeeper 服务器，从 Zookeeper 服务器获取到对应的 Kafka Server 信息[1]。 生产者发送消息阶段 当需要将消息存入消息队列中时，生产者根据配置的分片算法，选择分到哪一个 partition 中。在发送一条消息时，可以指定这条消息的 key，Producer 根据这个 key 和 Partition 机制来判断应该将这条消息发送到哪个 Parition。 Paritition 机制可以通过指定 Producer 的 paritition.class 这一参数来指定，该 class 必须实现 kafka.producer.Partitioner 接口。如果不实现 Partition 接口，那么会使用默认的分区算法，即根据根据 key 哈希后取余[2]。 随后生产者与该 Partition Leader 建立联系，之后将消息发送至该 partition leader。之后生产者会根据设置的 request.required.acks 参数不同，选择等待或或直接发送下一条消息。 request.required.acks = 0 表示 Producer 不等待来自 Leader 的 ACK 确认，直接发送下一条消息。在这种情况下，如果 Leader 分片所在服务器发生宕机，那么这些已经发送的数据会丢失。 request.required.acks = 1 表示 Producer 等待来自 Leader 的 ACK 确认，当收到确认后才发送下一条消息。在这种情况下，消息一定会被写入到 Leader 服务器，但并不保证 Follow 节点已经同步完成。所以如果在消息已经被写入 Leader 分片，但是还未同步到 Follower 节点，此时Leader 分片所在服务器宕机了，那么这条消息也就丢失了，无法被消费到。 request.required.acks = -1 表示 Producer 等待来自 Leader 和所有 Follower 的 ACK 确认之后，才发送下一条消息。在这种情况下，除非 Leader 节点和所有 Follower 节点都宕机了，否则不会发生消息的丢失。 Kafka存储消息阶段 当 Kafka 接收到消息后，其并不直接将消息写入磁盘，而是先写入内存中。之后根据生产者设置参数的不同，选择是否回复 ack 给生产者。之后有一个线程会定期将内存中的数据刷入磁盘，这里有两个参数控制着这个过程： # 数据达到多少条就将消息刷到磁盘 #log.flush.interval.messages=10000 # 多久将累积的消息刷到磁盘，任何一个达到指定值就触发写入 #log.flush.interval.ms=1000 如果我们设置 log.flush.interval.messages=1，那么每次来一条消息，就会刷一次磁盘。通过这种方式，就可以达到消息绝对不丢失的目的，这种情况我们称之为同步刷盘。反之，我们称之为异步刷盘。 于此同时，Kafka 服务器也会进行副本的复制，该 Partition 的 Follower 会从 Leader 节点拉取数据进行保存。然后将数据存储到 Partition 的 Follower 节点中。 消费者拉取消息阶段 在消费者启动时，其会连接到 zk 注册节点，之后根据所连接 topic 的 partition 个数和消费者个数，进行 partition 分配。一个 partition 最多只能被一个线程消费，但一个线程可以消费多个 partition。其分配算法如下： 1. 将目标 topic 下的所有 partirtion 排序，存于PT 2. 对某 consumer group 下所有 consumer 排序，存于 CG，第 i 个consumer 记为 Ci 3. N=size(PT)/size(CG)，向上取整 4. 解除 Ci 对原来分配的 partition 的消费权（i从0开始） 5. 将第i*N到（i+1）*N-1个 partition 分配给 Ci 我们用例子简单描述下这个算法的内容：假设我们连接的 topic 有 8 个 partition，此时有 3 个消费线程。那么 partition 的分配过程大致是这样的： 8/3=2.667，向上取整就是3，也就是说每个consumer分配3个分区。 那么给第一个消费者分配p0/p1/p2三个分区。 给第二个消费者分配p3/p4/p5三个分区。 给第三个消费者分配p6/p7两个分区。 接着消费者连接对应分区的 Kafka Server，并从该分区服务器拉取数据。 总结 这篇文章简单介绍了 Kafka 框架的技术架构以及消息流转过程，并介绍了其中的某些细节。通过这篇文章，相信大家对 Kafka 框架应该有个大致的了解。 参考资料 [1].kafka broker启动流程和server结构 [2].kafka发送消息分区选择策略详解 &nbsp; 福利 扫描添加小编微信，备注“姓名+公司职位”，加入【云计算学习交流群】，和志同道合的朋友们共同打卡学习！ 推荐阅读： Elastic Jeff Yoshimura：开源正在开启新一轮的创新 | 人物志 深入浅出Docker 镜像 | 技术头条 19岁当老板, 20岁ICO失败, 21岁将项目挂到了eBay, 为何初创公司如此艰难? 码二代的出路是什么？ 机器学习萌新必备的三种优化算法 | 选型指南 小程序的侵权“生死局” @996 程序员，ICU 你真的去不起！ 真香，朕在看了！" />
<link rel="canonical" href="https://mlh.app/2019/05/08/729966.html" />
<meta property="og:url" content="https://mlh.app/2019/05/08/729966.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-08T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"戳蓝字“CSDN云计算”关注我们哦！ 技术头条：干货、简洁、多维全面。更多云计算精华知识尽在眼前，get要点、solve难题，统统不在话下！ 大家都知道 Kafka 是一个非常牛逼的消息队列框架，阿里的 RocketMQ 也是在 Kafka 的基础上进行改进的。对于初学者来说，一开始面对这么一个庞然大物会不知道怎么入手。那么这篇文章就带你先了解一下 Kafka 的技术架构，让你从全局的视野认识 Kafka。了解了 Kafka 的整体架构和消息流程之后，脑海里就会有一个大致的结构，这时候再去学习每个部分就容易得多了。 我们先来看一下 Kafka 的整体架构图： Kafka 的架构图可以分为四个部分： Producer Cluster：生产者集群。一般由许多个实际的业务项目组成，其不断地往 Kafka 集群中写入数据。 Kafka Cluster：Kafka 服务器集群。这里就是 Kafka 作为重要的一部分，这里负责接收生产者写入的数据，并将其持久化到文件里，最终将消息提供给 Consumer Cluster。 Zookeeper Cluster：Zookeeper 集群。Zookeeper 负责维护整个 Kafka 集群的 Topic 信息、Kafka Controller 等信息。 Consumer Cluster：消费者集群。与 Producer Cluster 一样，其一般是由许多个实际的业务项目组成，不断地从 Kafka Cluster 中读取数据。 了解了 Kafka 的整体架构，那一个消息是怎么从生产者到 Kafka Server，又是如何从 Kafka Server 到消费者的呢？一般来说，一个消息的流转可以分为下面几个阶段： 服务器启动阶段 生产者发送消息阶段 Kafka存储消息阶段 消费者拉取消息阶段 服务器启动阶段 首先，我们会启动 Zookeeper 服务器，作为集群管理服务器。接着，启动 Kafka Server。Kafka Server 会向 Zookeeper 服务器注册信息，接着启动线程池监听客户端的连接请求。最后，启动生产者和消费者，连接到 Zookeeper 服务器，从 Zookeeper 服务器获取到对应的 Kafka Server 信息[1]。 生产者发送消息阶段 当需要将消息存入消息队列中时，生产者根据配置的分片算法，选择分到哪一个 partition 中。在发送一条消息时，可以指定这条消息的 key，Producer 根据这个 key 和 Partition 机制来判断应该将这条消息发送到哪个 Parition。 Paritition 机制可以通过指定 Producer 的 paritition.class 这一参数来指定，该 class 必须实现 kafka.producer.Partitioner 接口。如果不实现 Partition 接口，那么会使用默认的分区算法，即根据根据 key 哈希后取余[2]。 随后生产者与该 Partition Leader 建立联系，之后将消息发送至该 partition leader。之后生产者会根据设置的 request.required.acks 参数不同，选择等待或或直接发送下一条消息。 request.required.acks = 0 表示 Producer 不等待来自 Leader 的 ACK 确认，直接发送下一条消息。在这种情况下，如果 Leader 分片所在服务器发生宕机，那么这些已经发送的数据会丢失。 request.required.acks = 1 表示 Producer 等待来自 Leader 的 ACK 确认，当收到确认后才发送下一条消息。在这种情况下，消息一定会被写入到 Leader 服务器，但并不保证 Follow 节点已经同步完成。所以如果在消息已经被写入 Leader 分片，但是还未同步到 Follower 节点，此时Leader 分片所在服务器宕机了，那么这条消息也就丢失了，无法被消费到。 request.required.acks = -1 表示 Producer 等待来自 Leader 和所有 Follower 的 ACK 确认之后，才发送下一条消息。在这种情况下，除非 Leader 节点和所有 Follower 节点都宕机了，否则不会发生消息的丢失。 Kafka存储消息阶段 当 Kafka 接收到消息后，其并不直接将消息写入磁盘，而是先写入内存中。之后根据生产者设置参数的不同，选择是否回复 ack 给生产者。之后有一个线程会定期将内存中的数据刷入磁盘，这里有两个参数控制着这个过程： # 数据达到多少条就将消息刷到磁盘 #log.flush.interval.messages=10000 # 多久将累积的消息刷到磁盘，任何一个达到指定值就触发写入 #log.flush.interval.ms=1000 如果我们设置 log.flush.interval.messages=1，那么每次来一条消息，就会刷一次磁盘。通过这种方式，就可以达到消息绝对不丢失的目的，这种情况我们称之为同步刷盘。反之，我们称之为异步刷盘。 于此同时，Kafka 服务器也会进行副本的复制，该 Partition 的 Follower 会从 Leader 节点拉取数据进行保存。然后将数据存储到 Partition 的 Follower 节点中。 消费者拉取消息阶段 在消费者启动时，其会连接到 zk 注册节点，之后根据所连接 topic 的 partition 个数和消费者个数，进行 partition 分配。一个 partition 最多只能被一个线程消费，但一个线程可以消费多个 partition。其分配算法如下： 1. 将目标 topic 下的所有 partirtion 排序，存于PT 2. 对某 consumer group 下所有 consumer 排序，存于 CG，第 i 个consumer 记为 Ci 3. N=size(PT)/size(CG)，向上取整 4. 解除 Ci 对原来分配的 partition 的消费权（i从0开始） 5. 将第i*N到（i+1）*N-1个 partition 分配给 Ci 我们用例子简单描述下这个算法的内容：假设我们连接的 topic 有 8 个 partition，此时有 3 个消费线程。那么 partition 的分配过程大致是这样的： 8/3=2.667，向上取整就是3，也就是说每个consumer分配3个分区。 那么给第一个消费者分配p0/p1/p2三个分区。 给第二个消费者分配p3/p4/p5三个分区。 给第三个消费者分配p6/p7两个分区。 接着消费者连接对应分区的 Kafka Server，并从该分区服务器拉取数据。 总结 这篇文章简单介绍了 Kafka 框架的技术架构以及消息流转过程，并介绍了其中的某些细节。通过这篇文章，相信大家对 Kafka 框架应该有个大致的了解。 参考资料 [1].kafka broker启动流程和server结构 [2].kafka发送消息分区选择策略详解 &nbsp; 福利 扫描添加小编微信，备注“姓名+公司职位”，加入【云计算学习交流群】，和志同道合的朋友们共同打卡学习！ 推荐阅读： Elastic Jeff Yoshimura：开源正在开启新一轮的创新 | 人物志 深入浅出Docker 镜像 | 技术头条 19岁当老板, 20岁ICO失败, 21岁将项目挂到了eBay, 为何初创公司如此艰难? 码二代的出路是什么？ 机器学习萌新必备的三种优化算法 | 选型指南 小程序的侵权“生死局” @996 程序员，ICU 你真的去不起！ 真香，朕在看了！","@type":"BlogPosting","url":"https://mlh.app/2019/05/08/729966.html","headline":"5分钟带你了解Kafka的技术架构   技术头条","dateModified":"2019-05-08T00:00:00+08:00","datePublished":"2019-05-08T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/05/08/729966.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>5分钟带你了解Kafka的技术架构&nbsp;|&nbsp;技术头条</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <section class="xmteditor" style="display:none;" data-tools="新媒体管家" data-label="powered by xmt.cn"> 
 <br> 
</section> 
<p style="text-align: right;margin-left: 8px;margin-right: 8px;"><strong><span style="font-size: 15px;">戳蓝字“</span><span style="color: rgb(0, 82, 255);font-size: 15px;">CSDN云</span><span style="font-size: 15px;color: rgb(0, 82, 255);">计算</span><span style="font-size: 15px;">”关注我们哦！</span></strong><br></p> 
<p style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="rich_pages" data-copyright="0" data-ratio="0.5626666666666666" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28TsyOteeH58GPoZ68OkwONE1HQV1RJmdgsUccalRmNhdpSsqbyEfve3eIyYBojxH2YT9AbzTojmyg/640?wx_fmt=jpeg" data-type="jpeg" data-w="750" style="" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28TsyOteeH58GPoZ68OkwONE1HQV1RJmdgsUccalRmNhdpSsqbyEfve3eIyYBojxH2YT9AbzTojmyg/640?wx_fmt=jpeg"></p> 
<section powered-by="xiumi.us" style="white-space: normal;max-width: 100%;box-sizing: border-box;font-size: 15px;letter-spacing: 0.544px;line-height: 30px;widows: 1;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"> 
 <section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"> 
  <section> 
   <section powered-by="xiumi.us" style="box-sizing: border-box;line-height: 30px;max-width: 100%;letter-spacing: 0.54px;word-wrap: break-word !important;"> 
    <section style="box-sizing: border-box;max-width: 100%;word-wrap: break-word !important;"> 
     <section> 
      <section powered-by="xiumi.us" style="box-sizing: border-box;line-height: 30px;max-width: 100%;letter-spacing: 0.54px;word-wrap: break-word !important;"> 
       <section style="box-sizing: border-box;max-width: 100%;word-wrap: break-word !important;"> 
        <section> 
         <blockquote> 
          <p style="margin-right: 8px;margin-bottom: 15px;margin-left: 8px;line-height: 1.75em;min-height: 1em;max-width: 100%;letter-spacing: 1px;text-indent: 0em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="letter-spacing: 0.54px;color: rgb(0, 82, 255);"></span><strong style="color: rgb(0, 82, 255);font-size: 15px;letter-spacing: 0.54px;white-space: normal;widows: 1;background-color: rgb(255, 255, 255);"><strong style="max-width: 100%;color: rgba(0, 0, 0, 0.5);font-size: 15px;letter-spacing: 1px;white-space: normal;widows: 1;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;letter-spacing: 0.54px;color: rgb(0, 82, 255);box-sizing: border-box !important;word-wrap: break-word !important;">技术头条：干货、简洁、多维全面。更多云计算精华知识尽在眼前，get要点、solve难题，统统不在话下！</span></strong></strong></p> 
         </blockquote> 
        </section> 
       </section> 
      </section> 
     </section> 
    </section> 
   </section> 
  </section> 
 </section> 
</section> 
<p style="text-align: justify;margin-left: 8px;margin-right: 8px;"><span style="font-size: 15px;color: rgb(136, 136, 136);"></span></p> 
<p style="margin-bottom: 15px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);margin-left: 8px;margin-right: 8px;word-wrap: break-word !important;"><span style="font-size: 15px;">大家都知道 Kafka 是一个非常牛逼的消息队列框架，阿里的 RocketMQ 也是在 Kafka 的基础上进行改进的。</span><span style="font-size: 15px;">对于初学者来说，一开始面对这么一个庞然大物会不知道怎么入手。</span><span style="font-size: 15px;">那么这篇文章就带你先了解一下 Kafka 的技术架构，让你从全局的视野认识 Kafka。</span><span style="font-size: 15px;">了解了 Kafka 的整体架构和消息流程之后，脑海里就会有一个大致的结构，这时候再去学习每个部分就容易得多了。</span></p> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">我们先来看一下 Kafka 的整体架构图：</span></p> 
<p style="max-width: 100%;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;line-height: 27.2px;white-space: normal;widows: 1;text-align: justify;background-color: rgb(255, 255, 255);margin-left: 8px;margin-right: 8px;box-sizing: border-box !important;word-wrap: break-word !important;"><img class="rich_pages" data-ratio="0.3527885862516213" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/AVWicyZuuClHiaNtVBcRK9Iv58icoXZWbRJYXiaTPcvZeKEuialAxqqxhvT8egqWqRay6RBslCQ5RY7gzevO4InYW2w/640?wx_fmt=png" data-type="png" data-w="771" style="box-sizing: border-box !important;word-wrap: break-word !important;width: 677px !important;visibility: visible !important;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_png/AVWicyZuuClHiaNtVBcRK9Iv58icoXZWbRJYXiaTPcvZeKEuialAxqqxhvT8egqWqRay6RBslCQ5RY7gzevO4InYW2w/640?wx_fmt=png"></p> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">Kafka 的架构图可以分为四个部分：</span></p> 
<ul class=" list-paddingleft-2" style="list-style-type: square;margin-left: 8px;margin-right: 8px;"> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">Producer Cluster：生产者集群。一般由许多个实际的业务项目组成，其不断地往 Kafka 集群中写入数据。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">Kafka Cluster：Kafka 服务器集群。这里就是 Kafka 作为重要的一部分，这里负责接收生产者写入的数据，并将其持久化到文件里，最终将消息提供给 Consumer Cluster。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">Zookeeper Cluster：Zookeeper 集群。Zookeeper 负责维护整个 Kafka 集群的 Topic 信息、Kafka Controller 等信息。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">Consumer Cluster：消费者集群。与 Producer Cluster 一样，其一般是由许多个实际的业务项目组成，不断地从 Kafka Cluster 中读取数据。</span></p></li> 
</ul> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">了解了 Kafka 的整体架构，那一个消息是怎么从生产者到 Kafka Server，又是如何从 Kafka Server 到消费者的呢？</span><span style="font-size: 15px;">一般来说，一个消息的流转可以分为下面几个阶段：</span></p> 
<ul class=" list-paddingleft-2" style="list-style-type: square;margin-left: 8px;margin-right: 8px;"> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">服务器启动阶段</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">生产者发送消息阶段</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">Kafka存储消息阶段</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">消费者拉取消息阶段</span></p></li> 
</ul> 
<h2 style="margin: 1.5rem 8px 1rem;font-size: 24px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;white-space: normal;widows: 1;color: rgb(21, 153, 87);line-height: 1.35;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;font-family: Menlo, Monaco, &quot;Source Code Pro&quot;, Consolas, Inconsolata, &quot;Ubuntu Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Courier New&quot;, &quot;Droid Sans Mono&quot;, &quot;Hiragino Sans GB&quot;, 微软雅黑, monospace !important;"><span style="font-size: 15px;">服务器启动阶段</span></h2> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">首先，我们会启动 Zookeeper 服务器，作为集群管理服务器。</span><span style="font-size: 15px;">接着，启动 Kafka Server。</span><span style="font-size: 15px;">Kafka Server 会向 Zookeeper 服务器注册信息，接着启动线程池监听客户端的连接请求。</span><span style="font-size: 15px;">最后，启动生产者和消费者，连接到 Zookeeper 服务器，从 Zookeeper 服务器获取到对应的 Kafka Server 信息[1]。</span></p> 
<h2 style="margin: 1.5rem 8px 1rem;font-size: 24px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;white-space: normal;widows: 1;color: rgb(21, 153, 87);line-height: 1.35;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;font-family: Menlo, Monaco, &quot;Source Code Pro&quot;, Consolas, Inconsolata, &quot;Ubuntu Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Courier New&quot;, &quot;Droid Sans Mono&quot;, &quot;Hiragino Sans GB&quot;, 微软雅黑, monospace !important;"><span style="font-size: 15px;">生产者发送消息阶段</span></h2> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">当需要将消息存入消息队列中时，生产者根据配置的分片算法，选择分到哪一个 partition 中。</span><span style="font-size: 15px;">在发送一条消息时，可以指定这条消息的 key，Producer 根据这个 key 和 Partition 机制来判断应该将这条消息发送到哪个 Parition。</span></p> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">Paritition 机制可以通过指定 Producer 的 paritition.class 这一参数来指定，该 class 必须实现 kafka.producer.Partitioner 接口。</span><span style="font-size: 15px;">如果不实现 Partition 接口，那么会使用默认的分区算法，即根据根据 key 哈希后取余[2]。</span></p> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">随后生产者与该 Partition Leader 建立联系，之后将消息发送至该 partition leader。</span><span style="font-size: 15px;">之后生产者会根据设置的 request.required.acks 参数不同，选择等待或或直接发送下一条消息。</span></p> 
<ul class=" list-paddingleft-2" style="list-style-type: square;margin-left: 8px;margin-right: 8px;"> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">request.required.acks = 0</strong> 表示 Producer 不等待来自 Leader 的 ACK 确认，直接发送下一条消息。在这种情况下，如果 Leader 分片所在服务器发生宕机，那么这些已经发送的数据会丢失。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">request.required.acks = 1</strong> 表示 Producer 等待来自 Leader 的 ACK 确认，当收到确认后才发送下一条消息。在这种情况下，消息一定会被写入到 Leader 服务器，但并不保证 Follow 节点已经同步完成。所以如果在消息已经被写入 Leader 分片，但是还未同步到 Follower 节点，此时Leader 分片所在服务器宕机了，那么这条消息也就丢失了，无法被消费到。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box;color: rgb(0, 0, 0);word-wrap: break-word !important;">request.required.acks = -1</strong> 表示 Producer 等待来自 Leader 和所有 Follower 的 ACK 确认之后，才发送下一条消息。在这种情况下，除非 Leader 节点和所有 Follower 节点都宕机了，否则不会发生消息的丢失。</span></p></li> 
</ul> 
<h2 style="margin: 1.5rem 8px 1rem;font-size: 24px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;white-space: normal;widows: 1;color: rgb(21, 153, 87);line-height: 1.35;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;font-family: Menlo, Monaco, &quot;Source Code Pro&quot;, Consolas, Inconsolata, &quot;Ubuntu Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Courier New&quot;, &quot;Droid Sans Mono&quot;, &quot;Hiragino Sans GB&quot;, 微软雅黑, monospace !important;"><span style="font-size: 15px;">Kafka存储消息阶段</span></h2> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">当 Kafka 接收到消息后，其并不直接将消息写入磁盘，而是先写入内存中。</span><span style="font-size: 15px;">之后根据生产者设置参数的不同，选择是否回复 ack 给生产者。</span><span style="font-size: 15px;">之后有一个线程会定期将内存中的数据刷入磁盘，这里有两个参数控制着这个过程：</span></p> 
<pre class="" style="margin-right: 16px;margin-left: 16px;padding-top: 8px;padding-bottom: 6px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);text-align: start;font-size: 10px;line-height: 12px;background: rgb(241, 239, 238);word-wrap: break-word !important;font-family: consolas, menlo, courier, monospace, &quot;Microsoft Yahei&quot;!important;border-width: 1px !important;border-style: solid !important;border-color: rgb(226, 226, 226) !important;">
         
 <ol class=" list-paddingleft-2" style="list-style-type: none;margin-left: 8px;margin-right: 8px;">
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(156, 148, 145);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"># 数据达到多少条就将消息刷到磁盘</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(156, 148, 145);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">#log.flush.interval.messages=10000</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(156, 148, 145);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"># 多久将累积的消息刷到磁盘，任何一个达到指定值就触发写入</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(156, 148, 145);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">#log.flush.interval.ms=1000</span></code></span></p></li>
         
 </ol></pre> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">如果我们设置 log.flush.interval.messages=1，那么每次来一条消息，就会刷一次磁盘。</span><span style="font-size: 15px;">通过这种方式，就可以达到消息绝对不丢失的目的，这种情况我们称之为同步刷盘。</span><span style="font-size: 15px;">反之，我们称之为异步刷盘。</span></p> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">于此同时，Kafka 服务器也会进行副本的复制，该 Partition 的 Follower 会从 Leader 节点拉取数据进行保存。</span><span style="font-size: 15px;">然后将数据存储到 Partition 的 Follower 节点中。</span></p> 
<h2 style="margin: 1.5rem 8px 1rem;font-size: 24px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;white-space: normal;widows: 1;color: rgb(21, 153, 87);line-height: 1.35;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;font-family: Menlo, Monaco, &quot;Source Code Pro&quot;, Consolas, Inconsolata, &quot;Ubuntu Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Courier New&quot;, &quot;Droid Sans Mono&quot;, &quot;Hiragino Sans GB&quot;, 微软雅黑, monospace !important;"><span style="font-size: 15px;">消费者拉取消息阶段</span></h2> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">在消费者启动时，其会连接到 zk 注册节点，之后根据所连接 topic 的 partition 个数和消费者个数，进行 partition 分配。</span><span style="font-size: 15px;">一个 partition 最多只能被一个线程消费，但一个线程可以消费多个 partition。</span><span style="font-size: 15px;">其分配算法如下：</span></p> 
<pre class="" style="margin-right: 16px;margin-left: 16px;padding-top: 8px;padding-bottom: 6px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;border-radius: 0px;overflow-y: auto;color: rgb(80, 97, 109);text-align: start;font-size: 10px;line-height: 12px;background: rgb(241, 239, 238);word-wrap: break-word !important;font-family: consolas, menlo, courier, monospace, &quot;Microsoft Yahei&quot;!important;border-width: 1px !important;border-style: solid !important;border-color: rgb(226, 226, 226) !important;">
         
 <ol class=" list-paddingleft-2" style="list-style-type: none;margin-left: 8px;margin-right: 8px;">
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">1.</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> 将目标 topic 下的所有 partirtion 排序，存于PT</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">2.</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> 对某 consumer </span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(102, 102, 234);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">group</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> 下所有 consumer 排序，存于 CG，第 i 个consumer 记为 </span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(64, 126, 231);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">Ci</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">3.</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> N=size(PT)/size(CG)，向上取整</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">4.</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> 解除 </span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(64, 126, 231);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">Ci</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> 对原来分配的 partition 的消费权（i从</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">0</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">开始）</span></code></span></p></li>
          
  <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);display: block;line-height: 22px;font-size: 15px;word-wrap: break-word !important;word-break: inherit !important;text-align: justify;"><code style="margin-left: -20px;max-width: 100%;box-sizing: border-box;display: flex;overflow: initial;line-height: 12px;overflow-wrap: normal;border-width: 0px;border-style: initial;border-color: initial;font-size: 10px;word-wrap: break-word !important;font-family: inherit !important;"><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">5.</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;"> 将第i*N到（i+</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">1</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">）*N-</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(223, 83, 32);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">1</span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(27, 25, 24);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">个 partition 分配给 </span><span class="" style="display: block;font-size: 15px;max-width: 100%;box-sizing: border-box;color: rgb(64, 126, 231);line-height: 20px;word-break: inherit !important;word-wrap: break-word !important;white-space: inherit !important;">Ci</span></code></span></p></li>
         
 </ol></pre> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">我们用例子简单描述下这个算法的内容：</span><span style="font-size: 15px;">假设我们连接的 topic 有 8 个 partition，此时有 3 个消费线程。</span><span style="font-size: 15px;">那么 partition 的分配过程大致是这样的：</span></p> 
<ul class=" list-paddingleft-2" style="list-style-type: square;margin-left: 8px;margin-right: 8px;"> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">8/3=2.667，向上取整就是3，也就是说每个consumer分配3个分区。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">那么给第一个消费者分配p0/p1/p2三个分区。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">给第二个消费者分配p3/p4/p5三个分区。</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">给第三个消费者分配p6/p7两个分区。</span></p></li> 
</ul> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">接着消费者连接对应分区的 Kafka Server，并从该分区服务器拉取数据。</span></p> 
<h2 style="margin: 1.5rem 8px 1rem;font-size: 24px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;white-space: normal;widows: 1;color: rgb(21, 153, 87);line-height: 1.35;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;font-family: Menlo, Monaco, &quot;Source Code Pro&quot;, Consolas, Inconsolata, &quot;Ubuntu Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Courier New&quot;, &quot;Droid Sans Mono&quot;, &quot;Hiragino Sans GB&quot;, 微软雅黑, monospace !important;"><span style="font-size: 15px;">总结</span></h2> 
<p style="margin: 15px 8px;max-width: 100%;box-sizing: border-box;min-height: 1em;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;widows: 1;font-size: 16px;white-space: pre-line;line-height: 30px;color: rgb(74, 74, 74);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><span style="font-size: 15px;">这篇文章简单介绍了 Kafka 框架的技术架构以及消息流转过程，并介绍了其中的某些细节。</span><span style="font-size: 15px;">通过这篇文章，相信大家对 Kafka 框架应该有个大致的了解。</span></p> 
<h2 style="margin: 1.5rem 8px 1rem;font-size: 24px;max-width: 100%;box-sizing: border-box;font-variant-numeric: normal;font-variant-east-asian: normal;letter-spacing: 0.544px;white-space: normal;widows: 1;color: rgb(21, 153, 87);line-height: 1.35;text-align: justify;background-color: rgb(255, 255, 255);word-wrap: break-word !important;font-family: Menlo, Monaco, &quot;Source Code Pro&quot;, Consolas, Inconsolata, &quot;Ubuntu Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Courier New&quot;, &quot;Droid Sans Mono&quot;, &quot;Hiragino Sans GB&quot;, 微软雅黑, monospace !important;"><span style="font-size: 15px;">参考资料</span></h2> 
<ul class=" list-paddingleft-2" style="list-style-type: square;margin-left: 8px;margin-right: 8px;"> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">[1].kafka broker启动流程和server结构</span></p></li> 
 <li><p style="max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;text-align: justify;"><span style="max-width: 100%;box-sizing: border-box;color: rgb(74, 74, 74);line-height: 22px;font-size: 15px;word-wrap: break-word !important;">[2].kafka发送消息分区选择策略详解</span></p></li> 
</ul> 
<p style="text-indent:32px;text-align:center;"><span style="font-family:微软雅黑;color:rgb(0,0,0);font-size:16px;">&nbsp;</span></p> 
<p style="text-align: center;margin-left: 8px;margin-right: 8px;"><img class="" data-copyright="0" data-ratio="0.04523809523809524" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/1hReHaqafafJYoFH7OAhmUdTjo35vvJTy1lRVjG2CzFP3arfVRDqI7a8PSS6Sx5LialaFTE1HFu2N4OIhL8jP9g/640?wx_fmt=png" data-type="png" data-w="420" style="letter-spacing: 0.544px;line-height: 29.75px;box-sizing: border-box !important;word-wrap: break-word !important;width: 420px !important;visibility: visible !important;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_png/1hReHaqafafJYoFH7OAhmUdTjo35vvJTy1lRVjG2CzFP3arfVRDqI7a8PSS6Sx5LialaFTE1HFu2N4OIhL8jP9g/640?wx_fmt=png"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p> 
<p style="text-align: center;margin-left: 8px;margin-right: 8px;"><br></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;widows: 1;line-height: 1.4;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><span style="padding: 0.2em 0.5em;max-width: 100%;border-radius: 0.3em;color: white;font-size: 1em;font-family: inherit;font-weight: inherit;text-align: inherit;text-decoration: inherit;background-color: rgb(255, 105, 31);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;">福利</span></strong></p> 
<section class="" style="margin-top: -0.7em;font-size: 1em;white-space: normal;max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;widows: 1;border-width: 1px;border-style: solid;border-color: rgb(255, 105, 31);border-radius: 0.4em;background-color: rgb(255, 255, 255);box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"> 
 <section style="padding: 1.4em 1em 1em;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"> 
  <section style="max-width: 100%;font-size: 1em;font-family: inherit;text-align: inherit;text-decoration: inherit;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"> 
   <p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">扫描添加小编微信，备注“</span></strong><span style="max-width: 100%;color: rgb(255, 104, 39);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">姓名+公司职位</span></strong></span><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">”，加入【</span></strong><span style="max-width: 100%;color: rgb(255, 104, 39);box-sizing: border-box !important;word-wrap: break-word !important;"><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">云计算学习交流群</span></strong></span><strong style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">】，和志同道合的朋友们共同打卡学习！</span></strong></p> 
   <p style="margin-right: 8px;margin-left: 8px;max-width: 100%;min-height: 1em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"></p> 
   <p style="text-align: center;"><img class="rich_pages" data-copyright="0" data-ratio="1.005813953488372" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28QDZW3ZeMemRs5PPyI20qxP8zicUCD67ia0kT4tk9BTQ6OaiaGTrvMQzl6sfmlRmFhKBcuibvRsxg3ktA/640?wx_fmt=jpeg" data-type="jpeg" data-w="516" style="height: 156px;width: 155px;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_jpg/zxoLaeCI28QDZW3ZeMemRs5PPyI20qxP8zicUCD67ia0kT4tk9BTQ6OaiaGTrvMQzl6sfmlRmFhKBcuibvRsxg3ktA/640?wx_fmt=jpeg"></p> 
  </section> 
 </section> 
</section> 
<p style="text-align: center;margin-left: 8px;margin-right: 8px;"><br></p> 
<p style="margin-right: 8px;margin-left: 8px;white-space: normal;max-width: 100%;min-height: 1em;font-size: 15px;letter-spacing: 0.544px;line-height: 1.75em;box-sizing: border-box !important;word-wrap: break-word !important;overflow-wrap: break-word !important;"><strong style="max-width: 100%;text-indent: 28px;font-family: arial, 宋体, sans-serif;letter-spacing: 1px;overflow-wrap: break-word;box-sizing: border-box !important;word-wrap: break-word !important;"><span style="max-width: 100%;letter-spacing: 0.5px;overflow-wrap: break-word;box-sizing: border-box !important;word-wrap: break-word !important;">推荐阅读：</span></strong></p> 
<ul class=" list-paddingleft-2" style="margin-left: 8px;margin-right: 8px;"> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzA3MjY1MTQwNQ==&amp;mid=2649827390&amp;idx=1&amp;sn=b46af38886f0f18a8f9e612e1b4568ba&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">Elastic Jeff Yoshimura：开源正在开启新一轮的创新 | 人物志</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzA3MjY1MTQwNQ==&amp;mid=2649827337&amp;idx=1&amp;sn=5c580f242966f000500251077ebaf9e4&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">深入浅出Docker 镜像 | 技术头条</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzU2MTE1NDk2Mg==&amp;mid=2247494653&amp;idx=1&amp;sn=f8a0e8961bf7bc2a219bb4d2d65f88fd&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">19岁当老板, 20岁ICO失败, 21岁将项目挂到了eBay, 为何初创公司如此艰难?</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=Mzg3MDA4NDkxMQ==&amp;mid=2247483894&amp;idx=1&amp;sn=65c6f6d62f2f3b8ef44dd01de9c72867&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">码二代的出路是什么？</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzI0ODcxODk5OA==&amp;mid=2247504645&amp;idx=4&amp;sn=bd7644e3897019715ad78214ffe95c29&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">机器学习萌新必备的三种优化算法 | 选型指南</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MzA5MzY4NTQwMA==&amp;mid=2651010496&amp;idx=3&amp;sn=1a45d882bbd6b067c939f43cfd34d6d4&amp;scene=21#wechat_redirect" target="_blank" style="text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">小程序的侵权“生死局”</span></a></h2></li> 
 <li><h2 style="max-width: 100%;letter-spacing: 0.54px;box-sizing: border-box !important;word-wrap: break-word !important;"><a href="https://mp.weixin.qq.com/s?__biz=MjM5MjAwODM4MA==&amp;mid=2650718955&amp;idx=1&amp;sn=7dc3b3f93c529ae4ffbace0b5e40f3e2&amp;scene=21#wechat_redirect" target="_blank" style="font-size: 15px;text-decoration: underline;" data-linktype="2"><span style="font-size: 15px;">@996 程序员，ICU 你真的去不起！</span></a><br></h2></li> 
</ul> 
<section data-role="outer" label="Powered by 135editor.com" style="white-space: normal;max-width: 100%;font-size: 15px;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
 <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
  <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
   <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
    <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
     <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
      <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
       <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
        <section style="max-width: 100%;text-align: right;box-sizing: border-box !important;word-wrap: break-word !important;"> 
         <br style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
        </section> 
        <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
         <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
          <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
           <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
            <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;letter-spacing: 0.544px;line-height: 27.2px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
             <section data-role="outer" label="Powered by 135editor.com" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
              <section class="" data-tools="135编辑器" data-id="94174" style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
               <section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"> 
                <section style="max-width: 100%;text-align: right;box-sizing: border-box !important;word-wrap: break-word !important;"> 
                 <section style="margin-top: -6.4px;margin-left: -16px;max-width: 197px;font-family: 微软雅黑;font-size: 16px;letter-spacing: 0.544px;line-height: 25.6px;float: right;transform: matrix(1, 0, 0, 1, 0, 0);width: 16px;box-sizing: border-box !important;word-wrap: break-word !important;"> 
                  <img class="" data-ratio="1" data-src="https://mmbiz.qpic.cn/mmbiz_png/Pn4Sm0RsAujO0pvtNCLzZCiaWxGBfq2xaPwze1NRLTSQZYbzWNnTJwDwsReHiam91Wojzvw3RLibjicWkLWJjicgsvw/640?wx_fmt=png" data-type="png" data-w="23" data-width="100%" style="max-width: 16px;display: block;box-sizing: border-box !important;word-wrap: break-word !important;visibility: visible !important;width: 15.99px !important;" src="https://uzshare.com/_p?https://mmbiz.qpic.cn/mmbiz_png/Pn4Sm0RsAujO0pvtNCLzZCiaWxGBfq2xaPwze1NRLTSQZYbzWNnTJwDwsReHiam91Wojzvw3RLibjicWkLWJjicgsvw/640?wx_fmt=png"> 
                 </section> 
                 <section data-brushtype="text" style="padding: 10px 16px;max-width: 197px;font-family: 微软雅黑;font-size: 16px;line-height: 25.6px;border-radius: 10px;color: rgb(73, 73, 72);display: inline-block;font-weight: 700;letter-spacing: 1.5px;text-align: center;background: none 0% 0% / auto repeat scroll padding-box border-box rgb(253, 245, 13);box-sizing: border-box !important;word-wrap: break-word !important;"> 
                  <span style="max-width: 100%;font-size: 15px;box-sizing: border-box !important;word-wrap: break-word !important;">真香，朕在看了！</span> 
                 </section> 
                </section> 
               </section> 
              </section> 
             </section> 
            </section> 
           </section> 
          </section> 
         </section> 
        </section> 
       </section> 
      </section> 
     </section> 
    </section> 
   </section> 
  </section> 
 </section> 
</section>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
