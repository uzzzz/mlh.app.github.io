<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>[开发技巧]·TensorFlow&amp;Keras GPU使用技巧 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="[开发技巧]·TensorFlow&amp;Keras GPU使用技巧" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="[开发技巧]·TensorFlow&amp;Keras GPU使用技巧 1.问题描述 在使用TensorFlow&amp;Keras通过GPU进行加速训练时，有时在训练一个任务的时候需要去测试结果，或者是需要并行训练数据的时候就会显示OOM显存容量不足的错误。以下简称在训练一个任务的时候需要去测试结果，或者是需要并行训练数据为进行新的运算任务。 首先介绍下TensorFlow&amp;Keras GPU使用的机制：TensorFlow&amp;Keras会在有GPU可以使用时，自动将数据与运算放到GPU进行训练（这个不同于MXNet与PyTorch处理方式不同，MXNet与PyTorch需要手动编程去指定数据与运算的Device，这里不讨论这些方法之间的优劣，选择适合自己的就好了），默认充满GPU所有显存。&nbsp; 所以当用户在运行一个运算任务时会占据所有显存，如果再去开启一个新任务就会内存不足，引起OOM显存容量不足的错误。 &nbsp; 2.问题分析 通过对上述问题解读，应该可以通过以下的方法解决： 当一个训练任务默认占据所有GPU显存的时候，可以使用CPU进行新的任务（这显然不是最优方法，使用CPU进行新的任务速度会很慢） 当一个训练任务默认占据所有GPU显存的时候，用户可以设定此任务占用的GPU显存大小，现在再使用GPU进行新的任务时，就可以并行运行了 如果有多个GPU可以默认指定任务在不同GPU上。 &nbsp; 3.使用教程 &nbsp; 1.解决方法一：使用CPU进行新的任务 这不是最优方法，使用CPU进行新的任务速度会很慢，但是也是一种解决方式 1 2 3 4 5 6 7 8 import &nbsp; os &nbsp; os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]&nbsp; = &nbsp; &#39;-1&#39;&nbsp; &nbsp; # 打印 TF 可用的 GPU print (os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]) &nbsp; # -1 表示不使用GPU 2.解决方法二：设定任务占用的GPU显存大小 这个是笔者比较推荐的方式，由于TensorFlow&amp;Keras运行一个运算任务时会占据所有显存，其实有时并没有用到那么多。 这样做也会有点小问题就是，单个任务会变慢一点，笔者测试结果是在使用上述方法并行运行两个单个任务速度变为0.8左右，但是换来了可以运行两个任务，还是很值得的。（推测变慢的原因是两个任务并行运算时，对GPU压力更大，每个任务上分配的性能就会降低，类似于在电脑上跑多个任务，电脑会卡顿） 这样做要注意一点，在分配显存空间后，模型训练占据的内存要设置好（这个是指实际占用内存，可以通过修改batch_size来控制），不要超出你所分配的大小，不然会有不期望的结果出现。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import&nbsp;tensorflow as tf &nbsp; # 在开启对话session前，先创建一个 tf.ConfigProto() 实例对象 &nbsp; gpuConfig&nbsp;=&nbsp;tf.ConfigProto(allow_soft_placement=True) &nbsp; # 限制一个进程使用 60% 的显存 gpuConfig.gpu_options.per_process_gpu_memory_fraction&nbsp;=&nbsp;0.6 &nbsp; # 把你的配置部署到session&nbsp; 变量名 sess 无所谓 sess1&nbsp;=tf.Session(config=gpuConfig) &nbsp; &nbsp; #这样，如果你指定的卡的显存是2000M的话，你这个进程只能用1200M。 输出结果（with 1228 MB memory，代表使用1228 MB，这与设置的0.6 * 2000相符） 1 2 Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0&nbsp;with&nbsp;1228&nbsp;MB memory)&nbsp;-&gt; physical GPU (device:&nbsp;0, name: GeForce MX150, pci bus&nbsp;id:&nbsp;0000:01:00.0, compute capability:&nbsp;6.1) 3.解决方法三：多个GPU指定在不同GPU运行 如果你对编程感兴趣或者想往编程方向发展，可以关注微信公众号【筑梦编程】，大家一起交流讨论！小编也会每天定时更新既有趣又有用的编程知识！ &nbsp; 如果条件允许，拥有多个，就可以把不同任务放置在不同GPU上，要注意如果是和同事共用，要约定好如何分配，免得大家都用了同一个。 设置方法与方法一类似。-1代表不使用，0代表第一个，1代表第二个 以两个GPU举例，第一个任务开头可以使用如下，第二个任务就把0改为1，多个GPU方法类似。注意一点要放置在开头位置。 1 2 3 4 5 6 7 8 import&nbsp;os &nbsp; os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]&nbsp;=&nbsp;&#39;0&#39; &nbsp; # 打印 TF 可用的 GPU print(os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]) &nbsp; # -1 表示不使用GPU 0代表第一个 如果多于两个GPU，想在某个任务设置多个GPU，可以使用下述方法 1 2 3 4 5 6 7 8 import &nbsp; os &nbsp; os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]&nbsp; = &nbsp; &#39;0,1&#39; &nbsp; # 打印 TF 可用的 GPU print (os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]) &nbsp; # -1 表示不使用GPU 0代表第一个 最后留个大家一个思考问题，os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;] = &#39;-1,0&#39; 时会怎么样调用？ 欢迎大家在评论区留言发布自己看法和解读。。" />
<meta property="og:description" content="[开发技巧]·TensorFlow&amp;Keras GPU使用技巧 1.问题描述 在使用TensorFlow&amp;Keras通过GPU进行加速训练时，有时在训练一个任务的时候需要去测试结果，或者是需要并行训练数据的时候就会显示OOM显存容量不足的错误。以下简称在训练一个任务的时候需要去测试结果，或者是需要并行训练数据为进行新的运算任务。 首先介绍下TensorFlow&amp;Keras GPU使用的机制：TensorFlow&amp;Keras会在有GPU可以使用时，自动将数据与运算放到GPU进行训练（这个不同于MXNet与PyTorch处理方式不同，MXNet与PyTorch需要手动编程去指定数据与运算的Device，这里不讨论这些方法之间的优劣，选择适合自己的就好了），默认充满GPU所有显存。&nbsp; 所以当用户在运行一个运算任务时会占据所有显存，如果再去开启一个新任务就会内存不足，引起OOM显存容量不足的错误。 &nbsp; 2.问题分析 通过对上述问题解读，应该可以通过以下的方法解决： 当一个训练任务默认占据所有GPU显存的时候，可以使用CPU进行新的任务（这显然不是最优方法，使用CPU进行新的任务速度会很慢） 当一个训练任务默认占据所有GPU显存的时候，用户可以设定此任务占用的GPU显存大小，现在再使用GPU进行新的任务时，就可以并行运行了 如果有多个GPU可以默认指定任务在不同GPU上。 &nbsp; 3.使用教程 &nbsp; 1.解决方法一：使用CPU进行新的任务 这不是最优方法，使用CPU进行新的任务速度会很慢，但是也是一种解决方式 1 2 3 4 5 6 7 8 import &nbsp; os &nbsp; os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]&nbsp; = &nbsp; &#39;-1&#39;&nbsp; &nbsp; # 打印 TF 可用的 GPU print (os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]) &nbsp; # -1 表示不使用GPU 2.解决方法二：设定任务占用的GPU显存大小 这个是笔者比较推荐的方式，由于TensorFlow&amp;Keras运行一个运算任务时会占据所有显存，其实有时并没有用到那么多。 这样做也会有点小问题就是，单个任务会变慢一点，笔者测试结果是在使用上述方法并行运行两个单个任务速度变为0.8左右，但是换来了可以运行两个任务，还是很值得的。（推测变慢的原因是两个任务并行运算时，对GPU压力更大，每个任务上分配的性能就会降低，类似于在电脑上跑多个任务，电脑会卡顿） 这样做要注意一点，在分配显存空间后，模型训练占据的内存要设置好（这个是指实际占用内存，可以通过修改batch_size来控制），不要超出你所分配的大小，不然会有不期望的结果出现。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import&nbsp;tensorflow as tf &nbsp; # 在开启对话session前，先创建一个 tf.ConfigProto() 实例对象 &nbsp; gpuConfig&nbsp;=&nbsp;tf.ConfigProto(allow_soft_placement=True) &nbsp; # 限制一个进程使用 60% 的显存 gpuConfig.gpu_options.per_process_gpu_memory_fraction&nbsp;=&nbsp;0.6 &nbsp; # 把你的配置部署到session&nbsp; 变量名 sess 无所谓 sess1&nbsp;=tf.Session(config=gpuConfig) &nbsp; &nbsp; #这样，如果你指定的卡的显存是2000M的话，你这个进程只能用1200M。 输出结果（with 1228 MB memory，代表使用1228 MB，这与设置的0.6 * 2000相符） 1 2 Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0&nbsp;with&nbsp;1228&nbsp;MB memory)&nbsp;-&gt; physical GPU (device:&nbsp;0, name: GeForce MX150, pci bus&nbsp;id:&nbsp;0000:01:00.0, compute capability:&nbsp;6.1) 3.解决方法三：多个GPU指定在不同GPU运行 如果你对编程感兴趣或者想往编程方向发展，可以关注微信公众号【筑梦编程】，大家一起交流讨论！小编也会每天定时更新既有趣又有用的编程知识！ &nbsp; 如果条件允许，拥有多个，就可以把不同任务放置在不同GPU上，要注意如果是和同事共用，要约定好如何分配，免得大家都用了同一个。 设置方法与方法一类似。-1代表不使用，0代表第一个，1代表第二个 以两个GPU举例，第一个任务开头可以使用如下，第二个任务就把0改为1，多个GPU方法类似。注意一点要放置在开头位置。 1 2 3 4 5 6 7 8 import&nbsp;os &nbsp; os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]&nbsp;=&nbsp;&#39;0&#39; &nbsp; # 打印 TF 可用的 GPU print(os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]) &nbsp; # -1 表示不使用GPU 0代表第一个 如果多于两个GPU，想在某个任务设置多个GPU，可以使用下述方法 1 2 3 4 5 6 7 8 import &nbsp; os &nbsp; os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]&nbsp; = &nbsp; &#39;0,1&#39; &nbsp; # 打印 TF 可用的 GPU print (os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]) &nbsp; # -1 表示不使用GPU 0代表第一个 最后留个大家一个思考问题，os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;] = &#39;-1,0&#39; 时会怎么样调用？ 欢迎大家在评论区留言发布自己看法和解读。。" />
<link rel="canonical" href="https://mlh.app/2019/05/17/787053.html" />
<meta property="og:url" content="https://mlh.app/2019/05/17/787053.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"[开发技巧]·TensorFlow&amp;Keras GPU使用技巧 1.问题描述 在使用TensorFlow&amp;Keras通过GPU进行加速训练时，有时在训练一个任务的时候需要去测试结果，或者是需要并行训练数据的时候就会显示OOM显存容量不足的错误。以下简称在训练一个任务的时候需要去测试结果，或者是需要并行训练数据为进行新的运算任务。 首先介绍下TensorFlow&amp;Keras GPU使用的机制：TensorFlow&amp;Keras会在有GPU可以使用时，自动将数据与运算放到GPU进行训练（这个不同于MXNet与PyTorch处理方式不同，MXNet与PyTorch需要手动编程去指定数据与运算的Device，这里不讨论这些方法之间的优劣，选择适合自己的就好了），默认充满GPU所有显存。&nbsp; 所以当用户在运行一个运算任务时会占据所有显存，如果再去开启一个新任务就会内存不足，引起OOM显存容量不足的错误。 &nbsp; 2.问题分析 通过对上述问题解读，应该可以通过以下的方法解决： 当一个训练任务默认占据所有GPU显存的时候，可以使用CPU进行新的任务（这显然不是最优方法，使用CPU进行新的任务速度会很慢） 当一个训练任务默认占据所有GPU显存的时候，用户可以设定此任务占用的GPU显存大小，现在再使用GPU进行新的任务时，就可以并行运行了 如果有多个GPU可以默认指定任务在不同GPU上。 &nbsp; 3.使用教程 &nbsp; 1.解决方法一：使用CPU进行新的任务 这不是最优方法，使用CPU进行新的任务速度会很慢，但是也是一种解决方式 1 2 3 4 5 6 7 8 import &nbsp; os &nbsp; os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]&nbsp; = &nbsp; &#39;-1&#39;&nbsp; &nbsp; # 打印 TF 可用的 GPU print (os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]) &nbsp; # -1 表示不使用GPU 2.解决方法二：设定任务占用的GPU显存大小 这个是笔者比较推荐的方式，由于TensorFlow&amp;Keras运行一个运算任务时会占据所有显存，其实有时并没有用到那么多。 这样做也会有点小问题就是，单个任务会变慢一点，笔者测试结果是在使用上述方法并行运行两个单个任务速度变为0.8左右，但是换来了可以运行两个任务，还是很值得的。（推测变慢的原因是两个任务并行运算时，对GPU压力更大，每个任务上分配的性能就会降低，类似于在电脑上跑多个任务，电脑会卡顿） 这样做要注意一点，在分配显存空间后，模型训练占据的内存要设置好（这个是指实际占用内存，可以通过修改batch_size来控制），不要超出你所分配的大小，不然会有不期望的结果出现。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 import&nbsp;tensorflow as tf &nbsp; # 在开启对话session前，先创建一个 tf.ConfigProto() 实例对象 &nbsp; gpuConfig&nbsp;=&nbsp;tf.ConfigProto(allow_soft_placement=True) &nbsp; # 限制一个进程使用 60% 的显存 gpuConfig.gpu_options.per_process_gpu_memory_fraction&nbsp;=&nbsp;0.6 &nbsp; # 把你的配置部署到session&nbsp; 变量名 sess 无所谓 sess1&nbsp;=tf.Session(config=gpuConfig) &nbsp; &nbsp; #这样，如果你指定的卡的显存是2000M的话，你这个进程只能用1200M。 输出结果（with 1228 MB memory，代表使用1228 MB，这与设置的0.6 * 2000相符） 1 2 Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0&nbsp;with&nbsp;1228&nbsp;MB memory)&nbsp;-&gt; physical GPU (device:&nbsp;0, name: GeForce MX150, pci bus&nbsp;id:&nbsp;0000:01:00.0, compute capability:&nbsp;6.1) 3.解决方法三：多个GPU指定在不同GPU运行 如果你对编程感兴趣或者想往编程方向发展，可以关注微信公众号【筑梦编程】，大家一起交流讨论！小编也会每天定时更新既有趣又有用的编程知识！ &nbsp; 如果条件允许，拥有多个，就可以把不同任务放置在不同GPU上，要注意如果是和同事共用，要约定好如何分配，免得大家都用了同一个。 设置方法与方法一类似。-1代表不使用，0代表第一个，1代表第二个 以两个GPU举例，第一个任务开头可以使用如下，第二个任务就把0改为1，多个GPU方法类似。注意一点要放置在开头位置。 1 2 3 4 5 6 7 8 import&nbsp;os &nbsp; os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]&nbsp;=&nbsp;&#39;0&#39; &nbsp; # 打印 TF 可用的 GPU print(os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]) &nbsp; # -1 表示不使用GPU 0代表第一个 如果多于两个GPU，想在某个任务设置多个GPU，可以使用下述方法 1 2 3 4 5 6 7 8 import &nbsp; os &nbsp; os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]&nbsp; = &nbsp; &#39;0,1&#39; &nbsp; # 打印 TF 可用的 GPU print (os.environ[ &#39;CUDA_VISIBLE_DEVICES&#39; ]) &nbsp; # -1 表示不使用GPU 0代表第一个 最后留个大家一个思考问题，os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;] = &#39;-1,0&#39; 时会怎么样调用？ 欢迎大家在评论区留言发布自己看法和解读。。","@type":"BlogPosting","url":"https://mlh.app/2019/05/17/787053.html","headline":"[开发技巧]·TensorFlow&amp;Keras GPU使用技巧","dateModified":"2019-05-17T00:00:00+08:00","datePublished":"2019-05-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/05/17/787053.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>[开发技巧]·TensorFlow&Keras GPU使用技巧</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <h1>[开发技巧]·TensorFlow&amp;Keras GPU使用技巧</h1> 
  <h3><img alt="" class="has" height="420" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190517104110875.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hpYW9zb25nc2hpbmU=,size_16,color_FFFFFF,t_70" style="border:0px;"></h3> 
  <h2>1.问题描述</h2> 
  <p>在使用TensorFlow&amp;Keras<a href="https://blog.csdn.net/xiaosongshine/article/details/88567519" rel="nofollow">通过GPU进行加速训练</a>时，有时在训练一个任务的时候需要去测试结果，或者是需要并行训练数据的时候就会显示OOM显存容量不足的错误。以下简称在训练一个任务的时候需要去测试结果，或者是需要并行训练数据为进行新的运算任务。</p> 
  <p><strong>首先介绍下TensorFlow&amp;Keras GPU使用的机制：TensorFlow&amp;Keras会在有GPU可以使用时，自动将数据与运算放到GPU进行训练（这个不同于MXNet与<a href="https://blog.csdn.net/xiaosongshine/article/details/89401522" rel="nofollow">PyTorch处理方式不同</a>，MXNet与PyTorch需要手动编程去指定数据与运算的Device，这里不讨论这些方法之间的优劣，选择适合自己的就好了），默认充满GPU所有显存。&nbsp;</strong></p> 
  <p>所以当用户在运行一个运算任务时会占据所有显存，如果再去开启一个新任务就会内存不足，引起OOM显存容量不足的错误。</p> 
  <p>&nbsp;</p> 
  <h2>2.问题分析</h2> 
  <p>通过对上述问题解读，应该可以通过以下的方法解决：</p> 
  <ol>
   <li>当一个训练任务默认占据所有GPU显存的时候，可以使用CPU进行新的任务（这显然不是最优方法，使用CPU进行新的任务速度会很慢）</li> 
   <li>当一个训练任务默认占据所有GPU显存的时候，用户可以设定此任务占用的GPU显存大小，现在再使用GPU进行新的任务时，就可以并行运行了</li> 
   <li>如果有多个GPU可以默认指定任务在不同GPU上。</li> 
  </ol>
  <h2>&nbsp;</h2> 
  <h2>3.使用教程</h2> 
  <p>&nbsp;</p> 
  <h3><strong>1.解决方法一：使用CPU进行新的任务</strong></h3> 
  <p>这不是最优方法，使用CPU进行新的任务速度会很慢，但是也是一种解决方式</p> 
  <div style="color:#000000;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-weight:400;letter-spacing:normal;margin-left:0px;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"> 
   <div class="cnblogs_Highlighter sh-gutter" style="margin-left:0px;"> 
    <div style="margin-left:0px;"> 
     <div class="python syntaxhighlighter" id="highlighter_310136" style="font-size:1em;margin-left:0px;width:669px;"> 
      <table border="1" cellpadding="0" cellspacing="0" style="background:none;border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;width:669px;">
       <tbody style="background:none;border:0px;line-height:1.1em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;">
        <tr style="background:none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;">
         <td class="gutter" style="background:none;border-collapse:collapse;border-color:#C0C0C0;border-style:solid;border-width:1px;color:#afafaf;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;"> 
          <div class="alt2 index0 line number1" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           1
          </div> 
          <div class="alt1 index1 line number2" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           2
          </div> 
          <div class="alt2 index2 line number3" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           3
          </div> 
          <div class="alt1 index3 line number4" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           4
          </div> 
          <div class="alt2 index4 line number5" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           5
          </div> 
          <div class="alt1 index5 line number6" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           6
          </div> 
          <div class="alt2 index6 line number7" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           7
          </div> 
          <div class="alt1 index7 line number8" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           8
          </div> </td> 
         <td class="code" style="background:none;border-collapse:collapse;border-color:#C0C0C0;border-style:solid;border-width:1px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;"> 
          <div style="background:none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;"> 
           <div class="alt2 index0 line number1" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python keyword" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,255);">import</code>
            <span>&nbsp;</span>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">os</code>
           </div> 
           <div class="alt1 index1 line number2" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            &nbsp;
           </div> 
           <div class="alt2 index2 line number3" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">os.environ[</code>
            <code class="python string" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:#0000FF;">'CUDA_VISIBLE_DEVICES'</code>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">]<span>&nbsp;</span></code>
            <code class="python keyword" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,255);">=</code>
            <span>&nbsp;</span>
            <code class="python string" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:#0000FF;">'-1'</code>&nbsp;
           </div> 
           <div class="alt1 index3 line number4" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            &nbsp;
           </div> 
           <div class="alt2 index4 line number5" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python comments" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,130,0);"># 打印 TF 可用的 GPU</code>
           </div> 
           <div class="alt1 index5 line number6" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python functions" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(255,20,147);">print</code>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">(os.environ[</code>
            <code class="python string" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:#0000FF;">'CUDA_VISIBLE_DEVICES'</code>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">])</code>
           </div> 
           <div class="alt2 index6 line number7" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            &nbsp;
           </div> 
           <div class="alt1 index7 line number8" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python comments" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,130,0);"># -1 表示不使用GPU</code>
           </div> 
          </div> </td> 
        </tr>
       </tbody>
      </table>
     </div> 
    </div> 
   </div> 
   <span><img alt="" height="15" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" style="border:0px;" title="点击并拖拽以移动" width="15"></span>
  </div> 
  <h2><strong>2.解决方法二：设定任务占用的GPU显存大小</strong></h2> 
  <p>这个是笔者比较推荐的方式，由于TensorFlow&amp;Keras运行一个运算任务时会占据所有显存，其实有时并没有用到那么多。</p> 
  <p>这样做也会有点小问题就是，单个任务会变慢一点，笔者测试结果是在使用上述方法并行运行两个单个任务速度变为0.8左右，但是换来了可以运行两个任务，还是很值得的。（推测变慢的原因是两个任务并行运算时，对GPU压力更大，每个任务上分配的性能就会降低，类似于在电脑上跑多个任务，电脑会卡顿）</p> 
  <p><strong>这样做要注意一点，在分配显存空间后，模型训练占据的内存要设置好（这个是指实际占用内存，可以通过修改batch_size来控制），不要超出你所分配的大小，不然会有不期望的结果出现。</strong></p> 
  <table border="0" cellpadding="0" cellspacing="0">
   <tbody>
    <tr>
     <td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> <p>9</p> <p>10</p> <p>11</p> <p>12</p> <p>13</p> <p>14</p> </td> 
     <td> <p><code>import</code>&nbsp;<code>tensorflow as tf</code></p> <p>&nbsp;</p> <p><code># 在开启对话session前，先创建一个 tf.ConfigProto() 实例对象</code></p> <p>&nbsp;</p> <p><code>gpuConfig&nbsp;</code><code>=</code>&nbsp;<code>tf.ConfigProto(allow_soft_placement</code><code>=</code><code>True</code><code>)</code></p> <p>&nbsp;</p> <p><code># 限制一个进程使用 60% 的显存</code></p> <p><code>gpuConfig.gpu_options.per_process_gpu_memory_fraction&nbsp;</code><code>=</code>&nbsp;<code>0.6</code></p> <p>&nbsp;</p> <p><code># 把你的配置部署到session&nbsp; 变量名 sess 无所谓</code></p> <p><code>sess1&nbsp;</code><code>=</code><code>tf.Session(config</code><code>=</code><code>gpuConfig)</code></p> <p>&nbsp;</p> <p>&nbsp;</p> <p><code>#这样，如果你指定的卡的显存是2000M的话，你这个进程只能用1200M。</code></p> </td> 
    </tr>
   </tbody>
  </table>
  <div style="color:#000000;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-weight:400;letter-spacing:normal;margin-left:0px;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">
   <span><img alt="" height="15" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" style="border:0px;" title="点击并拖拽以移动" width="15"></span>
  </div> 
  <p>输出结果（with 1228 MB memory，代表使用1228 MB，这与设置的0.6 * 2000相符）</p> 
  <table border="0" cellpadding="0" cellspacing="0">
   <tbody>
    <tr>
     <td> <p>1</p> <p>2</p> </td> 
     <td> <p><code>Created TensorFlow device (</code><code>/</code><code>job:localhost</code><code>/</code><code>replica:</code><code>0</code><code>/</code><code>task:</code><code>0</code><code>/</code><code>device:GPU:</code><code>0</code>&nbsp;<code>with&nbsp;</code><code>1228</code>&nbsp;<code>MB memory)&nbsp;</code><code>-</code><code>&gt;</code></p> <p><code>physical GPU (device:&nbsp;</code><code>0</code><code>, name: GeForce MX150, pci bus&nbsp;</code><code>id</code><code>:&nbsp;</code><code>0000</code><code>:</code><code>01</code><code>:</code><code>00.0</code><code>, compute capability:&nbsp;</code><code>6.1</code><code>)</code></p> </td> 
    </tr>
   </tbody>
  </table>
  <div style="color:#000000;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-weight:400;letter-spacing:normal;margin-left:0px;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">
   <span><img alt="" height="15" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" style="border:0px;" title="点击并拖拽以移动" width="15"></span>
  </div> 
  <h3><strong>3.解决方法三：多个GPU指定在不同GPU运行</strong></h3> 
  <p><strong>如果你对编程感兴趣或者想往编程方向发展，可以关注微信公众号【筑梦编程】，大家一起交流讨论！小编也会每天定时更新既有趣又有用的编程知识！</strong><br> &nbsp;</p> 
  <p>如果条件允许，拥有多个，就可以把不同任务放置在不同GPU上，要注意如果是和同事共用，要约定好如何分配，免得大家都用了同一个。</p> 
  <p>设置方法与方法一类似。-1代表不使用，0代表第一个，1代表第二个</p> 
  <p>以两个GPU举例，第一个任务开头可以使用如下，第二个任务就把0改为1，多个GPU方法类似。注意一点要放置在开头位置。</p> 
  <table border="0" cellpadding="0" cellspacing="0">
   <tbody>
    <tr>
     <td> <p>1</p> <p>2</p> <p>3</p> <p>4</p> <p>5</p> <p>6</p> <p>7</p> <p>8</p> </td> 
     <td> <p><code>import</code>&nbsp;<code>os</code></p> <p>&nbsp;</p> <p><code>os.environ[</code><code>'CUDA_VISIBLE_DEVICES'</code><code>]&nbsp;</code><code>=</code>&nbsp;<code>'0'</code></p> <p>&nbsp;</p> <p><code># 打印 TF 可用的 GPU</code></p> <p><code>print</code><code>(os.environ[</code><code>'CUDA_VISIBLE_DEVICES'</code><code>])</code></p> <p>&nbsp;</p> <p><code># -1 表示不使用GPU 0代表第一个</code></p> </td> 
    </tr>
   </tbody>
  </table>
  <div style="color:#000000;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-weight:400;letter-spacing:normal;margin-left:0px;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">
   <span><img alt="" height="15" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" style="border:0px;" title="点击并拖拽以移动" width="15"></span>
  </div> 
  <p>如果多于两个GPU，想在某个任务设置多个GPU，可以使用下述方法</p> 
  <div style="color:#000000;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-weight:400;letter-spacing:normal;margin-left:0px;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"> 
   <div class="cnblogs_Highlighter sh-gutter" style="margin-left:0px;"> 
    <div style="margin-left:0px;"> 
     <div class="python syntaxhighlighter" id="highlighter_605272" style="font-size:1em;margin-left:0px;width:669px;"> 
      <table border="1" cellpadding="0" cellspacing="0" style="background:none;border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;width:669px;">
       <tbody style="background:none;border:0px;line-height:1.1em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;">
        <tr style="background:none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;">
         <td class="gutter" style="background:none;border-collapse:collapse;border-color:#C0C0C0;border-style:solid;border-width:1px;color:#afafaf;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;"> 
          <div class="alt2 index0 line number1" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           1
          </div> 
          <div class="alt1 index1 line number2" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           2
          </div> 
          <div class="alt2 index2 line number3" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           3
          </div> 
          <div class="alt1 index3 line number4" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           4
          </div> 
          <div class="alt2 index4 line number5" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           5
          </div> 
          <div class="alt1 index5 line number6" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           6
          </div> 
          <div class="alt2 index6 line number7" style="background:#f4f4f4 none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           7
          </div> 
          <div class="alt1 index7 line number8" style="background:#ffffff none;border-right-color:#6ce26c;border-right-style:solid;border-width:0px 2px 0px 0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:right;vertical-align:baseline;">
           8
          </div> </td> 
         <td class="code" style="background:none;border-collapse:collapse;border-color:#C0C0C0;border-style:solid;border-width:1px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;min-height:auto;text-align:left;vertical-align:baseline;"> 
          <div style="background:none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.1em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;"> 
           <div class="alt2 index0 line number1" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python keyword" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,255);">import</code>
            <span>&nbsp;</span>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">os</code>
           </div> 
           <div class="alt1 index1 line number2" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            &nbsp;
           </div> 
           <div class="alt2 index2 line number3" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">os.environ[</code>
            <code class="python string" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:#0000FF;">'CUDA_VISIBLE_DEVICES'</code>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">]<span>&nbsp;</span></code>
            <code class="python keyword" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,255);">=</code>
            <span>&nbsp;</span>
            <code class="python string" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:#0000FF;">'0,1'</code>
           </div> 
           <div class="alt1 index3 line number4" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            &nbsp;
           </div> 
           <div class="alt2 index4 line number5" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python comments" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,130,0);"># 打印 TF 可用的 GPU</code>
           </div> 
           <div class="alt1 index5 line number6" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python functions" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(255,20,147);">print</code>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">(os.environ[</code>
            <code class="python string" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:#0000FF;">'CUDA_VISIBLE_DEVICES'</code>
            <code class="python plain" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,0,0);">])</code>
           </div> 
           <div class="alt2 index6 line number7" style="background:#f4f4f4 none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            &nbsp;
           </div> 
           <div class="alt1 index7 line number8" style="background:#ffffff none;border:0px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;font-style:normal;font-weight:normal;line-height:1.8em;margin-left:0px;min-height:auto;text-align:left;vertical-align:baseline;">
            <code class="python comments" style="background:none;border:0px;line-height:1.8em;text-align:left;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:normal;font-style:normal;font-size:12px;min-height:auto;color:rgb(0,130,0);"># -1 表示不使用GPU 0代表第一个</code>
           </div> 
          </div> </td> 
        </tr>
       </tbody>
      </table>
     </div> 
    </div> 
   </div> 
  </div> 
  <p><strong>最后留个大家一个思考问题，os.environ['CUDA_VISIBLE_DEVICES'] = '-1,0' 时会怎么样调用？</strong></p> 
  <p>欢迎大家在评论区留言发布自己看法和解读。。</p> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
