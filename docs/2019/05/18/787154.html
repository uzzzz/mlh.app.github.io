<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Python计算机视觉编程（九） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Python计算机视觉编程（九）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="knn可视化 knn 算法流程 二维点knn可视化 dense sift原理 手势识别 knn可视化 knn 邻近算法，或者说K最近邻(kNN，k-NearestNeighbor)分类算法是数据挖掘分类技术中最简单的方法之一。kNN算法的核心思想是如果一个样本在特征空间中的k个最相邻的样本中的大多数属于某一个类别，则该样本也属于这个类别，并具有这个类别上样本的特性。 算法流程 准备数据，对数据进行预处理 选用合适的数据结构存储训练数据和测试元组 设定参数，如k 4.维护一个大小为k的的按距离由大到小的优先级队列，用于存储最近邻训练元组。随机从训练元组中选取k个元组作为初始的最近邻元组，分别计算测试元组到这k个元组的距离，将训练元组标号和距离存入优先级队列 遍历训练元组集，计算当前训练元组与测试元组的距离，将所得距离L 与优先级队列中的最大距离Lmax 进行比较。若L&gt;=Lmax，则舍弃该元组，遍历下一个元组。若L &lt; Lmax，删除优先级队列中最大距离的元组，将当前训练元组存入优先级队列。 遍历完毕，计算优先级队列中k 个元组的多数类，并将其作为测试元组的类别。 测试元组集测试完毕后计算误差率，继续设定不同的k值重新进行训练，最后取误差率最小的k 值。 二维点knn可视化 代码实现 创建二维样本数据 # -*- coding: utf-8 -*- from numpy.random import randn import pickle from pylab import * n = 200 class_1 = 0.4 * randn(n,2) class_2 = 1.5 * randn(n,2) + array([8,3]) labels = hstack((ones(n),-ones(n))) with open(&#39;points_normal.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; with open(&#39;points_normal_test.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; class_1 = 0.4 * randn(n,2) r = 0.8 * randn(n,1) + 8 angle = 3*pi * randn(n,1) class_2 = hstack((r*cos(angle),r*sin(angle))) labels = hstack((ones(n),-ones(n))) with open(&#39;points_ring.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; with open(&#39;points_ring_test.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; 可视化 # -*- coding: utf-8 -*- import pickle from pylab import * from PCV.classifiers import knn from PCV.tools import imtools pklist=[&#39;points_normal.pkl&#39;,&#39;points_ring.pkl&#39;] figure() for i, pklfile in enumerate(pklist): with open(pklfile, &#39;r&#39;) as f: class_1 = pickle.load(f) class_2 = pickle.load(f) labels = pickle.load(f) with open(pklfile[:-4]+&#39;_test.pkl&#39;, &#39;r&#39;) as f: class_1 = pickle.load(f) class_2 = pickle.load(f) labels = pickle.load(f) model = knn.KnnClassifier(labels,vstack((class_1,class_2))) print model.classify(class_1[0]) def classify(x,y,model=model): return array([model.classify([xx,yy]) for (xx,yy) in zip(x,y)]) subplot(1,2,i+1) imtools.plot_2D_boundary([-6,6,-6,6],[class_1,class_2],classify,[1,-1]) titlename=pklfile[:-4] title(titlename) show() dense sift原理 一种使用稠密SIFT特征进行目标跟踪的算法.该算法首先将表达目标的矩形区域分成相同大小的矩形块,计算每一个小块的SIFT特征,再对各个小块的稠密SIFT特征在中心位置进行采样,建模目标的表达.然后度量两个图像区域的不相似性,先计算两个区域对应小块的Bhattacharyya距离,再对各距离加权求和作为两个区域间的距离.因为目标所在区域靠近边缘的部分可能受到背景像素的影响,而区域的内部则更一致,所以越靠近区域中心权函数的值越大.最后提出了能适应目标尺度变化的跟踪算法.实验表明,本算法具有良好的性能. 手势的dense sift # -*- coding: utf-8 -*- from PCV.localdescriptors import sift, dsift from pylab import * from PIL import Image dsift.process_image_dsift(&#39;gesture/empire.jpg&#39;,&#39;empire.dsift&#39;,90,40,True) l,d = sift.read_features_from_file(&#39;empire.dsift&#39;) im = array(Image.open(&#39;gesture/empire.jpg&#39;)) sift.plot_features(im,l,True) title(&#39;dense SIFT&#39;) show() 手势识别 我们使用dense sift描述子来表示这些手势图像，并建立一个简单的手势识别系统。用训练数据及其标记作为输入，创建分类器对象。然后在测试集遍历并分类，计算出正确分类数。 使用书上的图片集手势识别测试结果 使用自己拍摄的手势图片，从中每类抽取一张测试 # -*- coding: utf-8 -*- from PCV.localdescriptors import dsift import os from PCV.localdescriptors import sift from pylab import * from PCV.classifiers import knn def get_imagelist(path): return [os.path.join(path,f) for f in os.listdir(path) if f.endswith(&#39;.ppm&#39;)] def read_gesture_features_labels(path): # create list of all files ending in .dsift featlist = [os.path.join(path,f) for f in os.listdir(path) if f.endswith(&#39;.dsift&#39;)] # read the features features = [] for featfile in featlist: l,d = sift.read_features_from_file(featfile) features.append(d.flatten()) features = array(features) # create labels labels = [featfile.split(&#39;/&#39;)[-1][0] for featfile in featlist] return features,array(labels) def print_confusion(res,labels,classnames): n = len(classnames) # confusion matrix class_ind = dict([(classnames[i],i) for i in range(n)]) confuse = zeros((n,n)) for i in range(len(test_labels)): confuse[class_ind[res[i]],class_ind[test_labels[i]]] += 1 print &#39;Confusion matrix for&#39; print classnames print confuse filelist_train = get_imagelist(&#39;gesture/train&#39;) filelist_test = get_imagelist(&#39;gesture/test&#39;) imlist=filelist_train+filelist_test for filename in imlist: featfile = filename[:-3]+&#39;dsift&#39; dsift.process_image_dsift(filename,featfile,10,5,resize=(50,50)) features,labels = read_gesture_features_labels(&#39;gesture/train/&#39;) test_features,test_labels = read_gesture_features_labels(&#39;gesture/test/&#39;) classnames = unique(labels) # test kNN k = 1 knn_classifier = knn.KnnClassifier(labels,features) res = array([knn_classifier.classify(test_features[i],k) for i in range(len(test_labels))]) # accuracy acc = sum(1.0*(res==test_labels)) / len(test_labels) print &#39;Accuracy:&#39;, acc print_confusion(res,test_labels,classnames)" />
<meta property="og:description" content="knn可视化 knn 算法流程 二维点knn可视化 dense sift原理 手势识别 knn可视化 knn 邻近算法，或者说K最近邻(kNN，k-NearestNeighbor)分类算法是数据挖掘分类技术中最简单的方法之一。kNN算法的核心思想是如果一个样本在特征空间中的k个最相邻的样本中的大多数属于某一个类别，则该样本也属于这个类别，并具有这个类别上样本的特性。 算法流程 准备数据，对数据进行预处理 选用合适的数据结构存储训练数据和测试元组 设定参数，如k 4.维护一个大小为k的的按距离由大到小的优先级队列，用于存储最近邻训练元组。随机从训练元组中选取k个元组作为初始的最近邻元组，分别计算测试元组到这k个元组的距离，将训练元组标号和距离存入优先级队列 遍历训练元组集，计算当前训练元组与测试元组的距离，将所得距离L 与优先级队列中的最大距离Lmax 进行比较。若L&gt;=Lmax，则舍弃该元组，遍历下一个元组。若L &lt; Lmax，删除优先级队列中最大距离的元组，将当前训练元组存入优先级队列。 遍历完毕，计算优先级队列中k 个元组的多数类，并将其作为测试元组的类别。 测试元组集测试完毕后计算误差率，继续设定不同的k值重新进行训练，最后取误差率最小的k 值。 二维点knn可视化 代码实现 创建二维样本数据 # -*- coding: utf-8 -*- from numpy.random import randn import pickle from pylab import * n = 200 class_1 = 0.4 * randn(n,2) class_2 = 1.5 * randn(n,2) + array([8,3]) labels = hstack((ones(n),-ones(n))) with open(&#39;points_normal.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; with open(&#39;points_normal_test.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; class_1 = 0.4 * randn(n,2) r = 0.8 * randn(n,1) + 8 angle = 3*pi * randn(n,1) class_2 = hstack((r*cos(angle),r*sin(angle))) labels = hstack((ones(n),-ones(n))) with open(&#39;points_ring.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; with open(&#39;points_ring_test.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; 可视化 # -*- coding: utf-8 -*- import pickle from pylab import * from PCV.classifiers import knn from PCV.tools import imtools pklist=[&#39;points_normal.pkl&#39;,&#39;points_ring.pkl&#39;] figure() for i, pklfile in enumerate(pklist): with open(pklfile, &#39;r&#39;) as f: class_1 = pickle.load(f) class_2 = pickle.load(f) labels = pickle.load(f) with open(pklfile[:-4]+&#39;_test.pkl&#39;, &#39;r&#39;) as f: class_1 = pickle.load(f) class_2 = pickle.load(f) labels = pickle.load(f) model = knn.KnnClassifier(labels,vstack((class_1,class_2))) print model.classify(class_1[0]) def classify(x,y,model=model): return array([model.classify([xx,yy]) for (xx,yy) in zip(x,y)]) subplot(1,2,i+1) imtools.plot_2D_boundary([-6,6,-6,6],[class_1,class_2],classify,[1,-1]) titlename=pklfile[:-4] title(titlename) show() dense sift原理 一种使用稠密SIFT特征进行目标跟踪的算法.该算法首先将表达目标的矩形区域分成相同大小的矩形块,计算每一个小块的SIFT特征,再对各个小块的稠密SIFT特征在中心位置进行采样,建模目标的表达.然后度量两个图像区域的不相似性,先计算两个区域对应小块的Bhattacharyya距离,再对各距离加权求和作为两个区域间的距离.因为目标所在区域靠近边缘的部分可能受到背景像素的影响,而区域的内部则更一致,所以越靠近区域中心权函数的值越大.最后提出了能适应目标尺度变化的跟踪算法.实验表明,本算法具有良好的性能. 手势的dense sift # -*- coding: utf-8 -*- from PCV.localdescriptors import sift, dsift from pylab import * from PIL import Image dsift.process_image_dsift(&#39;gesture/empire.jpg&#39;,&#39;empire.dsift&#39;,90,40,True) l,d = sift.read_features_from_file(&#39;empire.dsift&#39;) im = array(Image.open(&#39;gesture/empire.jpg&#39;)) sift.plot_features(im,l,True) title(&#39;dense SIFT&#39;) show() 手势识别 我们使用dense sift描述子来表示这些手势图像，并建立一个简单的手势识别系统。用训练数据及其标记作为输入，创建分类器对象。然后在测试集遍历并分类，计算出正确分类数。 使用书上的图片集手势识别测试结果 使用自己拍摄的手势图片，从中每类抽取一张测试 # -*- coding: utf-8 -*- from PCV.localdescriptors import dsift import os from PCV.localdescriptors import sift from pylab import * from PCV.classifiers import knn def get_imagelist(path): return [os.path.join(path,f) for f in os.listdir(path) if f.endswith(&#39;.ppm&#39;)] def read_gesture_features_labels(path): # create list of all files ending in .dsift featlist = [os.path.join(path,f) for f in os.listdir(path) if f.endswith(&#39;.dsift&#39;)] # read the features features = [] for featfile in featlist: l,d = sift.read_features_from_file(featfile) features.append(d.flatten()) features = array(features) # create labels labels = [featfile.split(&#39;/&#39;)[-1][0] for featfile in featlist] return features,array(labels) def print_confusion(res,labels,classnames): n = len(classnames) # confusion matrix class_ind = dict([(classnames[i],i) for i in range(n)]) confuse = zeros((n,n)) for i in range(len(test_labels)): confuse[class_ind[res[i]],class_ind[test_labels[i]]] += 1 print &#39;Confusion matrix for&#39; print classnames print confuse filelist_train = get_imagelist(&#39;gesture/train&#39;) filelist_test = get_imagelist(&#39;gesture/test&#39;) imlist=filelist_train+filelist_test for filename in imlist: featfile = filename[:-3]+&#39;dsift&#39; dsift.process_image_dsift(filename,featfile,10,5,resize=(50,50)) features,labels = read_gesture_features_labels(&#39;gesture/train/&#39;) test_features,test_labels = read_gesture_features_labels(&#39;gesture/test/&#39;) classnames = unique(labels) # test kNN k = 1 knn_classifier = knn.KnnClassifier(labels,features) res = array([knn_classifier.classify(test_features[i],k) for i in range(len(test_labels))]) # accuracy acc = sum(1.0*(res==test_labels)) / len(test_labels) print &#39;Accuracy:&#39;, acc print_confusion(res,test_labels,classnames)" />
<link rel="canonical" href="https://mlh.app/2019/05/18/787154.html" />
<meta property="og:url" content="https://mlh.app/2019/05/18/787154.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-18T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"knn可视化 knn 算法流程 二维点knn可视化 dense sift原理 手势识别 knn可视化 knn 邻近算法，或者说K最近邻(kNN，k-NearestNeighbor)分类算法是数据挖掘分类技术中最简单的方法之一。kNN算法的核心思想是如果一个样本在特征空间中的k个最相邻的样本中的大多数属于某一个类别，则该样本也属于这个类别，并具有这个类别上样本的特性。 算法流程 准备数据，对数据进行预处理 选用合适的数据结构存储训练数据和测试元组 设定参数，如k 4.维护一个大小为k的的按距离由大到小的优先级队列，用于存储最近邻训练元组。随机从训练元组中选取k个元组作为初始的最近邻元组，分别计算测试元组到这k个元组的距离，将训练元组标号和距离存入优先级队列 遍历训练元组集，计算当前训练元组与测试元组的距离，将所得距离L 与优先级队列中的最大距离Lmax 进行比较。若L&gt;=Lmax，则舍弃该元组，遍历下一个元组。若L &lt; Lmax，删除优先级队列中最大距离的元组，将当前训练元组存入优先级队列。 遍历完毕，计算优先级队列中k 个元组的多数类，并将其作为测试元组的类别。 测试元组集测试完毕后计算误差率，继续设定不同的k值重新进行训练，最后取误差率最小的k 值。 二维点knn可视化 代码实现 创建二维样本数据 # -*- coding: utf-8 -*- from numpy.random import randn import pickle from pylab import * n = 200 class_1 = 0.4 * randn(n,2) class_2 = 1.5 * randn(n,2) + array([8,3]) labels = hstack((ones(n),-ones(n))) with open(&#39;points_normal.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; with open(&#39;points_normal_test.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; class_1 = 0.4 * randn(n,2) r = 0.8 * randn(n,1) + 8 angle = 3*pi * randn(n,1) class_2 = hstack((r*cos(angle),r*sin(angle))) labels = hstack((ones(n),-ones(n))) with open(&#39;points_ring.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; with open(&#39;points_ring_test.pkl&#39;, &#39;w&#39;) as f: pickle.dump(class_1,f) pickle.dump(class_2,f) pickle.dump(labels,f) print &quot;save OK!&quot; 可视化 # -*- coding: utf-8 -*- import pickle from pylab import * from PCV.classifiers import knn from PCV.tools import imtools pklist=[&#39;points_normal.pkl&#39;,&#39;points_ring.pkl&#39;] figure() for i, pklfile in enumerate(pklist): with open(pklfile, &#39;r&#39;) as f: class_1 = pickle.load(f) class_2 = pickle.load(f) labels = pickle.load(f) with open(pklfile[:-4]+&#39;_test.pkl&#39;, &#39;r&#39;) as f: class_1 = pickle.load(f) class_2 = pickle.load(f) labels = pickle.load(f) model = knn.KnnClassifier(labels,vstack((class_1,class_2))) print model.classify(class_1[0]) def classify(x,y,model=model): return array([model.classify([xx,yy]) for (xx,yy) in zip(x,y)]) subplot(1,2,i+1) imtools.plot_2D_boundary([-6,6,-6,6],[class_1,class_2],classify,[1,-1]) titlename=pklfile[:-4] title(titlename) show() dense sift原理 一种使用稠密SIFT特征进行目标跟踪的算法.该算法首先将表达目标的矩形区域分成相同大小的矩形块,计算每一个小块的SIFT特征,再对各个小块的稠密SIFT特征在中心位置进行采样,建模目标的表达.然后度量两个图像区域的不相似性,先计算两个区域对应小块的Bhattacharyya距离,再对各距离加权求和作为两个区域间的距离.因为目标所在区域靠近边缘的部分可能受到背景像素的影响,而区域的内部则更一致,所以越靠近区域中心权函数的值越大.最后提出了能适应目标尺度变化的跟踪算法.实验表明,本算法具有良好的性能. 手势的dense sift # -*- coding: utf-8 -*- from PCV.localdescriptors import sift, dsift from pylab import * from PIL import Image dsift.process_image_dsift(&#39;gesture/empire.jpg&#39;,&#39;empire.dsift&#39;,90,40,True) l,d = sift.read_features_from_file(&#39;empire.dsift&#39;) im = array(Image.open(&#39;gesture/empire.jpg&#39;)) sift.plot_features(im,l,True) title(&#39;dense SIFT&#39;) show() 手势识别 我们使用dense sift描述子来表示这些手势图像，并建立一个简单的手势识别系统。用训练数据及其标记作为输入，创建分类器对象。然后在测试集遍历并分类，计算出正确分类数。 使用书上的图片集手势识别测试结果 使用自己拍摄的手势图片，从中每类抽取一张测试 # -*- coding: utf-8 -*- from PCV.localdescriptors import dsift import os from PCV.localdescriptors import sift from pylab import * from PCV.classifiers import knn def get_imagelist(path): return [os.path.join(path,f) for f in os.listdir(path) if f.endswith(&#39;.ppm&#39;)] def read_gesture_features_labels(path): # create list of all files ending in .dsift featlist = [os.path.join(path,f) for f in os.listdir(path) if f.endswith(&#39;.dsift&#39;)] # read the features features = [] for featfile in featlist: l,d = sift.read_features_from_file(featfile) features.append(d.flatten()) features = array(features) # create labels labels = [featfile.split(&#39;/&#39;)[-1][0] for featfile in featlist] return features,array(labels) def print_confusion(res,labels,classnames): n = len(classnames) # confusion matrix class_ind = dict([(classnames[i],i) for i in range(n)]) confuse = zeros((n,n)) for i in range(len(test_labels)): confuse[class_ind[res[i]],class_ind[test_labels[i]]] += 1 print &#39;Confusion matrix for&#39; print classnames print confuse filelist_train = get_imagelist(&#39;gesture/train&#39;) filelist_test = get_imagelist(&#39;gesture/test&#39;) imlist=filelist_train+filelist_test for filename in imlist: featfile = filename[:-3]+&#39;dsift&#39; dsift.process_image_dsift(filename,featfile,10,5,resize=(50,50)) features,labels = read_gesture_features_labels(&#39;gesture/train/&#39;) test_features,test_labels = read_gesture_features_labels(&#39;gesture/test/&#39;) classnames = unique(labels) # test kNN k = 1 knn_classifier = knn.KnnClassifier(labels,features) res = array([knn_classifier.classify(test_features[i],k) for i in range(len(test_labels))]) # accuracy acc = sum(1.0*(res==test_labels)) / len(test_labels) print &#39;Accuracy:&#39;, acc print_confusion(res,test_labels,classnames)","@type":"BlogPosting","url":"https://mlh.app/2019/05/18/787154.html","headline":"Python计算机视觉编程（九）","dateModified":"2019-05-18T00:00:00+08:00","datePublished":"2019-05-18T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/05/18/787154.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>Python计算机视觉编程（九）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> 
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path> 
  </svg> 
  <p></p>
  <div class="toc">
   <h3> </h3>
   <ul>
    <li><a href="#knn_1" rel="nofollow">knn可视化</a></li>
    <ul>
     <li><a href="#knn_2" rel="nofollow">knn</a></li>
     <li><a href="#_4" rel="nofollow">算法流程</a></li>
     <li><a href="#knn_13" rel="nofollow">二维点knn可视化</a></li>
    </ul>
    <li><a href="#dense_sift_99" rel="nofollow">dense sift原理</a></li>
    <li><a href="#_119" rel="nofollow">手势识别</a></li>
   </ul>
  </div>
  <p></p> 
  <h1><a id="knn_1"></a>knn可视化</h1> 
  <h2><a id="knn_2"></a>knn</h2> 
  <p>邻近算法，或者说K最近邻(kNN，k-NearestNeighbor)分类算法是数据挖掘分类技术中最简单的方法之一。kNN算法的核心思想是如果一个样本在特征空间中的k个最相邻的样本中的大多数属于某一个类别，则该样本也属于这个类别，并具有这个类别上样本的特性。</p> 
  <h2><a id="_4"></a>算法流程</h2> 
  <ol> 
   <li>准备数据，对数据进行预处理</li> 
   <li>选用合适的数据结构存储训练数据和测试元组</li> 
   <li>设定参数，如k<br> 4.维护一个大小为k的的按距离由大到小的优先级队列，用于存储最近邻训练元组。随机从训练元组中选取k个元组作为初始的最近邻元组，分别计算测试元组到这k个元组的距离，将训练元组标号和距离存入优先级队列</li> 
   <li>遍历训练元组集，计算当前训练元组与测试元组的距离，将所得距离L 与优先级队列中的最大距离Lmax</li> 
   <li>进行比较。若L&gt;=Lmax，则舍弃该元组，遍历下一个元组。若L &lt; Lmax，删除优先级队列中最大距离的元组，将当前训练元组存入优先级队列。</li> 
   <li>遍历完毕，计算优先级队列中k 个元组的多数类，并将其作为测试元组的类别。</li> 
   <li>测试元组集测试完毕后计算误差率，继续设定不同的k值重新进行训练，最后取误差率最小的k 值。</li> 
  </ol> 
  <h2><a id="knn_13"></a>二维点knn可视化</h2> 
  <p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019051821345943.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNDA5MzMx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 代码实现<br> 创建二维样本数据</p> 
  <pre><code class="prism language-javascript"># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token punctuation">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span>
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>random <span class="token keyword">import</span> randn
<span class="token keyword">import</span> pickle
<span class="token keyword">from</span> pylab <span class="token keyword">import</span> <span class="token operator">*</span>

n <span class="token operator">=</span> <span class="token number">200</span>

class_1 <span class="token operator">=</span> <span class="token number">0.4</span> <span class="token operator">*</span> <span class="token function">randn</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
class_2 <span class="token operator">=</span> <span class="token number">1.5</span> <span class="token operator">*</span> <span class="token function">randn</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> <span class="token function">hstack</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'points_normal.pkl'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_1<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_2<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>labels<span class="token punctuation">,</span>f<span class="token punctuation">)</span>

print <span class="token string">"save OK!"</span>

<span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'points_normal_test.pkl'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_1<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_2<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>labels<span class="token punctuation">,</span>f<span class="token punctuation">)</span>

print <span class="token string">"save OK!"</span>

class_1 <span class="token operator">=</span> <span class="token number">0.4</span> <span class="token operator">*</span> <span class="token function">randn</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> <span class="token number">0.8</span> <span class="token operator">*</span> <span class="token function">randn</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span>
angle <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">*</span>pi <span class="token operator">*</span> <span class="token function">randn</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
class_2 <span class="token operator">=</span> <span class="token function">hstack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">,</span>r<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> <span class="token function">hstack</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'points_ring.pkl'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_1<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_2<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>labels<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    
print <span class="token string">"save OK!"</span>

<span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'points_ring_test.pkl'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_1<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>class_2<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    pickle<span class="token punctuation">.</span><span class="token function">dump</span><span class="token punctuation">(</span>labels<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
    
print <span class="token string">"save OK!"</span>
</code></pre> 
  <p>可视化</p> 
  <pre><code class="prism language-javascript"># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token punctuation">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span>
<span class="token keyword">import</span> pickle
<span class="token keyword">from</span> pylab <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token constant">PCV</span><span class="token punctuation">.</span>classifiers <span class="token keyword">import</span> knn
<span class="token keyword">from</span> <span class="token constant">PCV</span><span class="token punctuation">.</span>tools <span class="token keyword">import</span> imtools

pklist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'points_normal.pkl'</span><span class="token punctuation">,</span><span class="token string">'points_ring.pkl'</span><span class="token punctuation">]</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> pklfile <span class="token keyword">in</span> <span class="token function">enumerate</span><span class="token punctuation">(</span>pklist<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span>pklfile<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        class_1 <span class="token operator">=</span> pickle<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        class_2 <span class="token operator">=</span> pickle<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        labels <span class="token operator">=</span> pickle<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>

    <span class="token keyword">with</span> <span class="token function">open</span><span class="token punctuation">(</span>pklfile<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'_test.pkl'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        class_1 <span class="token operator">=</span> pickle<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        class_2 <span class="token operator">=</span> pickle<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        labels <span class="token operator">=</span> pickle<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>

    model <span class="token operator">=</span> knn<span class="token punctuation">.</span><span class="token function">KnnClassifier</span><span class="token punctuation">(</span>labels<span class="token punctuation">,</span><span class="token function">vstack</span><span class="token punctuation">(</span><span class="token punctuation">(</span>class_1<span class="token punctuation">,</span>class_2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    print model<span class="token punctuation">.</span><span class="token function">classify</span><span class="token punctuation">(</span>class_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    def <span class="token function">classify</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>model<span class="token operator">=</span>model<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>model<span class="token punctuation">.</span><span class="token function">classify</span><span class="token punctuation">(</span><span class="token punctuation">[</span>xx<span class="token punctuation">,</span>yy<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>xx<span class="token punctuation">,</span>yy<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token function">zip</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    imtools<span class="token punctuation">.</span><span class="token function">plot_2D_boundary</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>class_1<span class="token punctuation">,</span>class_2<span class="token punctuation">]</span><span class="token punctuation">,</span>classify<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    titlename<span class="token operator">=</span>pklfile<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>
    <span class="token function">title</span><span class="token punctuation">(</span>titlename<span class="token punctuation">)</span>
<span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
  <h1><a id="dense_sift_99"></a>dense sift原理</h1> 
  <p>一种使用稠密SIFT特征进行目标跟踪的算法.该算法首先将表达目标的矩形区域分成相同大小的矩形块,计算每一个小块的SIFT特征,再对各个小块的稠密SIFT特征在中心位置进行采样,建模目标的表达.然后度量两个图像区域的不相似性,先计算两个区域对应小块的Bhattacharyya距离,再对各距离加权求和作为两个区域间的距离.因为目标所在区域靠近边缘的部分可能受到背景像素的影响,而区域的内部则更一致,所以越靠近区域中心权函数的值越大.最后提出了能适应目标尺度变化的跟踪算法.实验表明,本算法具有良好的性能.<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190518220523946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNDA5MzMx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190518220621141.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNDA5MzMx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 手势的dense sift<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190519192150377.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNDA5MzMx,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <pre><code class="prism language-javascript"># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token punctuation">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span>
<span class="token keyword">from</span> <span class="token constant">PCV</span><span class="token punctuation">.</span>localdescriptors <span class="token keyword">import</span> sift<span class="token punctuation">,</span> dsift
<span class="token keyword">from</span> pylab <span class="token keyword">import</span>  <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token constant">PIL</span> <span class="token keyword">import</span> Image

dsift<span class="token punctuation">.</span><span class="token function">process_image_dsift</span><span class="token punctuation">(</span><span class="token string">'gesture/empire.jpg'</span><span class="token punctuation">,</span><span class="token string">'empire.dsift'</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span>True<span class="token punctuation">)</span>
l<span class="token punctuation">,</span>d <span class="token operator">=</span> sift<span class="token punctuation">.</span><span class="token function">read_features_from_file</span><span class="token punctuation">(</span><span class="token string">'empire.dsift'</span><span class="token punctuation">)</span>
im <span class="token operator">=</span> <span class="token function">array</span><span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'gesture/empire.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sift<span class="token punctuation">.</span><span class="token function">plot_features</span><span class="token punctuation">(</span>im<span class="token punctuation">,</span>l<span class="token punctuation">,</span>True<span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'dense SIFT'</span><span class="token punctuation">)</span>
<span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
  <h1><a id="_119"></a>手势识别</h1> 
  <p>我们使用dense sift描述子来表示这些手势图像，并建立一个简单的手势识别系统。用训练数据及其标记作为输入，创建分类器对象。然后在测试集遍历并分类，计算出正确分类数。<br> 使用书上的图片集手势识别测试结果<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190518220306873.png" alt="在这里插入图片描述"><br> 使用自己拍摄的手势图片，从中每类抽取一张测试<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190519193527893.png" alt="在这里插入图片描述"></p> 
  <pre><code class="prism language-javascript"># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token punctuation">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span>
<span class="token keyword">from</span> <span class="token constant">PCV</span><span class="token punctuation">.</span>localdescriptors <span class="token keyword">import</span> dsift
<span class="token keyword">import</span> os
<span class="token keyword">from</span> <span class="token constant">PCV</span><span class="token punctuation">.</span>localdescriptors <span class="token keyword">import</span> sift
<span class="token keyword">from</span> pylab <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token constant">PCV</span><span class="token punctuation">.</span>classifiers <span class="token keyword">import</span> knn

def <span class="token function">get_imagelist</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">return</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>f<span class="token punctuation">)</span> <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span><span class="token function">endswith</span><span class="token punctuation">(</span><span class="token string">'.ppm'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

def <span class="token function">read_gesture_features_labels</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    # create list <span class="token keyword">of</span> all files ending <span class="token keyword">in</span> <span class="token punctuation">.</span>dsift
    featlist <span class="token operator">=</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>f<span class="token punctuation">)</span> <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span><span class="token function">listdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span><span class="token function">endswith</span><span class="token punctuation">(</span><span class="token string">'.dsift'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    # read the features
    features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> featfile <span class="token keyword">in</span> featlist<span class="token punctuation">:</span>
        l<span class="token punctuation">,</span>d <span class="token operator">=</span> sift<span class="token punctuation">.</span><span class="token function">read_features_from_file</span><span class="token punctuation">(</span>featfile<span class="token punctuation">)</span>
        features<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">flatten</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    features <span class="token operator">=</span> <span class="token function">array</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span>
    # create labels
    labels <span class="token operator">=</span> <span class="token punctuation">[</span>featfile<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> featfile <span class="token keyword">in</span> featlist<span class="token punctuation">]</span>
    <span class="token keyword">return</span> features<span class="token punctuation">,</span><span class="token function">array</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span>

def <span class="token function">print_confusion</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span>labels<span class="token punctuation">,</span>classnames<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token function">len</span><span class="token punctuation">(</span>classnames<span class="token punctuation">)</span>
    # confusion matrix
    class_ind <span class="token operator">=</span> <span class="token function">dict</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>classnames<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    confuse <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>test_labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        confuse<span class="token punctuation">[</span>class_ind<span class="token punctuation">[</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>class_ind<span class="token punctuation">[</span>test_labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    print <span class="token string">'Confusion matrix for'</span>
    print classnames
    print confuse

filelist_train <span class="token operator">=</span> <span class="token function">get_imagelist</span><span class="token punctuation">(</span><span class="token string">'gesture/train'</span><span class="token punctuation">)</span>
filelist_test <span class="token operator">=</span> <span class="token function">get_imagelist</span><span class="token punctuation">(</span><span class="token string">'gesture/test'</span><span class="token punctuation">)</span>
imlist<span class="token operator">=</span>filelist_train<span class="token operator">+</span>filelist_test

<span class="token keyword">for</span> filename <span class="token keyword">in</span> imlist<span class="token punctuation">:</span>
    featfile <span class="token operator">=</span> filename<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'dsift'</span>
    dsift<span class="token punctuation">.</span><span class="token function">process_image_dsift</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>featfile<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>resize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

features<span class="token punctuation">,</span>labels <span class="token operator">=</span> <span class="token function">read_gesture_features_labels</span><span class="token punctuation">(</span><span class="token string">'gesture/train/'</span><span class="token punctuation">)</span>
test_features<span class="token punctuation">,</span>test_labels <span class="token operator">=</span> <span class="token function">read_gesture_features_labels</span><span class="token punctuation">(</span><span class="token string">'gesture/test/'</span><span class="token punctuation">)</span>
classnames <span class="token operator">=</span> <span class="token function">unique</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span>

# test kNN
k <span class="token operator">=</span> <span class="token number">1</span>
knn_classifier <span class="token operator">=</span> knn<span class="token punctuation">.</span><span class="token function">KnnClassifier</span><span class="token punctuation">(</span>labels<span class="token punctuation">,</span>features<span class="token punctuation">)</span>
res <span class="token operator">=</span> <span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>knn_classifier<span class="token punctuation">.</span><span class="token function">classify</span><span class="token punctuation">(</span>test_features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span>
<span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>test_labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
# accuracy
acc <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">*</span><span class="token punctuation">(</span>res<span class="token operator">==</span>test_labels<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">len</span><span class="token punctuation">(</span>test_labels<span class="token punctuation">)</span>
print <span class="token string">'Accuracy:'</span><span class="token punctuation">,</span> acc

<span class="token function">print_confusion</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span>test_labels<span class="token punctuation">,</span>classnames<span class="token punctuation">)</span>

</code></pre> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
