<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>李航《统计学习方法》——第八章Boosting提升方法【补充集成学习】+习题答案 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="李航《统计学习方法》——第八章Boosting提升方法【补充集成学习】+习题答案" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="文章目录 一、集成学习 二、Bagging与随机森林 三、Boosting 提升方法 3.1 提升方法的思路和提升方法AdaBoost 3.2 前向分步加法模型与AdaBoost 3.3 提升树【提升树和AdaBoost的关系】 3.3.1 回归提升树 3.3.2 梯度提升树 四 习题 Boosting与AdaBoost可视化解析 一、集成学习   提升方法是一种常用的统计学习方法，是集成学习实现的一种方式，《统计学习方法》只介绍了提升方法的相关知识，本文从集成学习方法开始回顾，形成这部分内容的一个学习框架。   集成学习通过构建并结合多个学习器来完成学习任务，有时也被称为多分类系统，基于委员会的学习等。   如图所示，集成学习的一般结构是，先产生一组“个体学习器”，然后利用某种策略将他们结合起来。个体学习器通常由现有的学习算法从训练数据产生，例如C4.5决策树，BP神经网络等。图示个体学习器只包含同种类型的学习算法，这样的集成成为同质集成，此时，个体学习器成为基学习器，相应的学习算法称为基学习算法。如果集成学习包含不同的个体学习器，也就是用不同的学习算法构成个体学习器，这时称为异质集成，不再有基学习算法，个体学习器称为组件学习器。   一般情况下将多个学习器进行结合可以获得比单一学习器更显著优越的泛化性能。但是集成效果也可能更差，因为个体分类器本身性能问题，因此为了获得好的集成，个体分类器应该“好而不同”，也就是个体学习器要有一定的准确性，并且要有多样性，保证学习器之间有差异。   这时，集成学习涉及几个问题全部出现，1，如何生成个体分类器，根据其生成方式，大致可以分为两大类，即个体学习器间存在强依赖关系，必须串行生成的序列化方法(代表Boosting)，以及个体学习器间不存在强依赖关系，可同时生成的并行化方法(代表Bagging和随机森林)。2，如何衡量个体学习器的多样性，以及如何增强多样性。3，不同个体学习器之间如何结合，结合策略是什么。根据西瓜书集成学习章节总结如下，具体内容参考西瓜书： 二、Bagging与随机森林   欲得到泛化性能强的集成，集成中的个体学习器应尽可能相互独立，“独立“在实任务中无法做到，但是可以设法使基学习器尽可能有较大的差异—&gt;对给定的训练数据集进行取样，产生若干个不同的子集，分别训练基学习器，集成效果较好，但是同时需要保证个体学习器的性能不能太差，如果采样的每个子集都完全不同，则每个基学习器只用到了一小部分训练数据，甚至不足以进行有效学习，因此最终使用有交叠的采样子集。   根据样本抽取方法不同，Bagging可分为： 如果抽取的数据集的随机子集是样例的随机子集，我们叫做 Pasting 。 如果样例抽取是有放回的，我们称为 Bagging 。 如果抽取的数据集的随机子集是特征的随机子集，我们叫做随机子空间 (Random Subspaces)。 最后，如果基估计器构建在对于样本和特征抽取的子集之上时，我们叫做随机补丁 (Random Patches) 。   最终的预测结果，在结合策略中提到了，对于分类任务使用简单投票法,即每个分类器一票进行投票(也可以进行概率平均)；对于回归任务,则采用简单平均获取最终结果,即取所有分类器的平均值。   在多数情况下，bagging 方法提供了一种非常简单的方式来对单一模型进行改进，而无需修改背后的算法。 因为 bagging 方法可以减小过拟合，所以通常在强分类器和复杂模型上使用时表现的很好（例如，完全决策树，fully developed decision trees），相比之下 boosting 方法则在弱模型上表现更好（例如，浅层决策树，shallow decision trees）。   随机森林，是Bagging的一个变体，在一决策树为基学习器构建Bagging集成的基础上，进一步在决策树的训练过程中引入随机属性选择。具体来说，对基决策树的每个节点，（假设有 d d d个属性），先从该节点的属性集合中随机选择一个包含k个属性的子集，然后再从这个子集中选择一个最优属性用于划分，k控制了随机性的引入程度，一般情况下推荐 k = l o g 2 d k=log_2d k=log2​d。   随机森林不仅引入了样本扰动，还引入了属性扰动，因此最终的泛化性能可以通过个体学习器之间的差异度的增加进一步提升。实现简单，计算开销小，性能强大。 三、Boosting 提升方法 3.1 提升方法的思路和提升方法AdaBoost   在PCA框架下，一个概念是强可学习的充要条件是这个概念是弱可学习的。在学习中，找到弱可学习方法比强可学习方法容易得多，所以问题转换为如何将弱可学习方法提升为强可学习方法。大部分提升方法都是改变训练数据的概率分布（训练数据的权值分布），然后针对不同的训练数据分布调用弱学习算法学习一系列弱分类器。   此时有两个问题： 在每一轮如何改变训练数据的权值或概率分布。 【AdaBoost提高那些前一轮被弱分类器错误分类的样本的权值，降低被正确分类的样本的权值。】 如何将弱分类器组合成一个强分类器 【 分类问题：加权多数表决】 AdaBoost算法： 模型：损失函数为指数函数的加法模型 学习策略：极小化加法模型的指数损失 学习算法：前向分步加法算法 输入：训练数据集 T = { ( x 1 , y 1 ) , ( x 2 , y 2 ) , ⋯ &amp;ThinSpace; , ( x N , y N ) } T=\{(x_1,y_1),(x_2,y_2),\cdots,(x_N,y_N)\} T={(x1​,y1​),(x2​,y2​),⋯,(xN​,yN​)};弱学习算法 输出：最终分类器 G ( x ) G(x) G(x) 首先假设训练数据集具有均匀的权值分布 D 1 = ( w 11 , ⋯ &amp;ThinSpace; , w 1 i ⋯ &amp;ThinSpace; , w 1 N ) D_1=(w_{11},\cdots,w_{1i}\cdots,w_{1N}) D1​=(w11​,⋯,w1i​⋯,w1N​), w 1 i = 1 N w_{1i}=\frac{1}{N} w1i​=N1​，即每个训练样本在基本分类器的学习中作用相同，保证第一步在原始数据上能够学习基本分类器 G 1 ( x ) G_1(x) G1​(x) 反复学习基本分类器，假设学习 M M M个基本分类器，对 m = 1 , 2 , ⋯ &amp;ThinSpace; , M m=1,2,\cdots,M m=1,2,⋯,M (a).使用当前分布 D m D_m Dm​ 加权训练数据集，学习基分类器 G m ( x ) G_m(x) Gm​(x) (b)计算基分类器 G m ( x ) G_m(x) Gm​(x)在加权训练数据集上的分类误差率： e m = ∑ i = 1 N P ( G m ( x i ) ≠ y i ) = ∑ i = 1 N w m i I ( G m ( x i ) ≠ y i ) = ∑ G m ( x i ) ≠ y i w m i e_m=\sum_{i=1}^NP(G_m(x_i)\ne y_i)=\sum_{i=1}^Nw_{mi}I(G_m(x_i)\ne y_i)=\sum_{G_m(x_i)\ne y_i}w_{mi} em​=i=1∑N​P(Gm​(xi​)̸​=yi​)=i=1∑N​wmi​I(Gm​(xi​)̸​=yi​)=Gm​(xi​)̸​=yi​∑​wmi​ w m i w_{mi} wmi​表示第 m m m轮中第 i i i个实例的权值， ∑ i = 1 N w m i = 1 \sum_{i=1}^Nw_{mi}=1 ∑i=1N​wmi​=1,这表明， G m ( x ) G_m(x) Gm​(x)在加权的训练数据集上的分类误差率是被 G m ( x ) G_m(x) Gm​(x)误分类样本的权值之和。 （c）计算 G m ( x ) G_m(x) Gm​(x)的系数 α m \alpha_m αm​,表示 G m ( x ) G_m(x) Gm​(x)在最终分类器中的重要性。 α m = 1 2 l n 1 − e m e m \alpha_m=\frac{1}{2}ln\frac{1-e_m}{e_m} αm​=21​lnem​1−em​​当 e m ≤ 1 2 e_m\le\frac{1}{2} em​≤21​时， α m ≥ 0 \alpha_m\ge 0 αm​≥0,并且 α m \alpha_m αm​随着 e m e_m em​的减小而增大，所以分类误差率越小的基分类器在最终分类器中的作用越大。 (d)更新训练数据集的权值分布 D m = ( w m + 1 , 1 , ⋯ &amp;ThinSpace; , w m + 1 , i , ⋯ &amp;ThinSpace; , w m + 1 , N ) w m + 1 , i = w m i Z m e x p ( − α m y i G m ( x i ) ) = { w m i Z m e − α m G m ( x i ) = y i w m i Z m e α m G m ( x i ) ≠ y i D_m=(w_{m+1,1},\cdots,w_{m+1,i},\cdots,w_{m+1,N})\\w_{m+1,i}=\frac{w_{mi}}{Z_m}exp(-\alpha_my_iG_m(x_i))=\left\{ \begin{aligned} \frac{w_{mi}}{Z_m}e^{-\alpha_m}\quad\quad G_m(x_i)=y_i\\ \frac{w_{mi}}{Z_m}e^{\alpha_m}\quad\quad G_m(x_i)\ne y_i \\ \end{aligned} \right. Dm​=(wm+1,1​,⋯,wm+1,i​,⋯,wm+1,N​)wm+1,i​=Zm​wmi​​exp(−αm​yi​Gm​(xi​))=⎩⎪⎨⎪⎧​Zm​wmi​​e−αm​Gm​(xi​)=yi​Zm​wmi​​eαm​Gm​(xi​)̸​=yi​​当 e m ≤ 1 2 e_m\le\frac{1}{2} em​≤21​时， α m ≥ 0 \alpha_m\ge 0 αm​≥0,所以正确分类时，样本权值被缩小，错误分类时，样本权值被增大。 Z m Z_m Zm​是规范因子 Z m = ∑ i = 1 N w m i e x p ( − α m y i G m ( x i ) ) Z_m=\sum_{i=1}^Nw_{mi}exp(-\alpha_my_iG_m(x_i)) Zm​=i=1∑N​wmi​exp(−αm​yi​Gm​(xi​)) 构建基本分类器的线性组合 f ( x ) = ∑ m = 1 M α m G m ( x ) f(x) = \sum_{m=1}^M\alpha_mG_m(x) f(x)=m=1∑M​αm​Gm​(x)得到最终分类器为 G ( x ) = s i g n ( f ( x ) ) G(x) = sign(f(x)) G(x)=sign(f(x)) 3.2 前向分步加法模型与AdaBoost   AdaBoost的另一种解释为：模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。   前向分布算法的目标是训练一个加法模型 f ( x ) = ∑ m = 1 M β m b ( x ; γ m ) f(x)=\sum_{m=1}^M\beta_mb(x;γ_m) f(x)=∑m=1M​βm​b(x;γm​),给定训练数据和损失函数，学习加法模型就变成损失函数最小化问题，通常整体优化比较复杂，所以从前向后，每一步只学习一个基函数及其系数。经过推导，AdaBoost是模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。 3.3 提升树【提升树和AdaBoost的关系】   前向分布算法+决策树（分类树or回归树）=提升树   提升树是以分类树或者回归树为基本分类器的提升方法。分类问题用二叉分类树，回归问题用二叉回归树，最简单的回归树可看做是一个根节点连接的左右子树的二叉树，即所谓的决策树桩。提升树的模型可表示为： f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_M(x) = \sum_{m=1}^MT(x;\Theta_m) fM​(x)=m=1∑M​T(x;Θm​) T ( x ; Θ m ) T(x;\Theta_m) T(x;Θm​)表示决策树， Θ m \Theta_m Θm​表示决策树的参数； M M M表示树的个数。   提升树算法采用前向分布算法，首先确定初始提升树 f 0 ( x ) = 0 f_0(x)=0 f0​(x)=0，第 m m m步的模型是 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ m ) f_m(x) = f_{m-1}(x)+T(x;\Theta_m) fm​(x)=fm−1​(x)+T(x;Θm​)其中 f m − 1 ( x ) f_{m-1}(x) fm−1​(x)为当前模型，通过经验风险极小化确定下一棵决策树的参数 Θ m \Theta_m Θm​ Θ ^ m = a r g m i n Θ m ∑ i = 1 N L ( y i , f m − 1 ( x i ) + T ( x i ; Θ m ) ) \widehat{\Theta}_m = argmin_{\Theta_m}\sum_{i=1}^NL(y_i,f_{m-1}(x_i)+T(x_i;\Theta_m)) Θ m​=argminΘm​​i=1∑N​L(yi​,fm−1​(xi​)+T(xi​;Θm​))  针对不同的问题，提升树有不同的形式，主要区别在于损失函数不同，回归问题：平方误差损失函数；分类问题：指数损失函数；一般决策问题：一般损失函数。分类问题的提升树改变权重，回归问题的提升树拟合残差。损失函数是平方损失函数的时候，残差易求，如果不是平方损失函数也不是指数损失函数，残差就不可求，这时，就要用损失函数关于当前模型 f m − 1 ( x ) f_{m-1}(x) fm−1​(x)的负梯度来近似代替残差。梯度提升算法就是用梯度下降法来讲弱分类器提升为强分类器的算法。 提升树和AdaBoost之间是什么关系？   AdaBoost是提升思想的算法模型,经典的AdaBoost一般用于分类问题，并没有指定基函数，或者说是基分类器，它可以从改变样本的权值的角度和前向分布算法的角度来解释。当确定基函数是回归或分类树时，结合前向分布算法就得出提升树算法。   使用梯度提升进行分类的算法叫做GBDT，进行回归时则叫做GBRT。一般的提升树是用残差来确定树的叶节点的切分，并根据残差来确定该切分下的输出值，而GBDT首先是根据负梯度来确定切分，确定切分后根据线性搜索估计叶节点区域的值，使损失函数极小化。这就好比是寻找一个全局极小值，负梯度只给定一个方向，通过线性搜索确定在该方向下走几步。所以可以认为伪残差是只给出方向的残差。 3.3.1 回归提升树   对于分类问题，只需要将上述的AdaBoost的基学习器限定为二分类树，其余的和上述的AdaBoost内容无差。对于回归问题，可看做是对输入空间 χ χ χ划分为J个不相交的区域，在每个区域上输出的常量为 c j c_j cj​，那么树可以表示为： T ( x ; θ ) = ∑ j = 1 J c j I ( x ∈ R j ) T(x; \theta)=\sum_{j=1}^J c_j I(x \in R_j) T(x;θ)=j=1∑J​cj​I(x∈Rj​)其中 θ = { ( R 1 , c 1 ) , ( R 2 , c 2 ) , . . . , ( R J , c J ) } \theta=\{(R_1, c_1), (R_2, c_2),...,(R_J, c_J)\} θ={(R1​,c1​),(R2​,c2​),...,(RJ​,cJ​)}表示树的区域和区域上的常数，J表示区域的个数,是回归树的复杂度即叶结点的个数。   对于回归树的前向分步式算法有： f 0 ( x ) = 0 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ ) , m = 1 , 2 , . . . , M f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_0(x)=0\\f_m(x)=f_{m-1}(x)+T(x; \Theta), m= 1, 2, ..., M\\f_M(x)=\sum_{m=1}^M T(x;\Theta_m) f0​(x)=0fm​(x)=fm−1​(x)+T(x;Θ),m=1,2,...,MfM​(x)=m=1∑M​T(x;Θm​)在前向分步式算法的第m步，给定 m − 1 m−1 m−1步的情况，需要求解： θ m ∗ = a r g min ⁡ Θ m ∑ i = 1 N L ( y i , f m − 1 ( x i ) + T ( x i ; θ m ) \theta_m^* = arg\min_{\Theta_m}\sum_{i=1}^N L(y_i, f_{m-1}(x_i)+T(x_i; \theta_m) θm∗​=argΘm​min​i=1∑N​L(yi​,fm−1​(xi​)+T(xi​;θm​)得到第 m m m颗树的参数。   这里我们采用平方误差拟合回归问题，则： L ( y , f ( x ) = ( y − f ( x ) ) 2 L(y,f(x)=(y-f(x))^2 L(y,f(x)=(y−f(x))2其损失变为： L ( y , f m − 1 ( x ) + T ( x ; Θ m ) ) = [ y − f m − 1 ( x ) − T ( x : Θ m ) ] 2 = [ r − T ( x ; Θ m ) ] 2 L(y, f_{m-1}(x)+T(x; \Theta_m))=[y-f_{m-1}(x)-T(x: \Theta_m)]^2\\\qquad \qquad =[r-T(x; \Theta_m)]^2 L(y,fm−1​(x)+T(x;Θm​))=[y−fm−1​(x)−T(x:Θm​)]2=[r−T(x;Θm​)]2其中 r = y − f m − 1 ( x ) r=y−f_{m−1}(x) r=y−fm−1​(x)是当前拟合的残差，而目前我们的学习任务也仅仅是拟合这个残差,整个算法的步骤： (1). 初始化 f 0 ( x ) = 0 f_0(x)=0 f0​(x)=0 (2). 对 m = 1 , 2 ⋯ &amp;ThinSpace; , M m=1,2\cdots,M m=1,2⋯,M \quad\quad a. 计算残差 r = y − f m − 1 ( x ) r=y−f_{m−1}(x) r=y−fm−1​(x) \quad\quad b. 拟合残差，学习一个回归树，得到 T ( x ; Θ ) T(x; \Theta) T(x;Θ) \quad\quad c. 更新 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ ) f_m(x)=f_{m-1}(x)+T(x; \Theta) fm​(x)=fm−1​(x)+T(x;Θ) (3). 得到回归提升树 f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_M(x)=\sum_{m=1}^MT(x;\Theta_m) fM​(x)=m=1∑M​T(x;Θm​) 3.3.2 梯度提升树   前面用到的损失函数都有比较好的性质，如平方误差、指数函数等，但对于一般的函数来说，问题可能会变得复杂些，针对这一问题Freidman提出了梯度提升（Gradient Boosting），这是利用最速下降的近似方法，其关键是利用损失函数的负梯度在当前模型的值 − [ ∂ L ( y , f ( x i ) ) ∂ f ( x i ) ] f ( x ) = f m − 1 ( x ) -\Biggl[{\partial L(y,f(x_i)) \over \partial f(x_i)}\Biggr]_{f(x)=f_{m-1}(x)} −[∂f(xi​)∂L(y,f(xi​))​]f(x)=fm−1​(x)​作为近似残差，拟合一个回归树。 算法步骤： (1). 初始化 f 0 ( x ) = a r g min ⁡ c ∑ i = 1 N L ( y i , c ) f_0(x)=arg\min_c\sum_{i=1}^N L(y_i, c) f0​(x)=argcmin​i=1∑N​L(yi​,c)估计使损失函数极小化的常数值，是只有一个根节点的树。 (2). 对 m = 1 , 2 ⋯ &amp;ThinSpace; , M : m=1,2\cdots,M: m=1,2⋯,M: \quad\quad a . 对于 i = 1 , 2 , . . . , N i=1,2,...,N i=1,2,...,N, 计算 r m i = − [ ∂ L ( y , f ( x i ) ) ∂ f ( x i ) ] f ( x ) = f m − 1 ( x ) r_{mi}=-\Biggl[{\partial L(y,f(x_i)) \over \partial f(x_i)}\Biggr]_{f(x)=f_{m-1}(x)} rmi​=−[∂f(xi​)∂L(y,f(xi​))​]f(x)=fm−1​(x)​损失函数的负梯度在当前模型的值，将其作为残差的估计。当损失函数是平方损失函数的时候，负梯度为 2 ( y − f ( x ) ) ∣ f m − 1 ( x ) = 2 ( y − f m − 1 ( x ) ) 2(y-f(x))| f_{m-1}(x)=2(y-f_{m-1}(x)) 2(y−f(x))∣fm−1​(x)=2(y−fm−1​(x)),文章说也就是通常所说的残差，这个2倍关系是我计算错了吗？ \quad\quad b . 拟合 r m i r_{mi} rmi​，学习一个回归树的叶节点区域 R m j , j = 1 , 2 , . . . , J R_{mj},j=1,2,...,J Rmj​,j=1,2,...,J \quad\quad c.对 j = 1 , 2 , . . . , J j=1,2,...,J j=1,2,...,J计算 c m j = a r g min ⁡ c ∑ x i ∈ R m j L ( y i , f m − 1 ( x i ) + c ) c_{mj}=arg\min_c\sum_{x_i \in R_{mj}} L(y_i, f_{m-1}(x_i)+c) cmj​=argcmin​xi​∈Rmj​∑​L(yi​,fm−1​(xi​)+c)利用线性搜索估计叶结点区域的值，使损失函数极小化。 \quad\quad d.更新 f m ( x ) = f m − 1 ( x ) + ∑ j = 1 J c m j I ( x ∈ R m j ) f_m(x)=f_{m-1}(x)+\sum_{j=1}^J c_{mj}I(x \in R_{mj}) fm​(x)=fm−1​(x)+j=1∑J​cmj​I(x∈Rmj​)(3). 得到回归树： f ( x ) ∗ = f M ( x ) = ∑ m = 1 M ∑ j = 1 J c m j I ( x ∈ R m j ) f(x)^*=f_M(x)=\sum_{m=1}^M\sum_{j=1}^J c_{mj}I(x \in R_{mj}) f(x)∗=fM​(x)=m=1∑M​j=1∑J​cmj​I(x∈Rmj​) 四 习题 8.1 某公司招聘支援考查身体、业务能力、发展潜力这三项。身体分为合格1、不合格0两级，业务能力和发展潜力分为上1，中2，下3三级。分类为合格1，不合格-1两类。已知10个人的数据，如下表所示，假设弱分类器为决策树桩，试用AdaBoost算法学习一个强分类器。 应聘人员情况数据表 1 2 3 4 5 6 7 8 9 10 身体 0 0 1 1 1 0 1 1 1 0 业务 1 3 2 1 2 1 1 1 3 2 潜力 3 1 2 3 3 2 2 1 1 1 分类 -1 -1 -1 -1 -1 -1 1 1 -1 -1 from numpy import * # adaBoost算法 # 决策树桩仅分裂一次，也就是说只选择一次特征 # 决策树桩由三部分组成，特征，特征值，不等号的方向 # 读入数据 def loadData(): dataMat = matrix([[0. , 1. , 3.], [0. , 3. , 1.], [1. , 2. , 2.], [1. , 1. , 3.], [1. , 2. , 3.], [0. , 1. , 2.], [1. , 1. , 2.], [1. , 1. , 1.], [1. , 3. , 1.], [0. , 2. , 1.]]) classLabels = matrix([-1.0, -1.0,-1.0, -1.0, -1.0, -1.0,1.0, 1.0, -1.0 , -1.0]).T return dataMat, classLabels # 根据当前树桩对数据进行分类 def stumpClassify(dataMatrix, dimen, threshVal, threshIneq): retArray = ones((shape(dataMatrix)[0], 1))#预测矩阵 #左叶子 ，整个矩阵的样本进行比较赋值 if threshIneq == &#39;lt&#39;: retArray[dataMatrix[:, dimen] &lt;= threshVal] = -1.0 else: retArray[dataMatrix[:, dimen] &gt; threshVal] = -1.0 return retArray &#39;&#39;&#39; # 根据数据，标签和权值分布构造弱分类器，即决策树桩 stump 树桩 # D为数据权重向量 # numStep是步数，据此可算出步长， bestClassEst是最优情况下的分类情况 构造树桩要做的是： 选择合适的特征，选择合适的阈值 bestStump[&#39;dim&#39;] 合适的特征所在维度 bestStump[&#39;thresh&#39;] 合适特征的阈值 bestStump[&#39;ineq&#39;] &#39;&#39;&#39; def buildStump(dataMatrix, classLabels, D): m, n = shape(dataMatrix) numStep = 10.0 bestStump = {} #字典 minError = inf bestClasEst = mat(ones((m, 1))) #n是特征的种类数 for i in range(n): rangeMin = dataMatrix[:, i].min() #求每一种特征的最大最小值 rangeMax = dataMatrix[:, i].max() stepSize = (rangeMax-rangeMin)/numStep for j in range(-1, int(numStep)+1): threshVal = rangeMin + j*stepSize #不知左树-1准确率高还是右树，因此有这样一个计算 for inequal in [&#39;lt&#39;, &#39;rt&#39;]: predictVals = stumpClassify(dataMatrix, i, threshVal, inequal) errArr = mat(ones((m, 1))) errArr[predictVals == classLabels] = 0 weightedError = D.T*errArr if weightedError &lt; minError: minError = weightedError bestClassEst = predictVals bestStump[&#39;dim&#39;] = i bestStump[&#39;thresh&#39;] = threshVal bestStump[&#39;ineq&#39;] = inequal return bestStump, minError, bestClassEst # adaBoost训练过程 def adaBoostTrain(dataMatrix, classLabels, numIter=40): weakClassArr = [] #弱分类器 m = shape(dataMatrix)[0] #样本个数 D = mat(ones((m, 1))/m) #一开始是均值权重分布 aggClassEst = mat(zeros((m, 1))) for i in range(numIter): #numIter 弱分类器的个数 bestStump, error, classEst = buildStump(dataMatrix, classLabels, D) # 防止除以零溢出 alpha = float(0.5*log((1-error)/max(error, 1e-16))) bestStump[&#39;alpha&#39;] = alpha weakClassArr.append(bestStump) expon = multiply(-1*alpha*classLabels, classEst) D = multiply(D, exp(expon)) D /= D.sum() aggClassEst += alpha*classEst #弱分类器结果的求和 # 比较两个矩阵的值得出预测正误情况 aggError = sign(aggClassEst) != classLabels errorRate = aggError.sum()/m print(errorRate) if errorRate == 0.0: break return weakClassArr def adaClassify(dataMatrix, classifierArr): m = shape(dataMatrix)[0] aggClassEst = mat(zeros((m, 1))) for i in range(len(classifierArr)): stump = classifierArr[i] classEst = stumpClassify(dataMatrix, stump[&#39;dim&#39;], stump[&#39;thresh&#39;], stump[&#39;ineq&#39;]) aggClassEst += stump[&#39;alpha&#39;]*classEst return sign(aggClassEst) dataMat, classLabels = loadData() classifiers = adaBoostTrain(dataMat, classLabels, 9) labels = adaClassify(mat([1,2,3]), classifiers) print(labels) print(&#39;dim\tthresh\tinep\talpha&#39;) for i in range(6): print(str(classifiers[i][&#39;dim&#39;])+&#39;\t&#39;+str(classifiers[i][&#39;thresh&#39;]) +&#39;\t&#39;+str(classifiers[i][&#39;ineq&#39;])+&#39;\t&#39;+str(classifiers[i][&#39;alpha&#39;])) 前面6行是误差率，[-1]是对第5个样本的预测，dim表示特征维度，thresh表示划分阈值，inep左树还是右树准确率高。 8.2 比较支持向量机，AdaBoost，逻辑斯蒂回归模型的学习策略与算法。 策略 算法 支持向量机 极小化正则化合页损失，软间隔最大化 序列最小最优化（SMO） 逻辑斯蒂回归模型 极大对数似然函数，正则化的极大似然估计 改进的迭代尺度算法，梯度下降，拟牛顿 AdaBoost 极小化加法模型的指数损失 前向分步加法算法" />
<meta property="og:description" content="文章目录 一、集成学习 二、Bagging与随机森林 三、Boosting 提升方法 3.1 提升方法的思路和提升方法AdaBoost 3.2 前向分步加法模型与AdaBoost 3.3 提升树【提升树和AdaBoost的关系】 3.3.1 回归提升树 3.3.2 梯度提升树 四 习题 Boosting与AdaBoost可视化解析 一、集成学习   提升方法是一种常用的统计学习方法，是集成学习实现的一种方式，《统计学习方法》只介绍了提升方法的相关知识，本文从集成学习方法开始回顾，形成这部分内容的一个学习框架。   集成学习通过构建并结合多个学习器来完成学习任务，有时也被称为多分类系统，基于委员会的学习等。   如图所示，集成学习的一般结构是，先产生一组“个体学习器”，然后利用某种策略将他们结合起来。个体学习器通常由现有的学习算法从训练数据产生，例如C4.5决策树，BP神经网络等。图示个体学习器只包含同种类型的学习算法，这样的集成成为同质集成，此时，个体学习器成为基学习器，相应的学习算法称为基学习算法。如果集成学习包含不同的个体学习器，也就是用不同的学习算法构成个体学习器，这时称为异质集成，不再有基学习算法，个体学习器称为组件学习器。   一般情况下将多个学习器进行结合可以获得比单一学习器更显著优越的泛化性能。但是集成效果也可能更差，因为个体分类器本身性能问题，因此为了获得好的集成，个体分类器应该“好而不同”，也就是个体学习器要有一定的准确性，并且要有多样性，保证学习器之间有差异。   这时，集成学习涉及几个问题全部出现，1，如何生成个体分类器，根据其生成方式，大致可以分为两大类，即个体学习器间存在强依赖关系，必须串行生成的序列化方法(代表Boosting)，以及个体学习器间不存在强依赖关系，可同时生成的并行化方法(代表Bagging和随机森林)。2，如何衡量个体学习器的多样性，以及如何增强多样性。3，不同个体学习器之间如何结合，结合策略是什么。根据西瓜书集成学习章节总结如下，具体内容参考西瓜书： 二、Bagging与随机森林   欲得到泛化性能强的集成，集成中的个体学习器应尽可能相互独立，“独立“在实任务中无法做到，但是可以设法使基学习器尽可能有较大的差异—&gt;对给定的训练数据集进行取样，产生若干个不同的子集，分别训练基学习器，集成效果较好，但是同时需要保证个体学习器的性能不能太差，如果采样的每个子集都完全不同，则每个基学习器只用到了一小部分训练数据，甚至不足以进行有效学习，因此最终使用有交叠的采样子集。   根据样本抽取方法不同，Bagging可分为： 如果抽取的数据集的随机子集是样例的随机子集，我们叫做 Pasting 。 如果样例抽取是有放回的，我们称为 Bagging 。 如果抽取的数据集的随机子集是特征的随机子集，我们叫做随机子空间 (Random Subspaces)。 最后，如果基估计器构建在对于样本和特征抽取的子集之上时，我们叫做随机补丁 (Random Patches) 。   最终的预测结果，在结合策略中提到了，对于分类任务使用简单投票法,即每个分类器一票进行投票(也可以进行概率平均)；对于回归任务,则采用简单平均获取最终结果,即取所有分类器的平均值。   在多数情况下，bagging 方法提供了一种非常简单的方式来对单一模型进行改进，而无需修改背后的算法。 因为 bagging 方法可以减小过拟合，所以通常在强分类器和复杂模型上使用时表现的很好（例如，完全决策树，fully developed decision trees），相比之下 boosting 方法则在弱模型上表现更好（例如，浅层决策树，shallow decision trees）。   随机森林，是Bagging的一个变体，在一决策树为基学习器构建Bagging集成的基础上，进一步在决策树的训练过程中引入随机属性选择。具体来说，对基决策树的每个节点，（假设有 d d d个属性），先从该节点的属性集合中随机选择一个包含k个属性的子集，然后再从这个子集中选择一个最优属性用于划分，k控制了随机性的引入程度，一般情况下推荐 k = l o g 2 d k=log_2d k=log2​d。   随机森林不仅引入了样本扰动，还引入了属性扰动，因此最终的泛化性能可以通过个体学习器之间的差异度的增加进一步提升。实现简单，计算开销小，性能强大。 三、Boosting 提升方法 3.1 提升方法的思路和提升方法AdaBoost   在PCA框架下，一个概念是强可学习的充要条件是这个概念是弱可学习的。在学习中，找到弱可学习方法比强可学习方法容易得多，所以问题转换为如何将弱可学习方法提升为强可学习方法。大部分提升方法都是改变训练数据的概率分布（训练数据的权值分布），然后针对不同的训练数据分布调用弱学习算法学习一系列弱分类器。   此时有两个问题： 在每一轮如何改变训练数据的权值或概率分布。 【AdaBoost提高那些前一轮被弱分类器错误分类的样本的权值，降低被正确分类的样本的权值。】 如何将弱分类器组合成一个强分类器 【 分类问题：加权多数表决】 AdaBoost算法： 模型：损失函数为指数函数的加法模型 学习策略：极小化加法模型的指数损失 学习算法：前向分步加法算法 输入：训练数据集 T = { ( x 1 , y 1 ) , ( x 2 , y 2 ) , ⋯ &amp;ThinSpace; , ( x N , y N ) } T=\{(x_1,y_1),(x_2,y_2),\cdots,(x_N,y_N)\} T={(x1​,y1​),(x2​,y2​),⋯,(xN​,yN​)};弱学习算法 输出：最终分类器 G ( x ) G(x) G(x) 首先假设训练数据集具有均匀的权值分布 D 1 = ( w 11 , ⋯ &amp;ThinSpace; , w 1 i ⋯ &amp;ThinSpace; , w 1 N ) D_1=(w_{11},\cdots,w_{1i}\cdots,w_{1N}) D1​=(w11​,⋯,w1i​⋯,w1N​), w 1 i = 1 N w_{1i}=\frac{1}{N} w1i​=N1​，即每个训练样本在基本分类器的学习中作用相同，保证第一步在原始数据上能够学习基本分类器 G 1 ( x ) G_1(x) G1​(x) 反复学习基本分类器，假设学习 M M M个基本分类器，对 m = 1 , 2 , ⋯ &amp;ThinSpace; , M m=1,2,\cdots,M m=1,2,⋯,M (a).使用当前分布 D m D_m Dm​ 加权训练数据集，学习基分类器 G m ( x ) G_m(x) Gm​(x) (b)计算基分类器 G m ( x ) G_m(x) Gm​(x)在加权训练数据集上的分类误差率： e m = ∑ i = 1 N P ( G m ( x i ) ≠ y i ) = ∑ i = 1 N w m i I ( G m ( x i ) ≠ y i ) = ∑ G m ( x i ) ≠ y i w m i e_m=\sum_{i=1}^NP(G_m(x_i)\ne y_i)=\sum_{i=1}^Nw_{mi}I(G_m(x_i)\ne y_i)=\sum_{G_m(x_i)\ne y_i}w_{mi} em​=i=1∑N​P(Gm​(xi​)̸​=yi​)=i=1∑N​wmi​I(Gm​(xi​)̸​=yi​)=Gm​(xi​)̸​=yi​∑​wmi​ w m i w_{mi} wmi​表示第 m m m轮中第 i i i个实例的权值， ∑ i = 1 N w m i = 1 \sum_{i=1}^Nw_{mi}=1 ∑i=1N​wmi​=1,这表明， G m ( x ) G_m(x) Gm​(x)在加权的训练数据集上的分类误差率是被 G m ( x ) G_m(x) Gm​(x)误分类样本的权值之和。 （c）计算 G m ( x ) G_m(x) Gm​(x)的系数 α m \alpha_m αm​,表示 G m ( x ) G_m(x) Gm​(x)在最终分类器中的重要性。 α m = 1 2 l n 1 − e m e m \alpha_m=\frac{1}{2}ln\frac{1-e_m}{e_m} αm​=21​lnem​1−em​​当 e m ≤ 1 2 e_m\le\frac{1}{2} em​≤21​时， α m ≥ 0 \alpha_m\ge 0 αm​≥0,并且 α m \alpha_m αm​随着 e m e_m em​的减小而增大，所以分类误差率越小的基分类器在最终分类器中的作用越大。 (d)更新训练数据集的权值分布 D m = ( w m + 1 , 1 , ⋯ &amp;ThinSpace; , w m + 1 , i , ⋯ &amp;ThinSpace; , w m + 1 , N ) w m + 1 , i = w m i Z m e x p ( − α m y i G m ( x i ) ) = { w m i Z m e − α m G m ( x i ) = y i w m i Z m e α m G m ( x i ) ≠ y i D_m=(w_{m+1,1},\cdots,w_{m+1,i},\cdots,w_{m+1,N})\\w_{m+1,i}=\frac{w_{mi}}{Z_m}exp(-\alpha_my_iG_m(x_i))=\left\{ \begin{aligned} \frac{w_{mi}}{Z_m}e^{-\alpha_m}\quad\quad G_m(x_i)=y_i\\ \frac{w_{mi}}{Z_m}e^{\alpha_m}\quad\quad G_m(x_i)\ne y_i \\ \end{aligned} \right. Dm​=(wm+1,1​,⋯,wm+1,i​,⋯,wm+1,N​)wm+1,i​=Zm​wmi​​exp(−αm​yi​Gm​(xi​))=⎩⎪⎨⎪⎧​Zm​wmi​​e−αm​Gm​(xi​)=yi​Zm​wmi​​eαm​Gm​(xi​)̸​=yi​​当 e m ≤ 1 2 e_m\le\frac{1}{2} em​≤21​时， α m ≥ 0 \alpha_m\ge 0 αm​≥0,所以正确分类时，样本权值被缩小，错误分类时，样本权值被增大。 Z m Z_m Zm​是规范因子 Z m = ∑ i = 1 N w m i e x p ( − α m y i G m ( x i ) ) Z_m=\sum_{i=1}^Nw_{mi}exp(-\alpha_my_iG_m(x_i)) Zm​=i=1∑N​wmi​exp(−αm​yi​Gm​(xi​)) 构建基本分类器的线性组合 f ( x ) = ∑ m = 1 M α m G m ( x ) f(x) = \sum_{m=1}^M\alpha_mG_m(x) f(x)=m=1∑M​αm​Gm​(x)得到最终分类器为 G ( x ) = s i g n ( f ( x ) ) G(x) = sign(f(x)) G(x)=sign(f(x)) 3.2 前向分步加法模型与AdaBoost   AdaBoost的另一种解释为：模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。   前向分布算法的目标是训练一个加法模型 f ( x ) = ∑ m = 1 M β m b ( x ; γ m ) f(x)=\sum_{m=1}^M\beta_mb(x;γ_m) f(x)=∑m=1M​βm​b(x;γm​),给定训练数据和损失函数，学习加法模型就变成损失函数最小化问题，通常整体优化比较复杂，所以从前向后，每一步只学习一个基函数及其系数。经过推导，AdaBoost是模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。 3.3 提升树【提升树和AdaBoost的关系】   前向分布算法+决策树（分类树or回归树）=提升树   提升树是以分类树或者回归树为基本分类器的提升方法。分类问题用二叉分类树，回归问题用二叉回归树，最简单的回归树可看做是一个根节点连接的左右子树的二叉树，即所谓的决策树桩。提升树的模型可表示为： f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_M(x) = \sum_{m=1}^MT(x;\Theta_m) fM​(x)=m=1∑M​T(x;Θm​) T ( x ; Θ m ) T(x;\Theta_m) T(x;Θm​)表示决策树， Θ m \Theta_m Θm​表示决策树的参数； M M M表示树的个数。   提升树算法采用前向分布算法，首先确定初始提升树 f 0 ( x ) = 0 f_0(x)=0 f0​(x)=0，第 m m m步的模型是 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ m ) f_m(x) = f_{m-1}(x)+T(x;\Theta_m) fm​(x)=fm−1​(x)+T(x;Θm​)其中 f m − 1 ( x ) f_{m-1}(x) fm−1​(x)为当前模型，通过经验风险极小化确定下一棵决策树的参数 Θ m \Theta_m Θm​ Θ ^ m = a r g m i n Θ m ∑ i = 1 N L ( y i , f m − 1 ( x i ) + T ( x i ; Θ m ) ) \widehat{\Theta}_m = argmin_{\Theta_m}\sum_{i=1}^NL(y_i,f_{m-1}(x_i)+T(x_i;\Theta_m)) Θ m​=argminΘm​​i=1∑N​L(yi​,fm−1​(xi​)+T(xi​;Θm​))  针对不同的问题，提升树有不同的形式，主要区别在于损失函数不同，回归问题：平方误差损失函数；分类问题：指数损失函数；一般决策问题：一般损失函数。分类问题的提升树改变权重，回归问题的提升树拟合残差。损失函数是平方损失函数的时候，残差易求，如果不是平方损失函数也不是指数损失函数，残差就不可求，这时，就要用损失函数关于当前模型 f m − 1 ( x ) f_{m-1}(x) fm−1​(x)的负梯度来近似代替残差。梯度提升算法就是用梯度下降法来讲弱分类器提升为强分类器的算法。 提升树和AdaBoost之间是什么关系？   AdaBoost是提升思想的算法模型,经典的AdaBoost一般用于分类问题，并没有指定基函数，或者说是基分类器，它可以从改变样本的权值的角度和前向分布算法的角度来解释。当确定基函数是回归或分类树时，结合前向分布算法就得出提升树算法。   使用梯度提升进行分类的算法叫做GBDT，进行回归时则叫做GBRT。一般的提升树是用残差来确定树的叶节点的切分，并根据残差来确定该切分下的输出值，而GBDT首先是根据负梯度来确定切分，确定切分后根据线性搜索估计叶节点区域的值，使损失函数极小化。这就好比是寻找一个全局极小值，负梯度只给定一个方向，通过线性搜索确定在该方向下走几步。所以可以认为伪残差是只给出方向的残差。 3.3.1 回归提升树   对于分类问题，只需要将上述的AdaBoost的基学习器限定为二分类树，其余的和上述的AdaBoost内容无差。对于回归问题，可看做是对输入空间 χ χ χ划分为J个不相交的区域，在每个区域上输出的常量为 c j c_j cj​，那么树可以表示为： T ( x ; θ ) = ∑ j = 1 J c j I ( x ∈ R j ) T(x; \theta)=\sum_{j=1}^J c_j I(x \in R_j) T(x;θ)=j=1∑J​cj​I(x∈Rj​)其中 θ = { ( R 1 , c 1 ) , ( R 2 , c 2 ) , . . . , ( R J , c J ) } \theta=\{(R_1, c_1), (R_2, c_2),...,(R_J, c_J)\} θ={(R1​,c1​),(R2​,c2​),...,(RJ​,cJ​)}表示树的区域和区域上的常数，J表示区域的个数,是回归树的复杂度即叶结点的个数。   对于回归树的前向分步式算法有： f 0 ( x ) = 0 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ ) , m = 1 , 2 , . . . , M f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_0(x)=0\\f_m(x)=f_{m-1}(x)+T(x; \Theta), m= 1, 2, ..., M\\f_M(x)=\sum_{m=1}^M T(x;\Theta_m) f0​(x)=0fm​(x)=fm−1​(x)+T(x;Θ),m=1,2,...,MfM​(x)=m=1∑M​T(x;Θm​)在前向分步式算法的第m步，给定 m − 1 m−1 m−1步的情况，需要求解： θ m ∗ = a r g min ⁡ Θ m ∑ i = 1 N L ( y i , f m − 1 ( x i ) + T ( x i ; θ m ) \theta_m^* = arg\min_{\Theta_m}\sum_{i=1}^N L(y_i, f_{m-1}(x_i)+T(x_i; \theta_m) θm∗​=argΘm​min​i=1∑N​L(yi​,fm−1​(xi​)+T(xi​;θm​)得到第 m m m颗树的参数。   这里我们采用平方误差拟合回归问题，则： L ( y , f ( x ) = ( y − f ( x ) ) 2 L(y,f(x)=(y-f(x))^2 L(y,f(x)=(y−f(x))2其损失变为： L ( y , f m − 1 ( x ) + T ( x ; Θ m ) ) = [ y − f m − 1 ( x ) − T ( x : Θ m ) ] 2 = [ r − T ( x ; Θ m ) ] 2 L(y, f_{m-1}(x)+T(x; \Theta_m))=[y-f_{m-1}(x)-T(x: \Theta_m)]^2\\\qquad \qquad =[r-T(x; \Theta_m)]^2 L(y,fm−1​(x)+T(x;Θm​))=[y−fm−1​(x)−T(x:Θm​)]2=[r−T(x;Θm​)]2其中 r = y − f m − 1 ( x ) r=y−f_{m−1}(x) r=y−fm−1​(x)是当前拟合的残差，而目前我们的学习任务也仅仅是拟合这个残差,整个算法的步骤： (1). 初始化 f 0 ( x ) = 0 f_0(x)=0 f0​(x)=0 (2). 对 m = 1 , 2 ⋯ &amp;ThinSpace; , M m=1,2\cdots,M m=1,2⋯,M \quad\quad a. 计算残差 r = y − f m − 1 ( x ) r=y−f_{m−1}(x) r=y−fm−1​(x) \quad\quad b. 拟合残差，学习一个回归树，得到 T ( x ; Θ ) T(x; \Theta) T(x;Θ) \quad\quad c. 更新 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ ) f_m(x)=f_{m-1}(x)+T(x; \Theta) fm​(x)=fm−1​(x)+T(x;Θ) (3). 得到回归提升树 f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_M(x)=\sum_{m=1}^MT(x;\Theta_m) fM​(x)=m=1∑M​T(x;Θm​) 3.3.2 梯度提升树   前面用到的损失函数都有比较好的性质，如平方误差、指数函数等，但对于一般的函数来说，问题可能会变得复杂些，针对这一问题Freidman提出了梯度提升（Gradient Boosting），这是利用最速下降的近似方法，其关键是利用损失函数的负梯度在当前模型的值 − [ ∂ L ( y , f ( x i ) ) ∂ f ( x i ) ] f ( x ) = f m − 1 ( x ) -\Biggl[{\partial L(y,f(x_i)) \over \partial f(x_i)}\Biggr]_{f(x)=f_{m-1}(x)} −[∂f(xi​)∂L(y,f(xi​))​]f(x)=fm−1​(x)​作为近似残差，拟合一个回归树。 算法步骤： (1). 初始化 f 0 ( x ) = a r g min ⁡ c ∑ i = 1 N L ( y i , c ) f_0(x)=arg\min_c\sum_{i=1}^N L(y_i, c) f0​(x)=argcmin​i=1∑N​L(yi​,c)估计使损失函数极小化的常数值，是只有一个根节点的树。 (2). 对 m = 1 , 2 ⋯ &amp;ThinSpace; , M : m=1,2\cdots,M: m=1,2⋯,M: \quad\quad a . 对于 i = 1 , 2 , . . . , N i=1,2,...,N i=1,2,...,N, 计算 r m i = − [ ∂ L ( y , f ( x i ) ) ∂ f ( x i ) ] f ( x ) = f m − 1 ( x ) r_{mi}=-\Biggl[{\partial L(y,f(x_i)) \over \partial f(x_i)}\Biggr]_{f(x)=f_{m-1}(x)} rmi​=−[∂f(xi​)∂L(y,f(xi​))​]f(x)=fm−1​(x)​损失函数的负梯度在当前模型的值，将其作为残差的估计。当损失函数是平方损失函数的时候，负梯度为 2 ( y − f ( x ) ) ∣ f m − 1 ( x ) = 2 ( y − f m − 1 ( x ) ) 2(y-f(x))| f_{m-1}(x)=2(y-f_{m-1}(x)) 2(y−f(x))∣fm−1​(x)=2(y−fm−1​(x)),文章说也就是通常所说的残差，这个2倍关系是我计算错了吗？ \quad\quad b . 拟合 r m i r_{mi} rmi​，学习一个回归树的叶节点区域 R m j , j = 1 , 2 , . . . , J R_{mj},j=1,2,...,J Rmj​,j=1,2,...,J \quad\quad c.对 j = 1 , 2 , . . . , J j=1,2,...,J j=1,2,...,J计算 c m j = a r g min ⁡ c ∑ x i ∈ R m j L ( y i , f m − 1 ( x i ) + c ) c_{mj}=arg\min_c\sum_{x_i \in R_{mj}} L(y_i, f_{m-1}(x_i)+c) cmj​=argcmin​xi​∈Rmj​∑​L(yi​,fm−1​(xi​)+c)利用线性搜索估计叶结点区域的值，使损失函数极小化。 \quad\quad d.更新 f m ( x ) = f m − 1 ( x ) + ∑ j = 1 J c m j I ( x ∈ R m j ) f_m(x)=f_{m-1}(x)+\sum_{j=1}^J c_{mj}I(x \in R_{mj}) fm​(x)=fm−1​(x)+j=1∑J​cmj​I(x∈Rmj​)(3). 得到回归树： f ( x ) ∗ = f M ( x ) = ∑ m = 1 M ∑ j = 1 J c m j I ( x ∈ R m j ) f(x)^*=f_M(x)=\sum_{m=1}^M\sum_{j=1}^J c_{mj}I(x \in R_{mj}) f(x)∗=fM​(x)=m=1∑M​j=1∑J​cmj​I(x∈Rmj​) 四 习题 8.1 某公司招聘支援考查身体、业务能力、发展潜力这三项。身体分为合格1、不合格0两级，业务能力和发展潜力分为上1，中2，下3三级。分类为合格1，不合格-1两类。已知10个人的数据，如下表所示，假设弱分类器为决策树桩，试用AdaBoost算法学习一个强分类器。 应聘人员情况数据表 1 2 3 4 5 6 7 8 9 10 身体 0 0 1 1 1 0 1 1 1 0 业务 1 3 2 1 2 1 1 1 3 2 潜力 3 1 2 3 3 2 2 1 1 1 分类 -1 -1 -1 -1 -1 -1 1 1 -1 -1 from numpy import * # adaBoost算法 # 决策树桩仅分裂一次，也就是说只选择一次特征 # 决策树桩由三部分组成，特征，特征值，不等号的方向 # 读入数据 def loadData(): dataMat = matrix([[0. , 1. , 3.], [0. , 3. , 1.], [1. , 2. , 2.], [1. , 1. , 3.], [1. , 2. , 3.], [0. , 1. , 2.], [1. , 1. , 2.], [1. , 1. , 1.], [1. , 3. , 1.], [0. , 2. , 1.]]) classLabels = matrix([-1.0, -1.0,-1.0, -1.0, -1.0, -1.0,1.0, 1.0, -1.0 , -1.0]).T return dataMat, classLabels # 根据当前树桩对数据进行分类 def stumpClassify(dataMatrix, dimen, threshVal, threshIneq): retArray = ones((shape(dataMatrix)[0], 1))#预测矩阵 #左叶子 ，整个矩阵的样本进行比较赋值 if threshIneq == &#39;lt&#39;: retArray[dataMatrix[:, dimen] &lt;= threshVal] = -1.0 else: retArray[dataMatrix[:, dimen] &gt; threshVal] = -1.0 return retArray &#39;&#39;&#39; # 根据数据，标签和权值分布构造弱分类器，即决策树桩 stump 树桩 # D为数据权重向量 # numStep是步数，据此可算出步长， bestClassEst是最优情况下的分类情况 构造树桩要做的是： 选择合适的特征，选择合适的阈值 bestStump[&#39;dim&#39;] 合适的特征所在维度 bestStump[&#39;thresh&#39;] 合适特征的阈值 bestStump[&#39;ineq&#39;] &#39;&#39;&#39; def buildStump(dataMatrix, classLabels, D): m, n = shape(dataMatrix) numStep = 10.0 bestStump = {} #字典 minError = inf bestClasEst = mat(ones((m, 1))) #n是特征的种类数 for i in range(n): rangeMin = dataMatrix[:, i].min() #求每一种特征的最大最小值 rangeMax = dataMatrix[:, i].max() stepSize = (rangeMax-rangeMin)/numStep for j in range(-1, int(numStep)+1): threshVal = rangeMin + j*stepSize #不知左树-1准确率高还是右树，因此有这样一个计算 for inequal in [&#39;lt&#39;, &#39;rt&#39;]: predictVals = stumpClassify(dataMatrix, i, threshVal, inequal) errArr = mat(ones((m, 1))) errArr[predictVals == classLabels] = 0 weightedError = D.T*errArr if weightedError &lt; minError: minError = weightedError bestClassEst = predictVals bestStump[&#39;dim&#39;] = i bestStump[&#39;thresh&#39;] = threshVal bestStump[&#39;ineq&#39;] = inequal return bestStump, minError, bestClassEst # adaBoost训练过程 def adaBoostTrain(dataMatrix, classLabels, numIter=40): weakClassArr = [] #弱分类器 m = shape(dataMatrix)[0] #样本个数 D = mat(ones((m, 1))/m) #一开始是均值权重分布 aggClassEst = mat(zeros((m, 1))) for i in range(numIter): #numIter 弱分类器的个数 bestStump, error, classEst = buildStump(dataMatrix, classLabels, D) # 防止除以零溢出 alpha = float(0.5*log((1-error)/max(error, 1e-16))) bestStump[&#39;alpha&#39;] = alpha weakClassArr.append(bestStump) expon = multiply(-1*alpha*classLabels, classEst) D = multiply(D, exp(expon)) D /= D.sum() aggClassEst += alpha*classEst #弱分类器结果的求和 # 比较两个矩阵的值得出预测正误情况 aggError = sign(aggClassEst) != classLabels errorRate = aggError.sum()/m print(errorRate) if errorRate == 0.0: break return weakClassArr def adaClassify(dataMatrix, classifierArr): m = shape(dataMatrix)[0] aggClassEst = mat(zeros((m, 1))) for i in range(len(classifierArr)): stump = classifierArr[i] classEst = stumpClassify(dataMatrix, stump[&#39;dim&#39;], stump[&#39;thresh&#39;], stump[&#39;ineq&#39;]) aggClassEst += stump[&#39;alpha&#39;]*classEst return sign(aggClassEst) dataMat, classLabels = loadData() classifiers = adaBoostTrain(dataMat, classLabels, 9) labels = adaClassify(mat([1,2,3]), classifiers) print(labels) print(&#39;dim\tthresh\tinep\talpha&#39;) for i in range(6): print(str(classifiers[i][&#39;dim&#39;])+&#39;\t&#39;+str(classifiers[i][&#39;thresh&#39;]) +&#39;\t&#39;+str(classifiers[i][&#39;ineq&#39;])+&#39;\t&#39;+str(classifiers[i][&#39;alpha&#39;])) 前面6行是误差率，[-1]是对第5个样本的预测，dim表示特征维度，thresh表示划分阈值，inep左树还是右树准确率高。 8.2 比较支持向量机，AdaBoost，逻辑斯蒂回归模型的学习策略与算法。 策略 算法 支持向量机 极小化正则化合页损失，软间隔最大化 序列最小最优化（SMO） 逻辑斯蒂回归模型 极大对数似然函数，正则化的极大似然估计 改进的迭代尺度算法，梯度下降，拟牛顿 AdaBoost 极小化加法模型的指数损失 前向分步加法算法" />
<link rel="canonical" href="https://mlh.app/2019/02/17/342fc171073b8b1294b9eb2de888936c.html" />
<meta property="og:url" content="https://mlh.app/2019/02/17/342fc171073b8b1294b9eb2de888936c.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"文章目录 一、集成学习 二、Bagging与随机森林 三、Boosting 提升方法 3.1 提升方法的思路和提升方法AdaBoost 3.2 前向分步加法模型与AdaBoost 3.3 提升树【提升树和AdaBoost的关系】 3.3.1 回归提升树 3.3.2 梯度提升树 四 习题 Boosting与AdaBoost可视化解析 一、集成学习   提升方法是一种常用的统计学习方法，是集成学习实现的一种方式，《统计学习方法》只介绍了提升方法的相关知识，本文从集成学习方法开始回顾，形成这部分内容的一个学习框架。   集成学习通过构建并结合多个学习器来完成学习任务，有时也被称为多分类系统，基于委员会的学习等。   如图所示，集成学习的一般结构是，先产生一组“个体学习器”，然后利用某种策略将他们结合起来。个体学习器通常由现有的学习算法从训练数据产生，例如C4.5决策树，BP神经网络等。图示个体学习器只包含同种类型的学习算法，这样的集成成为同质集成，此时，个体学习器成为基学习器，相应的学习算法称为基学习算法。如果集成学习包含不同的个体学习器，也就是用不同的学习算法构成个体学习器，这时称为异质集成，不再有基学习算法，个体学习器称为组件学习器。   一般情况下将多个学习器进行结合可以获得比单一学习器更显著优越的泛化性能。但是集成效果也可能更差，因为个体分类器本身性能问题，因此为了获得好的集成，个体分类器应该“好而不同”，也就是个体学习器要有一定的准确性，并且要有多样性，保证学习器之间有差异。   这时，集成学习涉及几个问题全部出现，1，如何生成个体分类器，根据其生成方式，大致可以分为两大类，即个体学习器间存在强依赖关系，必须串行生成的序列化方法(代表Boosting)，以及个体学习器间不存在强依赖关系，可同时生成的并行化方法(代表Bagging和随机森林)。2，如何衡量个体学习器的多样性，以及如何增强多样性。3，不同个体学习器之间如何结合，结合策略是什么。根据西瓜书集成学习章节总结如下，具体内容参考西瓜书： 二、Bagging与随机森林   欲得到泛化性能强的集成，集成中的个体学习器应尽可能相互独立，“独立“在实任务中无法做到，但是可以设法使基学习器尽可能有较大的差异—&gt;对给定的训练数据集进行取样，产生若干个不同的子集，分别训练基学习器，集成效果较好，但是同时需要保证个体学习器的性能不能太差，如果采样的每个子集都完全不同，则每个基学习器只用到了一小部分训练数据，甚至不足以进行有效学习，因此最终使用有交叠的采样子集。   根据样本抽取方法不同，Bagging可分为： 如果抽取的数据集的随机子集是样例的随机子集，我们叫做 Pasting 。 如果样例抽取是有放回的，我们称为 Bagging 。 如果抽取的数据集的随机子集是特征的随机子集，我们叫做随机子空间 (Random Subspaces)。 最后，如果基估计器构建在对于样本和特征抽取的子集之上时，我们叫做随机补丁 (Random Patches) 。   最终的预测结果，在结合策略中提到了，对于分类任务使用简单投票法,即每个分类器一票进行投票(也可以进行概率平均)；对于回归任务,则采用简单平均获取最终结果,即取所有分类器的平均值。   在多数情况下，bagging 方法提供了一种非常简单的方式来对单一模型进行改进，而无需修改背后的算法。 因为 bagging 方法可以减小过拟合，所以通常在强分类器和复杂模型上使用时表现的很好（例如，完全决策树，fully developed decision trees），相比之下 boosting 方法则在弱模型上表现更好（例如，浅层决策树，shallow decision trees）。   随机森林，是Bagging的一个变体，在一决策树为基学习器构建Bagging集成的基础上，进一步在决策树的训练过程中引入随机属性选择。具体来说，对基决策树的每个节点，（假设有 d d d个属性），先从该节点的属性集合中随机选择一个包含k个属性的子集，然后再从这个子集中选择一个最优属性用于划分，k控制了随机性的引入程度，一般情况下推荐 k = l o g 2 d k=log_2d k=log2​d。   随机森林不仅引入了样本扰动，还引入了属性扰动，因此最终的泛化性能可以通过个体学习器之间的差异度的增加进一步提升。实现简单，计算开销小，性能强大。 三、Boosting 提升方法 3.1 提升方法的思路和提升方法AdaBoost   在PCA框架下，一个概念是强可学习的充要条件是这个概念是弱可学习的。在学习中，找到弱可学习方法比强可学习方法容易得多，所以问题转换为如何将弱可学习方法提升为强可学习方法。大部分提升方法都是改变训练数据的概率分布（训练数据的权值分布），然后针对不同的训练数据分布调用弱学习算法学习一系列弱分类器。   此时有两个问题： 在每一轮如何改变训练数据的权值或概率分布。 【AdaBoost提高那些前一轮被弱分类器错误分类的样本的权值，降低被正确分类的样本的权值。】 如何将弱分类器组合成一个强分类器 【 分类问题：加权多数表决】 AdaBoost算法： 模型：损失函数为指数函数的加法模型 学习策略：极小化加法模型的指数损失 学习算法：前向分步加法算法 输入：训练数据集 T = { ( x 1 , y 1 ) , ( x 2 , y 2 ) , ⋯ &amp;ThinSpace; , ( x N , y N ) } T=\\{(x_1,y_1),(x_2,y_2),\\cdots,(x_N,y_N)\\} T={(x1​,y1​),(x2​,y2​),⋯,(xN​,yN​)};弱学习算法 输出：最终分类器 G ( x ) G(x) G(x) 首先假设训练数据集具有均匀的权值分布 D 1 = ( w 11 , ⋯ &amp;ThinSpace; , w 1 i ⋯ &amp;ThinSpace; , w 1 N ) D_1=(w_{11},\\cdots,w_{1i}\\cdots,w_{1N}) D1​=(w11​,⋯,w1i​⋯,w1N​), w 1 i = 1 N w_{1i}=\\frac{1}{N} w1i​=N1​，即每个训练样本在基本分类器的学习中作用相同，保证第一步在原始数据上能够学习基本分类器 G 1 ( x ) G_1(x) G1​(x) 反复学习基本分类器，假设学习 M M M个基本分类器，对 m = 1 , 2 , ⋯ &amp;ThinSpace; , M m=1,2,\\cdots,M m=1,2,⋯,M (a).使用当前分布 D m D_m Dm​ 加权训练数据集，学习基分类器 G m ( x ) G_m(x) Gm​(x) (b)计算基分类器 G m ( x ) G_m(x) Gm​(x)在加权训练数据集上的分类误差率： e m = ∑ i = 1 N P ( G m ( x i ) ≠ y i ) = ∑ i = 1 N w m i I ( G m ( x i ) ≠ y i ) = ∑ G m ( x i ) ≠ y i w m i e_m=\\sum_{i=1}^NP(G_m(x_i)\\ne y_i)=\\sum_{i=1}^Nw_{mi}I(G_m(x_i)\\ne y_i)=\\sum_{G_m(x_i)\\ne y_i}w_{mi} em​=i=1∑N​P(Gm​(xi​)̸​=yi​)=i=1∑N​wmi​I(Gm​(xi​)̸​=yi​)=Gm​(xi​)̸​=yi​∑​wmi​ w m i w_{mi} wmi​表示第 m m m轮中第 i i i个实例的权值， ∑ i = 1 N w m i = 1 \\sum_{i=1}^Nw_{mi}=1 ∑i=1N​wmi​=1,这表明， G m ( x ) G_m(x) Gm​(x)在加权的训练数据集上的分类误差率是被 G m ( x ) G_m(x) Gm​(x)误分类样本的权值之和。 （c）计算 G m ( x ) G_m(x) Gm​(x)的系数 α m \\alpha_m αm​,表示 G m ( x ) G_m(x) Gm​(x)在最终分类器中的重要性。 α m = 1 2 l n 1 − e m e m \\alpha_m=\\frac{1}{2}ln\\frac{1-e_m}{e_m} αm​=21​lnem​1−em​​当 e m ≤ 1 2 e_m\\le\\frac{1}{2} em​≤21​时， α m ≥ 0 \\alpha_m\\ge 0 αm​≥0,并且 α m \\alpha_m αm​随着 e m e_m em​的减小而增大，所以分类误差率越小的基分类器在最终分类器中的作用越大。 (d)更新训练数据集的权值分布 D m = ( w m + 1 , 1 , ⋯ &amp;ThinSpace; , w m + 1 , i , ⋯ &amp;ThinSpace; , w m + 1 , N ) w m + 1 , i = w m i Z m e x p ( − α m y i G m ( x i ) ) = { w m i Z m e − α m G m ( x i ) = y i w m i Z m e α m G m ( x i ) ≠ y i D_m=(w_{m+1,1},\\cdots,w_{m+1,i},\\cdots,w_{m+1,N})\\\\w_{m+1,i}=\\frac{w_{mi}}{Z_m}exp(-\\alpha_my_iG_m(x_i))=\\left\\{ \\begin{aligned} \\frac{w_{mi}}{Z_m}e^{-\\alpha_m}\\quad\\quad G_m(x_i)=y_i\\\\ \\frac{w_{mi}}{Z_m}e^{\\alpha_m}\\quad\\quad G_m(x_i)\\ne y_i \\\\ \\end{aligned} \\right. Dm​=(wm+1,1​,⋯,wm+1,i​,⋯,wm+1,N​)wm+1,i​=Zm​wmi​​exp(−αm​yi​Gm​(xi​))=⎩⎪⎨⎪⎧​Zm​wmi​​e−αm​Gm​(xi​)=yi​Zm​wmi​​eαm​Gm​(xi​)̸​=yi​​当 e m ≤ 1 2 e_m\\le\\frac{1}{2} em​≤21​时， α m ≥ 0 \\alpha_m\\ge 0 αm​≥0,所以正确分类时，样本权值被缩小，错误分类时，样本权值被增大。 Z m Z_m Zm​是规范因子 Z m = ∑ i = 1 N w m i e x p ( − α m y i G m ( x i ) ) Z_m=\\sum_{i=1}^Nw_{mi}exp(-\\alpha_my_iG_m(x_i)) Zm​=i=1∑N​wmi​exp(−αm​yi​Gm​(xi​)) 构建基本分类器的线性组合 f ( x ) = ∑ m = 1 M α m G m ( x ) f(x) = \\sum_{m=1}^M\\alpha_mG_m(x) f(x)=m=1∑M​αm​Gm​(x)得到最终分类器为 G ( x ) = s i g n ( f ( x ) ) G(x) = sign(f(x)) G(x)=sign(f(x)) 3.2 前向分步加法模型与AdaBoost   AdaBoost的另一种解释为：模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。   前向分布算法的目标是训练一个加法模型 f ( x ) = ∑ m = 1 M β m b ( x ; γ m ) f(x)=\\sum_{m=1}^M\\beta_mb(x;γ_m) f(x)=∑m=1M​βm​b(x;γm​),给定训练数据和损失函数，学习加法模型就变成损失函数最小化问题，通常整体优化比较复杂，所以从前向后，每一步只学习一个基函数及其系数。经过推导，AdaBoost是模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。 3.3 提升树【提升树和AdaBoost的关系】   前向分布算法+决策树（分类树or回归树）=提升树   提升树是以分类树或者回归树为基本分类器的提升方法。分类问题用二叉分类树，回归问题用二叉回归树，最简单的回归树可看做是一个根节点连接的左右子树的二叉树，即所谓的决策树桩。提升树的模型可表示为： f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_M(x) = \\sum_{m=1}^MT(x;\\Theta_m) fM​(x)=m=1∑M​T(x;Θm​) T ( x ; Θ m ) T(x;\\Theta_m) T(x;Θm​)表示决策树， Θ m \\Theta_m Θm​表示决策树的参数； M M M表示树的个数。   提升树算法采用前向分布算法，首先确定初始提升树 f 0 ( x ) = 0 f_0(x)=0 f0​(x)=0，第 m m m步的模型是 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ m ) f_m(x) = f_{m-1}(x)+T(x;\\Theta_m) fm​(x)=fm−1​(x)+T(x;Θm​)其中 f m − 1 ( x ) f_{m-1}(x) fm−1​(x)为当前模型，通过经验风险极小化确定下一棵决策树的参数 Θ m \\Theta_m Θm​ Θ ^ m = a r g m i n Θ m ∑ i = 1 N L ( y i , f m − 1 ( x i ) + T ( x i ; Θ m ) ) \\widehat{\\Theta}_m = argmin_{\\Theta_m}\\sum_{i=1}^NL(y_i,f_{m-1}(x_i)+T(x_i;\\Theta_m)) Θ m​=argminΘm​​i=1∑N​L(yi​,fm−1​(xi​)+T(xi​;Θm​))  针对不同的问题，提升树有不同的形式，主要区别在于损失函数不同，回归问题：平方误差损失函数；分类问题：指数损失函数；一般决策问题：一般损失函数。分类问题的提升树改变权重，回归问题的提升树拟合残差。损失函数是平方损失函数的时候，残差易求，如果不是平方损失函数也不是指数损失函数，残差就不可求，这时，就要用损失函数关于当前模型 f m − 1 ( x ) f_{m-1}(x) fm−1​(x)的负梯度来近似代替残差。梯度提升算法就是用梯度下降法来讲弱分类器提升为强分类器的算法。 提升树和AdaBoost之间是什么关系？   AdaBoost是提升思想的算法模型,经典的AdaBoost一般用于分类问题，并没有指定基函数，或者说是基分类器，它可以从改变样本的权值的角度和前向分布算法的角度来解释。当确定基函数是回归或分类树时，结合前向分布算法就得出提升树算法。   使用梯度提升进行分类的算法叫做GBDT，进行回归时则叫做GBRT。一般的提升树是用残差来确定树的叶节点的切分，并根据残差来确定该切分下的输出值，而GBDT首先是根据负梯度来确定切分，确定切分后根据线性搜索估计叶节点区域的值，使损失函数极小化。这就好比是寻找一个全局极小值，负梯度只给定一个方向，通过线性搜索确定在该方向下走几步。所以可以认为伪残差是只给出方向的残差。 3.3.1 回归提升树   对于分类问题，只需要将上述的AdaBoost的基学习器限定为二分类树，其余的和上述的AdaBoost内容无差。对于回归问题，可看做是对输入空间 χ χ χ划分为J个不相交的区域，在每个区域上输出的常量为 c j c_j cj​，那么树可以表示为： T ( x ; θ ) = ∑ j = 1 J c j I ( x ∈ R j ) T(x; \\theta)=\\sum_{j=1}^J c_j I(x \\in R_j) T(x;θ)=j=1∑J​cj​I(x∈Rj​)其中 θ = { ( R 1 , c 1 ) , ( R 2 , c 2 ) , . . . , ( R J , c J ) } \\theta=\\{(R_1, c_1), (R_2, c_2),...,(R_J, c_J)\\} θ={(R1​,c1​),(R2​,c2​),...,(RJ​,cJ​)}表示树的区域和区域上的常数，J表示区域的个数,是回归树的复杂度即叶结点的个数。   对于回归树的前向分步式算法有： f 0 ( x ) = 0 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ ) , m = 1 , 2 , . . . , M f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_0(x)=0\\\\f_m(x)=f_{m-1}(x)+T(x; \\Theta), m= 1, 2, ..., M\\\\f_M(x)=\\sum_{m=1}^M T(x;\\Theta_m) f0​(x)=0fm​(x)=fm−1​(x)+T(x;Θ),m=1,2,...,MfM​(x)=m=1∑M​T(x;Θm​)在前向分步式算法的第m步，给定 m − 1 m−1 m−1步的情况，需要求解： θ m ∗ = a r g min ⁡ Θ m ∑ i = 1 N L ( y i , f m − 1 ( x i ) + T ( x i ; θ m ) \\theta_m^* = arg\\min_{\\Theta_m}\\sum_{i=1}^N L(y_i, f_{m-1}(x_i)+T(x_i; \\theta_m) θm∗​=argΘm​min​i=1∑N​L(yi​,fm−1​(xi​)+T(xi​;θm​)得到第 m m m颗树的参数。   这里我们采用平方误差拟合回归问题，则： L ( y , f ( x ) = ( y − f ( x ) ) 2 L(y,f(x)=(y-f(x))^2 L(y,f(x)=(y−f(x))2其损失变为： L ( y , f m − 1 ( x ) + T ( x ; Θ m ) ) = [ y − f m − 1 ( x ) − T ( x : Θ m ) ] 2 = [ r − T ( x ; Θ m ) ] 2 L(y, f_{m-1}(x)+T(x; \\Theta_m))=[y-f_{m-1}(x)-T(x: \\Theta_m)]^2\\\\\\qquad \\qquad =[r-T(x; \\Theta_m)]^2 L(y,fm−1​(x)+T(x;Θm​))=[y−fm−1​(x)−T(x:Θm​)]2=[r−T(x;Θm​)]2其中 r = y − f m − 1 ( x ) r=y−f_{m−1}(x) r=y−fm−1​(x)是当前拟合的残差，而目前我们的学习任务也仅仅是拟合这个残差,整个算法的步骤： (1). 初始化 f 0 ( x ) = 0 f_0(x)=0 f0​(x)=0 (2). 对 m = 1 , 2 ⋯ &amp;ThinSpace; , M m=1,2\\cdots,M m=1,2⋯,M \\quad\\quad a. 计算残差 r = y − f m − 1 ( x ) r=y−f_{m−1}(x) r=y−fm−1​(x) \\quad\\quad b. 拟合残差，学习一个回归树，得到 T ( x ; Θ ) T(x; \\Theta) T(x;Θ) \\quad\\quad c. 更新 f m ( x ) = f m − 1 ( x ) + T ( x ; Θ ) f_m(x)=f_{m-1}(x)+T(x; \\Theta) fm​(x)=fm−1​(x)+T(x;Θ) (3). 得到回归提升树 f M ( x ) = ∑ m = 1 M T ( x ; Θ m ) f_M(x)=\\sum_{m=1}^MT(x;\\Theta_m) fM​(x)=m=1∑M​T(x;Θm​) 3.3.2 梯度提升树   前面用到的损失函数都有比较好的性质，如平方误差、指数函数等，但对于一般的函数来说，问题可能会变得复杂些，针对这一问题Freidman提出了梯度提升（Gradient Boosting），这是利用最速下降的近似方法，其关键是利用损失函数的负梯度在当前模型的值 − [ ∂ L ( y , f ( x i ) ) ∂ f ( x i ) ] f ( x ) = f m − 1 ( x ) -\\Biggl[{\\partial L(y,f(x_i)) \\over \\partial f(x_i)}\\Biggr]_{f(x)=f_{m-1}(x)} −[∂f(xi​)∂L(y,f(xi​))​]f(x)=fm−1​(x)​作为近似残差，拟合一个回归树。 算法步骤： (1). 初始化 f 0 ( x ) = a r g min ⁡ c ∑ i = 1 N L ( y i , c ) f_0(x)=arg\\min_c\\sum_{i=1}^N L(y_i, c) f0​(x)=argcmin​i=1∑N​L(yi​,c)估计使损失函数极小化的常数值，是只有一个根节点的树。 (2). 对 m = 1 , 2 ⋯ &amp;ThinSpace; , M : m=1,2\\cdots,M: m=1,2⋯,M: \\quad\\quad a . 对于 i = 1 , 2 , . . . , N i=1,2,...,N i=1,2,...,N, 计算 r m i = − [ ∂ L ( y , f ( x i ) ) ∂ f ( x i ) ] f ( x ) = f m − 1 ( x ) r_{mi}=-\\Biggl[{\\partial L(y,f(x_i)) \\over \\partial f(x_i)}\\Biggr]_{f(x)=f_{m-1}(x)} rmi​=−[∂f(xi​)∂L(y,f(xi​))​]f(x)=fm−1​(x)​损失函数的负梯度在当前模型的值，将其作为残差的估计。当损失函数是平方损失函数的时候，负梯度为 2 ( y − f ( x ) ) ∣ f m − 1 ( x ) = 2 ( y − f m − 1 ( x ) ) 2(y-f(x))| f_{m-1}(x)=2(y-f_{m-1}(x)) 2(y−f(x))∣fm−1​(x)=2(y−fm−1​(x)),文章说也就是通常所说的残差，这个2倍关系是我计算错了吗？ \\quad\\quad b . 拟合 r m i r_{mi} rmi​，学习一个回归树的叶节点区域 R m j , j = 1 , 2 , . . . , J R_{mj},j=1,2,...,J Rmj​,j=1,2,...,J \\quad\\quad c.对 j = 1 , 2 , . . . , J j=1,2,...,J j=1,2,...,J计算 c m j = a r g min ⁡ c ∑ x i ∈ R m j L ( y i , f m − 1 ( x i ) + c ) c_{mj}=arg\\min_c\\sum_{x_i \\in R_{mj}} L(y_i, f_{m-1}(x_i)+c) cmj​=argcmin​xi​∈Rmj​∑​L(yi​,fm−1​(xi​)+c)利用线性搜索估计叶结点区域的值，使损失函数极小化。 \\quad\\quad d.更新 f m ( x ) = f m − 1 ( x ) + ∑ j = 1 J c m j I ( x ∈ R m j ) f_m(x)=f_{m-1}(x)+\\sum_{j=1}^J c_{mj}I(x \\in R_{mj}) fm​(x)=fm−1​(x)+j=1∑J​cmj​I(x∈Rmj​)(3). 得到回归树： f ( x ) ∗ = f M ( x ) = ∑ m = 1 M ∑ j = 1 J c m j I ( x ∈ R m j ) f(x)^*=f_M(x)=\\sum_{m=1}^M\\sum_{j=1}^J c_{mj}I(x \\in R_{mj}) f(x)∗=fM​(x)=m=1∑M​j=1∑J​cmj​I(x∈Rmj​) 四 习题 8.1 某公司招聘支援考查身体、业务能力、发展潜力这三项。身体分为合格1、不合格0两级，业务能力和发展潜力分为上1，中2，下3三级。分类为合格1，不合格-1两类。已知10个人的数据，如下表所示，假设弱分类器为决策树桩，试用AdaBoost算法学习一个强分类器。 应聘人员情况数据表 1 2 3 4 5 6 7 8 9 10 身体 0 0 1 1 1 0 1 1 1 0 业务 1 3 2 1 2 1 1 1 3 2 潜力 3 1 2 3 3 2 2 1 1 1 分类 -1 -1 -1 -1 -1 -1 1 1 -1 -1 from numpy import * # adaBoost算法 # 决策树桩仅分裂一次，也就是说只选择一次特征 # 决策树桩由三部分组成，特征，特征值，不等号的方向 # 读入数据 def loadData(): dataMat = matrix([[0. , 1. , 3.], [0. , 3. , 1.], [1. , 2. , 2.], [1. , 1. , 3.], [1. , 2. , 3.], [0. , 1. , 2.], [1. , 1. , 2.], [1. , 1. , 1.], [1. , 3. , 1.], [0. , 2. , 1.]]) classLabels = matrix([-1.0, -1.0,-1.0, -1.0, -1.0, -1.0,1.0, 1.0, -1.0 , -1.0]).T return dataMat, classLabels # 根据当前树桩对数据进行分类 def stumpClassify(dataMatrix, dimen, threshVal, threshIneq): retArray = ones((shape(dataMatrix)[0], 1))#预测矩阵 #左叶子 ，整个矩阵的样本进行比较赋值 if threshIneq == &#39;lt&#39;: retArray[dataMatrix[:, dimen] &lt;= threshVal] = -1.0 else: retArray[dataMatrix[:, dimen] &gt; threshVal] = -1.0 return retArray &#39;&#39;&#39; # 根据数据，标签和权值分布构造弱分类器，即决策树桩 stump 树桩 # D为数据权重向量 # numStep是步数，据此可算出步长， bestClassEst是最优情况下的分类情况 构造树桩要做的是： 选择合适的特征，选择合适的阈值 bestStump[&#39;dim&#39;] 合适的特征所在维度 bestStump[&#39;thresh&#39;] 合适特征的阈值 bestStump[&#39;ineq&#39;] &#39;&#39;&#39; def buildStump(dataMatrix, classLabels, D): m, n = shape(dataMatrix) numStep = 10.0 bestStump = {} #字典 minError = inf bestClasEst = mat(ones((m, 1))) #n是特征的种类数 for i in range(n): rangeMin = dataMatrix[:, i].min() #求每一种特征的最大最小值 rangeMax = dataMatrix[:, i].max() stepSize = (rangeMax-rangeMin)/numStep for j in range(-1, int(numStep)+1): threshVal = rangeMin + j*stepSize #不知左树-1准确率高还是右树，因此有这样一个计算 for inequal in [&#39;lt&#39;, &#39;rt&#39;]: predictVals = stumpClassify(dataMatrix, i, threshVal, inequal) errArr = mat(ones((m, 1))) errArr[predictVals == classLabels] = 0 weightedError = D.T*errArr if weightedError &lt; minError: minError = weightedError bestClassEst = predictVals bestStump[&#39;dim&#39;] = i bestStump[&#39;thresh&#39;] = threshVal bestStump[&#39;ineq&#39;] = inequal return bestStump, minError, bestClassEst # adaBoost训练过程 def adaBoostTrain(dataMatrix, classLabels, numIter=40): weakClassArr = [] #弱分类器 m = shape(dataMatrix)[0] #样本个数 D = mat(ones((m, 1))/m) #一开始是均值权重分布 aggClassEst = mat(zeros((m, 1))) for i in range(numIter): #numIter 弱分类器的个数 bestStump, error, classEst = buildStump(dataMatrix, classLabels, D) # 防止除以零溢出 alpha = float(0.5*log((1-error)/max(error, 1e-16))) bestStump[&#39;alpha&#39;] = alpha weakClassArr.append(bestStump) expon = multiply(-1*alpha*classLabels, classEst) D = multiply(D, exp(expon)) D /= D.sum() aggClassEst += alpha*classEst #弱分类器结果的求和 # 比较两个矩阵的值得出预测正误情况 aggError = sign(aggClassEst) != classLabels errorRate = aggError.sum()/m print(errorRate) if errorRate == 0.0: break return weakClassArr def adaClassify(dataMatrix, classifierArr): m = shape(dataMatrix)[0] aggClassEst = mat(zeros((m, 1))) for i in range(len(classifierArr)): stump = classifierArr[i] classEst = stumpClassify(dataMatrix, stump[&#39;dim&#39;], stump[&#39;thresh&#39;], stump[&#39;ineq&#39;]) aggClassEst += stump[&#39;alpha&#39;]*classEst return sign(aggClassEst) dataMat, classLabels = loadData() classifiers = adaBoostTrain(dataMat, classLabels, 9) labels = adaClassify(mat([1,2,3]), classifiers) print(labels) print(&#39;dim\\tthresh\\tinep\\talpha&#39;) for i in range(6): print(str(classifiers[i][&#39;dim&#39;])+&#39;\\t&#39;+str(classifiers[i][&#39;thresh&#39;]) +&#39;\\t&#39;+str(classifiers[i][&#39;ineq&#39;])+&#39;\\t&#39;+str(classifiers[i][&#39;alpha&#39;])) 前面6行是误差率，[-1]是对第5个样本的预测，dim表示特征维度，thresh表示划分阈值，inep左树还是右树准确率高。 8.2 比较支持向量机，AdaBoost，逻辑斯蒂回归模型的学习策略与算法。 策略 算法 支持向量机 极小化正则化合页损失，软间隔最大化 序列最小最优化（SMO） 逻辑斯蒂回归模型 极大对数似然函数，正则化的极大似然估计 改进的迭代尺度算法，梯度下降，拟牛顿 AdaBoost 极小化加法模型的指数损失 前向分步加法算法","@type":"BlogPosting","url":"https://mlh.app/2019/02/17/342fc171073b8b1294b9eb2de888936c.html","headline":"李航《统计学习方法》——第八章Boosting提升方法【补充集成学习】+习题答案","dateModified":"2019-02-17T00:00:00+08:00","datePublished":"2019-02-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/02/17/342fc171073b8b1294b9eb2de888936c.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>李航《统计学习方法》——第八章Boosting提升方法【补充集成学习】+习题答案</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p></p>
  <div class="toc">
   <h3>文章目录</h3>
   <ul>
    <ul>
     <ul>
      <li><a href="#_2" rel="nofollow">一、集成学习</a></li>
      <li><a href="#Bagging_8" rel="nofollow">二、Bagging与随机森林</a></li>
      <li><a href="#Boosting__21" rel="nofollow">三、Boosting 提升方法</a></li>
      <ul>
       <li><a href="#31_AdaBoost_22" rel="nofollow">3.1 提升方法的思路和提升方法AdaBoost</a></li>
       <li><a href="#32_AdaBoost_48" rel="nofollow">3.2 前向分步加法模型与AdaBoost</a></li>
       <li><a href="#33_AdaBoost_51" rel="nofollow">3.3 提升树【提升树和AdaBoost的关系】</a></li>
       <ul>
        <li><a href="#331__58" rel="nofollow">3.3.1 回归提升树</a></li>
        <li><a href="#332__68" rel="nofollow">3.3.2 梯度提升树</a></li>
       </ul>
      </ul>
      <li><a href="#__77" rel="nofollow">四 习题</a></li>
     </ul>
    </ul>
   </ul>
  </div>
  <br> 
  <a href="https://pan.baidu.com/s/1IRlmu68At1u8lLPQNttDvw?errno=0&amp;errmsg=Auth%20Login%20Sucess&amp;&amp;bduss=&amp;ssnerror=0&amp;traceid=" rel="nofollow">Boosting与AdaBoost可视化解析</a>
  <p></p> 
  <h3><a id="_2"></a>一、集成学习</h3> 
  <p>  提升方法是一种常用的统计学习方法，是集成学习实现的一种方式，《统计学习方法》只介绍了提升方法的相关知识，本文从集成学习方法开始回顾，形成这部分内容的一个学习框架。<br>   集成学习通过构建并结合多个学习器来完成学习任务，有时也被称为多分类系统，基于委员会的学习等。<img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/2019021612010548.png" alt="在这里插入图片描述"><br>   如图所示，集成学习的一般结构是，先产生一组“个体学习器”，然后利用某种策略将他们结合起来。个体学习器通常由现有的学习算法从训练数据产生，例如C4.5决策树，BP神经网络等。图示个体学习器只包含同种类型的学习算法，这样的集成成为同质集成，此时，个体学习器成为基学习器，相应的学习算法称为基学习算法。如果集成学习包含不同的个体学习器，也就是用不同的学习算法构成个体学习器，这时称为异质集成，不再有基学习算法，个体学习器称为组件学习器。<br>   一般情况下将多个学习器进行结合可以获得比单一学习器更显著优越的泛化性能。但是集成效果也可能更差，因为个体分类器本身性能问题，因此为了获得好的集成，个体分类器应该“好而不同”，也就是个体学习器要有一定的准确性，并且要有多样性，保证学习器之间有差异。<br>   这时，集成学习涉及几个问题全部出现，1，如何生成个体分类器，根据其生成方式，大致可以分为两大类，即个体学习器间存在强依赖关系，必须串行生成的序列化方法(代表Boosting)，以及个体学习器间不存在强依赖关系，可同时生成的并行化方法(代表Bagging和随机森林)。2，如何衡量个体学习器的多样性，以及如何增强多样性。3，不同个体学习器之间如何结合，结合策略是什么。根据西瓜书集成学习章节总结如下，具体内容参考西瓜书：<img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190216121149317.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNTQ3OTEwOA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h3><a id="Bagging_8"></a>二、Bagging与随机森林</h3> 
  <p>  欲得到泛化性能强的集成，集成中的个体学习器应尽可能相互独立，“独立“在实任务中无法做到，但是可以设法使基学习器尽可能有较大的差异—&gt;对给定的训练数据集进行取样，产生若干个不同的子集，分别训练基学习器，集成效果较好，但是同时需要保证个体学习器的性能不能太差，如果采样的每个子集都完全不同，则每个基学习器只用到了一小部分训练数据，甚至不足以进行有效学习，因此最终使用有交叠的采样子集。<br>   根据样本抽取方法不同，Bagging可分为：</p> 
  <ul> 
   <li>如果抽取的数据集的随机子集是样例的随机子集，我们叫做 Pasting 。</li> 
   <li>如果样例抽取是有放回的，我们称为 Bagging 。</li> 
   <li>如果抽取的数据集的随机子集是特征的随机子集，我们叫做随机子空间 (Random Subspaces)。</li> 
   <li>最后，如果基估计器构建在对于样本和特征抽取的子集之上时，我们叫做随机补丁 (Random Patches) 。</li> 
  </ul> 
  <p>  <strong>最终的预测结果</strong>，在结合策略中提到了，对于分类任务使用简单投票法,即每个分类器一票进行投票(也可以进行概率平均)；对于回归任务,则采用简单平均获取最终结果,即取所有分类器的平均值。<br>   在多数情况下，bagging 方法提供了一种非常简单的方式来对单一模型进行改进，而无需修改背后的算法。 因为 bagging 方法可以减小过拟合，所以通常在强分类器和复杂模型上使用时表现的很好（例如，完全决策树，fully developed decision trees），相比之下 boosting 方法则在弱模型上表现更好（例如，浅层决策树，shallow decision trees）。</p> 
  <p>  <strong>随机森林</strong>，是Bagging的一个变体，在一决策树为基学习器构建Bagging集成的基础上，进一步在决策树的训练过程中引入随机属性选择。具体来说，对基决策树的每个节点，（假设有<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          d
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         d
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">d</span></span></span></span></span>个属性），先从该节点的属性集合中随机选择一个包含k个属性的子集，然后再从这个子集中选择一个最优属性用于划分，k控制了随机性的引入程度，一般情况下推荐<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
         <mo>
          =
         </mo>
         <mi>
          l
         </mi>
         <mi>
          o
         </mi>
         <msub>
          <mi>
           g
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mi>
          d
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         k=log_2d
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit">d</span></span></span></span></span>。<br>   随机森林不仅引入了样本扰动，还引入了属性扰动，因此最终的泛化性能可以通过个体学习器之间的差异度的增加进一步提升。实现简单，计算开销小，性能强大。</p> 
  <h3><a id="Boosting__21"></a>三、Boosting 提升方法</h3> 
  <h4><a id="31_AdaBoost_22"></a>3.1 提升方法的思路和提升方法AdaBoost</h4> 
  <p>  在PCA框架下，一个概念是强可学习的充要条件是这个概念是弱可学习的。在学习中，找到弱可学习方法比强可学习方法容易得多，所以问题转换为如何将弱可学习方法提升为强可学习方法。大部分提升方法都是改变训练数据的概率分布（训练数据的权值分布），然后针对不同的训练数据分布调用弱学习算法学习一系列弱分类器。<br>   此时有两个问题：</p> 
  <ul> 
   <li>在每一轮如何改变训练数据的权值或概率分布。<br> 【AdaBoost提高那些前一轮被弱分类器错误分类的样本的权值，降低被正确分类的样本的权值。】</li> 
   <li>如何将弱分类器组合成一个强分类器<br> 【 分类问题：加权多数表决】</li> 
  </ul> 
  <p><strong>AdaBoost算法</strong>：<br> <strong>模型</strong>：损失函数为指数函数的加法模型<br> <strong>学习策略</strong>：极小化加法模型的指数损失<br> <strong>学习算法</strong>：前向分步加法算法<br> <strong>输入</strong>：训练数据集<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mo>
          =
         </mo>
         <mo>
          {
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <mo>
          ⋯
         </mo>&amp;ThinSpace;
         <mo separator="true">
          ,
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           N
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mi>
           N
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         T=\{(x_1,y_1),(x_2,y_2),\cdots,(x_N,y_N)\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span>;弱学习算法<br> <strong>输出</strong>：最终分类器<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          G
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         G(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></p> 
  <ol> 
   <li>首先假设训练数据集具有均匀的权值分布<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            D
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mn>
            11
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mo>
           ⋯
          </mo>&amp;ThinSpace;
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           ⋯
          </mo>&amp;ThinSpace;
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            w
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <mi>
             N
            </mi>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          D_1=(w_{11},\cdots,w_{1i}\cdots,w_{1N})
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            w
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mi>
            N
           </mi>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          w_{1i}=\frac{1}{N}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，即每个训练样本在基本分类器的学习中作用相同，保证第一步在原始数据上能够学习基本分类器<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_1(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></li> 
   <li>反复学习基本分类器，假设学习<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           M
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          M
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span>个基本分类器，对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           m
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           2
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mo>
           ⋯
          </mo>&amp;ThinSpace;
          <mo separator="true">
           ,
          </mo>
          <mi>
           M
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          m=1,2,\cdots,M
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span><br> (a).使用当前分布<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            D
           </mi>
           <mi>
            m
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          D_m
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 加权训练数据集，学习基分类器<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_m(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span><br> (b)计算基分类器<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_m(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>在加权训练数据集上的分类误差率：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             e
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <munderover>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             N
            </mi>
           </munderover>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             G
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mi mathvariant="normal">
            ≠
           </mi>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <munderover>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             N
            </mi>
           </munderover>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
           <mi>
            I
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             G
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mi mathvariant="normal">
            ≠
           </mi>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <munder>
            <mo>
             ∑
            </mo>
            <mrow>
             <msub>
              <mi>
               G
              </mi>
              <mi>
               m
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <msub>
              <mi>
               x
              </mi>
              <mi>
               i
              </mi>
             </msub>
             <mo>
              )
             </mo>
             <mi mathvariant="normal">
              ≠
             </mi>
             <msub>
              <mi>
               y
              </mi>
              <mi>
               i
              </mi>
             </msub>
            </mrow>
           </munder>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
          </mrow>
          <annotation encoding="application/x-tex">
           e_m=\sum_{i=1}^NP(G_m(x_i)\ne y_i)=\sum_{i=1}^Nw_{mi}I(G_m(x_i)\ne y_i)=\sum_{G_m(x_i)\ne y_i}w_{mi}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.56601em; vertical-align: -1.51601em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.80899em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="rlap mtight"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel latin_fallback mtight"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.03588em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            w
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          w_{mi}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           m
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          m
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>轮中第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           i
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          i
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span>个实例的权值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </msubsup>
          <msub>
           <mi>
            w
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \sum_{i=1}^Nw_{mi}=1
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.28094em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>,这表明，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_m(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>在加权的训练数据集上的分类误差率是被<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_m(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>误分类样本的权值之和。<br> （c）计算<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_m(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>的系数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mi>
            m
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_m
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>,表示<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            G
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          G_m(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>在最终分类器中的重要性。<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             α
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <mfrac>
            <mn>
             1
            </mn>
            <mn>
             2
            </mn>
           </mfrac>
           <mi>
            l
           </mi>
           <mi>
            n
           </mi>
           <mfrac>
            <mrow>
             <mn>
              1
             </mn>
             <mo>
              −
             </mo>
             <msub>
              <mi>
               e
              </mi>
              <mi>
               m
              </mi>
             </msub>
            </mrow>
            <msub>
             <mi>
              e
             </mi>
             <mi>
              m
             </mi>
            </msub>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
           \alpha_m=\frac{1}{2}ln\frac{1-e_m}{e_m}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.15744em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            e
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           ≤
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          e_m\le\frac{1}{2}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.78597em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>时，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           ≥
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_m\ge 0
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.78597em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>,并且<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mi>
            m
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_m
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>随着<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            e
           </mi>
           <mi>
            m
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          e_m
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的减小而增大，所以分类误差率越小的基分类器在最终分类器中的作用越大。<br> (d)更新训练数据集的权值分布<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             D
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mo>
            ⋯
           </mo>&amp;ThinSpace;
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mo>
            ⋯
           </mo>&amp;ThinSpace;
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi>
              N
             </mi>
            </mrow>
           </msub>
           <mo>
            )
           </mo>
           <mspace linebreak="newline"></mspace>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
           <mo>
            =
           </mo>
           <mfrac>
            <msub>
             <mi>
              w
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               i
              </mi>
             </mrow>
            </msub>
            <msub>
             <mi>
              Z
             </mi>
             <mi>
              m
             </mi>
            </msub>
           </mfrac>
           <mi>
            e
           </mi>
           <mi>
            x
           </mi>
           <mi>
            p
           </mi>
           <mo>
            (
           </mo>
           <mo>
            −
           </mo>
           <msub>
            <mi>
             α
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <msub>
            <mi>
             G
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mrow>
            <mo fence="true">
             {
            </mo>
            <mtable>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="true">
                <mrow>
                 <mfrac>
                  <msub>
                   <mi>
                    w
                   </mi>
                   <mrow>
                    <mi>
                     m
                    </mi>
                    <mi>
                     i
                    </mi>
                   </mrow>
                  </msub>
                  <msub>
                   <mi>
                    Z
                   </mi>
                   <mi>
                    m
                   </mi>
                  </msub>
                 </mfrac>
                 <msup>
                  <mi>
                   e
                  </mi>
                  <mrow>
                   <mo>
                    −
                   </mo>
                   <msub>
                    <mi>
                     α
                    </mi>
                    <mi>
                     m
                    </mi>
                   </msub>
                  </mrow>
                 </msup>
                 <mspace width="1em"></mspace>
                 <mspace width="1em"></mspace>
                 <msub>
                  <mi>
                   G
                  </mi>
                  <mi>
                   m
                  </mi>
                 </msub>
                 <mo>
                  (
                 </mo>
                 <msub>
                  <mi>
                   x
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msub>
                 <mo>
                  )
                 </mo>
                 <mo>
                  =
                 </mo>
                 <msub>
                  <mi>
                   y
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msub>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="true">
                <mrow>
                 <mfrac>
                  <msub>
                   <mi>
                    w
                   </mi>
                   <mrow>
                    <mi>
                     m
                    </mi>
                    <mi>
                     i
                    </mi>
                   </mrow>
                  </msub>
                  <msub>
                   <mi>
                    Z
                   </mi>
                   <mi>
                    m
                   </mi>
                  </msub>
                 </mfrac>
                 <msup>
                  <mi>
                   e
                  </mi>
                  <msub>
                   <mi>
                    α
                   </mi>
                   <mi>
                    m
                   </mi>
                  </msub>
                 </msup>
                 <mspace width="1em"></mspace>
                 <mspace width="1em"></mspace>
                 <msub>
                  <mi>
                   G
                  </mi>
                  <mi>
                   m
                  </mi>
                 </msub>
                 <mo>
                  (
                 </mo>
                 <msub>
                  <mi>
                   x
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msub>
                 <mo>
                  )
                 </mo>
                 <mi mathvariant="normal">
                  ≠
                 </mi>
                 <msub>
                  <mi>
                   y
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msub>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex">
           D_m=(w_{m+1,1},\cdots,w_{m+1,i},\cdots,w_{m+1,N})\\w_{m+1,i}=\frac{w_{mi}}{Z_m}exp(-\alpha_my_iG_m(x_i))=\left\{ \begin{aligned} \frac{w_{mi}}{Z_m}e^{-\alpha_m}\quad\quad G_m(x_i)=y_i\\ \frac{w_{mi}}{Z_m}e^{\alpha_m}\quad\quad G_m(x_i)\ne y_i \\ \end{aligned} \right.
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.94356em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.48712em; vertical-align: -1.99356em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.35002em;"><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎩</span></span></span><span class="" style="top: -2.19999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎨</span></span></span><span class="" style="top: -4.30001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎪</span></span></span><span class="" style="top: -4.60002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.85002em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.49356em;"><span class="" style="top: -4.49356em;"><span class="pstrut" style="height: 3.10756em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.821331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: -0.0037em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.10756em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.10756em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: -0.0037em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.99356em;"><span class=""></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            e
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           ≤
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mn>
            2
           </mn>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          e_m\le\frac{1}{2}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.78597em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>时，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           ≥
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_m\ge 0
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.78597em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>,所以正确分类时，样本权值被缩小，错误分类时，样本权值被增大。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            Z
           </mi>
           <mi>
            m
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          Z_m
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是规范因子<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             Z
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <munderover>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             N
            </mi>
           </munderover>
           <msub>
            <mi>
             w
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mi>
              i
             </mi>
            </mrow>
           </msub>
           <mi>
            e
           </mi>
           <mi>
            x
           </mi>
           <mi>
            p
           </mi>
           <mo>
            (
           </mo>
           <mo>
            −
           </mo>
           <msub>
            <mi>
             α
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <msub>
            <mi>
             G
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           Z_m=\sum_{i=1}^Nw_{mi}exp(-\alpha_my_iG_m(x_i))
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></li> 
   <li>构建基本分类器的线性组合<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            f
           </mi>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <munderover>
            <mo>
             ∑
            </mo>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             M
            </mi>
           </munderover>
           <msub>
            <mi>
             α
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <msub>
            <mi>
             G
            </mi>
            <mi>
             m
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           f(x) = \sum_{m=1}^M\alpha_mG_m(x)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.09545em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></span>得到最终分类器为<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            G
           </mi>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            s
           </mi>
           <mi>
            i
           </mi>
           <mi>
            g
           </mi>
           <mi>
            n
           </mi>
           <mo>
            (
           </mo>
           <mi>
            f
           </mi>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           G(x) = sign(f(x))
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></li> 
  </ol> 
  <h4><a id="32_AdaBoost_48"></a>3.2 前向分步加法模型与AdaBoost</h4> 
  <p>  AdaBoost的另一种解释为：模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。<br>   前向分布算法的目标是训练一个加法模型<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          f
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            m
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           M
          </mi>
         </msubsup>
         <msub>
          <mi>
           β
          </mi>
          <mi>
           m
          </mi>
         </msub>
         <mi>
          b
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo separator="true">
          ;
         </mo>
         <msub>
          <mi>
           γ
          </mi>
          <mi>
           m
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         f(x)=\sum_{m=1}^M\beta_mb(x;γ_m)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.28094em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit">b</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.05556em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>,给定训练数据和损失函数，学习加法模型就变成损失函数最小化问题，通常整体优化比较复杂，所以从前向后，每一步只学习一个基函数及其系数。经过推导，AdaBoost是模型为加法模型，损失函数为指数函数，学习算法为前向分布算法的二分类学习算法。</p> 
  <h4><a id="33_AdaBoost_51"></a>3.3 提升树【提升树和AdaBoost的关系】</h4> 
  <p>  <strong>前向分布算法+决策树（分类树or回归树）=提升树</strong><br>   提升树是以分类树或者回归树为基本分类器的提升方法。分类问题用二叉分类树，回归问题用二叉回归树，最简单的回归树可看做是一个根节点连接的左右子树的二叉树，即所谓的决策树桩。提升树的模型可表示为： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            M
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            M
           </mi>
          </munderover>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_M(x) = \sum_{m=1}^MT(x;\Theta_m)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.09545em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo separator="true">
          ;
         </mo>
         <msub>
          <mi mathvariant="normal">
           Θ
          </mi>
          <mi>
           m
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         T(x;\Theta_m)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>表示决策树，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="normal">
           Θ
          </mi>
          <mi>
           m
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \Theta_m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示决策树的参数；<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          M
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         M
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span>表示树的个数。<br>   提升树算法采用前向分布算法，首先确定初始提升树<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <mn>
          0
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         f_0(x)=0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>，第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>步的模型是<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_m(x) = f_{m-1}(x)+T(x;\Theta_m)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mo>
            −
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         f_{m-1}(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>为当前模型，通过经验风险极小化确定下一棵决策树的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi mathvariant="normal">
           Θ
          </mi>
          <mi>
           m
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \Theta_m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mover accent="true">
            <mi mathvariant="normal">
             Θ
            </mi>
            <mo stretchy="true">
             ^
            </mo>
           </mover>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           a
          </mi>
          <mi>
           r
          </mi>
          <mi>
           g
          </mi>
          <mi>
           m
          </mi>
          <mi>
           i
          </mi>
          <msub>
           <mi>
            n
           </mi>
           <msub>
            <mi mathvariant="normal">
             Θ
            </mi>
            <mi>
             m
            </mi>
           </msub>
          </msub>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            y
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \widehat{\Theta}_m = argmin_{\Theta_m}\sum_{i=1}^NL(y_i,f_{m-1}(x_i)+T(x_i;\Theta_m))
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Θ</span></span></span><span class="svg-align" style="top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;">
               <svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none">
                <path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path>
               </svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span>  针对不同的问题，提升树有不同的形式，主要区别在于损失函数不同，<strong>回归问题</strong>：平方误差损失函数；<strong>分类问题</strong>：指数损失函数；<strong>一般决策问题</strong>：一般损失函数。分类问题的提升树改变权重，回归问题的提升树拟合残差。损失函数是平方损失函数的时候，残差易求，如果不是平方损失函数也不是指数损失函数，残差就不可求，这时，就要用损失函数关于当前模型<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mo>
            −
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         f_{m-1}(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>的负梯度来近似代替残差。梯度提升算法就是用梯度下降法来讲弱分类器提升为强分类器的算法。<br> <a href="https://blog.csdn.net/lianjixuexi/article/details/78972594" rel="nofollow"><strong>提升树和AdaBoost之间是什么关系</strong>？</a><br>   AdaBoost是提升思想的算法模型,经典的AdaBoost一般用于分类问题，并没有指定基函数，或者说是基分类器，它可以从改变样本的权值的角度和前向分布算法的角度来解释。当确定基函数是回归或分类树时，结合前向分布算法就得出提升树算法。<br>   使用梯度提升进行分类的算法叫做GBDT，进行回归时则叫做GBRT。一般的提升树是用残差来确定树的叶节点的切分，并根据残差来确定该切分下的输出值，而GBDT首先是根据负梯度来确定切分，确定切分后根据线性搜索估计叶节点区域的值，使损失函数极小化。这就好比是寻找一个全局极小值，负梯度只给定一个方向，通过线性搜索确定在该方向下走几步。所以可以认为伪残差是只给出方向的残差。</p> 
  <h5><a id="331__58"></a>3.3.1 回归提升树</h5> 
  <p>  对于分类问题，只需要将上述的AdaBoost的基学习器限定为二分类树，其余的和上述的AdaBoost内容无差。对于回归问题，可看做是对输入空间<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          χ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         χ
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit">χ</span></span></span></span></span>划分为J个不相交的区域，在每个区域上输出的常量为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           c
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         c_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，那么树可以表示为： <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <mi>
           θ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            J
           </mi>
          </munderover>
          <msub>
           <mi>
            c
           </mi>
           <mi>
            j
           </mi>
          </msub>
          <mi>
           I
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           ∈
          </mo>
          <msub>
           <mi>
            R
           </mi>
           <mi>
            j
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          T(x; \theta)=\sum_{j=1}^J c_j I(x \in R_j)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
         <mo>
          =
         </mo>
         <mo>
          {
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           R
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           c
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           R
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           c
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           R
          </mi>
          <mi>
           J
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           c
          </mi>
          <mi>
           J
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta=\{(R_1, c_1), (R_2, c_2),...,(R_J, c_J)\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span>表示树的区域和区域上的常数，J表示区域的个数,是回归树的复杂度即叶结点的个数。<br>   对于回归树的前向分步式算法有：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
          <mspace linebreak="newline"></mspace>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <mi mathvariant="normal">
           Θ
          </mi>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
          <mi>
           m
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           2
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           M
          </mi>
          <mspace linebreak="newline"></mspace>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            M
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            M
           </mi>
          </munderover>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_0(x)=0\\f_m(x)=f_{m-1}(x)+T(x; \Theta), m= 1, 2, ..., M\\f_M(x)=\sum_{m=1}^M T(x;\Theta_m)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Θ</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.09545em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>在前向分步式算法的第m步，给定<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
         <mi mathvariant="normal">
          −
         </mi>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         m−1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord mathit">m</span><span class="mord">−</span><span class="mord">1</span></span></span></span></span>步的情况，需要求解：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi>
            θ
           </mi>
           <mi>
            m
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo>
           =
          </mo>
          <mi>
           a
          </mi>
          <mi>
           r
          </mi>
          <mi>
           g
          </mi>
          <munder>
           <mi>
            min
           </mi>
           <mo>
            ⁡
           </mo>
           <msub>
            <mi mathvariant="normal">
             Θ
            </mi>
            <mi>
             m
            </mi>
           </msub>
          </munder>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            y
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi>
            θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \theta_m^* = arg\min_{\Theta_m}\sum_{i=1}^N L(y_i, f_{m-1}(x_i)+T(x_i; \theta_m)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.985696em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -2.453em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.05567em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.164543em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.844431em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>得到第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>颗树的参数。<br>   这里我们采用平方误差拟合回归问题，则：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <mi>
           y
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mi>
           y
          </mi>
          <mo>
           −
          </mo>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <msup>
           <mo>
            )
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          L(y,f(x)=(y-f(x))^2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>其损失变为：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <mi>
           y
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <mi>
           y
          </mi>
          <mo>
           −
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           :
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <msup>
           <mo>
            ]
           </mo>
           <mn>
            2
           </mn>
          </msup>
          <mspace linebreak="newline"></mspace>
          <mspace width="2em"></mspace>
          <mspace width="2em"></mspace>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <mi>
           r
          </mi>
          <mo>
           −
          </mo>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <msup>
           <mo>
            ]
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          L(y, f_{m-1}(x)+T(x; \Theta_m))=[y-f_{m-1}(x)-T(x: \Theta_m)]^2\\\qquad \qquad =[r-T(x; \Theta_m)]^2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          r
         </mi>
         <mo>
          =
         </mo>
         <mi>
          y
         </mi>
         <mi mathvariant="normal">
          −
         </mi>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mi mathvariant="normal">
            −
           </mi>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         r=y−f_{m−1}(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mord">−</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>是当前拟合的残差，而目前我们的学习任务也仅仅是拟合这个残差,整个算法的步骤：<br> (1). 初始化<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <mn>
          0
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         f_0(x)=0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span><br> (2). 对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          2
         </mn>
         <mo>
          ⋯
         </mo>&amp;ThinSpace;
         <mo separator="true">
          ,
         </mo>
         <mi>
          M
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m=1,2\cdots,M
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>a. 计算残差<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          r
         </mi>
         <mo>
          =
         </mo>
         <mi>
          y
         </mi>
         <mi mathvariant="normal">
          −
         </mi>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mi mathvariant="normal">
            −
           </mi>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         r=y−f_{m−1}(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mord">−</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>b. 拟合残差，学习一个回归树，得到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo separator="true">
          ;
         </mo>
         <mi mathvariant="normal">
          Θ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         T(x; \Theta)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Θ</span><span class="mclose">)</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>c. 更新<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           f
          </mi>
          <mi>
           m
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           f
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mo>
            −
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          +
         </mo>
         <mi>
          T
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo separator="true">
          ;
         </mo>
         <mi mathvariant="normal">
          Θ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         f_m(x)=f_{m-1}(x)+T(x; \Theta)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">Θ</span><span class="mclose">)</span></span></span></span></span><br> (3). 得到回归提升树<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            M
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            M
           </mi>
          </munderover>
          <mi>
           T
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ;
          </mo>
          <msub>
           <mi mathvariant="normal">
            Θ
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_M(x)=\sum_{m=1}^MT(x;\Theta_m)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.09545em; vertical-align: -1.26711em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">Θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p> 
  <h5><a id="332__68"></a>3.3.2 梯度提升树</h5> 
  <p>  前面用到的损失函数都有比较好的性质，如平方误差、指数函数等，但对于一般的函数来说，问题可能会变得复杂些，针对这一问题Freidman提出了梯度提升（Gradient Boosting），这是利用最速下降的近似方法，其关键是利用损失函数的负梯度在当前模型的值<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          −
         </mo>
         <mo fence="true">
          [
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <mi>
            y
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            f
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            f
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
          </mrow>
         </mfrac>
         <msub>
          <mo fence="true">
           ]
          </mo>
          <mrow>
           <mi>
            f
           </mi>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             f
            </mi>
            <mrow>
             <mi>
              m
             </mi>
             <mo>
              −
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         -\Biggl[{\partial L(y,f(x_i)) \over \partial f(x_i)}\Biggr]_{f(x)=f_{m-1}(x)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.22473em; vertical-align: -1.47473em;"></span><span class="mord">−</span><span class="mopen"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathit mtight">L</span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose"><span class="mclose"><span class="delimsizing size4">]</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.40027em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.10764em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.47473em;"><span class=""></span></span></span></span></span></span></span></span></span></span>作为近似残差，拟合一个回归树。<br> <strong>算法步骤</strong>：<br> (1). 初始化<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mi>
           a
          </mi>
          <mi>
           r
          </mi>
          <mi>
           g
          </mi>
          <munder>
           <mi>
            min
           </mi>
           <mo>
            ⁡
           </mo>
           <mi>
            c
           </mi>
          </munder>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            y
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           c
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_0(x)=arg\min_c\sum_{i=1}^N L(y_i, c)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.1em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">c</span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></span></span>估计使损失函数极小化的常数值，是只有一个根节点的树。<br> (2). 对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          2
         </mn>
         <mo>
          ⋯
         </mo>&amp;ThinSpace;
         <mo separator="true">
          ,
         </mo>
         <mi>
          M
         </mi>
         <mo>
          :
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         m=1,2\cdots,M:
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>a . 对于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          2
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          N
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i=1,2,...,N
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span>, 计算<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            r
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             i
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           −
          </mo>
          <mo fence="true">
           [
          </mo>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             L
            </mi>
            <mo>
             (
            </mo>
            <mi>
             y
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             f
            </mi>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              x
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo>
             )
            </mo>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             f
            </mi>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              x
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
          <msub>
           <mo fence="true">
            ]
           </mo>
           <mrow>
            <mi>
             f
            </mi>
            <mo>
             (
            </mo>
            <mi>
             x
            </mi>
            <mo>
             )
            </mo>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              f
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <mo>
             (
            </mo>
            <mi>
             x
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          r_{mi}=-\Biggl[{\partial L(y,f(x_i)) \over \partial f(x_i)}\Biggr]_{f(x)=f_{m-1}(x)}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.22473em; vertical-align: -1.47473em;"></span><span class="mord">−</span><span class="mopen"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose"><span class="mclose"><span class="delimsizing size4">]</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"><span class="" style="top: -1.40027em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.10764em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.47473em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>损失函数的负梯度在当前模型的值，将其作为残差的估计。<strong>当损失函数是平方损失函数的时候，负梯度为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mn>
           2
          </mn>
          <mo>
           (
          </mo>
          <mi>
           y
          </mi>
          <mo>
           −
          </mo>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
          <mi mathvariant="normal">
           ∣
          </mi>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mn>
           2
          </mn>
          <mo>
           (
          </mo>
          <mi>
           y
          </mi>
          <mo>
           −
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          2(y-f(x))| f_{m-1}(x)=2(y-f_{m-1}(x))
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>,文章说也就是通常所说的残差，这个2倍关系是我计算错了吗</strong>？<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>b . 拟合<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           r
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         r_{mi}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，学习一个回归树的叶节点区域<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           R
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi>
          j
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          2
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         R_{mj},j=1,2,...,J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>c.对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          2
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j=1,2,...,J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>计算<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            c
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           a
          </mi>
          <mi>
           r
          </mi>
          <mi>
           g
          </mi>
          <munder>
           <mi>
            min
           </mi>
           <mo>
            ⁡
           </mo>
           <mi>
            c
           </mi>
          </munder>
          <munder>
           <mo>
            ∑
           </mo>
           <mrow>
            <msub>
             <mi>
              x
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo>
             ∈
            </mo>
            <msub>
             <mi>
              R
             </mi>
             <mrow>
              <mi>
               m
              </mi>
              <mi>
               j
              </mi>
             </mrow>
            </msub>
           </mrow>
          </munder>
          <mi>
           L
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            y
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           c
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          c_{mj}=arg\min_c\sum_{x_i \in R_{mj}} L(y_i, f_{m-1}(x_i)+c)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.54166em; vertical-align: -1.49166em;"></span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.1em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">c</span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.00773em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.49166em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></span></span>利用线性搜索估计叶结点区域的值，使损失函数极小化。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mspace width="1em"></mspace>
         <mspace width="1em"></mspace>
        </mrow>
        <annotation encoding="application/x-tex">
         \quad\quad
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>d.更新<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            m
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            J
           </mi>
          </munderover>
          <msub>
           <mi>
            c
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mi>
           I
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           ∈
          </mo>
          <msub>
           <mi>
            R
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f_m(x)=f_{m-1}(x)+\sum_{j=1}^J c_{mj}I(x \in R_{mj})
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span>(3). 得到回归树：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <msup>
           <mo>
            )
           </mo>
           <mo>
            ∗
           </mo>
          </msup>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            f
           </mi>
           <mi>
            M
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             m
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            M
           </mi>
          </munderover>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            J
           </mi>
          </munderover>
          <msub>
           <mi>
            c
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mi>
           I
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           ∈
          </mo>
          <msub>
           <mi>
            R
           </mi>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          f(x)^*=f_M(x)=\sum_{m=1}^M\sum_{j=1}^J c_{mj}I(x \in R_{mj})
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p> 
  <h3><a id="__77"></a>四 习题</h3> 
  <p><strong>8.1 某公司招聘支援考查身体、业务能力、发展潜力这三项。身体分为合格1、不合格0两级，业务能力和发展潜力分为上1，中2，下3三级。分类为合格1，不合格-1两类。已知10个人的数据，如下表所示，假设弱分类器为决策树桩，试用AdaBoost算法学习一个强分类器。</strong></p> 
  <table border="0" cellpadding="0" cellspacing="0" width="704"> 
   <colgroup>
    <col width="64" span="11"> 
   </colgroup>
   <tbody>
    <tr height="18"> 
     <td colspan="11" height="18" class="xl639524" width="704">应聘人员情况数据表</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl639524"></td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">2</td> 
     <td class="xl639524">3</td> 
     <td class="xl639524">4</td> 
     <td class="xl639524">5</td> 
     <td class="xl639524">6</td> 
     <td class="xl639524">7</td> 
     <td class="xl639524">8</td> 
     <td class="xl639524">9</td> 
     <td class="xl639524">10</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl639524">身体</td> 
     <td class="xl639524">0</td> 
     <td class="xl639524">0</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">0</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">0</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl639524">业务</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">3</td> 
     <td class="xl639524">2</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">2</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">3</td> 
     <td class="xl639524">2</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl639524">潜力</td> 
     <td class="xl639524">3</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">2</td> 
     <td class="xl639524">3</td> 
     <td class="xl639524">3</td> 
     <td class="xl639524">2</td> 
     <td class="xl639524">2</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl639524">分类</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">1</td> 
     <td class="xl639524">-1</td> 
     <td class="xl639524">-1</td> 
    </tr> 
   </tbody>
  </table> 
  <pre><code class="prism language-python"><span class="token keyword">from</span> numpy <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment"># adaBoost算法</span>
<span class="token comment"># 决策树桩仅分裂一次，也就是说只选择一次特征</span>
<span class="token comment"># 决策树桩由三部分组成，特征，特征值，不等号的方向</span>
                               
<span class="token comment"># 读入数据</span>
<span class="token keyword">def</span> <span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dataMat <span class="token operator">=</span> matrix<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    classLabels <span class="token operator">=</span> matrix<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span> <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
    <span class="token keyword">return</span> dataMat<span class="token punctuation">,</span> classLabels


<span class="token comment"># 根据当前树桩对数据进行分类</span>
<span class="token keyword">def</span> <span class="token function">stumpClassify</span><span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> dimen<span class="token punctuation">,</span> threshVal<span class="token punctuation">,</span> threshIneq<span class="token punctuation">)</span><span class="token punctuation">:</span>
    retArray <span class="token operator">=</span> ones<span class="token punctuation">(</span><span class="token punctuation">(</span>shape<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#预测矩阵</span>
    <span class="token comment">#左叶子 ，整个矩阵的样本进行比较赋值</span>
    <span class="token keyword">if</span> threshIneq <span class="token operator">==</span> <span class="token string">'lt'</span><span class="token punctuation">:</span>
        retArray<span class="token punctuation">[</span>dataMatrix<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> dimen<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> threshVal<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.0</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        retArray<span class="token punctuation">[</span>dataMatrix<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> dimen<span class="token punctuation">]</span> <span class="token operator">&gt;</span> threshVal<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.0</span>
    <span class="token keyword">return</span> retArray

<span class="token triple-quoted-string string">''' # 根据数据，标签和权值分布构造弱分类器，即决策树桩 stump 树桩 # D为数据权重向量 # numStep是步数，据此可算出步长， bestClassEst是最优情况下的分类情况 构造树桩要做的是： 选择合适的特征，选择合适的阈值 bestStump['dim'] 合适的特征所在维度 bestStump['thresh'] 合适特征的阈值 bestStump['ineq'] '''</span>
<span class="token keyword">def</span> <span class="token function">buildStump</span><span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> classLabels<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> shape<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">)</span>
    numStep <span class="token operator">=</span> <span class="token number">10.0</span>
    bestStump <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">#字典</span>
    minError <span class="token operator">=</span> inf
    bestClasEst <span class="token operator">=</span> mat<span class="token punctuation">(</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#n是特征的种类数 </span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        rangeMin <span class="token operator">=</span> dataMatrix<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#求每一种特征的最大最小值</span>
        rangeMax <span class="token operator">=</span> dataMatrix<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        stepSize <span class="token operator">=</span> <span class="token punctuation">(</span>rangeMax<span class="token operator">-</span>rangeMin<span class="token punctuation">)</span><span class="token operator">/</span>numStep
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>numStep<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            threshVal <span class="token operator">=</span> rangeMin <span class="token operator">+</span> j<span class="token operator">*</span>stepSize
            <span class="token comment">#不知左树-1准确率高还是右树，因此有这样一个计算</span>
            <span class="token keyword">for</span> inequal <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'lt'</span><span class="token punctuation">,</span> <span class="token string">'rt'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                predictVals <span class="token operator">=</span> stumpClassify<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> i<span class="token punctuation">,</span> threshVal<span class="token punctuation">,</span> inequal<span class="token punctuation">)</span>
                errArr <span class="token operator">=</span> mat<span class="token punctuation">(</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                errArr<span class="token punctuation">[</span>predictVals <span class="token operator">==</span> classLabels<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                weightedError <span class="token operator">=</span> D<span class="token punctuation">.</span>T<span class="token operator">*</span>errArr
                <span class="token keyword">if</span> weightedError <span class="token operator">&lt;</span> minError<span class="token punctuation">:</span>
                    minError <span class="token operator">=</span> weightedError
                    bestClassEst <span class="token operator">=</span> predictVals
                    bestStump<span class="token punctuation">[</span><span class="token string">'dim'</span><span class="token punctuation">]</span> <span class="token operator">=</span> i
                    bestStump<span class="token punctuation">[</span><span class="token string">'thresh'</span><span class="token punctuation">]</span> <span class="token operator">=</span> threshVal
                    bestStump<span class="token punctuation">[</span><span class="token string">'ineq'</span><span class="token punctuation">]</span> <span class="token operator">=</span> inequal
    <span class="token keyword">return</span> bestStump<span class="token punctuation">,</span> minError<span class="token punctuation">,</span> bestClassEst


<span class="token comment"># adaBoost训练过程</span>
<span class="token keyword">def</span> <span class="token function">adaBoostTrain</span><span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> classLabels<span class="token punctuation">,</span> numIter<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    weakClassArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">#弱分类器</span>
    m <span class="token operator">=</span> shape<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment">#样本个数</span>
    D <span class="token operator">=</span> mat<span class="token punctuation">(</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>m<span class="token punctuation">)</span>  <span class="token comment">#一开始是均值权重分布</span>
    aggClassEst <span class="token operator">=</span> mat<span class="token punctuation">(</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>numIter<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#numIter 弱分类器的个数</span>
        bestStump<span class="token punctuation">,</span> error<span class="token punctuation">,</span> classEst <span class="token operator">=</span> buildStump<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> classLabels<span class="token punctuation">,</span> D<span class="token punctuation">)</span>
        <span class="token comment"># 防止除以零溢出</span>
        alpha <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token operator">*</span>log<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>error<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">max</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        bestStump<span class="token punctuation">[</span><span class="token string">'alpha'</span><span class="token punctuation">]</span> <span class="token operator">=</span> alpha
        weakClassArr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>bestStump<span class="token punctuation">)</span>
        expon <span class="token operator">=</span> multiply<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>alpha<span class="token operator">*</span>classLabels<span class="token punctuation">,</span> classEst<span class="token punctuation">)</span>
        D <span class="token operator">=</span> multiply<span class="token punctuation">(</span>D<span class="token punctuation">,</span> exp<span class="token punctuation">(</span>expon<span class="token punctuation">)</span><span class="token punctuation">)</span>
        D <span class="token operator">/=</span> D<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        aggClassEst <span class="token operator">+=</span> alpha<span class="token operator">*</span>classEst  <span class="token comment">#弱分类器结果的求和</span>
        <span class="token comment"># 比较两个矩阵的值得出预测正误情况</span>
        aggError <span class="token operator">=</span> sign<span class="token punctuation">(</span>aggClassEst<span class="token punctuation">)</span> <span class="token operator">!=</span> classLabels
        errorRate <span class="token operator">=</span> aggError<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>m
        <span class="token keyword">print</span><span class="token punctuation">(</span>errorRate<span class="token punctuation">)</span>
        <span class="token keyword">if</span> errorRate <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    <span class="token keyword">return</span> weakClassArr

<span class="token keyword">def</span> <span class="token function">adaClassify</span><span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> classifierArr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> shape<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    aggClassEst <span class="token operator">=</span> mat<span class="token punctuation">(</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>classifierArr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        stump <span class="token operator">=</span> classifierArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        classEst <span class="token operator">=</span> stumpClassify<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> stump<span class="token punctuation">[</span><span class="token string">'dim'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stump<span class="token punctuation">[</span><span class="token string">'thresh'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stump<span class="token punctuation">[</span><span class="token string">'ineq'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        aggClassEst <span class="token operator">+=</span> stump<span class="token punctuation">[</span><span class="token string">'alpha'</span><span class="token punctuation">]</span><span class="token operator">*</span>classEst
    <span class="token keyword">return</span> sign<span class="token punctuation">(</span>aggClassEst<span class="token punctuation">)</span>

dataMat<span class="token punctuation">,</span> classLabels <span class="token operator">=</span> loadData<span class="token punctuation">(</span><span class="token punctuation">)</span>
classifiers <span class="token operator">=</span> adaBoostTrain<span class="token punctuation">(</span>dataMat<span class="token punctuation">,</span> classLabels<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> adaClassify<span class="token punctuation">(</span>mat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> classifiers<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>labels<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dim\tthresh\tinep\talpha'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>classifiers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'dim'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\t'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classifiers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'thresh'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token operator">+</span><span class="token string">'\t'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classifiers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ineq'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\t'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>classifiers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'alpha'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190217135714454.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNTQ3OTEwOA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 前面6行是误差率，[-1]是对第5个样本的预测，dim表示特征维度，thresh表示划分阈值，inep左树还是右树准确率高。<br> <strong>8.2 比较支持向量机，AdaBoost，逻辑斯蒂回归模型的学习策略与算法</strong>。</p> 
  <table border="0" cellpadding="0" cellspacing="0" width="681"> 
   <colgroup>
    <col width="128"> 
    <col width="280"> 
    <col width="273"> 
   </colgroup>
   <tbody>
    <tr height="18"> 
     <td height="18" class="xl1526162" width="128"></td> 
     <td class="xl1526162" width="280">策略</td> 
     <td class="xl1526162" width="273">算法</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl1526162">支持向量机</td> 
     <td class="xl1526162">极小化正则化合页损失，软间隔最大化</td> 
     <td class="xl1526162">序列最小最优化（SMO）</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl1526162">逻辑斯蒂回归模型</td> 
     <td class="xl1526162">极大对数似然函数，正则化的极大似然估计</td> 
     <td class="xl1526162">改进的迭代尺度算法，梯度下降，拟牛顿</td> 
    </tr> 
    <tr height="18"> 
     <td height="18" class="xl1526162">AdaBoost</td> 
     <td class="xl1526162">极小化加法模型的指数损失</td> 
     <td class="xl1526162">前向分步加法算法</td> 
    </tr> 
   </tbody>
  </table> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
