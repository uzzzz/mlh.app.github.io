<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>深度学习 GAN模式崩溃的理论解释 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="深度学习 GAN模式崩溃的理论解释" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="来源：老顾谈几何 本文约4040字，建议阅读7分钟。 本文与你讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释。 春节前夕，北美遭遇极端天气，在酷寒中笔者来到哈佛大学探望丘成桐先生。新春佳节，本是普天同庆的日子，但对于孤悬海外的游子而言，却是最为凄凉难耐。远离父母亲朋，远离故国家园，自然环境寒风凛冽，飞雪漫天，社会环境疏离淡漠，冷清寂寥。在波士顿见到导师和朋友，倍感欣慰。笔者曾经辅导过的Kylie刚刚从哈佛毕业。哈佛本科生的主流一般选择进入华尔街的金融公司，Kylie却特立独行地选择了教育。笔者辅导过的Simon刚刚被哈佛录取，矢志投身数学。在查尔斯河畔的LegalSeafood, Kylie给了Simon很多在哈佛求学的建议。看到弟子们的茁壮成长，笔者不禁感慨万千：时光荏苒，昭华流逝，人生苦短，择英才而教之，生命才会更有意义！ 笔者和哈佛大学统计系的刘军教授交流，刘教授告诉笔者最近有麻省理工的学者来哈佛寻求教职，求职学术演讲的主题就是最优传输理论在深度学习中的应用。由此可以，深度学习的最优传输理论解释逐渐被广泛接受。在哈佛大学的数学科学与应用中心（Harvard CMSA），丘先生和笔者进一步探讨深度学习中对抗生成网络和蒙日-安培方程理论的关系。 遥想二十多年前，笔者刚刚投到丘先生门下的时候，丘先生教给笔者的第一个几何分析的利器就是蒙日-安培方程理论（Monge-Ampere Equation）。那时，笔者在麻省理工大学学习机器视觉课程，需要求解闵科夫斯基（Minkowski）问题，即利用高斯曲率反求曲面形状。丘先生指导笔者用蒙日-安培方程来解决这一问题。当时无论如何也无法想象二十多年后，这一理论会在深度学习领域发挥重要作用。 近些年来，深度学习的革命几乎席卷了整个计算机科学领域，尤其是这两年来对抗生成网络模型（GAN）石破天惊、一骑绝尘，而蒙日-安培理论恰好可以为GAN提供强有力的理论支持。多少年来，丘先生一直强调基础理论的重要性，他曾经多次说道：“人类历史上技术的本质发展都是来自基础理论的重大突破，基础理论突破后往往经过数十年才会被工程技术领域所领会吸收。因此，对于科学的发展应该持有长远的观点，不能急功近利。”在笔者数十年的学术生涯中，多次见证了丘先生所预言的情形发生，例如陈类之于拓扑绝缘体，证明庞加莱猜测的黎奇曲率流（Ricci FLow）之于医学图像。 目前，笔者和很多合作者们倾向于认为蒙日-安培理论，最优传输理论对深度学习的发展会起到实质性作用，并为之孜孜以求。这次和丘先生主要讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释，细节请见论文【1】。 模式崩溃 （Mode Collapse） 对抗生成网络被广泛应用于图像生成领域，比较常用的有超分辨率、图像翻译、卡通人物生成、人体姿态生成、年龄变换、风格变换等等，超乎想象，精彩纷呈。另一方面，GAN模型训练困难，变化无常，神秘莫测。由于其强烈的不稳定性，目前难以大规模实用。 图1. MNIST数据集 tSNE 嵌入在平面上，10个团簇对应着10个模式（modes）。模式崩溃（Mode Collapse）指生成模型只生成其中的几种模式。 如图1所示，给定数据集合，我们用编码映射将其映入隐空间中，每个数字对应一个团簇，即MNIST数据的概率分布密度函数具有多个峰值，每个峰值被称为是一个模式（mode）。理想情况下，生成模型应该能够生成10个数字，如果只能生成其中的几个，而错失其它的模式，则我们称这种现象为模式崩溃（mode collapse）。 具体而言，GAN训练中经常出现如下三个层次的问题： 训练过程难以收敛，经常出现震荡；实验结果随机，难以复现； 训练收敛，但是出现模式崩溃（Mode Collapse）。例如，我们用MNIST数据集训练GAN模型，训练后的GAN只能生成十个数字中的某一个；或者在人脸图片的实验中，只生成某一种风格的图片。 用真实图片训练后的GAN模型涵盖所有模式，但是同时生成一些没有意义、或者现实中不可能出现的图片。 我们将这些现象笼统称为广义的模式崩溃问题。如何解释模式崩溃的原因，如何设计新型算法避免模式崩溃，这些是深度学习领域的最为基本的问题。我们用最优传输中的Brenier理论，和蒙日-安培方程（Monge-Ampere）的正则性（regularity）理论来解释模式崩溃问题。 GAN和蒙日-安培方程 我们以前讨论过对抗生成网络的最优传输观点：生成器（Generator）将隐空间的高斯分布变换成数据流形上一个分布，判别器（Discriminator）计算生成分布和真实数据分布之间的距离，例如Wasserstein距离。这些操作本质上都可以用最优传输理论来解释，并且加以改进。以欧氏距离平方为代价函数的最优传输问题归结为Brenier理论，并且等价于凸几何中的Alexandrov理论，最终归结为蒙日-安培方程。 假设在隐空间中，在源区域上定义了概率测度，在目标区域上定义了概率测度，，。同时存在，满足，由Brenier定理，存在全局Lipschitz凸函数，其梯度映射给出最优传输映射，即保持测度：对于任意Borel集合，, ， 同时极小化传输代价 . 这里凸函数被称为是Brenier势能函数。Brenier势能函数给出蒙日-安培方程（Monge-Ampere Equation)的弱解： . 在工程计算中，我们通常用Alexandrov弱解来逼近真实解，我们以前讨论过Alexandrov弱解的存在性和唯一性。 蒙日-安培方程的正则性理论 Brenier势能函数是蒙日-安培方程的解，其光滑性是一个错综复杂的问题。汪徐家教授是这一领域的国际权威之一，给了笔者很多帮助。我们假设源域是凸区域，如果也是凸区域，那么Caffarelli理论给出了Brenier势能函数的正则性。我们回忆赫德尔系数（Holder coefficient）为 , 赫德尔空间定义为： 如果密度函数，,那么Brenier势能函数，这里并且。 但是，如果目标概率分布的支集非凸，那么即便密度函数光滑，蒙日-安培方程的解有可能不可微，，进一步最优传输映射非连续。 由Brenier定理，Brenier势能函数为整体Lipschitz，因此几乎处处可导。我们称可求导的点为正常点（regular point），不可求导的点为奇异点（singular point），则奇异点集合为零测度。我们考察每一点处的次微分， 定义（次微分）一个凸函数在点的次微分（subdifferential）定义为集合 正常点的次微分只包含函数的梯度，即&nbsp;，奇异点的次微分是一个无穷集合。我们定义集合， 显然，是正常点集合，是奇异点集合，这里。每一个奇异点都可以用正常点的Cauchy序列来逼近，由此，我们可以定义可达次微分， 可以证明：次微分等于可达次微分的凸包（convex hull）， . 图2. 最优传输映射中的奇异点集合，（苏科华作）。 如图2所示，目标测度的支集具有两个联通分支，我们稠密采样目标测度，表示成定义在两个团簇上面的狄拉克测度。我们然后计算蒙日-安培方程的Alenxandrov解。依随采样密度增加，狄拉克测度弱收敛到目标测度，Alenxandrov解收敛到真实解。我们看到Brenier势能函数的Alenxandrov解可以表示成一张凸曲面，图曲面中间有一条脊线（ridge），脊线的投影是最优传输映射的奇异点集。 图3. GPU版本的最优传输映射（郭洋、Simon Lam 作）。 图3显示了基于GPU算法的从平面长方形上的均匀分布到两个半圆盘上的均匀分布的最优传输映射，长方形的中线显示了最优传输映射的奇异点集。 图4. GPU版本的最优传输映射（郭洋、Simon Lam作）。 图4从平面长方形上的均匀分布到哑铃形状上的均匀分布的最优传输映射，仔细观察，我们可以看出最优传输映射的奇异点集是中线上的两条线段，介于红蓝斑点之间。 图5. 最优传输映射的奇异点结构（齐鑫、苏科华作）。 图5显示了二维最优传输映射的奇异点结构：这里源区域是单位圆盘，目标区域是平面上非凸区域，带有一个孔洞。Breinier势能函数的奇异点集标注在左帧，，每个奇异点的次微分覆盖一个二维区域，覆盖的孔洞，覆盖右侧的灰色三角形； 每一条曲线覆盖边界处的一个“豁口”，上的任意一点，次微分是外、联结着边界上两点的直线段，可达次微分是边界上的那两点。奇异点的测度为0，Brenier势能函数几乎处处可微，最优传输映射在上几乎处处连续，在上间断。 图6. 实心兔子和实心球之间的最优传输映射，表面皱褶结构，(苏科华作)。 最优传输映射的奇异点结构理论在高维空间依然成立，如图6所示，实心球体和实心兔子体之间的最优传输映射诱导了兔子表面上的大量皱褶，最优传输映射在皱褶处间断。 最优传输映射具有奇异点，那么一般传输映射又会如何？假设我们有映射，将概率测度推前到概率测度，Brenier极分解定理断言，存在唯一的分解， 这里是最优传输映射，是雅可比行列式处处为1的自映射。由此，一般的传输映射也存在奇异点，映射在奇异点处间断。 模式崩溃的理论解释 目前的深度神经网络只能够逼近连续映射，而传输映射是具有间断点的非连续映射，换言之，GAN训练过程中，目标映射不在DNN的可表示泛函空间之中，这一显而易见的矛盾导致了收敛困难；如果目标概率测度的支集具有多个联通分支，GAN训练得到的又是连续映射，则有可能连续映射的值域集中在某一个连通分支上，这就是模式崩溃（mode collapse）；如果强行用一个连续映射来覆盖所有的连通分支，那么这一连续映射的值域必然会覆盖之外的一些区域，即GAN会生成一些没有现实意义的图片。这给出了GAN模式崩溃的直接解释。 那么，如何来用真实数据验证我们的猜测呢？我们用CelebA数据集验证了传输映射的非连续性。 图7. AE-OT体系结构。 如图7所示我们认为人脸图片在图像空间中的分布集中在某个低维流形附近，我们用自动编码器（Autoencoder），将流形映入到隐空间中，编码映射记为，解码映射记为。编码映射将分布推前到隐空间的分布，的支集为。商空间中的最优传输映射为，这里是单位立方体，为均匀分布。我们在中随机采样，那么是生成的人脸图片。 图8. AE-OT生成的人脸图像。 图9. 在隐空间进行插值的结果。 如图9所示，我们在隐空间中任选两点，然后画一条直线段，那么给出了一系列人脸图像，即人脸图像流形上的一条曲线。如果最优传输映射非连续，有可能和奇异点集相交，即直线段和某个皱褶相交，不妨设交点为，那么在人脸图像流形之外，即是一幅真实生活中不可能出现的人脸。图9中心显示了一幅人脸图像，左眼为棕色，右眼为蓝色，这是现实世界中几乎不可能的人脸。这意味着和奇异点集相交，传输映射非连续，存在间断点。 那么如何避免模式崩溃呢？通过以上分析我们知道，深度神经网络只能逼近连续映射，传输映射本身是非连续的，这一内在矛盾引发了模式崩溃。但是最优传输映射是Brenier势能函数的梯度，Brenier势能函数本身是连续的，因此深度神经网络应该来逼近Brenier势能函数，而非传输映射。更进一步，我们应该判断Brenier势能函数的奇异点，即图2中的脊线和图6中的皱褶。 小结 基于真实数据的流形分布假设，我们将深度学习的主要任务分解为学习流形结构和概率变换两部分；概率变换可以用最优传输理论来解释和实现。基于Brenier理论，我们发现GAN模型中的生成器D和判别器G计算的函数彼此可以相互表示，因此生成器和判别器应该交流中间计算结果，用合作代替竞争。Brenier理论等价于蒙日-安培方程，蒙日-安培方程正则性理论表明：如果目标概率分布的支集非凸，那么存在零测度的奇异点集，传输映射在奇异点处间断。而传统深度神经网络只能逼近连续映射，这一矛盾造成了模式崩溃。 通过计算Brenier势能函数，并且判定奇异点集，我们可以避免模式崩溃。这些算法存在GPU实现方式。这种方法更为稳定，鲁棒，训练效率大为提升，并且用透明的理论模型部分取代了经验的黑箱。 References 【1】Na Lei, Yang Guo, Dongsheng An, Xin Qi, Zhongxuan Luo, Shing-Tung Yau, Xianfeng Gu. &quot;Mode Collapse and Regularity of Optimal Transportation Maps&quot;, ArXiv:1902.02934 编辑：文婧 校对：林亦霖" />
<meta property="og:description" content="来源：老顾谈几何 本文约4040字，建议阅读7分钟。 本文与你讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释。 春节前夕，北美遭遇极端天气，在酷寒中笔者来到哈佛大学探望丘成桐先生。新春佳节，本是普天同庆的日子，但对于孤悬海外的游子而言，却是最为凄凉难耐。远离父母亲朋，远离故国家园，自然环境寒风凛冽，飞雪漫天，社会环境疏离淡漠，冷清寂寥。在波士顿见到导师和朋友，倍感欣慰。笔者曾经辅导过的Kylie刚刚从哈佛毕业。哈佛本科生的主流一般选择进入华尔街的金融公司，Kylie却特立独行地选择了教育。笔者辅导过的Simon刚刚被哈佛录取，矢志投身数学。在查尔斯河畔的LegalSeafood, Kylie给了Simon很多在哈佛求学的建议。看到弟子们的茁壮成长，笔者不禁感慨万千：时光荏苒，昭华流逝，人生苦短，择英才而教之，生命才会更有意义！ 笔者和哈佛大学统计系的刘军教授交流，刘教授告诉笔者最近有麻省理工的学者来哈佛寻求教职，求职学术演讲的主题就是最优传输理论在深度学习中的应用。由此可以，深度学习的最优传输理论解释逐渐被广泛接受。在哈佛大学的数学科学与应用中心（Harvard CMSA），丘先生和笔者进一步探讨深度学习中对抗生成网络和蒙日-安培方程理论的关系。 遥想二十多年前，笔者刚刚投到丘先生门下的时候，丘先生教给笔者的第一个几何分析的利器就是蒙日-安培方程理论（Monge-Ampere Equation）。那时，笔者在麻省理工大学学习机器视觉课程，需要求解闵科夫斯基（Minkowski）问题，即利用高斯曲率反求曲面形状。丘先生指导笔者用蒙日-安培方程来解决这一问题。当时无论如何也无法想象二十多年后，这一理论会在深度学习领域发挥重要作用。 近些年来，深度学习的革命几乎席卷了整个计算机科学领域，尤其是这两年来对抗生成网络模型（GAN）石破天惊、一骑绝尘，而蒙日-安培理论恰好可以为GAN提供强有力的理论支持。多少年来，丘先生一直强调基础理论的重要性，他曾经多次说道：“人类历史上技术的本质发展都是来自基础理论的重大突破，基础理论突破后往往经过数十年才会被工程技术领域所领会吸收。因此，对于科学的发展应该持有长远的观点，不能急功近利。”在笔者数十年的学术生涯中，多次见证了丘先生所预言的情形发生，例如陈类之于拓扑绝缘体，证明庞加莱猜测的黎奇曲率流（Ricci FLow）之于医学图像。 目前，笔者和很多合作者们倾向于认为蒙日-安培理论，最优传输理论对深度学习的发展会起到实质性作用，并为之孜孜以求。这次和丘先生主要讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释，细节请见论文【1】。 模式崩溃 （Mode Collapse） 对抗生成网络被广泛应用于图像生成领域，比较常用的有超分辨率、图像翻译、卡通人物生成、人体姿态生成、年龄变换、风格变换等等，超乎想象，精彩纷呈。另一方面，GAN模型训练困难，变化无常，神秘莫测。由于其强烈的不稳定性，目前难以大规模实用。 图1. MNIST数据集 tSNE 嵌入在平面上，10个团簇对应着10个模式（modes）。模式崩溃（Mode Collapse）指生成模型只生成其中的几种模式。 如图1所示，给定数据集合，我们用编码映射将其映入隐空间中，每个数字对应一个团簇，即MNIST数据的概率分布密度函数具有多个峰值，每个峰值被称为是一个模式（mode）。理想情况下，生成模型应该能够生成10个数字，如果只能生成其中的几个，而错失其它的模式，则我们称这种现象为模式崩溃（mode collapse）。 具体而言，GAN训练中经常出现如下三个层次的问题： 训练过程难以收敛，经常出现震荡；实验结果随机，难以复现； 训练收敛，但是出现模式崩溃（Mode Collapse）。例如，我们用MNIST数据集训练GAN模型，训练后的GAN只能生成十个数字中的某一个；或者在人脸图片的实验中，只生成某一种风格的图片。 用真实图片训练后的GAN模型涵盖所有模式，但是同时生成一些没有意义、或者现实中不可能出现的图片。 我们将这些现象笼统称为广义的模式崩溃问题。如何解释模式崩溃的原因，如何设计新型算法避免模式崩溃，这些是深度学习领域的最为基本的问题。我们用最优传输中的Brenier理论，和蒙日-安培方程（Monge-Ampere）的正则性（regularity）理论来解释模式崩溃问题。 GAN和蒙日-安培方程 我们以前讨论过对抗生成网络的最优传输观点：生成器（Generator）将隐空间的高斯分布变换成数据流形上一个分布，判别器（Discriminator）计算生成分布和真实数据分布之间的距离，例如Wasserstein距离。这些操作本质上都可以用最优传输理论来解释，并且加以改进。以欧氏距离平方为代价函数的最优传输问题归结为Brenier理论，并且等价于凸几何中的Alexandrov理论，最终归结为蒙日-安培方程。 假设在隐空间中，在源区域上定义了概率测度，在目标区域上定义了概率测度，，。同时存在，满足，由Brenier定理，存在全局Lipschitz凸函数，其梯度映射给出最优传输映射，即保持测度：对于任意Borel集合，, ， 同时极小化传输代价 . 这里凸函数被称为是Brenier势能函数。Brenier势能函数给出蒙日-安培方程（Monge-Ampere Equation)的弱解： . 在工程计算中，我们通常用Alexandrov弱解来逼近真实解，我们以前讨论过Alexandrov弱解的存在性和唯一性。 蒙日-安培方程的正则性理论 Brenier势能函数是蒙日-安培方程的解，其光滑性是一个错综复杂的问题。汪徐家教授是这一领域的国际权威之一，给了笔者很多帮助。我们假设源域是凸区域，如果也是凸区域，那么Caffarelli理论给出了Brenier势能函数的正则性。我们回忆赫德尔系数（Holder coefficient）为 , 赫德尔空间定义为： 如果密度函数，,那么Brenier势能函数，这里并且。 但是，如果目标概率分布的支集非凸，那么即便密度函数光滑，蒙日-安培方程的解有可能不可微，，进一步最优传输映射非连续。 由Brenier定理，Brenier势能函数为整体Lipschitz，因此几乎处处可导。我们称可求导的点为正常点（regular point），不可求导的点为奇异点（singular point），则奇异点集合为零测度。我们考察每一点处的次微分， 定义（次微分）一个凸函数在点的次微分（subdifferential）定义为集合 正常点的次微分只包含函数的梯度，即&nbsp;，奇异点的次微分是一个无穷集合。我们定义集合， 显然，是正常点集合，是奇异点集合，这里。每一个奇异点都可以用正常点的Cauchy序列来逼近，由此，我们可以定义可达次微分， 可以证明：次微分等于可达次微分的凸包（convex hull）， . 图2. 最优传输映射中的奇异点集合，（苏科华作）。 如图2所示，目标测度的支集具有两个联通分支，我们稠密采样目标测度，表示成定义在两个团簇上面的狄拉克测度。我们然后计算蒙日-安培方程的Alenxandrov解。依随采样密度增加，狄拉克测度弱收敛到目标测度，Alenxandrov解收敛到真实解。我们看到Brenier势能函数的Alenxandrov解可以表示成一张凸曲面，图曲面中间有一条脊线（ridge），脊线的投影是最优传输映射的奇异点集。 图3. GPU版本的最优传输映射（郭洋、Simon Lam 作）。 图3显示了基于GPU算法的从平面长方形上的均匀分布到两个半圆盘上的均匀分布的最优传输映射，长方形的中线显示了最优传输映射的奇异点集。 图4. GPU版本的最优传输映射（郭洋、Simon Lam作）。 图4从平面长方形上的均匀分布到哑铃形状上的均匀分布的最优传输映射，仔细观察，我们可以看出最优传输映射的奇异点集是中线上的两条线段，介于红蓝斑点之间。 图5. 最优传输映射的奇异点结构（齐鑫、苏科华作）。 图5显示了二维最优传输映射的奇异点结构：这里源区域是单位圆盘，目标区域是平面上非凸区域，带有一个孔洞。Breinier势能函数的奇异点集标注在左帧，，每个奇异点的次微分覆盖一个二维区域，覆盖的孔洞，覆盖右侧的灰色三角形； 每一条曲线覆盖边界处的一个“豁口”，上的任意一点，次微分是外、联结着边界上两点的直线段，可达次微分是边界上的那两点。奇异点的测度为0，Brenier势能函数几乎处处可微，最优传输映射在上几乎处处连续，在上间断。 图6. 实心兔子和实心球之间的最优传输映射，表面皱褶结构，(苏科华作)。 最优传输映射的奇异点结构理论在高维空间依然成立，如图6所示，实心球体和实心兔子体之间的最优传输映射诱导了兔子表面上的大量皱褶，最优传输映射在皱褶处间断。 最优传输映射具有奇异点，那么一般传输映射又会如何？假设我们有映射，将概率测度推前到概率测度，Brenier极分解定理断言，存在唯一的分解， 这里是最优传输映射，是雅可比行列式处处为1的自映射。由此，一般的传输映射也存在奇异点，映射在奇异点处间断。 模式崩溃的理论解释 目前的深度神经网络只能够逼近连续映射，而传输映射是具有间断点的非连续映射，换言之，GAN训练过程中，目标映射不在DNN的可表示泛函空间之中，这一显而易见的矛盾导致了收敛困难；如果目标概率测度的支集具有多个联通分支，GAN训练得到的又是连续映射，则有可能连续映射的值域集中在某一个连通分支上，这就是模式崩溃（mode collapse）；如果强行用一个连续映射来覆盖所有的连通分支，那么这一连续映射的值域必然会覆盖之外的一些区域，即GAN会生成一些没有现实意义的图片。这给出了GAN模式崩溃的直接解释。 那么，如何来用真实数据验证我们的猜测呢？我们用CelebA数据集验证了传输映射的非连续性。 图7. AE-OT体系结构。 如图7所示我们认为人脸图片在图像空间中的分布集中在某个低维流形附近，我们用自动编码器（Autoencoder），将流形映入到隐空间中，编码映射记为，解码映射记为。编码映射将分布推前到隐空间的分布，的支集为。商空间中的最优传输映射为，这里是单位立方体，为均匀分布。我们在中随机采样，那么是生成的人脸图片。 图8. AE-OT生成的人脸图像。 图9. 在隐空间进行插值的结果。 如图9所示，我们在隐空间中任选两点，然后画一条直线段，那么给出了一系列人脸图像，即人脸图像流形上的一条曲线。如果最优传输映射非连续，有可能和奇异点集相交，即直线段和某个皱褶相交，不妨设交点为，那么在人脸图像流形之外，即是一幅真实生活中不可能出现的人脸。图9中心显示了一幅人脸图像，左眼为棕色，右眼为蓝色，这是现实世界中几乎不可能的人脸。这意味着和奇异点集相交，传输映射非连续，存在间断点。 那么如何避免模式崩溃呢？通过以上分析我们知道，深度神经网络只能逼近连续映射，传输映射本身是非连续的，这一内在矛盾引发了模式崩溃。但是最优传输映射是Brenier势能函数的梯度，Brenier势能函数本身是连续的，因此深度神经网络应该来逼近Brenier势能函数，而非传输映射。更进一步，我们应该判断Brenier势能函数的奇异点，即图2中的脊线和图6中的皱褶。 小结 基于真实数据的流形分布假设，我们将深度学习的主要任务分解为学习流形结构和概率变换两部分；概率变换可以用最优传输理论来解释和实现。基于Brenier理论，我们发现GAN模型中的生成器D和判别器G计算的函数彼此可以相互表示，因此生成器和判别器应该交流中间计算结果，用合作代替竞争。Brenier理论等价于蒙日-安培方程，蒙日-安培方程正则性理论表明：如果目标概率分布的支集非凸，那么存在零测度的奇异点集，传输映射在奇异点处间断。而传统深度神经网络只能逼近连续映射，这一矛盾造成了模式崩溃。 通过计算Brenier势能函数，并且判定奇异点集，我们可以避免模式崩溃。这些算法存在GPU实现方式。这种方法更为稳定，鲁棒，训练效率大为提升，并且用透明的理论模型部分取代了经验的黑箱。 References 【1】Na Lei, Yang Guo, Dongsheng An, Xin Qi, Zhongxuan Luo, Shing-Tung Yau, Xianfeng Gu. &quot;Mode Collapse and Regularity of Optimal Transportation Maps&quot;, ArXiv:1902.02934 编辑：文婧 校对：林亦霖" />
<link rel="canonical" href="https://mlh.app/2019/02/17/f9c3f08d6ad1237d4f740e6f41926208.html" />
<meta property="og:url" content="https://mlh.app/2019/02/17/f9c3f08d6ad1237d4f740e6f41926208.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"来源：老顾谈几何 本文约4040字，建议阅读7分钟。 本文与你讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释。 春节前夕，北美遭遇极端天气，在酷寒中笔者来到哈佛大学探望丘成桐先生。新春佳节，本是普天同庆的日子，但对于孤悬海外的游子而言，却是最为凄凉难耐。远离父母亲朋，远离故国家园，自然环境寒风凛冽，飞雪漫天，社会环境疏离淡漠，冷清寂寥。在波士顿见到导师和朋友，倍感欣慰。笔者曾经辅导过的Kylie刚刚从哈佛毕业。哈佛本科生的主流一般选择进入华尔街的金融公司，Kylie却特立独行地选择了教育。笔者辅导过的Simon刚刚被哈佛录取，矢志投身数学。在查尔斯河畔的LegalSeafood, Kylie给了Simon很多在哈佛求学的建议。看到弟子们的茁壮成长，笔者不禁感慨万千：时光荏苒，昭华流逝，人生苦短，择英才而教之，生命才会更有意义！ 笔者和哈佛大学统计系的刘军教授交流，刘教授告诉笔者最近有麻省理工的学者来哈佛寻求教职，求职学术演讲的主题就是最优传输理论在深度学习中的应用。由此可以，深度学习的最优传输理论解释逐渐被广泛接受。在哈佛大学的数学科学与应用中心（Harvard CMSA），丘先生和笔者进一步探讨深度学习中对抗生成网络和蒙日-安培方程理论的关系。 遥想二十多年前，笔者刚刚投到丘先生门下的时候，丘先生教给笔者的第一个几何分析的利器就是蒙日-安培方程理论（Monge-Ampere Equation）。那时，笔者在麻省理工大学学习机器视觉课程，需要求解闵科夫斯基（Minkowski）问题，即利用高斯曲率反求曲面形状。丘先生指导笔者用蒙日-安培方程来解决这一问题。当时无论如何也无法想象二十多年后，这一理论会在深度学习领域发挥重要作用。 近些年来，深度学习的革命几乎席卷了整个计算机科学领域，尤其是这两年来对抗生成网络模型（GAN）石破天惊、一骑绝尘，而蒙日-安培理论恰好可以为GAN提供强有力的理论支持。多少年来，丘先生一直强调基础理论的重要性，他曾经多次说道：“人类历史上技术的本质发展都是来自基础理论的重大突破，基础理论突破后往往经过数十年才会被工程技术领域所领会吸收。因此，对于科学的发展应该持有长远的观点，不能急功近利。”在笔者数十年的学术生涯中，多次见证了丘先生所预言的情形发生，例如陈类之于拓扑绝缘体，证明庞加莱猜测的黎奇曲率流（Ricci FLow）之于医学图像。 目前，笔者和很多合作者们倾向于认为蒙日-安培理论，最优传输理论对深度学习的发展会起到实质性作用，并为之孜孜以求。这次和丘先生主要讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释，细节请见论文【1】。 模式崩溃 （Mode Collapse） 对抗生成网络被广泛应用于图像生成领域，比较常用的有超分辨率、图像翻译、卡通人物生成、人体姿态生成、年龄变换、风格变换等等，超乎想象，精彩纷呈。另一方面，GAN模型训练困难，变化无常，神秘莫测。由于其强烈的不稳定性，目前难以大规模实用。 图1. MNIST数据集 tSNE 嵌入在平面上，10个团簇对应着10个模式（modes）。模式崩溃（Mode Collapse）指生成模型只生成其中的几种模式。 如图1所示，给定数据集合，我们用编码映射将其映入隐空间中，每个数字对应一个团簇，即MNIST数据的概率分布密度函数具有多个峰值，每个峰值被称为是一个模式（mode）。理想情况下，生成模型应该能够生成10个数字，如果只能生成其中的几个，而错失其它的模式，则我们称这种现象为模式崩溃（mode collapse）。 具体而言，GAN训练中经常出现如下三个层次的问题： 训练过程难以收敛，经常出现震荡；实验结果随机，难以复现； 训练收敛，但是出现模式崩溃（Mode Collapse）。例如，我们用MNIST数据集训练GAN模型，训练后的GAN只能生成十个数字中的某一个；或者在人脸图片的实验中，只生成某一种风格的图片。 用真实图片训练后的GAN模型涵盖所有模式，但是同时生成一些没有意义、或者现实中不可能出现的图片。 我们将这些现象笼统称为广义的模式崩溃问题。如何解释模式崩溃的原因，如何设计新型算法避免模式崩溃，这些是深度学习领域的最为基本的问题。我们用最优传输中的Brenier理论，和蒙日-安培方程（Monge-Ampere）的正则性（regularity）理论来解释模式崩溃问题。 GAN和蒙日-安培方程 我们以前讨论过对抗生成网络的最优传输观点：生成器（Generator）将隐空间的高斯分布变换成数据流形上一个分布，判别器（Discriminator）计算生成分布和真实数据分布之间的距离，例如Wasserstein距离。这些操作本质上都可以用最优传输理论来解释，并且加以改进。以欧氏距离平方为代价函数的最优传输问题归结为Brenier理论，并且等价于凸几何中的Alexandrov理论，最终归结为蒙日-安培方程。 假设在隐空间中，在源区域上定义了概率测度，在目标区域上定义了概率测度，，。同时存在，满足，由Brenier定理，存在全局Lipschitz凸函数，其梯度映射给出最优传输映射，即保持测度：对于任意Borel集合，, ， 同时极小化传输代价 . 这里凸函数被称为是Brenier势能函数。Brenier势能函数给出蒙日-安培方程（Monge-Ampere Equation)的弱解： . 在工程计算中，我们通常用Alexandrov弱解来逼近真实解，我们以前讨论过Alexandrov弱解的存在性和唯一性。 蒙日-安培方程的正则性理论 Brenier势能函数是蒙日-安培方程的解，其光滑性是一个错综复杂的问题。汪徐家教授是这一领域的国际权威之一，给了笔者很多帮助。我们假设源域是凸区域，如果也是凸区域，那么Caffarelli理论给出了Brenier势能函数的正则性。我们回忆赫德尔系数（Holder coefficient）为 , 赫德尔空间定义为： 如果密度函数，,那么Brenier势能函数，这里并且。 但是，如果目标概率分布的支集非凸，那么即便密度函数光滑，蒙日-安培方程的解有可能不可微，，进一步最优传输映射非连续。 由Brenier定理，Brenier势能函数为整体Lipschitz，因此几乎处处可导。我们称可求导的点为正常点（regular point），不可求导的点为奇异点（singular point），则奇异点集合为零测度。我们考察每一点处的次微分， 定义（次微分）一个凸函数在点的次微分（subdifferential）定义为集合 正常点的次微分只包含函数的梯度，即&nbsp;，奇异点的次微分是一个无穷集合。我们定义集合， 显然，是正常点集合，是奇异点集合，这里。每一个奇异点都可以用正常点的Cauchy序列来逼近，由此，我们可以定义可达次微分， 可以证明：次微分等于可达次微分的凸包（convex hull）， . 图2. 最优传输映射中的奇异点集合，（苏科华作）。 如图2所示，目标测度的支集具有两个联通分支，我们稠密采样目标测度，表示成定义在两个团簇上面的狄拉克测度。我们然后计算蒙日-安培方程的Alenxandrov解。依随采样密度增加，狄拉克测度弱收敛到目标测度，Alenxandrov解收敛到真实解。我们看到Brenier势能函数的Alenxandrov解可以表示成一张凸曲面，图曲面中间有一条脊线（ridge），脊线的投影是最优传输映射的奇异点集。 图3. GPU版本的最优传输映射（郭洋、Simon Lam 作）。 图3显示了基于GPU算法的从平面长方形上的均匀分布到两个半圆盘上的均匀分布的最优传输映射，长方形的中线显示了最优传输映射的奇异点集。 图4. GPU版本的最优传输映射（郭洋、Simon Lam作）。 图4从平面长方形上的均匀分布到哑铃形状上的均匀分布的最优传输映射，仔细观察，我们可以看出最优传输映射的奇异点集是中线上的两条线段，介于红蓝斑点之间。 图5. 最优传输映射的奇异点结构（齐鑫、苏科华作）。 图5显示了二维最优传输映射的奇异点结构：这里源区域是单位圆盘，目标区域是平面上非凸区域，带有一个孔洞。Breinier势能函数的奇异点集标注在左帧，，每个奇异点的次微分覆盖一个二维区域，覆盖的孔洞，覆盖右侧的灰色三角形； 每一条曲线覆盖边界处的一个“豁口”，上的任意一点，次微分是外、联结着边界上两点的直线段，可达次微分是边界上的那两点。奇异点的测度为0，Brenier势能函数几乎处处可微，最优传输映射在上几乎处处连续，在上间断。 图6. 实心兔子和实心球之间的最优传输映射，表面皱褶结构，(苏科华作)。 最优传输映射的奇异点结构理论在高维空间依然成立，如图6所示，实心球体和实心兔子体之间的最优传输映射诱导了兔子表面上的大量皱褶，最优传输映射在皱褶处间断。 最优传输映射具有奇异点，那么一般传输映射又会如何？假设我们有映射，将概率测度推前到概率测度，Brenier极分解定理断言，存在唯一的分解， 这里是最优传输映射，是雅可比行列式处处为1的自映射。由此，一般的传输映射也存在奇异点，映射在奇异点处间断。 模式崩溃的理论解释 目前的深度神经网络只能够逼近连续映射，而传输映射是具有间断点的非连续映射，换言之，GAN训练过程中，目标映射不在DNN的可表示泛函空间之中，这一显而易见的矛盾导致了收敛困难；如果目标概率测度的支集具有多个联通分支，GAN训练得到的又是连续映射，则有可能连续映射的值域集中在某一个连通分支上，这就是模式崩溃（mode collapse）；如果强行用一个连续映射来覆盖所有的连通分支，那么这一连续映射的值域必然会覆盖之外的一些区域，即GAN会生成一些没有现实意义的图片。这给出了GAN模式崩溃的直接解释。 那么，如何来用真实数据验证我们的猜测呢？我们用CelebA数据集验证了传输映射的非连续性。 图7. AE-OT体系结构。 如图7所示我们认为人脸图片在图像空间中的分布集中在某个低维流形附近，我们用自动编码器（Autoencoder），将流形映入到隐空间中，编码映射记为，解码映射记为。编码映射将分布推前到隐空间的分布，的支集为。商空间中的最优传输映射为，这里是单位立方体，为均匀分布。我们在中随机采样，那么是生成的人脸图片。 图8. AE-OT生成的人脸图像。 图9. 在隐空间进行插值的结果。 如图9所示，我们在隐空间中任选两点，然后画一条直线段，那么给出了一系列人脸图像，即人脸图像流形上的一条曲线。如果最优传输映射非连续，有可能和奇异点集相交，即直线段和某个皱褶相交，不妨设交点为，那么在人脸图像流形之外，即是一幅真实生活中不可能出现的人脸。图9中心显示了一幅人脸图像，左眼为棕色，右眼为蓝色，这是现实世界中几乎不可能的人脸。这意味着和奇异点集相交，传输映射非连续，存在间断点。 那么如何避免模式崩溃呢？通过以上分析我们知道，深度神经网络只能逼近连续映射，传输映射本身是非连续的，这一内在矛盾引发了模式崩溃。但是最优传输映射是Brenier势能函数的梯度，Brenier势能函数本身是连续的，因此深度神经网络应该来逼近Brenier势能函数，而非传输映射。更进一步，我们应该判断Brenier势能函数的奇异点，即图2中的脊线和图6中的皱褶。 小结 基于真实数据的流形分布假设，我们将深度学习的主要任务分解为学习流形结构和概率变换两部分；概率变换可以用最优传输理论来解释和实现。基于Brenier理论，我们发现GAN模型中的生成器D和判别器G计算的函数彼此可以相互表示，因此生成器和判别器应该交流中间计算结果，用合作代替竞争。Brenier理论等价于蒙日-安培方程，蒙日-安培方程正则性理论表明：如果目标概率分布的支集非凸，那么存在零测度的奇异点集，传输映射在奇异点处间断。而传统深度神经网络只能逼近连续映射，这一矛盾造成了模式崩溃。 通过计算Brenier势能函数，并且判定奇异点集，我们可以避免模式崩溃。这些算法存在GPU实现方式。这种方法更为稳定，鲁棒，训练效率大为提升，并且用透明的理论模型部分取代了经验的黑箱。 References 【1】Na Lei, Yang Guo, Dongsheng An, Xin Qi, Zhongxuan Luo, Shing-Tung Yau, Xianfeng Gu. &quot;Mode Collapse and Regularity of Optimal Transportation Maps&quot;, ArXiv:1902.02934 编辑：文婧 校对：林亦霖","@type":"BlogPosting","url":"https://mlh.app/2019/02/17/f9c3f08d6ad1237d4f740e6f41926208.html","headline":"深度学习 GAN模式崩溃的理论解释","dateModified":"2019-02-17T00:00:00+08:00","datePublished":"2019-02-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/02/17/f9c3f08d6ad1237d4f740e6f41926208.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>深度学习 | GAN模式崩溃的理论解释</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="rich_media_content" id="js_content"> 
   <p style="min-height:1em;letter-spacing:.544px;line-height:27.2px;"><img style="line-height:25.6px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/heS6wRSHVMn0YptVVJtnANRduO6oQSa9cyiacHBrHnT1JA0YOn2Ric2G5gVwA8CpFxpiczaJedoSxUP81ClEZwuEw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;"><span style="color:rgb(136,136,136);font-size:14px;letter-spacing:normal;text-align:left;">来源：老顾谈几何</span><br></p>
   <p style="min-height:1em;line-height:normal;"><span><span>本文</span>约</span><strong><span style="color:rgb(166,91,203);">4040字</span></strong><span>，建议阅读</span><span style="color:rgb(166,91,203);"><strong>7分钟</strong></span><span>。</span></p>
   <p style="line-height:normal;"><span style="font-size:14px;">本文与你讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">春节前夕，北美遭遇极端天气，在酷寒中笔者来到哈佛大学探望丘成桐先生。新春佳节，本是普天同庆的日子，但对于孤悬海外的游子而言，却是最为凄凉难耐。远离父母亲朋，远离故国家园，自然环境寒风凛冽，飞雪漫天，社会环境疏离淡漠，冷清寂寥。在波士顿见到导师和朋友，倍感欣慰。<span style="font-size:15px;">笔者</span>曾经辅导过的Kylie刚刚从哈佛毕业。哈佛本科生的主流一般选择进入华尔街的金融公司，Kylie却特立独行地选择了教育。<span style="font-size:15px;">笔者</span>辅导过的Simon刚刚被哈佛录取，矢志投身数学。在查尔斯河畔的LegalSeafood, Kylie给了Simon很多在哈佛求学的建议。看到弟子们的茁壮成长，<span style="font-size:15px;">笔者</span>不禁感慨万千：时光荏苒，昭华流逝，人生苦短，择英才而教之，生命才会更有意义！</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><span style="font-size:15px;">笔者</span>和哈佛大学统计系的刘军教授交流，刘教授告诉<span style="font-size:15px;">笔者</span>最近有麻省理工的学者来哈佛寻求教职，求职学术演讲的主题就是最优传输理论在深度学习中的应用。由此可以，深度学习的最优传输理论解释逐渐被广泛接受。在哈佛大学的数学科学与应用中心（Harvard CMSA），丘先生和<span style="font-size:15px;">笔者</span>进一步探讨深度学习中对抗生成网络和蒙日-安培方程理论的关系。</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">遥想二十多年前，<span style="font-size:15px;">笔者</span>刚刚投到丘先生门下的时候，丘先生教给<span style="font-size:15px;">笔者</span>的第一个几何分析的利器就是蒙日-安培方程理论（Monge-Ampere Equation）。那时，<span style="font-size:15px;">笔者</span>在麻省理工大学学习机器视觉课程，需要求解闵科夫斯基（Minkowski）问题，即利用高斯曲率反求曲面形状。丘先生指导<span style="font-size:15px;">笔者</span>用蒙日-安培方程来解决这一问题。当时无论如何也无法想象二十多年后，这一理论会在深度学习领域发挥重要作用。</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><strong><span style="font-size:15px;">近些年来，深度学习的革命几乎席卷了整个计算机科学领域，尤其是这两年来对抗生成网络模型（GAN）石破天惊、一骑绝尘，而蒙日-安培理论恰好可以为GAN提供强有力的理论支持。</span></strong><span style="font-size:15px;">多少年来，丘先生一直强调基础理论的重要性，他曾经多次说道：“人类历史上技术的本质发展都是来自基础理论的重大突破，基础理论突破后往往经过数十年才会被工程技术领域所领会吸收。因此，对于科学的发展应该持有长远的观点，不能急功近利。”在<span style="font-size:15px;">笔者</span>数十年的学术生涯中，多次见证了丘先生所预言的情形发生，例如陈类之于拓扑绝缘体，证明庞加莱猜测的黎奇曲率流（Ricci FLow）之于医学图像。</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">目前，<span style="font-size:15px;">笔者</span>和很多合作者们倾向于认为蒙日-安培理论，最优传输理论对深度学习的发展会起到实质性作用，并为之孜孜以求。这次和丘先生主要讨论蒙日-安培方程正则性理论关于GAN模型中模式崩溃（Mode Collapse）的解释，细节请见论文【1】。<br></span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;">模式崩溃 （Mode Collapse）</span></strong></span><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">对抗生成网络被广泛应用于图像生成领域，比较常用的有超分辨率、图像翻译、卡通人物生成、人体姿态生成、年龄变换、风格变换等等，超乎想象，精彩纷呈。另一方面，GAN模型训练困难，变化无常，神秘莫测。由于其强烈的不稳定性，目前难以大规模实用。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8FTKYZrCWIzsz44nEzx0hrrnyfTEnTP7powZCkEib0258c8ZAs8o5Jjw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:normal;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图1. MNIST数据集 tSNE 嵌入在平面上，10个团簇对应着10个模式（modes）。模式崩溃（Mode Collapse）指生成模型只生成其中的几种模式。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">如图1所示，给定数据集合，我们用编码映射将其映入隐空间中，每个数字对应一个团簇，即MNIST数据的概率分布密度函数具有多个峰值，每个峰值被称为是一个模式（mode）。理想情况下，生成模型应该能够生成10个数字，如果只能生成其中的几个，而错失其它的模式，则我们称这种现象为模式崩溃（mode collapse）。<br></span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><strong><span style="font-size:15px;">具体而言，GAN训练中经常出现如下三个层次的问题：</span></strong></p>
   <p><br></p>
   <ol class="list-paddingleft-2">
    <li><p style="line-height:1.5em;"><span style="font-size:15px;">训练过程难以收敛，经常出现震荡；实验结果随机，难以复现；<br></span></p></li>
    <li><p style="line-height:1.5em;"><span style="font-size:15px;">训练收敛，但是出现模式崩溃（Mode Collapse）。例如，我们用MNIST数据集训练GAN模型，训练后的GAN只能生成十个数字中的某一个；或者在人脸图片的实验中，只生成某一种风格的图片。</span></p></li>
    <li><p style="line-height:1.5em;"><span style="font-size:15px;">用真实图片训练后的GAN模型涵盖所有模式，但是同时生成一些没有意义、或者现实中不可能出现的图片。<br></span></p></li>
   </ol>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">我们将这些现象笼统称为广义的模式崩溃问题。如何解释模式崩溃的原因，如何设计新型算法避免模式崩溃，这些是深度学习领域的最为基本的问题。我们用最优传输中的Brenier理论，和蒙日-安培方程（Monge-Ampere）的正则性（regularity）理论来解释模式崩溃问题。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;">GAN和蒙日-安培方程</span></strong></span><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">我们以前讨论过对抗生成网络的</span><span style="font-size:15px;">最优传输观点</span><span style="font-size:15px;">：生成器（Generator）将隐空间的高斯分布变换成数据流形上一个分布，判别器（Discriminator）计算生成分布和真实数据分布之间的距离，例如Wasserstein距离。这些操作本质上都可以用</span><span style="font-size:15px;">最优传输理论来解释</span><span style="font-size:15px;">，并且加以改进。以欧氏距离平方为代价函数的最优传输问题归结为Brenier理论，并且等价于凸几何中的Alexandrov理论，最终归结为蒙日-安培方程。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">假设在隐空间中，在源区域</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">上定义了概率测度</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8KzvR1XvbAynQ6pq97C0x6ZAExyNECHmrgDiaW8o0Rgz40tpsRg6KrBg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，在目标区域</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">上定义了概率测度</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8etuMA7URRMw9A1rbOAZ9qNqrq4qDEGCrmuclJxy4EH2MnBxZYwyggw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8o6PUjgDjvWPcCLa5kFJBqTfHTeVc8O5zCPicJERKQuaFkmPjXUUGU6w/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8tWPalZFxeDTamBYf5TicMyLco6MINic0ibscbdiahVgxzGRIETWHNsu5Rw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。同时存在</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8bgsvj4bibYQsQO9lN0y3VYiaic4pDwlOWhlN95CuY4QtPXm9rFFxgdqeg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，满足</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8rq9AOOnicQbyRWsnM3vqKpSPveNOoz8tUr8Q7rabTyXhjDXhf0PnRAA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，由Brenier定理，存在全局Lipschitz凸函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8VbFiabdgeYd3tGhXDQcsLbaBN8flaKhj5JqbvLBXb9N14a5ibuOjdZibw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，其梯度映射给出最优传输映射，即</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8HdR0CjZYC0wBG36Rao4kTibT9zXx5HZJk3iaEqPrib54hmELc26K0BA7g/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">保持测度：对于任意Borel集合</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8T7T4ndCmRgzicSd9viaZmaFRa11sgQfZItTSLpTicsp3Aibf22JmubhtwA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8Er3ic630A6eYR1k4ku57ITicJoMcNQIaFJECgNYM6B1SGu2EIdIQtgicA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">,</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8lJu7GZALm3RYXKgU9JWBYGQhthdpeKMwBxE3VBnz2ibUScL3IayNuyg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">同时极小化传输代价</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8YsDVg86OZtlp4gIXLBV5lL6mR8kmepVbkxicleh78V6jWDS4U7ayEew/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">.</span></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">这里凸函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8VbFiabdgeYd3tGhXDQcsLbaBN8flaKhj5JqbvLBXb9N14a5ibuOjdZibw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">被称为是Brenier势能函数。Brenier势能函数给出蒙日-安培方程（Monge-Ampere Equation)的弱解：</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD80QrdVCIoj2n5BM0A2pczJnXXnod12dhQAqJh8EeqBGa9icePQTd4FOg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">.</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">在工程计算中，我们通常用Alexandrov弱解来逼近真实解，我们以前讨论过Alexandrov弱解的</span><span style="font-size:15px;">存在性和唯一性</span><span style="font-size:15px;">。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;">蒙日-安培方程的正则性理论</span></strong></span><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">Brenier势能函数是蒙日-安培方程的解，其光滑性是一个错综复杂的问题。汪徐家教授是这一领域的国际权威之一，给了<span style="font-size:15px;">笔者</span>很多帮助。我们假设源域</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是凸区域，如果</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">也是凸区域，那么Caffarelli理论给出了Brenier势能函数的正则性。我们回忆赫德尔系数（Holder coefficient）为</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8yv6ImZWOhc4BibViajF1RyR0PPH48zYQHzLqR0xicjKCp3KCiagZvyfgvw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">,</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><strong><span style="font-size:15px;">赫德尔空间定义为：</span></strong></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD87DRRx0TL6cuHMeD52xSCQHYn7icd3DXm47DCs0ric7Ix2zHrtb1IwGAw/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">如果密度函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8uiczttXvK6L2CgXYF7SI2c4FFKoTJ7KnMIDewsHcSSVy5wm7sibmrHDw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8csLhtKumMYHovs6OIMID6ggYiah9ibt6l0bCiaTRQIjm9Jf1ABCKMSRfw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">,那么Brenier势能函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8nCiaZP9avkAY5WZxhIEh5JibsH9dqJ6XRchrLbUfZSoIIaAQBAIgWBJg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，这里</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8xqoD1RJG4c9KTMs5psribpvyGiaicrqJvL9OpPCSFs0HN0JdiaV7d95WVg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">并且</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8C2XDFBlzSGEic7Qu2EvrBibqgu5AicFBVib6S8KCibmicEMVnjJuNhILaibIQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">但是，如果目标概率分布的支集</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">非凸，那么即便密度函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8wz8Sl6UhDbdKEf4gWriamv2fp4MFCHTSeIZJYjuPwxdicVZoial5wshVQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">光滑，蒙日-安培方程的解有可能不可微，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD804TzdKKY8Np3d5rzwB32S9RQIMWyb3QZaFgE10zH21BrCib8jx911Mw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，进一步最优传输映射</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8zdk1638icNWeFjwHOICXA0WwQL2lkNmqJLjMdxib2qEIdRmPZkpIzuyw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">非连续。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">由Brenier定理，Brenier势能函数为整体Lipschitz，因此几乎处处可导。我们称可求导的点为正常点（regular point），不可求导的点为奇异点（singular point），则奇异点集合为零测度。我们考察每一点处的次微分，</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">定义（次微分）一个凸函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemhrQjicuZoxFGmx0InryEGowRZc8lHcZj1r66EEND6u9BO8icCvibpLklWTK5PSFmbhPzDauWrExHUg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">在</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gek0yPVLuziabmxyoP1aYxZtkibjoXLoFzbygR5licMlOqsP6sghSCsgEiahohmWEMv8DKC6Jhrx4QCpKQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">点的次微分（subdifferential）定义为集合</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gek0yPVLuziabmxyoP1aYxZtktvB6zqznXOdDM1MGlqyWcD3IVHXsWu9jNlBrgfQTXC5SXllGZv88LA/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">正常点</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8hEwvPxnLoYXnmEyewKYHy6bEFublZaYxn3IS89TFyyj5YibCo1OWFDA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">的次微分只包含函数的梯度，即&nbsp;</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8cicJibmwf23SPzq9GRusAF1sZYnkvPHjEW2DQibiab2SCsUiaFm4azPXSlw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，奇异点的次微分是一个无穷集合。我们定义集合，</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8ib3GKP7M278C9YODHUAEty1icOiasC0aPrYicnc94GpxANF3VqWgxlohGw/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">显然，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD81siavrntz5NjfSWdWE63oM0tHuaVMqaibZ6coX9ruLhicwLcMhbJ6ObYA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是正常点集合，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8DgROOYlE2J7stpl9dPxVoibuIpqpL1V1rBwicDomWHtpr69TFCdTHTKw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是奇异点集合，这里</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gibQTfu67iaAoMFSrvyJTPicsFAiavg0dTCxxE09oRrdUWVH86HJYa63tg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。每一个奇异点都可以用正常点的Cauchy序列来逼近，由此，我们可以定义可达次微分，</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8jLr9ibtYgicT6FbhI9ESsmg83Csw7WtUAP1IkSJNQ0g29hLnC0I1yjSg/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">可以证明：次微分等于可达次微分的凸包（convex hull），</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8jPeYwBaILC9uSDWdGIpg2UPdohPNxrQVzFrZKaWTvavQNbJ7slWErA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">.</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gelXYwM3lvdqXJnky1Ut52h7961AlXmvQlaSJ3ZPicZKjY0BKCn8WTzhicQibBOSkgsupUyMmx2l5NL6A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图2. 最优传输映射中的奇异点集合，（苏科华作）。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">如图2所示，目标测度的支集具有两个联通分支，我们稠密采样目标测度，表示成定义在两个团簇上面的狄拉克测度。我们然后计算蒙日-安培方程的Alenxandrov解。依随采样密度增加，狄拉克测度弱收敛到目标测度，Alenxandrov解收敛到真实解。我们看到Brenier势能函数的Alenxandrov解可以表示成一张凸曲面，图曲面中间有一条脊线（ridge），脊线的投影是最优传输映射的奇异点集</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8Zuz5dz4uhRrpxe68QWsg4zXQ2nIF785de1xoWFynrzO1c5PN1mPjSg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8Ct8qx9aUKHLTmbuZFDHOPfWLdCMZmqfOVAISvtwe2Zo2UQyKmgiaaBg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图3. GPU版本的最优传输映射（郭洋、Simon Lam 作）。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">图3显示了基于GPU算法的从平面长方形上的均匀分布到两个半圆盘上的均匀分布的最优传输映射，长方形的中线显示了最优传输映射的奇异点集</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8Zuz5dz4uhRrpxe68QWsg4zXQ2nIF785de1xoWFynrzO1c5PN1mPjSg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD80J0SWBHcKxw0tCCty23G3LtmmricSc1rB0ibIwYjkaajMYfFbG6hAibsA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图4. GPU版本的最优传输映射（郭洋、Simon Lam作）。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">图4从平面长方形上的均匀分布到哑铃形状上的均匀分布的最优传输映射，仔细观察，我们可以看出最优传输映射的奇异点集</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8Zuz5dz4uhRrpxe68QWsg4zXQ2nIF785de1xoWFynrzO1c5PN1mPjSg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是中线上的两条线段，介于红蓝斑点之间。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD81mnN30q0RxHYDBLEFKFYXEbm8szicNoTeCtdWrQ4T9NXstYEPD8BSMw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图5. 最优传输映射的奇异点结构（齐鑫、苏科华作）。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">图5显示了二维最优传输映射的奇异点结构：这里源区域</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是单位圆盘，目标区域</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是平面上非凸区域，带有一个孔洞。Breinier势能函数</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemhrQjicuZoxFGmx0InryEGowRZc8lHcZj1r66EEND6u9BO8icCvibpLklWTK5PSFmbhPzDauWrExHUg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">的奇异点集标注在左帧，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8bAG1HWzMJmukhzs28YiarpUVTdrCS41hGBtcibNALCWT7YpY6koCJgSQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，每个奇异点的次微分覆盖一个二维区域，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8JclCibSqps8nMeV4nBia9p99I4C1u1ZlYaicbljIX0LM2894KdLttyL3Q/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">覆盖</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">的孔洞，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8GlNvFTYA3fxicQ5YkzPSMicbdpaTco4FaUPXbbjARsMaI78OfSuzC52Q/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">覆盖右侧的灰色三角形；</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD80vmEIkaiczcnYb3l7U6ia1lGicFQQiaqKuLkFwce1N85S88xicRV2RhO2Gg/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">每一条曲线</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8pljLUbfMn42n5fpNY3BfxgtRC93fJP8unYzpHWt2n6nEmf9djEGvng/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">覆盖</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">边界处的一个“豁口”，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8pljLUbfMn42n5fpNY3BfxgtRC93fJP8unYzpHWt2n6nEmf9djEGvng/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">上的任意一点</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8cCw7yva8PR68Em1K7lWnrcmwDHYgIC1RWr690bnhD0Rcteu6nFJeoQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，次微分</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8kvqKt2XuQTSewvVGXVB27MiahWXMGyeia1KnK56Tv7DibJI0kEuibP4HDw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">外、联结着</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">边界上两点的直线段，可达次微分</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8IVQ18tUxQEHLvnRPRmTWSOYv9Pptkicgeaia3VjxMdp3J6Hw4wZxhicQw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">边界上的那两点。奇异点的测度为0，Brenier势能函数几乎处处可微，最优传输映射</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8zdk1638icNWeFjwHOICXA0WwQL2lkNmqJLjMdxib2qEIdRmPZkpIzuyw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">在</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">上几乎处处连续，在</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8EyD75J4Xu2G2BZRoco8J1V2yHIgTevCTYicpKZtRrknOF7ZLSFic6xJw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">上间断。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8R84Miaw79M4guxEcxBGdUGkiccgxVHdlDJQ7ou05lNrmdeSeApKicw74Q/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图6. 实心兔子和实心球之间的最优传输映射，表面皱褶结构，(苏科华作)。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">最优传输映射的奇异点结构理论在高维空间依然成立，如图6所示，实心球体和实心兔子体之间的最优传输映射诱导了兔子表面上的大量皱褶，最优传输映射在皱褶处间断。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">最优传输映射具有奇异点，那么一般传输映射又会如何？假设我们有映射</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8KtJ7x91Tt6EEHWwbzaRR18bEbKtffkDZJlHMgEOunWv09t7QLs0Zrw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，将概率测度</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8KzvR1XvbAynQ6pq97C0x6ZAExyNECHmrgDiaW8o0Rgz40tpsRg6KrBg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">推前到概率测度</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8etuMA7URRMw9A1rbOAZ9qNqrq4qDEGCrmuclJxy4EH2MnBxZYwyggw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，Brenier极分解定理断言，存在唯一的分解</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8ggmaegNlLQTruuUIf4QLfzsWyIRIOrWVRibCicEeAN6DpUXxLZZOoNvw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">， 这里</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8zdk1638icNWeFjwHOICXA0WwQL2lkNmqJLjMdxib2qEIdRmPZkpIzuyw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是最优传输映射，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8zOurxXyKMgedrUYw9DqnzWYyHbAMr4d3MQicnraIMicRBUSYdicTbO4cA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是雅可比行列式处处为1的自映射。由此，一般的传输映射也存在奇异点，映射在奇异点处间断。</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;">模式崩溃的理论解释</span></strong></span><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">目前的深度神经网络只能够逼近连续映射，而传输映射是具有间断点的非连续映射，换言之，GAN训练过程中，目标映射不在DNN的可表示泛函空间之中，这一显而易见的矛盾导致了收敛困难；如果目标概率测度的支集具有多个联通分支，GAN训练得到的又是连续映射，则有可能连续映射的值域集中在某一个连通分支上，这就是模式崩溃（mode collapse）；如果强行用一个连续映射来覆盖所有的连通分支，那么这一连续映射的值域必然会覆盖</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8siafNKd6zlNm5GxIEtia4sN3tXAVhozeyTVNNYiaKJtFGKqdrpicGhKBNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">之外的一些区域，即GAN会生成一些没有现实意义的图片。这给出了GAN模式崩溃的直接解释。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><strong><span style="font-size:15px;">那么，如何来用真实数据验证我们的猜测呢？我们用CelebA数据集验证了传输映射的非连续性。</span></strong><span style="font-size:15px;"><br></span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktC2RhHuxxNC5QhCVorjaiaL06XRcDqJXchPWUJ3nE5ldXK2PXVgrEdXg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图7. AE-OT体系结构。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">如图7所示我们认为人脸图片在图像空间中的分布</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD88PwVsb0iaicmtbCERJfic5clNPhicUdDrpIx3lW70ASqEKAbJ0haZx7GcQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">集中在某个低维流形</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8x5H5yonTfpdPT2GjOvglgX9ibcAwOG0JcgelnfZ5slKdDoLFYqZyIOA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">附近，我们用自动编码器（Autoencoder），将流形</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8x5H5yonTfpdPT2GjOvglgX9ibcAwOG0JcgelnfZ5slKdDoLFYqZyIOA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">映入到隐空间中，编码映射记为</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8rYUN9hAacyx1bsQwzbjFlwMK4h5Eib8b0VMxjUokE8yKZ6WVe4sSjZQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，解码映射记为</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8eia8DMicfyeNIumKcbEKPGVWyGOk5n1Viazxc7T6y39GCqgQQ0DnP9kuw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。编码映射将分布</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD88PwVsb0iaicmtbCERJfic5clNPhicUdDrpIx3lW70ASqEKAbJ0haZx7GcQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">推前到隐空间的分布</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8lCxaYELzb3MJeQwmuTxayIMbW2Rks3AyaBZEGKox5ObhSOR9z9Oic0g/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD88PwVsb0iaicmtbCERJfic5clNPhicUdDrpIx3lW70ASqEKAbJ0haZx7GcQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">的支集为</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD81ZnbxWCExRY0AYATeNpkuwTd8eIA9SbibtrkvcmXxAjeTFgHGWmibfag/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">。商空间中的最优传输映射为</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8FExOaAKAqCf4wKLBDKATaVicjarFzmZcHTcqibBkS3JwAxh4kicpMeWrg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，这里</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是单位立方体</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8oQqqBr0BaMTEiaf388Bk5kCqmRM2CFqXicZNGbk2zkDObzlial5DhfMPQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8rcQXsI95icJ3840t5W3fXjaQEqwnaqzWO6QzcbFAUKgR9byJEtM90yQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">为均匀分布。我们在</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">中随机采样</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8uLjc8m9Tib6Tcc1Qqu3AKeUoqkcSpEWWUUxHa6rngOTzqrFfS4Ynahg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，那么</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8jnsyiad1gphHFkbIln5ApI8Kt21jh9gicm6DHr8GZ0MsUiajoOTrh9Izg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是生成的人脸图片。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/JcQsXQ30genk5rj65socg1wAZMCVMrktUJ4hGM3wmuJXLdeJWcoXq2wZ5tGh5Bwia42SajJtau24MSUh8I5XySw/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图8. AE-OT生成的人脸图像。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;text-align:center;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30genk5rj65socg1wAZMCVMrktgJwTIGQMG7IlN03XsnJcOWlwX0y1jZwnxGOAhA4pqWtsIk297UZ4wg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="line-height:1.5em;text-align:center;"><span style="font-size:14px;color:rgb(136,136,136);">图9. 在隐空间进行插值的结果。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">如图9所示，我们在隐空间</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8gOfxw06CyWpReQTRACHcGw7LMhxhrh4TWAOKCjXlOctByGu5sGXAeA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">中任选两点，然后画一条直线段</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8GOJgvTrc58EL140svMhCOFuiaIicEBxk9BwFYe4icjEXMkE5KBU24biamw/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，那么</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD84wTR3HjF4OxkLibkicEZaTYvicBSXe8YvNwS8kQvXRtE2ibwznGswtegGA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">给出了一系列人脸图像，即人脸图像流形</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8OD3Y0g1T0IyZxmkZMsPtakXKPiaIUzOBMdfiaE8IQibeHxDoYBq4UbaNQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">上的一条曲线。如果最优传输映射非连续，</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8F5BAeU2oezSJIFXN8jYibutb4W7k2udFiaDvz3ppIiclhFvkiaU3VxyPTA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">有可能和奇异点集相交，即直线段</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8F5BAeU2oezSJIFXN8jYibutb4W7k2udFiaDvz3ppIiclhFvkiaU3VxyPTA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">和某个皱褶相交，不妨设交点为</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8LPWfCYCVme6Uu9aDwaHalohAOvk1A073Xuo1rMGtH1Go0MBibqCAjjg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">，那么</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD82dLiaJoTMiajvCJw581cHXSoe8udnBUc18udjK7Jj3xzDrjTDwicrJMHg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">在人脸图像流形之外，即</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD82dLiaJoTMiajvCJw581cHXSoe8udnBUc18udjK7Jj3xzDrjTDwicrJMHg/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">是一幅真实生活中不可能出现的人脸。图9中心显示了一幅人脸图像，左眼为棕色，右眼为蓝色，这是现实世界中几乎不可能的人脸。这意味着</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD8F5BAeU2oezSJIFXN8jYibutb4W7k2udFiaDvz3ppIiclhFvkiaU3VxyPTA/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">和奇异点集相交，传输映射</span><img title="This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program." src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/JcQsXQ30gemIFdU4mSztZY08IrwldGD81Qhvd2IdyDt84Z1NlJ7Y7kRQjKM0MsOpE4SHEaRO5pol2DIoXHsibhQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"><span style="font-size:15px;">非连续，存在间断点。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><strong><span style="font-size:15px;">那么如何避免模式崩溃呢？</span></strong><span style="font-size:15px;">通过以上分析我们知道，深度神经网络只能逼近连续映射，传输映射本身是非连续的，这一内在矛盾引发了模式崩溃。但是最优传输映射是Brenier势能函数的梯度，Brenier势能函数本身是连续的，因此深度神经网络应该来逼近Brenier势能函数，而非传输映射。更进一步，我们应该判断Brenier势能函数的奇异点，即图2中的脊线和图6中的皱褶。</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;text-align:center;"><span style="color:rgb(166,91,203);"><strong><span style="font-size:15px;">小结</span></strong></span><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">基于真实数据的流形分布假设，我们将深度学习的主要任务分解为学习流形结构和概率变换两部分；概率变换可以用最优传输理论来解释和实现。基于Brenier理论，我们发现GAN模型中的生成器D和判别器G计算的函数彼此可以相互表示，因此生成器和判别器应该交流中间计算结果，用合作代替竞争。Brenier理论等价于蒙日-安培方程，蒙日-安培方程正则性理论表明：如果目标概率分布的支集非凸，那么存在零测度的奇异点集，传输映射在奇异点处间断。而传统深度神经网络只能逼近连续映射，这一矛盾造成了模式崩溃。</span></p>
   <p><br></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;">通过计算Brenier势能函数，并且判定奇异点集，我们可以避免模式崩溃。这些算法存在GPU实现方式。这种方法更为稳定，鲁棒，训练效率大为提升，并且用透明的理论模型部分取代了经验的黑箱。</span></p>
   <p><br></p>
   <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);">References</span></p>
   <p><br></p>
   <p style="line-height:normal;"><span style="font-size:14px;color:rgb(136,136,136);">【1】Na Lei, Yang Guo, Dongsheng An, Xin Qi, Zhongxuan Luo, Shing-Tung Yau, Xianfeng Gu. "Mode Collapse and Regularity of Optimal Transportation Maps", ArXiv:1902.02934</span></p>
   <p style="line-height:1.5em;"><span style="font-size:15px;"><br></span></p>
   <p style="line-height:1.5em;text-align:right;"><span style="font-size:14px;color:rgb(136,136,136);">编辑：文婧</span></p>
   <p style="line-height:1.5em;text-align:right;"><span style="font-size:14px;color:rgb(136,136,136);">校对：林亦霖</span></p>
   <p><br></p>
   <p><img style="font-size:14px;text-align:center;line-height:25.6px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/PPmNUrRwibGHPlpkpt6ILAymro02Y5UMTj7BLDMQS5YMoayGDDUrf8mk29v1ZPtyBoh8xt6vvewbfh6DBF9a5Gw/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"><img style="font-size:14px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/heS6wRSHVMmCGJlfLia0LBzV1XyKic2AHoDSX2dPOIVnNz6DksXpGEevdkaxicHJHpCbI1JnVGPsz0pMqatduBDkg/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p> 
  </div> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
