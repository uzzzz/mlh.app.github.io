<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>ClassificationåŸºç¡€å®éªŒç³»åˆ—ä¸‰â€”â€”MobileNetè®ºæ–‡ç¬”è®°ä¸å¤ç° | æœ‰ç»„ç»‡åœ¨ï¼</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="ClassificationåŸºç¡€å®éªŒç³»åˆ—ä¸‰â€”â€”MobileNetè®ºæ–‡ç¬”è®°ä¸å¤ç°" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ä¸€ã€æ¦‚è¿° â€ƒâ€ƒæœ¬æ–‡è®°å½•MobileNetè®ºæ–‡çš„é˜…è¯»ç¬”è®°ä»¥åŠä»£ç å®ç°ã€‚å…¶å®æœ¬æ¥æ˜¯æƒ³ç›´æ¥çœ‹MobileNet v2çš„ï¼Œç»“æœv2çš„è®ºæ–‡å¤ªéš¾äº†çœ‹ä¸å¤§æ‡‚...æ‰€ä»¥å…ˆæ¥çœ‹çœ‹v1å§ğŸ¶ â€ƒâ€ƒé¦–å…ˆæ ¹æ®çŸ¥ä¹å¤§ä½¬çš„è¯´æ³•ï¼ŒMobileNetå¹¶é2017å¹´çš„åˆ›ä½œï¼Œè€Œæ˜¯Googleæ­¤å‰ä¸¤å¹´å°±æœ‰çš„å·¥ä½œï¼Œåªæ˜¯æ–‡ç« ä¸€ç›´æ²¡å‘è¡¨è€Œå·²ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆMobileNetçœ‹èµ·æ¥æ˜¯ä¸€ç§éå¸¸å¤å¤çš„â€œç›´ç­’ç»“æ„â€ï¼Œæ€§ä»·æ¯”ä¸é«˜ã€‚å…³äºâ€œæ€§ä»·æ¯”â€ï¼Œå¤§ä½¬æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š â€ƒâ€ƒâ€œåç»­ä¸€ç³»åˆ—çš„ResNet, DenseNetç­‰ç»“æ„å·²ç»è¯æ˜é€šè¿‡å¤ç”¨å›¾åƒç‰¹å¾ï¼Œ ä½¿ç”¨concat/eltwise+ ç­‰æ“ä½œè¿›è¡Œèåˆï¼Œ èƒ½æå¤§æå‡ç½‘ç»œçš„æ€§ä»·æ¯”â€ â€ƒâ€ƒå…¶æ¬¡MobileNetä¸­çš„Depthwise Convåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªç­‰åˆ°å†™MobileNet v2ç¬”è®°æ—¶å†è¿›ä¸€æ­¥åˆ†æã€‚ 1.1 è®ºæ–‡ä¸»è¦å†…å®¹ â€ƒâ€ƒæœ¬æ–‡ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ–¹é¢çš„å†…å®¹ï¼š ä»‹ç»Depthwise Separable Convolutionï¼ˆæ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼‰ä»¥åŠå…¶åœ¨è®¡ç®—é‡æ–¹é¢ç›¸å¯¹äºä¼ ç»Ÿå·ç§¯çš„ä¼˜åŠ¿ï¼› æå‡ºäº†ä¸¤ä¸ªè¶…å‚æ•°Width Multiplier å’ŒResolution Multiplier ï¼Œç”¨äºè¿›ä¸€æ­¥å‹ç¼©æ¨¡å‹çš„å¤æ‚åº¦ï¼Œå‡å°å‚æ•°æ•°é‡ã€‚ å¤§é‡çš„å®éªŒç»“æœç”¨äºå¯¹æ¯”Depthwiseå’Œæ™®é€šå·ç§¯ï¼Œä»¥åŠæ¯”è¾ƒä¸åŒMultiplierä¸‹æ¨¡å‹çš„å¤æ‚åº¦å’Œå‡†ç¡®ç‡ã€‚ äºŒã€è®ºæ–‡é˜…è¯» 2.1 Depthwise Separable Convolution â€ƒâ€ƒä¸»è¦æ€æƒ³æ˜¯å¯¹ä¼ ç»Ÿå·ç§¯åšäº†ä¸€ä¸ªåˆ†è§£â€”â€”å°†ä¼ ç»Ÿå·ç§¯åˆ†æˆdepthwiseå’Œpointwiseä¸¤æ­¥æ¥å®Œæˆã€‚å…¶ä¸­depthwiseå°±æ˜¯å¯¹è¾“å…¥ç‰¹å¾çš„æ¯ä¸ªé€šé“å•ç‹¬ä½¿ç”¨ä¸€ä¸ªfilterï¼Œç„¶åå¯¹å¾—åˆ°çš„è‹¥å¹²ä¸ªè¾“å‡ºé€šé“å†ä½¿ç”¨1x1convè¿›è¡Œç»„åˆï¼Œå¾—åˆ°æ–°ç‰¹å¾ï¼Œå³pointwise Convã€‚ç¬¬äºŒæ­¥ä¹Ÿä½“ç°äº†1x1 Convè·¨é€šé“æ•´æµçš„ç‰¹ç‚¹ã€‚ â€ƒâ€ƒè®ºæ–‡ä¸­å¯¹æ­¤çš„è§£é‡Šæ˜¯ï¼Œæ ‡å‡†å·ç§¯ä¸­ï¼Œæ»¤æ³¢å’Œæ»¤æ³¢ä¹‹åç‰¹å¾çš„çº¿æ€§ç»„åˆå¯ä»¥çœ‹åšä¸¤ä¸ªæ­¥éª¤ï¼Œæ·±åº¦å¯åˆ†ç¦»å·ç§¯å°±æ˜¯å°†è¿™ä¸¤ä¸ªæ­¥éª¤åˆ†å¼€è¿›è¡Œã€‚ â€ƒâ€ƒå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚è€Œè¿™ç§å‡è®¾ç›®å‰è¿˜æ— æ³•è¯æ˜ï¼Œä½†æ˜¯å®é™…å®éªŒç»“æœè¡¨æ˜æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¡®å®å¯ä»¥å‡å°å‚æ•°æ•°é‡ã€‚å‚è€ƒä¸Šé¢çŸ¥ä¹å¸–å­å¤§ä½¬çš„å›ç­”ï¼š è¿‘ä¸¤å¹´æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆDepth-wise Separable Convolutionï¼‰å¤§çº¢å¤§ç´«çš„ä¸¤å¹´ï¼Œç”šè‡³æœ‰è·ŸResNetçš„Skip-connectionä¸€æ ·æˆä¸ºç½‘ç»œåŸºæœ¬ç»„ä»¶çš„è¶‹åŠ¿ã€‚Xceptionè®ºæ–‡æŒ‡å‡ºï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚åº”ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å¦ä¸€ä¸ªä¼˜åŠ¿å³æ˜¯å‚æ•°é‡çš„èŠ‚çœï¼ˆè¿™ä¸€ç‚¹å…¶å®ä¹Ÿæ˜¯è§£è€¦çš„ç»“æœï¼Œå‚æ•°æè¿°ä¸Šäº«å—äº†æ­£äº¤æ€§çš„ä¹˜æ³•å¢ç›Šï¼‰ã€‚ç„¶è€Œï¼Œè¿™ä¸€å‡è®¾çš„æˆç«‹ä¸å¦è¿˜æ˜¯å­˜ç–‘çš„ï¼Œç›®å‰æˆ‘ä»¬ä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„å·¥å…·å»æè¿°å’Œè¯æ˜è¿™ä¸€å‡è®¾ã€‚ â€ƒâ€ƒä¸‹é¢çš„è‰å›¾å±•ç¤ºäº†depthwiseå’Œpointwiseä¸¤ä¸ªå±‚åŠå…¶è®¡ç®—é‡ã€‚ Fig. 1. æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¤ºæ„å›¾ â€ƒâ€ƒç”±äºæ ‡å‡†å·ç§¯çš„è®¡ç®—é‡ä¸ºï¼Œç”¨ä¸Šå›¾çš„å¼å­é™¤ä»¥è¯¥å¼ï¼Œç»“æœä¸º ï¼ˆå¿½ç•¥D_Gå’ŒD_Fä¹‹é—´çš„å·®è·ï¼‰ç”±äºç½‘ç»œä¸­ç”¨çš„å·ç§¯æ ¸å¤§å°D_kå‡ä¸º3x3ï¼Œä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å‚æ•°é‡çº¦ä¸ºæ ‡å‡†å·ç§¯çš„ã€‚ Fig. 2. Depthwiseå’ŒPointwiseè§†ä¸ºä¸¤å±‚ï¼Œåé¢å„æ¥ä¸€ç»„BNå’ŒReLU â€ƒâ€ƒé™¤æ­¤ä¹‹å¤–ï¼Œè®ºæ–‡ä¸­è¿˜æåˆ°äº†ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œå°±æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ä¸­å¤§éƒ¨åˆ†è¿ç®—é‡éƒ½æ¥è‡ª1x1 Convï¼Œè€Œ1x1 Convs &quot;do not require this reordering in memory and can be implemented directly with GEMM which is one of the most optimized numerical linear algebra algorithms.&quot;ï¼Œè¿™é‡Œçš„reorderingå°±æ˜¯ç»å…¸çš„im2colï¼Œå³caffeä¸­å®ç°å·ç§¯çš„æ–¹æ³•ã€‚å°±æ˜¯è¯´å¦‚æœç©ºé—´ç»´åº¦å¤§äº1çš„å·ç§¯ï¼Œä¸ºäº†ä½¿ç”¨é«˜çº§ä¼˜åŒ–æ–¹æ³•GEMMï¼Œéœ€è¦å…ˆç”¨im2colè¿›è¡ŒçŸ©é˜µé‡ç»„ã€‚è€Œ1x1 ConvèŠ‚çœäº†è¿™ä¸€æ­¥ï¼Œæ•…æ–‡ç« ä¸­è¯´1x1 Convæ˜¯çº¿æ€§ä»£æ•°æ•°å€¼è®¡ç®—ä¸­çš„æœ€ä¼˜ç®—æ³•ä¹‹ä¸€ã€‚è¯¦ç»†äº†è§£im2colå¯ä»¥è§è¿™ç¯‡åšå®¢ã€‚æ³¨æ„caffeä¸­æ˜¯æŒ‰è¡Œä¼˜å…ˆï¼Œè€ŒMatlabæ˜¯æŒ‰åˆ—ä¼˜å…ˆã€‚ Fig. 3. im2colä¸reordering 2.2 Width Multiplierä¸Resolution Multiplier Width Multiplier å¯¹å„å±‚ä½¿ç”¨åŒä¸€ä¸ªç¼©æ”¾å› å­æ¥å‡å°‘æ»¤æ³¢å™¨ä¸ªæ•°ï¼Œä½¿è¾“å…¥é€šé“æ•°å˜ä¸ºï¼Œè¾“å‡ºé€šé“æ•°å˜ä¸ºã€‚é€šå¸¸åœ¨1, 0.75, 0.5, 0.25ä¸­é€‰æ‹©ã€‚1ä¸ºæ ‡å‡†MobileNetï¼Œå…¶ä»–ä¸‰ä¸ªä¸ºç²¾ç®€çš„MobileNetã€‚èŠ‚çœçš„è®¡ç®—é‡çº¦ä¸º ã€‚ Resolution Multiplier å¯¹ç½‘ç»œè¾“å…¥å°ºå¯¸ä½¿ç”¨ä¸€ä¸ªç¼©æ”¾å› å­ï¼Œè¿›è€Œä½¿å¾—æ¯ä¸€å±‚feature mapå°ºå¯¸éƒ½å˜æˆåŸæ¥çš„å€ã€‚è¿™ä¸ªç¼©æ”¾å› å­å®é™…ä¸Šå°±æ˜¯é€‰æ‹©ä¸åŒçš„è¾“å…¥å°ºå¯¸ï¼Œæ²¡æœ‰åƒWidth Multiplieré‚£æ ·æ˜¾å¼è®¾ç½®ã€‚è¯¥å› å­èŠ‚çœçš„è®¡ç®—é‡ä¹Ÿçº¦ä¸ºã€‚ 2.3 å®éªŒåˆ†æ 2.3.1 æ·±åº¦å¯åˆ†ç¦»å·ç§¯å¸¦æ¥çš„æ€§èƒ½ä¸‹é™å¯ä»¥æ¥æ”¶ Fig. 4. å°†MobileNetä¸­çš„å·ç§¯å…¨éƒ¨æ¢æˆæ™®é€šå·ç§¯ï¼Œå¯¹æ¯”ç»“æœ 2.3.2 Shallower or thinner? â€ƒâ€ƒåœ¨å¯¹åŸå§‹MobileNetè¿›è¡Œè¿›ä¸€æ­¥å‹ç¼©æ—¶ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨Width Multiplierï¼Œè€Œä¸æ˜¯ç®€å•åœ°å‡å°‘æ¨¡å‹çš„å±‚æ•°ï¼Ÿæ–‡ç« é€šè¿‡å®éªŒè¯æ˜ï¼Œä½¿ç”¨ç¼©å‡ç½‘ç»œæ¯”å‡å°ç½‘ç»œå±‚æ•°æ€§èƒ½è¦å¥½ã€‚ Fig. 5. Narrow v.s. Shallow MobileNet 2.3.3 Width Multiplierå¯ä»¥è®¾å¤šå¤§ï¼Ÿ â€ƒâ€ƒè¿™ä¸ªåº”è¯¥æ˜¯å¤§å®¶æœ€å…³å¿ƒçš„å®éªŒäº†ã€‚æœ¬å®éªŒè¯æ˜åœ¨ä»1é™åˆ°0.5çš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹æ€§èƒ½æ˜¯å¹³æ»‘ä¸‹é™çš„ï¼›å½“ä»0.5é™åˆ°0.25æ—¶ï¼Œæ€§èƒ½å¤§å¹…ä¸‹é™ã€‚å¯è§å¯¹æ¨¡å‹æ€§èƒ½å½±å“è¾ƒå°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå€¼å¾—å°è¯•çš„é€‰æ‹©ã€‚ Fig. 6. Î±çš„å½±å“ 2.3.4 è¾“å…¥åˆ†è¾¨ç‡çš„å½±å“ï¼Ÿ â€ƒâ€ƒéšç€è¾“å…¥åˆ†è¾¨ç‡çš„é™ä½ï¼Œæ¨¡å‹æ€§èƒ½çš„ä¸‹é™è¶‹åŠ¿è¾ƒå¹³æ»‘ï¼š Fig. 7. Ïçš„å½±å“ 2.3.5 å…¶ä»–å®éªŒ â€ƒâ€ƒæœ¬æ–‡è¿˜æ¯”è¾ƒäº†MobileNetä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½ã€‚æ¯”å¦‚1.0MobileNet-224è¦å¼ºäºGoogLeNetï¼Œç¨é€ŠäºVGG16ï¼Œä½†æ˜¯ç›¸æ¯”VGG16ï¼Œæ¨¡å‹å¤§å°ç¼©å°äº†32å€ï¼Œè®¡ç®—é‡å°‘äº†27å€ï¼å¦å¤–ï¼Œ0.5 MobileNet-160çš„æ€§èƒ½å°±è¶…è¿‡SqueezeNetå’ŒAlexNetäº†ã€‚ ä¸‰ã€ä»£ç å®ç° 3.1 Gluonä¸­Conv2D â€ƒâ€ƒGluonä¸­nn.Conv2Dæä¾›äº†ä¾¿åˆ©çš„æ¥å£ï¼Œå³é€šè¿‡è®¾ç½®groupså‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå·ç§¯è¿›è¡Œçš„æ–¹å¼ã€‚è§ä¸‹æ–¹çš„å‚æ•°è¯´æ˜ Fig. 8. Conv2Då‚æ•° è¿™ä¸ªå‚æ•°ä»‹ç»ä¿¡æ¯é‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚å€¼å¾—æ³¨æ„çš„æœ‰å‡ ä¸ªåœ°æ–¹ï¼š é€šå¸¸ä¸€ç§æ¯”è¾ƒçœäº‹çš„åšæ³•æ˜¯ä½¿ç”¨Conv2Dæ—¶ä¸æŒ‡å®šinput_channelsï¼Œä¸è¿‡è¿™æ ·å®šä¹‰å®Œç½‘ç»œä¹‹åï¼Œæ¨¡å‹çš„åˆå§‹åŒ–ä¼šè¢«æ¨è¿Ÿè¿›è¡Œï¼Œå³å½“æ¨¡å‹ç¬¬ä¸€æ¬¡call forwardå‡½æ•°æ—¶æ‰ä¼šæ ¹æ®è¾“å…¥å›¾åƒå°ºå¯¸æ¨æ–­input_channelsè¿›è€Œåˆå§‹åŒ–ç½‘ç»œå‚æ•°ã€‚è¿™æ ·å¯èƒ½ä¼šå½±å“model.summary()ç­‰å‡½æ•°çš„ä½¿ç”¨ã€‚ çœ‹èµ·æ¥Conv2Dä¹Ÿæä¾›äº†æ‰©å¼ å·ç§¯çš„æ¥å£ groupså‚æ•°ï¼šæ§åˆ¶è¾“å…¥ç‰¹å¾å›¾å’Œè¾“å‡ºç‰¹å¾å›¾çš„è¿æ¥æ–¹å¼ã€‚é»˜è®¤groups=1ï¼Œå³å·ç§¯æ ¸çš„æ·±åº¦å’Œè¾“å…¥é€šé“æ·±åº¦ç›¸åŒã€‚å¦‚æœå–2ï¼Œåˆ™æ•ˆæœç›¸å½“äºå°†è¾“å…¥ç‰¹å¾æŒ‰é€šé“é‚£ä¸€ç»´åˆ†æˆä¸¤åŠï¼Œæ¯ä¸€åŠä¸ä¸€ä¸ªgroupè¿›è¡Œå·ç§¯ï¼Œè¾“å‡ºçš„ç‰¹å¾å›¾concatå¾—åˆ°ä¸€ä¸ªç‰¹å¾å›¾ã€‚å› æ­¤ï¼Œå¦‚æœå°†groupså‚æ•°è®¾ç½®ä¸ºåŒè¾“å…¥é€šé“æ•°ç›®ä¸€è‡´ï¼Œå°±æ˜¯Depthwise Convolutionã€‚ â€ƒâ€ƒé¦–å…ˆæˆ‘åšäº†ä¸€ä¸ªå°å®éªŒæ¥å¯¹æ¯”æ™®é€šå·ç§¯å’Œgroups&gt;1çš„å·ç§¯ï¼Œæ¥éªŒè¯è¯¥å‚æ•°æ˜¯å¦å¯ç”¨äºç®€ä¾¿åœ°å®ç°depthwise convã€‚å®éªŒè™½ç„¶é€‰å–äº†è¾ƒå°çš„è¾“å…¥feature mapå’Œå·ç§¯æ ¸ï¼Œä½†æ˜¯è¾“å‡ºç»“æœè¿˜æ˜¯æ¯”è¾ƒå†—é•¿ã€‚æœ‰å…´è¶£çš„å¯ä»¥ç›´æ¥çœ‹ä»£ç ï¼Œåé¢MobileNetçš„æ­å»ºä»¥åŠè®­ç»ƒå®éªŒä¹Ÿåœ¨é‡Œé¢ã€‚è¿™é‡Œç›´æ¥æ”¾ä¸Šç»“è®ºï¼š å¯ä»¥ä½¿ç”¨Gluonæä¾›çš„groupsæ¥å£å®ç°Depthwise Convã€‚ åªéœ€è¦è®¾ç½®num_in_channels(in_channels)==num_out_channels(channels)==groupsï¼Œå½“ç„¶ï¼ŒåŒæ™®é€šå·ç§¯ï¼Œin_channelså‚æ•°ä¹Ÿå¯ä»¥ä¸æ˜¾å¼åœ°æŒ‡å®šã€‚ä¸è¿‡è¿™æ ·æ¨¡å‹åˆå§‹åŒ–ä¼šå»¶ååˆ°ç¬¬ä¸€æ¬¡model.forwardä¹‹åè¿›è¡Œã€‚ 3.2 å®ç°MobileNet â€ƒâ€ƒ from mxnet import nd import numpy as np from mxnet.gluon import nn import mxnet as mx from mxnet import gluon class ConvBlock(nn.HybridBlock): def __init__(self, in_channels, channels, strides, padding, num_sync_bn_devices=-1, multiplier=1.0): super(ConvBlock, self).__init__() self.conv_block = nn.HybridSequential() with self.conv_block.name_scope(): self.conv_block.add(nn.Conv2D(int(channels*multiplier), 3, strides, padding, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.conv_block.add(nn.BatchNorm()) else: self.conv_block.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.conv_block.add(nn.Activation(&#39;relu&#39;)) def hybrid_forward(self, F, x): return self.conv_block(x) class DepthwiseSeperable(nn.HybridBlock): def __init__(self, in_channels, channels, strides, num_sync_bn_devices=-1, multiplier=1.0, **kwags): # Weidth Multiplier in_channels = int(in_channels * multiplier) channels = int(channels * multiplier) super(DepthwiseSeperable, self).__init__(**kwags) self.depthwise = nn.HybridSequential() with self.depthwise.name_scope(): self.depthwise.add(nn.Conv2D(in_channels, 3, strides, padding=1,groups=in_channels, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.depthwise.add(nn.BatchNorm()) else: self.depthwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.depthwise.add(nn.Activation(&#39;relu&#39;)) self.pointwise = nn.HybridSequential() with self.pointwise.name_scope(): self.pointwise.add(nn.Conv2D(channels, 1, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.pointwise.add(nn.BatchNorm()) else: self.pointwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.pointwise.add(nn.Activation(&#39;relu&#39;)) def hybrid_forward(self, F, x): return(self.pointwise(self.depthwise(x))) class MobileNet(nn.HybridBlock): def __init__(self, num_classes, n_devices=2, multiplier=1.0, **kwags): super(MobileNet, self).__init__(**kwags) self.net = nn.HybridSequential() self.net.add(ConvBlock(3, 32, 2, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(32, 64, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(64, 128, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(128, 128, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(128, 256, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(256, 256, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(256, 512, 2, n_devices, multiplier)) for _ in range(5): self.net.add(DepthwiseSeperable(512, 512, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(512, 1024, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(1024, 1024, 1, n_devices, multiplier)) self.net.add(nn.GlobalAvgPool2D()) self.net.add(nn.Dense(num_classes)) def hybrid_forward(self, F, x): return self.net(x) å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µå°ä»£ç æ£€æŸ¥ä¸‹ä¸Šé¢å®šä¹‰çš„æ¨¡å‹ï¼š net = MobileNet(num_classes=1000, n_devices=2, multiplier=1.0) net.initialize(mx.init.Xavier()) test_input = nd.random_normal(shape=(1, 3, 224, 224)) net.summary(test_input) ä¹Ÿå¯ä»¥ä½¿ç”¨mxnet.viz.plot_networksæ‰“å°å‡ºæ¨¡å‹çš„graphï¼Œä¸è¿‡éœ€è¦å…ˆå°†æ¨¡å‹è½¬æ¢ä¸ºsymbolï¼š net.hybridize() output = net.forward(test_input) # exportä¹‹ååŒæ—¶ç”Ÿæˆäº†ä¸€ä¸ª.jsonæ–‡ä»¶å’Œ.paramsæ–‡ä»¶ net.export(&#39;Gluon-MobileNet&#39;) symnet = mx.symbol.load(&#39;Gluon-MobileNet-symbol.json&#39;) mx.viz.plot_network(symnet, title=&#39;mobilnet_viz&#39;, shape={&#39;data&#39;:(1, 3, 224, 224)}) å›¾ç‰‡å¤ªé•¿è¿™é‡Œå°±ä¸æ”¾äº†ã€‚å¯ä»¥åˆ°notebookä¸­å»çœ‹ã€‚ 3.3 Experiment on CIFAR10 è¶…å‚æ•°è®¾ç½®ï¼š OPTIMIZER: &#39;nag&#39; BATCH_SIZE = 64 # per gpu EPOCHS = 200 LR = 1e-1 WD = 5e-4 MOMENTUM = 0.9 lr_decay_dict = {40:0.1, 80:0.1, 120:0.1} æ•°æ®å¢å¼ºï¼š è®­ç»ƒæ•°æ®ï¼šéšæœºå·¦å³ç¿»è½¬ï¼›å½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼› æµ‹è¯•æ•°æ®ï¼šå½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼› ç»“æœï¼š Fig. 9. Training Curve Fig. 10. Classification Report ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡æ˜¯æ¨¡å‹åœ¨ç¬¬äºŒæ¬¡decay 0.1æ—¶çš„ç¬¬äºŒæˆ–ç¬¬ä¸‰ä¸ªepochå¼€å§‹ï¼ˆå›¾ä¸­å¤§æ¦‚ç¬¬80ä¸ªepochå¤„ï¼‰ä¼šè¿…é€Ÿå¼€å§‹è¿‡æ‹Ÿåˆã€‚çœ‹èµ·æ¥æ¨¡å‹çš„è®­ç»ƒå—å­¦ä¹ ç‡è¡°å‡çš„å½±å“éå¸¸å¤§ã€‚" />
<meta property="og:description" content="ä¸€ã€æ¦‚è¿° â€ƒâ€ƒæœ¬æ–‡è®°å½•MobileNetè®ºæ–‡çš„é˜…è¯»ç¬”è®°ä»¥åŠä»£ç å®ç°ã€‚å…¶å®æœ¬æ¥æ˜¯æƒ³ç›´æ¥çœ‹MobileNet v2çš„ï¼Œç»“æœv2çš„è®ºæ–‡å¤ªéš¾äº†çœ‹ä¸å¤§æ‡‚...æ‰€ä»¥å…ˆæ¥çœ‹çœ‹v1å§ğŸ¶ â€ƒâ€ƒé¦–å…ˆæ ¹æ®çŸ¥ä¹å¤§ä½¬çš„è¯´æ³•ï¼ŒMobileNetå¹¶é2017å¹´çš„åˆ›ä½œï¼Œè€Œæ˜¯Googleæ­¤å‰ä¸¤å¹´å°±æœ‰çš„å·¥ä½œï¼Œåªæ˜¯æ–‡ç« ä¸€ç›´æ²¡å‘è¡¨è€Œå·²ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆMobileNetçœ‹èµ·æ¥æ˜¯ä¸€ç§éå¸¸å¤å¤çš„â€œç›´ç­’ç»“æ„â€ï¼Œæ€§ä»·æ¯”ä¸é«˜ã€‚å…³äºâ€œæ€§ä»·æ¯”â€ï¼Œå¤§ä½¬æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š â€ƒâ€ƒâ€œåç»­ä¸€ç³»åˆ—çš„ResNet, DenseNetç­‰ç»“æ„å·²ç»è¯æ˜é€šè¿‡å¤ç”¨å›¾åƒç‰¹å¾ï¼Œ ä½¿ç”¨concat/eltwise+ ç­‰æ“ä½œè¿›è¡Œèåˆï¼Œ èƒ½æå¤§æå‡ç½‘ç»œçš„æ€§ä»·æ¯”â€ â€ƒâ€ƒå…¶æ¬¡MobileNetä¸­çš„Depthwise Convåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªç­‰åˆ°å†™MobileNet v2ç¬”è®°æ—¶å†è¿›ä¸€æ­¥åˆ†æã€‚ 1.1 è®ºæ–‡ä¸»è¦å†…å®¹ â€ƒâ€ƒæœ¬æ–‡ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ–¹é¢çš„å†…å®¹ï¼š ä»‹ç»Depthwise Separable Convolutionï¼ˆæ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼‰ä»¥åŠå…¶åœ¨è®¡ç®—é‡æ–¹é¢ç›¸å¯¹äºä¼ ç»Ÿå·ç§¯çš„ä¼˜åŠ¿ï¼› æå‡ºäº†ä¸¤ä¸ªè¶…å‚æ•°Width Multiplier å’ŒResolution Multiplier ï¼Œç”¨äºè¿›ä¸€æ­¥å‹ç¼©æ¨¡å‹çš„å¤æ‚åº¦ï¼Œå‡å°å‚æ•°æ•°é‡ã€‚ å¤§é‡çš„å®éªŒç»“æœç”¨äºå¯¹æ¯”Depthwiseå’Œæ™®é€šå·ç§¯ï¼Œä»¥åŠæ¯”è¾ƒä¸åŒMultiplierä¸‹æ¨¡å‹çš„å¤æ‚åº¦å’Œå‡†ç¡®ç‡ã€‚ äºŒã€è®ºæ–‡é˜…è¯» 2.1 Depthwise Separable Convolution â€ƒâ€ƒä¸»è¦æ€æƒ³æ˜¯å¯¹ä¼ ç»Ÿå·ç§¯åšäº†ä¸€ä¸ªåˆ†è§£â€”â€”å°†ä¼ ç»Ÿå·ç§¯åˆ†æˆdepthwiseå’Œpointwiseä¸¤æ­¥æ¥å®Œæˆã€‚å…¶ä¸­depthwiseå°±æ˜¯å¯¹è¾“å…¥ç‰¹å¾çš„æ¯ä¸ªé€šé“å•ç‹¬ä½¿ç”¨ä¸€ä¸ªfilterï¼Œç„¶åå¯¹å¾—åˆ°çš„è‹¥å¹²ä¸ªè¾“å‡ºé€šé“å†ä½¿ç”¨1x1convè¿›è¡Œç»„åˆï¼Œå¾—åˆ°æ–°ç‰¹å¾ï¼Œå³pointwise Convã€‚ç¬¬äºŒæ­¥ä¹Ÿä½“ç°äº†1x1 Convè·¨é€šé“æ•´æµçš„ç‰¹ç‚¹ã€‚ â€ƒâ€ƒè®ºæ–‡ä¸­å¯¹æ­¤çš„è§£é‡Šæ˜¯ï¼Œæ ‡å‡†å·ç§¯ä¸­ï¼Œæ»¤æ³¢å’Œæ»¤æ³¢ä¹‹åç‰¹å¾çš„çº¿æ€§ç»„åˆå¯ä»¥çœ‹åšä¸¤ä¸ªæ­¥éª¤ï¼Œæ·±åº¦å¯åˆ†ç¦»å·ç§¯å°±æ˜¯å°†è¿™ä¸¤ä¸ªæ­¥éª¤åˆ†å¼€è¿›è¡Œã€‚ â€ƒâ€ƒå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚è€Œè¿™ç§å‡è®¾ç›®å‰è¿˜æ— æ³•è¯æ˜ï¼Œä½†æ˜¯å®é™…å®éªŒç»“æœè¡¨æ˜æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¡®å®å¯ä»¥å‡å°å‚æ•°æ•°é‡ã€‚å‚è€ƒä¸Šé¢çŸ¥ä¹å¸–å­å¤§ä½¬çš„å›ç­”ï¼š è¿‘ä¸¤å¹´æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆDepth-wise Separable Convolutionï¼‰å¤§çº¢å¤§ç´«çš„ä¸¤å¹´ï¼Œç”šè‡³æœ‰è·ŸResNetçš„Skip-connectionä¸€æ ·æˆä¸ºç½‘ç»œåŸºæœ¬ç»„ä»¶çš„è¶‹åŠ¿ã€‚Xceptionè®ºæ–‡æŒ‡å‡ºï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚åº”ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å¦ä¸€ä¸ªä¼˜åŠ¿å³æ˜¯å‚æ•°é‡çš„èŠ‚çœï¼ˆè¿™ä¸€ç‚¹å…¶å®ä¹Ÿæ˜¯è§£è€¦çš„ç»“æœï¼Œå‚æ•°æè¿°ä¸Šäº«å—äº†æ­£äº¤æ€§çš„ä¹˜æ³•å¢ç›Šï¼‰ã€‚ç„¶è€Œï¼Œè¿™ä¸€å‡è®¾çš„æˆç«‹ä¸å¦è¿˜æ˜¯å­˜ç–‘çš„ï¼Œç›®å‰æˆ‘ä»¬ä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„å·¥å…·å»æè¿°å’Œè¯æ˜è¿™ä¸€å‡è®¾ã€‚ â€ƒâ€ƒä¸‹é¢çš„è‰å›¾å±•ç¤ºäº†depthwiseå’Œpointwiseä¸¤ä¸ªå±‚åŠå…¶è®¡ç®—é‡ã€‚ Fig. 1. æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¤ºæ„å›¾ â€ƒâ€ƒç”±äºæ ‡å‡†å·ç§¯çš„è®¡ç®—é‡ä¸ºï¼Œç”¨ä¸Šå›¾çš„å¼å­é™¤ä»¥è¯¥å¼ï¼Œç»“æœä¸º ï¼ˆå¿½ç•¥D_Gå’ŒD_Fä¹‹é—´çš„å·®è·ï¼‰ç”±äºç½‘ç»œä¸­ç”¨çš„å·ç§¯æ ¸å¤§å°D_kå‡ä¸º3x3ï¼Œä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å‚æ•°é‡çº¦ä¸ºæ ‡å‡†å·ç§¯çš„ã€‚ Fig. 2. Depthwiseå’ŒPointwiseè§†ä¸ºä¸¤å±‚ï¼Œåé¢å„æ¥ä¸€ç»„BNå’ŒReLU â€ƒâ€ƒé™¤æ­¤ä¹‹å¤–ï¼Œè®ºæ–‡ä¸­è¿˜æåˆ°äº†ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œå°±æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ä¸­å¤§éƒ¨åˆ†è¿ç®—é‡éƒ½æ¥è‡ª1x1 Convï¼Œè€Œ1x1 Convs &quot;do not require this reordering in memory and can be implemented directly with GEMM which is one of the most optimized numerical linear algebra algorithms.&quot;ï¼Œè¿™é‡Œçš„reorderingå°±æ˜¯ç»å…¸çš„im2colï¼Œå³caffeä¸­å®ç°å·ç§¯çš„æ–¹æ³•ã€‚å°±æ˜¯è¯´å¦‚æœç©ºé—´ç»´åº¦å¤§äº1çš„å·ç§¯ï¼Œä¸ºäº†ä½¿ç”¨é«˜çº§ä¼˜åŒ–æ–¹æ³•GEMMï¼Œéœ€è¦å…ˆç”¨im2colè¿›è¡ŒçŸ©é˜µé‡ç»„ã€‚è€Œ1x1 ConvèŠ‚çœäº†è¿™ä¸€æ­¥ï¼Œæ•…æ–‡ç« ä¸­è¯´1x1 Convæ˜¯çº¿æ€§ä»£æ•°æ•°å€¼è®¡ç®—ä¸­çš„æœ€ä¼˜ç®—æ³•ä¹‹ä¸€ã€‚è¯¦ç»†äº†è§£im2colå¯ä»¥è§è¿™ç¯‡åšå®¢ã€‚æ³¨æ„caffeä¸­æ˜¯æŒ‰è¡Œä¼˜å…ˆï¼Œè€ŒMatlabæ˜¯æŒ‰åˆ—ä¼˜å…ˆã€‚ Fig. 3. im2colä¸reordering 2.2 Width Multiplierä¸Resolution Multiplier Width Multiplier å¯¹å„å±‚ä½¿ç”¨åŒä¸€ä¸ªç¼©æ”¾å› å­æ¥å‡å°‘æ»¤æ³¢å™¨ä¸ªæ•°ï¼Œä½¿è¾“å…¥é€šé“æ•°å˜ä¸ºï¼Œè¾“å‡ºé€šé“æ•°å˜ä¸ºã€‚é€šå¸¸åœ¨1, 0.75, 0.5, 0.25ä¸­é€‰æ‹©ã€‚1ä¸ºæ ‡å‡†MobileNetï¼Œå…¶ä»–ä¸‰ä¸ªä¸ºç²¾ç®€çš„MobileNetã€‚èŠ‚çœçš„è®¡ç®—é‡çº¦ä¸º ã€‚ Resolution Multiplier å¯¹ç½‘ç»œè¾“å…¥å°ºå¯¸ä½¿ç”¨ä¸€ä¸ªç¼©æ”¾å› å­ï¼Œè¿›è€Œä½¿å¾—æ¯ä¸€å±‚feature mapå°ºå¯¸éƒ½å˜æˆåŸæ¥çš„å€ã€‚è¿™ä¸ªç¼©æ”¾å› å­å®é™…ä¸Šå°±æ˜¯é€‰æ‹©ä¸åŒçš„è¾“å…¥å°ºå¯¸ï¼Œæ²¡æœ‰åƒWidth Multiplieré‚£æ ·æ˜¾å¼è®¾ç½®ã€‚è¯¥å› å­èŠ‚çœçš„è®¡ç®—é‡ä¹Ÿçº¦ä¸ºã€‚ 2.3 å®éªŒåˆ†æ 2.3.1 æ·±åº¦å¯åˆ†ç¦»å·ç§¯å¸¦æ¥çš„æ€§èƒ½ä¸‹é™å¯ä»¥æ¥æ”¶ Fig. 4. å°†MobileNetä¸­çš„å·ç§¯å…¨éƒ¨æ¢æˆæ™®é€šå·ç§¯ï¼Œå¯¹æ¯”ç»“æœ 2.3.2 Shallower or thinner? â€ƒâ€ƒåœ¨å¯¹åŸå§‹MobileNetè¿›è¡Œè¿›ä¸€æ­¥å‹ç¼©æ—¶ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨Width Multiplierï¼Œè€Œä¸æ˜¯ç®€å•åœ°å‡å°‘æ¨¡å‹çš„å±‚æ•°ï¼Ÿæ–‡ç« é€šè¿‡å®éªŒè¯æ˜ï¼Œä½¿ç”¨ç¼©å‡ç½‘ç»œæ¯”å‡å°ç½‘ç»œå±‚æ•°æ€§èƒ½è¦å¥½ã€‚ Fig. 5. Narrow v.s. Shallow MobileNet 2.3.3 Width Multiplierå¯ä»¥è®¾å¤šå¤§ï¼Ÿ â€ƒâ€ƒè¿™ä¸ªåº”è¯¥æ˜¯å¤§å®¶æœ€å…³å¿ƒçš„å®éªŒäº†ã€‚æœ¬å®éªŒè¯æ˜åœ¨ä»1é™åˆ°0.5çš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹æ€§èƒ½æ˜¯å¹³æ»‘ä¸‹é™çš„ï¼›å½“ä»0.5é™åˆ°0.25æ—¶ï¼Œæ€§èƒ½å¤§å¹…ä¸‹é™ã€‚å¯è§å¯¹æ¨¡å‹æ€§èƒ½å½±å“è¾ƒå°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå€¼å¾—å°è¯•çš„é€‰æ‹©ã€‚ Fig. 6. Î±çš„å½±å“ 2.3.4 è¾“å…¥åˆ†è¾¨ç‡çš„å½±å“ï¼Ÿ â€ƒâ€ƒéšç€è¾“å…¥åˆ†è¾¨ç‡çš„é™ä½ï¼Œæ¨¡å‹æ€§èƒ½çš„ä¸‹é™è¶‹åŠ¿è¾ƒå¹³æ»‘ï¼š Fig. 7. Ïçš„å½±å“ 2.3.5 å…¶ä»–å®éªŒ â€ƒâ€ƒæœ¬æ–‡è¿˜æ¯”è¾ƒäº†MobileNetä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½ã€‚æ¯”å¦‚1.0MobileNet-224è¦å¼ºäºGoogLeNetï¼Œç¨é€ŠäºVGG16ï¼Œä½†æ˜¯ç›¸æ¯”VGG16ï¼Œæ¨¡å‹å¤§å°ç¼©å°äº†32å€ï¼Œè®¡ç®—é‡å°‘äº†27å€ï¼å¦å¤–ï¼Œ0.5 MobileNet-160çš„æ€§èƒ½å°±è¶…è¿‡SqueezeNetå’ŒAlexNetäº†ã€‚ ä¸‰ã€ä»£ç å®ç° 3.1 Gluonä¸­Conv2D â€ƒâ€ƒGluonä¸­nn.Conv2Dæä¾›äº†ä¾¿åˆ©çš„æ¥å£ï¼Œå³é€šè¿‡è®¾ç½®groupså‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå·ç§¯è¿›è¡Œçš„æ–¹å¼ã€‚è§ä¸‹æ–¹çš„å‚æ•°è¯´æ˜ Fig. 8. Conv2Då‚æ•° è¿™ä¸ªå‚æ•°ä»‹ç»ä¿¡æ¯é‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚å€¼å¾—æ³¨æ„çš„æœ‰å‡ ä¸ªåœ°æ–¹ï¼š é€šå¸¸ä¸€ç§æ¯”è¾ƒçœäº‹çš„åšæ³•æ˜¯ä½¿ç”¨Conv2Dæ—¶ä¸æŒ‡å®šinput_channelsï¼Œä¸è¿‡è¿™æ ·å®šä¹‰å®Œç½‘ç»œä¹‹åï¼Œæ¨¡å‹çš„åˆå§‹åŒ–ä¼šè¢«æ¨è¿Ÿè¿›è¡Œï¼Œå³å½“æ¨¡å‹ç¬¬ä¸€æ¬¡call forwardå‡½æ•°æ—¶æ‰ä¼šæ ¹æ®è¾“å…¥å›¾åƒå°ºå¯¸æ¨æ–­input_channelsè¿›è€Œåˆå§‹åŒ–ç½‘ç»œå‚æ•°ã€‚è¿™æ ·å¯èƒ½ä¼šå½±å“model.summary()ç­‰å‡½æ•°çš„ä½¿ç”¨ã€‚ çœ‹èµ·æ¥Conv2Dä¹Ÿæä¾›äº†æ‰©å¼ å·ç§¯çš„æ¥å£ groupså‚æ•°ï¼šæ§åˆ¶è¾“å…¥ç‰¹å¾å›¾å’Œè¾“å‡ºç‰¹å¾å›¾çš„è¿æ¥æ–¹å¼ã€‚é»˜è®¤groups=1ï¼Œå³å·ç§¯æ ¸çš„æ·±åº¦å’Œè¾“å…¥é€šé“æ·±åº¦ç›¸åŒã€‚å¦‚æœå–2ï¼Œåˆ™æ•ˆæœç›¸å½“äºå°†è¾“å…¥ç‰¹å¾æŒ‰é€šé“é‚£ä¸€ç»´åˆ†æˆä¸¤åŠï¼Œæ¯ä¸€åŠä¸ä¸€ä¸ªgroupè¿›è¡Œå·ç§¯ï¼Œè¾“å‡ºçš„ç‰¹å¾å›¾concatå¾—åˆ°ä¸€ä¸ªç‰¹å¾å›¾ã€‚å› æ­¤ï¼Œå¦‚æœå°†groupså‚æ•°è®¾ç½®ä¸ºåŒè¾“å…¥é€šé“æ•°ç›®ä¸€è‡´ï¼Œå°±æ˜¯Depthwise Convolutionã€‚ â€ƒâ€ƒé¦–å…ˆæˆ‘åšäº†ä¸€ä¸ªå°å®éªŒæ¥å¯¹æ¯”æ™®é€šå·ç§¯å’Œgroups&gt;1çš„å·ç§¯ï¼Œæ¥éªŒè¯è¯¥å‚æ•°æ˜¯å¦å¯ç”¨äºç®€ä¾¿åœ°å®ç°depthwise convã€‚å®éªŒè™½ç„¶é€‰å–äº†è¾ƒå°çš„è¾“å…¥feature mapå’Œå·ç§¯æ ¸ï¼Œä½†æ˜¯è¾“å‡ºç»“æœè¿˜æ˜¯æ¯”è¾ƒå†—é•¿ã€‚æœ‰å…´è¶£çš„å¯ä»¥ç›´æ¥çœ‹ä»£ç ï¼Œåé¢MobileNetçš„æ­å»ºä»¥åŠè®­ç»ƒå®éªŒä¹Ÿåœ¨é‡Œé¢ã€‚è¿™é‡Œç›´æ¥æ”¾ä¸Šç»“è®ºï¼š å¯ä»¥ä½¿ç”¨Gluonæä¾›çš„groupsæ¥å£å®ç°Depthwise Convã€‚ åªéœ€è¦è®¾ç½®num_in_channels(in_channels)==num_out_channels(channels)==groupsï¼Œå½“ç„¶ï¼ŒåŒæ™®é€šå·ç§¯ï¼Œin_channelså‚æ•°ä¹Ÿå¯ä»¥ä¸æ˜¾å¼åœ°æŒ‡å®šã€‚ä¸è¿‡è¿™æ ·æ¨¡å‹åˆå§‹åŒ–ä¼šå»¶ååˆ°ç¬¬ä¸€æ¬¡model.forwardä¹‹åè¿›è¡Œã€‚ 3.2 å®ç°MobileNet â€ƒâ€ƒ from mxnet import nd import numpy as np from mxnet.gluon import nn import mxnet as mx from mxnet import gluon class ConvBlock(nn.HybridBlock): def __init__(self, in_channels, channels, strides, padding, num_sync_bn_devices=-1, multiplier=1.0): super(ConvBlock, self).__init__() self.conv_block = nn.HybridSequential() with self.conv_block.name_scope(): self.conv_block.add(nn.Conv2D(int(channels*multiplier), 3, strides, padding, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.conv_block.add(nn.BatchNorm()) else: self.conv_block.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.conv_block.add(nn.Activation(&#39;relu&#39;)) def hybrid_forward(self, F, x): return self.conv_block(x) class DepthwiseSeperable(nn.HybridBlock): def __init__(self, in_channels, channels, strides, num_sync_bn_devices=-1, multiplier=1.0, **kwags): # Weidth Multiplier in_channels = int(in_channels * multiplier) channels = int(channels * multiplier) super(DepthwiseSeperable, self).__init__(**kwags) self.depthwise = nn.HybridSequential() with self.depthwise.name_scope(): self.depthwise.add(nn.Conv2D(in_channels, 3, strides, padding=1,groups=in_channels, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.depthwise.add(nn.BatchNorm()) else: self.depthwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.depthwise.add(nn.Activation(&#39;relu&#39;)) self.pointwise = nn.HybridSequential() with self.pointwise.name_scope(): self.pointwise.add(nn.Conv2D(channels, 1, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.pointwise.add(nn.BatchNorm()) else: self.pointwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.pointwise.add(nn.Activation(&#39;relu&#39;)) def hybrid_forward(self, F, x): return(self.pointwise(self.depthwise(x))) class MobileNet(nn.HybridBlock): def __init__(self, num_classes, n_devices=2, multiplier=1.0, **kwags): super(MobileNet, self).__init__(**kwags) self.net = nn.HybridSequential() self.net.add(ConvBlock(3, 32, 2, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(32, 64, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(64, 128, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(128, 128, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(128, 256, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(256, 256, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(256, 512, 2, n_devices, multiplier)) for _ in range(5): self.net.add(DepthwiseSeperable(512, 512, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(512, 1024, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(1024, 1024, 1, n_devices, multiplier)) self.net.add(nn.GlobalAvgPool2D()) self.net.add(nn.Dense(num_classes)) def hybrid_forward(self, F, x): return self.net(x) å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µå°ä»£ç æ£€æŸ¥ä¸‹ä¸Šé¢å®šä¹‰çš„æ¨¡å‹ï¼š net = MobileNet(num_classes=1000, n_devices=2, multiplier=1.0) net.initialize(mx.init.Xavier()) test_input = nd.random_normal(shape=(1, 3, 224, 224)) net.summary(test_input) ä¹Ÿå¯ä»¥ä½¿ç”¨mxnet.viz.plot_networksæ‰“å°å‡ºæ¨¡å‹çš„graphï¼Œä¸è¿‡éœ€è¦å…ˆå°†æ¨¡å‹è½¬æ¢ä¸ºsymbolï¼š net.hybridize() output = net.forward(test_input) # exportä¹‹ååŒæ—¶ç”Ÿæˆäº†ä¸€ä¸ª.jsonæ–‡ä»¶å’Œ.paramsæ–‡ä»¶ net.export(&#39;Gluon-MobileNet&#39;) symnet = mx.symbol.load(&#39;Gluon-MobileNet-symbol.json&#39;) mx.viz.plot_network(symnet, title=&#39;mobilnet_viz&#39;, shape={&#39;data&#39;:(1, 3, 224, 224)}) å›¾ç‰‡å¤ªé•¿è¿™é‡Œå°±ä¸æ”¾äº†ã€‚å¯ä»¥åˆ°notebookä¸­å»çœ‹ã€‚ 3.3 Experiment on CIFAR10 è¶…å‚æ•°è®¾ç½®ï¼š OPTIMIZER: &#39;nag&#39; BATCH_SIZE = 64 # per gpu EPOCHS = 200 LR = 1e-1 WD = 5e-4 MOMENTUM = 0.9 lr_decay_dict = {40:0.1, 80:0.1, 120:0.1} æ•°æ®å¢å¼ºï¼š è®­ç»ƒæ•°æ®ï¼šéšæœºå·¦å³ç¿»è½¬ï¼›å½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼› æµ‹è¯•æ•°æ®ï¼šå½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼› ç»“æœï¼š Fig. 9. Training Curve Fig. 10. Classification Report ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡æ˜¯æ¨¡å‹åœ¨ç¬¬äºŒæ¬¡decay 0.1æ—¶çš„ç¬¬äºŒæˆ–ç¬¬ä¸‰ä¸ªepochå¼€å§‹ï¼ˆå›¾ä¸­å¤§æ¦‚ç¬¬80ä¸ªepochå¤„ï¼‰ä¼šè¿…é€Ÿå¼€å§‹è¿‡æ‹Ÿåˆã€‚çœ‹èµ·æ¥æ¨¡å‹çš„è®­ç»ƒå—å­¦ä¹ ç‡è¡°å‡çš„å½±å“éå¸¸å¤§ã€‚" />
<meta property="og:site_name" content="æœ‰ç»„ç»‡åœ¨ï¼" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-01T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"ä¸€ã€æ¦‚è¿° â€ƒâ€ƒæœ¬æ–‡è®°å½•MobileNetè®ºæ–‡çš„é˜…è¯»ç¬”è®°ä»¥åŠä»£ç å®ç°ã€‚å…¶å®æœ¬æ¥æ˜¯æƒ³ç›´æ¥çœ‹MobileNet v2çš„ï¼Œç»“æœv2çš„è®ºæ–‡å¤ªéš¾äº†çœ‹ä¸å¤§æ‡‚...æ‰€ä»¥å…ˆæ¥çœ‹çœ‹v1å§ğŸ¶ â€ƒâ€ƒé¦–å…ˆæ ¹æ®çŸ¥ä¹å¤§ä½¬çš„è¯´æ³•ï¼ŒMobileNetå¹¶é2017å¹´çš„åˆ›ä½œï¼Œè€Œæ˜¯Googleæ­¤å‰ä¸¤å¹´å°±æœ‰çš„å·¥ä½œï¼Œåªæ˜¯æ–‡ç« ä¸€ç›´æ²¡å‘è¡¨è€Œå·²ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆMobileNetçœ‹èµ·æ¥æ˜¯ä¸€ç§éå¸¸å¤å¤çš„â€œç›´ç­’ç»“æ„â€ï¼Œæ€§ä»·æ¯”ä¸é«˜ã€‚å…³äºâ€œæ€§ä»·æ¯”â€ï¼Œå¤§ä½¬æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š â€ƒâ€ƒâ€œåç»­ä¸€ç³»åˆ—çš„ResNet, DenseNetç­‰ç»“æ„å·²ç»è¯æ˜é€šè¿‡å¤ç”¨å›¾åƒç‰¹å¾ï¼Œ ä½¿ç”¨concat/eltwise+ ç­‰æ“ä½œè¿›è¡Œèåˆï¼Œ èƒ½æå¤§æå‡ç½‘ç»œçš„æ€§ä»·æ¯”â€ â€ƒâ€ƒå…¶æ¬¡MobileNetä¸­çš„Depthwise Convåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªç­‰åˆ°å†™MobileNet v2ç¬”è®°æ—¶å†è¿›ä¸€æ­¥åˆ†æã€‚ 1.1 è®ºæ–‡ä¸»è¦å†…å®¹ â€ƒâ€ƒæœ¬æ–‡ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ–¹é¢çš„å†…å®¹ï¼š ä»‹ç»Depthwise Separable Convolutionï¼ˆæ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼‰ä»¥åŠå…¶åœ¨è®¡ç®—é‡æ–¹é¢ç›¸å¯¹äºä¼ ç»Ÿå·ç§¯çš„ä¼˜åŠ¿ï¼› æå‡ºäº†ä¸¤ä¸ªè¶…å‚æ•°Width Multiplier å’ŒResolution Multiplier ï¼Œç”¨äºè¿›ä¸€æ­¥å‹ç¼©æ¨¡å‹çš„å¤æ‚åº¦ï¼Œå‡å°å‚æ•°æ•°é‡ã€‚ å¤§é‡çš„å®éªŒç»“æœç”¨äºå¯¹æ¯”Depthwiseå’Œæ™®é€šå·ç§¯ï¼Œä»¥åŠæ¯”è¾ƒä¸åŒMultiplierä¸‹æ¨¡å‹çš„å¤æ‚åº¦å’Œå‡†ç¡®ç‡ã€‚ äºŒã€è®ºæ–‡é˜…è¯» 2.1 Depthwise Separable Convolution â€ƒâ€ƒä¸»è¦æ€æƒ³æ˜¯å¯¹ä¼ ç»Ÿå·ç§¯åšäº†ä¸€ä¸ªåˆ†è§£â€”â€”å°†ä¼ ç»Ÿå·ç§¯åˆ†æˆdepthwiseå’Œpointwiseä¸¤æ­¥æ¥å®Œæˆã€‚å…¶ä¸­depthwiseå°±æ˜¯å¯¹è¾“å…¥ç‰¹å¾çš„æ¯ä¸ªé€šé“å•ç‹¬ä½¿ç”¨ä¸€ä¸ªfilterï¼Œç„¶åå¯¹å¾—åˆ°çš„è‹¥å¹²ä¸ªè¾“å‡ºé€šé“å†ä½¿ç”¨1x1convè¿›è¡Œç»„åˆï¼Œå¾—åˆ°æ–°ç‰¹å¾ï¼Œå³pointwise Convã€‚ç¬¬äºŒæ­¥ä¹Ÿä½“ç°äº†1x1 Convè·¨é€šé“æ•´æµçš„ç‰¹ç‚¹ã€‚ â€ƒâ€ƒè®ºæ–‡ä¸­å¯¹æ­¤çš„è§£é‡Šæ˜¯ï¼Œæ ‡å‡†å·ç§¯ä¸­ï¼Œæ»¤æ³¢å’Œæ»¤æ³¢ä¹‹åç‰¹å¾çš„çº¿æ€§ç»„åˆå¯ä»¥çœ‹åšä¸¤ä¸ªæ­¥éª¤ï¼Œæ·±åº¦å¯åˆ†ç¦»å·ç§¯å°±æ˜¯å°†è¿™ä¸¤ä¸ªæ­¥éª¤åˆ†å¼€è¿›è¡Œã€‚ â€ƒâ€ƒå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚è€Œè¿™ç§å‡è®¾ç›®å‰è¿˜æ— æ³•è¯æ˜ï¼Œä½†æ˜¯å®é™…å®éªŒç»“æœè¡¨æ˜æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¡®å®å¯ä»¥å‡å°å‚æ•°æ•°é‡ã€‚å‚è€ƒä¸Šé¢çŸ¥ä¹å¸–å­å¤§ä½¬çš„å›ç­”ï¼š è¿‘ä¸¤å¹´æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆDepth-wise Separable Convolutionï¼‰å¤§çº¢å¤§ç´«çš„ä¸¤å¹´ï¼Œç”šè‡³æœ‰è·ŸResNetçš„Skip-connectionä¸€æ ·æˆä¸ºç½‘ç»œåŸºæœ¬ç»„ä»¶çš„è¶‹åŠ¿ã€‚Xceptionè®ºæ–‡æŒ‡å‡ºï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚åº”ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å¦ä¸€ä¸ªä¼˜åŠ¿å³æ˜¯å‚æ•°é‡çš„èŠ‚çœï¼ˆè¿™ä¸€ç‚¹å…¶å®ä¹Ÿæ˜¯è§£è€¦çš„ç»“æœï¼Œå‚æ•°æè¿°ä¸Šäº«å—äº†æ­£äº¤æ€§çš„ä¹˜æ³•å¢ç›Šï¼‰ã€‚ç„¶è€Œï¼Œè¿™ä¸€å‡è®¾çš„æˆç«‹ä¸å¦è¿˜æ˜¯å­˜ç–‘çš„ï¼Œç›®å‰æˆ‘ä»¬ä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„å·¥å…·å»æè¿°å’Œè¯æ˜è¿™ä¸€å‡è®¾ã€‚ â€ƒâ€ƒä¸‹é¢çš„è‰å›¾å±•ç¤ºäº†depthwiseå’Œpointwiseä¸¤ä¸ªå±‚åŠå…¶è®¡ç®—é‡ã€‚ Fig. 1. æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¤ºæ„å›¾ â€ƒâ€ƒç”±äºæ ‡å‡†å·ç§¯çš„è®¡ç®—é‡ä¸ºï¼Œç”¨ä¸Šå›¾çš„å¼å­é™¤ä»¥è¯¥å¼ï¼Œç»“æœä¸º ï¼ˆå¿½ç•¥D_Gå’ŒD_Fä¹‹é—´çš„å·®è·ï¼‰ç”±äºç½‘ç»œä¸­ç”¨çš„å·ç§¯æ ¸å¤§å°D_kå‡ä¸º3x3ï¼Œä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å‚æ•°é‡çº¦ä¸ºæ ‡å‡†å·ç§¯çš„ã€‚ Fig. 2. Depthwiseå’ŒPointwiseè§†ä¸ºä¸¤å±‚ï¼Œåé¢å„æ¥ä¸€ç»„BNå’ŒReLU â€ƒâ€ƒé™¤æ­¤ä¹‹å¤–ï¼Œè®ºæ–‡ä¸­è¿˜æåˆ°äº†ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œå°±æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ä¸­å¤§éƒ¨åˆ†è¿ç®—é‡éƒ½æ¥è‡ª1x1 Convï¼Œè€Œ1x1 Convs &quot;do not require this reordering in memory and can be implemented directly with GEMM which is one of the most optimized numerical linear algebra algorithms.&quot;ï¼Œè¿™é‡Œçš„reorderingå°±æ˜¯ç»å…¸çš„im2colï¼Œå³caffeä¸­å®ç°å·ç§¯çš„æ–¹æ³•ã€‚å°±æ˜¯è¯´å¦‚æœç©ºé—´ç»´åº¦å¤§äº1çš„å·ç§¯ï¼Œä¸ºäº†ä½¿ç”¨é«˜çº§ä¼˜åŒ–æ–¹æ³•GEMMï¼Œéœ€è¦å…ˆç”¨im2colè¿›è¡ŒçŸ©é˜µé‡ç»„ã€‚è€Œ1x1 ConvèŠ‚çœäº†è¿™ä¸€æ­¥ï¼Œæ•…æ–‡ç« ä¸­è¯´1x1 Convæ˜¯çº¿æ€§ä»£æ•°æ•°å€¼è®¡ç®—ä¸­çš„æœ€ä¼˜ç®—æ³•ä¹‹ä¸€ã€‚è¯¦ç»†äº†è§£im2colå¯ä»¥è§è¿™ç¯‡åšå®¢ã€‚æ³¨æ„caffeä¸­æ˜¯æŒ‰è¡Œä¼˜å…ˆï¼Œè€ŒMatlabæ˜¯æŒ‰åˆ—ä¼˜å…ˆã€‚ Fig. 3. im2colä¸reordering 2.2 Width Multiplierä¸Resolution Multiplier Width Multiplier å¯¹å„å±‚ä½¿ç”¨åŒä¸€ä¸ªç¼©æ”¾å› å­æ¥å‡å°‘æ»¤æ³¢å™¨ä¸ªæ•°ï¼Œä½¿è¾“å…¥é€šé“æ•°å˜ä¸ºï¼Œè¾“å‡ºé€šé“æ•°å˜ä¸ºã€‚é€šå¸¸åœ¨1, 0.75, 0.5, 0.25ä¸­é€‰æ‹©ã€‚1ä¸ºæ ‡å‡†MobileNetï¼Œå…¶ä»–ä¸‰ä¸ªä¸ºç²¾ç®€çš„MobileNetã€‚èŠ‚çœçš„è®¡ç®—é‡çº¦ä¸º ã€‚ Resolution Multiplier å¯¹ç½‘ç»œè¾“å…¥å°ºå¯¸ä½¿ç”¨ä¸€ä¸ªç¼©æ”¾å› å­ï¼Œè¿›è€Œä½¿å¾—æ¯ä¸€å±‚feature mapå°ºå¯¸éƒ½å˜æˆåŸæ¥çš„å€ã€‚è¿™ä¸ªç¼©æ”¾å› å­å®é™…ä¸Šå°±æ˜¯é€‰æ‹©ä¸åŒçš„è¾“å…¥å°ºå¯¸ï¼Œæ²¡æœ‰åƒWidth Multiplieré‚£æ ·æ˜¾å¼è®¾ç½®ã€‚è¯¥å› å­èŠ‚çœçš„è®¡ç®—é‡ä¹Ÿçº¦ä¸ºã€‚ 2.3 å®éªŒåˆ†æ 2.3.1 æ·±åº¦å¯åˆ†ç¦»å·ç§¯å¸¦æ¥çš„æ€§èƒ½ä¸‹é™å¯ä»¥æ¥æ”¶ Fig. 4. å°†MobileNetä¸­çš„å·ç§¯å…¨éƒ¨æ¢æˆæ™®é€šå·ç§¯ï¼Œå¯¹æ¯”ç»“æœ 2.3.2 Shallower or thinner? â€ƒâ€ƒåœ¨å¯¹åŸå§‹MobileNetè¿›è¡Œè¿›ä¸€æ­¥å‹ç¼©æ—¶ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨Width Multiplierï¼Œè€Œä¸æ˜¯ç®€å•åœ°å‡å°‘æ¨¡å‹çš„å±‚æ•°ï¼Ÿæ–‡ç« é€šè¿‡å®éªŒè¯æ˜ï¼Œä½¿ç”¨ç¼©å‡ç½‘ç»œæ¯”å‡å°ç½‘ç»œå±‚æ•°æ€§èƒ½è¦å¥½ã€‚ Fig. 5. Narrow v.s. Shallow MobileNet 2.3.3 Width Multiplierå¯ä»¥è®¾å¤šå¤§ï¼Ÿ â€ƒâ€ƒè¿™ä¸ªåº”è¯¥æ˜¯å¤§å®¶æœ€å…³å¿ƒçš„å®éªŒäº†ã€‚æœ¬å®éªŒè¯æ˜åœ¨ä»1é™åˆ°0.5çš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹æ€§èƒ½æ˜¯å¹³æ»‘ä¸‹é™çš„ï¼›å½“ä»0.5é™åˆ°0.25æ—¶ï¼Œæ€§èƒ½å¤§å¹…ä¸‹é™ã€‚å¯è§å¯¹æ¨¡å‹æ€§èƒ½å½±å“è¾ƒå°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå€¼å¾—å°è¯•çš„é€‰æ‹©ã€‚ Fig. 6. Î±çš„å½±å“ 2.3.4 è¾“å…¥åˆ†è¾¨ç‡çš„å½±å“ï¼Ÿ â€ƒâ€ƒéšç€è¾“å…¥åˆ†è¾¨ç‡çš„é™ä½ï¼Œæ¨¡å‹æ€§èƒ½çš„ä¸‹é™è¶‹åŠ¿è¾ƒå¹³æ»‘ï¼š Fig. 7. Ïçš„å½±å“ 2.3.5 å…¶ä»–å®éªŒ â€ƒâ€ƒæœ¬æ–‡è¿˜æ¯”è¾ƒäº†MobileNetä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½ã€‚æ¯”å¦‚1.0MobileNet-224è¦å¼ºäºGoogLeNetï¼Œç¨é€ŠäºVGG16ï¼Œä½†æ˜¯ç›¸æ¯”VGG16ï¼Œæ¨¡å‹å¤§å°ç¼©å°äº†32å€ï¼Œè®¡ç®—é‡å°‘äº†27å€ï¼å¦å¤–ï¼Œ0.5 MobileNet-160çš„æ€§èƒ½å°±è¶…è¿‡SqueezeNetå’ŒAlexNetäº†ã€‚ ä¸‰ã€ä»£ç å®ç° 3.1 Gluonä¸­Conv2D â€ƒâ€ƒGluonä¸­nn.Conv2Dæä¾›äº†ä¾¿åˆ©çš„æ¥å£ï¼Œå³é€šè¿‡è®¾ç½®groupså‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå·ç§¯è¿›è¡Œçš„æ–¹å¼ã€‚è§ä¸‹æ–¹çš„å‚æ•°è¯´æ˜ Fig. 8. Conv2Då‚æ•° è¿™ä¸ªå‚æ•°ä»‹ç»ä¿¡æ¯é‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚å€¼å¾—æ³¨æ„çš„æœ‰å‡ ä¸ªåœ°æ–¹ï¼š é€šå¸¸ä¸€ç§æ¯”è¾ƒçœäº‹çš„åšæ³•æ˜¯ä½¿ç”¨Conv2Dæ—¶ä¸æŒ‡å®šinput_channelsï¼Œä¸è¿‡è¿™æ ·å®šä¹‰å®Œç½‘ç»œä¹‹åï¼Œæ¨¡å‹çš„åˆå§‹åŒ–ä¼šè¢«æ¨è¿Ÿè¿›è¡Œï¼Œå³å½“æ¨¡å‹ç¬¬ä¸€æ¬¡call forwardå‡½æ•°æ—¶æ‰ä¼šæ ¹æ®è¾“å…¥å›¾åƒå°ºå¯¸æ¨æ–­input_channelsè¿›è€Œåˆå§‹åŒ–ç½‘ç»œå‚æ•°ã€‚è¿™æ ·å¯èƒ½ä¼šå½±å“model.summary()ç­‰å‡½æ•°çš„ä½¿ç”¨ã€‚ çœ‹èµ·æ¥Conv2Dä¹Ÿæä¾›äº†æ‰©å¼ å·ç§¯çš„æ¥å£ groupså‚æ•°ï¼šæ§åˆ¶è¾“å…¥ç‰¹å¾å›¾å’Œè¾“å‡ºç‰¹å¾å›¾çš„è¿æ¥æ–¹å¼ã€‚é»˜è®¤groups=1ï¼Œå³å·ç§¯æ ¸çš„æ·±åº¦å’Œè¾“å…¥é€šé“æ·±åº¦ç›¸åŒã€‚å¦‚æœå–2ï¼Œåˆ™æ•ˆæœç›¸å½“äºå°†è¾“å…¥ç‰¹å¾æŒ‰é€šé“é‚£ä¸€ç»´åˆ†æˆä¸¤åŠï¼Œæ¯ä¸€åŠä¸ä¸€ä¸ªgroupè¿›è¡Œå·ç§¯ï¼Œè¾“å‡ºçš„ç‰¹å¾å›¾concatå¾—åˆ°ä¸€ä¸ªç‰¹å¾å›¾ã€‚å› æ­¤ï¼Œå¦‚æœå°†groupså‚æ•°è®¾ç½®ä¸ºåŒè¾“å…¥é€šé“æ•°ç›®ä¸€è‡´ï¼Œå°±æ˜¯Depthwise Convolutionã€‚ â€ƒâ€ƒé¦–å…ˆæˆ‘åšäº†ä¸€ä¸ªå°å®éªŒæ¥å¯¹æ¯”æ™®é€šå·ç§¯å’Œgroups&gt;1çš„å·ç§¯ï¼Œæ¥éªŒè¯è¯¥å‚æ•°æ˜¯å¦å¯ç”¨äºç®€ä¾¿åœ°å®ç°depthwise convã€‚å®éªŒè™½ç„¶é€‰å–äº†è¾ƒå°çš„è¾“å…¥feature mapå’Œå·ç§¯æ ¸ï¼Œä½†æ˜¯è¾“å‡ºç»“æœè¿˜æ˜¯æ¯”è¾ƒå†—é•¿ã€‚æœ‰å…´è¶£çš„å¯ä»¥ç›´æ¥çœ‹ä»£ç ï¼Œåé¢MobileNetçš„æ­å»ºä»¥åŠè®­ç»ƒå®éªŒä¹Ÿåœ¨é‡Œé¢ã€‚è¿™é‡Œç›´æ¥æ”¾ä¸Šç»“è®ºï¼š å¯ä»¥ä½¿ç”¨Gluonæä¾›çš„groupsæ¥å£å®ç°Depthwise Convã€‚ åªéœ€è¦è®¾ç½®num_in_channels(in_channels)==num_out_channels(channels)==groupsï¼Œå½“ç„¶ï¼ŒåŒæ™®é€šå·ç§¯ï¼Œin_channelså‚æ•°ä¹Ÿå¯ä»¥ä¸æ˜¾å¼åœ°æŒ‡å®šã€‚ä¸è¿‡è¿™æ ·æ¨¡å‹åˆå§‹åŒ–ä¼šå»¶ååˆ°ç¬¬ä¸€æ¬¡model.forwardä¹‹åè¿›è¡Œã€‚ 3.2 å®ç°MobileNet â€ƒâ€ƒ from mxnet import nd import numpy as np from mxnet.gluon import nn import mxnet as mx from mxnet import gluon class ConvBlock(nn.HybridBlock): def __init__(self, in_channels, channels, strides, padding, num_sync_bn_devices=-1, multiplier=1.0): super(ConvBlock, self).__init__() self.conv_block = nn.HybridSequential() with self.conv_block.name_scope(): self.conv_block.add(nn.Conv2D(int(channels*multiplier), 3, strides, padding, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.conv_block.add(nn.BatchNorm()) else: self.conv_block.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.conv_block.add(nn.Activation(&#39;relu&#39;)) def hybrid_forward(self, F, x): return self.conv_block(x) class DepthwiseSeperable(nn.HybridBlock): def __init__(self, in_channels, channels, strides, num_sync_bn_devices=-1, multiplier=1.0, **kwags): # Weidth Multiplier in_channels = int(in_channels * multiplier) channels = int(channels * multiplier) super(DepthwiseSeperable, self).__init__(**kwags) self.depthwise = nn.HybridSequential() with self.depthwise.name_scope(): self.depthwise.add(nn.Conv2D(in_channels, 3, strides, padding=1,groups=in_channels, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.depthwise.add(nn.BatchNorm()) else: self.depthwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.depthwise.add(nn.Activation(&#39;relu&#39;)) self.pointwise = nn.HybridSequential() with self.pointwise.name_scope(): self.pointwise.add(nn.Conv2D(channels, 1, in_channels=in_channels, use_bias=False)) if num_sync_bn_devices == -1: self.pointwise.add(nn.BatchNorm()) else: self.pointwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices)) self.pointwise.add(nn.Activation(&#39;relu&#39;)) def hybrid_forward(self, F, x): return(self.pointwise(self.depthwise(x))) class MobileNet(nn.HybridBlock): def __init__(self, num_classes, n_devices=2, multiplier=1.0, **kwags): super(MobileNet, self).__init__(**kwags) self.net = nn.HybridSequential() self.net.add(ConvBlock(3, 32, 2, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(32, 64, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(64, 128, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(128, 128, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(128, 256, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(256, 256, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(256, 512, 2, n_devices, multiplier)) for _ in range(5): self.net.add(DepthwiseSeperable(512, 512, 1, n_devices, multiplier)) self.net.add(DepthwiseSeperable(512, 1024, 2, n_devices, multiplier)) self.net.add(DepthwiseSeperable(1024, 1024, 1, n_devices, multiplier)) self.net.add(nn.GlobalAvgPool2D()) self.net.add(nn.Dense(num_classes)) def hybrid_forward(self, F, x): return self.net(x) å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µå°ä»£ç æ£€æŸ¥ä¸‹ä¸Šé¢å®šä¹‰çš„æ¨¡å‹ï¼š net = MobileNet(num_classes=1000, n_devices=2, multiplier=1.0) net.initialize(mx.init.Xavier()) test_input = nd.random_normal(shape=(1, 3, 224, 224)) net.summary(test_input) ä¹Ÿå¯ä»¥ä½¿ç”¨mxnet.viz.plot_networksæ‰“å°å‡ºæ¨¡å‹çš„graphï¼Œä¸è¿‡éœ€è¦å…ˆå°†æ¨¡å‹è½¬æ¢ä¸ºsymbolï¼š net.hybridize() output = net.forward(test_input) # exportä¹‹ååŒæ—¶ç”Ÿæˆäº†ä¸€ä¸ª.jsonæ–‡ä»¶å’Œ.paramsæ–‡ä»¶ net.export(&#39;Gluon-MobileNet&#39;) symnet = mx.symbol.load(&#39;Gluon-MobileNet-symbol.json&#39;) mx.viz.plot_network(symnet, title=&#39;mobilnet_viz&#39;, shape={&#39;data&#39;:(1, 3, 224, 224)}) å›¾ç‰‡å¤ªé•¿è¿™é‡Œå°±ä¸æ”¾äº†ã€‚å¯ä»¥åˆ°notebookä¸­å»çœ‹ã€‚ 3.3 Experiment on CIFAR10 è¶…å‚æ•°è®¾ç½®ï¼š OPTIMIZER: &#39;nag&#39; BATCH_SIZE = 64 # per gpu EPOCHS = 200 LR = 1e-1 WD = 5e-4 MOMENTUM = 0.9 lr_decay_dict = {40:0.1, 80:0.1, 120:0.1} æ•°æ®å¢å¼ºï¼š è®­ç»ƒæ•°æ®ï¼šéšæœºå·¦å³ç¿»è½¬ï¼›å½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼› æµ‹è¯•æ•°æ®ï¼šå½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼› ç»“æœï¼š Fig. 9. Training Curve Fig. 10. Classification Report ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡æ˜¯æ¨¡å‹åœ¨ç¬¬äºŒæ¬¡decay 0.1æ—¶çš„ç¬¬äºŒæˆ–ç¬¬ä¸‰ä¸ªepochå¼€å§‹ï¼ˆå›¾ä¸­å¤§æ¦‚ç¬¬80ä¸ªepochå¤„ï¼‰ä¼šè¿…é€Ÿå¼€å§‹è¿‡æ‹Ÿåˆã€‚çœ‹èµ·æ¥æ¨¡å‹çš„è®­ç»ƒå—å­¦ä¹ ç‡è¡°å‡çš„å½±å“éå¸¸å¤§ã€‚","@type":"BlogPosting","url":"/2019/02/01/a43e95d8dda5379b427837705140264f.html","headline":"ClassificationåŸºç¡€å®éªŒç³»åˆ—ä¸‰â€”â€”MobileNetè®ºæ–‡ç¬”è®°ä¸å¤ç°","dateModified":"2019-02-01T00:00:00+08:00","datePublished":"2019-02-01T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/02/01/a43e95d8dda5379b427837705140264f.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>ClassificationåŸºç¡€å®éªŒç³»åˆ—ä¸‰â€”â€”MobileNetè®ºæ–‡ç¬”è®°ä¸å¤ç°</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>æŸšå­ç¤¾åŒº</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="show-content-free"> 
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-68396a46402b281c.png" alt="14755769-68396a46402b281c.png">
     </div> 
    </div> 
    <div class="image-caption"></div> 
   </div> 
   <h3>ä¸€ã€æ¦‚è¿°</h3> 
   <p>â€ƒâ€ƒæœ¬æ–‡è®°å½•<a href="https://arxiv.org/abs/1704.04861" rel="nofollow">MobileNetè®ºæ–‡</a>çš„é˜…è¯»ç¬”è®°ä»¥åŠä»£ç å®ç°ã€‚å…¶å®æœ¬æ¥æ˜¯æƒ³ç›´æ¥çœ‹MobileNet v2çš„ï¼Œç»“æœv2çš„è®ºæ–‡å¤ªéš¾äº†çœ‹ä¸å¤§æ‡‚...æ‰€ä»¥å…ˆæ¥çœ‹çœ‹v1å§ğŸ¶</p> 
   <p>â€ƒâ€ƒé¦–å…ˆæ ¹æ®<a href="https://www.zhihu.com/question/265709710/answer/298245276" rel="nofollow">çŸ¥ä¹å¤§ä½¬</a>çš„è¯´æ³•ï¼ŒMobileNetå¹¶é2017å¹´çš„åˆ›ä½œï¼Œè€Œæ˜¯Googleæ­¤å‰ä¸¤å¹´å°±æœ‰çš„å·¥ä½œï¼Œåªæ˜¯æ–‡ç« ä¸€ç›´æ²¡å‘è¡¨è€Œå·²ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆMobileNetçœ‹èµ·æ¥æ˜¯ä¸€ç§éå¸¸å¤å¤çš„â€œç›´ç­’ç»“æ„â€ï¼Œæ€§ä»·æ¯”ä¸é«˜ã€‚å…³äºâ€œæ€§ä»·æ¯”â€ï¼Œå¤§ä½¬æ˜¯è¿™ä¹ˆè§£é‡Šçš„ï¼š</p> 
   <hr>
   <p>â€ƒâ€ƒ<em>â€œåç»­ä¸€ç³»åˆ—çš„ResNet, DenseNetç­‰ç»“æ„å·²ç»è¯æ˜é€šè¿‡å¤ç”¨å›¾åƒç‰¹å¾ï¼Œ ä½¿ç”¨concat/eltwise+ ç­‰æ“ä½œè¿›è¡Œèåˆï¼Œ èƒ½æå¤§æå‡ç½‘ç»œçš„æ€§ä»·æ¯”â€</em></p> 
   <hr>
   <p>â€ƒâ€ƒå…¶æ¬¡MobileNetä¸­çš„Depthwise Convåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªç­‰åˆ°å†™MobileNet v2ç¬”è®°æ—¶å†è¿›ä¸€æ­¥åˆ†æã€‚</p> 
   <h4>1.1 è®ºæ–‡ä¸»è¦å†…å®¹</h4> 
   <p>â€ƒâ€ƒæœ¬æ–‡ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ–¹é¢çš„å†…å®¹ï¼š</p> 
   <ol>
    <li>ä»‹ç»Depthwise Separable Convolutionï¼ˆæ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼‰ä»¥åŠå…¶åœ¨è®¡ç®—é‡æ–¹é¢ç›¸å¯¹äºä¼ ç»Ÿå·ç§¯çš„ä¼˜åŠ¿ï¼›</li> 
    <li>æå‡ºäº†ä¸¤ä¸ªè¶…å‚æ•°<code>Width Multiplier</code> å’Œ<code>Resolution Multiplier</code> ï¼Œç”¨äºè¿›ä¸€æ­¥å‹ç¼©æ¨¡å‹çš„å¤æ‚åº¦ï¼Œå‡å°å‚æ•°æ•°é‡ã€‚</li> 
    <li>å¤§é‡çš„å®éªŒç»“æœç”¨äºå¯¹æ¯”Depthwiseå’Œæ™®é€šå·ç§¯ï¼Œä»¥åŠæ¯”è¾ƒä¸åŒMultiplierä¸‹æ¨¡å‹çš„å¤æ‚åº¦å’Œå‡†ç¡®ç‡ã€‚</li> 
   </ol>
   <h3>äºŒã€è®ºæ–‡é˜…è¯»</h3> 
   <h4>2.1 Depthwise Separable Convolution</h4> 
   <p>â€ƒâ€ƒä¸»è¦æ€æƒ³æ˜¯å¯¹ä¼ ç»Ÿå·ç§¯åšäº†ä¸€ä¸ª<strong>åˆ†è§£</strong>â€”â€”å°†ä¼ ç»Ÿå·ç§¯åˆ†æˆdepthwiseå’Œpointwiseä¸¤æ­¥æ¥å®Œæˆã€‚å…¶ä¸­depthwiseå°±æ˜¯å¯¹è¾“å…¥ç‰¹å¾çš„æ¯ä¸ªé€šé“å•ç‹¬ä½¿ç”¨ä¸€ä¸ªfilterï¼Œç„¶åå¯¹å¾—åˆ°çš„è‹¥å¹²ä¸ªè¾“å‡ºé€šé“å†ä½¿ç”¨1x1convè¿›è¡Œç»„åˆï¼Œå¾—åˆ°æ–°ç‰¹å¾ï¼Œå³pointwise Convã€‚ç¬¬äºŒæ­¥ä¹Ÿä½“ç°äº†1x1 Convè·¨é€šé“æ•´æµçš„ç‰¹ç‚¹ã€‚</p> 
   <p>â€ƒâ€ƒè®ºæ–‡ä¸­å¯¹æ­¤çš„è§£é‡Šæ˜¯ï¼Œæ ‡å‡†å·ç§¯ä¸­ï¼Œæ»¤æ³¢å’Œæ»¤æ³¢ä¹‹åç‰¹å¾çš„çº¿æ€§ç»„åˆå¯ä»¥çœ‹åšä¸¤ä¸ªæ­¥éª¤ï¼Œæ·±åº¦å¯åˆ†ç¦»å·ç§¯å°±æ˜¯å°†è¿™ä¸¤ä¸ªæ­¥éª¤åˆ†å¼€è¿›è¡Œã€‚</p> 
   <p>â€ƒâ€ƒå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ<strong>è¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚</strong>è€Œè¿™ç§å‡è®¾ç›®å‰è¿˜æ— æ³•è¯æ˜ï¼Œä½†æ˜¯å®é™…å®éªŒç»“æœè¡¨æ˜æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¡®å®å¯ä»¥å‡å°å‚æ•°æ•°é‡ã€‚å‚è€ƒä¸Šé¢çŸ¥ä¹å¸–å­å¤§ä½¬çš„å›ç­”ï¼š</p> 
   <hr>
   <p><em>è¿‘ä¸¤å¹´æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆDepth-wise Separable Convolutionï¼‰å¤§çº¢å¤§ç´«çš„ä¸¤å¹´ï¼Œç”šè‡³æœ‰è·ŸResNetçš„Skip-connectionä¸€æ ·æˆä¸ºç½‘ç»œåŸºæœ¬ç»„ä»¶çš„è¶‹åŠ¿ã€‚</em><em>Xceptionè®ºæ–‡æŒ‡å‡ºï¼Œè¿™ç§å·ç§¯èƒŒåçš„å‡è®¾æ˜¯è·¨channelç›¸å…³æ€§å’Œè·¨spatialç›¸å…³æ€§çš„è§£è€¦ã€‚</em><em>åº”ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å¦ä¸€ä¸ªä¼˜åŠ¿å³æ˜¯å‚æ•°é‡çš„èŠ‚çœï¼ˆè¿™ä¸€ç‚¹å…¶å®ä¹Ÿæ˜¯è§£è€¦çš„ç»“æœï¼Œå‚æ•°æè¿°ä¸Šäº«å—äº†æ­£äº¤æ€§çš„ä¹˜æ³•å¢ç›Šï¼‰ã€‚ç„¶è€Œï¼Œè¿™ä¸€å‡è®¾çš„æˆç«‹ä¸å¦è¿˜æ˜¯å­˜ç–‘çš„ï¼Œç›®å‰æˆ‘ä»¬ä¹Ÿæ²¡æœ‰è¶³å¤Ÿçš„å·¥å…·å»æè¿°å’Œè¯æ˜è¿™ä¸€å‡è®¾ã€‚</em></p> 
   <hr>
   <p>â€ƒâ€ƒä¸‹é¢çš„è‰å›¾å±•ç¤ºäº†depthwiseå’Œpointwiseä¸¤ä¸ªå±‚åŠå…¶è®¡ç®—é‡ã€‚</p> 
   <br>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-fddfd9072e09feeb.png" alt="14755769-fddfd9072e09feeb.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 1. æ·±åº¦å¯åˆ†ç¦»å·ç§¯ç¤ºæ„å›¾
    </div> 
   </div> 
   <p>â€ƒâ€ƒç”±äºæ ‡å‡†å·ç§¯çš„è®¡ç®—é‡ä¸ºï¼Œç”¨ä¸Šå›¾çš„å¼å­é™¤ä»¥è¯¥å¼ï¼Œç»“æœä¸º ï¼ˆå¿½ç•¥D_Gå’ŒD_Fä¹‹é—´çš„å·®è·ï¼‰ç”±äºç½‘ç»œä¸­ç”¨çš„å·ç§¯æ ¸å¤§å°D_kå‡ä¸º3x3ï¼Œä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å‚æ•°é‡çº¦ä¸ºæ ‡å‡†å·ç§¯çš„ã€‚</p> 
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-bbbaf0cc6ea8b070.png" alt="14755769-bbbaf0cc6ea8b070.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 2. Depthwiseå’ŒPointwiseè§†ä¸ºä¸¤å±‚ï¼Œåé¢å„æ¥ä¸€ç»„BNå’ŒReLU
    </div> 
   </div> 
   <p>â€ƒâ€ƒé™¤æ­¤ä¹‹å¤–ï¼Œè®ºæ–‡ä¸­è¿˜æåˆ°äº†ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œå°±æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ä¸­å¤§éƒ¨åˆ†è¿ç®—é‡éƒ½æ¥è‡ª1x1 Convï¼Œè€Œ1x1 Convs <em>"do not require this reordering in memory and can be implemented directly with GEMM which is one of the most optimized numerical linear algebra algorithms."</em>ï¼Œè¿™é‡Œçš„reorderingå°±æ˜¯ç»å…¸çš„<code>im2col</code>ï¼Œå³caffeä¸­å®ç°å·ç§¯çš„æ–¹æ³•ã€‚å°±æ˜¯è¯´å¦‚æœç©ºé—´ç»´åº¦å¤§äº1çš„å·ç§¯ï¼Œä¸ºäº†ä½¿ç”¨é«˜çº§ä¼˜åŒ–æ–¹æ³•GEMMï¼Œéœ€è¦å…ˆç”¨im2colè¿›è¡ŒçŸ©é˜µé‡ç»„ã€‚è€Œ1x1 ConvèŠ‚çœäº†è¿™ä¸€æ­¥ï¼Œæ•…æ–‡ç« ä¸­è¯´1x1 Convæ˜¯çº¿æ€§ä»£æ•°æ•°å€¼è®¡ç®—ä¸­çš„æœ€ä¼˜ç®—æ³•ä¹‹ä¸€ã€‚è¯¦ç»†äº†è§£im2colå¯ä»¥è§<a href="https://blog.csdn.net/Mrhiuser/article/details/52672824" rel="nofollow">è¿™ç¯‡åšå®¢</a>ã€‚æ³¨æ„caffeä¸­æ˜¯æŒ‰è¡Œä¼˜å…ˆï¼Œè€ŒMatlabæ˜¯æŒ‰åˆ—ä¼˜å…ˆã€‚<br></p>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-5a05b0a91f61eb7a.png" alt="14755769-5a05b0a91f61eb7a.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 3. im2colä¸reordering
    </div> 
   </div>
   <p></p> 
   <h4>2.2 Width Multiplierä¸Resolution Multiplier</h4> 
   <ul>
    <li><p>Width Multiplier<br> å¯¹å„å±‚ä½¿ç”¨åŒä¸€ä¸ªç¼©æ”¾å› å­æ¥å‡å°‘æ»¤æ³¢å™¨ä¸ªæ•°ï¼Œä½¿è¾“å…¥é€šé“æ•°å˜ä¸ºï¼Œè¾“å‡ºé€šé“æ•°å˜ä¸ºã€‚é€šå¸¸åœ¨1, 0.75, 0.5, 0.25ä¸­é€‰æ‹©ã€‚1ä¸ºæ ‡å‡†MobileNetï¼Œå…¶ä»–ä¸‰ä¸ªä¸ºç²¾ç®€çš„MobileNetã€‚èŠ‚çœçš„è®¡ç®—é‡çº¦ä¸º ã€‚</p></li> 
    <li><p>Resolution Multiplier<br> å¯¹ç½‘ç»œè¾“å…¥å°ºå¯¸ä½¿ç”¨ä¸€ä¸ªç¼©æ”¾å› å­ï¼Œè¿›è€Œä½¿å¾—æ¯ä¸€å±‚feature mapå°ºå¯¸éƒ½å˜æˆåŸæ¥çš„å€ã€‚è¿™ä¸ªç¼©æ”¾å› å­å®é™…ä¸Šå°±æ˜¯é€‰æ‹©ä¸åŒçš„è¾“å…¥å°ºå¯¸ï¼Œæ²¡æœ‰åƒWidth Multiplieré‚£æ ·æ˜¾å¼è®¾ç½®ã€‚è¯¥å› å­èŠ‚çœçš„è®¡ç®—é‡ä¹Ÿçº¦ä¸ºã€‚</p></li> 
   </ul>
   <h4>2.3 å®éªŒåˆ†æ</h4> 
   <h5>2.3.1 æ·±åº¦å¯åˆ†ç¦»å·ç§¯å¸¦æ¥çš„æ€§èƒ½ä¸‹é™å¯ä»¥æ¥æ”¶</h5> 
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-cb6f7154b7c9b892.png" alt="14755769-cb6f7154b7c9b892.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 4. å°†MobileNetä¸­çš„å·ç§¯å…¨éƒ¨æ¢æˆæ™®é€šå·ç§¯ï¼Œå¯¹æ¯”ç»“æœ
    </div> 
   </div> 
   <h5>2.3.2 Shallower or thinner?</h5> 
   <p>â€ƒâ€ƒåœ¨å¯¹åŸå§‹MobileNetè¿›è¡Œè¿›ä¸€æ­¥å‹ç¼©æ—¶ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨Width Multiplierï¼Œè€Œä¸æ˜¯ç®€å•åœ°å‡å°‘æ¨¡å‹çš„å±‚æ•°ï¼Ÿæ–‡ç« é€šè¿‡å®éªŒè¯æ˜ï¼Œä½¿ç”¨ç¼©å‡ç½‘ç»œæ¯”å‡å°ç½‘ç»œå±‚æ•°æ€§èƒ½è¦å¥½ã€‚<br></p>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-de07ca3e4c7af3f7.png" alt="14755769-de07ca3e4c7af3f7.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 5. Narrow v.s. Shallow MobileNet
    </div> 
   </div>
   <p></p> 
   <h5>2.3.3 Width Multiplierå¯ä»¥è®¾å¤šå¤§ï¼Ÿ</h5> 
   <p>â€ƒâ€ƒè¿™ä¸ªåº”è¯¥æ˜¯å¤§å®¶æœ€å…³å¿ƒçš„å®éªŒäº†ã€‚æœ¬å®éªŒè¯æ˜åœ¨ä»1é™åˆ°0.5çš„è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹æ€§èƒ½æ˜¯å¹³æ»‘ä¸‹é™çš„ï¼›å½“ä»0.5é™åˆ°0.25æ—¶ï¼Œæ€§èƒ½å¤§å¹…ä¸‹é™ã€‚å¯è§å¯¹æ¨¡å‹æ€§èƒ½å½±å“è¾ƒå°ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå€¼å¾—å°è¯•çš„é€‰æ‹©ã€‚<br></p>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-3b4615c9a52f4c58.png" alt="14755769-3b4615c9a52f4c58.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 6. Î±çš„å½±å“
    </div> 
   </div>
   <p></p> 
   <h5>2.3.4 è¾“å…¥åˆ†è¾¨ç‡çš„å½±å“ï¼Ÿ</h5> 
   <p>â€ƒâ€ƒéšç€è¾“å…¥åˆ†è¾¨ç‡çš„é™ä½ï¼Œæ¨¡å‹æ€§èƒ½çš„ä¸‹é™è¶‹åŠ¿è¾ƒå¹³æ»‘ï¼š</p> 
   <br>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-de7102249097eaee.png" alt="14755769-de7102249097eaee.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 7. Ïçš„å½±å“
    </div> 
   </div> 
   <h5>2.3.5 å…¶ä»–å®éªŒ</h5> 
   <p>â€ƒâ€ƒæœ¬æ–‡è¿˜æ¯”è¾ƒäº†MobileNetä¸å…¶ä»–ç½‘ç»œçš„æ€§èƒ½ã€‚æ¯”å¦‚1.0MobileNet-224è¦å¼ºäºGoogLeNetï¼Œç¨é€ŠäºVGG16ï¼Œä½†æ˜¯ç›¸æ¯”VGG16ï¼Œæ¨¡å‹å¤§å°ç¼©å°äº†32å€ï¼Œè®¡ç®—é‡å°‘äº†27å€ï¼å¦å¤–ï¼Œ0.5 MobileNet-160çš„æ€§èƒ½å°±è¶…è¿‡SqueezeNetå’ŒAlexNetäº†ã€‚</p> 
   <h3>ä¸‰ã€ä»£ç å®ç°</h3> 
   <h4>3.1 Gluonä¸­Conv2D</h4> 
   <p>â€ƒâ€ƒGluonä¸­nn.Conv2Dæä¾›äº†ä¾¿åˆ©çš„æ¥å£ï¼Œå³é€šè¿‡è®¾ç½®groupså‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå·ç§¯è¿›è¡Œçš„æ–¹å¼ã€‚è§ä¸‹æ–¹çš„å‚æ•°è¯´æ˜</p> 
   <br>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-e9e1b712e9730740.png" alt="14755769-e9e1b712e9730740.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 8. Conv2Då‚æ•°
    </div> 
   </div> 
   <ul>
    <li>è¿™ä¸ªå‚æ•°ä»‹ç»ä¿¡æ¯é‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚å€¼å¾—æ³¨æ„çš„æœ‰å‡ ä¸ªåœ°æ–¹ï¼š</li> 
   </ul>
   <ol>
    <li>é€šå¸¸ä¸€ç§æ¯”è¾ƒçœäº‹çš„åšæ³•æ˜¯ä½¿ç”¨Conv2Dæ—¶ä¸æŒ‡å®šinput_channelsï¼Œä¸è¿‡è¿™æ ·å®šä¹‰å®Œç½‘ç»œä¹‹åï¼Œæ¨¡å‹çš„åˆå§‹åŒ–ä¼šè¢«æ¨è¿Ÿè¿›è¡Œï¼Œå³å½“æ¨¡å‹ç¬¬ä¸€æ¬¡call forwardå‡½æ•°æ—¶æ‰ä¼šæ ¹æ®è¾“å…¥å›¾åƒå°ºå¯¸æ¨æ–­input_channelsè¿›è€Œåˆå§‹åŒ–ç½‘ç»œå‚æ•°ã€‚è¿™æ ·å¯èƒ½ä¼šå½±å“model.summary()ç­‰å‡½æ•°çš„ä½¿ç”¨ã€‚</li> 
    <li>çœ‹èµ·æ¥Conv2Dä¹Ÿæä¾›äº†æ‰©å¼ å·ç§¯çš„æ¥å£</li> 
    <li> <code>groups</code>å‚æ•°ï¼šæ§åˆ¶è¾“å…¥ç‰¹å¾å›¾å’Œè¾“å‡ºç‰¹å¾å›¾çš„è¿æ¥æ–¹å¼ã€‚é»˜è®¤groups=1ï¼Œå³å·ç§¯æ ¸çš„æ·±åº¦å’Œè¾“å…¥é€šé“æ·±åº¦ç›¸åŒã€‚<strong>å¦‚æœå–2ï¼Œåˆ™æ•ˆæœç›¸å½“äºå°†è¾“å…¥ç‰¹å¾æŒ‰é€šé“é‚£ä¸€ç»´åˆ†æˆä¸¤åŠï¼Œæ¯ä¸€åŠä¸ä¸€ä¸ªgroupè¿›è¡Œå·ç§¯ï¼Œè¾“å‡ºçš„ç‰¹å¾å›¾concatå¾—åˆ°ä¸€ä¸ªç‰¹å¾å›¾ã€‚</strong>å› æ­¤ï¼Œå¦‚æœå°†groupså‚æ•°è®¾ç½®ä¸ºåŒè¾“å…¥é€šé“æ•°ç›®ä¸€è‡´ï¼Œå°±æ˜¯Depthwise Convolutionã€‚</li> 
   </ol>
   <p>â€ƒâ€ƒé¦–å…ˆæˆ‘åšäº†ä¸€ä¸ªå°å®éªŒæ¥å¯¹æ¯”æ™®é€šå·ç§¯å’Œgroups&gt;1çš„å·ç§¯ï¼Œæ¥éªŒè¯è¯¥å‚æ•°æ˜¯å¦å¯ç”¨äºç®€ä¾¿åœ°å®ç°depthwise convã€‚å®éªŒè™½ç„¶é€‰å–äº†è¾ƒå°çš„è¾“å…¥feature mapå’Œå·ç§¯æ ¸ï¼Œä½†æ˜¯è¾“å‡ºç»“æœè¿˜æ˜¯æ¯”è¾ƒå†—é•¿ã€‚æœ‰å…´è¶£çš„å¯ä»¥ç›´æ¥çœ‹<a href="https://github.com/cy810557/chiyuan/blob/master/Projects/Classifications/MobileNets/MobileNet-Gluon.ipynb" rel="nofollow">ä»£ç </a>ï¼Œåé¢MobileNetçš„æ­å»ºä»¥åŠè®­ç»ƒå®éªŒä¹Ÿåœ¨é‡Œé¢ã€‚è¿™é‡Œç›´æ¥æ”¾ä¸Šç»“è®ºï¼š</p> 
   <ul>
    <li>å¯ä»¥ä½¿ç”¨Gluonæä¾›çš„groupsæ¥å£å®ç°Depthwise Convã€‚ åªéœ€è¦è®¾ç½®<code>num_in_channels(in_channels)==num_out_channels(channels)==groups</code>ï¼Œå½“ç„¶ï¼ŒåŒæ™®é€šå·ç§¯ï¼Œin_channelså‚æ•°ä¹Ÿå¯ä»¥ä¸æ˜¾å¼åœ°æŒ‡å®šã€‚ä¸è¿‡è¿™æ ·æ¨¡å‹åˆå§‹åŒ–ä¼šå»¶ååˆ°ç¬¬ä¸€æ¬¡model.forwardä¹‹åè¿›è¡Œã€‚</li> 
   </ul>
   <h4>3.2 å®ç°MobileNet</h4> 
   <p>â€ƒâ€ƒ</p> 
   <pre><code class="python">from mxnet import nd
import numpy as np
from mxnet.gluon import nn
import mxnet as mx
from mxnet import gluon

class ConvBlock(nn.HybridBlock):
    def __init__(self, in_channels, channels, strides, padding, num_sync_bn_devices=-1, multiplier=1.0):
        super(ConvBlock, self).__init__()
        self.conv_block = nn.HybridSequential()
        with self.conv_block.name_scope():
            self.conv_block.add(nn.Conv2D(int(channels*multiplier), 3, strides, padding, 
                                          in_channels=in_channels, use_bias=False))
            if num_sync_bn_devices == -1:
                self.conv_block.add(nn.BatchNorm())
            else:
                self.conv_block.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices))
            self.conv_block.add(nn.Activation('relu'))
    def hybrid_forward(self, F, x):
        return self.conv_block(x)

class DepthwiseSeperable(nn.HybridBlock):
    def __init__(self, in_channels, channels, strides, num_sync_bn_devices=-1, multiplier=1.0, **kwags):
        # Weidth Multiplier
        in_channels = int(in_channels * multiplier)
        channels = int(channels * multiplier)
        super(DepthwiseSeperable, self).__init__(**kwags)
        self.depthwise = nn.HybridSequential()
        with self.depthwise.name_scope():
            self.depthwise.add(nn.Conv2D(in_channels, 3, strides, padding=1,groups=in_channels, 
                                         in_channels=in_channels, use_bias=False))
            if num_sync_bn_devices == -1:
                self.depthwise.add(nn.BatchNorm())
            else:
                self.depthwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices))
            self.depthwise.add(nn.Activation('relu'))
            
        self.pointwise = nn.HybridSequential()
        with self.pointwise.name_scope():
            self.pointwise.add(nn.Conv2D(channels, 1, in_channels=in_channels, use_bias=False))
            if num_sync_bn_devices == -1:
                self.pointwise.add(nn.BatchNorm())
            else:
                self.pointwise.add(gluon.contrib.nn.SyncBatchNorm(num_devices=num_sync_bn_devices))
            self.pointwise.add(nn.Activation('relu'))
       
    def hybrid_forward(self, F, x):
        return(self.pointwise(self.depthwise(x)))

class MobileNet(nn.HybridBlock):
    def __init__(self, num_classes, n_devices=2, multiplier=1.0, **kwags):
        super(MobileNet, self).__init__(**kwags)
        self.net = nn.HybridSequential()
        self.net.add(ConvBlock(3, 32, 2, 1, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(32, 64, 1, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(64, 128, 2, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(128, 128, 1, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(128, 256, 2, n_devices, multiplier))

        self.net.add(DepthwiseSeperable(256, 256, 1, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(256, 512, 2, n_devices, multiplier))
        for _ in range(5):
            self.net.add(DepthwiseSeperable(512, 512, 1, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(512, 1024, 2, n_devices, multiplier))
        self.net.add(DepthwiseSeperable(1024, 1024, 1, n_devices, multiplier))

        self.net.add(nn.GlobalAvgPool2D())
        self.net.add(nn.Dense(num_classes))

    def hybrid_forward(self, F, x):
        return self.net(x)
</code></pre> 
   <ul>
    <li>å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µå°ä»£ç æ£€æŸ¥ä¸‹ä¸Šé¢å®šä¹‰çš„æ¨¡å‹ï¼š</li> 
   </ul>
   <pre><code class="python">net = MobileNet(num_classes=1000, n_devices=2, multiplier=1.0)
net.initialize(mx.init.Xavier())
test_input = nd.random_normal(shape=(1, 3, 224, 224))
net.summary(test_input)
</code></pre> 
   <ul>
    <li>ä¹Ÿå¯ä»¥ä½¿ç”¨mxnet.viz.plot_networksæ‰“å°å‡ºæ¨¡å‹çš„graphï¼Œä¸è¿‡éœ€è¦å…ˆå°†æ¨¡å‹è½¬æ¢ä¸ºsymbolï¼š</li> 
   </ul>
   <pre><code>net.hybridize()
output = net.forward(test_input)
# exportä¹‹ååŒæ—¶ç”Ÿæˆäº†ä¸€ä¸ª.jsonæ–‡ä»¶å’Œ.paramsæ–‡ä»¶
net.export('Gluon-MobileNet')
symnet = mx.symbol.load('Gluon-MobileNet-symbol.json')
mx.viz.plot_network(symnet, title='mobilnet_viz', shape={'data':(1, 3, 224, 224)})
</code></pre> 
   <p>å›¾ç‰‡å¤ªé•¿è¿™é‡Œå°±ä¸æ”¾äº†ã€‚å¯ä»¥åˆ°<a href="https://github.com/cy810557/chiyuan/blob/master/Projects/Classifications/MobileNets/MobileNet-Gluon.ipynb" rel="nofollow">notebook</a>ä¸­å»çœ‹ã€‚</p> 
   <h4>3.3 Experiment on CIFAR10</h4> 
   <p>è¶…å‚æ•°è®¾ç½®ï¼š</p> 
   <pre><code>OPTIMIZER: 'nag'
BATCH_SIZE = 64  # per gpu
EPOCHS = 200
LR = 1e-1
WD = 5e-4
MOMENTUM = 0.9
lr_decay_dict = {40:0.1, 80:0.1, 120:0.1}
</code></pre> 
   <p>æ•°æ®å¢å¼ºï¼š</p> 
   <ul>
    <li>è®­ç»ƒæ•°æ®ï¼šéšæœºå·¦å³ç¿»è½¬ï¼›å½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼›</li> 
    <li>æµ‹è¯•æ•°æ®ï¼šå½’ä¸€åŒ–åˆ°0-1ï¼›å‡å»æ•°æ®é›†å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼›</li> 
   </ul>
   <p>ç»“æœï¼š</p> 
   <br>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-cb0058007f3ec876.png" alt="14755769-cb0058007f3ec876.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 9. Training Curve
    </div> 
   </div>
   <br>
   <div class="image-package"> 
    <div class="image-container"> 
     <div class="image-container-fill"></div> 
     <div class="image-view">
      <img src="https://upload-images.jianshu.io/upload_images/14755769-7576ddfa29602eeb.png" alt="14755769-7576ddfa29602eeb.png">
     </div> 
    </div> 
    <div class="image-caption">
     Fig. 10. Classification Report
    </div> 
   </div> 
   <ul>
    <li>ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡æ˜¯æ¨¡å‹åœ¨ç¬¬äºŒæ¬¡decay 0.1æ—¶çš„ç¬¬äºŒæˆ–ç¬¬ä¸‰ä¸ªepochå¼€å§‹ï¼ˆå›¾ä¸­å¤§æ¦‚ç¬¬80ä¸ªepochå¤„ï¼‰ä¼šè¿…é€Ÿå¼€å§‹è¿‡æ‹Ÿåˆã€‚çœ‹èµ·æ¥æ¨¡å‹çš„è®­ç»ƒå—å­¦ä¹ ç‡è¡°å‡çš„å½±å“éå¸¸å¤§ã€‚</li> 
   </ul>
  </div> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- è‡ªå®šä¹‰å¹¿å‘Š -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">æ›´å¤šç²¾å½©å†…å®¹</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">å›é¦–é¡µ</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
