<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>吴恩达机器学习笔记（二）——单变量线性回归 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="吴恩达机器学习笔记（二）——单变量线性回归" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="文章目录 前言 一、符号定义 二、代价函数 三、梯度下降算法 四、Matlab算法实现 五、结语 前言 上一章我们学习了机器学习的应用领域、定义以及算法的分类，这一章来学习最简单的一个机器学习算法——单变量线性回归算法，它是一种监督学习的算法，而且输出值是连续变化的值，因此是一种“回归”算法。 一、符号定义 我们通过吴老师课堂上给出的练习题中的例子来学习单变量线性回归算法。 　　在进行监督学习算法的时候，我们首先要有一个训练集，这里的训练集就是人们统计的50名不同年龄的儿童和他们的身高，如下图所示。 　　　　 这里我们开发机器学习算法的目的就是找出身高与年龄的大致对应关系，从而可以预测特定年龄小孩的大致身高。 　　因此，这个训练集中，我们的输入值是年龄，输出值是身高。通常来讲，我们称输入变量为特征（feature），用 x x x表示，输出值定义为 y y y，这里的 x x x就是小孩的年龄了，因为只有这么一个输入变量，因此这个问题是一个单变量的问题，如果有多个输入变量的话可以用 x 1 , x 2 , x 3 ⋯ x_1,x_2,x_3\cdots x1​,x2​,x3​⋯表示。我们用 m m m表示训练样本的数量，在本例中， m m m就是小孩的数量，也就是 m = 50 m=50 m=50。我们用符号（ x ( i ) x^{(i)} x(i)， y ( i ) y^{(i)} y(i)）表示第 i i i个小孩的年龄和身高， i = 1 , 2 , 3 ⋯ 50 i=1,2,3\cdots50 i=1,2,3⋯50。 　　接下来，为了找出x和y之间的关系，我们把x和y画成散点图，如下所示 　　　　　　　 从数据点的分布可以看出，身高和年龄之间大致呈线性关系，因此假设身高与年龄之间的函数关系是一个线性函数。这个假设函数（hypothesis）我们将其命名为 h h h，即 y = h ( x ) y=h(x) y=h(x)，机器学习算法的目的就是找出 h ( x ) h(x) h(x)的具体表达式。在本例中，我们认为假设函数是一条直线，于是有 h ( x ) = θ 0 + θ 1 x h(x)=\theta_{0}+\theta_{1}x h(x)=θ0​+θ1​x，其中 θ 1 \theta_{1} θ1​表示直线的斜率， θ 0 \theta_{0} θ0​表示直线在 x x x轴上的截距。 　　这样，我们的研究目标就转化为寻找最优的 θ 0 \theta_{0} θ0​和 θ 1 \theta_{1} θ1​。等学习了后面的内容后，我们就会发现，监督学习算法的最终目的通常就是寻找最优的参数。 　　接下来，为了让我们的表达方法更具有普适性和简洁性，我们把变量都用向量的方式来表示。我们定义函数 h ( x ) h(x) h(x)的参数为向量 θ = \mathbf{\theta}= θ= [ θ 0 θ 1 ] \left[\begin{matrix}\theta_{0}\\\theta_{1}\end{matrix}\right] [θ0​θ1​​]，同时，我们将 x x x也写成向量的形式，为了让 x x x和 θ \mathbf{\theta} θ对应起来，我们给它增加一个常数1，变成： x = \mathbf{x}= x= [ 1 x ] \left[\begin{matrix}1\\x\end{matrix}\right] [1x​]，由于只有一个输出量，因此 y y y的向量形式为 y = \mathbf{y}= y= [ y ] \left[\begin{matrix}y\end{matrix}\right] [y​]。这样，我们样本集的输入值就可以写成一个 2 × m 2×m 2×m的矩阵： [ 1 1 ⋯ x ( 1 ) x ( 2 ) ⋯ ] \left[\begin{matrix}1&amp;amp;1&amp;amp;\cdots\\x^{(1)}&amp;amp;x^{(2)}&amp;amp;\cdots\end{matrix}\right] [1x(1)​1x(2)​⋯⋯​]，输出值就可以写成一个 1 × m 1×m 1×m的矩阵 [ y ( 1 ) y ( 2 ) ⋯ ] \left[\begin{matrix}y^{(1)}&amp;amp;y^{(2)}&amp;amp;\cdots\end{matrix}\right] [y(1)​y(2)​⋯​]。这样一来我们的假设函数就可以用向量表示为 h = θ T × x h=\mathbf{\theta^{T}}\times\mathbf{x} h=θT×x，这里的 × \times ×是矩阵的乘积，我们也可以省略这个乘号，写成 h = θ T x h=\mathbf{\theta^{T}}\mathbf{x} h=θTx。这种表达方式对后面的多变量回归乃至逻辑回归都是适用的，同时也可以方便地转化为Matlab代码。因此，以后我们就用不带下标的字母 θ \mathbf{\theta} θ表示参数向量，用 θ 0 , θ 1 ⋯ \theta_{0},\theta_{1}\cdots θ0​,θ1​⋯表示向量中的元素；用 x \mathbf{x} x表示输入向量， x j x_j xj​表示第 j j j个输入变量， x j ( i ) x^{(i)}_j xj(i)​表示第 i i i个样本的第 j j j个输入变量；同样地， y \mathbf{y} y表示输出向量， y j y_j yj​表示第 j j j个输出量， y j ( i ) y^{(i)}_j yj(i)​表示第 i i i个样本的第 j j j个输出量 　　至此，我们就完成了单变量线性回归的准备工作了，下面开始考虑如何寻找最优的参数 θ \mathbf{\theta} θ。 二、代价函数 为了寻找最优的参数 θ \mathbf{\theta} θ，我们首先要确定一个标准，即什么样的参数是“优”的。直观地理解，对于每一个样本，我们的函数值 h ( x ( i ) ) h(x^{(i)}) h(x(i))与实际的输出值 y ( i ) y^{(i)} y(i)符合得越好，我们认为对应的参数越“好”。我们可以使用方差 [ h ( x ( i ) ) − y ( i ) ] 2 [h(x^{(i)})-y^{(i)}]^{2} [h(x(i))−y(i)]2来定量地描述这两个值的符合程度，方差越大，说明这两个值的差异越大，方差为零时这两个值完全相同。 　　综合考虑所有的样本，我们可以用所有样本的方差之和 J = ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] 2 J=\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}} J=i=1∑m​[h(x(i))−y(i)]2来表征函数 h h h与样本集整体的符合程度， J J J越小，符合程度越高，我们称函数 J J J为函数 h h h的代价函数。 　　从函数 J J J的定义可以看出它的大小只与参数 θ \mathbf{\theta} θ有关，即 J = J ( θ ) J=J(\mathbf{\theta}) J=J(θ)。这样一来，我们的目标就再一次转化为寻找使代价函数值 J J J最小的参数 θ \mathbf{\theta} θ。 三、梯度下降算法 那么，如何寻找 J J J最小时的参数 θ \mathbf{\theta} θ呢？这就要用到梯度下降算法了。 　　梯度下降算法的思想很简单， J ( θ 0 , θ 1 ) J(\theta_{0},\theta_{1}) J(θ0​,θ1​)实际上是一个关于 θ 0 和 θ 1 \theta_{0}和\theta_{1} θ0​和θ1​的二维曲面，每一对 ( θ 0 , θ 1 ) (\theta_{0},\theta_{1}) (θ0​,θ1​)都对应于曲面上的一个点，如下图所示： 　　　　 我们先任意初始化一个 θ \mathbf{\theta} θ值，然后找出该点处 J J J下降最快的方向，将 θ \mathbf{\theta} θ向这个方向移动一小步，然后再重新寻找 J J J下降最快的方向，再向新的方向移动一小步，如此循环，直到 J J J达到最小值，这个过程中 θ \mathbf{\theta} θ的移动路径如上图中黑色四芒星所示。 　　而函数 J J J下降最快的方向其实就是函数 J ( θ 0 , θ 1 ) J(\theta_{0},\theta_{1}) J(θ0​,θ1​)的梯度的反方向。根据梯度的定义，函数 J J J的梯度为 ∇ J = ∂ J ∂ θ 0 θ 0 → + ∂ J ∂ θ 1 θ 1 → \nabla{J}=\frac{\partial{J}}{\partial{\theta_{0}}}\overrightarrow{\theta_{0}}+\frac{\partial{J}}{\partial{\theta_{1}}}\overrightarrow{\theta_{1}} ∇J=∂θ0​∂J​θ0​ ​+∂θ1​∂J​θ1​ ​，其中， θ 0 → \overrightarrow{\theta_{0}} θ0​ ​和 θ 1 → \overrightarrow{\theta_{1}} θ1​ ​分别代表沿 θ 0 \theta_{0} θ0​和 θ 1 \theta_{1} θ1​正方向的单位向量，为了使 θ \mathbf{\theta} θ往 J J J下降最快的方向移动，应该使 θ 0 \theta_{0} θ0​和 θ 1 \theta_{1} θ1​分别减去 α ∗ ∂ J ∂ θ 0 \alpha*\frac{\partial{J}}{\partial{\theta_{0}}} α∗∂θ0​∂J​和 α ∗ ∂ J ∂ θ 1 \alpha*\frac{\partial{J}}{\partial{\theta_{1}}} α∗∂θ1​∂J​，其中 α \alpha α(&gt;0)代表移动的步长。于是，梯度下降算法的计算过程如下所示： 　　Step1、初始化 θ \mathbf{\theta} θ：例如令 θ 0 = θ 1 = 0 \theta_{0}=\theta_{1}=0 θ0​=θ1​=0; 　　Step2、计算当前 θ \mathbf{\theta} θ值对应的 J J J的梯度值： ∂ J ∂ θ 0 \frac{\partial{J}}{\partial{\theta_{0}}} ∂θ0​∂J​, ∂ J ∂ θ 1 \frac{\partial{J}}{\partial{\theta_{1}}} ∂θ1​∂J​； 　　Step3、更新 θ \mathbf{\theta} θ： θ 0 : = θ 0 − α ∗ ∂ J ∂ θ 0 \theta_{0}:=\theta_{0}-\alpha*\frac{\partial{J}}{\partial{\theta_{0}}} θ0​:=θ0​−α∗∂θ0​∂J​； θ 1 : = θ 1 − α ∗ ∂ J ∂ θ 1 \theta_{1}:=\theta_{1}-\alpha*\frac{\partial{J}}{\partial{\theta_{1}}} θ1​:=θ1​−α∗∂θ1​∂J​; 　　Step4、判断是否结束循环，若为否则回到Step2。 　　从以上过程可以看出，每一步的移动步长是由该点处 J J J的梯度大小和 α \alpha α共同决定的。在 α \alpha α大小不变的情况下，当 J J J离最小值较远时，对应的梯度值较大， θ \mathbf{\theta} θ移动的较快； J J J越接近最小值， θ \mathbf{\theta} θ移动步长越小，最终逐渐收敛到 J J J最小处。 　　而第二步中偏导数 ∂ J ∂ θ 0 \frac{\partial{J}}{\partial{\theta_{0}}} ∂θ0​∂J​, ∂ J ∂ θ 1 \frac{\partial{J}}{\partial{\theta_{1}}} ∂θ1​∂J​的值可以将 h ( x ) = θ 0 + θ 1 x h(x)=\theta_{0}+\theta_{1}x h(x)=θ0​+θ1​x代入 J = ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] 2 J=\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}} J=i=1∑m​[h(x(i))−y(i)]2中计算得出。根据偏导数的运算规则，可以得出： ∂ J ∂ θ 0 = 2 ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] \frac{\partial{J}}{\partial{\theta_{0}}}=2\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]} ∂θ0​∂J​=2i=1∑m​[h(x(i))−y(i)]； ∂ J ∂ θ 1 = 2 ∑ i = 1 m x ( i ) [ h ( x ( i ) ) − y ( i ) ] \frac{\partial{J}}{\partial{\theta_{1}}}=2\sum\limits_{i=1}^m{x^{(i)}[h(x^{(i)})-y^{(i)}]} ∂θ1​∂J​=2i=1∑m​x(i)[h(x(i))−y(i)]，实际执行时，会在前面乘上一个系数 1 2 m \frac{1}{2m} 2m1​,并不会影响最终的优化结果。 四、Matlab算法实现 接下来，用Matlab来实现以上过程，代码如下： %导入训练集； x=load(&#39;ex2x.dat&#39;); y=load(&#39;ex2y.dat&#39;); %画出训练集的散点图 figure, subplot(121), plot(x,y,&#39;o&#39;); ylabel(&#39;Height in meters&#39;); xlabel(&#39;Age in years&#39;); hold on; %step1、初始化相关参数，注意：这里我们将x和y写成了m*2和m*1的向量形 %式，这样一来h=x*theta，与文中所述有所不同。 m=length(y); x=[ones(m,1),x]; n=2; theta=zeros(n,1); alpha=0.07; %开始单变量梯度下降循环，并实时显示J的变化 subplot(122); for step=1:800 %先计算h-y的值，h-y是一个m×1的向量 h_y=x*theta-y; %step2、3 计算梯度并更新θ的值，通过向量乘法实现样本的求和。 theta(1)=theta(1)-alpha/m*(h_y&#39;*x(:,1)); theta(2)=theta(2)-alpha/m*(h_y&#39;*x(:,2)); %计算并显示代价函数值 J=sum(h_y.^2)/m/2; if mod(step,10)==9 plot(step,log10(J),&#39;o&#39;); axis([0,800,-inf,inf]); ylabel(&#39;log(J)&#39;); xlabel(&#39;Step&#39;); hold on; drawnow; end end %显示最终的优化结果 subplot(121), tempx=linspace(2,8,100); tempy=theta(1)+tempx*theta(2); plot(tempx,tempy); %准备数据，画出代价函数曲面 Jval=zeros(100,100); theta0=linspace(-3,3,100); theta1=linspace(-1,1,100); for xs=1:length(theta0) for ys=1:length(theta1) theta=[theta0(xs);theta1(ys)]; h_y=x*theta-y; Jval(xs,ys)=sum(h_y.^2)/m/2; end end figure, surf(theta0,theta1,Jval&#39;); axis([-3,3,-1,1]); xlabel(&#39;\theta_0&#39;); ylabel(&#39;\theta_1&#39;) 程序的运行结果如下图所示，红色的直线为最终的优化结果。 五、结语 以上Matlab代码中用到的数据和代码文件可以在这里下载，提取码m806 　　这一章主要介绍了单变量线性回归算法的原理和实现过程，定义了相关的符号和函数。随着后续的学习我们会发现，本章所学习的算法过程也是其它监督学习算法的大致实现过程，即定义特征量和假设函数、推导代价函数和偏导数、应用梯度下降算法寻找最优参数。 　　下一章介绍多变量的线性回归算法的原理和实现方法。" />
<meta property="og:description" content="文章目录 前言 一、符号定义 二、代价函数 三、梯度下降算法 四、Matlab算法实现 五、结语 前言 上一章我们学习了机器学习的应用领域、定义以及算法的分类，这一章来学习最简单的一个机器学习算法——单变量线性回归算法，它是一种监督学习的算法，而且输出值是连续变化的值，因此是一种“回归”算法。 一、符号定义 我们通过吴老师课堂上给出的练习题中的例子来学习单变量线性回归算法。 　　在进行监督学习算法的时候，我们首先要有一个训练集，这里的训练集就是人们统计的50名不同年龄的儿童和他们的身高，如下图所示。 　　　　 这里我们开发机器学习算法的目的就是找出身高与年龄的大致对应关系，从而可以预测特定年龄小孩的大致身高。 　　因此，这个训练集中，我们的输入值是年龄，输出值是身高。通常来讲，我们称输入变量为特征（feature），用 x x x表示，输出值定义为 y y y，这里的 x x x就是小孩的年龄了，因为只有这么一个输入变量，因此这个问题是一个单变量的问题，如果有多个输入变量的话可以用 x 1 , x 2 , x 3 ⋯ x_1,x_2,x_3\cdots x1​,x2​,x3​⋯表示。我们用 m m m表示训练样本的数量，在本例中， m m m就是小孩的数量，也就是 m = 50 m=50 m=50。我们用符号（ x ( i ) x^{(i)} x(i)， y ( i ) y^{(i)} y(i)）表示第 i i i个小孩的年龄和身高， i = 1 , 2 , 3 ⋯ 50 i=1,2,3\cdots50 i=1,2,3⋯50。 　　接下来，为了找出x和y之间的关系，我们把x和y画成散点图，如下所示 　　　　　　　 从数据点的分布可以看出，身高和年龄之间大致呈线性关系，因此假设身高与年龄之间的函数关系是一个线性函数。这个假设函数（hypothesis）我们将其命名为 h h h，即 y = h ( x ) y=h(x) y=h(x)，机器学习算法的目的就是找出 h ( x ) h(x) h(x)的具体表达式。在本例中，我们认为假设函数是一条直线，于是有 h ( x ) = θ 0 + θ 1 x h(x)=\theta_{0}+\theta_{1}x h(x)=θ0​+θ1​x，其中 θ 1 \theta_{1} θ1​表示直线的斜率， θ 0 \theta_{0} θ0​表示直线在 x x x轴上的截距。 　　这样，我们的研究目标就转化为寻找最优的 θ 0 \theta_{0} θ0​和 θ 1 \theta_{1} θ1​。等学习了后面的内容后，我们就会发现，监督学习算法的最终目的通常就是寻找最优的参数。 　　接下来，为了让我们的表达方法更具有普适性和简洁性，我们把变量都用向量的方式来表示。我们定义函数 h ( x ) h(x) h(x)的参数为向量 θ = \mathbf{\theta}= θ= [ θ 0 θ 1 ] \left[\begin{matrix}\theta_{0}\\\theta_{1}\end{matrix}\right] [θ0​θ1​​]，同时，我们将 x x x也写成向量的形式，为了让 x x x和 θ \mathbf{\theta} θ对应起来，我们给它增加一个常数1，变成： x = \mathbf{x}= x= [ 1 x ] \left[\begin{matrix}1\\x\end{matrix}\right] [1x​]，由于只有一个输出量，因此 y y y的向量形式为 y = \mathbf{y}= y= [ y ] \left[\begin{matrix}y\end{matrix}\right] [y​]。这样，我们样本集的输入值就可以写成一个 2 × m 2×m 2×m的矩阵： [ 1 1 ⋯ x ( 1 ) x ( 2 ) ⋯ ] \left[\begin{matrix}1&amp;amp;1&amp;amp;\cdots\\x^{(1)}&amp;amp;x^{(2)}&amp;amp;\cdots\end{matrix}\right] [1x(1)​1x(2)​⋯⋯​]，输出值就可以写成一个 1 × m 1×m 1×m的矩阵 [ y ( 1 ) y ( 2 ) ⋯ ] \left[\begin{matrix}y^{(1)}&amp;amp;y^{(2)}&amp;amp;\cdots\end{matrix}\right] [y(1)​y(2)​⋯​]。这样一来我们的假设函数就可以用向量表示为 h = θ T × x h=\mathbf{\theta^{T}}\times\mathbf{x} h=θT×x，这里的 × \times ×是矩阵的乘积，我们也可以省略这个乘号，写成 h = θ T x h=\mathbf{\theta^{T}}\mathbf{x} h=θTx。这种表达方式对后面的多变量回归乃至逻辑回归都是适用的，同时也可以方便地转化为Matlab代码。因此，以后我们就用不带下标的字母 θ \mathbf{\theta} θ表示参数向量，用 θ 0 , θ 1 ⋯ \theta_{0},\theta_{1}\cdots θ0​,θ1​⋯表示向量中的元素；用 x \mathbf{x} x表示输入向量， x j x_j xj​表示第 j j j个输入变量， x j ( i ) x^{(i)}_j xj(i)​表示第 i i i个样本的第 j j j个输入变量；同样地， y \mathbf{y} y表示输出向量， y j y_j yj​表示第 j j j个输出量， y j ( i ) y^{(i)}_j yj(i)​表示第 i i i个样本的第 j j j个输出量 　　至此，我们就完成了单变量线性回归的准备工作了，下面开始考虑如何寻找最优的参数 θ \mathbf{\theta} θ。 二、代价函数 为了寻找最优的参数 θ \mathbf{\theta} θ，我们首先要确定一个标准，即什么样的参数是“优”的。直观地理解，对于每一个样本，我们的函数值 h ( x ( i ) ) h(x^{(i)}) h(x(i))与实际的输出值 y ( i ) y^{(i)} y(i)符合得越好，我们认为对应的参数越“好”。我们可以使用方差 [ h ( x ( i ) ) − y ( i ) ] 2 [h(x^{(i)})-y^{(i)}]^{2} [h(x(i))−y(i)]2来定量地描述这两个值的符合程度，方差越大，说明这两个值的差异越大，方差为零时这两个值完全相同。 　　综合考虑所有的样本，我们可以用所有样本的方差之和 J = ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] 2 J=\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}} J=i=1∑m​[h(x(i))−y(i)]2来表征函数 h h h与样本集整体的符合程度， J J J越小，符合程度越高，我们称函数 J J J为函数 h h h的代价函数。 　　从函数 J J J的定义可以看出它的大小只与参数 θ \mathbf{\theta} θ有关，即 J = J ( θ ) J=J(\mathbf{\theta}) J=J(θ)。这样一来，我们的目标就再一次转化为寻找使代价函数值 J J J最小的参数 θ \mathbf{\theta} θ。 三、梯度下降算法 那么，如何寻找 J J J最小时的参数 θ \mathbf{\theta} θ呢？这就要用到梯度下降算法了。 　　梯度下降算法的思想很简单， J ( θ 0 , θ 1 ) J(\theta_{0},\theta_{1}) J(θ0​,θ1​)实际上是一个关于 θ 0 和 θ 1 \theta_{0}和\theta_{1} θ0​和θ1​的二维曲面，每一对 ( θ 0 , θ 1 ) (\theta_{0},\theta_{1}) (θ0​,θ1​)都对应于曲面上的一个点，如下图所示： 　　　　 我们先任意初始化一个 θ \mathbf{\theta} θ值，然后找出该点处 J J J下降最快的方向，将 θ \mathbf{\theta} θ向这个方向移动一小步，然后再重新寻找 J J J下降最快的方向，再向新的方向移动一小步，如此循环，直到 J J J达到最小值，这个过程中 θ \mathbf{\theta} θ的移动路径如上图中黑色四芒星所示。 　　而函数 J J J下降最快的方向其实就是函数 J ( θ 0 , θ 1 ) J(\theta_{0},\theta_{1}) J(θ0​,θ1​)的梯度的反方向。根据梯度的定义，函数 J J J的梯度为 ∇ J = ∂ J ∂ θ 0 θ 0 → + ∂ J ∂ θ 1 θ 1 → \nabla{J}=\frac{\partial{J}}{\partial{\theta_{0}}}\overrightarrow{\theta_{0}}+\frac{\partial{J}}{\partial{\theta_{1}}}\overrightarrow{\theta_{1}} ∇J=∂θ0​∂J​θ0​ ​+∂θ1​∂J​θ1​ ​，其中， θ 0 → \overrightarrow{\theta_{0}} θ0​ ​和 θ 1 → \overrightarrow{\theta_{1}} θ1​ ​分别代表沿 θ 0 \theta_{0} θ0​和 θ 1 \theta_{1} θ1​正方向的单位向量，为了使 θ \mathbf{\theta} θ往 J J J下降最快的方向移动，应该使 θ 0 \theta_{0} θ0​和 θ 1 \theta_{1} θ1​分别减去 α ∗ ∂ J ∂ θ 0 \alpha*\frac{\partial{J}}{\partial{\theta_{0}}} α∗∂θ0​∂J​和 α ∗ ∂ J ∂ θ 1 \alpha*\frac{\partial{J}}{\partial{\theta_{1}}} α∗∂θ1​∂J​，其中 α \alpha α(&gt;0)代表移动的步长。于是，梯度下降算法的计算过程如下所示： 　　Step1、初始化 θ \mathbf{\theta} θ：例如令 θ 0 = θ 1 = 0 \theta_{0}=\theta_{1}=0 θ0​=θ1​=0; 　　Step2、计算当前 θ \mathbf{\theta} θ值对应的 J J J的梯度值： ∂ J ∂ θ 0 \frac{\partial{J}}{\partial{\theta_{0}}} ∂θ0​∂J​, ∂ J ∂ θ 1 \frac{\partial{J}}{\partial{\theta_{1}}} ∂θ1​∂J​； 　　Step3、更新 θ \mathbf{\theta} θ： θ 0 : = θ 0 − α ∗ ∂ J ∂ θ 0 \theta_{0}:=\theta_{0}-\alpha*\frac{\partial{J}}{\partial{\theta_{0}}} θ0​:=θ0​−α∗∂θ0​∂J​； θ 1 : = θ 1 − α ∗ ∂ J ∂ θ 1 \theta_{1}:=\theta_{1}-\alpha*\frac{\partial{J}}{\partial{\theta_{1}}} θ1​:=θ1​−α∗∂θ1​∂J​; 　　Step4、判断是否结束循环，若为否则回到Step2。 　　从以上过程可以看出，每一步的移动步长是由该点处 J J J的梯度大小和 α \alpha α共同决定的。在 α \alpha α大小不变的情况下，当 J J J离最小值较远时，对应的梯度值较大， θ \mathbf{\theta} θ移动的较快； J J J越接近最小值， θ \mathbf{\theta} θ移动步长越小，最终逐渐收敛到 J J J最小处。 　　而第二步中偏导数 ∂ J ∂ θ 0 \frac{\partial{J}}{\partial{\theta_{0}}} ∂θ0​∂J​, ∂ J ∂ θ 1 \frac{\partial{J}}{\partial{\theta_{1}}} ∂θ1​∂J​的值可以将 h ( x ) = θ 0 + θ 1 x h(x)=\theta_{0}+\theta_{1}x h(x)=θ0​+θ1​x代入 J = ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] 2 J=\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}} J=i=1∑m​[h(x(i))−y(i)]2中计算得出。根据偏导数的运算规则，可以得出： ∂ J ∂ θ 0 = 2 ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] \frac{\partial{J}}{\partial{\theta_{0}}}=2\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]} ∂θ0​∂J​=2i=1∑m​[h(x(i))−y(i)]； ∂ J ∂ θ 1 = 2 ∑ i = 1 m x ( i ) [ h ( x ( i ) ) − y ( i ) ] \frac{\partial{J}}{\partial{\theta_{1}}}=2\sum\limits_{i=1}^m{x^{(i)}[h(x^{(i)})-y^{(i)}]} ∂θ1​∂J​=2i=1∑m​x(i)[h(x(i))−y(i)]，实际执行时，会在前面乘上一个系数 1 2 m \frac{1}{2m} 2m1​,并不会影响最终的优化结果。 四、Matlab算法实现 接下来，用Matlab来实现以上过程，代码如下： %导入训练集； x=load(&#39;ex2x.dat&#39;); y=load(&#39;ex2y.dat&#39;); %画出训练集的散点图 figure, subplot(121), plot(x,y,&#39;o&#39;); ylabel(&#39;Height in meters&#39;); xlabel(&#39;Age in years&#39;); hold on; %step1、初始化相关参数，注意：这里我们将x和y写成了m*2和m*1的向量形 %式，这样一来h=x*theta，与文中所述有所不同。 m=length(y); x=[ones(m,1),x]; n=2; theta=zeros(n,1); alpha=0.07; %开始单变量梯度下降循环，并实时显示J的变化 subplot(122); for step=1:800 %先计算h-y的值，h-y是一个m×1的向量 h_y=x*theta-y; %step2、3 计算梯度并更新θ的值，通过向量乘法实现样本的求和。 theta(1)=theta(1)-alpha/m*(h_y&#39;*x(:,1)); theta(2)=theta(2)-alpha/m*(h_y&#39;*x(:,2)); %计算并显示代价函数值 J=sum(h_y.^2)/m/2; if mod(step,10)==9 plot(step,log10(J),&#39;o&#39;); axis([0,800,-inf,inf]); ylabel(&#39;log(J)&#39;); xlabel(&#39;Step&#39;); hold on; drawnow; end end %显示最终的优化结果 subplot(121), tempx=linspace(2,8,100); tempy=theta(1)+tempx*theta(2); plot(tempx,tempy); %准备数据，画出代价函数曲面 Jval=zeros(100,100); theta0=linspace(-3,3,100); theta1=linspace(-1,1,100); for xs=1:length(theta0) for ys=1:length(theta1) theta=[theta0(xs);theta1(ys)]; h_y=x*theta-y; Jval(xs,ys)=sum(h_y.^2)/m/2; end end figure, surf(theta0,theta1,Jval&#39;); axis([-3,3,-1,1]); xlabel(&#39;\theta_0&#39;); ylabel(&#39;\theta_1&#39;) 程序的运行结果如下图所示，红色的直线为最终的优化结果。 五、结语 以上Matlab代码中用到的数据和代码文件可以在这里下载，提取码m806 　　这一章主要介绍了单变量线性回归算法的原理和实现过程，定义了相关的符号和函数。随着后续的学习我们会发现，本章所学习的算法过程也是其它监督学习算法的大致实现过程，即定义特征量和假设函数、推导代价函数和偏导数、应用梯度下降算法寻找最优参数。 　　下一章介绍多变量的线性回归算法的原理和实现方法。" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-20T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"文章目录 前言 一、符号定义 二、代价函数 三、梯度下降算法 四、Matlab算法实现 五、结语 前言 上一章我们学习了机器学习的应用领域、定义以及算法的分类，这一章来学习最简单的一个机器学习算法——单变量线性回归算法，它是一种监督学习的算法，而且输出值是连续变化的值，因此是一种“回归”算法。 一、符号定义 我们通过吴老师课堂上给出的练习题中的例子来学习单变量线性回归算法。 　　在进行监督学习算法的时候，我们首先要有一个训练集，这里的训练集就是人们统计的50名不同年龄的儿童和他们的身高，如下图所示。 　　　　 这里我们开发机器学习算法的目的就是找出身高与年龄的大致对应关系，从而可以预测特定年龄小孩的大致身高。 　　因此，这个训练集中，我们的输入值是年龄，输出值是身高。通常来讲，我们称输入变量为特征（feature），用 x x x表示，输出值定义为 y y y，这里的 x x x就是小孩的年龄了，因为只有这么一个输入变量，因此这个问题是一个单变量的问题，如果有多个输入变量的话可以用 x 1 , x 2 , x 3 ⋯ x_1,x_2,x_3\\cdots x1​,x2​,x3​⋯表示。我们用 m m m表示训练样本的数量，在本例中， m m m就是小孩的数量，也就是 m = 50 m=50 m=50。我们用符号（ x ( i ) x^{(i)} x(i)， y ( i ) y^{(i)} y(i)）表示第 i i i个小孩的年龄和身高， i = 1 , 2 , 3 ⋯ 50 i=1,2,3\\cdots50 i=1,2,3⋯50。 　　接下来，为了找出x和y之间的关系，我们把x和y画成散点图，如下所示 　　　　　　　 从数据点的分布可以看出，身高和年龄之间大致呈线性关系，因此假设身高与年龄之间的函数关系是一个线性函数。这个假设函数（hypothesis）我们将其命名为 h h h，即 y = h ( x ) y=h(x) y=h(x)，机器学习算法的目的就是找出 h ( x ) h(x) h(x)的具体表达式。在本例中，我们认为假设函数是一条直线，于是有 h ( x ) = θ 0 + θ 1 x h(x)=\\theta_{0}+\\theta_{1}x h(x)=θ0​+θ1​x，其中 θ 1 \\theta_{1} θ1​表示直线的斜率， θ 0 \\theta_{0} θ0​表示直线在 x x x轴上的截距。 　　这样，我们的研究目标就转化为寻找最优的 θ 0 \\theta_{0} θ0​和 θ 1 \\theta_{1} θ1​。等学习了后面的内容后，我们就会发现，监督学习算法的最终目的通常就是寻找最优的参数。 　　接下来，为了让我们的表达方法更具有普适性和简洁性，我们把变量都用向量的方式来表示。我们定义函数 h ( x ) h(x) h(x)的参数为向量 θ = \\mathbf{\\theta}= θ= [ θ 0 θ 1 ] \\left[\\begin{matrix}\\theta_{0}\\\\\\theta_{1}\\end{matrix}\\right] [θ0​θ1​​]，同时，我们将 x x x也写成向量的形式，为了让 x x x和 θ \\mathbf{\\theta} θ对应起来，我们给它增加一个常数1，变成： x = \\mathbf{x}= x= [ 1 x ] \\left[\\begin{matrix}1\\\\x\\end{matrix}\\right] [1x​]，由于只有一个输出量，因此 y y y的向量形式为 y = \\mathbf{y}= y= [ y ] \\left[\\begin{matrix}y\\end{matrix}\\right] [y​]。这样，我们样本集的输入值就可以写成一个 2 × m 2×m 2×m的矩阵： [ 1 1 ⋯ x ( 1 ) x ( 2 ) ⋯ ] \\left[\\begin{matrix}1&amp;amp;1&amp;amp;\\cdots\\\\x^{(1)}&amp;amp;x^{(2)}&amp;amp;\\cdots\\end{matrix}\\right] [1x(1)​1x(2)​⋯⋯​]，输出值就可以写成一个 1 × m 1×m 1×m的矩阵 [ y ( 1 ) y ( 2 ) ⋯ ] \\left[\\begin{matrix}y^{(1)}&amp;amp;y^{(2)}&amp;amp;\\cdots\\end{matrix}\\right] [y(1)​y(2)​⋯​]。这样一来我们的假设函数就可以用向量表示为 h = θ T × x h=\\mathbf{\\theta^{T}}\\times\\mathbf{x} h=θT×x，这里的 × \\times ×是矩阵的乘积，我们也可以省略这个乘号，写成 h = θ T x h=\\mathbf{\\theta^{T}}\\mathbf{x} h=θTx。这种表达方式对后面的多变量回归乃至逻辑回归都是适用的，同时也可以方便地转化为Matlab代码。因此，以后我们就用不带下标的字母 θ \\mathbf{\\theta} θ表示参数向量，用 θ 0 , θ 1 ⋯ \\theta_{0},\\theta_{1}\\cdots θ0​,θ1​⋯表示向量中的元素；用 x \\mathbf{x} x表示输入向量， x j x_j xj​表示第 j j j个输入变量， x j ( i ) x^{(i)}_j xj(i)​表示第 i i i个样本的第 j j j个输入变量；同样地， y \\mathbf{y} y表示输出向量， y j y_j yj​表示第 j j j个输出量， y j ( i ) y^{(i)}_j yj(i)​表示第 i i i个样本的第 j j j个输出量 　　至此，我们就完成了单变量线性回归的准备工作了，下面开始考虑如何寻找最优的参数 θ \\mathbf{\\theta} θ。 二、代价函数 为了寻找最优的参数 θ \\mathbf{\\theta} θ，我们首先要确定一个标准，即什么样的参数是“优”的。直观地理解，对于每一个样本，我们的函数值 h ( x ( i ) ) h(x^{(i)}) h(x(i))与实际的输出值 y ( i ) y^{(i)} y(i)符合得越好，我们认为对应的参数越“好”。我们可以使用方差 [ h ( x ( i ) ) − y ( i ) ] 2 [h(x^{(i)})-y^{(i)}]^{2} [h(x(i))−y(i)]2来定量地描述这两个值的符合程度，方差越大，说明这两个值的差异越大，方差为零时这两个值完全相同。 　　综合考虑所有的样本，我们可以用所有样本的方差之和 J = ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] 2 J=\\sum\\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}} J=i=1∑m​[h(x(i))−y(i)]2来表征函数 h h h与样本集整体的符合程度， J J J越小，符合程度越高，我们称函数 J J J为函数 h h h的代价函数。 　　从函数 J J J的定义可以看出它的大小只与参数 θ \\mathbf{\\theta} θ有关，即 J = J ( θ ) J=J(\\mathbf{\\theta}) J=J(θ)。这样一来，我们的目标就再一次转化为寻找使代价函数值 J J J最小的参数 θ \\mathbf{\\theta} θ。 三、梯度下降算法 那么，如何寻找 J J J最小时的参数 θ \\mathbf{\\theta} θ呢？这就要用到梯度下降算法了。 　　梯度下降算法的思想很简单， J ( θ 0 , θ 1 ) J(\\theta_{0},\\theta_{1}) J(θ0​,θ1​)实际上是一个关于 θ 0 和 θ 1 \\theta_{0}和\\theta_{1} θ0​和θ1​的二维曲面，每一对 ( θ 0 , θ 1 ) (\\theta_{0},\\theta_{1}) (θ0​,θ1​)都对应于曲面上的一个点，如下图所示： 　　　　 我们先任意初始化一个 θ \\mathbf{\\theta} θ值，然后找出该点处 J J J下降最快的方向，将 θ \\mathbf{\\theta} θ向这个方向移动一小步，然后再重新寻找 J J J下降最快的方向，再向新的方向移动一小步，如此循环，直到 J J J达到最小值，这个过程中 θ \\mathbf{\\theta} θ的移动路径如上图中黑色四芒星所示。 　　而函数 J J J下降最快的方向其实就是函数 J ( θ 0 , θ 1 ) J(\\theta_{0},\\theta_{1}) J(θ0​,θ1​)的梯度的反方向。根据梯度的定义，函数 J J J的梯度为 ∇ J = ∂ J ∂ θ 0 θ 0 → + ∂ J ∂ θ 1 θ 1 → \\nabla{J}=\\frac{\\partial{J}}{\\partial{\\theta_{0}}}\\overrightarrow{\\theta_{0}}+\\frac{\\partial{J}}{\\partial{\\theta_{1}}}\\overrightarrow{\\theta_{1}} ∇J=∂θ0​∂J​θ0​ ​+∂θ1​∂J​θ1​ ​，其中， θ 0 → \\overrightarrow{\\theta_{0}} θ0​ ​和 θ 1 → \\overrightarrow{\\theta_{1}} θ1​ ​分别代表沿 θ 0 \\theta_{0} θ0​和 θ 1 \\theta_{1} θ1​正方向的单位向量，为了使 θ \\mathbf{\\theta} θ往 J J J下降最快的方向移动，应该使 θ 0 \\theta_{0} θ0​和 θ 1 \\theta_{1} θ1​分别减去 α ∗ ∂ J ∂ θ 0 \\alpha*\\frac{\\partial{J}}{\\partial{\\theta_{0}}} α∗∂θ0​∂J​和 α ∗ ∂ J ∂ θ 1 \\alpha*\\frac{\\partial{J}}{\\partial{\\theta_{1}}} α∗∂θ1​∂J​，其中 α \\alpha α(&gt;0)代表移动的步长。于是，梯度下降算法的计算过程如下所示： 　　Step1、初始化 θ \\mathbf{\\theta} θ：例如令 θ 0 = θ 1 = 0 \\theta_{0}=\\theta_{1}=0 θ0​=θ1​=0; 　　Step2、计算当前 θ \\mathbf{\\theta} θ值对应的 J J J的梯度值： ∂ J ∂ θ 0 \\frac{\\partial{J}}{\\partial{\\theta_{0}}} ∂θ0​∂J​, ∂ J ∂ θ 1 \\frac{\\partial{J}}{\\partial{\\theta_{1}}} ∂θ1​∂J​； 　　Step3、更新 θ \\mathbf{\\theta} θ： θ 0 : = θ 0 − α ∗ ∂ J ∂ θ 0 \\theta_{0}:=\\theta_{0}-\\alpha*\\frac{\\partial{J}}{\\partial{\\theta_{0}}} θ0​:=θ0​−α∗∂θ0​∂J​； θ 1 : = θ 1 − α ∗ ∂ J ∂ θ 1 \\theta_{1}:=\\theta_{1}-\\alpha*\\frac{\\partial{J}}{\\partial{\\theta_{1}}} θ1​:=θ1​−α∗∂θ1​∂J​; 　　Step4、判断是否结束循环，若为否则回到Step2。 　　从以上过程可以看出，每一步的移动步长是由该点处 J J J的梯度大小和 α \\alpha α共同决定的。在 α \\alpha α大小不变的情况下，当 J J J离最小值较远时，对应的梯度值较大， θ \\mathbf{\\theta} θ移动的较快； J J J越接近最小值， θ \\mathbf{\\theta} θ移动步长越小，最终逐渐收敛到 J J J最小处。 　　而第二步中偏导数 ∂ J ∂ θ 0 \\frac{\\partial{J}}{\\partial{\\theta_{0}}} ∂θ0​∂J​, ∂ J ∂ θ 1 \\frac{\\partial{J}}{\\partial{\\theta_{1}}} ∂θ1​∂J​的值可以将 h ( x ) = θ 0 + θ 1 x h(x)=\\theta_{0}+\\theta_{1}x h(x)=θ0​+θ1​x代入 J = ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] 2 J=\\sum\\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}} J=i=1∑m​[h(x(i))−y(i)]2中计算得出。根据偏导数的运算规则，可以得出： ∂ J ∂ θ 0 = 2 ∑ i = 1 m [ h ( x ( i ) ) − y ( i ) ] \\frac{\\partial{J}}{\\partial{\\theta_{0}}}=2\\sum\\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]} ∂θ0​∂J​=2i=1∑m​[h(x(i))−y(i)]； ∂ J ∂ θ 1 = 2 ∑ i = 1 m x ( i ) [ h ( x ( i ) ) − y ( i ) ] \\frac{\\partial{J}}{\\partial{\\theta_{1}}}=2\\sum\\limits_{i=1}^m{x^{(i)}[h(x^{(i)})-y^{(i)}]} ∂θ1​∂J​=2i=1∑m​x(i)[h(x(i))−y(i)]，实际执行时，会在前面乘上一个系数 1 2 m \\frac{1}{2m} 2m1​,并不会影响最终的优化结果。 四、Matlab算法实现 接下来，用Matlab来实现以上过程，代码如下： %导入训练集； x=load(&#39;ex2x.dat&#39;); y=load(&#39;ex2y.dat&#39;); %画出训练集的散点图 figure, subplot(121), plot(x,y,&#39;o&#39;); ylabel(&#39;Height in meters&#39;); xlabel(&#39;Age in years&#39;); hold on; %step1、初始化相关参数，注意：这里我们将x和y写成了m*2和m*1的向量形 %式，这样一来h=x*theta，与文中所述有所不同。 m=length(y); x=[ones(m,1),x]; n=2; theta=zeros(n,1); alpha=0.07; %开始单变量梯度下降循环，并实时显示J的变化 subplot(122); for step=1:800 %先计算h-y的值，h-y是一个m×1的向量 h_y=x*theta-y; %step2、3 计算梯度并更新θ的值，通过向量乘法实现样本的求和。 theta(1)=theta(1)-alpha/m*(h_y&#39;*x(:,1)); theta(2)=theta(2)-alpha/m*(h_y&#39;*x(:,2)); %计算并显示代价函数值 J=sum(h_y.^2)/m/2; if mod(step,10)==9 plot(step,log10(J),&#39;o&#39;); axis([0,800,-inf,inf]); ylabel(&#39;log(J)&#39;); xlabel(&#39;Step&#39;); hold on; drawnow; end end %显示最终的优化结果 subplot(121), tempx=linspace(2,8,100); tempy=theta(1)+tempx*theta(2); plot(tempx,tempy); %准备数据，画出代价函数曲面 Jval=zeros(100,100); theta0=linspace(-3,3,100); theta1=linspace(-1,1,100); for xs=1:length(theta0) for ys=1:length(theta1) theta=[theta0(xs);theta1(ys)]; h_y=x*theta-y; Jval(xs,ys)=sum(h_y.^2)/m/2; end end figure, surf(theta0,theta1,Jval&#39;); axis([-3,3,-1,1]); xlabel(&#39;\\theta_0&#39;); ylabel(&#39;\\theta_1&#39;) 程序的运行结果如下图所示，红色的直线为最终的优化结果。 五、结语 以上Matlab代码中用到的数据和代码文件可以在这里下载，提取码m806 　　这一章主要介绍了单变量线性回归算法的原理和实现过程，定义了相关的符号和函数。随着后续的学习我们会发现，本章所学习的算法过程也是其它监督学习算法的大致实现过程，即定义特征量和假设函数、推导代价函数和偏导数、应用梯度下降算法寻找最优参数。 　　下一章介绍多变量的线性回归算法的原理和实现方法。","@type":"BlogPosting","url":"/2019/02/20/636b742c40f5a0d96e0e83bdd5c66462.html","headline":"吴恩达机器学习笔记（二）——单变量线性回归","dateModified":"2019-02-20T00:00:00+08:00","datePublished":"2019-02-20T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/02/20/636b742c40f5a0d96e0e83bdd5c66462.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>吴恩达机器学习笔记（二）——单变量线性回归</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div id="content_views" class="markdown_views prism-atom-one-light"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p></p>
  <div class="toc">
   <h3>文章目录</h3>
   <ul>
    <ul>
     <li><a href="#_2" rel="nofollow">前言</a></li>
     <li><a href="#_5" rel="nofollow">一、符号定义</a></li>
     <li><a href="#_17" rel="nofollow">二、代价函数</a></li>
     <li><a href="#_22" rel="nofollow">三、梯度下降算法</a></li>
     <li><a href="#Matlab_36" rel="nofollow">四、Matlab算法实现</a></li>
     <li><a href="#_105" rel="nofollow">五、结语</a></li>
    </ul>
   </ul>
  </div>
  <p></p> 
  <h2><a id="_2"></a>前言</h2> 
  <p><a href="https://blog.csdn.net/weixin_43008870/article/details/87627559" rel="nofollow">上一章</a>我们学习了机器学习的应用领域、定义以及算法的分类，这一章来学习最简单的一个机器学习算法——单变量线性回归算法，它是一种监督学习的算法，而且输出值是连续变化的值，因此是一种“回归”算法。</p> 
  <h2><a id="_5"></a>一、符号定义</h2> 
  <p>我们通过吴老师课堂上给出的练习题中的例子来学习单变量线性回归算法。<br> 　　在进行监督学习算法的时候，我们首先要有一个训练集，这里的训练集就是人们统计的50名不同年龄的儿童和他们的身高，如下图所示。<br> 　　　　<img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190220162944976.PNG" width="50%"><br> 这里我们开发机器学习算法的目的就是找出身高与年龄的大致对应关系，从而可以预测特定年龄小孩的大致身高。<br> 　　因此，这个训练集中，我们的输入值是年龄，输出值是身高。通常来讲，我们称输入变量为特征（feature），用<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>表示，输出值定义为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>，这里的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>就是小孩的年龄了，因为只有这么一个输入变量，因此这个问题是一个单变量的问题，如果有多个输入变量的话可以用<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           3
          </mn>
         </msub>
         <mo>
          ⋯
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         x_1,x_2,x_3\cdots
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span></span></span></span></span>表示。我们用<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>表示训练样本的数量，在本例中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>就是小孩的数量，也就是<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
         <mo>
          =
         </mo>
         <mn>
          50
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         m=50
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span><span class="mord">0</span></span></span></span></span>。我们用符号（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           x
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         x^{(i)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           y
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         y^{(i)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>）表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span>个小孩的年龄和身高，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          2
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          3
         </mn>
         <mo>
          ⋯
         </mo>
         <mn>
          50
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         i=1,2,3\cdots50
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">3</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">5</span><span class="mord">0</span></span></span></span></span>。<br> 　　接下来，为了找出x和y之间的关系，我们把x和y画成散点图，如下所示<br> 　　　　　　　<img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190220164112658.PNG" width="50%"><br> 从数据点的分布可以看出，身高和年龄之间大致呈线性关系，因此假设身高与年龄之间的函数关系是一个线性函数。这个<strong>假设函数</strong>（hypothesis）我们将其命名为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span></span></span></span></span>，即<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
         <mo>
          =
         </mo>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         y=h(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>，机器学习算法的目的就是找出<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         h(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>的具体表达式。在本例中，我们认为假设函数是一条直线，于是有<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h(x)=\theta_{0}+\theta_{1}x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit">x</span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示直线的斜率，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示直线在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>轴上的截距。<br> 　　这样，我们的研究目标就转化为寻找最优的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。等学习了后面的内容后，我们就会发现，监督学习算法的最终目的通常就是寻找最优的参数。<br> 　　接下来，为了让我们的表达方法更具有普适性和简洁性，我们把变量都用向量的方式来表示。我们定义函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         h(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>的参数为向量<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
         <mo>
          =
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}=
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          [
         </mo>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <msub>
              <mi>
               θ
              </mi>
              <mn>
               0
              </mn>
             </msub>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <msub>
              <mi>
               θ
              </mi>
              <mn>
               1
              </mn>
             </msub>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <mo fence="true">
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left[\begin{matrix}\theta_{0}\\\theta_{1}\end{matrix}\right]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>，同时，我们将<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>也写成向量的形式，为了让<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>对应起来，我们给它增加一个常数1，变成：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold">
          x
         </mi>
         <mo>
          =
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}=
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.44444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          [
         </mo>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mn>
              1
             </mn>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mi>
              x
             </mi>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <mo fence="true">
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left[\begin{matrix}1\\x\end{matrix}\right]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.40003em; vertical-align: -0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.45em;"><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.95em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>，由于只有一个输出量，因此<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>的向量形式为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold">
          y
         </mi>
         <mo>
          =
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{y}=
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">y</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          [
         </mo>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mi>
              y
             </mi>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <mo fence="true">
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left[\begin{matrix}y\end{matrix}\right]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.20001em; vertical-align: -0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.85em;"><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span>。这样，我们样本集的输入值就可以写成一个<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          2
         </mn>
         <mo>
          ×
         </mo>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         2×m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>的矩阵：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          [
         </mo>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mn>
              1
             </mn>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mn>
              1
             </mn>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mo>
              ⋯
             </mo>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <msup>
              <mi>
               x
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <msup>
              <mi>
               x
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mo>
              ⋯
             </mo>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <mo fence="true">
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left[\begin{matrix}1&amp;amp;1&amp;amp;\cdots\\x^{(1)}&amp;amp;x^{(2)}&amp;amp;\cdots\end{matrix}\right]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.448em; vertical-align: -0.974em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.474em;"><span class="" style="top: -3.634em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.386em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.974em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.474em;"><span class="" style="top: -3.634em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span><span class="" style="top: -2.386em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.974em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.474em;"><span class="" style="top: -3.634em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span class="" style="top: -2.386em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.974em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>，输出值就可以写成一个<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mn>
          1
         </mn>
         <mo>
          ×
         </mo>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         1×m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>的矩阵<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo fence="true">
          [
         </mo>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <msup>
              <mi>
               y
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <msup>
              <mi>
               y
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mo>
              ⋯
             </mo>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <mo fence="true">
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \left[\begin{matrix}y^{(1)}&amp;amp;y^{(2)}&amp;amp;\cdots\end{matrix}\right]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.248em; vertical-align: -0.374em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874em;"><span class="" style="top: -2.986em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.374em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874em;"><span class="" style="top: -2.986em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.374em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.874em;"><span class="" style="top: -2.986em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.374em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span>。这样一来我们的假设函数就可以用向量表示为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          =
         </mo>
         <msup>
          <mi>
           θ
          </mi>
          <mi mathvariant="bold">
           T
          </mi>
         </msup>
         <mo>
          ×
         </mo>
         <mi mathvariant="bold">
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h=\mathbf{\theta^{T}}\times\mathbf{x}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.926607em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.843277em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.44444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span>，这里的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          ×
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \times
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">×</span></span></span></span></span>是矩阵的乘积，我们也可以省略这个乘号，写成<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          =
         </mo>
         <msup>
          <mi>
           θ
          </mi>
          <mi mathvariant="bold">
           T
          </mi>
         </msup>
         <mi mathvariant="bold">
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h=\mathbf{\theta^{T}}\mathbf{x}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.843277em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.843277em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span>。这种表达方式对后面的多变量回归乃至逻辑回归都是适用的，同时也可以方便地转化为Matlab代码。因此，以后我们就用不带下标的字母<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>表示参数向量，用<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          ⋯
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0},\theta_{1}\cdots
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span></span></span></span></span>表示向量中的元素；用<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold">
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{x}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.44444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span>表示输入向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个输入变量，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           x
          </mi>
          <mi>
           j
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         x^{(i)}_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.45777em; vertical-align: -0.412972em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span>个样本的第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个输入变量；同样地，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="bold">
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{y}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.01597em;">y</span></span></span></span></span></span>表示输出向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           y
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         y_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个输出量，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mi>
           y
          </mi>
          <mi>
           j
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation encoding="application/x-tex">
         y^{(i)}_j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.45777em; vertical-align: -0.412972em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span>个样本的第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span>个输出量<br> 　　至此，我们就完成了单变量线性回归的准备工作了，下面开始考虑如何寻找最优的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>。</p> 
  <h2><a id="_17"></a>二、代价函数</h2> 
  <p>为了寻找最优的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>，我们首先要确定一个标准，即什么样的参数是“优”的。直观地理解，对于每一个样本，我们的函数值<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <msup>
          <mi>
           x
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         h(x^{(i)})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>与实际的输出值<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           y
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         y^{(i)}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>符合得越好，我们认为对应的参数越“好”。我们可以使用方差<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          [
         </mo>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <msup>
          <mi>
           x
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
         <mo>
          )
         </mo>
         <mo>
          −
         </mo>
         <msup>
          <mi>
           y
          </mi>
          <mrow>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
          </mrow>
         </msup>
         <msup>
          <mo>
           ]
          </mo>
          <mn>
           2
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         [h(x^{(i)})-y^{(i)}]^{2}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>来定量地描述这两个值的符合程度，方差越大，说明这两个值的差异越大，方差为零时这两个值完全相同。<br> 　　综合考虑所有的样本，我们可以用所有样本的方差之和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
         <mo>
          =
         </mo>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           m
          </mi>
         </msubsup>
         <mrow>
          <mo>
           [
          </mo>
          <mi>
           h
          </mi>
          <mo>
           (
          </mo>
          <msup>
           <mi>
            x
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <msup>
           <mi>
            y
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <msup>
           <mo>
            ]
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         J=\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32907em; vertical-align: -0.977669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.12233em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.00001em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.977669em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span>来表征函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span></span></span></span></span>与样本集整体的符合程度，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>越小，符合程度越高，我们称函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>为函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span></span></span></span></span>的<strong>代价函数</strong>。<br> 　　从函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>的定义可以看出它的大小只与参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>有关，即<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
         <mo>
          =
         </mo>
         <mi>
          J
         </mi>
         <mo>
          (
         </mo>
         <mi>
          θ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         J=J(\mathbf{\theta})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span><span class="mclose">)</span></span></span></span></span>。这样一来，我们的目标就再一次转化为寻找使代价函数值<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>最小的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>。</p> 
  <h2><a id="_22"></a>三、梯度下降算法</h2> 
  <p>那么，如何寻找<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>最小时的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>呢？这就要用到梯度下降算法了。<br> 　　梯度下降算法的思想很简单，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         J(\theta_{0},\theta_{1})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>实际上是一个关于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mi mathvariant="normal">
          和
         </mi>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}和\theta_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的二维曲面，每一对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         (\theta_{0},\theta_{1})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>都对应于曲面上的一个点，如下图所示：<br> 　　　　<img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190220201548572.PNG" width="60%" alt=""><br> 我们先任意初始化一个<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>值，然后找出该点处<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>下降最快的方向，将<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>向这个方向移动一小步，然后再重新寻找<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>下降最快的方向，再向新的方向移动一小步，如此循环，直到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>达到最小值，这个过程中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>的移动路径如上图中黑色四芒星所示。<br> 　　而函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>下降最快的方向其实就是函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         J(\theta_{0},\theta_{1})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>的梯度的反方向。根据梯度的定义，函数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>的梯度为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi mathvariant="normal">
          ∇
         </mi>
         <mi>
          J
         </mi>
         <mo>
          =
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
         </mfrac>
         <mover accent="true">
          <msub>
           <mi>
            θ
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo stretchy="true">
           →
          </mo>
         </mover>
         <mo>
          +
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </mfrac>
         <mover accent="true">
          <msub>
           <mi>
            θ
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo stretchy="true">
           →
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \nabla{J}=\frac{\partial{J}}{\partial{\theta_{0}}}\overrightarrow{\theta_{0}}+\frac{\partial{J}}{\partial{\theta_{1}}}\overrightarrow{\theta_{1}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">∇</span><span class="mord"><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.66154em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.21644em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="svg-align" style="top: -3.69444em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="height: 0.522em; min-width: 0.888em;">
             <svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice">
              <path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path>
             </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.66154em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.21644em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="svg-align" style="top: -3.69444em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="height: 0.522em; min-width: 0.888em;">
             <svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice">
              <path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path>
             </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span>，其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <msub>
           <mi>
            θ
           </mi>
           <mn>
            0
           </mn>
          </msub>
          <mo stretchy="true">
           →
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \overrightarrow{\theta_{0}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.36644em; vertical-align: -0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.21644em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="svg-align" style="top: -3.69444em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="height: 0.522em; min-width: 0.888em;">
             <svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice">
              <path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path>
             </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <msub>
           <mi>
            θ
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo stretchy="true">
           →
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \overrightarrow{\theta_{1}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.36644em; vertical-align: -0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.21644em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="svg-align" style="top: -3.69444em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="height: 0.522em; min-width: 0.888em;">
             <svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice">
              <path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path>
             </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span>分别代表沿<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>正方向的单位向量，为了使<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>往<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>下降最快的方向移动，应该使<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别减去<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
         <mo>
          ∗
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha*\frac{\partial{J}}{\partial{\theta_{0}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
         <mo>
          ∗
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha*\frac{\partial{J}}{\partial{\theta_{1}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>(&gt;0)代表移动的步长。于是，梯度下降算法的计算过程如下所示：<br> 　　Step1、初始化<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>：例如令<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          0
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}=\theta_{1}=0
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>;<br> 　　Step2、计算当前<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>值对应的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>的梯度值：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial{J}}{\partial{\theta_{0}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial{J}}{\partial{\theta_{1}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>；<br> 　　Step3、更新<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          :
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          −
         </mo>
         <mi>
          α
         </mi>
         <mo>
          ∗
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{0}:=\theta_{0}-\alpha*\frac{\partial{J}}{\partial{\theta_{0}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>；<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          :
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          −
         </mo>
         <mi>
          α
         </mi>
         <mo>
          ∗
         </mo>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta_{1}:=\theta_{1}-\alpha*\frac{\partial{J}}{\partial{\theta_{1}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>;<br> 　　Step4、判断是否结束循环，若为否则回到Step2。<br> 　　从以上过程可以看出，每一步的移动步长是由该点处<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>的梯度大小和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>共同决定的。在<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>大小不变的情况下，当<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>离最小值较远时，对应的梯度值较大，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>移动的较快；<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>越接近最小值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \mathbf{\theta}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span></span>移动步长越小，最终逐渐收敛到<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         J
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span></span></span></span></span>最小处。<br> 　　而第二步中偏导数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial{J}}{\partial{\theta_{0}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial{J}}{\partial{\theta_{1}}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>的值可以将<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           0
          </mn>
         </msub>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           θ
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         h(x)=\theta_{0}+\theta_{1}x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit">x</span></span></span></span></span>代入<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          J
         </mi>
         <mo>
          =
         </mo>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           m
          </mi>
         </msubsup>
         <mrow>
          <mo>
           [
          </mo>
          <mi>
           h
          </mi>
          <mo>
           (
          </mo>
          <msup>
           <mi>
            x
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <msup>
           <mi>
            y
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <msup>
           <mo>
            ]
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         J=\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]^{2}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32907em; vertical-align: -0.977669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.12233em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.00001em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.977669em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span>中计算得出。根据偏导数的运算规则，可以得出：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             0
            </mn>
           </msub>
          </mrow>
         </mfrac>
         <mo>
          =
         </mo>
         <mn>
          2
         </mn>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           m
          </mi>
         </msubsup>
         <mrow>
          <mo>
           [
          </mo>
          <mi>
           h
          </mi>
          <mo>
           (
          </mo>
          <msup>
           <mi>
            x
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <msup>
           <mi>
            y
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           ]
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial{J}}{\partial{\theta_{0}}}=2\sum\limits_{i=1}^m{[h(x^{(i)})-y^{(i)}]}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32907em; vertical-align: -0.977669em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.12233em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.00001em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.977669em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></span>；<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <mi>
            J
           </mi>
          </mrow>
          <mrow>
           <mi mathvariant="normal">
            ∂
           </mi>
           <msub>
            <mi>
             θ
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </mfrac>
         <mo>
          =
         </mo>
         <mn>
          2
         </mn>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           m
          </mi>
         </msubsup>
         <mrow>
          <msup>
           <mi>
            x
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           [
          </mo>
          <mi>
           h
          </mi>
          <mo>
           (
          </mo>
          <msup>
           <mi>
            x
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <msup>
           <mi>
            y
           </mi>
           <mrow>
            <mo>
             (
            </mo>
            <mi>
             i
            </mi>
            <mo>
             )
            </mo>
           </mrow>
          </msup>
          <mo>
           ]
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{\partial{J}}{\partial{\theta_{1}}}=2\sum\limits_{i=1}^m{x^{(i)}[h(x^{(i)})-y^{(i)}]}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.32521em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.09618em;">J</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32907em; vertical-align: -0.977669em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.12233em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.00001em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.977669em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></span>，实际执行时，会在前面乘上一个系数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mfrac>
          <mn>
           1
          </mn>
          <mrow>
           <mn>
            2
           </mn>
           <mi>
            m
           </mi>
          </mrow>
         </mfrac>
        </mrow>
        <annotation encoding="application/x-tex">
         \frac{1}{2m}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathit mtight">m</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>,并不会影响最终的优化结果。</p> 
  <h2><a id="Matlab_36"></a>四、Matlab算法实现</h2> 
  <p>接下来，用Matlab来实现以上过程，代码如下：</p> 
  <pre><code>%导入训练集；
x=load('ex2x.dat');
y=load('ex2y.dat');

%画出训练集的散点图
figure,
subplot(121),
plot(x,y,'o');
ylabel('Height in meters');
xlabel('Age in years');
hold on;

%step1、初始化相关参数，注意：这里我们将x和y写成了m*2和m*1的向量形
%式，这样一来h=x*theta，与文中所述有所不同。
m=length(y);
x=[ones(m,1),x];
n=2;
theta=zeros(n,1);
alpha=0.07;

%开始单变量梯度下降循环，并实时显示J的变化
subplot(122);
for step=1:800
    %先计算h-y的值，h-y是一个m×1的向量
    h_y=x*theta-y;
    %step2、3 计算梯度并更新θ的值，通过向量乘法实现样本的求和。
    theta(1)=theta(1)-alpha/m*(h_y'*x(:,1));
    theta(2)=theta(2)-alpha/m*(h_y'*x(:,2)); 
    %计算并显示代价函数值
    J=sum(h_y.^2)/m/2;
    if mod(step,10)==9
        plot(step,log10(J),'o');
        axis([0,800,-inf,inf]);
        ylabel('log(J)');
        xlabel('Step');
        hold on;
        drawnow;
    end   
end

%显示最终的优化结果 
subplot(121),
tempx=linspace(2,8,100);
tempy=theta(1)+tempx*theta(2);
plot(tempx,tempy);

%准备数据，画出代价函数曲面
Jval=zeros(100,100);
theta0=linspace(-3,3,100);
theta1=linspace(-1,1,100);
for xs=1:length(theta0)
    for ys=1:length(theta1)
        theta=[theta0(xs);theta1(ys)];
        h_y=x*theta-y;
        Jval(xs,ys)=sum(h_y.^2)/m/2;
    end
end
figure,
surf(theta0,theta1,Jval');
axis([-3,3,-1,1]);
xlabel('\theta_0'); ylabel('\theta_1')
</code></pre> 
  <p>程序的运行结果如下图所示，红色的直线为最终的优化结果。<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190221095126284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzAwODg3MA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190221091158398.png" width="60%"></p> 
  <h2><a id="_105"></a>五、结语</h2> 
  <p>以上Matlab代码中用到的数据和代码文件可以在<a href="https://pan.baidu.com/s/1leW43g9XDYGRTBX2_iHogQ" rel="nofollow">这里</a>下载，提取码m806<br> 　　这一章主要介绍了单变量线性回归算法的原理和实现过程，定义了相关的符号和函数。随着后续的学习我们会发现，本章所学习的算法过程也是其它监督学习算法的大致实现过程，即定义特征量和假设函数、推导代价函数和偏导数、应用梯度下降算法寻找最优参数。<br> 　　<a href="https://blog.csdn.net/weixin_43008870/article/details/87860706" rel="nofollow">下一章</a>介绍多变量的线性回归算法的原理和实现方法。</p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
