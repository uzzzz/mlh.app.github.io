<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>山东大学机器学习（实验七解读）—— PCA | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="山东大学机器学习（实验七解读）—— PCA" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：欢迎转载和交流。 https://blog.csdn.net/Hachi_Lin/article/details/87884957 1. 一对多SVM分类器 对于多分类来说，一对多的SVM分类器思想是给定一类标上正标签，其余剩下的类标上负标签，对应的将训练40次。我们用细胞元组来将训练数据和测试数据存储起来。 divdata.m函数负责将数据重新分配，即按上述我所说的 function data = divdata(index,X,n) len = size(X,1); if index == 1 data = [[X(1:n,:),ones(n,1)];[X(n+1:len,:),-ones(len-n,1)]]; elseif index == 80 data = [[X(1:len-n,:),-ones(len-n,1)];[X(len-n+1:len,:),ones(n,1)]]; else data = [[X(1:n*(index-1),:),-ones(n*(index-1),1)];[X(n*index-n+1:n*index,:),ones(n,1)];[X(n*index+1:len,:),-ones(len-n*index,1)]]; end end svmTrain.m是训练函数(这是实验五中的函数) function svm = svmTrain(X,Y,C) % Options是用来控制算法的选项参数的向量，optimset无参时， % 创建一个选项结构所有字段为默认值的选项 options = optimset; options.largeScale = &#39;off&#39;; %LargeScale指大规模搜索，off表示在规模搜索模式关闭 options.Display = &#39;off&#39;; %表示无输出 %二次规划用来求解问题，使用quadprog n = length(Y); %使用线性核 H = (Y.*X)*(Y.*X)&#39;; H=(H+H&#39;)/2; f = -ones(n,1); %f&#39;为1*n个-1 A = []; b = []; Aeq = Y&#39;; beq = 0; lb = zeros(n,1); ub = C*ones(n,1); a0 = zeros(n,1); % a0是解的初始近似值 a = quadprog(H,f,A,b,Aeq,beq,lb,ub,a0,options); epsilon = 1e-9; sv_label = find(abs(a)&gt; epsilon); svm.sva = a(sv_label); svm.Xsv = X(sv_label,:); svm.Ysv = Y(sv_label); svm.svnum = length(sv_label); svm.a = a; end test1.m主函数 %从人脸照片中随选择7张作为训练集 train_data = zeros(40*7,112*92); test_data = zeros(40*3,112*92); for i = 1:40 file_name = [&#39;s&#39;,num2str(i)]; %随机选取同一文件夹下的7个图片 index = randperm(10); for j = 1:7 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(j)),&#39;.pgm&#39;]; image = double(imread(name)); %将矩阵展开为一行 train_data(7*(i-1)+j,:) = reshape(image,1,112*92); end for j = 1:3 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(7+j)),&#39;.pgm&#39;]; image = double(imread(name)); test_data(3*(i-1)+j,:) = reshape(image,1,112*92); end end %================PCA算法开始================ %(一)Step one: 中心化数据 numData = [train_data;test_data]; X = numData - repmat(mean(numData),40*10,1); %(二)Step two: 求中心化数据的协方差矩阵 C = X&#39;*X/size(X,1); %(三)Step three: 计算特征向量和特征值 [V,D] = eig(C); %(四)Step four: 将特征值和特征向量按降序排序 [dummy,order] = sort(diag(-D)); d=diag(D); %将特征值取出，构成一个列向量 E=V(:,order); %将特征向量按照特征值大小进行降序排列 newd=d(order); %将特征值构成的列向量按降序排列 %(五)Step five: 取前k行组成矩阵P,构成变换矩阵 %选取5个特征贡献率值来当作测试对象 Crate = [0.75 0.80 0.85 0.90 0.95]; sumd = sum(newd); for ii = 1:length(Crate) k = 0; for j = 1:length(newd) i = sum(newd(1:j,1),1)/sumd; %计算贡献率=前k个特征值之和/总特征值之和 if i &gt; Crate(ii) %当贡献率大于95%时循环结束,并记下取多少个特征值 k = j; break; end end P = E(:,1:k); newX = X*P; %================SVM 实现多分类================ %================一对多SVM分类器=============== %(一)Step one: 重新分配数据 train_X = newX(1:280,:); test_X = newX(281:400,:); num = 40; data1 = cell(num,1); data2 = cell(num,1); for i = 1:num data1{i,1} = divdata(i,train_X,7); data2{i,1} = divdata(i,test_X,3); end %(二)Step two: 训练数据 a = zeros(num,size(train_X,1)); w = zeros(num,size(train_X,2)); b = zeros(num,1); for i = 1:num svm = svmTrain(data1{i,1}(:,1:k),data1{i,1}(:,k+1),1); a(i,:) = svm.a&#39;; for j = 1:size(train_X,2) w(i,j) = sum(a(i,:)&#39;.*data1{i,1}(:,k+1).*data1{i,1}(:,j)); end b(i,1) = sum(svm.Ysv-svm.Xsv*w(i,:)&#39;)/svm.svnum; end %(三)Step three: 测试数据 labels_num = zeros(size(test_X,1),num); for i = 1:num labels_num(:,i) = (test_X*w(i,:)&#39;)&#39;+b(i,1); end %(四)Step four: 得出分类结果 labels = zeros(size(test_X,1),1); for i = 1:size(test_X,1) [~,index] = max(labels_num(i,:)); labels(i,1) = index; end %(五)Step five： 分析分类结果 compare = zeros(size(test_X,1),1); for i = 1:num compare((i-1)*3+1:(i-1)*3+3,1) = i; end success_num = length(find(compare==labels)); success_rate = success_num/size(test_X,1); %打印分类正确率情况 fprintf(&#39;==========one-to-all==========\n&#39;); fprintf(&#39; k = %d\n&#39;,k); fprintf(&#39; Crate:%f\n test_data_num: %d\n&#39;,Crate(ii),size(test_X,1)); fprintf(&#39; success_num: %f\n success_rate: %f\n&#39;,success_num,success_rate); end   test1.m中的特征贡献率是决定最终维数的标准，因为在对矩阵求解特征值和特征向量时，有些特征值太小了，我们可以不考虑它们，因此可以用特征贡献率来决定我们选取的特征数，也即维数。   对于如何知道测试集某一数据是属于哪一类是这样判断的，因为40组数据在SVM训练器上得到的 ω \omega ω和 b b b是不一样的，因此对应的 ω T x + b \omega^Tx+b ωTx+b的值不同，若这个值是小于0的则不考虑，若这个值是大于0的，我们要找出这40组 ω \omega ω和 b b b中使得该值最大的 ω \omega ω和 b b b，其对应的训练集的正标签即为该 ω T x + b \omega^Tx+b ωTx+b最大嘛。 测试结果 测试数据集总数为120组。 特征贡献率 维数 正确组数 正确率 0.75 30 75 0.6250 0.80 44 66 0.5500 0.85 68 74 0.6167 0.90 111 80 0.6667 0.95 190 81 0.6750 2. 一对一SVM分类器 采用一对一的SVM的思想是对于40个类，我们任意选出两个类作为二分类的SVM训练集，将选定的两个类分别标上正标签和负标签，使用实验五的svmTrain训练训练集，这时我们将训练40×(40-1)/2 = 780次。 test2.m主函数，这个函数还用到了上述的svmTrain.m %从人脸照片中随选择7张作为训练集 train_data = zeros(40*7,112*92); test_data = zeros(40*3,112*92); for i = 1:40 file_name = [&#39;s&#39;,num2str(i)]; %随机选取同一文件夹下的7个图片 index = randperm(10); for j = 1:7 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(j)),&#39;.pgm&#39;]; image = double(imread(name)); %将矩阵展开为一行 train_data(7*(i-1)+j,:) = reshape(image,1,112*92); end for j = 1:3 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(7+j)),&#39;.pgm&#39;]; image = double(imread(name)); test_data(3*(i-1)+j,:) = reshape(image,1,112*92); end end %================PCA算法开始================ %(一)Step one: 中心化数据 numData = [train_data;test_data]; X = numData - repmat(mean(numData),40*10,1); %(二)Step two: 求中心化数据的协方差矩阵 C = X&#39;*X/size(X,1); %(三)Step three: 计算特征向量和特征值 [V,D] = eig(C); %(四)Step four: 将特征值和特征向量按降序排序 [dummy,order] = sort(diag(-D)); d=diag(D); %将特征值取出，构成一个列向量 E=V(:,order); %将特征向量按照特征值大小进行降序排列 newd=d(order); %将特征值构成的列向量按降序排列 %(五)Step five: 取前k行组成矩阵P,构成变换矩阵 %选取5个特征贡献率值来当作测试对象 Crate = [0.75 0.80 0.85 0.90 0.95]; sumd = sum(newd); for ii = 1:length(Crate) k = 0; for j = 1:length(newd) i = sum(newd(1:j,1),1)/sumd; %计算贡献率=前k个特征值之和/总特征值之和 if i &gt; Crate(ii) %当贡献率大于95%时循环结束,并记下取多少个特征值 k = j; break; end end P = E(:,1:k); newX = X*P; %================SVM 实现多分类================ %这里采用一对一方法 %(一)Step one: 重新分配数据 train_X = newX(1:280,:); test_X = newX(281:400,:); num = 40*(40-1)/2; data1 = cell(num,1); data2 = cell(num,1); index = 1; two_labels = zeros(num,2); for i = 1:39 for j = i+1:40 data1{index,1} = [[train_X(i*7-6:i*7,:),ones(7,1)];[train_X(j*7-6:j*7,:),-ones(7,1)]]; data2{index,1} = [[test_X(i*3-2:i*3,:),ones(3,1)];[test_X(j*3-2:j*3,:),-ones(3,1)]]; two_labels(index,1) = i; two_labels(index,2) = j; index = index + 1; end end %(二)Step two: 训练数据 a = zeros(num,14); w = zeros(num,size(train_X,2)); b = zeros(num,1); for i = 1:num svm = svmTrain(data1{i,1}(:,1:k),data1{i,1}(:,k+1),1); a(i,:) = svm.a&#39;; for j = 1:size(train_X,2) w(i,j) = sum(a(i,:)&#39;.*data1{i,1}(:,k+1).*data1{i,1}(:,j)); end b(i,1) = sum(svm.Ysv-svm.Xsv*w(i,:)&#39;)/svm.svnum; end %(三)Step three: 测试数据 labels_num = zeros(size(test_X,1),num); for i = 1:num labels_num(:,i) = (test_X*w(i,:)&#39;)&#39;+b(i,1); end %(四)Step four: 得出分类结果 %找出每个类别所在的分类器 labels_svm = zeros(40,39); for i = 1:40 labels_svm(i,:) = find(two_labels(:,1)==i | two_labels(:,2)==i); end %统计每一类在各个分类器分类正确率 labels = zeros(size(test_X,1),1); for i = 1:size(test_X,1) pro = zeros(40,1); for j = 1:40 for m = 1:39 if labels_num(i,labels_svm(j,m)) &gt; 0 &amp;&amp; two_labels(labels_svm(j,m),1) == j pro(j,1) = pro(j,1) + 1; elseif labels_num(i,labels_svm(j,m)) &lt; 0 &amp;&amp; two_labels(labels_svm(j,m),2) == j pro(j,1) = pro(j,1) + 1; end end end [~,index] = max(pro); labels(i,1) = index; end %(五)Step five： 分析分类结果 compare = zeros(size(test_X,1),1); for i = 1:40 compare((i-1)*3+1:(i-1)*3+3,1) = i; end success_num = length(find(compare==labels)); success_rate = success_num/size(test_X,1); %打印分类正确率情况 fprintf(&#39;==========one-to-all==========\n&#39;); fprintf(&#39; k = %d\n&#39;,k); fprintf(&#39; Crate:%f\n test_data_num: %d\n&#39;,Crate(ii),size(test_X,1)); fprintf(&#39; success_num: %f\n success_rate: %f\n&#39;,success_num,success_rate); end   对于一对一的SVM训练模型，如何划分每一个测试集属于哪一类思路是这样的，因为关于某一个类的训练次数会有39次(以第一个人脸为例，它会和剩下的39个不同的人脸进行组合训练)，而对于每一个测试集，我们的780次训练将会得到相应的 ω \omega ω和 b b b，每个测试集的 ω T x + b \omega^Tx+b ωTx+b的值将会是不一样的。比较这40个类中，测试集在每个类对应的39次训练中 ω T x + b \omega^Tx+b ωTx+b为正数的次数最多的即为该类。例如某一测试集在第一类人脸中对应的39次训练对应的 ω T x + b \omega^Tx+b ωTx+b为正数的次数是30次，而在其余的人脸中对应的39次训练对应的 ω T x + b \omega^Tx+b ωTx+b为正数的次数少于30次，那么可以判断该测试集的最终结果就是第一类人脸。(讲的有点out口，需要自行体会和理解) 测试结果 特征贡献率 维数 正确组数 正确率 0.75 30 115 0.9583 0.80 44 115 0.9583 0.85 68 115 0.9583 0.90 111 115 0.9583 0.95 190 115 0.9583 3. 两者模型对比 从上述结果看来一对一模型比一对多模型的效果较好些，但总的来说这两者的效果都不是很理想的，高级教程中会有其它解决多分类的更高校的算法。一对多的不理想在于它的正负标签比例不均衡，而一对一的不理想在于它的训练次数大大增加了，因为目前只学了二分类，往后研究还得学习关于多分类的算法。" />
<meta property="og:description" content="版权声明：欢迎转载和交流。 https://blog.csdn.net/Hachi_Lin/article/details/87884957 1. 一对多SVM分类器 对于多分类来说，一对多的SVM分类器思想是给定一类标上正标签，其余剩下的类标上负标签，对应的将训练40次。我们用细胞元组来将训练数据和测试数据存储起来。 divdata.m函数负责将数据重新分配，即按上述我所说的 function data = divdata(index,X,n) len = size(X,1); if index == 1 data = [[X(1:n,:),ones(n,1)];[X(n+1:len,:),-ones(len-n,1)]]; elseif index == 80 data = [[X(1:len-n,:),-ones(len-n,1)];[X(len-n+1:len,:),ones(n,1)]]; else data = [[X(1:n*(index-1),:),-ones(n*(index-1),1)];[X(n*index-n+1:n*index,:),ones(n,1)];[X(n*index+1:len,:),-ones(len-n*index,1)]]; end end svmTrain.m是训练函数(这是实验五中的函数) function svm = svmTrain(X,Y,C) % Options是用来控制算法的选项参数的向量，optimset无参时， % 创建一个选项结构所有字段为默认值的选项 options = optimset; options.largeScale = &#39;off&#39;; %LargeScale指大规模搜索，off表示在规模搜索模式关闭 options.Display = &#39;off&#39;; %表示无输出 %二次规划用来求解问题，使用quadprog n = length(Y); %使用线性核 H = (Y.*X)*(Y.*X)&#39;; H=(H+H&#39;)/2; f = -ones(n,1); %f&#39;为1*n个-1 A = []; b = []; Aeq = Y&#39;; beq = 0; lb = zeros(n,1); ub = C*ones(n,1); a0 = zeros(n,1); % a0是解的初始近似值 a = quadprog(H,f,A,b,Aeq,beq,lb,ub,a0,options); epsilon = 1e-9; sv_label = find(abs(a)&gt; epsilon); svm.sva = a(sv_label); svm.Xsv = X(sv_label,:); svm.Ysv = Y(sv_label); svm.svnum = length(sv_label); svm.a = a; end test1.m主函数 %从人脸照片中随选择7张作为训练集 train_data = zeros(40*7,112*92); test_data = zeros(40*3,112*92); for i = 1:40 file_name = [&#39;s&#39;,num2str(i)]; %随机选取同一文件夹下的7个图片 index = randperm(10); for j = 1:7 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(j)),&#39;.pgm&#39;]; image = double(imread(name)); %将矩阵展开为一行 train_data(7*(i-1)+j,:) = reshape(image,1,112*92); end for j = 1:3 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(7+j)),&#39;.pgm&#39;]; image = double(imread(name)); test_data(3*(i-1)+j,:) = reshape(image,1,112*92); end end %================PCA算法开始================ %(一)Step one: 中心化数据 numData = [train_data;test_data]; X = numData - repmat(mean(numData),40*10,1); %(二)Step two: 求中心化数据的协方差矩阵 C = X&#39;*X/size(X,1); %(三)Step three: 计算特征向量和特征值 [V,D] = eig(C); %(四)Step four: 将特征值和特征向量按降序排序 [dummy,order] = sort(diag(-D)); d=diag(D); %将特征值取出，构成一个列向量 E=V(:,order); %将特征向量按照特征值大小进行降序排列 newd=d(order); %将特征值构成的列向量按降序排列 %(五)Step five: 取前k行组成矩阵P,构成变换矩阵 %选取5个特征贡献率值来当作测试对象 Crate = [0.75 0.80 0.85 0.90 0.95]; sumd = sum(newd); for ii = 1:length(Crate) k = 0; for j = 1:length(newd) i = sum(newd(1:j,1),1)/sumd; %计算贡献率=前k个特征值之和/总特征值之和 if i &gt; Crate(ii) %当贡献率大于95%时循环结束,并记下取多少个特征值 k = j; break; end end P = E(:,1:k); newX = X*P; %================SVM 实现多分类================ %================一对多SVM分类器=============== %(一)Step one: 重新分配数据 train_X = newX(1:280,:); test_X = newX(281:400,:); num = 40; data1 = cell(num,1); data2 = cell(num,1); for i = 1:num data1{i,1} = divdata(i,train_X,7); data2{i,1} = divdata(i,test_X,3); end %(二)Step two: 训练数据 a = zeros(num,size(train_X,1)); w = zeros(num,size(train_X,2)); b = zeros(num,1); for i = 1:num svm = svmTrain(data1{i,1}(:,1:k),data1{i,1}(:,k+1),1); a(i,:) = svm.a&#39;; for j = 1:size(train_X,2) w(i,j) = sum(a(i,:)&#39;.*data1{i,1}(:,k+1).*data1{i,1}(:,j)); end b(i,1) = sum(svm.Ysv-svm.Xsv*w(i,:)&#39;)/svm.svnum; end %(三)Step three: 测试数据 labels_num = zeros(size(test_X,1),num); for i = 1:num labels_num(:,i) = (test_X*w(i,:)&#39;)&#39;+b(i,1); end %(四)Step four: 得出分类结果 labels = zeros(size(test_X,1),1); for i = 1:size(test_X,1) [~,index] = max(labels_num(i,:)); labels(i,1) = index; end %(五)Step five： 分析分类结果 compare = zeros(size(test_X,1),1); for i = 1:num compare((i-1)*3+1:(i-1)*3+3,1) = i; end success_num = length(find(compare==labels)); success_rate = success_num/size(test_X,1); %打印分类正确率情况 fprintf(&#39;==========one-to-all==========\n&#39;); fprintf(&#39; k = %d\n&#39;,k); fprintf(&#39; Crate:%f\n test_data_num: %d\n&#39;,Crate(ii),size(test_X,1)); fprintf(&#39; success_num: %f\n success_rate: %f\n&#39;,success_num,success_rate); end   test1.m中的特征贡献率是决定最终维数的标准，因为在对矩阵求解特征值和特征向量时，有些特征值太小了，我们可以不考虑它们，因此可以用特征贡献率来决定我们选取的特征数，也即维数。   对于如何知道测试集某一数据是属于哪一类是这样判断的，因为40组数据在SVM训练器上得到的 ω \omega ω和 b b b是不一样的，因此对应的 ω T x + b \omega^Tx+b ωTx+b的值不同，若这个值是小于0的则不考虑，若这个值是大于0的，我们要找出这40组 ω \omega ω和 b b b中使得该值最大的 ω \omega ω和 b b b，其对应的训练集的正标签即为该 ω T x + b \omega^Tx+b ωTx+b最大嘛。 测试结果 测试数据集总数为120组。 特征贡献率 维数 正确组数 正确率 0.75 30 75 0.6250 0.80 44 66 0.5500 0.85 68 74 0.6167 0.90 111 80 0.6667 0.95 190 81 0.6750 2. 一对一SVM分类器 采用一对一的SVM的思想是对于40个类，我们任意选出两个类作为二分类的SVM训练集，将选定的两个类分别标上正标签和负标签，使用实验五的svmTrain训练训练集，这时我们将训练40×(40-1)/2 = 780次。 test2.m主函数，这个函数还用到了上述的svmTrain.m %从人脸照片中随选择7张作为训练集 train_data = zeros(40*7,112*92); test_data = zeros(40*3,112*92); for i = 1:40 file_name = [&#39;s&#39;,num2str(i)]; %随机选取同一文件夹下的7个图片 index = randperm(10); for j = 1:7 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(j)),&#39;.pgm&#39;]; image = double(imread(name)); %将矩阵展开为一行 train_data(7*(i-1)+j,:) = reshape(image,1,112*92); end for j = 1:3 %文件名拼接 name = [&#39;att_faces\&#39;,file_name,&#39;\&#39;,num2str(index(7+j)),&#39;.pgm&#39;]; image = double(imread(name)); test_data(3*(i-1)+j,:) = reshape(image,1,112*92); end end %================PCA算法开始================ %(一)Step one: 中心化数据 numData = [train_data;test_data]; X = numData - repmat(mean(numData),40*10,1); %(二)Step two: 求中心化数据的协方差矩阵 C = X&#39;*X/size(X,1); %(三)Step three: 计算特征向量和特征值 [V,D] = eig(C); %(四)Step four: 将特征值和特征向量按降序排序 [dummy,order] = sort(diag(-D)); d=diag(D); %将特征值取出，构成一个列向量 E=V(:,order); %将特征向量按照特征值大小进行降序排列 newd=d(order); %将特征值构成的列向量按降序排列 %(五)Step five: 取前k行组成矩阵P,构成变换矩阵 %选取5个特征贡献率值来当作测试对象 Crate = [0.75 0.80 0.85 0.90 0.95]; sumd = sum(newd); for ii = 1:length(Crate) k = 0; for j = 1:length(newd) i = sum(newd(1:j,1),1)/sumd; %计算贡献率=前k个特征值之和/总特征值之和 if i &gt; Crate(ii) %当贡献率大于95%时循环结束,并记下取多少个特征值 k = j; break; end end P = E(:,1:k); newX = X*P; %================SVM 实现多分类================ %这里采用一对一方法 %(一)Step one: 重新分配数据 train_X = newX(1:280,:); test_X = newX(281:400,:); num = 40*(40-1)/2; data1 = cell(num,1); data2 = cell(num,1); index = 1; two_labels = zeros(num,2); for i = 1:39 for j = i+1:40 data1{index,1} = [[train_X(i*7-6:i*7,:),ones(7,1)];[train_X(j*7-6:j*7,:),-ones(7,1)]]; data2{index,1} = [[test_X(i*3-2:i*3,:),ones(3,1)];[test_X(j*3-2:j*3,:),-ones(3,1)]]; two_labels(index,1) = i; two_labels(index,2) = j; index = index + 1; end end %(二)Step two: 训练数据 a = zeros(num,14); w = zeros(num,size(train_X,2)); b = zeros(num,1); for i = 1:num svm = svmTrain(data1{i,1}(:,1:k),data1{i,1}(:,k+1),1); a(i,:) = svm.a&#39;; for j = 1:size(train_X,2) w(i,j) = sum(a(i,:)&#39;.*data1{i,1}(:,k+1).*data1{i,1}(:,j)); end b(i,1) = sum(svm.Ysv-svm.Xsv*w(i,:)&#39;)/svm.svnum; end %(三)Step three: 测试数据 labels_num = zeros(size(test_X,1),num); for i = 1:num labels_num(:,i) = (test_X*w(i,:)&#39;)&#39;+b(i,1); end %(四)Step four: 得出分类结果 %找出每个类别所在的分类器 labels_svm = zeros(40,39); for i = 1:40 labels_svm(i,:) = find(two_labels(:,1)==i | two_labels(:,2)==i); end %统计每一类在各个分类器分类正确率 labels = zeros(size(test_X,1),1); for i = 1:size(test_X,1) pro = zeros(40,1); for j = 1:40 for m = 1:39 if labels_num(i,labels_svm(j,m)) &gt; 0 &amp;&amp; two_labels(labels_svm(j,m),1) == j pro(j,1) = pro(j,1) + 1; elseif labels_num(i,labels_svm(j,m)) &lt; 0 &amp;&amp; two_labels(labels_svm(j,m),2) == j pro(j,1) = pro(j,1) + 1; end end end [~,index] = max(pro); labels(i,1) = index; end %(五)Step five： 分析分类结果 compare = zeros(size(test_X,1),1); for i = 1:40 compare((i-1)*3+1:(i-1)*3+3,1) = i; end success_num = length(find(compare==labels)); success_rate = success_num/size(test_X,1); %打印分类正确率情况 fprintf(&#39;==========one-to-all==========\n&#39;); fprintf(&#39; k = %d\n&#39;,k); fprintf(&#39; Crate:%f\n test_data_num: %d\n&#39;,Crate(ii),size(test_X,1)); fprintf(&#39; success_num: %f\n success_rate: %f\n&#39;,success_num,success_rate); end   对于一对一的SVM训练模型，如何划分每一个测试集属于哪一类思路是这样的，因为关于某一个类的训练次数会有39次(以第一个人脸为例，它会和剩下的39个不同的人脸进行组合训练)，而对于每一个测试集，我们的780次训练将会得到相应的 ω \omega ω和 b b b，每个测试集的 ω T x + b \omega^Tx+b ωTx+b的值将会是不一样的。比较这40个类中，测试集在每个类对应的39次训练中 ω T x + b \omega^Tx+b ωTx+b为正数的次数最多的即为该类。例如某一测试集在第一类人脸中对应的39次训练对应的 ω T x + b \omega^Tx+b ωTx+b为正数的次数是30次，而在其余的人脸中对应的39次训练对应的 ω T x + b \omega^Tx+b ωTx+b为正数的次数少于30次，那么可以判断该测试集的最终结果就是第一类人脸。(讲的有点out口，需要自行体会和理解) 测试结果 特征贡献率 维数 正确组数 正确率 0.75 30 115 0.9583 0.80 44 115 0.9583 0.85 68 115 0.9583 0.90 111 115 0.9583 0.95 190 115 0.9583 3. 两者模型对比 从上述结果看来一对一模型比一对多模型的效果较好些，但总的来说这两者的效果都不是很理想的，高级教程中会有其它解决多分类的更高校的算法。一对多的不理想在于它的正负标签比例不均衡，而一对一的不理想在于它的训练次数大大增加了，因为目前只学了二分类，往后研究还得学习关于多分类的算法。" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-22T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：欢迎转载和交流。 https://blog.csdn.net/Hachi_Lin/article/details/87884957 1. 一对多SVM分类器 对于多分类来说，一对多的SVM分类器思想是给定一类标上正标签，其余剩下的类标上负标签，对应的将训练40次。我们用细胞元组来将训练数据和测试数据存储起来。 divdata.m函数负责将数据重新分配，即按上述我所说的 function data = divdata(index,X,n) len = size(X,1); if index == 1 data = [[X(1:n,:),ones(n,1)];[X(n+1:len,:),-ones(len-n,1)]]; elseif index == 80 data = [[X(1:len-n,:),-ones(len-n,1)];[X(len-n+1:len,:),ones(n,1)]]; else data = [[X(1:n*(index-1),:),-ones(n*(index-1),1)];[X(n*index-n+1:n*index,:),ones(n,1)];[X(n*index+1:len,:),-ones(len-n*index,1)]]; end end svmTrain.m是训练函数(这是实验五中的函数) function svm = svmTrain(X,Y,C) % Options是用来控制算法的选项参数的向量，optimset无参时， % 创建一个选项结构所有字段为默认值的选项 options = optimset; options.largeScale = &#39;off&#39;; %LargeScale指大规模搜索，off表示在规模搜索模式关闭 options.Display = &#39;off&#39;; %表示无输出 %二次规划用来求解问题，使用quadprog n = length(Y); %使用线性核 H = (Y.*X)*(Y.*X)&#39;; H=(H+H&#39;)/2; f = -ones(n,1); %f&#39;为1*n个-1 A = []; b = []; Aeq = Y&#39;; beq = 0; lb = zeros(n,1); ub = C*ones(n,1); a0 = zeros(n,1); % a0是解的初始近似值 a = quadprog(H,f,A,b,Aeq,beq,lb,ub,a0,options); epsilon = 1e-9; sv_label = find(abs(a)&gt; epsilon); svm.sva = a(sv_label); svm.Xsv = X(sv_label,:); svm.Ysv = Y(sv_label); svm.svnum = length(sv_label); svm.a = a; end test1.m主函数 %从人脸照片中随选择7张作为训练集 train_data = zeros(40*7,112*92); test_data = zeros(40*3,112*92); for i = 1:40 file_name = [&#39;s&#39;,num2str(i)]; %随机选取同一文件夹下的7个图片 index = randperm(10); for j = 1:7 %文件名拼接 name = [&#39;att_faces\\&#39;,file_name,&#39;\\&#39;,num2str(index(j)),&#39;.pgm&#39;]; image = double(imread(name)); %将矩阵展开为一行 train_data(7*(i-1)+j,:) = reshape(image,1,112*92); end for j = 1:3 %文件名拼接 name = [&#39;att_faces\\&#39;,file_name,&#39;\\&#39;,num2str(index(7+j)),&#39;.pgm&#39;]; image = double(imread(name)); test_data(3*(i-1)+j,:) = reshape(image,1,112*92); end end %================PCA算法开始================ %(一)Step one: 中心化数据 numData = [train_data;test_data]; X = numData - repmat(mean(numData),40*10,1); %(二)Step two: 求中心化数据的协方差矩阵 C = X&#39;*X/size(X,1); %(三)Step three: 计算特征向量和特征值 [V,D] = eig(C); %(四)Step four: 将特征值和特征向量按降序排序 [dummy,order] = sort(diag(-D)); d=diag(D); %将特征值取出，构成一个列向量 E=V(:,order); %将特征向量按照特征值大小进行降序排列 newd=d(order); %将特征值构成的列向量按降序排列 %(五)Step five: 取前k行组成矩阵P,构成变换矩阵 %选取5个特征贡献率值来当作测试对象 Crate = [0.75 0.80 0.85 0.90 0.95]; sumd = sum(newd); for ii = 1:length(Crate) k = 0; for j = 1:length(newd) i = sum(newd(1:j,1),1)/sumd; %计算贡献率=前k个特征值之和/总特征值之和 if i &gt; Crate(ii) %当贡献率大于95%时循环结束,并记下取多少个特征值 k = j; break; end end P = E(:,1:k); newX = X*P; %================SVM 实现多分类================ %================一对多SVM分类器=============== %(一)Step one: 重新分配数据 train_X = newX(1:280,:); test_X = newX(281:400,:); num = 40; data1 = cell(num,1); data2 = cell(num,1); for i = 1:num data1{i,1} = divdata(i,train_X,7); data2{i,1} = divdata(i,test_X,3); end %(二)Step two: 训练数据 a = zeros(num,size(train_X,1)); w = zeros(num,size(train_X,2)); b = zeros(num,1); for i = 1:num svm = svmTrain(data1{i,1}(:,1:k),data1{i,1}(:,k+1),1); a(i,:) = svm.a&#39;; for j = 1:size(train_X,2) w(i,j) = sum(a(i,:)&#39;.*data1{i,1}(:,k+1).*data1{i,1}(:,j)); end b(i,1) = sum(svm.Ysv-svm.Xsv*w(i,:)&#39;)/svm.svnum; end %(三)Step three: 测试数据 labels_num = zeros(size(test_X,1),num); for i = 1:num labels_num(:,i) = (test_X*w(i,:)&#39;)&#39;+b(i,1); end %(四)Step four: 得出分类结果 labels = zeros(size(test_X,1),1); for i = 1:size(test_X,1) [~,index] = max(labels_num(i,:)); labels(i,1) = index; end %(五)Step five： 分析分类结果 compare = zeros(size(test_X,1),1); for i = 1:num compare((i-1)*3+1:(i-1)*3+3,1) = i; end success_num = length(find(compare==labels)); success_rate = success_num/size(test_X,1); %打印分类正确率情况 fprintf(&#39;==========one-to-all==========\\n&#39;); fprintf(&#39; k = %d\\n&#39;,k); fprintf(&#39; Crate:%f\\n test_data_num: %d\\n&#39;,Crate(ii),size(test_X,1)); fprintf(&#39; success_num: %f\\n success_rate: %f\\n&#39;,success_num,success_rate); end   test1.m中的特征贡献率是决定最终维数的标准，因为在对矩阵求解特征值和特征向量时，有些特征值太小了，我们可以不考虑它们，因此可以用特征贡献率来决定我们选取的特征数，也即维数。   对于如何知道测试集某一数据是属于哪一类是这样判断的，因为40组数据在SVM训练器上得到的 ω \\omega ω和 b b b是不一样的，因此对应的 ω T x + b \\omega^Tx+b ωTx+b的值不同，若这个值是小于0的则不考虑，若这个值是大于0的，我们要找出这40组 ω \\omega ω和 b b b中使得该值最大的 ω \\omega ω和 b b b，其对应的训练集的正标签即为该 ω T x + b \\omega^Tx+b ωTx+b最大嘛。 测试结果 测试数据集总数为120组。 特征贡献率 维数 正确组数 正确率 0.75 30 75 0.6250 0.80 44 66 0.5500 0.85 68 74 0.6167 0.90 111 80 0.6667 0.95 190 81 0.6750 2. 一对一SVM分类器 采用一对一的SVM的思想是对于40个类，我们任意选出两个类作为二分类的SVM训练集，将选定的两个类分别标上正标签和负标签，使用实验五的svmTrain训练训练集，这时我们将训练40×(40-1)/2 = 780次。 test2.m主函数，这个函数还用到了上述的svmTrain.m %从人脸照片中随选择7张作为训练集 train_data = zeros(40*7,112*92); test_data = zeros(40*3,112*92); for i = 1:40 file_name = [&#39;s&#39;,num2str(i)]; %随机选取同一文件夹下的7个图片 index = randperm(10); for j = 1:7 %文件名拼接 name = [&#39;att_faces\\&#39;,file_name,&#39;\\&#39;,num2str(index(j)),&#39;.pgm&#39;]; image = double(imread(name)); %将矩阵展开为一行 train_data(7*(i-1)+j,:) = reshape(image,1,112*92); end for j = 1:3 %文件名拼接 name = [&#39;att_faces\\&#39;,file_name,&#39;\\&#39;,num2str(index(7+j)),&#39;.pgm&#39;]; image = double(imread(name)); test_data(3*(i-1)+j,:) = reshape(image,1,112*92); end end %================PCA算法开始================ %(一)Step one: 中心化数据 numData = [train_data;test_data]; X = numData - repmat(mean(numData),40*10,1); %(二)Step two: 求中心化数据的协方差矩阵 C = X&#39;*X/size(X,1); %(三)Step three: 计算特征向量和特征值 [V,D] = eig(C); %(四)Step four: 将特征值和特征向量按降序排序 [dummy,order] = sort(diag(-D)); d=diag(D); %将特征值取出，构成一个列向量 E=V(:,order); %将特征向量按照特征值大小进行降序排列 newd=d(order); %将特征值构成的列向量按降序排列 %(五)Step five: 取前k行组成矩阵P,构成变换矩阵 %选取5个特征贡献率值来当作测试对象 Crate = [0.75 0.80 0.85 0.90 0.95]; sumd = sum(newd); for ii = 1:length(Crate) k = 0; for j = 1:length(newd) i = sum(newd(1:j,1),1)/sumd; %计算贡献率=前k个特征值之和/总特征值之和 if i &gt; Crate(ii) %当贡献率大于95%时循环结束,并记下取多少个特征值 k = j; break; end end P = E(:,1:k); newX = X*P; %================SVM 实现多分类================ %这里采用一对一方法 %(一)Step one: 重新分配数据 train_X = newX(1:280,:); test_X = newX(281:400,:); num = 40*(40-1)/2; data1 = cell(num,1); data2 = cell(num,1); index = 1; two_labels = zeros(num,2); for i = 1:39 for j = i+1:40 data1{index,1} = [[train_X(i*7-6:i*7,:),ones(7,1)];[train_X(j*7-6:j*7,:),-ones(7,1)]]; data2{index,1} = [[test_X(i*3-2:i*3,:),ones(3,1)];[test_X(j*3-2:j*3,:),-ones(3,1)]]; two_labels(index,1) = i; two_labels(index,2) = j; index = index + 1; end end %(二)Step two: 训练数据 a = zeros(num,14); w = zeros(num,size(train_X,2)); b = zeros(num,1); for i = 1:num svm = svmTrain(data1{i,1}(:,1:k),data1{i,1}(:,k+1),1); a(i,:) = svm.a&#39;; for j = 1:size(train_X,2) w(i,j) = sum(a(i,:)&#39;.*data1{i,1}(:,k+1).*data1{i,1}(:,j)); end b(i,1) = sum(svm.Ysv-svm.Xsv*w(i,:)&#39;)/svm.svnum; end %(三)Step three: 测试数据 labels_num = zeros(size(test_X,1),num); for i = 1:num labels_num(:,i) = (test_X*w(i,:)&#39;)&#39;+b(i,1); end %(四)Step four: 得出分类结果 %找出每个类别所在的分类器 labels_svm = zeros(40,39); for i = 1:40 labels_svm(i,:) = find(two_labels(:,1)==i | two_labels(:,2)==i); end %统计每一类在各个分类器分类正确率 labels = zeros(size(test_X,1),1); for i = 1:size(test_X,1) pro = zeros(40,1); for j = 1:40 for m = 1:39 if labels_num(i,labels_svm(j,m)) &gt; 0 &amp;&amp; two_labels(labels_svm(j,m),1) == j pro(j,1) = pro(j,1) + 1; elseif labels_num(i,labels_svm(j,m)) &lt; 0 &amp;&amp; two_labels(labels_svm(j,m),2) == j pro(j,1) = pro(j,1) + 1; end end end [~,index] = max(pro); labels(i,1) = index; end %(五)Step five： 分析分类结果 compare = zeros(size(test_X,1),1); for i = 1:40 compare((i-1)*3+1:(i-1)*3+3,1) = i; end success_num = length(find(compare==labels)); success_rate = success_num/size(test_X,1); %打印分类正确率情况 fprintf(&#39;==========one-to-all==========\\n&#39;); fprintf(&#39; k = %d\\n&#39;,k); fprintf(&#39; Crate:%f\\n test_data_num: %d\\n&#39;,Crate(ii),size(test_X,1)); fprintf(&#39; success_num: %f\\n success_rate: %f\\n&#39;,success_num,success_rate); end   对于一对一的SVM训练模型，如何划分每一个测试集属于哪一类思路是这样的，因为关于某一个类的训练次数会有39次(以第一个人脸为例，它会和剩下的39个不同的人脸进行组合训练)，而对于每一个测试集，我们的780次训练将会得到相应的 ω \\omega ω和 b b b，每个测试集的 ω T x + b \\omega^Tx+b ωTx+b的值将会是不一样的。比较这40个类中，测试集在每个类对应的39次训练中 ω T x + b \\omega^Tx+b ωTx+b为正数的次数最多的即为该类。例如某一测试集在第一类人脸中对应的39次训练对应的 ω T x + b \\omega^Tx+b ωTx+b为正数的次数是30次，而在其余的人脸中对应的39次训练对应的 ω T x + b \\omega^Tx+b ωTx+b为正数的次数少于30次，那么可以判断该测试集的最终结果就是第一类人脸。(讲的有点out口，需要自行体会和理解) 测试结果 特征贡献率 维数 正确组数 正确率 0.75 30 115 0.9583 0.80 44 115 0.9583 0.85 68 115 0.9583 0.90 111 115 0.9583 0.95 190 115 0.9583 3. 两者模型对比 从上述结果看来一对一模型比一对多模型的效果较好些，但总的来说这两者的效果都不是很理想的，高级教程中会有其它解决多分类的更高校的算法。一对多的不理想在于它的正负标签比例不均衡，而一对一的不理想在于它的训练次数大大增加了，因为目前只学了二分类，往后研究还得学习关于多分类的算法。","@type":"BlogPosting","url":"/2019/02/22/71179dedf19106e5ecd951e5578e1359.html","headline":"山东大学机器学习（实验七解读）—— PCA","dateModified":"2019-02-22T00:00:00+08:00","datePublished":"2019-02-22T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/02/22/71179dedf19106e5ecd951e5578e1359.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>山东大学机器学习（实验七解读）—— PCA</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：欢迎转载和交流。 https://blog.csdn.net/Hachi_Lin/article/details/87884957 
 </div> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h3><a id="1_SVM_0"></a>1. 一对多SVM分类器</h3> 
  <p>对于多分类来说，一对多的SVM分类器思想是给定一类标上正标签，其余剩下的类标上负标签，对应的将训练40次。我们用细胞元组来将训练数据和测试数据存储起来。</p> 
  <ul> 
   <li>divdata.m函数负责将数据重新分配，即按上述我所说的</li> 
  </ul> 
  <pre><code class="prism language-c">function data <span class="token operator">=</span> <span class="token function">divdata</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>X<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
    len <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">1</span>
        data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>n<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>len<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>len<span class="token operator">-</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    elseif index <span class="token operator">==</span> <span class="token number">80</span>
        data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>len<span class="token operator">-</span>n<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>len<span class="token operator">-</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span>len<span class="token operator">-</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>len<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>n<span class="token operator">*</span><span class="token punctuation">(</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token operator">*</span><span class="token punctuation">(</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span>n<span class="token operator">*</span>index<span class="token operator">-</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>n<span class="token operator">*</span>index<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token function">X</span><span class="token punctuation">(</span>n<span class="token operator">*</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>len<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>len<span class="token operator">-</span>n<span class="token operator">*</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    end
end
</code></pre> 
  <ul> 
   <li>svmTrain.m是训练函数(这是实验五中的函数)</li> 
  </ul> 
  <pre><code class="prism language-c">function svm <span class="token operator">=</span> <span class="token function">svmTrain</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>C<span class="token punctuation">)</span>
    <span class="token operator">%</span> Options是用来控制算法的选项参数的向量，optimset无参时，
    <span class="token operator">%</span> 创建一个选项结构所有字段为默认值的选项
    options <span class="token operator">=</span> optimset<span class="token punctuation">;</span>
    options<span class="token punctuation">.</span>largeScale <span class="token operator">=</span> <span class="token string">'off'</span><span class="token punctuation">;</span> <span class="token operator">%</span>LargeScale指大规模搜索，off表示在规模搜索模式关闭
    options<span class="token punctuation">.</span>Display <span class="token operator">=</span> <span class="token string">'off'</span><span class="token punctuation">;</span> <span class="token operator">%</span>表示无输出
    
    <span class="token operator">%</span>二次规划用来求解问题，使用quadprog
    n <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token operator">%</span>使用线性核   
    H <span class="token operator">=</span> <span class="token punctuation">(</span>Y<span class="token punctuation">.</span><span class="token operator">*</span>X<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Y<span class="token punctuation">.</span><span class="token operator">*</span>X<span class="token punctuation">)</span>'<span class="token punctuation">;</span>
    H<span class="token operator">=</span><span class="token punctuation">(</span>H<span class="token operator">+</span>H'<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    f <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>f'为<span class="token number">1</span><span class="token operator">*</span>n个<span class="token operator">-</span><span class="token number">1</span>
    A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    Aeq <span class="token operator">=</span> Y'<span class="token punctuation">;</span> 
    beq <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    lb <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    ub <span class="token operator">=</span> C<span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    a0 <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span> a0是解的初始近似值
    a <span class="token operator">=</span> <span class="token function">quadprog</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span>f<span class="token punctuation">,</span>A<span class="token punctuation">,</span>b<span class="token punctuation">,</span>Aeq<span class="token punctuation">,</span>beq<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>ub<span class="token punctuation">,</span>a0<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    epsilon <span class="token operator">=</span> <span class="token number">1e-9</span><span class="token punctuation">;</span>
    sv_label <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">&gt;</span> epsilon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    svm<span class="token punctuation">.</span>sva <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span>sv_label<span class="token punctuation">)</span><span class="token punctuation">;</span>
    svm<span class="token punctuation">.</span>Xsv <span class="token operator">=</span> <span class="token function">X</span><span class="token punctuation">(</span>sv_label<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    svm<span class="token punctuation">.</span>Ysv <span class="token operator">=</span> <span class="token function">Y</span><span class="token punctuation">(</span>sv_label<span class="token punctuation">)</span><span class="token punctuation">;</span>
    svm<span class="token punctuation">.</span>svnum <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>sv_label<span class="token punctuation">)</span><span class="token punctuation">;</span>
    svm<span class="token punctuation">.</span>a <span class="token operator">=</span> a<span class="token punctuation">;</span>
end
</code></pre> 
  <ul> 
   <li>test1.m主函数</li> 
  </ul> 
  <pre><code class="prism language-c"><span class="token operator">%</span>从人脸照片中随选择<span class="token number">7</span>张作为训练集
train_data <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
test_data <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">40</span>
   file_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token operator">%</span>随机选取同一文件夹下的<span class="token number">7</span>个图片
   index <span class="token operator">=</span> <span class="token function">randperm</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">7</span>
       <span class="token operator">%</span>文件名拼接
       name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'att_faces\',file_name,'</span>\<span class="token string">',num2str(index(j)),'</span><span class="token punctuation">.</span>pgm'<span class="token punctuation">]</span><span class="token punctuation">;</span>
       image <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">%</span>将矩阵展开为一行
       <span class="token function">train_data</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">reshape</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
   <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span>
       <span class="token operator">%</span>文件名拼接
       name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'att_faces\',file_name,'</span>\<span class="token string">',num2str(index(7+j)),'</span><span class="token punctuation">.</span>pgm'<span class="token punctuation">]</span><span class="token punctuation">;</span>
       image <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">test_data</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">reshape</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
end
<span class="token operator">%</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>PCA算法开始<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token operator">%</span><span class="token punctuation">(</span>一<span class="token punctuation">)</span>Step one<span class="token punctuation">:</span> 中心化数据
numData <span class="token operator">=</span> <span class="token punctuation">[</span>train_data<span class="token punctuation">;</span>test_data<span class="token punctuation">]</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> numData <span class="token operator">-</span> <span class="token function">repmat</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span>numData<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token punctuation">(</span>二<span class="token punctuation">)</span>Step two<span class="token punctuation">:</span> 求中心化数据的协方差矩阵
C <span class="token operator">=</span> X'<span class="token operator">*</span>X<span class="token operator">/</span><span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token punctuation">(</span>三<span class="token punctuation">)</span>Step three<span class="token punctuation">:</span> 计算特征向量和特征值
<span class="token punctuation">[</span>V<span class="token punctuation">,</span>D<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">eig</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token punctuation">(</span>四<span class="token punctuation">)</span>Step four<span class="token punctuation">:</span> 将特征值和特征向量按降序排序
<span class="token punctuation">[</span>dummy<span class="token punctuation">,</span>order<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">diag</span><span class="token punctuation">(</span><span class="token operator">-</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token operator">=</span><span class="token function">diag</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">%</span>将特征值取出，构成一个列向量
E<span class="token operator">=</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>将特征向量按照特征值大小进行降序排列
newd<span class="token operator">=</span><span class="token function">d</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span>将特征值构成的列向量按降序排列

<span class="token operator">%</span><span class="token punctuation">(</span>五<span class="token punctuation">)</span>Step five<span class="token punctuation">:</span> 取前k行组成矩阵P<span class="token punctuation">,</span>构成变换矩阵
<span class="token operator">%</span>选取<span class="token number">5</span>个特征贡献率值来当作测试对象
Crate <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.75</span> <span class="token number">0.80</span> <span class="token number">0.85</span> <span class="token number">0.90</span> <span class="token number">0.95</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
sumd <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>newd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> ii <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">length</span><span class="token punctuation">(</span>Crate<span class="token punctuation">)</span>
    k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">length</span><span class="token punctuation">(</span>newd<span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">newd</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span>sumd<span class="token punctuation">;</span> <span class="token operator">%</span>计算贡献率<span class="token operator">=</span>前k个特征值之和<span class="token operator">/</span>总特征值之和 
        <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token function">Crate</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span> <span class="token operator">%</span>当贡献率大于<span class="token number">95</span><span class="token operator">%</span>时循环结束<span class="token punctuation">,</span>并记下取多少个特征值
            k <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        end
    end
    P <span class="token operator">=</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    newX <span class="token operator">=</span> X<span class="token operator">*</span>P<span class="token punctuation">;</span>
    <span class="token operator">%</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>SVM 实现多分类<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
    <span class="token operator">%</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>一对多SVM分类器<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
    <span class="token operator">%</span><span class="token punctuation">(</span>一<span class="token punctuation">)</span>Step one<span class="token punctuation">:</span> 重新分配数据
    train_X <span class="token operator">=</span> <span class="token function">newX</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">280</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    test_X <span class="token operator">=</span> <span class="token function">newX</span><span class="token punctuation">(</span><span class="token number">281</span><span class="token punctuation">:</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    num <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
    data1 <span class="token operator">=</span> <span class="token function">cell</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data2 <span class="token operator">=</span> <span class="token function">cell</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
       data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">divdata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>train_X<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       data2<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">divdata</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>test_X<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>二<span class="token punctuation">)</span>Step two<span class="token punctuation">:</span> 训练数据
    a <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>train_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    w <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>train_X<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
       svm <span class="token operator">=</span> <span class="token function">svmTrain</span><span class="token punctuation">(</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span>  svm<span class="token punctuation">.</span>a'<span class="token punctuation">;</span>
       <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>train_X<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
          <span class="token function">w</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span>'<span class="token punctuation">.</span><span class="token operator">*</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       end
       <span class="token function">b</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>svm<span class="token punctuation">.</span>Ysv<span class="token operator">-</span>svm<span class="token punctuation">.</span>Xsv<span class="token operator">*</span><span class="token function">w</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span>'<span class="token punctuation">)</span><span class="token operator">/</span>svm<span class="token punctuation">.</span>svnum<span class="token punctuation">;</span>
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>三<span class="token punctuation">)</span>Step three<span class="token punctuation">:</span> 测试数据
    labels_num <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
       <span class="token function">labels_num</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>test_X<span class="token operator">*</span><span class="token function">w</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token string">')'</span><span class="token operator">+</span><span class="token function">b</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>四<span class="token punctuation">)</span>Step four<span class="token punctuation">:</span> 得出分类结果
    labels <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">labels_num</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">labels</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> index<span class="token punctuation">;</span>
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>五<span class="token punctuation">)</span>Step five： 分析分类结果
    compare <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
       <span class="token function">compare</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span> 
    end
    success_num <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>compare<span class="token operator">==</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    success_rate <span class="token operator">=</span> success_num<span class="token operator">/</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span>打印分类正确率情况
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'==========one-to-all==========\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' k = %d\n'</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' Crate:%f\n test_data_num: %d\n'</span><span class="token punctuation">,</span><span class="token function">Crate</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' success_num: %f\n success_rate: %f\n'</span><span class="token punctuation">,</span>success_num<span class="token punctuation">,</span>success_rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
end

</code></pre> 
  <p>  test1.m中的特征贡献率是决定最终维数的标准，因为在对矩阵求解特征值和特征向量时，有些特征值太小了，我们可以不考虑它们，因此可以用特征贡献率来决定我们选取的特征数，也即维数。<br>   对于如何知道测试集某一数据是属于哪一类是这样判断的，因为40组数据在SVM训练器上得到的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          ω
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">ω</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>是不一样的，因此对应的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           ω
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mi>
          x
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega^Tx+b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>的值不同，若这个值是小于0的则不考虑，若这个值是大于0的，我们要找出这40组<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          ω
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">ω</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>中使得该值最大的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          ω
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">ω</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>，其对应的训练集的正标签即为该<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           ω
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mi>
          x
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega^Tx+b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>最大嘛。</p> 
  <ul> 
   <li>测试结果<br> 测试数据集总数为120组。</li> 
  </ul> 
  <table> 
   <thead> 
    <tr> 
     <th>特征贡献率</th> 
     <th>维数</th> 
     <th>正确组数</th> 
     <th>正确率</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>0.75</td> 
     <td>30</td> 
     <td>75</td> 
     <td>0.6250</td> 
    </tr> 
    <tr> 
     <td>0.80</td> 
     <td>44</td> 
     <td>66</td> 
     <td>0.5500</td> 
    </tr> 
    <tr> 
     <td>0.85</td> 
     <td>68</td> 
     <td>74</td> 
     <td>0.6167</td> 
    </tr> 
    <tr> 
     <td>0.90</td> 
     <td>111</td> 
     <td>80</td> 
     <td>0.6667</td> 
    </tr> 
    <tr> 
     <td>0.95</td> 
     <td>190</td> 
     <td>81</td> 
     <td>0.6750</td> 
    </tr> 
   </tbody> 
  </table>
  <h3><a id="2_SVM_172"></a>2. 一对一SVM分类器</h3> 
  <p>采用一对一的SVM的思想是对于40个类，我们任意选出两个类作为二分类的SVM训练集，将选定的两个类分别标上正标签和负标签，使用实验五的svmTrain训练训练集，这时我们将训练40×(40-1)/2 = 780次。</p> 
  <ul> 
   <li>test2.m主函数，这个函数还用到了上述的svmTrain.m</li> 
  </ul> 
  <pre><code class="prism language-c"><span class="token operator">%</span>从人脸照片中随选择<span class="token number">7</span>张作为训练集
train_data <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
test_data <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">40</span>
   file_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token operator">%</span>随机选取同一文件夹下的<span class="token number">7</span>个图片
   index <span class="token operator">=</span> <span class="token function">randperm</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">7</span>
       <span class="token operator">%</span>文件名拼接
       name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'att_faces\',file_name,'</span>\<span class="token string">',num2str(index(j)),'</span><span class="token punctuation">.</span>pgm'<span class="token punctuation">]</span><span class="token punctuation">;</span>
       image <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">%</span>将矩阵展开为一行
       <span class="token function">train_data</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">reshape</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
   <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span>
       <span class="token operator">%</span>文件名拼接
       name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'att_faces\',file_name,'</span>\<span class="token string">',num2str(index(7+j)),'</span><span class="token punctuation">.</span>pgm'<span class="token punctuation">]</span><span class="token punctuation">;</span>
       image <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token function">imread</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">test_data</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">reshape</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token operator">*</span><span class="token number">92</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   end
end
<span class="token operator">%</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>PCA算法开始<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token operator">%</span><span class="token punctuation">(</span>一<span class="token punctuation">)</span>Step one<span class="token punctuation">:</span> 中心化数据
numData <span class="token operator">=</span> <span class="token punctuation">[</span>train_data<span class="token punctuation">;</span>test_data<span class="token punctuation">]</span><span class="token punctuation">;</span>
X <span class="token operator">=</span> numData <span class="token operator">-</span> <span class="token function">repmat</span><span class="token punctuation">(</span><span class="token function">mean</span><span class="token punctuation">(</span>numData<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token punctuation">(</span>二<span class="token punctuation">)</span>Step two<span class="token punctuation">:</span> 求中心化数据的协方差矩阵
C <span class="token operator">=</span> X'<span class="token operator">*</span>X<span class="token operator">/</span><span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token punctuation">(</span>三<span class="token punctuation">)</span>Step three<span class="token punctuation">:</span> 计算特征向量和特征值
<span class="token punctuation">[</span>V<span class="token punctuation">,</span>D<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">eig</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token punctuation">(</span>四<span class="token punctuation">)</span>Step four<span class="token punctuation">:</span> 将特征值和特征向量按降序排序
<span class="token punctuation">[</span>dummy<span class="token punctuation">,</span>order<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">diag</span><span class="token punctuation">(</span><span class="token operator">-</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token operator">=</span><span class="token function">diag</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">%</span>将特征值取出，构成一个列向量
E<span class="token operator">=</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>将特征向量按照特征值大小进行降序排列
newd<span class="token operator">=</span><span class="token function">d</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span>将特征值构成的列向量按降序排列

<span class="token operator">%</span><span class="token punctuation">(</span>五<span class="token punctuation">)</span>Step five<span class="token punctuation">:</span> 取前k行组成矩阵P<span class="token punctuation">,</span>构成变换矩阵
<span class="token operator">%</span>选取<span class="token number">5</span>个特征贡献率值来当作测试对象
Crate <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.75</span> <span class="token number">0.80</span> <span class="token number">0.85</span> <span class="token number">0.90</span> <span class="token number">0.95</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
sumd <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>newd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> ii <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">length</span><span class="token punctuation">(</span>Crate<span class="token punctuation">)</span>
    k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">length</span><span class="token punctuation">(</span>newd<span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">newd</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span>sumd<span class="token punctuation">;</span> <span class="token operator">%</span>计算贡献率<span class="token operator">=</span>前k个特征值之和<span class="token operator">/</span>总特征值之和 
        <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token function">Crate</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span> <span class="token operator">%</span>当贡献率大于<span class="token number">95</span><span class="token operator">%</span>时循环结束<span class="token punctuation">,</span>并记下取多少个特征值
            k <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        end
    end
    P <span class="token operator">=</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    newX <span class="token operator">=</span> X<span class="token operator">*</span>P<span class="token punctuation">;</span>
    <span class="token operator">%</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>SVM 实现多分类<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
    <span class="token operator">%</span>这里采用一对一方法
    <span class="token operator">%</span><span class="token punctuation">(</span>一<span class="token punctuation">)</span>Step one<span class="token punctuation">:</span> 重新分配数据
    train_X <span class="token operator">=</span> <span class="token function">newX</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">280</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    test_X <span class="token operator">=</span> <span class="token function">newX</span><span class="token punctuation">(</span><span class="token number">281</span><span class="token punctuation">:</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    num <span class="token operator">=</span> <span class="token number">40</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    data1 <span class="token operator">=</span> <span class="token function">cell</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data2 <span class="token operator">=</span> <span class="token function">cell</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    two_labels <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">39</span>
        <span class="token keyword">for</span> j <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">40</span>
            data1<span class="token punctuation">{</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token function">train_X</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">7</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span>i<span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token function">train_X</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">7</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span>j<span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            data2<span class="token punctuation">{</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token function">test_X</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token function">test_X</span><span class="token punctuation">(</span>j<span class="token operator">*</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>j<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">two_labels</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token function">two_labels</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
            index <span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        end
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>二<span class="token punctuation">)</span>Step two<span class="token punctuation">:</span> 训练数据
    a <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    w <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>train_X<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
       svm <span class="token operator">=</span> <span class="token function">svmTrain</span><span class="token punctuation">(</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span>  svm<span class="token punctuation">.</span>a'<span class="token punctuation">;</span>
       <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>train_X<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
          <span class="token function">w</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span>'<span class="token punctuation">.</span><span class="token operator">*</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span>data1<span class="token punctuation">{</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       end
       <span class="token function">b</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>svm<span class="token punctuation">.</span>Ysv<span class="token operator">-</span>svm<span class="token punctuation">.</span>Xsv<span class="token operator">*</span><span class="token function">w</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span>'<span class="token punctuation">)</span><span class="token operator">/</span>svm<span class="token punctuation">.</span>svnum<span class="token punctuation">;</span>
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>三<span class="token punctuation">)</span>Step three<span class="token punctuation">:</span> 测试数据
    labels_num <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span>num
       <span class="token function">labels_num</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>test_X<span class="token operator">*</span><span class="token function">w</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token string">')'</span><span class="token operator">+</span><span class="token function">b</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>四<span class="token punctuation">)</span>Step four<span class="token punctuation">:</span> 得出分类结果
    <span class="token operator">%</span>找出每个类别所在的分类器
    labels_svm <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">40</span>
         <span class="token function">labels_svm</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">two_labels</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span>i <span class="token operator">|</span> <span class="token function">two_labels</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">==</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    <span class="token operator">%</span>统计每一类在各个分类器分类正确率
    labels <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        pro <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">40</span>
           <span class="token keyword">for</span> m <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">39</span>
               <span class="token keyword">if</span> <span class="token function">labels_num</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token function">labels_svm</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">two_labels</span><span class="token punctuation">(</span><span class="token function">labels_svm</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> j
                   <span class="token function">pro</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">pro</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
               elseif <span class="token function">labels_num</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token function">labels_svm</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">two_labels</span><span class="token punctuation">(</span><span class="token function">labels_svm</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> j
                   <span class="token function">pro</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">pro</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
               end
           end  
        end
        <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>pro<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">labels</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> index<span class="token punctuation">;</span>
    end

    <span class="token operator">%</span><span class="token punctuation">(</span>五<span class="token punctuation">)</span>Step five： 分析分类结果
    compare <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">40</span>
       <span class="token function">compare</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span> 
    end
    success_num <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span>compare<span class="token operator">==</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    success_rate <span class="token operator">=</span> success_num<span class="token operator">/</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span>打印分类正确率情况
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">'==========one-to-all==========\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' k = %d\n'</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' Crate:%f\n test_data_num: %d\n'</span><span class="token punctuation">,</span><span class="token function">Crate</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span>test_X<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token string">' success_num: %f\n success_rate: %f\n'</span><span class="token punctuation">,</span>success_num<span class="token punctuation">,</span>success_rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
</code></pre> 
  <p>  对于一对一的SVM训练模型，如何划分每一个测试集属于哪一类思路是这样的，因为关于某一个类的训练次数会有39次(以第一个人脸为例，它会和剩下的39个不同的人脸进行组合训练)，而对于每一个测试集，我们的780次训练将会得到相应的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          ω
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">ω</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>，每个测试集的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           ω
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mi>
          x
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega^Tx+b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>的值将会是不一样的。比较这40个类中，测试集在每个类对应的39次训练中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           ω
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mi>
          x
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega^Tx+b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>为正数的次数最多的即为该类。例如某一测试集在第一类人脸中对应的39次训练对应的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           ω
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mi>
          x
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega^Tx+b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>为正数的次数是30次，而在其余的人脸中对应的39次训练对应的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           ω
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mi>
          x
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \omega^Tx+b
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">b</span></span></span></span></span>为正数的次数少于30次，那么可以判断该测试集的最终结果就是第一类人脸。(讲的有点out口，需要自行体会和理解)</p> 
  <ul> 
   <li>测试结果</li> 
   <li></li> 
  </ul> 
  <table> 
   <thead> 
    <tr> 
     <th>特征贡献率</th> 
     <th>维数</th> 
     <th>正确组数</th> 
     <th>正确率</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>0.75</td> 
     <td>30</td> 
     <td>115</td> 
     <td>0.9583</td> 
    </tr> 
    <tr> 
     <td>0.80</td> 
     <td>44</td> 
     <td>115</td> 
     <td>0.9583</td> 
    </tr> 
    <tr> 
     <td>0.85</td> 
     <td>68</td> 
     <td>115</td> 
     <td>0.9583</td> 
    </tr> 
    <tr> 
     <td>0.90</td> 
     <td>111</td> 
     <td>115</td> 
     <td>0.9583</td> 
    </tr> 
    <tr> 
     <td>0.95</td> 
     <td>190</td> 
     <td>115</td> 
     <td>0.9583</td> 
    </tr> 
   </tbody> 
  </table>
  <h3><a id="3__317"></a>3. 两者模型对比</h3> 
  <p>从上述结果看来一对一模型比一对多模型的效果较好些，但总的来说这两者的效果都不是很理想的，高级教程中会有其它解决多分类的更高校的算法。一对多的不理想在于它的正负标签比例不均衡，而一对一的不理想在于它的训练次数大大增加了，因为目前只学了二分类，往后研究还得学习关于多分类的算法。</p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
