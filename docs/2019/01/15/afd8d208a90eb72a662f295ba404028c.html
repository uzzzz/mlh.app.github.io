<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>机器学习 - 期望最大（EM）算法 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="机器学习 - 期望最大（EM）算法" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/weixin_37352167/article/details/86485136 机器学习 - 期望最大（EM）算法 引述 引例 算法过程 过程推导 引述 之前我们讲过 最大似然估计 与 最大后验概率估计，这两种方法都是根据已有的数据标签 y 对参数进行估计，适用于监督学习。但是当面对无监督学习时便无从下手，因为我们并不知道样本数据服从哪个类别标签的分布。而 期望最大（Expectation Maximization）法就可针对此种情况进行应用。 EM 算法是一种迭代算法，用于含有 隐变量 的概率模型参数的极大似然估计，或极大后验概率估计（其中隐变量可视为类别标签）。我们可以将 EM 算法视为含有隐变量的概率模型参数的极大似然估计法。EM 算法的每次迭代由两步组成：E 步，求期望；M 步，求极大。 稍微具体一点，EM 算法解决两个问题： （1）样本属于哪个分布； （2）并求出每一个分布的参数。 下面看一个具体例子。 引例 问题： 假设有 3 枚硬币 A、B、C. 这些硬币正面出现的概率分别为 π 、 p 、 q π、p、q π、p、q. 进行如下抛硬币的实验，在每一次实验中： （1）先抛硬币 A，根据其结果，正面选择硬币 B，反面选择硬币 C； （2）而后抛选出的硬币，出现正面记作 1，反面记作 0. 独立重复试验 n 次（这里，n=10），最终结果为：1, 1, 0, 1, 0, 0, 1, 0, 1, 1 假设我们只能观测到结果 1 或 0，但无法观测硬币 A 的结果（即无法得知选择 B 或 C），问如何估计 3 硬币正面出现的概率 π 、 p 、 q π、p、q π、p、q。 解： 三硬币的模型可写做（一次实验）： P ( y ∣ θ ) = ∑ z ∈ { B , C } P ( y , z ∣ θ ) = ∑ z ∈ { B , C } P ( z ∣ θ ) P ( y ∣ z , θ ) = π p y ( 1 − p ) 1 − y + ( 1 − π ) q y ( 1 − q ) 1 − y \begin{aligned} P(y|θ) =&amp;amp; \sum_{z∈\{B,C\}}P(y,z|θ)=\sum_{z∈\{B,C\}}P(z|θ)P(y|z,θ)\\ =&amp;amp; πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}\\ \end{aligned} P(y∣θ)==​z∈{B,C}∑​P(y,z∣θ)=z∈{B,C}∑​P(z∣θ)P(y∣z,θ)πpy(1−p)1−y+(1−π)qy(1−q)1−y​ 其中 y 是观测变量，表示实验结果 1 或 0；z 是隐变量，表示无法观测道德硬币 A 的结果； θ = ( π , p , q ) θ=(π,p,q) θ=(π,p,q) 是模型的参数。 将观测数据表示为 Y=(y1,y2,…,yn)，未观测数据表示为 Z=(z1,z2,…,zn)，则观测数据的似然函数为： L ( y ; θ ) = ∏ j = 1 n P ( y j ∣ θ ) = ∏ j = 1 n [ π p y ( 1 − p ) 1 − y + ( 1 − π ) q y ( 1 − q ) 1 − y ] L(y;θ)=\prod_{j=1}^{n}P(y_j|θ)=\prod_{j=1}^{n}[πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}] L(y;θ)=∏j=1n​P(yj​∣θ)=∏j=1n​[πpy(1−p)1−y+(1−π)qy(1−q)1−y] 对数似然函数的极大似然估计为： θ ‾ = θ a r g &nbsp; m a x L ( y ; θ ) \overline θ=\mathop{}_{θ}^{arg~max }L(y;θ) θ=θarg&nbsp;max​L(y;θ) 此问题是没有解析解的，只有通过迭代的方法求解。EM 方法就是可以用于求解这个问题的一种迭代算法。 下面给出 EM 算法的 求解过程： 1）选取参数的初值，记作 θ ( 0 ) = ( π ( 0 ) , p ( 0 ) , q ( 0 ) ) θ^{(0)}=(π^{(0)},p^{(0)},q^{(0)}) θ(0)=(π(0),p(0),q(0)) 2）设第 i 次迭代的参数值为 θ ( i ) = ( π ( i ) , p ( i ) , q ( i ) ) θ^{(i)}=(π^{(i)},p^{(i)},q^{(i)}) θ(i)=(π(i),p(i),q(i))，则第 i+1 次的迭代如下： E 步：计算在模型参数 π ( i ) , p ( i ) , q ( i ) π^{(i)},p^{(i)},q^{(i)} π(i),p(i),q(i) 下观测数据 y j y_j yj​，来自抛硬币 B 的概率： μ j ( i + 1 ) = π ( i ) ( p ( i ) ) y j ( 1 − p ( i ) ) 1 − y j π ( i ) ( p ( i ) ) y j ( 1 − p ( i ) ) 1 − y j + ( 1 − π ) ( i ) ( q ( i ) ) y j ( 1 − q ( i ) ) 1 − y j μ_j^{(i+1)}=\frac{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j}}{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j} + (1-π)^{(i)}(q^{(i)})^{y_j}(1-q^{(i)})^{1-y_j}} μj(i+1)​=π(i)(p(i))yj​(1−p(i))1−yj​+(1−π)(i)(q(i))yj​(1−q(i))1−yj​π(i)(p(i))yj​(1−p(i))1−yj​​ （可以这样理解：硬币 B 与 硬币 C 都可以得到观测数据 yj，所以产生 yj 的概率为二者概率的和，要求结果来自硬币 B 的概率，就应用 硬币 B 的概率除以和。） M 步：计算模型参数的新估计值： （1） π ( i + 1 ) = 1 n ∑ j = 1 n μ j ( i + 1 ) π^{(i+1)}=\frac{1}{n}\sum_{j=1}^{n}μ_j^{(i+1)} π(i+1)=n1​∑j=1n​μj(i+1)​ （硬币 B 出现的概率等于硬币 A 正面出现的概率 π π π，所以对 10 次实验所得的 μ 求均值（期望）即得 π π π） （2） p ( i + 1 ) = ∑ j = 1 n μ j ( i + 1 ) y j ∑ j = 1 n μ j ( i + 1 ) p^{(i+1)}=\frac{\sum_{j=1}^{n}μ_j^{(i+1)}y_j}{\sum_{j=1}^{n}μ_j^{(i+1)}} p(i+1)=∑j=1n​μj(i+1)​∑j=1n​μj(i+1)​yj​​ （分母为选择硬币 B 的概率，分子为选择硬币 B 且抛硬币 B 的结果为 正的概率；也可认为分母为选择硬币 B 的次数，分子为选择硬币 B 且抛硬币 B 的结果为正的次数；二者相比可得硬币 B 出现正面的概率 p） （3） q ( i + 1 ) = ∑ j = 1 n [ 1 − μ j ( i + 1 ) ] y j ∑ j = 1 n [ 1 − μ j ( i + 1 ) ] q^{(i+1)}=\frac{\sum_{j=1}^{n}[1-μ_j^{(i+1)}]y_j}{\sum_{j=1}^{n}[1-μ_j^{(i+1)}]} q(i+1)=∑j=1n​[1−μj(i+1)​]∑j=1n​[1−μj(i+1)​]yj​​ （分母为选择硬币 C 的概率，分子为选择硬币 C 且抛硬币 C 的结果为 正的概率；也可认为分母为选择硬币 C 的次数，分子为选择硬币 C 且抛硬币 C 的结果为正的次数；二者相比可得硬币 C 出现正面的概率 q） 根据观测结果 1, 1, 0, 1, 0, 0, 1, 0, 1, 1 进行代数计算： 初始值 π ( 0 ) = 0.5 ， p ( 0 ) = 0.5 ， q ( 0 ) = 0.5 π^{(0)}=0.5，p^{(0)}=0.5，q^{(0)}=0.5 π(0)=0.5，p(0)=0.5，q(0)=0.5 第 1 次 迭代： E 步： μ j ( 1 ) = 0.5 μ_j^{(1)}=0.5 μj(1)​=0.5 M 步： π ( 1 ) = 0.5 ， p ( 1 ) = 0.6 ， q ( 1 ) = 0.6 π^{(1)}=0.5，p^{(1)}=0.6，q^{(1)}=0.6 π(1)=0.5，p(1)=0.6，q(1)=0.6 第 2 次 迭代： E 步： μ j ( 2 ) = 0.5 ， j = 1 , 2 , . . . , 10 μ_j^{(2)}=0.5，j=1,2,...,10 μj(2)​=0.5，j=1,2,...,10 M 步： π ( 2 ) = 0.5 ， p ( 2 ) = 0.6 ， q ( 2 ) = 0.6 π^{(2)}=0.5，p^{(2)}=0.6，q^{(2)}=0.6 π(2)=0.5，p(2)=0.6，q(2)=0.6 结果： 因为 ||θ2-θ1||&lt;ξ，其中 ξ 为较小的正数，所以迭代停止，于是得到模型参数 θ 的极大似然估计： π ∗ = 0.5 ， p ∗ = 0.6 ， q ∗ = 0.6 π^*=0.5，p^*=0.6，q^*=0.6 π∗=0.5，p∗=0.6，q∗=0.6 注意： 当初始值为 π ( 0 ) = 0.4 ， p ( 0 ) = 0.6 ， q ( 0 ) = 0.7 π^{(0)}=0.4，p^{(0)}=0.6，q^{(0)}=0.7 π(0)=0.4，p(0)=0.6，q(0)=0.7 时，最终参数极大似然估计为： π ∗ = 0.4064 ， p ∗ = 0.5368 ， q ∗ = 0.6432 π^*=0.4064，p^*=0.5368，q^*=0.6432 π∗=0.4064，p∗=0.5368，q∗=0.6432，说明 EM 算法是 初始值敏感 的。 算法过程 输入：观测变量数据 Y，隐变量 Z，联合分布 P(Y,Z|θ)，条件分布 P(Z|Y,θ) 输出：模型参数 θ 选择参数的初值 θ(0)，开始迭代 E 步：记 θ(i) 为第 i 次迭代参数 θ 的估计值，在第 i+1 次迭代的 E 步，计算： Q ( θ ∣ θ i ) = E z [ l o g P ( Y , Z ∣ θ ) ∣ Y , θ i ] = ∑ z l o g P ( Y , Z ∣ θ ) P ( Z ∣ Y , θ i ) \begin{aligned} Q(θ|θ^i)=&amp;amp;E_z[log P(Y,Z|θ)|Y,θ^i]\\ =&amp;amp;\sum_{z}logP(Y,Z|θ)P(Z|Y,θ^i) \end{aligned} Q(θ∣θi)==​Ez​[logP(Y,Z∣θ)∣Y,θi]z∑​logP(Y,Z∣θ)P(Z∣Y,θi)​ 其中， P ( Z ∣ Y , θ ( i ) ) P(Z|Y,θ^{(i)}) P(Z∣Y,θ(i)) 是在给定观测数据 Y 和当前参数估计 θ(i) 下隐变量数据 Z 的条件概率分布。 M 步：求使 Q ( θ ∣ θ i ) Q(θ|θ^i) Q(θ∣θi) 极大化的 θ，确定第 i+1 次迭代的参数的估计值 θi+1 θ i + 1 = θ a r g m a x Q ( θ ∣ θ i ) θ^{i+1}=\mathop{}_{θ}^{arg max}Q(θ|θ^i) θi+1=θargmax​Q(θ∣θi) 重复 E 步与 M 步，直到收敛，停止条件 ∣ ∣ θ 2 − θ 1 ∣ ∣ &amp;lt; ξ 1 ， 或 ∣ ∣ Q ( θ ∣ θ i + 1 ) − Q ( θ ∣ θ i ) ∣ ∣ &amp;lt; ξ 2 ， 其 中 ξ 1 ， ξ 2 为 较 小 的 正 数 ||θ^2-θ^1||&amp;lt;ξ_1，或 ||Q(θ|θ^{i+1})-Q(θ|θ^i)||&amp;lt;ξ_2，其中 ξ_1，ξ_2 为较小的正数 ∣∣θ2−θ1∣∣&lt;ξ1​，或∣∣Q(θ∣θi+1)−Q(θ∣θi)∣∣&lt;ξ2​，其中ξ1​，ξ2​为较小的正数。 其中 Q ( θ ∣ θ i ) Q(θ|θ^i) Q(θ∣θi) 是 EM 算法的核心，称为 Q 函数。 Q 函数定义：对数似然函数 P(Z|Y,θ) 关于在给定观测数据 Y 和当前参数 θ(i) 下对隐变量数据 Z 的条件概率分布 P(Z|Y,θi) 的期望称为 Q 函数，即： Q ( θ ∣ θ i ) = E z [ l o g P ( Y , Z ∣ θ ) ∣ Y , θ i ] Q(θ|θ^i)=E_z[log P(Y,Z|θ)|Y,θ^i] Q(θ∣θi)=Ez​[logP(Y,Z∣θ)∣Y,θi] 过程推导 对于含有隐变量的概率模型，目标是极大化观测数据 Y 关于参数 θ 的对数似然函数，即极大化： L ( θ ) = l o g P ( Y ∣ θ ) = l o g ∑ z P ( Y , Z ∣ θ ) = l o g ⟮ ∑ z P ( Y ∣ Z , θ ) P ( Z ∣ θ ) ⟯ \begin{aligned} L(θ)=&amp;amp;log P(Y|θ)=log\sum_{z}P(Y,Z|θ)\\ =&amp;amp;log\lgroup\sum_{z}P(Y|Z,θ)P(Z|θ)\rgroup\\ \end{aligned} L(θ)==​logP(Y∣θ)=logz∑​P(Y,Z∣θ)log⟮z∑​P(Y∣Z,θ)P(Z∣θ)⟯​ 要对其进行极大似然估计，其困难点在于包含 未观测数据 以及包含 和的对数 而 EM 算法是通过迭代逐步近似极大化 L(θ) 的。我们希望后一次的估计值 θ(i+1) 能使 L(θ) 增加，即 L(θ(i+1)) &gt; L(θ(i))，并逐步达到极大值。所以我们可以考虑两次的差值： L ( θ i + 1 ) − L ( θ i ) = l o g ⟮ ∑ z P ( Y ∣ Z , θ i + 1 ) P ( Z ∣ θ i + 1 ) ⟯ − l o g ⟮ ∑ z P ( Y ∣ Z , θ i ) P ( Z ∣ θ i ) L(θ^{i+1})-L(θ^{i})=log\lgroup\sum_{z}P(Y|Z,θ^{i+1})P(Z|θ^{i+1})\rgroup-log\lgroup\sum_{z}P(Y|Z,θ^{i})P(Z|θ^{i}) L(θi+1)−L(θi)=log⟮∑z​P(Y∣Z,θi+1)P(Z∣θi+1)⟯−log⟮∑z​P(Y∣Z,θi)P(Z∣θi) 利用 Jensen 不等式： l o g ∑ j λ j y j ≥ ∑ j λ j l o g y j ， 其 中 λ j ≥ 0 ， ∑ j λ j = 1 log\sum_{j}λ_jy_j\ge\sum_{j}λ_jlogy_j，其中 λ_j\ge0，\sum_{j}λ_j=1 log∑j​λj​yj​≥∑j​λj​logyj​，其中λj​≥0，∑j​λj​=1 L ( θ i + 1 ) − L ( θ i ) = log ⁡ ∑ z P ( Y , Z ∣ θ i + 1 ) − l o g ∑ z P ( Y , Z ∣ θ i ) = log ⁡ ⟮ ∑ z P ( Y , Z ∣ θ i + 1 ) P ( Y , Z ∣ θ i ) ⟯ = log ⁡ ⟮ ∑ z P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i ) ⟯ ≥ ∑ z P ( Z ∣ Y , θ i ) log ⁡ P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i ) \begin{aligned} L(θ^{i+1})-L(θ^{i})=&amp;amp;\log\sum_{z}P(Y,Z|θ^{i+1})-log\sum_{z}P(Y,Z|θ^i)\\ =&amp;amp;\log\lgroup\sum_{z}\frac{P(Y,Z|θ^{i+1})}{P(Y,Z|θ^i)}\rgroup\\ =&amp;amp;\log\lgroup \sum_{z}P(Z|Y,θ^{i})\frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\rgroup\\ \ge&amp;amp;\sum_{z}P(Z|Y,θ^{i}) \log \frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\\ \end{aligned} L(θi+1)−L(θi)===≥​logz∑​P(Y,Z∣θi+1)−logz∑​P(Y,Z∣θi)log⟮z∑​P(Y,Z∣θi)P(Y,Z∣θi+1)​⟯log⟮z∑​P(Z∣Y,θi)P(Z∣Y,θi)P(Y,Z∣θi)P(Y,Z∣θi+1)​⟯z∑​P(Z∣Y,θi)logP(Z∣Y,θi)P(Y,Z∣θi)P(Y,Z∣θi+1)​​ 令 J ( θ i + 1 , θ i ) = L ( θ i ) + ∑ z P ( Z ∣ Y , θ ( i ) ) log ⁡ P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ ( i ) ) P ( Y , Z ∣ θ i ) J(θ^{i+1},θ^{i})=L(θ^{i})+\sum_{z}P(Z|Y,θ^{(i)}) \log \frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{(i)})P(Y,Z|θ^i)} J(θi+1,θi)=L(θi)+∑z​P(Z∣Y,θ(i))logP(Z∣Y,θ(i))P(Y,Z∣θi)P(Y,Z∣θi+1)​ 则 L ( θ i + 1 ) ≥ J ( θ i + 1 , θ i ) L(θ^{i+1})\ge J(θ^{i+1},θ^{i}) L(θi+1)≥J(θi+1,θi) 所以此时函数 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 相当于 L ( θ i + 1 ) L(θ^{i+1}) L(θi+1) 的一个下界，且 L ( θ i ) = J ( θ i , θ i ) L(θ^i) = J(θ^i,θ^i) L(θi)=J(θi,θi)，所以，任何可以使 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 增大的 θ，也可以使 L ( θ ) L(θ) L(θ) 增大。为了使 L ( θ ) L(θ) L(θ) 有尽可能大的增长，选择 θi+1 使 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 达到，即 θ i + 1 = θ a r g m a x J ( θ i + 1 , θ i ) θ^{i+1}=\mathop{}_{θ}^{arg max}J(θ^{i+1},θ^i) θi+1=θargmax​J(θi+1,θi) 将 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 中对于 θi+1 是常数的项省去： θ i + 1 = ∑ z P ( Z ∣ Y , θ ( i ) ) P ( Y , Z ∣ θ i + 1 ) = θ a r g m a x Q ( θ i + 1 ∣ θ i ) \begin{aligned} θ^{i+1}=&amp;amp;\sum_{z}P(Z|Y,θ^{(i)})P(Y,Z|θ^{i+1})\\ =&amp;amp;\mathop{}_{θ}^{arg max}Q(θ^{i+1}|θ^i) \end{aligned} θi+1==​z∑​P(Z∣Y,θ(i))P(Y,Z∣θi+1)θargmax​Q(θi+1∣θi)​ 也就是说，极大化 Q 函数相当于极大化两次迭代的对数似然函数 L ( θ i + 1 ) − L ( θ i ) L(θ^{i+1})-L(θ^{i}) L(θi+1)−L(θi) 的差值，也就相当于在逐步近似最大化 L ( θ ) L(θ) L(θ). 且等价于 EM 算法中的一次迭代。 一种形式化地理解 EM 的算法的过程，相当于： 先固定 θold，调整 Q 函数使下界上升至 L ( θ ) L(θ) L(θ) 的值；然后固定 Q 函数，调整 θ 使下届达到最大值，此时为新的 θ；而后重复上面两步，直至收敛。 混合模型 混合模型是由多个参数不同的相似分布函数（称为分模型）组成（相当于多个盒子），且每个分模型对应一个概率（相当于各盒子被选择的概率）。首先根据概率选出分模型（选出隐变量），而后依据分模型自身的概率分布生成观测，进行多次以生成观测序列。 极大-极大算法（广义EM算法，GEM） 由 Q 函数以及隐变量 z 的分布的熵构成 F 函数，首先固定 θ 以极大化 F 函数，而后固定隐变量 z 的分布以极大化 F 函数。" />
<meta property="og:description" content="版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/weixin_37352167/article/details/86485136 机器学习 - 期望最大（EM）算法 引述 引例 算法过程 过程推导 引述 之前我们讲过 最大似然估计 与 最大后验概率估计，这两种方法都是根据已有的数据标签 y 对参数进行估计，适用于监督学习。但是当面对无监督学习时便无从下手，因为我们并不知道样本数据服从哪个类别标签的分布。而 期望最大（Expectation Maximization）法就可针对此种情况进行应用。 EM 算法是一种迭代算法，用于含有 隐变量 的概率模型参数的极大似然估计，或极大后验概率估计（其中隐变量可视为类别标签）。我们可以将 EM 算法视为含有隐变量的概率模型参数的极大似然估计法。EM 算法的每次迭代由两步组成：E 步，求期望；M 步，求极大。 稍微具体一点，EM 算法解决两个问题： （1）样本属于哪个分布； （2）并求出每一个分布的参数。 下面看一个具体例子。 引例 问题： 假设有 3 枚硬币 A、B、C. 这些硬币正面出现的概率分别为 π 、 p 、 q π、p、q π、p、q. 进行如下抛硬币的实验，在每一次实验中： （1）先抛硬币 A，根据其结果，正面选择硬币 B，反面选择硬币 C； （2）而后抛选出的硬币，出现正面记作 1，反面记作 0. 独立重复试验 n 次（这里，n=10），最终结果为：1, 1, 0, 1, 0, 0, 1, 0, 1, 1 假设我们只能观测到结果 1 或 0，但无法观测硬币 A 的结果（即无法得知选择 B 或 C），问如何估计 3 硬币正面出现的概率 π 、 p 、 q π、p、q π、p、q。 解： 三硬币的模型可写做（一次实验）： P ( y ∣ θ ) = ∑ z ∈ { B , C } P ( y , z ∣ θ ) = ∑ z ∈ { B , C } P ( z ∣ θ ) P ( y ∣ z , θ ) = π p y ( 1 − p ) 1 − y + ( 1 − π ) q y ( 1 − q ) 1 − y \begin{aligned} P(y|θ) =&amp;amp; \sum_{z∈\{B,C\}}P(y,z|θ)=\sum_{z∈\{B,C\}}P(z|θ)P(y|z,θ)\\ =&amp;amp; πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}\\ \end{aligned} P(y∣θ)==​z∈{B,C}∑​P(y,z∣θ)=z∈{B,C}∑​P(z∣θ)P(y∣z,θ)πpy(1−p)1−y+(1−π)qy(1−q)1−y​ 其中 y 是观测变量，表示实验结果 1 或 0；z 是隐变量，表示无法观测道德硬币 A 的结果； θ = ( π , p , q ) θ=(π,p,q) θ=(π,p,q) 是模型的参数。 将观测数据表示为 Y=(y1,y2,…,yn)，未观测数据表示为 Z=(z1,z2,…,zn)，则观测数据的似然函数为： L ( y ; θ ) = ∏ j = 1 n P ( y j ∣ θ ) = ∏ j = 1 n [ π p y ( 1 − p ) 1 − y + ( 1 − π ) q y ( 1 − q ) 1 − y ] L(y;θ)=\prod_{j=1}^{n}P(y_j|θ)=\prod_{j=1}^{n}[πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}] L(y;θ)=∏j=1n​P(yj​∣θ)=∏j=1n​[πpy(1−p)1−y+(1−π)qy(1−q)1−y] 对数似然函数的极大似然估计为： θ ‾ = θ a r g &nbsp; m a x L ( y ; θ ) \overline θ=\mathop{}_{θ}^{arg~max }L(y;θ) θ=θarg&nbsp;max​L(y;θ) 此问题是没有解析解的，只有通过迭代的方法求解。EM 方法就是可以用于求解这个问题的一种迭代算法。 下面给出 EM 算法的 求解过程： 1）选取参数的初值，记作 θ ( 0 ) = ( π ( 0 ) , p ( 0 ) , q ( 0 ) ) θ^{(0)}=(π^{(0)},p^{(0)},q^{(0)}) θ(0)=(π(0),p(0),q(0)) 2）设第 i 次迭代的参数值为 θ ( i ) = ( π ( i ) , p ( i ) , q ( i ) ) θ^{(i)}=(π^{(i)},p^{(i)},q^{(i)}) θ(i)=(π(i),p(i),q(i))，则第 i+1 次的迭代如下： E 步：计算在模型参数 π ( i ) , p ( i ) , q ( i ) π^{(i)},p^{(i)},q^{(i)} π(i),p(i),q(i) 下观测数据 y j y_j yj​，来自抛硬币 B 的概率： μ j ( i + 1 ) = π ( i ) ( p ( i ) ) y j ( 1 − p ( i ) ) 1 − y j π ( i ) ( p ( i ) ) y j ( 1 − p ( i ) ) 1 − y j + ( 1 − π ) ( i ) ( q ( i ) ) y j ( 1 − q ( i ) ) 1 − y j μ_j^{(i+1)}=\frac{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j}}{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j} + (1-π)^{(i)}(q^{(i)})^{y_j}(1-q^{(i)})^{1-y_j}} μj(i+1)​=π(i)(p(i))yj​(1−p(i))1−yj​+(1−π)(i)(q(i))yj​(1−q(i))1−yj​π(i)(p(i))yj​(1−p(i))1−yj​​ （可以这样理解：硬币 B 与 硬币 C 都可以得到观测数据 yj，所以产生 yj 的概率为二者概率的和，要求结果来自硬币 B 的概率，就应用 硬币 B 的概率除以和。） M 步：计算模型参数的新估计值： （1） π ( i + 1 ) = 1 n ∑ j = 1 n μ j ( i + 1 ) π^{(i+1)}=\frac{1}{n}\sum_{j=1}^{n}μ_j^{(i+1)} π(i+1)=n1​∑j=1n​μj(i+1)​ （硬币 B 出现的概率等于硬币 A 正面出现的概率 π π π，所以对 10 次实验所得的 μ 求均值（期望）即得 π π π） （2） p ( i + 1 ) = ∑ j = 1 n μ j ( i + 1 ) y j ∑ j = 1 n μ j ( i + 1 ) p^{(i+1)}=\frac{\sum_{j=1}^{n}μ_j^{(i+1)}y_j}{\sum_{j=1}^{n}μ_j^{(i+1)}} p(i+1)=∑j=1n​μj(i+1)​∑j=1n​μj(i+1)​yj​​ （分母为选择硬币 B 的概率，分子为选择硬币 B 且抛硬币 B 的结果为 正的概率；也可认为分母为选择硬币 B 的次数，分子为选择硬币 B 且抛硬币 B 的结果为正的次数；二者相比可得硬币 B 出现正面的概率 p） （3） q ( i + 1 ) = ∑ j = 1 n [ 1 − μ j ( i + 1 ) ] y j ∑ j = 1 n [ 1 − μ j ( i + 1 ) ] q^{(i+1)}=\frac{\sum_{j=1}^{n}[1-μ_j^{(i+1)}]y_j}{\sum_{j=1}^{n}[1-μ_j^{(i+1)}]} q(i+1)=∑j=1n​[1−μj(i+1)​]∑j=1n​[1−μj(i+1)​]yj​​ （分母为选择硬币 C 的概率，分子为选择硬币 C 且抛硬币 C 的结果为 正的概率；也可认为分母为选择硬币 C 的次数，分子为选择硬币 C 且抛硬币 C 的结果为正的次数；二者相比可得硬币 C 出现正面的概率 q） 根据观测结果 1, 1, 0, 1, 0, 0, 1, 0, 1, 1 进行代数计算： 初始值 π ( 0 ) = 0.5 ， p ( 0 ) = 0.5 ， q ( 0 ) = 0.5 π^{(0)}=0.5，p^{(0)}=0.5，q^{(0)}=0.5 π(0)=0.5，p(0)=0.5，q(0)=0.5 第 1 次 迭代： E 步： μ j ( 1 ) = 0.5 μ_j^{(1)}=0.5 μj(1)​=0.5 M 步： π ( 1 ) = 0.5 ， p ( 1 ) = 0.6 ， q ( 1 ) = 0.6 π^{(1)}=0.5，p^{(1)}=0.6，q^{(1)}=0.6 π(1)=0.5，p(1)=0.6，q(1)=0.6 第 2 次 迭代： E 步： μ j ( 2 ) = 0.5 ， j = 1 , 2 , . . . , 10 μ_j^{(2)}=0.5，j=1,2,...,10 μj(2)​=0.5，j=1,2,...,10 M 步： π ( 2 ) = 0.5 ， p ( 2 ) = 0.6 ， q ( 2 ) = 0.6 π^{(2)}=0.5，p^{(2)}=0.6，q^{(2)}=0.6 π(2)=0.5，p(2)=0.6，q(2)=0.6 结果： 因为 ||θ2-θ1||&lt;ξ，其中 ξ 为较小的正数，所以迭代停止，于是得到模型参数 θ 的极大似然估计： π ∗ = 0.5 ， p ∗ = 0.6 ， q ∗ = 0.6 π^*=0.5，p^*=0.6，q^*=0.6 π∗=0.5，p∗=0.6，q∗=0.6 注意： 当初始值为 π ( 0 ) = 0.4 ， p ( 0 ) = 0.6 ， q ( 0 ) = 0.7 π^{(0)}=0.4，p^{(0)}=0.6，q^{(0)}=0.7 π(0)=0.4，p(0)=0.6，q(0)=0.7 时，最终参数极大似然估计为： π ∗ = 0.4064 ， p ∗ = 0.5368 ， q ∗ = 0.6432 π^*=0.4064，p^*=0.5368，q^*=0.6432 π∗=0.4064，p∗=0.5368，q∗=0.6432，说明 EM 算法是 初始值敏感 的。 算法过程 输入：观测变量数据 Y，隐变量 Z，联合分布 P(Y,Z|θ)，条件分布 P(Z|Y,θ) 输出：模型参数 θ 选择参数的初值 θ(0)，开始迭代 E 步：记 θ(i) 为第 i 次迭代参数 θ 的估计值，在第 i+1 次迭代的 E 步，计算： Q ( θ ∣ θ i ) = E z [ l o g P ( Y , Z ∣ θ ) ∣ Y , θ i ] = ∑ z l o g P ( Y , Z ∣ θ ) P ( Z ∣ Y , θ i ) \begin{aligned} Q(θ|θ^i)=&amp;amp;E_z[log P(Y,Z|θ)|Y,θ^i]\\ =&amp;amp;\sum_{z}logP(Y,Z|θ)P(Z|Y,θ^i) \end{aligned} Q(θ∣θi)==​Ez​[logP(Y,Z∣θ)∣Y,θi]z∑​logP(Y,Z∣θ)P(Z∣Y,θi)​ 其中， P ( Z ∣ Y , θ ( i ) ) P(Z|Y,θ^{(i)}) P(Z∣Y,θ(i)) 是在给定观测数据 Y 和当前参数估计 θ(i) 下隐变量数据 Z 的条件概率分布。 M 步：求使 Q ( θ ∣ θ i ) Q(θ|θ^i) Q(θ∣θi) 极大化的 θ，确定第 i+1 次迭代的参数的估计值 θi+1 θ i + 1 = θ a r g m a x Q ( θ ∣ θ i ) θ^{i+1}=\mathop{}_{θ}^{arg max}Q(θ|θ^i) θi+1=θargmax​Q(θ∣θi) 重复 E 步与 M 步，直到收敛，停止条件 ∣ ∣ θ 2 − θ 1 ∣ ∣ &amp;lt; ξ 1 ， 或 ∣ ∣ Q ( θ ∣ θ i + 1 ) − Q ( θ ∣ θ i ) ∣ ∣ &amp;lt; ξ 2 ， 其 中 ξ 1 ， ξ 2 为 较 小 的 正 数 ||θ^2-θ^1||&amp;lt;ξ_1，或 ||Q(θ|θ^{i+1})-Q(θ|θ^i)||&amp;lt;ξ_2，其中 ξ_1，ξ_2 为较小的正数 ∣∣θ2−θ1∣∣&lt;ξ1​，或∣∣Q(θ∣θi+1)−Q(θ∣θi)∣∣&lt;ξ2​，其中ξ1​，ξ2​为较小的正数。 其中 Q ( θ ∣ θ i ) Q(θ|θ^i) Q(θ∣θi) 是 EM 算法的核心，称为 Q 函数。 Q 函数定义：对数似然函数 P(Z|Y,θ) 关于在给定观测数据 Y 和当前参数 θ(i) 下对隐变量数据 Z 的条件概率分布 P(Z|Y,θi) 的期望称为 Q 函数，即： Q ( θ ∣ θ i ) = E z [ l o g P ( Y , Z ∣ θ ) ∣ Y , θ i ] Q(θ|θ^i)=E_z[log P(Y,Z|θ)|Y,θ^i] Q(θ∣θi)=Ez​[logP(Y,Z∣θ)∣Y,θi] 过程推导 对于含有隐变量的概率模型，目标是极大化观测数据 Y 关于参数 θ 的对数似然函数，即极大化： L ( θ ) = l o g P ( Y ∣ θ ) = l o g ∑ z P ( Y , Z ∣ θ ) = l o g ⟮ ∑ z P ( Y ∣ Z , θ ) P ( Z ∣ θ ) ⟯ \begin{aligned} L(θ)=&amp;amp;log P(Y|θ)=log\sum_{z}P(Y,Z|θ)\\ =&amp;amp;log\lgroup\sum_{z}P(Y|Z,θ)P(Z|θ)\rgroup\\ \end{aligned} L(θ)==​logP(Y∣θ)=logz∑​P(Y,Z∣θ)log⟮z∑​P(Y∣Z,θ)P(Z∣θ)⟯​ 要对其进行极大似然估计，其困难点在于包含 未观测数据 以及包含 和的对数 而 EM 算法是通过迭代逐步近似极大化 L(θ) 的。我们希望后一次的估计值 θ(i+1) 能使 L(θ) 增加，即 L(θ(i+1)) &gt; L(θ(i))，并逐步达到极大值。所以我们可以考虑两次的差值： L ( θ i + 1 ) − L ( θ i ) = l o g ⟮ ∑ z P ( Y ∣ Z , θ i + 1 ) P ( Z ∣ θ i + 1 ) ⟯ − l o g ⟮ ∑ z P ( Y ∣ Z , θ i ) P ( Z ∣ θ i ) L(θ^{i+1})-L(θ^{i})=log\lgroup\sum_{z}P(Y|Z,θ^{i+1})P(Z|θ^{i+1})\rgroup-log\lgroup\sum_{z}P(Y|Z,θ^{i})P(Z|θ^{i}) L(θi+1)−L(θi)=log⟮∑z​P(Y∣Z,θi+1)P(Z∣θi+1)⟯−log⟮∑z​P(Y∣Z,θi)P(Z∣θi) 利用 Jensen 不等式： l o g ∑ j λ j y j ≥ ∑ j λ j l o g y j ， 其 中 λ j ≥ 0 ， ∑ j λ j = 1 log\sum_{j}λ_jy_j\ge\sum_{j}λ_jlogy_j，其中 λ_j\ge0，\sum_{j}λ_j=1 log∑j​λj​yj​≥∑j​λj​logyj​，其中λj​≥0，∑j​λj​=1 L ( θ i + 1 ) − L ( θ i ) = log ⁡ ∑ z P ( Y , Z ∣ θ i + 1 ) − l o g ∑ z P ( Y , Z ∣ θ i ) = log ⁡ ⟮ ∑ z P ( Y , Z ∣ θ i + 1 ) P ( Y , Z ∣ θ i ) ⟯ = log ⁡ ⟮ ∑ z P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i ) ⟯ ≥ ∑ z P ( Z ∣ Y , θ i ) log ⁡ P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i ) \begin{aligned} L(θ^{i+1})-L(θ^{i})=&amp;amp;\log\sum_{z}P(Y,Z|θ^{i+1})-log\sum_{z}P(Y,Z|θ^i)\\ =&amp;amp;\log\lgroup\sum_{z}\frac{P(Y,Z|θ^{i+1})}{P(Y,Z|θ^i)}\rgroup\\ =&amp;amp;\log\lgroup \sum_{z}P(Z|Y,θ^{i})\frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\rgroup\\ \ge&amp;amp;\sum_{z}P(Z|Y,θ^{i}) \log \frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\\ \end{aligned} L(θi+1)−L(θi)===≥​logz∑​P(Y,Z∣θi+1)−logz∑​P(Y,Z∣θi)log⟮z∑​P(Y,Z∣θi)P(Y,Z∣θi+1)​⟯log⟮z∑​P(Z∣Y,θi)P(Z∣Y,θi)P(Y,Z∣θi)P(Y,Z∣θi+1)​⟯z∑​P(Z∣Y,θi)logP(Z∣Y,θi)P(Y,Z∣θi)P(Y,Z∣θi+1)​​ 令 J ( θ i + 1 , θ i ) = L ( θ i ) + ∑ z P ( Z ∣ Y , θ ( i ) ) log ⁡ P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ ( i ) ) P ( Y , Z ∣ θ i ) J(θ^{i+1},θ^{i})=L(θ^{i})+\sum_{z}P(Z|Y,θ^{(i)}) \log \frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{(i)})P(Y,Z|θ^i)} J(θi+1,θi)=L(θi)+∑z​P(Z∣Y,θ(i))logP(Z∣Y,θ(i))P(Y,Z∣θi)P(Y,Z∣θi+1)​ 则 L ( θ i + 1 ) ≥ J ( θ i + 1 , θ i ) L(θ^{i+1})\ge J(θ^{i+1},θ^{i}) L(θi+1)≥J(θi+1,θi) 所以此时函数 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 相当于 L ( θ i + 1 ) L(θ^{i+1}) L(θi+1) 的一个下界，且 L ( θ i ) = J ( θ i , θ i ) L(θ^i) = J(θ^i,θ^i) L(θi)=J(θi,θi)，所以，任何可以使 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 增大的 θ，也可以使 L ( θ ) L(θ) L(θ) 增大。为了使 L ( θ ) L(θ) L(θ) 有尽可能大的增长，选择 θi+1 使 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 达到，即 θ i + 1 = θ a r g m a x J ( θ i + 1 , θ i ) θ^{i+1}=\mathop{}_{θ}^{arg max}J(θ^{i+1},θ^i) θi+1=θargmax​J(θi+1,θi) 将 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 中对于 θi+1 是常数的项省去： θ i + 1 = ∑ z P ( Z ∣ Y , θ ( i ) ) P ( Y , Z ∣ θ i + 1 ) = θ a r g m a x Q ( θ i + 1 ∣ θ i ) \begin{aligned} θ^{i+1}=&amp;amp;\sum_{z}P(Z|Y,θ^{(i)})P(Y,Z|θ^{i+1})\\ =&amp;amp;\mathop{}_{θ}^{arg max}Q(θ^{i+1}|θ^i) \end{aligned} θi+1==​z∑​P(Z∣Y,θ(i))P(Y,Z∣θi+1)θargmax​Q(θi+1∣θi)​ 也就是说，极大化 Q 函数相当于极大化两次迭代的对数似然函数 L ( θ i + 1 ) − L ( θ i ) L(θ^{i+1})-L(θ^{i}) L(θi+1)−L(θi) 的差值，也就相当于在逐步近似最大化 L ( θ ) L(θ) L(θ). 且等价于 EM 算法中的一次迭代。 一种形式化地理解 EM 的算法的过程，相当于： 先固定 θold，调整 Q 函数使下界上升至 L ( θ ) L(θ) L(θ) 的值；然后固定 Q 函数，调整 θ 使下届达到最大值，此时为新的 θ；而后重复上面两步，直至收敛。 混合模型 混合模型是由多个参数不同的相似分布函数（称为分模型）组成（相当于多个盒子），且每个分模型对应一个概率（相当于各盒子被选择的概率）。首先根据概率选出分模型（选出隐变量），而后依据分模型自身的概率分布生成观测，进行多次以生成观测序列。 极大-极大算法（广义EM算法，GEM） 由 Q 函数以及隐变量 z 的分布的熵构成 F 函数，首先固定 θ 以极大化 F 函数，而后固定隐变量 z 的分布以极大化 F 函数。" />
<link rel="canonical" href="https://mlh.app/2019/01/15/afd8d208a90eb72a662f295ba404028c.html" />
<meta property="og:url" content="https://mlh.app/2019/01/15/afd8d208a90eb72a662f295ba404028c.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-15T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/weixin_37352167/article/details/86485136 机器学习 - 期望最大（EM）算法 引述 引例 算法过程 过程推导 引述 之前我们讲过 最大似然估计 与 最大后验概率估计，这两种方法都是根据已有的数据标签 y 对参数进行估计，适用于监督学习。但是当面对无监督学习时便无从下手，因为我们并不知道样本数据服从哪个类别标签的分布。而 期望最大（Expectation Maximization）法就可针对此种情况进行应用。 EM 算法是一种迭代算法，用于含有 隐变量 的概率模型参数的极大似然估计，或极大后验概率估计（其中隐变量可视为类别标签）。我们可以将 EM 算法视为含有隐变量的概率模型参数的极大似然估计法。EM 算法的每次迭代由两步组成：E 步，求期望；M 步，求极大。 稍微具体一点，EM 算法解决两个问题： （1）样本属于哪个分布； （2）并求出每一个分布的参数。 下面看一个具体例子。 引例 问题： 假设有 3 枚硬币 A、B、C. 这些硬币正面出现的概率分别为 π 、 p 、 q π、p、q π、p、q. 进行如下抛硬币的实验，在每一次实验中： （1）先抛硬币 A，根据其结果，正面选择硬币 B，反面选择硬币 C； （2）而后抛选出的硬币，出现正面记作 1，反面记作 0. 独立重复试验 n 次（这里，n=10），最终结果为：1, 1, 0, 1, 0, 0, 1, 0, 1, 1 假设我们只能观测到结果 1 或 0，但无法观测硬币 A 的结果（即无法得知选择 B 或 C），问如何估计 3 硬币正面出现的概率 π 、 p 、 q π、p、q π、p、q。 解： 三硬币的模型可写做（一次实验）： P ( y ∣ θ ) = ∑ z ∈ { B , C } P ( y , z ∣ θ ) = ∑ z ∈ { B , C } P ( z ∣ θ ) P ( y ∣ z , θ ) = π p y ( 1 − p ) 1 − y + ( 1 − π ) q y ( 1 − q ) 1 − y \\begin{aligned} P(y|θ) =&amp;amp; \\sum_{z∈\\{B,C\\}}P(y,z|θ)=\\sum_{z∈\\{B,C\\}}P(z|θ)P(y|z,θ)\\\\ =&amp;amp; πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}\\\\ \\end{aligned} P(y∣θ)==​z∈{B,C}∑​P(y,z∣θ)=z∈{B,C}∑​P(z∣θ)P(y∣z,θ)πpy(1−p)1−y+(1−π)qy(1−q)1−y​ 其中 y 是观测变量，表示实验结果 1 或 0；z 是隐变量，表示无法观测道德硬币 A 的结果； θ = ( π , p , q ) θ=(π,p,q) θ=(π,p,q) 是模型的参数。 将观测数据表示为 Y=(y1,y2,…,yn)，未观测数据表示为 Z=(z1,z2,…,zn)，则观测数据的似然函数为： L ( y ; θ ) = ∏ j = 1 n P ( y j ∣ θ ) = ∏ j = 1 n [ π p y ( 1 − p ) 1 − y + ( 1 − π ) q y ( 1 − q ) 1 − y ] L(y;θ)=\\prod_{j=1}^{n}P(y_j|θ)=\\prod_{j=1}^{n}[πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}] L(y;θ)=∏j=1n​P(yj​∣θ)=∏j=1n​[πpy(1−p)1−y+(1−π)qy(1−q)1−y] 对数似然函数的极大似然估计为： θ ‾ = θ a r g &nbsp; m a x L ( y ; θ ) \\overline θ=\\mathop{}_{θ}^{arg~max }L(y;θ) θ=θarg&nbsp;max​L(y;θ) 此问题是没有解析解的，只有通过迭代的方法求解。EM 方法就是可以用于求解这个问题的一种迭代算法。 下面给出 EM 算法的 求解过程： 1）选取参数的初值，记作 θ ( 0 ) = ( π ( 0 ) , p ( 0 ) , q ( 0 ) ) θ^{(0)}=(π^{(0)},p^{(0)},q^{(0)}) θ(0)=(π(0),p(0),q(0)) 2）设第 i 次迭代的参数值为 θ ( i ) = ( π ( i ) , p ( i ) , q ( i ) ) θ^{(i)}=(π^{(i)},p^{(i)},q^{(i)}) θ(i)=(π(i),p(i),q(i))，则第 i+1 次的迭代如下： E 步：计算在模型参数 π ( i ) , p ( i ) , q ( i ) π^{(i)},p^{(i)},q^{(i)} π(i),p(i),q(i) 下观测数据 y j y_j yj​，来自抛硬币 B 的概率： μ j ( i + 1 ) = π ( i ) ( p ( i ) ) y j ( 1 − p ( i ) ) 1 − y j π ( i ) ( p ( i ) ) y j ( 1 − p ( i ) ) 1 − y j + ( 1 − π ) ( i ) ( q ( i ) ) y j ( 1 − q ( i ) ) 1 − y j μ_j^{(i+1)}=\\frac{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j}}{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j} + (1-π)^{(i)}(q^{(i)})^{y_j}(1-q^{(i)})^{1-y_j}} μj(i+1)​=π(i)(p(i))yj​(1−p(i))1−yj​+(1−π)(i)(q(i))yj​(1−q(i))1−yj​π(i)(p(i))yj​(1−p(i))1−yj​​ （可以这样理解：硬币 B 与 硬币 C 都可以得到观测数据 yj，所以产生 yj 的概率为二者概率的和，要求结果来自硬币 B 的概率，就应用 硬币 B 的概率除以和。） M 步：计算模型参数的新估计值： （1） π ( i + 1 ) = 1 n ∑ j = 1 n μ j ( i + 1 ) π^{(i+1)}=\\frac{1}{n}\\sum_{j=1}^{n}μ_j^{(i+1)} π(i+1)=n1​∑j=1n​μj(i+1)​ （硬币 B 出现的概率等于硬币 A 正面出现的概率 π π π，所以对 10 次实验所得的 μ 求均值（期望）即得 π π π） （2） p ( i + 1 ) = ∑ j = 1 n μ j ( i + 1 ) y j ∑ j = 1 n μ j ( i + 1 ) p^{(i+1)}=\\frac{\\sum_{j=1}^{n}μ_j^{(i+1)}y_j}{\\sum_{j=1}^{n}μ_j^{(i+1)}} p(i+1)=∑j=1n​μj(i+1)​∑j=1n​μj(i+1)​yj​​ （分母为选择硬币 B 的概率，分子为选择硬币 B 且抛硬币 B 的结果为 正的概率；也可认为分母为选择硬币 B 的次数，分子为选择硬币 B 且抛硬币 B 的结果为正的次数；二者相比可得硬币 B 出现正面的概率 p） （3） q ( i + 1 ) = ∑ j = 1 n [ 1 − μ j ( i + 1 ) ] y j ∑ j = 1 n [ 1 − μ j ( i + 1 ) ] q^{(i+1)}=\\frac{\\sum_{j=1}^{n}[1-μ_j^{(i+1)}]y_j}{\\sum_{j=1}^{n}[1-μ_j^{(i+1)}]} q(i+1)=∑j=1n​[1−μj(i+1)​]∑j=1n​[1−μj(i+1)​]yj​​ （分母为选择硬币 C 的概率，分子为选择硬币 C 且抛硬币 C 的结果为 正的概率；也可认为分母为选择硬币 C 的次数，分子为选择硬币 C 且抛硬币 C 的结果为正的次数；二者相比可得硬币 C 出现正面的概率 q） 根据观测结果 1, 1, 0, 1, 0, 0, 1, 0, 1, 1 进行代数计算： 初始值 π ( 0 ) = 0.5 ， p ( 0 ) = 0.5 ， q ( 0 ) = 0.5 π^{(0)}=0.5，p^{(0)}=0.5，q^{(0)}=0.5 π(0)=0.5，p(0)=0.5，q(0)=0.5 第 1 次 迭代： E 步： μ j ( 1 ) = 0.5 μ_j^{(1)}=0.5 μj(1)​=0.5 M 步： π ( 1 ) = 0.5 ， p ( 1 ) = 0.6 ， q ( 1 ) = 0.6 π^{(1)}=0.5，p^{(1)}=0.6，q^{(1)}=0.6 π(1)=0.5，p(1)=0.6，q(1)=0.6 第 2 次 迭代： E 步： μ j ( 2 ) = 0.5 ， j = 1 , 2 , . . . , 10 μ_j^{(2)}=0.5，j=1,2,...,10 μj(2)​=0.5，j=1,2,...,10 M 步： π ( 2 ) = 0.5 ， p ( 2 ) = 0.6 ， q ( 2 ) = 0.6 π^{(2)}=0.5，p^{(2)}=0.6，q^{(2)}=0.6 π(2)=0.5，p(2)=0.6，q(2)=0.6 结果： 因为 ||θ2-θ1||&lt;ξ，其中 ξ 为较小的正数，所以迭代停止，于是得到模型参数 θ 的极大似然估计： π ∗ = 0.5 ， p ∗ = 0.6 ， q ∗ = 0.6 π^*=0.5，p^*=0.6，q^*=0.6 π∗=0.5，p∗=0.6，q∗=0.6 注意： 当初始值为 π ( 0 ) = 0.4 ， p ( 0 ) = 0.6 ， q ( 0 ) = 0.7 π^{(0)}=0.4，p^{(0)}=0.6，q^{(0)}=0.7 π(0)=0.4，p(0)=0.6，q(0)=0.7 时，最终参数极大似然估计为： π ∗ = 0.4064 ， p ∗ = 0.5368 ， q ∗ = 0.6432 π^*=0.4064，p^*=0.5368，q^*=0.6432 π∗=0.4064，p∗=0.5368，q∗=0.6432，说明 EM 算法是 初始值敏感 的。 算法过程 输入：观测变量数据 Y，隐变量 Z，联合分布 P(Y,Z|θ)，条件分布 P(Z|Y,θ) 输出：模型参数 θ 选择参数的初值 θ(0)，开始迭代 E 步：记 θ(i) 为第 i 次迭代参数 θ 的估计值，在第 i+1 次迭代的 E 步，计算： Q ( θ ∣ θ i ) = E z [ l o g P ( Y , Z ∣ θ ) ∣ Y , θ i ] = ∑ z l o g P ( Y , Z ∣ θ ) P ( Z ∣ Y , θ i ) \\begin{aligned} Q(θ|θ^i)=&amp;amp;E_z[log P(Y,Z|θ)|Y,θ^i]\\\\ =&amp;amp;\\sum_{z}logP(Y,Z|θ)P(Z|Y,θ^i) \\end{aligned} Q(θ∣θi)==​Ez​[logP(Y,Z∣θ)∣Y,θi]z∑​logP(Y,Z∣θ)P(Z∣Y,θi)​ 其中， P ( Z ∣ Y , θ ( i ) ) P(Z|Y,θ^{(i)}) P(Z∣Y,θ(i)) 是在给定观测数据 Y 和当前参数估计 θ(i) 下隐变量数据 Z 的条件概率分布。 M 步：求使 Q ( θ ∣ θ i ) Q(θ|θ^i) Q(θ∣θi) 极大化的 θ，确定第 i+1 次迭代的参数的估计值 θi+1 θ i + 1 = θ a r g m a x Q ( θ ∣ θ i ) θ^{i+1}=\\mathop{}_{θ}^{arg max}Q(θ|θ^i) θi+1=θargmax​Q(θ∣θi) 重复 E 步与 M 步，直到收敛，停止条件 ∣ ∣ θ 2 − θ 1 ∣ ∣ &amp;lt; ξ 1 ， 或 ∣ ∣ Q ( θ ∣ θ i + 1 ) − Q ( θ ∣ θ i ) ∣ ∣ &amp;lt; ξ 2 ， 其 中 ξ 1 ， ξ 2 为 较 小 的 正 数 ||θ^2-θ^1||&amp;lt;ξ_1，或 ||Q(θ|θ^{i+1})-Q(θ|θ^i)||&amp;lt;ξ_2，其中 ξ_1，ξ_2 为较小的正数 ∣∣θ2−θ1∣∣&lt;ξ1​，或∣∣Q(θ∣θi+1)−Q(θ∣θi)∣∣&lt;ξ2​，其中ξ1​，ξ2​为较小的正数。 其中 Q ( θ ∣ θ i ) Q(θ|θ^i) Q(θ∣θi) 是 EM 算法的核心，称为 Q 函数。 Q 函数定义：对数似然函数 P(Z|Y,θ) 关于在给定观测数据 Y 和当前参数 θ(i) 下对隐变量数据 Z 的条件概率分布 P(Z|Y,θi) 的期望称为 Q 函数，即： Q ( θ ∣ θ i ) = E z [ l o g P ( Y , Z ∣ θ ) ∣ Y , θ i ] Q(θ|θ^i)=E_z[log P(Y,Z|θ)|Y,θ^i] Q(θ∣θi)=Ez​[logP(Y,Z∣θ)∣Y,θi] 过程推导 对于含有隐变量的概率模型，目标是极大化观测数据 Y 关于参数 θ 的对数似然函数，即极大化： L ( θ ) = l o g P ( Y ∣ θ ) = l o g ∑ z P ( Y , Z ∣ θ ) = l o g ⟮ ∑ z P ( Y ∣ Z , θ ) P ( Z ∣ θ ) ⟯ \\begin{aligned} L(θ)=&amp;amp;log P(Y|θ)=log\\sum_{z}P(Y,Z|θ)\\\\ =&amp;amp;log\\lgroup\\sum_{z}P(Y|Z,θ)P(Z|θ)\\rgroup\\\\ \\end{aligned} L(θ)==​logP(Y∣θ)=logz∑​P(Y,Z∣θ)log⟮z∑​P(Y∣Z,θ)P(Z∣θ)⟯​ 要对其进行极大似然估计，其困难点在于包含 未观测数据 以及包含 和的对数 而 EM 算法是通过迭代逐步近似极大化 L(θ) 的。我们希望后一次的估计值 θ(i+1) 能使 L(θ) 增加，即 L(θ(i+1)) &gt; L(θ(i))，并逐步达到极大值。所以我们可以考虑两次的差值： L ( θ i + 1 ) − L ( θ i ) = l o g ⟮ ∑ z P ( Y ∣ Z , θ i + 1 ) P ( Z ∣ θ i + 1 ) ⟯ − l o g ⟮ ∑ z P ( Y ∣ Z , θ i ) P ( Z ∣ θ i ) L(θ^{i+1})-L(θ^{i})=log\\lgroup\\sum_{z}P(Y|Z,θ^{i+1})P(Z|θ^{i+1})\\rgroup-log\\lgroup\\sum_{z}P(Y|Z,θ^{i})P(Z|θ^{i}) L(θi+1)−L(θi)=log⟮∑z​P(Y∣Z,θi+1)P(Z∣θi+1)⟯−log⟮∑z​P(Y∣Z,θi)P(Z∣θi) 利用 Jensen 不等式： l o g ∑ j λ j y j ≥ ∑ j λ j l o g y j ， 其 中 λ j ≥ 0 ， ∑ j λ j = 1 log\\sum_{j}λ_jy_j\\ge\\sum_{j}λ_jlogy_j，其中 λ_j\\ge0，\\sum_{j}λ_j=1 log∑j​λj​yj​≥∑j​λj​logyj​，其中λj​≥0，∑j​λj​=1 L ( θ i + 1 ) − L ( θ i ) = log ⁡ ∑ z P ( Y , Z ∣ θ i + 1 ) − l o g ∑ z P ( Y , Z ∣ θ i ) = log ⁡ ⟮ ∑ z P ( Y , Z ∣ θ i + 1 ) P ( Y , Z ∣ θ i ) ⟯ = log ⁡ ⟮ ∑ z P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i ) ⟯ ≥ ∑ z P ( Z ∣ Y , θ i ) log ⁡ P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ i ) P ( Y , Z ∣ θ i ) \\begin{aligned} L(θ^{i+1})-L(θ^{i})=&amp;amp;\\log\\sum_{z}P(Y,Z|θ^{i+1})-log\\sum_{z}P(Y,Z|θ^i)\\\\ =&amp;amp;\\log\\lgroup\\sum_{z}\\frac{P(Y,Z|θ^{i+1})}{P(Y,Z|θ^i)}\\rgroup\\\\ =&amp;amp;\\log\\lgroup \\sum_{z}P(Z|Y,θ^{i})\\frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\\rgroup\\\\ \\ge&amp;amp;\\sum_{z}P(Z|Y,θ^{i}) \\log \\frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\\\\ \\end{aligned} L(θi+1)−L(θi)===≥​logz∑​P(Y,Z∣θi+1)−logz∑​P(Y,Z∣θi)log⟮z∑​P(Y,Z∣θi)P(Y,Z∣θi+1)​⟯log⟮z∑​P(Z∣Y,θi)P(Z∣Y,θi)P(Y,Z∣θi)P(Y,Z∣θi+1)​⟯z∑​P(Z∣Y,θi)logP(Z∣Y,θi)P(Y,Z∣θi)P(Y,Z∣θi+1)​​ 令 J ( θ i + 1 , θ i ) = L ( θ i ) + ∑ z P ( Z ∣ Y , θ ( i ) ) log ⁡ P ( Y , Z ∣ θ i + 1 ) P ( Z ∣ Y , θ ( i ) ) P ( Y , Z ∣ θ i ) J(θ^{i+1},θ^{i})=L(θ^{i})+\\sum_{z}P(Z|Y,θ^{(i)}) \\log \\frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{(i)})P(Y,Z|θ^i)} J(θi+1,θi)=L(θi)+∑z​P(Z∣Y,θ(i))logP(Z∣Y,θ(i))P(Y,Z∣θi)P(Y,Z∣θi+1)​ 则 L ( θ i + 1 ) ≥ J ( θ i + 1 , θ i ) L(θ^{i+1})\\ge J(θ^{i+1},θ^{i}) L(θi+1)≥J(θi+1,θi) 所以此时函数 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 相当于 L ( θ i + 1 ) L(θ^{i+1}) L(θi+1) 的一个下界，且 L ( θ i ) = J ( θ i , θ i ) L(θ^i) = J(θ^i,θ^i) L(θi)=J(θi,θi)，所以，任何可以使 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 增大的 θ，也可以使 L ( θ ) L(θ) L(θ) 增大。为了使 L ( θ ) L(θ) L(θ) 有尽可能大的增长，选择 θi+1 使 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 达到，即 θ i + 1 = θ a r g m a x J ( θ i + 1 , θ i ) θ^{i+1}=\\mathop{}_{θ}^{arg max}J(θ^{i+1},θ^i) θi+1=θargmax​J(θi+1,θi) 将 J ( θ i + 1 , θ i ) J(θ^{i+1},θ^i) J(θi+1,θi) 中对于 θi+1 是常数的项省去： θ i + 1 = ∑ z P ( Z ∣ Y , θ ( i ) ) P ( Y , Z ∣ θ i + 1 ) = θ a r g m a x Q ( θ i + 1 ∣ θ i ) \\begin{aligned} θ^{i+1}=&amp;amp;\\sum_{z}P(Z|Y,θ^{(i)})P(Y,Z|θ^{i+1})\\\\ =&amp;amp;\\mathop{}_{θ}^{arg max}Q(θ^{i+1}|θ^i) \\end{aligned} θi+1==​z∑​P(Z∣Y,θ(i))P(Y,Z∣θi+1)θargmax​Q(θi+1∣θi)​ 也就是说，极大化 Q 函数相当于极大化两次迭代的对数似然函数 L ( θ i + 1 ) − L ( θ i ) L(θ^{i+1})-L(θ^{i}) L(θi+1)−L(θi) 的差值，也就相当于在逐步近似最大化 L ( θ ) L(θ) L(θ). 且等价于 EM 算法中的一次迭代。 一种形式化地理解 EM 的算法的过程，相当于： 先固定 θold，调整 Q 函数使下界上升至 L ( θ ) L(θ) L(θ) 的值；然后固定 Q 函数，调整 θ 使下届达到最大值，此时为新的 θ；而后重复上面两步，直至收敛。 混合模型 混合模型是由多个参数不同的相似分布函数（称为分模型）组成（相当于多个盒子），且每个分模型对应一个概率（相当于各盒子被选择的概率）。首先根据概率选出分模型（选出隐变量），而后依据分模型自身的概率分布生成观测，进行多次以生成观测序列。 极大-极大算法（广义EM算法，GEM） 由 Q 函数以及隐变量 z 的分布的熵构成 F 函数，首先固定 θ 以极大化 F 函数，而后固定隐变量 z 的分布以极大化 F 函数。","@type":"BlogPosting","url":"https://mlh.app/2019/01/15/afd8d208a90eb72a662f295ba404028c.html","headline":"机器学习 - 期望最大（EM）算法","dateModified":"2019-01-15T00:00:00+08:00","datePublished":"2019-01-15T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/01/15/afd8d208a90eb72a662f295ba404028c.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>机器学习 - 期望最大（EM）算法</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/weixin_37352167/article/details/86485136 
 </div> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p></p>
  <div class="toc">
   <h3>机器学习 - 期望最大（EM）算法</h3>
   <ul>
    <ul>
     <ul>
      <li><a href="#_2" rel="nofollow">引述</a></li>
      <li><a href="#_15" rel="nofollow">引例</a></li>
      <li><a href="#_108" rel="nofollow">算法过程</a></li>
      <li><a href="#_135" rel="nofollow">过程推导</a></li>
     </ul>
    </ul>
   </ul>
  </div>
  <p></p> 
  <ul> 
   <li> <h3><a id="_2"></a>引述</h3> <p>之前我们讲过 <a href="https://blog.csdn.net/weixin_37352167/article/details/84958019" rel="nofollow">最大似然估计 与 最大后验概率估计</a>，这两种方法都是根据已有的数据标签 y 对参数进行估计，适用于监督学习。但是当面对无监督学习时便无从下手，因为我们并不知道样本数据服从哪个类别标签的分布。而 期望最大（Expectation Maximization）法就可针对此种情况进行应用。</p> <p>EM 算法是一种迭代算法，用于含有 <strong>隐变量</strong> 的概率模型参数的极大似然估计，或极大后验概率估计（其中隐变量可视为类别标签）。我们可以将 EM 算法视为含有隐变量的概率模型参数的极大似然估计法。EM 算法的每次迭代由两步组成：<strong>E 步</strong>，求期望；<strong>M 步</strong>，求极大。</p> <p>稍微具体一点，EM 算法解决两个问题：</p> <p>（1）样本属于哪个分布；<br> （2）并求出每一个分布的参数。</p> <p>下面看一个具体例子。</p> </li> 
   <li> <h3><a id="_15"></a>引例</h3> <p><strong>问题：</strong></p> <p>假设有 3 枚硬币 A、B、C. 这些硬币正面出现的概率分别为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            π
           </mi>
           <mi mathvariant="normal">
            、
           </mi>
           <mi>
            p
           </mi>
           <mi mathvariant="normal">
            、
           </mi>
           <mi>
            q
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           π、p、q
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mord cjk_fallback">、</span><span class="mord mathit">p</span><span class="mord cjk_fallback">、</span><span class="mord mathit" style="margin-right: 0.03588em;">q</span></span></span></span></span>.<br> 进行如下抛硬币的实验，在每一次实验中：</p> <p>（1）先抛硬币 A，根据其结果，正面选择硬币 B，反面选择硬币 C；<br> （2）而后抛选出的硬币，出现正面记作 1，反面记作 0.</p> <p>独立重复试验 n 次（这里，n=10），最终结果为：1, 1, 0, 1, 0, 0, 1, 0, 1, 1</p> <p>假设我们只能观测到结果 1 或 0，但无法观测硬币 A 的结果（即无法得知选择 B 或 C），问如何估计 3 硬币正面出现的概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            π
           </mi>
           <mi mathvariant="normal">
            、
           </mi>
           <mi>
            p
           </mi>
           <mi mathvariant="normal">
            、
           </mi>
           <mi>
            q
           </mi>
          </mrow>
          <annotation encoding="application/x-tex">
           π、p、q
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mord cjk_fallback">、</span><span class="mord mathit">p</span><span class="mord cjk_fallback">、</span><span class="mord mathit" style="margin-right: 0.03588em;">q</span></span></span></span></span>。</p> 
    <hr> <p><strong>解：</strong></p> <p>三硬币的模型可写做（一次实验）：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mtable>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                y
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mo>
                =
               </mo>
              </mrow>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <munder>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <mi>
                  z
                 </mi>
                 <mo>
                  ∈
                 </mo>
                 <mo>
                  {
                 </mo>
                 <mi>
                  B
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  C
                 </mi>
                 <mo>
                  }
                 </mo>
                </mrow>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mo>
                =
               </mo>
               <munder>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <mi>
                  z
                 </mi>
                 <mo>
                  ∈
                 </mo>
                 <mo>
                  {
                 </mo>
                 <mi>
                  B
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  C
                 </mi>
                 <mo>
                  }
                 </mo>
                </mrow>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                y
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                z
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mo>
               =
              </mo>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <mi>
                π
               </mi>
               <msup>
                <mi>
                 p
                </mi>
                <mi>
                 y
                </mi>
               </msup>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <mi>
                p
               </mi>
               <msup>
                <mo>
                 )
                </mo>
                <mrow>
                 <mn>
                  1
                 </mn>
                 <mo>
                  −
                 </mo>
                 <mi>
                  y
                 </mi>
                </mrow>
               </msup>
               <mo>
                +
               </mo>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <mi>
                π
               </mi>
               <mo>
                )
               </mo>
               <msup>
                <mi>
                 q
                </mi>
                <mi>
                 y
                </mi>
               </msup>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <mi>
                q
               </mi>
               <msup>
                <mo>
                 )
                </mo>
                <mrow>
                 <mn>
                  1
                 </mn>
                 <mo>
                  −
                 </mo>
                 <mi>
                  y
                 </mi>
                </mrow>
               </msup>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
          </mtable>
          <annotation encoding="application/x-tex">
           \begin{aligned} P(y|θ) =&amp;amp; \sum_{z∈\{B,C\}}P(y,z|θ)=\sum_{z∈\{B,C\}}P(z|θ)P(y|z,θ)\\ =&amp;amp; πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}\\ \end{aligned}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.39012em; vertical-align: -1.94506em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.44506em;"><span class="" style="top: -4.44506em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span><span class="" style="top: -1.76495em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.94506em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.44506em;"><span class="" style="top: -4.44506em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.80899em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord mathit mtight" style="margin-right: 0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right: 0.07153em;">C</span><span class="mclose mtight">}</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.04398em;">z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.80899em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord mathit mtight" style="margin-right: 0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right: 0.07153em;">C</span><span class="mclose mtight">}</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.51601em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.04398em;">z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span><span class="" style="top: -1.76495em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.94506em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> <p>其中 y 是观测变量，表示实验结果 1 或 0；z 是隐变量，表示无法观测道德硬币 A 的结果；<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            θ
           </mi>
           <mo>
            =
           </mo>
           <mo>
            (
           </mo>
           <mi>
            π
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            p
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            q
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           θ=(π,p,q)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="mclose">)</span></span></span></span></span> 是模型的参数。</p> <p>将观测数据表示为 Y=(y<sub>1</sub>,y<sub>2</sub>,…,y<sub>n</sub>)，未观测数据表示为 Z=(z<sub>1</sub>,z<sub>2</sub>,…,z<sub>n</sub>)，则观测数据的似然函数为：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <mi>
            y
           </mi>
           <mo separator="true">
            ;
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <msubsup>
            <mo>
             ∏
            </mo>
            <mrow>
             <mi>
              j
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             n
            </mi>
           </msubsup>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <msubsup>
            <mo>
             ∏
            </mo>
            <mrow>
             <mi>
              j
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
            </mrow>
            <mi>
             n
            </mi>
           </msubsup>
           <mo>
            [
           </mo>
           <mi>
            π
           </mi>
           <msup>
            <mi>
             p
            </mi>
            <mi>
             y
            </mi>
           </msup>
           <mo>
            (
           </mo>
           <mn>
            1
           </mn>
           <mo>
            −
           </mo>
           <mi>
            p
           </mi>
           <msup>
            <mo>
             )
            </mo>
            <mrow>
             <mn>
              1
             </mn>
             <mo>
              −
             </mo>
             <mi>
              y
             </mi>
            </mrow>
           </msup>
           <mo>
            +
           </mo>
           <mo>
            (
           </mo>
           <mn>
            1
           </mn>
           <mo>
            −
           </mo>
           <mi>
            π
           </mi>
           <mo>
            )
           </mo>
           <msup>
            <mi>
             q
            </mi>
            <mi>
             y
            </mi>
           </msup>
           <mo>
            (
           </mo>
           <mn>
            1
           </mn>
           <mo>
            −
           </mo>
           <mi>
            q
           </mi>
           <msup>
            <mo>
             )
            </mo>
            <mrow>
             <mn>
              1
             </mn>
             <mo>
              −
             </mo>
             <mi>
              y
             </mi>
            </mrow>
           </msup>
           <mo>
            ]
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(y;θ)=\prod_{j=1}^{n}P(y_j|θ)=\prod_{j=1}^{n}[πp^y(1-p)^{1-y}+(1-π)q^y(1-q)^{1-y}]
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.24011em; vertical-align: -0.435818em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.24011em; vertical-align: -0.435818em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathit">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p> <p>对数似然函数的极大似然估计为：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mover accent="true">
            <mi>
             θ
            </mi>
            <mo stretchy="true">
             ‾
            </mo>
           </mover>
           <mo>
            =
           </mo>
           <msubsup>
            <mo></mo>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              a
             </mi>
             <mi>
              r
             </mi>
             <mi>
              g
             </mi>
             <mtext>
              &nbsp;
             </mtext>
             <mi>
              m
             </mi>
             <mi>
              a
             </mi>
             <mi>
              x
             </mi>
            </mrow>
           </msubsup>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <mi>
            y
           </mi>
           <mo separator="true">
            ;
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \overline θ=\mathop{}_{θ}^{arg~max }L(y;θ)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.89444em; vertical-align: 0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08361em; vertical-align: -0.301308em;"></span><span class="mop"><span class="mop"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7823em;"><span class="" style="top: -2.39869em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="" style="top: -3.18091em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">g</span><span class="mspace nobreak mtight"><span class="mtight">&nbsp;</span></span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></p> <p>此问题是没有解析解的，只有通过迭代的方法求解。EM 方法就是可以用于求解这个问题的一种迭代算法。</p> 
    <hr> <p>下面给出 EM 算法的 <strong>求解过程</strong>：</p> <p>1）选取参数的初值，记作 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mn>
              0
             </mn>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo>
            =
           </mo>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             π
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mn>
              0
             </mn>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             p
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mn>
              0
             </mn>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             q
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mn>
              0
             </mn>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           θ^{(0)}=(π^{(0)},p^{(0)},q^{(0)})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>2）设第 i 次迭代的参数值为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo>
            =
           </mo>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             π
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             p
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             q
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           θ^{(i)}=(π^{(i)},p^{(i)},q^{(i)})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，则第 i+1 次的迭代如下：</p> 
    <ul> 
     <li> <p><strong>E 步</strong>：计算在模型参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo separator="true">
              ,
             </mo>
             <msup>
              <mi>
               p
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo separator="true">
              ,
             </mo>
             <msup>
              <mi>
               q
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
            </mrow>
            <annotation encoding="application/x-tex">
             π^{(i)},p^{(i)},q^{(i)}
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span> 下观测数据 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msub>
              <mi>
               y
              </mi>
              <mi>
               j
              </mi>
             </msub>
            </mrow>
            <annotation encoding="application/x-tex">
             y_j
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，来自抛硬币 B 的概率：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msubsup>
              <mi>
               μ
              </mi>
              <mi>
               j
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msubsup>
             <mo>
              =
             </mo>
             <mfrac>
              <mrow>
               <msup>
                <mi>
                 π
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                (
               </mo>
               <msup>
                <mi>
                 p
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <msub>
                 <mi>
                  y
                 </mi>
                 <mi>
                  j
                 </mi>
                </msub>
               </msup>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 p
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <mrow>
                 <mn>
                  1
                 </mn>
                 <mo>
                  −
                 </mo>
                 <msub>
                  <mi>
                   y
                  </mi>
                  <mi>
                   j
                  </mi>
                 </msub>
                </mrow>
               </msup>
              </mrow>
              <mrow>
               <msup>
                <mi>
                 π
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                (
               </mo>
               <msup>
                <mi>
                 p
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <msub>
                 <mi>
                  y
                 </mi>
                 <mi>
                  j
                 </mi>
                </msub>
               </msup>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 p
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <mrow>
                 <mn>
                  1
                 </mn>
                 <mo>
                  −
                 </mo>
                 <msub>
                  <mi>
                   y
                  </mi>
                  <mi>
                   j
                  </mi>
                 </msub>
                </mrow>
               </msup>
               <mo>
                +
               </mo>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <mi>
                π
               </mi>
               <msup>
                <mo>
                 )
                </mo>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                (
               </mo>
               <msup>
                <mi>
                 q
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <msub>
                 <mi>
                  y
                 </mi>
                 <mi>
                  j
                 </mi>
                </msub>
               </msup>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <msup>
                <mi>
                 q
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <msup>
                <mo>
                 )
                </mo>
                <mrow>
                 <mn>
                  1
                 </mn>
                 <mo>
                  −
                 </mo>
                 <msub>
                  <mi>
                   y
                  </mi>
                  <mi>
                   j
                  </mi>
                 </msub>
                </mrow>
               </msup>
              </mrow>
             </mfrac>
            </mrow>
            <annotation encoding="application/x-tex">
             μ_j^{(i+1)}=\frac{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j}}{π^{(i)}(p^{(i)})^{y_j}(1-p^{(i)})^{1-y_j} + (1-π)^{(i)}(q^{(i)})^{y_j}(1-q^{(i)})^{1-y_j}}
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.45777em; vertical-align: -0.412972em;"></span><span class="mord"><span class="mord mathit">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.79893em; vertical-align: -0.637225em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1617em;"><span class="" style="top: -2.53777em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.778979em;"><span class="" style="top: -2.97144em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.03588em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.65952em;"></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.50916em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.93175em;"><span class="" style="top: -2.97144em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.03588em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.65952em;"></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.50916em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">π</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.778979em;"><span class="" style="top: -2.97144em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.03588em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.65952em;"></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.50916em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.93175em;"><span class="" style="top: -2.97144em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.03588em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.65952em;"></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.50916em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.966714em;"><span class="" style="top: -2.96671em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.966714em;"><span class="" style="top: -2.96671em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.778979em;"><span class="" style="top: -2.97144em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.03588em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.65952em;"></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.50916em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.966714em;"><span class="" style="top: -2.96671em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.93175em;"><span class="" style="top: -2.97144em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: -0.03588em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.65952em;"></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.50916em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.637225em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p>（可以这样理解：硬币 B 与 硬币 C 都可以得到观测数据 y<sub>j</sub>，所以产生 y<sub>j</sub> 的概率为二者概率的和，要求结果来自硬币 B 的概率，就应用 硬币 B 的概率除以和。）</p> </li> 
     <li> <p><strong>M 步</strong>：计算模型参数的新估计值：</p> <p>（1）<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mfrac>
              <mn>
               1
              </mn>
              <mi>
               n
              </mi>
             </mfrac>
             <msubsup>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                j
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               n
              </mi>
             </msubsup>
             <msubsup>
              <mi>
               μ
              </mi>
              <mi>
               j
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msubsup>
            </mrow>
            <annotation encoding="application/x-tex">
             π^{(i+1)}=\frac{1}{n}\sum_{j=1}^{n}μ_j^{(i+1)}
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.48062em; vertical-align: -0.435818em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> <p>（硬币 B 出现的概率等于硬币 A 正面出现的概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi>
              π
             </mi>
            </mrow>
            <annotation encoding="application/x-tex">
             π
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span>，所以对 10 次实验所得的 μ 求均值（期望）即得 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi>
              π
             </mi>
            </mrow>
            <annotation encoding="application/x-tex">
             π
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span>）</p> 
      <hr> <p>（2）<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               p
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mfrac>
              <mrow>
               <msubsup>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <mi>
                  j
                 </mi>
                 <mo>
                  =
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
                <mi>
                 n
                </mi>
               </msubsup>
               <msubsup>
                <mi>
                 μ
                </mi>
                <mi>
                 j
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <msub>
                <mi>
                 y
                </mi>
                <mi>
                 j
                </mi>
               </msub>
              </mrow>
              <mrow>
               <msubsup>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <mi>
                  j
                 </mi>
                 <mo>
                  =
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
                <mi>
                 n
                </mi>
               </msubsup>
               <msubsup>
                <mi>
                 μ
                </mi>
                <mi>
                 j
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
              </mrow>
             </mfrac>
            </mrow>
            <annotation encoding="application/x-tex">
             p^{(i+1)}=\frac{\sum_{j=1}^{n}μ_j^{(i+1)}y_j}{\sum_{j=1}^{n}μ_j^{(i+1)}}
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.24836em; vertical-align: -0.87418em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37418em;"><span class="" style="top: -2.44864em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.704686em;"><span class="" style="top: -2.17856em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -2.89714em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.460324em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: 0.195167em;"></span><span class="mord mtight"><span class="mord mathit mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05909em;"><span class="" style="top: -2.21343em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.05909em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.63282em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738543em;"><span class="" style="top: -2.17856em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.460324em;"><span class=""></span></span></span></span></span></span><span class="mspace mtight" style="margin-right: 0.195167em;"></span><span class="mord mtight"><span class="mord mathit mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05909em;"><span class="" style="top: -2.21343em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.05909em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.03588em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.87418em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p>（分母为选择硬币 B 的概率，分子为选择硬币 B 且抛硬币 B 的结果为 正的概率；也可认为分母为选择硬币 B 的次数，分子为选择硬币 B 且抛硬币 B 的结果为正的次数；二者相比可得硬币 B 出现正面的概率 p）</p> 
      <hr> <p>（3）<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               q
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mfrac>
              <mrow>
               <msubsup>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <mi>
                  j
                 </mi>
                 <mo>
                  =
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
                <mi>
                 n
                </mi>
               </msubsup>
               <mo>
                [
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <msubsup>
                <mi>
                 μ
                </mi>
                <mi>
                 j
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <mo>
                ]
               </mo>
               <msub>
                <mi>
                 y
                </mi>
                <mi>
                 j
                </mi>
               </msub>
              </mrow>
              <mrow>
               <msubsup>
                <mo>
                 ∑
                </mo>
                <mrow>
                 <mi>
                  j
                 </mi>
                 <mo>
                  =
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
                <mi>
                 n
                </mi>
               </msubsup>
               <mo>
                [
               </mo>
               <mn>
                1
               </mn>
               <mo>
                −
               </mo>
               <msubsup>
                <mi>
                 μ
                </mi>
                <mi>
                 j
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msubsup>
               <mo>
                ]
               </mo>
              </mrow>
             </mfrac>
            </mrow>
            <annotation encoding="application/x-tex">
             q^{(i+1)}=\frac{\sum_{j=1}^{n}[1-μ_j^{(i+1)}]y_j}{\sum_{j=1}^{n}[1-μ_j^{(i+1)}]}
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.24836em; vertical-align: -0.87418em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37418em;"><span class="" style="top: -2.44864em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.704686em;"><span class="" style="top: -2.17856em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -2.89714em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.460324em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05909em;"><span class="" style="top: -2.21343em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.05909em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">]</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.63282em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.738543em;"><span class="" style="top: -2.17856em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.460324em;"><span class=""></span></span></span></span></span></span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05909em;"><span class="" style="top: -2.21343em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.05909em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.461171em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">]</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.03588em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.281886em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.87418em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p>（分母为选择硬币 C 的概率，分子为选择硬币 C 且抛硬币 C 的结果为 正的概率；也可认为分母为选择硬币 C 的次数，分子为选择硬币 C 且抛硬币 C 的结果为正的次数；二者相比可得硬币 C 出现正面的概率 q）</p> </li> 
    </ul> 
    <hr> <p>根据观测结果 1, 1, 0, 1, 0, 0, 1, 0, 1, 1 进行代数计算：</p> 
    <ul> 
     <li> <p><strong>初始值</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                0
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               p
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                0
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               q
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                0
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             π^{(0)}=0.5，p^{(0)}=0.5，q^{(0)}=0.5
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span></span></p> </li> 
     <li> <p><strong>第 1 次</strong> 迭代：</p> <p>E 步：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msubsup>
              <mi>
               μ
              </mi>
              <mi>
               j
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msubsup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             μ_j^{(1)}=0.5
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.45777em; vertical-align: -0.412972em;"></span><span class="mord"><span class="mord mathit">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span></span></p> <p>M 步：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               p
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               q
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                1
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             π^{(1)}=0.5，p^{(1)}=0.6，q^{(1)}=0.6
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span></span></span></span></span></p> </li> 
     <li> <p><strong>第 2 次</strong> 迭代：</p> <p>E 步：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msubsup>
              <mi>
               μ
              </mi>
              <mi>
               j
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msubsup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <mi>
              j
             </mi>
             <mo>
              =
             </mo>
             <mn>
              1
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mn>
              2
             </mn>
             <mo separator="true">
              ,
             </mo>
             <mi mathvariant="normal">
              .
             </mi>
             <mi mathvariant="normal">
              .
             </mi>
             <mi mathvariant="normal">
              .
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mn>
              10
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             μ_j^{(2)}=0.5，j=1,2,...,10
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.45777em; vertical-align: -0.412972em;"></span><span class="mord"><span class="mord mathit">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.0448em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.2198em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mord">0</span></span></span></span></span></p> <p>M 步：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               p
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               q
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                2
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             π^{(2)}=0.5，p^{(2)}=0.6，q^{(2)}=0.6
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span></span></span></span></span></p> </li> 
     <li> <p><strong>结果</strong>：</p> <p>因为 ||θ<sup>2</sup>-θ<sup>1</sup>||&lt;ξ，其中 ξ 为较小的正数，所以迭代停止，于是得到模型参数 θ 的极大似然估计：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mo>
               ∗
              </mo>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               p
              </mi>
              <mo>
               ∗
              </mo>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               q
              </mi>
              <mo>
               ∗
              </mo>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             π^*=0.5，p^*=0.6，q^*=0.6
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span></span></span></span></span></p> </li> 
     <li> <p><strong>注意</strong>：</p> <p>当初始值为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                0
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.4
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               p
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                0
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               q
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mn>
                0
               </mn>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.7
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             π^{(0)}=0.4，p^{(0)}=0.6，q^{(0)}=0.7
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.888em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.08244em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span></span></span></span></span> 时，最终参数极大似然估计为：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               π
              </mi>
              <mo>
               ∗
              </mo>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.4064
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               p
              </mi>
              <mo>
               ∗
              </mo>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.5368
             </mn>
             <mi mathvariant="normal">
              ，
             </mi>
             <msup>
              <mi>
               q
              </mi>
              <mo>
               ∗
              </mo>
             </msup>
             <mo>
              =
             </mo>
             <mn>
              0.6432
             </mn>
            </mrow>
            <annotation encoding="application/x-tex">
             π^*=0.4064，p^*=0.5368，q^*=0.6432
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">0</span><span class="mord">6</span><span class="mord">4</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.883136em; vertical-align: -0.19444em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span><span class="mord">8</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord">4</span><span class="mord">3</span><span class="mord">2</span></span></span></span></span>，说明 EM 算法是 <strong>初始值敏感</strong> 的。</p> </li> 
    </ul> </li> 
   <li> <h3><a id="_108"></a>算法过程</h3> <p>输入：观测变量数据 Y，隐变量 Z，联合分布 P(Y,Z|θ)，条件分布 P(Z|Y,θ)</p> <p>输出：模型参数 θ</p> 
    <ul> 
     <li> <p>选择参数的初值 θ<sup>(0)</sup>，开始迭代</p> </li> 
     <li> <p>E 步：记 θ<sup>(i)</sup> 为第 i 次迭代参数 θ 的估计值，在第 i+1 次迭代的 E 步，计算：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mtable>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="true">
                <mrow>
                 <mi>
                  Q
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  θ
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                 <mo>
                  =
                 </mo>
                </mrow>
               </mstyle>
              </mtd>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="true">
                <mrow>
                 <mrow></mrow>
                 <msub>
                  <mi>
                   E
                  </mi>
                  <mi>
                   z
                  </mi>
                 </msub>
                 <mo>
                  [
                 </mo>
                 <mi>
                  l
                 </mi>
                 <mi>
                  o
                 </mi>
                 <mi>
                  g
                 </mi>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <mi>
                  θ
                 </mi>
                 <mo>
                  )
                 </mo>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  ]
                 </mo>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="true">
                <mo>
                 =
                </mo>
               </mstyle>
              </mtd>
              <mtd>
               <mstyle scriptlevel="0" displaystyle="true">
                <mrow>
                 <mrow></mrow>
                 <munder>
                  <mo>
                   ∑
                  </mo>
                  <mi>
                   z
                  </mi>
                 </munder>
                 <mi>
                  l
                 </mi>
                 <mi>
                  o
                 </mi>
                 <mi>
                  g
                 </mi>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <mi>
                  θ
                 </mi>
                 <mo>
                  )
                 </mo>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
               </mstyle>
              </mtd>
             </mtr>
            </mtable>
            <annotation encoding="application/x-tex">
             \begin{aligned} Q(θ|θ^i)=&amp;amp;E_z[log P(Y,Z|θ)|Y,θ^i]\\ =&amp;amp;\sum_{z}logP(Y,Z|θ)P(Z|Y,θ^i) \end{aligned}
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.13467em; vertical-align: -1.81734em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.31734em;"><span class="" style="top: -4.49268em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span><span class="" style="top: -2.78267em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.81734em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.31734em;"><span class="" style="top: -4.49268em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.05764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: -2.78267em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.81734em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> <p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              Z
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              Y
             </mi>
             <mo separator="true">
              ,
             </mo>
             <msup>
              <mi>
               θ
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              )
             </mo>
            </mrow>
            <annotation encoding="application/x-tex">
             P(Z|Y,θ^{(i)})
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 是在给定观测数据 Y 和当前参数估计 θ<sup>(i)</sup> 下隐变量数据 Z 的条件概率分布。</p> </li> 
     <li> <p>M 步：求使 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi>
              Q
             </mi>
             <mo>
              (
             </mo>
             <mi>
              θ
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mi>
               i
              </mi>
             </msup>
             <mo>
              )
             </mo>
            </mrow>
            <annotation encoding="application/x-tex">
             Q(θ|θ^i)
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 极大化的 θ，确定第 i+1 次迭代的参数的估计值 θ<sup>i+1</sup></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <msup>
              <mi>
               θ
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msup>
             <mo>
              =
             </mo>
             <msubsup>
              <mo></mo>
              <mi>
               θ
              </mi>
              <mrow>
               <mi>
                a
               </mi>
               <mi>
                r
               </mi>
               <mi>
                g
               </mi>
               <mi>
                m
               </mi>
               <mi>
                a
               </mi>
               <mi>
                x
               </mi>
              </mrow>
             </msubsup>
             <mi>
              Q
             </mi>
             <mo>
              (
             </mo>
             <mi>
              θ
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mi>
               i
              </mi>
             </msup>
             <mo>
              )
             </mo>
            </mrow>
            <annotation encoding="application/x-tex">
             θ^{i+1}=\mathop{}_{θ}^{arg max}Q(θ|θ^i)
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12597em; vertical-align: -0.301308em;"></span><span class="mop"><span class="mop"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7823em;"><span class="" style="top: -2.39869em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="" style="top: -3.18091em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">g</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> </li> 
     <li> <p>重复 E 步与 M 步，直到收敛，停止条件 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mn>
               2
              </mn>
             </msup>
             <mo>
              −
             </mo>
             <msup>
              <mi>
               θ
              </mi>
              <mn>
               1
              </mn>
             </msup>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mo>
              &amp;lt;
             </mo>
             <msub>
              <mi>
               ξ
              </mi>
              <mn>
               1
              </mn>
             </msub>
             <mi mathvariant="normal">
              ，
             </mi>
             <mi mathvariant="normal">
              或
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              Q
             </mi>
             <mo>
              (
             </mo>
             <mi>
              θ
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msup>
             <mo>
              )
             </mo>
             <mo>
              −
             </mo>
             <mi>
              Q
             </mi>
             <mo>
              (
             </mo>
             <mi>
              θ
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mi>
               i
              </mi>
             </msup>
             <mo>
              )
             </mo>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mo>
              &amp;lt;
             </mo>
             <msub>
              <mi>
               ξ
              </mi>
              <mn>
               2
              </mn>
             </msub>
             <mi mathvariant="normal">
              ，
             </mi>
             <mi mathvariant="normal">
              其
             </mi>
             <mi mathvariant="normal">
              中
             </mi>
             <msub>
              <mi>
               ξ
              </mi>
              <mn>
               1
              </mn>
             </msub>
             <mi mathvariant="normal">
              ，
             </mi>
             <msub>
              <mi>
               ξ
              </mi>
              <mn>
               2
              </mn>
             </msub>
             <mi mathvariant="normal">
              为
             </mi>
             <mi mathvariant="normal">
              较
             </mi>
             <mi mathvariant="normal">
              小
             </mi>
             <mi mathvariant="normal">
              的
             </mi>
             <mi mathvariant="normal">
              正
             </mi>
             <mi mathvariant="normal">
              数
             </mi>
            </mrow>
            <annotation encoding="application/x-tex">
             ||θ^2-θ^1||&amp;lt;ξ_1，或 ||Q(θ|θ^{i+1})-Q(θ|θ^i)||&amp;lt;ξ_2，其中 ξ_1，ξ_2 为较小的正数
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">或</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">中</span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">较</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">正</span><span class="mord cjk_fallback">数</span></span></span></span></span>。</p> </li> 
    </ul> <p>其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            Q
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           Q(θ|θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 是 EM 算法的核心，称为 Q 函数。</p> 
    <ul> 
     <li> <p>Q 函数定义：<strong>对数似然函数 P(Z|Y,θ) 关于在给定观测数据 Y 和当前参数 θ<sup>(i)</sup> 下对隐变量数据 Z 的条件概率分布 P(Z|Y,θ<sup>i</sup>) 的期望称为 Q 函数</strong>，即：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi>
              Q
             </mi>
             <mo>
              (
             </mo>
             <mi>
              θ
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mi>
               i
              </mi>
             </msup>
             <mo>
              )
             </mo>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               E
              </mi>
              <mi>
               z
              </mi>
             </msub>
             <mo>
              [
             </mo>
             <mi>
              l
             </mi>
             <mi>
              o
             </mi>
             <mi>
              g
             </mi>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              Y
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              Z
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              θ
             </mi>
             <mo>
              )
             </mo>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              Y
             </mi>
             <mo separator="true">
              ,
             </mo>
             <msup>
              <mi>
               θ
              </mi>
              <mi>
               i
              </mi>
             </msup>
             <mo>
              ]
             </mo>
            </mrow>
            <annotation encoding="application/x-tex">
             Q(θ|θ^i)=E_z[log P(Y,Z|θ)|Y,θ^i]
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.05764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p> </li> 
    </ul> </li> 
   <li> <h3><a id="_135"></a>过程推导</h3> <p>对于含有隐变量的概率模型，目标是极大化观测数据 Y 关于参数 θ 的对数似然函数，即极大化：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mtable>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mi>
                L
               </mi>
               <mo>
                (
               </mo>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mo>
                =
               </mo>
              </mrow>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
               <mi>
                g
               </mi>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Y
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mo>
                =
               </mo>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
               <mi>
                g
               </mi>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mo>
               =
              </mo>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
               <mi>
                g
               </mi>
               <mo>
                ⟮
               </mo>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Y
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                Z
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                θ
               </mi>
               <mo>
                )
               </mo>
               <mo>
                ⟯
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
          </mtable>
          <annotation encoding="application/x-tex">
           \begin{aligned} L(θ)=&amp;amp;log P(Y|θ)=log\sum_{z}P(Y,Z|θ)\\ =&amp;amp;log\lgroup\sum_{z}P(Y|Z,θ)P(Z|θ)\rgroup\\ \end{aligned}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.20002em; vertical-align: -2.35001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.85001em;"><span class="" style="top: -4.85001em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.35001em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.85001em;"><span class="" style="top: -4.85001em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">⟮</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mclose">⟯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.35001em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
    <hr> <p>要对其进行极大似然估计，其困难点在于包含 <strong>未观测数据</strong> 以及包含 <strong>和的对数</strong></p> <p>而 EM 算法是通过迭代逐步近似极大化 L(θ) 的。我们希望后一次的估计值 θ<sup>(i+1)</sup> 能使 L(θ) 增加，即 L(θ<sup>(i+1)</sup>) &gt; L(θ<sup>(i)</sup>)，并逐步达到极大值。所以我们可以考虑两次的差值：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            l
           </mi>
           <mi>
            o
           </mi>
           <mi>
            g
           </mi>
           <mo>
            ⟮
           </mo>
           <msub>
            <mo>
             ∑
            </mo>
            <mi>
             z
            </mi>
           </msub>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <mi>
            Y
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            Z
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <mi>
            Z
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            ⟯
           </mo>
           <mo>
            −
           </mo>
           <mi>
            l
           </mi>
           <mi>
            o
           </mi>
           <mi>
            g
           </mi>
           <mo>
            ⟮
           </mo>
           <msub>
            <mo>
             ∑
            </mo>
            <mi>
             z
            </mi>
           </msub>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <mi>
            Y
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            Z
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <mi>
            Z
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ^{i+1})-L(θ^{i})=log\lgroup\sum_{z}P(Y|Z,θ^{i+1})P(Z|θ^{i+1})\rgroup-log\lgroup\sum_{z}P(Y|Z,θ^{i})P(Z|θ^{i})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12437em; vertical-align: -0.29971em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">⟮</span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.001682em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">⟯</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.12437em; vertical-align: -0.29971em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">⟮</span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.001682em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> 
    <hr> <p>利用 Jensen 不等式：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            l
           </mi>
           <mi>
            o
           </mi>
           <mi>
            g
           </mi>
           <msub>
            <mo>
             ∑
            </mo>
            <mi>
             j
            </mi>
           </msub>
           <msub>
            <mi>
             λ
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mo>
            ≥
           </mo>
           <msub>
            <mo>
             ∑
            </mo>
            <mi>
             j
            </mi>
           </msub>
           <msub>
            <mi>
             λ
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mi>
            l
           </mi>
           <mi>
            o
           </mi>
           <mi>
            g
           </mi>
           <msub>
            <mi>
             y
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mi mathvariant="normal">
            ，
           </mi>
           <mi mathvariant="normal">
            其
           </mi>
           <mi mathvariant="normal">
            中
           </mi>
           <msub>
            <mi>
             λ
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mo>
            ≥
           </mo>
           <mn>
            0
           </mn>
           <mi mathvariant="normal">
            ，
           </mi>
           <msub>
            <mo>
             ∑
            </mo>
            <mi>
             j
            </mi>
           </msub>
           <msub>
            <mi>
             λ
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <annotation encoding="application/x-tex">
           log\sum_{j}λ_jy_j\ge\sum_{j}λ_jlogy_j，其中 λ_j\ge0，\sum_{j}λ_j=1
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.18582em; vertical-align: -0.435818em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.18582em; vertical-align: -0.435818em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">中</span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.18582em; vertical-align: -0.435818em;"></span><span class="mord">0</span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mtable>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mi>
                L
               </mi>
               <mo>
                (
               </mo>
               <msup>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msup>
               <mo>
                )
               </mo>
               <mo>
                −
               </mo>
               <mi>
                L
               </mi>
               <mo>
                (
               </mo>
               <msup>
                <mi>
                 θ
                </mi>
                <mi>
                 i
                </mi>
               </msup>
               <mo>
                )
               </mo>
               <mo>
                =
               </mo>
              </mrow>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <mi>
                log
               </mi>
               <mo>
                ⁡
               </mo>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <msup>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msup>
               <mo>
                )
               </mo>
               <mo>
                −
               </mo>
               <mi>
                l
               </mi>
               <mi>
                o
               </mi>
               <mi>
                g
               </mi>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <msup>
                <mi>
                 θ
                </mi>
                <mi>
                 i
                </mi>
               </msup>
               <mo>
                )
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mo>
               =
              </mo>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <mi>
                log
               </mi>
               <mo>
                ⁡
               </mo>
               <mo>
                ⟮
               </mo>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mfrac>
                <mrow>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    +
                   </mo>
                   <mn>
                    1
                   </mn>
                  </mrow>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
                <mrow>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
               </mfrac>
               <mo>
                ⟯
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mo>
               =
              </mo>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <mi>
                log
               </mi>
               <mo>
                ⁡
               </mo>
               <mo>
                ⟮
               </mo>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <msup>
                <mi>
                 θ
                </mi>
                <mi>
                 i
                </mi>
               </msup>
               <mo>
                )
               </mo>
               <mfrac>
                <mrow>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    +
                   </mo>
                   <mn>
                    1
                   </mn>
                  </mrow>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
                <mrow>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
               </mfrac>
               <mo>
                ⟯
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mo>
               ≥
              </mo>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <msup>
                <mi>
                 θ
                </mi>
                <mi>
                 i
                </mi>
               </msup>
               <mo>
                )
               </mo>
               <mi>
                log
               </mi>
               <mo>
                ⁡
               </mo>
               <mfrac>
                <mrow>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mrow>
                   <mi>
                    i
                   </mi>
                   <mo>
                    +
                   </mo>
                   <mn>
                    1
                   </mn>
                  </mrow>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
                <mrow>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                 <mi>
                  P
                 </mi>
                 <mo>
                  (
                 </mo>
                 <mi>
                  Y
                 </mi>
                 <mo separator="true">
                  ,
                 </mo>
                 <mi>
                  Z
                 </mi>
                 <mi mathvariant="normal">
                  ∣
                 </mi>
                 <msup>
                  <mi>
                   θ
                  </mi>
                  <mi>
                   i
                  </mi>
                 </msup>
                 <mo>
                  )
                 </mo>
                </mrow>
               </mfrac>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
          </mtable>
          <annotation encoding="application/x-tex">
           \begin{aligned} L(θ^{i+1})-L(θ^{i})=&amp;amp;\log\sum_{z}P(Y,Z|θ^{i+1})-log\sum_{z}P(Y,Z|θ^i)\\ =&amp;amp;\log\lgroup\sum_{z}\frac{P(Y,Z|θ^{i+1})}{P(Y,Z|θ^i)}\rgroup\\ =&amp;amp;\log\lgroup \sum_{z}P(Z|Y,θ^{i})\frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\rgroup\\ \ge&amp;amp;\sum_{z}P(Z|Y,θ^{i}) \log \frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{i})P(Y,Z|θ^i)}\\ \end{aligned}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 11.755em; vertical-align: -5.62751em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.12751em;"><span class="" style="top: -8.57917em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span><span class="" style="top: -5.5275em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mrel">=</span></span></span><span class="" style="top: -2.47583em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mrel">=</span></span></span><span class="" style="top: 0.575839em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mrel">≥</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.62751em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.12751em;"><span class="" style="top: -8.57917em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -5.5275em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">⟮</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.50166em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.750664em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⟯</span></span></span><span class="" style="top: -2.47583em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">⟮</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.50166em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.750664em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.750664em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⟯</span></span></span><span class="" style="top: 0.575839em;"><span class="pstrut" style="height: 3.50166em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.50166em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.750664em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.750664em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.62751em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
    <hr> <p>令</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            +
           </mo>
           <msub>
            <mo>
             ∑
            </mo>
            <mi>
             z
            </mi>
           </msub>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <mi>
            Z
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            Y
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
           <mi>
            log
           </mi>
           <mo>
            ⁡
           </mo>
           <mfrac>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              Y
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              Z
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msup>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              Z
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              Y
             </mi>
             <mo separator="true">
              ,
             </mo>
             <msup>
              <mi>
               θ
              </mi>
              <mrow>
               <mo>
                (
               </mo>
               <mi>
                i
               </mi>
               <mo>
                )
               </mo>
              </mrow>
             </msup>
             <mo>
              )
             </mo>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              Y
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              Z
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <msup>
              <mi>
               θ
              </mi>
              <mi>
               i
              </mi>
             </msup>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
           J(θ^{i+1},θ^{i})=L(θ^{i})+\sum_{z}P(Z|Y,θ^{(i)}) \log \frac{P(Y,Z|θ^{i+1})}{P(Z|Y,θ^{(i)})P(Y,Z|θ^i)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.67688em; vertical-align: -0.560425em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.001682em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.11646em;"><span class="" style="top: -2.61457em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.07153em;">Z</span><span class="mord mtight">∣</span><span class="mord mathit mtight" style="margin-right: 0.22222em;">Y</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.822036em;"><span class="" style="top: -2.82204em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.53571em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.22222em;">Y</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right: 0.07153em;">Z</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.757086em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathit mtight" style="margin-right: 0.22222em;">Y</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right: 0.07153em;">Z</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.902086em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.560425em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p>则</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            ≥
           </mo>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ^{i+1})\ge J(θ^{i+1},θ^{i})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> 
    <hr> <p>所以此时函数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           J(θ^{i+1},θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 相当于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ^{i+1})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的一个下界，且 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ^i) = J(θ^i,θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，所以，任何可以使 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           J(θ^{i+1},θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 增大的 θ，也可以使 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span> 增大。为了使 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span> 有尽可能大的增长，选择 θ<sup>i+1</sup> 使 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           J(θ^{i+1},θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 达到，即</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            =
           </mo>
           <msubsup>
            <mo></mo>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              a
             </mi>
             <mi>
              r
             </mi>
             <mi>
              g
             </mi>
             <mi>
              m
             </mi>
             <mi>
              a
             </mi>
             <mi>
              x
             </mi>
            </mrow>
           </msubsup>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           θ^{i+1}=\mathop{}_{θ}^{arg max}J(θ^{i+1},θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12597em; vertical-align: -0.301308em;"></span><span class="mop"><span class="mop"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7823em;"><span class="" style="top: -2.39869em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="" style="top: -3.18091em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">g</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> 
    <hr> <p>将 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            J
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo separator="true">
            ,
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           J(θ^{i+1},θ^i)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.09618em;">J</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 中对于 θ<sup>i+1</sup> 是常数的项省去：</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mtable>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <msup>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msup>
               <mo>
                =
               </mo>
              </mrow>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <munder>
                <mo>
                 ∑
                </mo>
                <mi>
                 z
                </mi>
               </munder>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <msup>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mo>
                  (
                 </mo>
                 <mi>
                  i
                 </mi>
                 <mo>
                  )
                 </mo>
                </mrow>
               </msup>
               <mo>
                )
               </mo>
               <mi>
                P
               </mi>
               <mo>
                (
               </mo>
               <mi>
                Y
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                Z
               </mi>
               <mi mathvariant="normal">
                ∣
               </mi>
               <msup>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msup>
               <mo>
                )
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
           <mtr>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mo>
               =
              </mo>
             </mstyle>
            </mtd>
            <mtd>
             <mstyle scriptlevel="0" displaystyle="true">
              <mrow>
               <mrow></mrow>
               <msubsup>
                <mo></mo>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mi>
                  a
                 </mi>
                 <mi>
                  r
                 </mi>
                 <mi>
                  g
                 </mi>
                 <mi>
                  m
                 </mi>
                 <mi>
                  a
                 </mi>
                 <mi>
                  x
                 </mi>
                </mrow>
               </msubsup>
               <mi>
                Q
               </mi>
               <mo>
                (
               </mo>
               <msup>
                <mi>
                 θ
                </mi>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msup>
               <mi mathvariant="normal">
                ∣
               </mi>
               <msup>
                <mi>
                 θ
                </mi>
                <mi>
                 i
                </mi>
               </msup>
               <mo>
                )
               </mo>
              </mrow>
             </mstyle>
            </mtd>
           </mtr>
          </mtable>
          <annotation encoding="application/x-tex">
           \begin{aligned} θ^{i+1}=&amp;amp;\sum_{z}P(Z|Y,θ^{(i)})P(Y,Z|θ^{i+1})\\ =&amp;amp;\mathop{}_{θ}^{arg max}Q(θ^{i+1}|θ^i) \end{aligned}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.13467em; vertical-align: -1.81734em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.31734em;"><span class="" style="top: -4.31734em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span><span class="" style="top: -1.89267em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.81734em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.31734em;"><span class="" style="top: -4.31734em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathit mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.89267em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7823em;"><span class="" style="top: -2.39869em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="" style="top: -3.18091em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">g</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.874664em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.81734em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> <p>也就是说，极大化 Q 函数相当于极大化两次迭代的对数似然函数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msup>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <msup>
            <mi>
             θ
            </mi>
            <mi>
             i
            </mi>
           </msup>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ^{i+1})-L(θ^{i})
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的差值，也就相当于在逐步近似最大化 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            L
           </mi>
           <mo>
            (
           </mo>
           <mi>
            θ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           L(θ)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span>.</p> <p>且等价于 EM 算法中的一次迭代。</p> 
    <ul> 
     <li> <p>一种形式化地理解</p> <p>EM 的算法的过程，相当于：</p> <p>先固定 θ<sup>old</sup>，调整 Q 函数使下界上升至 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
          <math>
           <semantics>
            <mrow>
             <mi>
              L
             </mi>
             <mo>
              (
             </mo>
             <mi>
              θ
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <annotation encoding="application/x-tex">
             L(θ)
            </annotation>
           </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span> 的值；然后固定 Q 函数，调整 θ 使下届达到最大值，此时为新的 θ；而后重复上面两步，直至收敛。</p> </li> 
     <li> <p>混合模型</p> <p>混合模型是由多个参数不同的相似分布函数（称为分模型）组成（相当于多个盒子），且每个分模型对应一个概率（相当于各盒子被选择的概率）。首先根据概率选出分模型（选出隐变量），而后依据分模型自身的概率分布生成观测，进行多次以生成观测序列。</p> </li> 
     <li> <p>极大-极大算法（广义EM算法，GEM）</p> <p>由 Q 函数以及隐变量 z 的分布的熵构成 F 函数，首先固定 θ 以极大化 F 函数，而后固定隐变量 z 的分布以极大化 F 函数。</p> </li> 
    </ul> </li> 
  </ul> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
