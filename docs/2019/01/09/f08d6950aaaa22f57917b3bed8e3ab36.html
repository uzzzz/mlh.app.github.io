<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>NetVLAD相关论文阅读与总结 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="NetVLAD相关论文阅读与总结" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：未经博主允许不得转载 https://blog.csdn.net/qq_24954345/article/details/86176862 论文阅读报告 论文选择 [a] NetVLAD: CNN architecture for weakly supervised place recognition (CVPR 2016) [b] ActionVLAD: Learning spatio-temporal aggregation for action classification (CVPR 2017) [c] GhostVLAD for set-based face recognition (ACCV 2018) 报告内容概要 本文主要针对VLAD（Vector of locally aggregated descriptors，局部聚合向量）进行探索，这是一种传统的特征提取方法。NetVLAD这篇文章将其融合到CNN卷积网络中去，本文将对其网络中VLAD层做详细介绍，并且围绕上述的相关论文结合其应用特点与改进措施展开探索。第一篇文章本文主要围绕其原理方法介绍，后两篇文章主要针对其具体应用与改进作进一步分析。 什么是VLAD？ VLAD（Vector of locally aggregated descriptors，局部聚合向量）是一种类似于BOF（bag-of-feature）的描述图像的特征方法，可以理解是将局部特征表示成全局特征的编码方法。在这之前，BoF（词袋模型）通常用来描述基于Sift局部特征，在图像检索和分类中有着广泛的应用。相比于BoF，VLAD更加能够对图像的准确表达，得到更具有判别能力的特征，并且便于降维（PCA），同时降维对准确率的影响也较小。类似的方法还有，如FV（Fisher vector），这些传统的方法不具备可导性，因而无法进行反向传播，随着深度学习的普及逐渐被CNN所取代。 论文NetVLAD[a] 论文核心：文中提出一种卷积神经网络结构，可以实现端到端的识别。主要创新点是将传统的VLAD结构嵌入到CNN网络结构中去，得到一个新的VLAD层。NetVLAD可以很容易的运用到任何的CNN结构中，并且可以使用反向传播进行优化。 介绍 这篇文章主要针对地点识别问题来进行的研究。地点识别存在着一个很大的挑战是，在光照等其它因素影响下，即便是同一个地点图像之间的差异也是非常大。关键问题是如何找到这样一个具有代表性且具有区分性特征的表达。传统做法是将地点识别问题看作实例检索任务，使用具有不变性特征（SIFT）来表示每一个图像，然后将特征聚合成一个向量表示，这些向量通常对图像具有一定的代表和区分性，方法有BOW，VLAD，FV等。随着近些年卷积网络的不断发展，CNN对图像的表达能力已经非常可观并且有效。虽然CNN能够用在较大的数据集上，但是如果直接迁移使用CNN，那么它作为一个黑盒来提取图像特征，但很大程度上会限制示例级别（instance-level）上的识别任务。所以这篇文章主要抓的问题是： 如何定义一个好的网络结构 怎样获取足够多的标注数据 怎么训练来提升结构性能 第一，基于现有的神经网络架构，文章提出一个带有VLAD层的卷积神经网络模型 NetVLAD，它可以被加到任何的CNN结构中，并且可以使用BP算法优化。 第二，为了训练网络，收集了大量不同时间不同角度相同地点的全景图。通过这些数据进行训练是若监督学习，因为我们知道这些地点很接近，但是并不知道图像中的哪个部分决定了这两幅全景图是同一个地方。 第三，使用端到端的方式来学习模型参数，得到的描述特征对于视角和光照情况具有非常高的鲁棒性。 主要方法 局部聚合向量（VLAD）是广泛应用在示例检索与图像分类中的一种描述池化方法，它能够抓取图像中局部特征在图像中聚合的统计信息。视觉词袋聚合是记录每个词的数目，而VLAD是记录每个词的残差和。 给定 N N N 个D维局部图像描述子 x i x_i xi​作为输入， K K K 个聚类中心作为 c k c_k ck​ 作为VLAD的参数，VLAD的输出是一个 K × D K×D K×D维的图像描述向量，为了方便记作 V V V 是一个 K × D K×D K×D 的矩阵，但是这个矩阵被转换成向量表示，然后在进行归一化，计算公式如下： V ( j , k ) = ∑ i = 1 N a k ( x i ) ( x i ( j ) − c k ( j ) ) V(j,k) = \sum_{i=1}^N {a_k(\text{x}_i)(x_i(j)-c_k(j))} V(j,k)=i=1∑N​ak​(xi​)(xi​(j)−ck​(j)) 其中， x i ( j ) x_i(j) xi​(j) 和 c k ( j ) c_k(j) ck​(j) 表示是第 i i i 个局部描述子和第 k k k 个聚类中心的第 j j j 个特征值。 a k ( x i ) a_k(\text{x}_i) ak​(xi​) 我们可以简单理解为第i个局部特征属于第k个聚类的权重，也就是说，如果它的值等于1就说明它属于这个聚类的簇。如果是传统方法的VLAD，那么这个值只能是1或者0。直观上看，$ V$ 表征着所有局部特征在每一个聚类簇上的残差 ( x i − c k ) (\text{x}_i-\text{c}_k) (xi​−ck​)和。 在传统的VLAD中，由于 a k ( x i ) a_k(\text{x}_i) ak​(xi​)是一个不连续的值，取值为1或0，并且满足 ∑ i = 1 K a k ( x i ) = 1 \sum_{i=1}^K a_k(\text{x}_i)=1 ∑i=1K​ak​(xi​)=1，使得不能进行反向传播，文章采用一种近似的方式，来对 a k ( x i ) a_k(\text{x}_i) ak​(xi​) 做软分配（soft assignment）如下式： a ‾ k ( x i ) = e − α ∥ x i − c k ∥ 2 ∑ k ′ e − α ∥ x i − c k ′ ∥ 2 \overline{a}_k(\text{x}_i)=\frac{e^{-\alpha\|\text{x}_i-\text{c}_k\|^2}}{\sum_{k&amp;#x27;} e^{-\alpha\|\text{x}_i-\text{c}_{k&amp;#x27;}\|^2}} ak​(xi​)=∑k′​e−α∥xi​−ck′​∥2e−α∥xi​−ck​∥2​ 这个权重的分配可以把它当作一个模糊聚类的分配方式，根据每个局部特征到聚类中心的距离来生成一个概率函数权重。对于一个局部特征描述 x i \text{x}_i xi​ 在每个聚类簇下的权重的范围在0~1之间，权重最高的可以理解为该特征离聚类簇中心的聚类最近，权重低说明其离簇中心较远。可以注意到，当 α → + ∞ \alpha \to +\infty α→+∞ 时，这个式子就表示着原始的VLAD结构。 进一步地，可以将上式进行平方展开, e.g. ( a + b ) 2 = a 2 + b 2 + 2 a b (a+b)^2=a^2+b^2+2ab (a+b)2=a2+b2+2ab ，可以得到下式： a ‾ k ( x i ) = e w k T x i + b k ∑ k ′ e w k ′ T x i + b k ′ \overline{a}_k(\text{x}_i)=\frac{e^{\text{w}_k^T\text{x}_i+b_k}}{\sum_{k&amp;#x27;} e^{\text{w}_{k&amp;#x27;}^T\text{x}_i+b_{k&amp;#x27;}}} ak​(xi​)=∑k′​ewk′T​xi​+bk′​ewkT​xi​+bk​​ 其中， w k ′ = 2 α c k , b k = − α ∥ c k ∥ 2 \text{w}_{k&amp;#x27;}=2\alpha\text{c}_k,b_k=-\alpha\|\text{c}_k\|^2 wk′​=2αck​,bk​=−α∥ck​∥2,最终，我们可以得到VLAD特征向量为: V ( j , k ) = ∑ i = 1 N e w k T x i + b k ∑ k ′ e w k ′ T x i + b k ′ ( x i ( j ) − c k ( j ) ) V(j,k) = \sum_{i=1}^N {\frac{e^{\text{w}_k^T\text{x}_i+b_k}}{\sum_{k&amp;#x27;} e^{\text{w}_{k&amp;#x27;}^T\text{x}_i+b_{k&amp;#x27;}}}(x_i(j)-c_k(j))} V(j,k)=i=1∑N​∑k′​ewk′T​xi​+bk′​ewkT​xi​+bk​​(xi​(j)−ck​(j)) 可以看出，式中的参数 w k , b k , \text{w}_k,b_k, wk​,bk​, 以及$ \text{c}_k$ 都是可以训练的，和原始的VLAD很近似，NetVLAD通过这种在不同聚类簇上的软分配（soft-assignment）方式,能够有效的聚合了局部特征空间中不同部分（聚类）的一阶残差的统计量。另外我们可以注意到，NetVLAD中包含着三个参数， w k , b k , \text{w}_k,b_k, wk​,bk​, 和 c k \text{c}_k ck​，原始VLAD中只有一个参数 c k \text{c}_k ck​ ，这使得NetVLAD相对于传统的方法具有更加的灵活性，并且所有的参数在特定的任``务下可以通过端到端的方式来学习得到。 图1. CNN结构图 由图1可以看出，NetVLAD 层可以直接接在卷积网络中的最后一层（ H × W × D H×W×D H×W×D）上，把最后一层的特征图看作 N N N 个密集的 D D D 维局部描述子。soft-assignment过程可以分为两个步骤：1). 通过K个滤波器 { w k } \{\text{w}_k\} {wk​} 将N×D矩阵来学到 s k ( x i ) = w k T x i + b k s_k(\text{x}_i)=\text{w}_k^T\text{x}_i+b_k sk​(xi​)=wkT​xi​+bk​ ; 2). 卷积输出然后经过一个soft-max 函数，来生成 a ‾ k ( x i ) \overline{a}_k(\text{x}_i) ak​(xi​) 。 总结 这篇文章通过结合传统的特征提取方法，设计了NetVLAD这种网络结构，使得网络更加有效的利用卷积特征，能够有效的提高对同类别图像的表达能力，并提高分类的区分能力。这也是这篇文章最大的贡献。基于这种网络框架，后续有着很多的别的方向上的应用，如论文[2]、[3]等。 论文ActionVLAD[2] 这是一篇发表在CVPR2017年的关于行为识别的文章。行为识别的任务不同于图像分类，图像分类只是单单在图像上提取特征。而关于行为的，输入是一段视频，其重点在于对时间和空间上的特征提取，这篇文章在时间空间上分别独立提取特征，然后以VLAD的方式做pooling聚合，利用NetVLAD网络结构形成端到端训练。 动机 图2. 一个行为的描述 在一段视频中虽然是单一的动作分类，但是可能有多个不同的子类特征，例如投篮动作上有hoop, jump, group, throw, ball, running 等多个特征，所以需要一种方式把这些局部特征聚合到一个行为特征中去，用来分类。 行为特征提取 在以往的工作中，通常是是用卷积网络来提取空间上的特征，例如分别对不同帧做卷积。而时间上的特征最常见的还是利用光流的方法，光流是根据相邻帧之间的变化人为提取的特征信息，并且以2D图像的方式表示出来，因此基于双流的方法是目前行为识别中，非常有效的方法之一。这篇文章利用双流法的方式，对图像及其光流特征分别进行提取并聚合。关于特征聚合的方式像VLAD和FV这种，前文已经提到，这篇文章采用了论文[a]中提出的方法，将NetVLAD层网络用在行为识别网络中去。 可训练的时空聚合网络 图3. 网络结构图 有图3 可以看出，网络结构是对多帧图像进行的卷积操作，同时，光流图像也做同样操作。先只考虑RGB流的网络，因为是对多帧图像做的卷积，所以说会出现多帧图像下的卷积特征图。和论文[a]中的单个特征图不同，因此我们对公式（4）来做一个改进，是NetVLAD可以有效适用多个特征图。如下式： V ( j , k ) = ∑ t = 1 T ∑ i = 1 N e − α ∥ x i t − c k ∥ 2 ∑ k ′ e − α ∥ x i t − c k ′ ∥ 2 ⎵ Soft-assignment ( x i t ( j ) − c k ( j ) ) ⎵ Residual V(j,k) = \sum_{t=1}^T\sum_{i=1}^N \underbrace{\frac{e^{-\alpha\|\text{x}_{it}-\text{c}_k\|^2}}{\sum_{k&amp;#x27;} e^{-\alpha\|\text{x}_{it}-\text{c}_{k&amp;#x27;}\|^2}}}_\text{Soft-assignment}\underbrace{(x_{it}(j)-c_k(j))}_\text{Residual} V(j,k)=t=1∑T​i=1∑N​Soft-assignment ∑k′​e−α∥xit​−ck′​∥2e−α∥xit​−ck​∥2​​​Residual (xit​(j)−ck​(j))​​ 其中, x i t x_{it} xit​ 表示第 t t t 帧图像第 i i i 个特征描述子。 i ∈ 1 , 2 , … , N i\in{1,2,\ldots,N} i∈1,2,…,N， t ∈ 1 , 2 , … , T t\in{1,2,\ldots,T} t∈1,2,…,T 。可以看出，相对于论文[a]，这里将特征维度增加了一维，两个求和操作说明是在时间和空间上进行特征聚合，原理和操作方式不变，还是直接利用卷积计算得到特征的特征分布的统计量。 RGB流与光流的结合 由于网络是采用的双流法的结构，因此需要对双流进行结合。这篇文章设计了3种结合方式并进行对比。结合方式如图4所示 图4. 对双流结构的不同融合策略 1. 对RGB流和光流输出的特征图直接串接，实质也就是肯定了其在空间特征上的一致性。然后用一个单独的ActionVLAD层接进串接后的特征图。 2. 将所有的特征，全部直接做特征聚合，接到ActionVLAD中去。 3. 第三种方式，分别对，rgb流和光流做actionVLAD，最后在融合分类。 论文中对其进行实验对比，结果表明第三种结合的方式最好，这在一定程度上表明了，光流与rgb流的特征差异较大，不适合在一起构建词典。因此最终采用了第三种方式（Late fusion）通过最后的实现对比，可以看出这种方法的优势非常明显。如下表所示： 实验结果与其它方法对比 ##### 可视化分析 图中描述的是一个 ‘action words’ (聚类得到)的可视化。每一排代表不同视频中的帧，其中高亮的部分对应着特征图的感受野范围。进一步说，（a）展现的 ‘action word’ 是一个人手持这一个东西。（b）就是人的头发。© 像是一个圆形的像轮子一样的东西。等等。 总结 这篇文章针对行为识别任务，有效的将时空局部特征聚合，利用VLAD建立端到端可训练网络。 论文GhostVLAD[c] 这篇文章是DeepMind联合VGG组共同的研究成果。主要针对人脸识别的问题利用VLAD方法开展的研究。 动机 在人脸识别应用中，很多场景能够获取某一个体的多幅人脸图像的集合（比如在监控视频中），适用人脸图像集来做识别，这个问题被称为基于模板的人脸识别（template-based face recognition）。对于多幅图像，当然可以使用单幅人脸图像的识别方法，综合多幅图像的识别结果确定最终的人脸识别结果，但更好的方式是直接基于人脸图像集提取特征，比较人脸图像集的特征相似性。这涉及到如何聚合多幅人脸图像的特征向量成为一个特征向量，使该特征紧凑而又更具鉴别性的问题。 思路与原理 这篇文章作者的想法非常简单，当聚合多个人脸图像特征时，现有的平均池化等方法没能考虑到人脸图像集中一些低质量的图像（比如模糊人脸）的作用，这些图像含有的信息对识别并没有太大的贡献，应该降低这些低质量图像对最终聚合特征的贡献。一种直接的处理方法是，在人脸图像预处理阶段将低质量图像找出来，降低其贡献权重，但作者认为，端到端自动训练的方式让网络自身去优化识别并降低该部分样本的权重更好。 网络结构如上图所示，网络的输入是同一个人多个人脸图像，每次的图像个数可以不同，可以通过CNN网络提取每个图像的特征。这里要注意的是，与论文a和b不同，这里CNN提取的特征不在是卷积层特征，而是每个图像对应的全连接层特征，因为这里要聚合的是不同图像的特征，而不是论文a和b中所提到的的局部特征描述子。将提取得到的特征进行L2归一化处理，再送入到聚合模块。GhostVLAD聚合模块和VLAD原理几乎一样，能够将多个人脸的特征聚合成固定维数的特征矩阵（与图像的输入个数无关），再通过全连接层FC、BN、L2归一化维紧凑的鉴别特征。 其中的关键网络模块GhostVLAD既实现特征聚合，同时降低低质量图像的权重，提高高质量图像的聚合权重。说白了一句话，既然不要人为参与，那就要构建一种网络结构，让网络自动学习对识别不重要的信息，并丢掉它。作者是在NetVLAD上做出的算法改进，前文已提到，NetVLAD可以理解为一种可微分完全可训练的VLAD编码聚合方法，它的作用大致是自动计算特征聚类中心，计算残差，然后把残差加权，构建聚合特征矩阵，整个过程方便加入到神经网络中。 GhostVLAD的改进则是增加聚类中心的个数到K+G，但是增加的聚类中心在构建聚合特征矩阵的时候不参与贡献权重。如下图所示： 红色位置即标示出的Ghost 聚类中心，后续步骤中被去除，Ghost有“幻象”的意思，可能很多模糊的人脸的确看起来是“幻象”，这也是GhostVLAD名称的由来。这些多出来的不参与聚合特征矩阵构建的Ghost聚类中心，就相当于给了神经网络丢弃一部分信息使得网络更具鉴别性的可能，而在原来的NetVLAD中是体现不出来的。 实验结果 作者首先设计的实验是比较网络加上GhostVLAD层跟不加的精度，验证其有效性，作者使用的训练集是VGGFace2。实验设置不再赘述，这里直接给出结果。 在IJB-B数据集上的1:1人脸验证结果比较如下图，取得了大幅度的精度提升。 在IJB-B数据集上的1:N人脸识别结果比较如下图，同样取得了大幅度的精度提升。 最后作者可视化了使用GhostVLAD后对输入样本权重的影响，发现对于那些低质量模糊人脸的确权重被降低了。如下图所示： 总结 这篇文章从一个简单的直觉开始，构建了一种帮助神经网络丢弃鉴别性不足的信息的有效方式，大幅改进了基于图像集合的人脸识别方法，算法具有较高的实用价值，思想也很值得借鉴！ 值得一提的是，该文中的GhostVLAD方法不仅仅适用于人脸识别，在图像检索、行人重识别等领域也同样适用。 报告总结 这三篇论文都是围绕着VLAD来进行的研究，可以说是论文b和c都是在基于论文a提出的方法对不同的应用领域开展的探索。关于NetVLAD的应用其实也不止这些，如ECCV2018年一篇文章利用NetVLAD方法，将局部点云特征进行聚合，很好了提升了3D目标识别效果。 总的来说，这些应用都离不开VLAD本质上的特点： 可以理解成一种Pooling的方式，即将多个维度不同的特征聚合，生成一个能够有效描述这些特征集的向量。 或者可以理解成一个多示例（multi-instance）问题，在把众多的特征比作多个示例，这些示例特征，哪些能够对分类有效，哪些没有用，我们可以用VLAD来自行挑选具有辨识能力的instance。" />
<meta property="og:description" content="版权声明：未经博主允许不得转载 https://blog.csdn.net/qq_24954345/article/details/86176862 论文阅读报告 论文选择 [a] NetVLAD: CNN architecture for weakly supervised place recognition (CVPR 2016) [b] ActionVLAD: Learning spatio-temporal aggregation for action classification (CVPR 2017) [c] GhostVLAD for set-based face recognition (ACCV 2018) 报告内容概要 本文主要针对VLAD（Vector of locally aggregated descriptors，局部聚合向量）进行探索，这是一种传统的特征提取方法。NetVLAD这篇文章将其融合到CNN卷积网络中去，本文将对其网络中VLAD层做详细介绍，并且围绕上述的相关论文结合其应用特点与改进措施展开探索。第一篇文章本文主要围绕其原理方法介绍，后两篇文章主要针对其具体应用与改进作进一步分析。 什么是VLAD？ VLAD（Vector of locally aggregated descriptors，局部聚合向量）是一种类似于BOF（bag-of-feature）的描述图像的特征方法，可以理解是将局部特征表示成全局特征的编码方法。在这之前，BoF（词袋模型）通常用来描述基于Sift局部特征，在图像检索和分类中有着广泛的应用。相比于BoF，VLAD更加能够对图像的准确表达，得到更具有判别能力的特征，并且便于降维（PCA），同时降维对准确率的影响也较小。类似的方法还有，如FV（Fisher vector），这些传统的方法不具备可导性，因而无法进行反向传播，随着深度学习的普及逐渐被CNN所取代。 论文NetVLAD[a] 论文核心：文中提出一种卷积神经网络结构，可以实现端到端的识别。主要创新点是将传统的VLAD结构嵌入到CNN网络结构中去，得到一个新的VLAD层。NetVLAD可以很容易的运用到任何的CNN结构中，并且可以使用反向传播进行优化。 介绍 这篇文章主要针对地点识别问题来进行的研究。地点识别存在着一个很大的挑战是，在光照等其它因素影响下，即便是同一个地点图像之间的差异也是非常大。关键问题是如何找到这样一个具有代表性且具有区分性特征的表达。传统做法是将地点识别问题看作实例检索任务，使用具有不变性特征（SIFT）来表示每一个图像，然后将特征聚合成一个向量表示，这些向量通常对图像具有一定的代表和区分性，方法有BOW，VLAD，FV等。随着近些年卷积网络的不断发展，CNN对图像的表达能力已经非常可观并且有效。虽然CNN能够用在较大的数据集上，但是如果直接迁移使用CNN，那么它作为一个黑盒来提取图像特征，但很大程度上会限制示例级别（instance-level）上的识别任务。所以这篇文章主要抓的问题是： 如何定义一个好的网络结构 怎样获取足够多的标注数据 怎么训练来提升结构性能 第一，基于现有的神经网络架构，文章提出一个带有VLAD层的卷积神经网络模型 NetVLAD，它可以被加到任何的CNN结构中，并且可以使用BP算法优化。 第二，为了训练网络，收集了大量不同时间不同角度相同地点的全景图。通过这些数据进行训练是若监督学习，因为我们知道这些地点很接近，但是并不知道图像中的哪个部分决定了这两幅全景图是同一个地方。 第三，使用端到端的方式来学习模型参数，得到的描述特征对于视角和光照情况具有非常高的鲁棒性。 主要方法 局部聚合向量（VLAD）是广泛应用在示例检索与图像分类中的一种描述池化方法，它能够抓取图像中局部特征在图像中聚合的统计信息。视觉词袋聚合是记录每个词的数目，而VLAD是记录每个词的残差和。 给定 N N N 个D维局部图像描述子 x i x_i xi​作为输入， K K K 个聚类中心作为 c k c_k ck​ 作为VLAD的参数，VLAD的输出是一个 K × D K×D K×D维的图像描述向量，为了方便记作 V V V 是一个 K × D K×D K×D 的矩阵，但是这个矩阵被转换成向量表示，然后在进行归一化，计算公式如下： V ( j , k ) = ∑ i = 1 N a k ( x i ) ( x i ( j ) − c k ( j ) ) V(j,k) = \sum_{i=1}^N {a_k(\text{x}_i)(x_i(j)-c_k(j))} V(j,k)=i=1∑N​ak​(xi​)(xi​(j)−ck​(j)) 其中， x i ( j ) x_i(j) xi​(j) 和 c k ( j ) c_k(j) ck​(j) 表示是第 i i i 个局部描述子和第 k k k 个聚类中心的第 j j j 个特征值。 a k ( x i ) a_k(\text{x}_i) ak​(xi​) 我们可以简单理解为第i个局部特征属于第k个聚类的权重，也就是说，如果它的值等于1就说明它属于这个聚类的簇。如果是传统方法的VLAD，那么这个值只能是1或者0。直观上看，$ V$ 表征着所有局部特征在每一个聚类簇上的残差 ( x i − c k ) (\text{x}_i-\text{c}_k) (xi​−ck​)和。 在传统的VLAD中，由于 a k ( x i ) a_k(\text{x}_i) ak​(xi​)是一个不连续的值，取值为1或0，并且满足 ∑ i = 1 K a k ( x i ) = 1 \sum_{i=1}^K a_k(\text{x}_i)=1 ∑i=1K​ak​(xi​)=1，使得不能进行反向传播，文章采用一种近似的方式，来对 a k ( x i ) a_k(\text{x}_i) ak​(xi​) 做软分配（soft assignment）如下式： a ‾ k ( x i ) = e − α ∥ x i − c k ∥ 2 ∑ k ′ e − α ∥ x i − c k ′ ∥ 2 \overline{a}_k(\text{x}_i)=\frac{e^{-\alpha\|\text{x}_i-\text{c}_k\|^2}}{\sum_{k&amp;#x27;} e^{-\alpha\|\text{x}_i-\text{c}_{k&amp;#x27;}\|^2}} ak​(xi​)=∑k′​e−α∥xi​−ck′​∥2e−α∥xi​−ck​∥2​ 这个权重的分配可以把它当作一个模糊聚类的分配方式，根据每个局部特征到聚类中心的距离来生成一个概率函数权重。对于一个局部特征描述 x i \text{x}_i xi​ 在每个聚类簇下的权重的范围在0~1之间，权重最高的可以理解为该特征离聚类簇中心的聚类最近，权重低说明其离簇中心较远。可以注意到，当 α → + ∞ \alpha \to +\infty α→+∞ 时，这个式子就表示着原始的VLAD结构。 进一步地，可以将上式进行平方展开, e.g. ( a + b ) 2 = a 2 + b 2 + 2 a b (a+b)^2=a^2+b^2+2ab (a+b)2=a2+b2+2ab ，可以得到下式： a ‾ k ( x i ) = e w k T x i + b k ∑ k ′ e w k ′ T x i + b k ′ \overline{a}_k(\text{x}_i)=\frac{e^{\text{w}_k^T\text{x}_i+b_k}}{\sum_{k&amp;#x27;} e^{\text{w}_{k&amp;#x27;}^T\text{x}_i+b_{k&amp;#x27;}}} ak​(xi​)=∑k′​ewk′T​xi​+bk′​ewkT​xi​+bk​​ 其中， w k ′ = 2 α c k , b k = − α ∥ c k ∥ 2 \text{w}_{k&amp;#x27;}=2\alpha\text{c}_k,b_k=-\alpha\|\text{c}_k\|^2 wk′​=2αck​,bk​=−α∥ck​∥2,最终，我们可以得到VLAD特征向量为: V ( j , k ) = ∑ i = 1 N e w k T x i + b k ∑ k ′ e w k ′ T x i + b k ′ ( x i ( j ) − c k ( j ) ) V(j,k) = \sum_{i=1}^N {\frac{e^{\text{w}_k^T\text{x}_i+b_k}}{\sum_{k&amp;#x27;} e^{\text{w}_{k&amp;#x27;}^T\text{x}_i+b_{k&amp;#x27;}}}(x_i(j)-c_k(j))} V(j,k)=i=1∑N​∑k′​ewk′T​xi​+bk′​ewkT​xi​+bk​​(xi​(j)−ck​(j)) 可以看出，式中的参数 w k , b k , \text{w}_k,b_k, wk​,bk​, 以及$ \text{c}_k$ 都是可以训练的，和原始的VLAD很近似，NetVLAD通过这种在不同聚类簇上的软分配（soft-assignment）方式,能够有效的聚合了局部特征空间中不同部分（聚类）的一阶残差的统计量。另外我们可以注意到，NetVLAD中包含着三个参数， w k , b k , \text{w}_k,b_k, wk​,bk​, 和 c k \text{c}_k ck​，原始VLAD中只有一个参数 c k \text{c}_k ck​ ，这使得NetVLAD相对于传统的方法具有更加的灵活性，并且所有的参数在特定的任``务下可以通过端到端的方式来学习得到。 图1. CNN结构图 由图1可以看出，NetVLAD 层可以直接接在卷积网络中的最后一层（ H × W × D H×W×D H×W×D）上，把最后一层的特征图看作 N N N 个密集的 D D D 维局部描述子。soft-assignment过程可以分为两个步骤：1). 通过K个滤波器 { w k } \{\text{w}_k\} {wk​} 将N×D矩阵来学到 s k ( x i ) = w k T x i + b k s_k(\text{x}_i)=\text{w}_k^T\text{x}_i+b_k sk​(xi​)=wkT​xi​+bk​ ; 2). 卷积输出然后经过一个soft-max 函数，来生成 a ‾ k ( x i ) \overline{a}_k(\text{x}_i) ak​(xi​) 。 总结 这篇文章通过结合传统的特征提取方法，设计了NetVLAD这种网络结构，使得网络更加有效的利用卷积特征，能够有效的提高对同类别图像的表达能力，并提高分类的区分能力。这也是这篇文章最大的贡献。基于这种网络框架，后续有着很多的别的方向上的应用，如论文[2]、[3]等。 论文ActionVLAD[2] 这是一篇发表在CVPR2017年的关于行为识别的文章。行为识别的任务不同于图像分类，图像分类只是单单在图像上提取特征。而关于行为的，输入是一段视频，其重点在于对时间和空间上的特征提取，这篇文章在时间空间上分别独立提取特征，然后以VLAD的方式做pooling聚合，利用NetVLAD网络结构形成端到端训练。 动机 图2. 一个行为的描述 在一段视频中虽然是单一的动作分类，但是可能有多个不同的子类特征，例如投篮动作上有hoop, jump, group, throw, ball, running 等多个特征，所以需要一种方式把这些局部特征聚合到一个行为特征中去，用来分类。 行为特征提取 在以往的工作中，通常是是用卷积网络来提取空间上的特征，例如分别对不同帧做卷积。而时间上的特征最常见的还是利用光流的方法，光流是根据相邻帧之间的变化人为提取的特征信息，并且以2D图像的方式表示出来，因此基于双流的方法是目前行为识别中，非常有效的方法之一。这篇文章利用双流法的方式，对图像及其光流特征分别进行提取并聚合。关于特征聚合的方式像VLAD和FV这种，前文已经提到，这篇文章采用了论文[a]中提出的方法，将NetVLAD层网络用在行为识别网络中去。 可训练的时空聚合网络 图3. 网络结构图 有图3 可以看出，网络结构是对多帧图像进行的卷积操作，同时，光流图像也做同样操作。先只考虑RGB流的网络，因为是对多帧图像做的卷积，所以说会出现多帧图像下的卷积特征图。和论文[a]中的单个特征图不同，因此我们对公式（4）来做一个改进，是NetVLAD可以有效适用多个特征图。如下式： V ( j , k ) = ∑ t = 1 T ∑ i = 1 N e − α ∥ x i t − c k ∥ 2 ∑ k ′ e − α ∥ x i t − c k ′ ∥ 2 ⎵ Soft-assignment ( x i t ( j ) − c k ( j ) ) ⎵ Residual V(j,k) = \sum_{t=1}^T\sum_{i=1}^N \underbrace{\frac{e^{-\alpha\|\text{x}_{it}-\text{c}_k\|^2}}{\sum_{k&amp;#x27;} e^{-\alpha\|\text{x}_{it}-\text{c}_{k&amp;#x27;}\|^2}}}_\text{Soft-assignment}\underbrace{(x_{it}(j)-c_k(j))}_\text{Residual} V(j,k)=t=1∑T​i=1∑N​Soft-assignment ∑k′​e−α∥xit​−ck′​∥2e−α∥xit​−ck​∥2​​​Residual (xit​(j)−ck​(j))​​ 其中, x i t x_{it} xit​ 表示第 t t t 帧图像第 i i i 个特征描述子。 i ∈ 1 , 2 , … , N i\in{1,2,\ldots,N} i∈1,2,…,N， t ∈ 1 , 2 , … , T t\in{1,2,\ldots,T} t∈1,2,…,T 。可以看出，相对于论文[a]，这里将特征维度增加了一维，两个求和操作说明是在时间和空间上进行特征聚合，原理和操作方式不变，还是直接利用卷积计算得到特征的特征分布的统计量。 RGB流与光流的结合 由于网络是采用的双流法的结构，因此需要对双流进行结合。这篇文章设计了3种结合方式并进行对比。结合方式如图4所示 图4. 对双流结构的不同融合策略 1. 对RGB流和光流输出的特征图直接串接，实质也就是肯定了其在空间特征上的一致性。然后用一个单独的ActionVLAD层接进串接后的特征图。 2. 将所有的特征，全部直接做特征聚合，接到ActionVLAD中去。 3. 第三种方式，分别对，rgb流和光流做actionVLAD，最后在融合分类。 论文中对其进行实验对比，结果表明第三种结合的方式最好，这在一定程度上表明了，光流与rgb流的特征差异较大，不适合在一起构建词典。因此最终采用了第三种方式（Late fusion）通过最后的实现对比，可以看出这种方法的优势非常明显。如下表所示： 实验结果与其它方法对比 ##### 可视化分析 图中描述的是一个 ‘action words’ (聚类得到)的可视化。每一排代表不同视频中的帧，其中高亮的部分对应着特征图的感受野范围。进一步说，（a）展现的 ‘action word’ 是一个人手持这一个东西。（b）就是人的头发。© 像是一个圆形的像轮子一样的东西。等等。 总结 这篇文章针对行为识别任务，有效的将时空局部特征聚合，利用VLAD建立端到端可训练网络。 论文GhostVLAD[c] 这篇文章是DeepMind联合VGG组共同的研究成果。主要针对人脸识别的问题利用VLAD方法开展的研究。 动机 在人脸识别应用中，很多场景能够获取某一个体的多幅人脸图像的集合（比如在监控视频中），适用人脸图像集来做识别，这个问题被称为基于模板的人脸识别（template-based face recognition）。对于多幅图像，当然可以使用单幅人脸图像的识别方法，综合多幅图像的识别结果确定最终的人脸识别结果，但更好的方式是直接基于人脸图像集提取特征，比较人脸图像集的特征相似性。这涉及到如何聚合多幅人脸图像的特征向量成为一个特征向量，使该特征紧凑而又更具鉴别性的问题。 思路与原理 这篇文章作者的想法非常简单，当聚合多个人脸图像特征时，现有的平均池化等方法没能考虑到人脸图像集中一些低质量的图像（比如模糊人脸）的作用，这些图像含有的信息对识别并没有太大的贡献，应该降低这些低质量图像对最终聚合特征的贡献。一种直接的处理方法是，在人脸图像预处理阶段将低质量图像找出来，降低其贡献权重，但作者认为，端到端自动训练的方式让网络自身去优化识别并降低该部分样本的权重更好。 网络结构如上图所示，网络的输入是同一个人多个人脸图像，每次的图像个数可以不同，可以通过CNN网络提取每个图像的特征。这里要注意的是，与论文a和b不同，这里CNN提取的特征不在是卷积层特征，而是每个图像对应的全连接层特征，因为这里要聚合的是不同图像的特征，而不是论文a和b中所提到的的局部特征描述子。将提取得到的特征进行L2归一化处理，再送入到聚合模块。GhostVLAD聚合模块和VLAD原理几乎一样，能够将多个人脸的特征聚合成固定维数的特征矩阵（与图像的输入个数无关），再通过全连接层FC、BN、L2归一化维紧凑的鉴别特征。 其中的关键网络模块GhostVLAD既实现特征聚合，同时降低低质量图像的权重，提高高质量图像的聚合权重。说白了一句话，既然不要人为参与，那就要构建一种网络结构，让网络自动学习对识别不重要的信息，并丢掉它。作者是在NetVLAD上做出的算法改进，前文已提到，NetVLAD可以理解为一种可微分完全可训练的VLAD编码聚合方法，它的作用大致是自动计算特征聚类中心，计算残差，然后把残差加权，构建聚合特征矩阵，整个过程方便加入到神经网络中。 GhostVLAD的改进则是增加聚类中心的个数到K+G，但是增加的聚类中心在构建聚合特征矩阵的时候不参与贡献权重。如下图所示： 红色位置即标示出的Ghost 聚类中心，后续步骤中被去除，Ghost有“幻象”的意思，可能很多模糊的人脸的确看起来是“幻象”，这也是GhostVLAD名称的由来。这些多出来的不参与聚合特征矩阵构建的Ghost聚类中心，就相当于给了神经网络丢弃一部分信息使得网络更具鉴别性的可能，而在原来的NetVLAD中是体现不出来的。 实验结果 作者首先设计的实验是比较网络加上GhostVLAD层跟不加的精度，验证其有效性，作者使用的训练集是VGGFace2。实验设置不再赘述，这里直接给出结果。 在IJB-B数据集上的1:1人脸验证结果比较如下图，取得了大幅度的精度提升。 在IJB-B数据集上的1:N人脸识别结果比较如下图，同样取得了大幅度的精度提升。 最后作者可视化了使用GhostVLAD后对输入样本权重的影响，发现对于那些低质量模糊人脸的确权重被降低了。如下图所示： 总结 这篇文章从一个简单的直觉开始，构建了一种帮助神经网络丢弃鉴别性不足的信息的有效方式，大幅改进了基于图像集合的人脸识别方法，算法具有较高的实用价值，思想也很值得借鉴！ 值得一提的是，该文中的GhostVLAD方法不仅仅适用于人脸识别，在图像检索、行人重识别等领域也同样适用。 报告总结 这三篇论文都是围绕着VLAD来进行的研究，可以说是论文b和c都是在基于论文a提出的方法对不同的应用领域开展的探索。关于NetVLAD的应用其实也不止这些，如ECCV2018年一篇文章利用NetVLAD方法，将局部点云特征进行聚合，很好了提升了3D目标识别效果。 总的来说，这些应用都离不开VLAD本质上的特点： 可以理解成一种Pooling的方式，即将多个维度不同的特征聚合，生成一个能够有效描述这些特征集的向量。 或者可以理解成一个多示例（multi-instance）问题，在把众多的特征比作多个示例，这些示例特征，哪些能够对分类有效，哪些没有用，我们可以用VLAD来自行挑选具有辨识能力的instance。" />
<link rel="canonical" href="https://mlh.app/2019/01/09/f08d6950aaaa22f57917b3bed8e3ab36.html" />
<meta property="og:url" content="https://mlh.app/2019/01/09/f08d6950aaaa22f57917b3bed8e3ab36.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-09T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：未经博主允许不得转载 https://blog.csdn.net/qq_24954345/article/details/86176862 论文阅读报告 论文选择 [a] NetVLAD: CNN architecture for weakly supervised place recognition (CVPR 2016) [b] ActionVLAD: Learning spatio-temporal aggregation for action classification (CVPR 2017) [c] GhostVLAD for set-based face recognition (ACCV 2018) 报告内容概要 本文主要针对VLAD（Vector of locally aggregated descriptors，局部聚合向量）进行探索，这是一种传统的特征提取方法。NetVLAD这篇文章将其融合到CNN卷积网络中去，本文将对其网络中VLAD层做详细介绍，并且围绕上述的相关论文结合其应用特点与改进措施展开探索。第一篇文章本文主要围绕其原理方法介绍，后两篇文章主要针对其具体应用与改进作进一步分析。 什么是VLAD？ VLAD（Vector of locally aggregated descriptors，局部聚合向量）是一种类似于BOF（bag-of-feature）的描述图像的特征方法，可以理解是将局部特征表示成全局特征的编码方法。在这之前，BoF（词袋模型）通常用来描述基于Sift局部特征，在图像检索和分类中有着广泛的应用。相比于BoF，VLAD更加能够对图像的准确表达，得到更具有判别能力的特征，并且便于降维（PCA），同时降维对准确率的影响也较小。类似的方法还有，如FV（Fisher vector），这些传统的方法不具备可导性，因而无法进行反向传播，随着深度学习的普及逐渐被CNN所取代。 论文NetVLAD[a] 论文核心：文中提出一种卷积神经网络结构，可以实现端到端的识别。主要创新点是将传统的VLAD结构嵌入到CNN网络结构中去，得到一个新的VLAD层。NetVLAD可以很容易的运用到任何的CNN结构中，并且可以使用反向传播进行优化。 介绍 这篇文章主要针对地点识别问题来进行的研究。地点识别存在着一个很大的挑战是，在光照等其它因素影响下，即便是同一个地点图像之间的差异也是非常大。关键问题是如何找到这样一个具有代表性且具有区分性特征的表达。传统做法是将地点识别问题看作实例检索任务，使用具有不变性特征（SIFT）来表示每一个图像，然后将特征聚合成一个向量表示，这些向量通常对图像具有一定的代表和区分性，方法有BOW，VLAD，FV等。随着近些年卷积网络的不断发展，CNN对图像的表达能力已经非常可观并且有效。虽然CNN能够用在较大的数据集上，但是如果直接迁移使用CNN，那么它作为一个黑盒来提取图像特征，但很大程度上会限制示例级别（instance-level）上的识别任务。所以这篇文章主要抓的问题是： 如何定义一个好的网络结构 怎样获取足够多的标注数据 怎么训练来提升结构性能 第一，基于现有的神经网络架构，文章提出一个带有VLAD层的卷积神经网络模型 NetVLAD，它可以被加到任何的CNN结构中，并且可以使用BP算法优化。 第二，为了训练网络，收集了大量不同时间不同角度相同地点的全景图。通过这些数据进行训练是若监督学习，因为我们知道这些地点很接近，但是并不知道图像中的哪个部分决定了这两幅全景图是同一个地方。 第三，使用端到端的方式来学习模型参数，得到的描述特征对于视角和光照情况具有非常高的鲁棒性。 主要方法 局部聚合向量（VLAD）是广泛应用在示例检索与图像分类中的一种描述池化方法，它能够抓取图像中局部特征在图像中聚合的统计信息。视觉词袋聚合是记录每个词的数目，而VLAD是记录每个词的残差和。 给定 N N N 个D维局部图像描述子 x i x_i xi​作为输入， K K K 个聚类中心作为 c k c_k ck​ 作为VLAD的参数，VLAD的输出是一个 K × D K×D K×D维的图像描述向量，为了方便记作 V V V 是一个 K × D K×D K×D 的矩阵，但是这个矩阵被转换成向量表示，然后在进行归一化，计算公式如下： V ( j , k ) = ∑ i = 1 N a k ( x i ) ( x i ( j ) − c k ( j ) ) V(j,k) = \\sum_{i=1}^N {a_k(\\text{x}_i)(x_i(j)-c_k(j))} V(j,k)=i=1∑N​ak​(xi​)(xi​(j)−ck​(j)) 其中， x i ( j ) x_i(j) xi​(j) 和 c k ( j ) c_k(j) ck​(j) 表示是第 i i i 个局部描述子和第 k k k 个聚类中心的第 j j j 个特征值。 a k ( x i ) a_k(\\text{x}_i) ak​(xi​) 我们可以简单理解为第i个局部特征属于第k个聚类的权重，也就是说，如果它的值等于1就说明它属于这个聚类的簇。如果是传统方法的VLAD，那么这个值只能是1或者0。直观上看，$ V$ 表征着所有局部特征在每一个聚类簇上的残差 ( x i − c k ) (\\text{x}_i-\\text{c}_k) (xi​−ck​)和。 在传统的VLAD中，由于 a k ( x i ) a_k(\\text{x}_i) ak​(xi​)是一个不连续的值，取值为1或0，并且满足 ∑ i = 1 K a k ( x i ) = 1 \\sum_{i=1}^K a_k(\\text{x}_i)=1 ∑i=1K​ak​(xi​)=1，使得不能进行反向传播，文章采用一种近似的方式，来对 a k ( x i ) a_k(\\text{x}_i) ak​(xi​) 做软分配（soft assignment）如下式： a ‾ k ( x i ) = e − α ∥ x i − c k ∥ 2 ∑ k ′ e − α ∥ x i − c k ′ ∥ 2 \\overline{a}_k(\\text{x}_i)=\\frac{e^{-\\alpha\\|\\text{x}_i-\\text{c}_k\\|^2}}{\\sum_{k&amp;#x27;} e^{-\\alpha\\|\\text{x}_i-\\text{c}_{k&amp;#x27;}\\|^2}} ak​(xi​)=∑k′​e−α∥xi​−ck′​∥2e−α∥xi​−ck​∥2​ 这个权重的分配可以把它当作一个模糊聚类的分配方式，根据每个局部特征到聚类中心的距离来生成一个概率函数权重。对于一个局部特征描述 x i \\text{x}_i xi​ 在每个聚类簇下的权重的范围在0~1之间，权重最高的可以理解为该特征离聚类簇中心的聚类最近，权重低说明其离簇中心较远。可以注意到，当 α → + ∞ \\alpha \\to +\\infty α→+∞ 时，这个式子就表示着原始的VLAD结构。 进一步地，可以将上式进行平方展开, e.g. ( a + b ) 2 = a 2 + b 2 + 2 a b (a+b)^2=a^2+b^2+2ab (a+b)2=a2+b2+2ab ，可以得到下式： a ‾ k ( x i ) = e w k T x i + b k ∑ k ′ e w k ′ T x i + b k ′ \\overline{a}_k(\\text{x}_i)=\\frac{e^{\\text{w}_k^T\\text{x}_i+b_k}}{\\sum_{k&amp;#x27;} e^{\\text{w}_{k&amp;#x27;}^T\\text{x}_i+b_{k&amp;#x27;}}} ak​(xi​)=∑k′​ewk′T​xi​+bk′​ewkT​xi​+bk​​ 其中， w k ′ = 2 α c k , b k = − α ∥ c k ∥ 2 \\text{w}_{k&amp;#x27;}=2\\alpha\\text{c}_k,b_k=-\\alpha\\|\\text{c}_k\\|^2 wk′​=2αck​,bk​=−α∥ck​∥2,最终，我们可以得到VLAD特征向量为: V ( j , k ) = ∑ i = 1 N e w k T x i + b k ∑ k ′ e w k ′ T x i + b k ′ ( x i ( j ) − c k ( j ) ) V(j,k) = \\sum_{i=1}^N {\\frac{e^{\\text{w}_k^T\\text{x}_i+b_k}}{\\sum_{k&amp;#x27;} e^{\\text{w}_{k&amp;#x27;}^T\\text{x}_i+b_{k&amp;#x27;}}}(x_i(j)-c_k(j))} V(j,k)=i=1∑N​∑k′​ewk′T​xi​+bk′​ewkT​xi​+bk​​(xi​(j)−ck​(j)) 可以看出，式中的参数 w k , b k , \\text{w}_k,b_k, wk​,bk​, 以及$ \\text{c}_k$ 都是可以训练的，和原始的VLAD很近似，NetVLAD通过这种在不同聚类簇上的软分配（soft-assignment）方式,能够有效的聚合了局部特征空间中不同部分（聚类）的一阶残差的统计量。另外我们可以注意到，NetVLAD中包含着三个参数， w k , b k , \\text{w}_k,b_k, wk​,bk​, 和 c k \\text{c}_k ck​，原始VLAD中只有一个参数 c k \\text{c}_k ck​ ，这使得NetVLAD相对于传统的方法具有更加的灵活性，并且所有的参数在特定的任``务下可以通过端到端的方式来学习得到。 图1. CNN结构图 由图1可以看出，NetVLAD 层可以直接接在卷积网络中的最后一层（ H × W × D H×W×D H×W×D）上，把最后一层的特征图看作 N N N 个密集的 D D D 维局部描述子。soft-assignment过程可以分为两个步骤：1). 通过K个滤波器 { w k } \\{\\text{w}_k\\} {wk​} 将N×D矩阵来学到 s k ( x i ) = w k T x i + b k s_k(\\text{x}_i)=\\text{w}_k^T\\text{x}_i+b_k sk​(xi​)=wkT​xi​+bk​ ; 2). 卷积输出然后经过一个soft-max 函数，来生成 a ‾ k ( x i ) \\overline{a}_k(\\text{x}_i) ak​(xi​) 。 总结 这篇文章通过结合传统的特征提取方法，设计了NetVLAD这种网络结构，使得网络更加有效的利用卷积特征，能够有效的提高对同类别图像的表达能力，并提高分类的区分能力。这也是这篇文章最大的贡献。基于这种网络框架，后续有着很多的别的方向上的应用，如论文[2]、[3]等。 论文ActionVLAD[2] 这是一篇发表在CVPR2017年的关于行为识别的文章。行为识别的任务不同于图像分类，图像分类只是单单在图像上提取特征。而关于行为的，输入是一段视频，其重点在于对时间和空间上的特征提取，这篇文章在时间空间上分别独立提取特征，然后以VLAD的方式做pooling聚合，利用NetVLAD网络结构形成端到端训练。 动机 图2. 一个行为的描述 在一段视频中虽然是单一的动作分类，但是可能有多个不同的子类特征，例如投篮动作上有hoop, jump, group, throw, ball, running 等多个特征，所以需要一种方式把这些局部特征聚合到一个行为特征中去，用来分类。 行为特征提取 在以往的工作中，通常是是用卷积网络来提取空间上的特征，例如分别对不同帧做卷积。而时间上的特征最常见的还是利用光流的方法，光流是根据相邻帧之间的变化人为提取的特征信息，并且以2D图像的方式表示出来，因此基于双流的方法是目前行为识别中，非常有效的方法之一。这篇文章利用双流法的方式，对图像及其光流特征分别进行提取并聚合。关于特征聚合的方式像VLAD和FV这种，前文已经提到，这篇文章采用了论文[a]中提出的方法，将NetVLAD层网络用在行为识别网络中去。 可训练的时空聚合网络 图3. 网络结构图 有图3 可以看出，网络结构是对多帧图像进行的卷积操作，同时，光流图像也做同样操作。先只考虑RGB流的网络，因为是对多帧图像做的卷积，所以说会出现多帧图像下的卷积特征图。和论文[a]中的单个特征图不同，因此我们对公式（4）来做一个改进，是NetVLAD可以有效适用多个特征图。如下式： V ( j , k ) = ∑ t = 1 T ∑ i = 1 N e − α ∥ x i t − c k ∥ 2 ∑ k ′ e − α ∥ x i t − c k ′ ∥ 2 ⎵ Soft-assignment ( x i t ( j ) − c k ( j ) ) ⎵ Residual V(j,k) = \\sum_{t=1}^T\\sum_{i=1}^N \\underbrace{\\frac{e^{-\\alpha\\|\\text{x}_{it}-\\text{c}_k\\|^2}}{\\sum_{k&amp;#x27;} e^{-\\alpha\\|\\text{x}_{it}-\\text{c}_{k&amp;#x27;}\\|^2}}}_\\text{Soft-assignment}\\underbrace{(x_{it}(j)-c_k(j))}_\\text{Residual} V(j,k)=t=1∑T​i=1∑N​Soft-assignment ∑k′​e−α∥xit​−ck′​∥2e−α∥xit​−ck​∥2​​​Residual (xit​(j)−ck​(j))​​ 其中, x i t x_{it} xit​ 表示第 t t t 帧图像第 i i i 个特征描述子。 i ∈ 1 , 2 , … , N i\\in{1,2,\\ldots,N} i∈1,2,…,N， t ∈ 1 , 2 , … , T t\\in{1,2,\\ldots,T} t∈1,2,…,T 。可以看出，相对于论文[a]，这里将特征维度增加了一维，两个求和操作说明是在时间和空间上进行特征聚合，原理和操作方式不变，还是直接利用卷积计算得到特征的特征分布的统计量。 RGB流与光流的结合 由于网络是采用的双流法的结构，因此需要对双流进行结合。这篇文章设计了3种结合方式并进行对比。结合方式如图4所示 图4. 对双流结构的不同融合策略 1. 对RGB流和光流输出的特征图直接串接，实质也就是肯定了其在空间特征上的一致性。然后用一个单独的ActionVLAD层接进串接后的特征图。 2. 将所有的特征，全部直接做特征聚合，接到ActionVLAD中去。 3. 第三种方式，分别对，rgb流和光流做actionVLAD，最后在融合分类。 论文中对其进行实验对比，结果表明第三种结合的方式最好，这在一定程度上表明了，光流与rgb流的特征差异较大，不适合在一起构建词典。因此最终采用了第三种方式（Late fusion）通过最后的实现对比，可以看出这种方法的优势非常明显。如下表所示： 实验结果与其它方法对比 ##### 可视化分析 图中描述的是一个 ‘action words’ (聚类得到)的可视化。每一排代表不同视频中的帧，其中高亮的部分对应着特征图的感受野范围。进一步说，（a）展现的 ‘action word’ 是一个人手持这一个东西。（b）就是人的头发。© 像是一个圆形的像轮子一样的东西。等等。 总结 这篇文章针对行为识别任务，有效的将时空局部特征聚合，利用VLAD建立端到端可训练网络。 论文GhostVLAD[c] 这篇文章是DeepMind联合VGG组共同的研究成果。主要针对人脸识别的问题利用VLAD方法开展的研究。 动机 在人脸识别应用中，很多场景能够获取某一个体的多幅人脸图像的集合（比如在监控视频中），适用人脸图像集来做识别，这个问题被称为基于模板的人脸识别（template-based face recognition）。对于多幅图像，当然可以使用单幅人脸图像的识别方法，综合多幅图像的识别结果确定最终的人脸识别结果，但更好的方式是直接基于人脸图像集提取特征，比较人脸图像集的特征相似性。这涉及到如何聚合多幅人脸图像的特征向量成为一个特征向量，使该特征紧凑而又更具鉴别性的问题。 思路与原理 这篇文章作者的想法非常简单，当聚合多个人脸图像特征时，现有的平均池化等方法没能考虑到人脸图像集中一些低质量的图像（比如模糊人脸）的作用，这些图像含有的信息对识别并没有太大的贡献，应该降低这些低质量图像对最终聚合特征的贡献。一种直接的处理方法是，在人脸图像预处理阶段将低质量图像找出来，降低其贡献权重，但作者认为，端到端自动训练的方式让网络自身去优化识别并降低该部分样本的权重更好。 网络结构如上图所示，网络的输入是同一个人多个人脸图像，每次的图像个数可以不同，可以通过CNN网络提取每个图像的特征。这里要注意的是，与论文a和b不同，这里CNN提取的特征不在是卷积层特征，而是每个图像对应的全连接层特征，因为这里要聚合的是不同图像的特征，而不是论文a和b中所提到的的局部特征描述子。将提取得到的特征进行L2归一化处理，再送入到聚合模块。GhostVLAD聚合模块和VLAD原理几乎一样，能够将多个人脸的特征聚合成固定维数的特征矩阵（与图像的输入个数无关），再通过全连接层FC、BN、L2归一化维紧凑的鉴别特征。 其中的关键网络模块GhostVLAD既实现特征聚合，同时降低低质量图像的权重，提高高质量图像的聚合权重。说白了一句话，既然不要人为参与，那就要构建一种网络结构，让网络自动学习对识别不重要的信息，并丢掉它。作者是在NetVLAD上做出的算法改进，前文已提到，NetVLAD可以理解为一种可微分完全可训练的VLAD编码聚合方法，它的作用大致是自动计算特征聚类中心，计算残差，然后把残差加权，构建聚合特征矩阵，整个过程方便加入到神经网络中。 GhostVLAD的改进则是增加聚类中心的个数到K+G，但是增加的聚类中心在构建聚合特征矩阵的时候不参与贡献权重。如下图所示： 红色位置即标示出的Ghost 聚类中心，后续步骤中被去除，Ghost有“幻象”的意思，可能很多模糊的人脸的确看起来是“幻象”，这也是GhostVLAD名称的由来。这些多出来的不参与聚合特征矩阵构建的Ghost聚类中心，就相当于给了神经网络丢弃一部分信息使得网络更具鉴别性的可能，而在原来的NetVLAD中是体现不出来的。 实验结果 作者首先设计的实验是比较网络加上GhostVLAD层跟不加的精度，验证其有效性，作者使用的训练集是VGGFace2。实验设置不再赘述，这里直接给出结果。 在IJB-B数据集上的1:1人脸验证结果比较如下图，取得了大幅度的精度提升。 在IJB-B数据集上的1:N人脸识别结果比较如下图，同样取得了大幅度的精度提升。 最后作者可视化了使用GhostVLAD后对输入样本权重的影响，发现对于那些低质量模糊人脸的确权重被降低了。如下图所示： 总结 这篇文章从一个简单的直觉开始，构建了一种帮助神经网络丢弃鉴别性不足的信息的有效方式，大幅改进了基于图像集合的人脸识别方法，算法具有较高的实用价值，思想也很值得借鉴！ 值得一提的是，该文中的GhostVLAD方法不仅仅适用于人脸识别，在图像检索、行人重识别等领域也同样适用。 报告总结 这三篇论文都是围绕着VLAD来进行的研究，可以说是论文b和c都是在基于论文a提出的方法对不同的应用领域开展的探索。关于NetVLAD的应用其实也不止这些，如ECCV2018年一篇文章利用NetVLAD方法，将局部点云特征进行聚合，很好了提升了3D目标识别效果。 总的来说，这些应用都离不开VLAD本质上的特点： 可以理解成一种Pooling的方式，即将多个维度不同的特征聚合，生成一个能够有效描述这些特征集的向量。 或者可以理解成一个多示例（multi-instance）问题，在把众多的特征比作多个示例，这些示例特征，哪些能够对分类有效，哪些没有用，我们可以用VLAD来自行挑选具有辨识能力的instance。","@type":"BlogPosting","url":"https://mlh.app/2019/01/09/f08d6950aaaa22f57917b3bed8e3ab36.html","headline":"NetVLAD相关论文阅读与总结","dateModified":"2019-01-09T00:00:00+08:00","datePublished":"2019-01-09T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/01/09/f08d6950aaaa22f57917b3bed8e3ab36.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>NetVLAD相关论文阅读与总结</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright"> 
  <svg class="icon" title="CSDN认证原创" aria-hidden="true" style="width:53px; height: 18px; vertical-align: -4px;"> 
   <use xlink:href="#CSDN_Cert"></use> 
  </svg> 版权声明：未经博主允许不得转载 https://blog.csdn.net/qq_24954345/article/details/86176862 
 </div> 
 <div id="content_views" class="markdown_views prism-tomorrow-night"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h1><a id="_1"></a>论文阅读报告</h1> 
  <h3><a id="_3"></a>论文选择</h3> 
  <p>[a] NetVLAD: CNN architecture for weakly supervised place recognition (CVPR 2016)<br> [b] ActionVLAD: Learning spatio-temporal aggregation for action classification (CVPR 2017)<br> [c] GhostVLAD for set-based face recognition (ACCV 2018)</p> 
  <h3><a id="_8"></a>报告内容概要</h3> 
  <p>本文主要针对VLAD（Vector of locally aggregated descriptors，局部聚合向量）进行探索，这是一种传统的特征提取方法。NetVLAD这篇文章将其融合到CNN卷积网络中去，本文将对其网络中VLAD层做详细介绍，并且围绕上述的相关论文结合其应用特点与改进措施展开探索。第一篇文章本文主要围绕其原理方法介绍，后两篇文章主要针对其具体应用与改进作进一步分析。</p> 
  <h3><a id="VLAD_10"></a>什么是VLAD？</h3> 
  <p>VLAD（Vector of locally aggregated descriptors，局部聚合向量）是一种类似于BOF（bag-of-feature）的描述图像的特征方法，可以理解是将局部特征表示成全局特征的编码方法。在这之前，BoF（词袋模型）通常用来描述基于Sift局部特征，在图像检索和分类中有着广泛的应用。相比于BoF，VLAD更加能够对图像的准确表达，得到更具有判别能力的特征，并且便于降维（PCA），同时降维对准确率的影响也较小。类似的方法还有，如FV（Fisher vector），这些传统的方法不具备可导性，因而无法进行反向传播，随着深度学习的普及逐渐被CNN所取代。</p> 
  <h3><a id="NetVLADa_13"></a>论文NetVLAD[a]</h3> 
  <p>论文核心：文中提出一种卷积神经网络结构，可以实现端到端的识别。主要创新点是将传统的VLAD结构嵌入到CNN网络结构中去，得到一个新的VLAD层。NetVLAD可以很容易的运用到任何的CNN结构中，并且可以使用反向传播进行优化。</p> 
  <h5><a id="_15"></a>介绍</h5> 
  <p>这篇文章主要针对地点识别问题来进行的研究。地点识别存在着一个很大的挑战是，在光照等其它因素影响下，即便是同一个地点图像之间的差异也是非常大。关键问题是如何找到这样一个具有代表性且具有区分性特征的表达。传统做法是将地点识别问题看作实例检索任务，使用具有不变性特征（SIFT）来表示每一个图像，然后将特征聚合成一个向量表示，这些向量通常对图像具有一定的代表和区分性，方法有BOW，VLAD，FV等。随着近些年卷积网络的不断发展，CNN对图像的表达能力已经非常可观并且有效。虽然CNN能够用在较大的数据集上，但是如果直接迁移使用CNN，那么它作为一个黑盒来提取图像特征，但很大程度上会限制示例级别（instance-level）上的识别任务。所以这篇文章主要抓的问题是：</p> 
  <ul> 
   <li>如何定义一个好的网络结构</li> 
   <li>怎样获取足够多的标注数据</li> 
   <li>怎么训练来提升结构性能</li> 
  </ul> 
  <p>第一，基于现有的神经网络架构，文章提出一个带有VLAD层的卷积神经网络模型 NetVLAD，它可以被加到任何的CNN结构中，并且可以使用BP算法优化。<br> 第二，为了训练网络，收集了大量不同时间不同角度相同地点的全景图。通过这些数据进行训练是若监督学习，因为我们知道这些地点很接近，但是并不知道图像中的哪个部分决定了这两幅全景图是同一个地方。<br> 第三，使用端到端的方式来学习模型参数，得到的描述特征对于视角和光照情况具有非常高的鲁棒性。</p> 
  <h5><a id="_25"></a>主要方法</h5> 
  <p>局部聚合向量（VLAD）是广泛应用在示例检索与图像分类中的一种描述池化方法，它能够抓取图像中局部特征在图像中聚合的统计信息。视觉词袋聚合是记录每个词的数目，而VLAD是记录每个词的残差和。<br> 给定 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          N
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         N
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span> 个D维局部图像描述子<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>作为输入，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span></span></span></span></span> 个聚类中心作为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           c
          </mi>
          <mi>
           k
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         c_k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 作为VLAD的参数，VLAD的输出是一个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
         <mo>
          ×
         </mo>
         <mi>
          D
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K×D
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">D</span></span></span></span></span>维的图像描述向量，为了方便记作 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          V
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         V
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span></span></span></span></span> 是一个 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
         <mo>
          ×
         </mo>
         <mi>
          D
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K×D
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">D</span></span></span></span></span> 的矩阵，但是这个矩阵被转换成向量表示，然后在进行归一化，计算公式如下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           V
          </mi>
          <mo>
           (
          </mo>
          <mi>
           j
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           k
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mrow>
           <msub>
            <mi>
             a
            </mi>
            <mi>
             k
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <msub>
            <mtext>
             x
            </mtext>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            )
           </mo>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <msub>
            <mi>
             c
            </mi>
            <mi>
             k
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
           V(j,k) = \sum_{i=1}^N {a_k(\text{x}_i)(x_i(j)-c_k(j))} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          j
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         x_i(j)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           c
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          j
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         c_k(j)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 表示是第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个局部描述子和第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          k
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span></span></span></span></span> 个聚类中心的第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span> 个特征值。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           a
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         a_k(\text{x}_i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 我们可以简单理解为第i个局部特征属于第k个聚类的权重，也就是说，如果它的值等于1就说明它属于这个聚类的簇。如果是传统方法的VLAD，那么这个值只能是1或者0。直观上看，$ V$ 表征着所有局部特征在每一个聚类簇上的残差<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          −
         </mo>
         <msub>
          <mtext>
           c
          </mtext>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         (\text{x}_i-\text{c}_k)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>和。<br> 在传统的VLAD中，由于<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           a
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         a_k(\text{x}_i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>是一个不连续的值，取值为1或0，并且满足 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           K
          </mi>
         </msubsup>
         <msub>
          <mi>
           a
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \sum_{i=1}^K a_k(\text{x}_i)=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.28094em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，使得不能进行反向传播，文章采用一种近似的方式，来对<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           a
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         a_k(\text{x}_i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 做软分配（soft assignment）如下式：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mover accent="true">
            <mi>
             a
            </mi>
            <mo stretchy="true">
             ‾
            </mo>
           </mover>
           <mi>
            k
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mtext>
            x
           </mtext>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <msup>
            <mi>
             e
            </mi>
            <mrow>
             <mo>
              −
             </mo>
             <mi>
              α
             </mi>
             <mi mathvariant="normal">
              ∥
             </mi>
             <msub>
              <mtext>
               x
              </mtext>
              <mi>
               i
              </mi>
             </msub>
             <mo>
              −
             </mo>
             <msub>
              <mtext>
               c
              </mtext>
              <mi>
               k
              </mi>
             </msub>
             <msup>
              <mi mathvariant="normal">
               ∥
              </mi>
              <mn>
               2
              </mn>
             </msup>
            </mrow>
           </msup>
           <mrow>
            <munder>
             <mo>
              ∑
             </mo>
             <msup>
              <mi>
               k
              </mi>
              <mo mathvariant="normal">
               ′
              </mo>
             </msup>
            </munder>
            <msup>
             <mi>
              e
             </mi>
             <mrow>
              <mo>
               −
              </mo>
              <mi>
               α
              </mi>
              <mi mathvariant="normal">
               ∥
              </mi>
              <msub>
               <mtext>
                x
               </mtext>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               −
              </mo>
              <msub>
               <mtext>
                c
               </mtext>
               <msup>
                <mi>
                 k
                </mi>
                <mo mathvariant="normal">
                 ′
                </mo>
               </msup>
              </msub>
              <msup>
               <mi mathvariant="normal">
                ∥
               </mi>
               <mn>
                2
               </mn>
              </msup>
             </mrow>
            </msup>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
           \overline{a}_k(\text{x}_i)=\frac{e^{-\alpha\|\text{x}_i-\text{c}_k\|^2}}{\sum_{k&amp;#x27;} e^{-\alpha\|\text{x}_i-\text{c}_{k&amp;#x27;}\|^2}} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.63056em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">a</span></span></span><span class="" style="top: -3.55056em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.6698em; vertical-align: -1.00588em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.66392em;"><span class="" style="top: -2.29383em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.186398em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.81617em;"><span class="" style="top: -2.99117em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.0037em;">α</span><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.262029em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.746314em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.98692em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.0037em;">α</span><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891314em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.00588em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 这个权重的分配可以把它当作一个模糊聚类的分配方式，根据每个局部特征到聚类中心的距离来生成一个概率函数权重。对于一个局部特征描述 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{x}_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 在每个聚类簇下的权重的范围在0~1之间，权重最高的可以理解为该特征离聚类簇中心的聚类最近，权重低说明其离簇中心较远。可以注意到，当 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          α
         </mi>
         <mo>
          →
         </mo>
         <mo>
          +
         </mo>
         <mi mathvariant="normal">
          ∞
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha \to +\infty
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">+</span><span class="mord">∞</span></span></span></span></span> 时，这个式子就表示着原始的VLAD结构。<br> 进一步地，可以将上式进行平方展开, e.g. <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <mi>
          a
         </mi>
         <mo>
          +
         </mo>
         <mi>
          b
         </mi>
         <msup>
          <mo>
           )
          </mo>
          <mn>
           2
          </mn>
         </msup>
         <mo>
          =
         </mo>
         <msup>
          <mi>
           a
          </mi>
          <mn>
           2
          </mn>
         </msup>
         <mo>
          +
         </mo>
         <msup>
          <mi>
           b
          </mi>
          <mn>
           2
          </mn>
         </msup>
         <mo>
          +
         </mo>
         <mn>
          2
         </mn>
         <mi>
          a
         </mi>
         <mi>
          b
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         (a+b)^2=a^2+b^2+2ab
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.897438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mord mathit">a</span><span class="mord mathit">b</span></span></span></span></span> ，可以得到下式：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mover accent="true">
            <mi>
             a
            </mi>
            <mo stretchy="true">
             ‾
            </mo>
           </mover>
           <mi>
            k
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <msub>
           <mtext>
            x
           </mtext>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <msup>
            <mi>
             e
            </mi>
            <mrow>
             <msubsup>
              <mtext>
               w
              </mtext>
              <mi>
               k
              </mi>
              <mi>
               T
              </mi>
             </msubsup>
             <msub>
              <mtext>
               x
              </mtext>
              <mi>
               i
              </mi>
             </msub>
             <mo>
              +
             </mo>
             <msub>
              <mi>
               b
              </mi>
              <mi>
               k
              </mi>
             </msub>
            </mrow>
           </msup>
           <mrow>
            <munder>
             <mo>
              ∑
             </mo>
             <msup>
              <mi>
               k
              </mi>
              <mo mathvariant="normal">
               ′
              </mo>
             </msup>
            </munder>
            <msup>
             <mi>
              e
             </mi>
             <mrow>
              <msubsup>
               <mtext>
                w
               </mtext>
               <msup>
                <mi>
                 k
                </mi>
                <mo mathvariant="normal">
                 ′
                </mo>
               </msup>
               <mi>
                T
               </mi>
              </msubsup>
              <msub>
               <mtext>
                x
               </mtext>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                b
               </mi>
               <msup>
                <mi>
                 k
                </mi>
                <mo mathvariant="normal">
                 ′
                </mo>
               </msup>
              </msub>
             </mrow>
            </msup>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
           \overline{a}_k(\text{x}_i)=\frac{e^{\text{w}_k^T\text{x}_i+b_k}}{\sum_{k&amp;#x27;} e^{\text{w}_{k&amp;#x27;}^T\text{x}_i+b_{k&amp;#x27;}}} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.63056em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">a</span></span></span><span class="" style="top: -3.55056em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.88447em; vertical-align: -1.2011em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.68337em;"><span class="" style="top: -2.11em;"><span class="pstrut" style="height: 3.01139em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.186398em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.01139em;"><span class="" style="top: -3.12837em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.832893em;"><span class="" style="top: -2.1488em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.95163em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.458029em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.262029em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.24139em;"><span class="pstrut" style="height: 3.01139em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.68839em;"><span class="pstrut" style="height: 3.01139em;"></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.00636em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.919093em;"><span class="" style="top: -2.214em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2011em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mtext>
           w
          </mtext>
          <msup>
           <mi>
            k
           </mi>
           <mo mathvariant="normal">
            ′
           </mo>
          </msup>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          2
         </mn>
         <mi>
          α
         </mi>
         <msub>
          <mtext>
           c
          </mtext>
          <mi>
           k
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <mo>
          −
         </mo>
         <mi>
          α
         </mi>
         <mi mathvariant="normal">
          ∥
         </mi>
         <msub>
          <mtext>
           c
          </mtext>
          <mi>
           k
          </mi>
         </msub>
         <msup>
          <mi mathvariant="normal">
           ∥
          </mi>
          <mn>
           2
          </mn>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{w}_{k&amp;#x27;}=2\alpha\text{c}_k,b_k=-\alpha\|\text{c}_k\|^2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">2</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord text"><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>,最终，我们可以得到VLAD特征向量为:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           V
          </mi>
          <mo>
           (
          </mo>
          <mi>
           j
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           k
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mrow>
           <mfrac>
            <msup>
             <mi>
              e
             </mi>
             <mrow>
              <msubsup>
               <mtext>
                w
               </mtext>
               <mi>
                k
               </mi>
               <mi>
                T
               </mi>
              </msubsup>
              <msub>
               <mtext>
                x
               </mtext>
               <mi>
                i
               </mi>
              </msub>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                b
               </mi>
               <mi>
                k
               </mi>
              </msub>
             </mrow>
            </msup>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <msup>
               <mi>
                k
               </mi>
               <mo mathvariant="normal">
                ′
               </mo>
              </msup>
             </munder>
             <msup>
              <mi>
               e
              </mi>
              <mrow>
               <msubsup>
                <mtext>
                 w
                </mtext>
                <msup>
                 <mi>
                  k
                 </mi>
                 <mo mathvariant="normal">
                  ′
                 </mo>
                </msup>
                <mi>
                 T
                </mi>
               </msubsup>
               <msub>
                <mtext>
                 x
                </mtext>
                <mi>
                 i
                </mi>
               </msub>
               <mo>
                +
               </mo>
               <msub>
                <mi>
                 b
                </mi>
                <msup>
                 <mi>
                  k
                 </mi>
                 <mo mathvariant="normal">
                  ′
                 </mo>
                </msup>
               </msub>
              </mrow>
             </msup>
            </mrow>
           </mfrac>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             x
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
           <mo>
            −
           </mo>
           <msub>
            <mi>
             c
            </mi>
            <mi>
             k
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
           V(j,k) = \sum_{i=1}^N {\frac{e^{\text{w}_k^T\text{x}_i+b_k}}{\sum_{k&amp;#x27;} e^{\text{w}_{k&amp;#x27;}^T\text{x}_i+b_{k&amp;#x27;}}}(x_i(j)-c_k(j))} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.68337em;"><span class="" style="top: -2.11em;"><span class="pstrut" style="height: 3.01139em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.186398em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.01139em;"><span class="" style="top: -3.12837em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.832893em;"><span class="" style="top: -2.1488em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.95163em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.458029em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.262029em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.24139em;"><span class="pstrut" style="height: 3.01139em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.68839em;"><span class="pstrut" style="height: 3.01139em;"></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.00636em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.919093em;"><span class="" style="top: -2.214em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2011em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></span><br> 可以看出，式中的参数<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mtext>
           w
          </mtext>
          <mi>
           k
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{w}_k,b_k,
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord text"><span class="mord">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> 以及$ \text{c}_k$ 都是可以训练的，和原始的VLAD很近似，NetVLAD通过这种在不同聚类簇上的软分配（soft-assignment）方式,能够有效的聚合了局部特征空间中不同部分（聚类）的一阶残差的统计量。另外我们可以注意到，NetVLAD中包含着三个参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mtext>
           w
          </mtext>
          <mi>
           k
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{w}_k,b_k,
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord text"><span class="mord">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mtext>
           c
          </mtext>
          <mi>
           k
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{c}_k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，原始VLAD中只有一个参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mtext>
           c
          </mtext>
          <mi>
           k
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \text{c}_k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ，这使得NetVLAD相对于传统的方法具有更加的灵活性，并且所有的参数在特定的任``务下可以通过端到端的方式来学习得到。</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109201918844.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <center>
   图1. CNN结构图
  </center> 
  <p>由图1可以看出，NetVLAD 层可以直接接在卷积网络中的最后一层（<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          H
         </mi>
         <mo>
          ×
         </mo>
         <mi>
          W
         </mi>
         <mo>
          ×
         </mo>
         <mi>
          D
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         H×W×D
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.08125em;">H</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">W</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">D</span></span></span></span></span>）上，把最后一层的特征图看作 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          N
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         N
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span> 个密集的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          D
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         D
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">D</span></span></span></span></span> 维局部描述子。soft-assignment过程可以分为两个步骤：1). 通过K个滤波器 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          {
         </mo>
         <msub>
          <mtext>
           w
          </mtext>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \{\text{w}_k\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord text"><span class="mord">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> 将N×D矩阵来学到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           s
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msubsup>
          <mtext>
           w
          </mtext>
          <mi>
           k
          </mi>
          <mi>
           T
          </mi>
         </msubsup>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           k
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         s_k(\text{x}_i)=\text{w}_k^T\text{x}_i+b_k
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord text"><span class="mord">w</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ; 2). 卷积输出然后经过一个soft-max 函数，来生成 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mover accent="true">
           <mi>
            a
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <msub>
          <mtext>
           x
          </mtext>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \overline{a}_k(\text{x}_i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.63056em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">a</span></span></span><span class="" style="top: -3.55056em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 。</p> 
  <h5><a id="_53"></a>总结</h5> 
  <p>这篇文章通过结合传统的特征提取方法，设计了NetVLAD这种网络结构，使得网络更加有效的利用卷积特征，能够有效的提高对同类别图像的表达能力，并提高分类的区分能力。这也是这篇文章最大的贡献。基于这种网络框架，后续有着很多的别的方向上的应用，如论文[2]、[3]等。</p> 
  <h3><a id="ActionVLAD2_57"></a>论文ActionVLAD[2]</h3> 
  <p>这是一篇发表在CVPR2017年的关于行为识别的文章。行为识别的任务不同于图像分类，图像分类只是单单在图像上提取特征。而关于行为的，输入是一段视频，其重点在于对时间和空间上的特征提取，这篇文章在时间空间上分别独立提取特征，然后以VLAD的方式做pooling聚合，利用NetVLAD网络结构形成端到端训练。</p> 
  <h5><a id="_61"></a>动机</h5> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109201952219.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="行为描述"></p> 
  <center>
   图2. 一个行为的描述
  </center> 在一段视频中虽然是单一的动作分类，但是可能有多个不同的子类特征，例如投篮动作上有hoop, jump, group, throw, ball, running 等多个特征，所以需要一种方式把这些局部特征聚合到一个行为特征中去，用来分类。 
  <h5><a id="_67"></a>行为特征提取</h5> 
  <p>在以往的工作中，通常是是用卷积网络来提取空间上的特征，例如分别对不同帧做卷积。而时间上的特征最常见的还是利用光流的方法，光流是根据相邻帧之间的变化人为提取的特征信息，并且以2D图像的方式表示出来，因此基于双流的方法是目前行为识别中，非常有效的方法之一。这篇文章利用双流法的方式，对图像及其光流特征分别进行提取并聚合。关于特征聚合的方式像VLAD和FV这种，前文已经提到，这篇文章采用了论文[a]中提出的方法，将NetVLAD层网络用在行为识别网络中去。</p> 
  <h5><a id="_70"></a>可训练的时空聚合网络</h5> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/2019010920204581.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="结构图"></p> 
  <center>
   图3. 网络结构图
  </center> 有图3 可以看出，网络结构是对多帧图像进行的卷积操作，同时，光流图像也做同样操作。先只考虑RGB流的网络，因为是对多帧图像做的卷积，所以说会出现多帧图像下的卷积特征图。和论文[a]中的单个特征图不同，因此我们对公式（4）来做一个改进，是NetVLAD可以有效适用多个特征图。如下式： 
  <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           V
          </mi>
          <mo>
           (
          </mo>
          <mi>
           j
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           k
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            T
           </mi>
          </munderover>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <munder>
           <munder>
            <mfrac>
             <msup>
              <mi>
               e
              </mi>
              <mrow>
               <mo>
                −
               </mo>
               <mi>
                α
               </mi>
               <mi mathvariant="normal">
                ∥
               </mi>
               <msub>
                <mtext>
                 x
                </mtext>
                <mrow>
                 <mi>
                  i
                 </mi>
                 <mi>
                  t
                 </mi>
                </mrow>
               </msub>
               <mo>
                −
               </mo>
               <msub>
                <mtext>
                 c
                </mtext>
                <mi>
                 k
                </mi>
               </msub>
               <msup>
                <mi mathvariant="normal">
                 ∥
                </mi>
                <mn>
                 2
                </mn>
               </msup>
              </mrow>
             </msup>
             <mrow>
              <munder>
               <mo>
                ∑
               </mo>
               <msup>
                <mi>
                 k
                </mi>
                <mo mathvariant="normal">
                 ′
                </mo>
               </msup>
              </munder>
              <msup>
               <mi>
                e
               </mi>
               <mrow>
                <mo>
                 −
                </mo>
                <mi>
                 α
                </mi>
                <mi mathvariant="normal">
                 ∥
                </mi>
                <msub>
                 <mtext>
                  x
                 </mtext>
                 <mrow>
                  <mi>
                   i
                  </mi>
                  <mi>
                   t
                  </mi>
                 </mrow>
                </msub>
                <mo>
                 −
                </mo>
                <msub>
                 <mtext>
                  c
                 </mtext>
                 <msup>
                  <mi>
                   k
                  </mi>
                  <mo mathvariant="normal">
                   ′
                  </mo>
                 </msup>
                </msub>
                <msup>
                 <mi mathvariant="normal">
                  ∥
                 </mi>
                 <mn>
                  2
                 </mn>
                </msup>
               </mrow>
              </msup>
             </mrow>
            </mfrac>
            <mo stretchy="true">
             ⎵
            </mo>
           </munder>
           <mtext>
            Soft-assignment
           </mtext>
          </munder>
          <munder>
           <munder>
            <mrow>
             <mo>
              (
             </mo>
             <msub>
              <mi>
               x
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mi>
                t
               </mi>
              </mrow>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
             <mo>
              −
             </mo>
             <msub>
              <mi>
               c
              </mi>
              <mi>
               k
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
             <mo>
              )
             </mo>
            </mrow>
            <mo stretchy="true">
             ⎵
            </mo>
           </munder>
           <mtext>
            Residual
           </mtext>
          </munder>
         </mrow>
         <annotation encoding="application/x-tex">
           V(j,k) = \sum_{t=1}^T\sum_{i=1}^N \underbrace{\frac{e^{-\alpha\|\text{x}_{it}-\text{c}_k\|^2}}{\sum_{k&amp;#x27;} e^{-\alpha\|\text{x}_{it}-\text{c}_{k&amp;#x27;}\|^2}}}_\text{Soft-assignment}\underbrace{(x_{it}(j)-c_k(j))}_\text{Residual} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 4.30443em; vertical-align: -2.4761em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.66392em;"><span class="" style="top: -1.32393em;"><span class="pstrut" style="height: 3.66392em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Soft-assignment</span></span></span></span><span class="" style="top: -3.66392em;"><span class="pstrut" style="height: 3.66392em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.66392em;"><span class="svg-align" style="top: -2.01004em;"><span class="pstrut" style="height: 3.66392em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice">
                     <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                    </svg></span><span class="brace-center" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice">
                     <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                    </svg></span><span class="brace-right" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice">
                     <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                    </svg></span></span></span><span class="" style="top: -3.66392em;"><span class="pstrut" style="height: 3.66392em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.66392em;"><span class="" style="top: -2.29383em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.186398em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.81617em;"><span class="" style="top: -2.99117em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.0037em;">α</span><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.3448em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.60683em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.84956em;"><span class="" style="top: -2.84956em; margin-right: 0.1em;"><span class="pstrut" style="height: 2.55556em;"></span><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.262029em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.746314em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.98692em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.0037em;">α</span><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">c</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.34877em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.151229em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891314em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.00588em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.65388em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.4761em;"><span class=""></span></span></span></span></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -1.41589em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Residual</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="svg-align" style="top: -2.102em;"><span class="pstrut" style="height: 3em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice">
                     <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                    </svg></span><span class="brace-center" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice">
                     <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                    </svg></span><span class="brace-right" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice">
                     <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                    </svg></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.898em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.58411em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> 其中, <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            t
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_{it}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span> 帧图像第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个特征描述子。<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
         <mo>
          ∈
         </mo>
         <mrow>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           2
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mo>
           …
          </mo>
          <mo separator="true">
           ,
          </mo>
          <mi>
           N
          </mi>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         i\in{1,2,\ldots,N}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69862em; vertical-align: -0.0391em;"></span><span class="mord mathit">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          ∈
         </mo>
         <mrow>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mn>
           2
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mo>
           …
          </mo>
          <mo separator="true">
           ,
          </mo>
          <mi>
           T
          </mi>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         t\in{1,2,\ldots,T}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65418em; vertical-align: -0.0391em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span></span></span></span></span></span> 。可以看出，相对于论文[a]，这里将特征维度增加了一维，两个求和操作说明是在时间和空间上进行特征聚合，原理和操作方式不变，还是直接利用卷积计算得到特征的特征分布的统计量。</p> 
  <h5><a id="RGB_79"></a>RGB流与光流的结合</h5> 
  <p>由于网络是采用的双流法的结构，因此需要对双流进行结合。这篇文章设计了3种结合方式并进行对比。结合方式如图4所示</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109202107387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="融合策略"></p> 
  <center>
   图4. 对双流结构的不同融合策略
  </center> 1. 对RGB流和光流输出的特征图直接串接，实质也就是肯定了其在空间特征上的一致性。然后用一个单独的ActionVLAD层接进串接后的特征图。 2. 将所有的特征，全部直接做特征聚合，接到ActionVLAD中去。 3. 第三种方式，分别对，rgb流和光流做actionVLAD，最后在融合分类。 论文中对其进行实验对比，结果表明第三种结合的方式最好，这在一定程度上表明了，光流与rgb流的特征差异较大，不适合在一起构建词典。因此最终采用了第三种方式（Late fusion）通过最后的实现对比，可以看出这种方法的优势非常明显。如下表所示： 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109202143576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <center>
    实验结果与其它方法对比
  </center> ##### 可视化分析 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109202154869.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 图中描述的是一个 ‘action words’ (聚类得到)的可视化。每一排代表不同视频中的帧，其中高亮的部分对应着特征图的感受野范围。进一步说，（a）展现的 ‘action word’ 是一个人手持这一个东西。（b）就是人的头发。© 像是一个圆形的像轮子一样的东西。等等。</p> 
  <h5><a id="_95"></a>总结</h5> 
  <p>这篇文章针对行为识别任务，有效的将时空局部特征聚合，利用VLAD建立端到端可训练网络。</p> 
  <h3><a id="GhostVLADc_98"></a>论文GhostVLAD[c]</h3> 
  <p>这篇文章是DeepMind联合VGG组共同的研究成果。主要针对人脸识别的问题利用VLAD方法开展的研究。</p> 
  <h5><a id="_102"></a>动机</h5> 
  <p>在人脸识别应用中，很多场景能够获取某一个体的多幅人脸图像的集合（比如在监控视频中），适用人脸图像集来做识别，这个问题被称为基于模板的人脸识别（template-based face recognition）。对于多幅图像，当然可以使用单幅人脸图像的识别方法，综合多幅图像的识别结果确定最终的人脸识别结果，但更好的方式是直接基于人脸图像集提取特征，比较人脸图像集的特征相似性。这涉及到如何聚合多幅人脸图像的特征向量成为一个特征向量，使该特征紧凑而又更具鉴别性的问题。</p> 
  <h5><a id="_106"></a>思路与原理</h5> 
  <p>这篇文章作者的想法非常简单，当聚合多个人脸图像特征时，现有的平均池化等方法没能考虑到人脸图像集中一些低质量的图像（比如模糊人脸）的作用，这些图像含有的信息对识别并没有太大的贡献，应该降低这些低质量图像对最终聚合特征的贡献。一种直接的处理方法是，在人脸图像预处理阶段将低质量图像找出来，降低其贡献权重，但作者认为，端到端自动训练的方式让网络自身去优化识别并降低该部分样本的权重更好。</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109202209414.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="TIM截图20190109174307"></p> 
  <p>网络结构如上图所示，网络的输入是同一个人多个人脸图像，每次的图像个数可以不同，可以通过CNN网络提取每个图像的特征。这里要注意的是，与论文a和b不同，这里CNN提取的特征不在是卷积层特征，而是每个图像对应的全连接层特征，因为这里要聚合的是不同图像的特征，而不是论文a和b中所提到的的局部特征描述子。将提取得到的特征进行L2归一化处理，再送入到聚合模块。GhostVLAD聚合模块和VLAD原理几乎一样，能够将多个人脸的特征聚合成固定维数的特征矩阵（与图像的输入个数无关），再通过全连接层FC、BN、L2归一化维紧凑的鉴别特征。</p> 
  <p>其中的关键网络模块GhostVLAD既实现特征聚合，同时降低低质量图像的权重，提高高质量图像的聚合权重。说白了一句话，既然不要人为参与，那就要构建一种网络结构，让网络自动学习对识别不重要的信息，并丢掉它。作者是在NetVLAD上做出的算法改进，前文已提到，NetVLAD可以理解为一种可微分完全可训练的VLAD编码聚合方法，它的作用大致是自动计算特征聚类中心，计算残差，然后把残差加权，构建聚合特征矩阵，整个过程方便加入到神经网络中。</p> 
  <p>GhostVLAD的改进则是增加聚类中心的个数到K+G，但是增加的聚类中心在构建聚合特征矩阵的时候不参与贡献权重。如下图所示：</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109202232352.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="TIM截图20190109175539"><br> 红色位置即标示出的Ghost 聚类中心，后续步骤中被去除，Ghost有“幻象”的意思，可能很多模糊的人脸的确看起来是“幻象”，这也是GhostVLAD名称的由来。这些多出来的不参与聚合特征矩阵构建的Ghost聚类中心，就相当于给了神经网络丢弃一部分信息使得网络更具鉴别性的可能，而在原来的NetVLAD中是体现不出来的。</p> 
  <h5><a id="_120"></a>实验结果</h5> 
  <p>作者首先设计的实验是比较网络加上GhostVLAD层跟不加的精度，验证其有效性，作者使用的训练集是VGGFace2。实验设置不再赘述，这里直接给出结果。</p> 
  <p>在IJB-B数据集上的<strong>1:1人脸验证</strong>结果比较如下图，取得了大幅度的精度提升。</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190109202250290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="TIM截图20190109175821"><br> 在IJB-B数据集上的1:N人脸识别结果比较如下图，同样取得了大幅度的精度提升。</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/2019010920230134.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="TIM截图20190109180011"><br> 最后作者可视化了使用GhostVLAD后对输入样本权重的影响，发现对于那些低质量模糊人脸的确权重被降低了。如下图所示：</p> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/201901092023168.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI0OTU0MzQ1,size_16,color_FFFFFF,t_70" alt="TIM截图20190109180214"></p> 
  <h5><a id="_134"></a>总结</h5> 
  <p>这篇文章从一个简单的直觉开始，构建了一种帮助神经网络丢弃鉴别性不足的信息的有效方式，大幅改进了基于图像集合的人脸识别方法，算法具有较高的实用价值，思想也很值得借鉴！</p> 
  <p>值得一提的是，该文中的GhostVLAD方法不仅仅适用于人脸识别，在图像检索、行人重识别等领域也同样适用。</p> 
  <h3><a id="_140"></a>报告总结</h3> 
  <p>这三篇论文都是围绕着VLAD来进行的研究，可以说是论文b和c都是在基于论文a提出的方法对不同的应用领域开展的探索。关于NetVLAD的应用其实也不止这些，如ECCV2018年一篇文章利用NetVLAD方法，将局部点云特征进行聚合，很好了提升了3D目标识别效果。</p> 
  <p>总的来说，这些应用都离不开VLAD本质上的特点：</p> 
  <ol> 
   <li>可以理解成一种Pooling的方式，即将多个维度不同的特征聚合，生成一个能够有效描述这些特征集的向量。</li> 
   <li>或者可以理解成一个多示例（multi-instance）问题，在把众多的特征比作多个示例，这些示例特征，哪些能够对分类有效，哪些没有用，我们可以用VLAD来自行挑选具有辨识能力的instance。</li> 
  </ol> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
