<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>机器学习笔记之隐马尔科夫模型 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="机器学习笔记之隐马尔科夫模型" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="版权声明：本文为博主原创文章，转载请指明作者以及链接，并通知作者，谢谢。 https://blog.csdn.net/wshixinshouaaa/article/details/85701540 隐马尔科夫HMM 一、序言 二、基本概念 2.1 定义 2.2 例子 2.3 基本假设 三、三个问题 3.1 概率计算问题 3.2 学习问题 3.3 预测问题 四、三个问题解决算法 4.1 概率计算算法 4.1.1 直接计算法（暴力法） 4.1.2 前向算法 4.1.2.1 详解 4.1.2.2 例子 4.1.3 后向算法 4.1.3 一些概率与期望的计算 4.2 学习算法 4.2.1 监督算法 4.2.2 Baum-Welch 算法 4.3 预测算法 Reference 一、序言 重新复习隐马尔科夫模型，重点是HMM模型的三个问题及前向、后向和维特比算法。 二、基本概念 2.1 定义 隐马尔可夫模型由初始概率分布、状态转移概率分布以及观测概率分布确定。隐马尔可夫模型的形式定义如下: 设Q是所有可能的状态的集合,V是所有可能的观测的集合。 Q = q 1 , q 2 , . . . , q n , V = v 1 , v 2 , . . . v m Q={q_{1},q_{2},...,q_{n}}, \quad V={v_{1},v_{2},...v_{m}} Q=q1​,q2​,...,qn​,V=v1​,v2​,...vm​ 其中, n n n是可能的状态数, m m m是可能的观测数。 设 I I I是长度为 t t t的状态序列, O O O是对应的观测序列: I = i 1 , i 2 , . . . , i t , O = o 1 , o 2 , . . . , o t I={i_{1},i_{2},...,i_{t}}, \quad O={o_{1},o_{2},...,o_{t}} I=i1​,i2​,...,it​,O=o1​,o2​,...,ot​ A A A是状态转移概率矩阵: A = [ a i j ] n × n A=[a_{ij}]_{n×n} A=[aij​]n×n​ 其中, a i j = P ( i t = q j ∣ i t − 1 = q i ) , i = 1 , . . . n ; j = 1 , . . . , n a_{ij}=P(i_{t}=q_{j}|i_{t-1}=q_{i}), \quad i=1,...n;j=1,...,n aij​=P(it​=qj​∣it−1​=qi​),i=1,...n;j=1,...,n 是在时刻 t − 1 t-1 t−1处于状态 q i q_{i} qi​的条件下在时刻 t t t转移到状态 q j q_{j} qj​的概率。 B B B是观测概率矩阵: B = [ b j k ] n × m B=[b_{jk}]_{n×m} B=[bjk​]n×m​ 其中， b k j = P ( o t = v k ∣ i t = q j ) , k = 1 , . . . m , j = 1 , . . . , n b_{kj}=P(o_{t}=v_{k}|i_{t}=q_{j}), \quad k=1,...m,j=1,...,n bkj​=P(ot​=vk​∣it​=qj​),k=1,...m,j=1,...,n 是在时刻 t t t处于状态 q j q_{j} qj​的条件下生成观测 v k v_{k} vk​的概率。 π \pi π是初始状态概率向量: π = π i \pi=\pi_{i} π=πi​ 其中， π i = P ( i 1 = q i ) , i = 1 , . . . n \pi_{i}=P(i_{1}=q_{i}), \quad i=1,...n πi​=P(i1​=qi​),i=1,...n 是初始时刻 t = 1 t=1 t=1处于状态 q i q_{i} qi​的概率。 2.2 例子 举个例子，当观察到屋外艳阳高照，那么肯定是晴天；若是半乌云密布，则是阴天；若是电闪雷鸣，则是雨天。艳阳高照，乌云密布，电闪雷鸣是我们能直接观察到的，对应着上面定义的观测序列。 而它们对应的天气状态分别是晴天、阴天和雨天，则是状态序列，因为我们先观察到外边的环境是艳阳高照，乌云密布，电闪雷鸣，然后再推测出是晴天、阴天还是雨天。 如下图所示，上面的是一条隐马尔科夫链，下面对应着其随机生成的状态序列。 如下图所示，是一个完整的 HMM 模型。 状态集合 Q = q 1 , q 2 , q 3 Q={q_{1},q_{2},q_{3}} Q=q1​,q2​,q3​，其中 q 1 = 艳 阳 高 照 q_{1}=艳阳高照 q1​=艳阳高照， q 2 = 乌 云 密 布 q_{2}=乌云密布 q2​=乌云密布， q 3 = 电 闪 雷 鸣 q_{3}=电闪雷鸣 q3​=电闪雷鸣。 观测集合 V = v 1 , v 2 , v 3 V={v_{1},v_{2},v_{3}} V=v1​,v2​,v3​，其中 v 1 = 晴 天 v_{1}=晴天 v1​=晴天， v 2 = 阴 天 v_{2}=阴天 v2​=阴天， v 3 = 雨 天 v_{3}=雨天 v3​=雨天。 状态转移概率矩阵 A A A： 观测概率矩阵 B B B： 初始状态概率 π \pi π： 以上数据是随便写的。 2.3 基本假设 三、三个问题 只看这个可能有点晦涩，下面就例子说的通俗一下： 3.1 概率计算问题 评估问题，即概率计算问题，是三个问题中最简单的。给定 HMM 模型 λ \lambda λ，也就是已经知道状态转移概率矩阵 A A A、观测概率矩阵 B B B 和初始状态概率 π \pi π，同时给出观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，求在该 HMM 模型下这个观测序列生成的概率。例如求接下来三天的观测天气是（阴天，雨天，晴天）的概率。解决算法：前向-后向算法。 3.2 学习问题 学习问题是三个问题中最复杂的一个。这个问题中只给出观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，让求 HMM 模型 λ \lambda λ 的三个参数： A A A、 B B B 和 π \pi π。例如，给出观测天气是（阴天，雨天，晴天），根据观测序列求一个 HMM 模型。解决算法： B a u m − W e l c h Baum-Welch Baum−Welch 算法（EM算法）。 3.3 预测问题 预测问题，也称为解码问题。给定 HMM 模型 λ \lambda λ 和观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，求在该 HMM 模型下最有可能生成这个观测序列的隐状态序列。例如，观测天气是（阴天，雨天，晴天），求最有可能对应该观测序列的状态序列是（艳阳高照，乌云密布，电闪雷鸣），还是（乌云密布，电闪雷鸣，艳阳高照），或者是其他的某个状态序列。解决算法： V i t e r b i Viterbi Viterbi 算法（一种动态规划）。 四、三个问题解决算法 4.1 概率计算算法 目的：给定 HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 和观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求在该HMM 模型下生成该观测序列的概率 P ( O ∣ λ ) P(O|\lambda) P(O∣λ)。 4.1.1 直接计算法（暴力法） 首先，在给定 HMM 模型下，生成 一个 隐状态序列 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​ 的概率为： P ( I ∣ λ ) = π i 1 a i 1 i 2 a i 2 i 3 . . . a i T − 1 i T P(I|\lambda) = \pi_{i_{1}}a_{i_{1}i_{2}}a_{i_{2}i_{3}}...a_{i_{T-1}i_{T}} P(I∣λ)=πi1​​ai1​i2​​ai2​i3​​...aiT−1​iT​​ 然后，在该状态序列，生成对应的观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​ 的改立为： P ( O ∣ I , λ ) = b i 1 o 1 b i 2 o 2 . . . b i T o T P(O|I,\lambda) = b_{i_{1}o_{1}}b_{i_{2}o_{2}}...b_{i_{T}o_{T}} P(O∣I,λ)=bi1​o1​​bi2​o2​​...biT​oT​​ 最后，在给定 HMM 模型下，生成状态序列 I I I 和观测序列 O O O 的联合概率为： P ( O , I ∣ λ ) = P ( O ∣ I , λ ) P ( I ∣ λ ) = π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O,I|\lambda) = P(O|I,\lambda)P(I|\lambda) = \pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O,I∣λ)=P(O∣I,λ)P(I∣λ)=πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 综上是 HMM 模型生成一个状态序列，再生成观测序列的概率。只要对所有不同的状态序列 I I I 求和，就是要求的给定观测序列的概率 P ( O ∣ λ ) P(O|\lambda) P(O∣λ)： P ( O ∣ λ ) = ∑ I P ( O ∣ I , λ ) P ( I ∣ λ ) = ∑ I 1 , I 2 , . . . π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O|\lambda) = \sum_{I}P(O|I,\lambda)P(I|\lambda) = \sum_{I_{1},I_{2},...}\pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O∣λ)=I∑​P(O∣I,λ)P(I∣λ)=I1​,I2​,...∑​πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 使用该算法原理简单，但是计算量巨大。时间复杂度： O ( T N T ) O(TN^{T}) O(TNT)。 4.1.2 前向算法 4.1.2.1 详解 前向概率 α t ( i ) \alpha_{t}(i) αt​(i) 如下图所示： 其实，前向算法可以看做是动态规划。 注意看呦， α t ( i ) = P ( o 1 , o 2 , . . . , o t , i t = q t ∣ λ ) \alpha_{t}(i) = P(o_{1},o_{2},...,o_{t},i_{t}=q_{t}|\lambda) αt​(i)=P(o1​,o2​,...,ot​,it​=qt​∣λ) 这不就是 暴力法中第三步 求的状态序列 I I I 和观测序列 O O O 的联合概率吗？ 我们只要把 t t t 时刻中所有状态序列 q i ∈ ( q 1 , q 2 , . . . , q n ) q_{i} \in (q_{1},q_{2},...,q_{n}) qi​∈(q1​,q2​,...,qn​) 做累加，然后乘上 t + 1 t+1 t+1 时刻 q i q_{i} qi​ 对应的观测概率，即 [ ∑ j = 1 n α t ( j ) a j i ] b i o t + 1 [\sum_{j=1}^n \alpha_{t}(j)a_{ji}]b_{i}o_{t+1} [∑j=1n​αt​(j)aji​]bi​ot+1​，就得到 t + 1 t+1 t+1 时刻的状态序列 I I I 和观测序列 O O O 的联合概率，即前向概率 α t + 1 ( i ) \alpha_{t+1}(i) αt+1​(i)。 如下图所示： 所以，只要计算出 t = 1 t=1 t=1 时刻的前向概率 α 1 ( i ) \alpha_{1}(i) α1​(i)，往后依次递推就可以了。例如 α 1 ( i ) = π i 1 b i 1 o 1 \alpha_{1}(i) = \pi_{i_{1}}b_{i_{1}o_{1}} α1​(i)=πi1​​bi1​o1​​， α 2 ( i ) = α 1 ( 1 ) b 1 o i + α 1 ( 2 ) b 2 o i + . . . + α 1 ( n ) b n o i \alpha_{2}(i) = \alpha_{1}(1)b_{1}o_{i} + \alpha_{1}(2)b_{2}o_{i} +...+\alpha_{1}(n)b_{n}o_{i} α2​(i)=α1​(1)b1​oi​+α1​(2)b2​oi​+...+α1​(n)bn​oi​。 综上： 4.1.2.2 例子 观测集合为： V = ( 红 ， 白 ) V=(红，白) V=(红，白) 状态集合为： Q = ( 盒 子 1 , 盒 子 2 , 盒 子 3 ) Q=(盒子1,盒子2,盒子3) Q=(盒子1,盒子2,盒子3) 观测序列为： O = ( 红 ， 白 ， 红 ) O=(红，白，红) O=(红，白，红) 状态转移概率矩阵为 A A A : 第 i i i 行表示选择第 i i i 个盒子，第 j j j 列表示转移到第 j j j 个盒子， 比如： A 23 A_{23} A23​ 表示上一次选择第二个盒子，这次选择第三个盒子的概率为 0.2。 观测概率矩阵 B B B： 第 i i i 行表示选择的是第 i i i 个盒子，第 j j j 列表示从该盒子取到 j j j 号球， 比如： B 31 B_{31} B31​ 表示从第二个盒子取出球的概率为 0.7。 （1) 计算初值 t = 1 t=1 t=1 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子1的概率： α 1 ( 1 ) = π 1 b 1 o 1 = 0.2 × 0.5 = 0.10 \alpha_{1}(1) = \pi_{1}b_{1o_{1}} = 0.2×0.5=0.10 α1​(1)=π1​b1o1​​=0.2×0.5=0.10 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子2的概率： α 1 ( 2 ) = π 2 b 2 o 1 = 0.4 × 0.4 = 0.16 \alpha_{1}(2) = \pi_{2}b_{2o_{1}} = 0.4×0.4=0.16 α1​(2)=π2​b2o1​​=0.4×0.4=0.16 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子3的概率： α 1 ( 3 ) = π 3 b 3 o 1 = 0.4 × 0.7 = 0.28 \alpha_{1}(3) = \pi_{3}b_{3o_{1}} = 0.4×0.7=0.28 α1​(3)=π3​b3o1​​=0.4×0.7=0.28 （2) 递推计算 t = 2 t=2 t=2 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子1的概率： α 2 ( 1 ) = [ ∑ i = 1 3 α 1 ( i ) a i 1 ] b 1 o 2 = ( 0.10 × 0.5 + 0.16 × 0.3 + 0.28 ∗ 0.2 ) × 0.5 = 0.154 × 0.5 = 0.077 \alpha_{2}(1) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i1}]b_{1o_{2}} = (0.10×0.5+0.16×0.3+0.28*0.2)×0.5=0.154×0.5=0.077 α2​(1)=[i=1∑3​α1​(i)ai1​]b1o2​​=(0.10×0.5+0.16×0.3+0.28∗0.2)×0.5=0.154×0.5=0.077 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子2的概率： α 2 ( 2 ) = [ ∑ i = 1 3 α 1 ( i ) a i 2 ] b 2 o 2 = ( 0.10 × 0.2 + 0.16 × 0.5 + 0.28 ∗ 0.3 ) × 0.6 = 0.184 × 0.6 = 0.1104 \alpha_{2}(2) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i2}]b_{2o_{2}} = (0.10×0.2+0.16×0.5+0.28*0.3)×0.6=0.184×0.6=0.1104 α2​(2)=[i=1∑3​α1​(i)ai2​]b2o2​​=(0.10×0.2+0.16×0.5+0.28∗0.3)×0.6=0.184×0.6=0.1104 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子3的概率： α 2 ( 3 ) = [ ∑ i = 1 3 α 1 ( i ) a i 3 ] b 3 o 2 = ( 0.10 × 0.3 + 0.16 × 0.2 + 0.28 ∗ 0.5 ) × 0.3 = 0.202 × 0.3 = 0.0606 \alpha_{2}(3) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i3}]b_{3o_{2}} = (0.10×0.3+0.16×0.2+0.28*0.5)×0.3=0.202×0.3=0.0606 α2​(3)=[i=1∑3​α1​(i)ai3​]b3o2​​=(0.10×0.3+0.16×0.2+0.28∗0.5)×0.3=0.202×0.3=0.0606 （3) 递推计算 t = 3 t=3 t=3 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子1的概率： α 3 ( 1 ) = [ ∑ i = 1 3 α 2 ( i ) a i 1 ] b 1 o 2 = 0.04187 \alpha_{3}(1) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i1}]b_{1o_{2}}=0.04187 α3​(1)=[i=1∑3​α2​(i)ai1​]b1o2​​=0.04187 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子2的概率： α 3 ( 2 ) = [ ∑ i = 1 3 α 2 ( i ) a i 2 ] b 2 o 2 = 0.03551 \alpha_{3}(2) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i2}]b_{2o_{2}}=0.03551 α3​(2)=[i=1∑3​α2​(i)ai2​]b2o2​​=0.03551 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子2的概率： α 3 ( 3 ) = [ ∑ i = 1 3 α 2 ( i ) a i 3 ] b 3 o 2 = 0.05284 \alpha_{3}(3) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i3}]b_{3o_{2}}=0.05284 α3​(3)=[i=1∑3​α2​(i)ai3​]b3o2​​=0.05284 （4) 终止 P ( O ∣ λ ) = ∑ i = 1 3 α 3 ( i ) = 0.13022 P(O|\lambda) =\sum_{i=1}^3 \alpha_{3}(i)=0.13022 P(O∣λ)=i=1∑3​α3​(i)=0.13022 4.1.3 后向算法 其实后向算法和前向算法类似，只不过是从后往前递推。 后向概率 β t ( i ) \beta{t}(i) βt(i) 如下图所示： 首先，定义最后时刻的 β T ( i ) = 1 \beta_{T}(i) = 1 βT​(i)=1。 然后 ，对于 t = T − 1 , T − 2 , . . . , 1 t = T-1,T-2,...,1 t=T−1,T−2,...,1，后向概率 β t ( i ) \beta_{t}(i) βt​(i) 就等于 t t t 时刻的状态 i t = q i i_{t} = q_{i} it​=qi​ 转移到时刻 t + 1 t+1 t+1 的状态 i t + 1 = q j i_{t+1} = q_{j} it+1​=qj​ 的概率 × t + 1 t+1 t+1 时刻状态 i t + 1 i_{t+1} it+1​ 对应的观测状态 o t + 1 o_{t+1} ot+1​ 的概率 × t + 1 t+1 t+1 时刻的后向概率 β t + 1 ( i ) \beta_{t+1}(i) βt+1​(i)。即： β t ( i ) = ∑ j = 1 n a i j b j o t + 1 β t + 1 ( i ) \beta_{t}(i) = \sum_{j=1}^n a_{ij}b_{jo_{t+1}}\beta_{t+1}(i) βt​(i)=j=1∑n​aij​bjot+1​​βt+1​(i) 如下图所示： 最后，观测概率 P ( O ∣ λ ) = ∑ i = 1 n π i b i o 1 β 1 ( i ) P(O|\lambda) = \sum_{i=1}^n \pi_{i}b_{io_{1}}\beta_{1}(i) P(O∣λ)=∑i=1n​πi​bio1​​β1​(i)。 其实，观测概率 P ( O ∣ λ ) P(O|\lambda) P(O∣λ) 还可以这么写： P ( O ∣ λ ) = ∑ i = 1 n ∑ j = 1 n α t ( i ) a i j b j o t + 1 β t + 1 ( j ) P(O|\lambda) = \sum_{i=1}^n \sum_{j=1}^n \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j) P(O∣λ)=i=1∑n​j=1∑n​αt​(i)aij​bjot+1​​βt+1​(j) 是不是其实很好理解。 4.1.3 一些概率与期望的计算 利用前向概率和后向概率,可以得到关于单个状态和两个状态概率的计算公式。 给定模型 λ \lambda λ 和观测 O O O，在时刻 t t t 处于状态 q i q_{i} qi​ 的概率。记 γ t ( i ) = P ( i t = q i ∣ O , λ ) = P ( i t = q i , O ∣ λ ) P ( O ∣ λ ) \gamma_{t}(i) = P(i_{t}=q_{i}|O,\lambda) = \frac{P(i_{t}=q_{i},O|\lambda)}{P(O|\lambda)} γt​(i)=P(it​=qi​∣O,λ)=P(O∣λ)P(it​=qi​,O∣λ)​ 由前向概率 α t ( i ) \alpha_t(i) αt​(i) 和后向概率 β t ( i ) \beta_t(i) βt​(i) 定义可知: α t ( i ) β t ( i ) = P ( i t = q t ∣ O , λ ) \alpha_{t}(i)\beta_t(i) = P(i_{t}=q_{t}|O,\lambda) αt​(i)βt​(i)=P(it​=qt​∣O,λ) 于是得到: γ t ( i ) = α t ( i ) β t ( i ) P ( O ∣ λ ) = α t ( i ) β t ( i ) ∑ j = 1 N α t ( j ) β t ( j ) \gamma_{t}(i) = \frac{\alpha_{t}(i)\beta_t(i)}{P(O|\lambda)} = \frac{\alpha_{t}(i)\beta_t(i)}{\sum_{j=1}^N \alpha_{t}(j)\beta_t(j)} γt​(i)=P(O∣λ)αt​(i)βt​(i)​=∑j=1N​αt​(j)βt​(j)αt​(i)βt​(i)​ 给定模型 λ \lambda λ 和观测 O O O，在时刻 t t t 处于状态 q i q_{i} qi​ 的概率。同时在时刻 t + 1 t+1 t+1 处于状态 q j q_{j} qj​ 的概率，记 ξ t ( i , j ) = P ( i t = q i , i t + 1 = q j ∣ O , λ ) = P ( i t = q i , i t + 1 = q j , O ∣ λ ) ∑ i = 1 N ∑ j = 1 N P ( i t = q i , i t + 1 = q j , O ∣ λ ) \xi_{t}(i,j) = P(i_{t}=q_{i},i_{t+1}=q_{j}|O,\lambda) = \frac{P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda)}{\sum_{i=1}^N \sum_{j=1}^N P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda)} ξt​(i,j)=P(it​=qi​,it+1​=qj​∣O,λ)=∑i=1N​∑j=1N​P(it​=qi​,it+1​=qj​,O∣λ)P(it​=qi​,it+1​=qj​,O∣λ)​ 而 P ( i t = q i , i t + 1 = q j , O ∣ λ ) = α t ( i ) a i j b j o t + 1 β t + 1 ( j ) P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda) = \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j) P(it​=qi​,it+1​=qj​,O∣λ)=αt​(i)aij​bjot+1​​βt+1​(j) 所以 ξ t ( i , j ) = q j , O ∣ λ ) = α t ( i ) a i j b j o t + 1 β t + 1 ( j ) ∑ i = 1 N ∑ j = 1 N α t ( i ) a i j b j o t + 1 β t + 1 ( j ) \xi_{t}(i,j) = q_{j},O|\lambda) = \frac{\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)}{\sum_{i=1}^N \sum_{j=1}^N \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)} ξt​(i,j)=qj​,O∣λ)=∑i=1N​∑j=1N​αt​(i)aij​bjot+1​​βt+1​(j)αt​(i)aij​bjot+1​​βt+1​(j)​ 4.2 学习算法 目的： 给定观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​ 和状态序列 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​，求HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 的三个参数。 给定观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 的三个参数。 解决方法： 监督算法 B a u m − W e l c h Baum-Welch Baum−Welch 算法 4.2.1 监督算法 第二步求观测概率应该是 b j k b_{jk} bjk​，因为懒，就直接截图了。 4.2.2 Baum-Welch 算法 现在已经知道的是观测数据 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​， 设隐状态数据为 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​，那么完全数据是 ( O , I ) = ( o 1 , o 2 , . . . , o T , i 1 , i 2 , . . . , i T ) (O,I)=(o_{1},o_{2},...,o_{T},i_{1},i_{2},...,i_{T}) (O,I)=(o1​,o2​,...,oT​,i1​,i2​,...,iT​)。完全数据的对数似然函数是 l o g P ( O , I ∣ λ ) logP(O,I|\lambda) logP(O,I∣λ)。 既然 B a u m − W e l c h Baum-Welch Baum−Welch 算法使用的就是 E M EM EM 算法，那么就要走两个步骤： （1） E E E 步 求出联合分布 P ( O , I ∣ λ ) P(O,I|\lambda) P(O,I∣λ) 基于条件概率 ( I ∣ O , λ ‾ ) (I|O,\overline \lambda) (I∣O,λ) 的期望，其中 λ ‾ \overline \lambda λ 为 HMM 模型参数的当前估计值， λ \lambda λ 为极大化的 HMM 模型参数。 （2） M M M 步 最大化这个期望，得到更新的模型参数λ。接着不停的进行EM迭代，直到模型参数的值收敛为止。 公式推导： （1） E E E 步：求 Q Q Q 函数 根据 E M EM EM 的 Q Q Q 函数定义，即这里要求的联合分布的期望为： Q ( λ , λ ‾ ) = ∑ I P ( I ∣ O , λ ‾ ) l n P ( O , I ∣ λ ) = ∑ I l n P ( O , I ∣ λ ) P ( I , O ∣ λ ‾ ) P ( O , λ ‾ ) Q(\lambda,\overline \lambda) = \sum_{I}P(I|O,\overline \lambda)lnP(O,I|\lambda) = \sum_{I}lnP(O,I|\lambda)\frac{P(I,O|\overline \lambda)}{P(O,\overline \lambda)} Q(λ,λ)=I∑​P(I∣O,λ)lnP(O,I∣λ)=I∑​lnP(O,I∣λ)P(O,λ)P(I,O∣λ)​ P ( O , λ ‾ ) P(O,\overline \lambda) P(O,λ) 表示上次求出的参数与观测数据的联合概率，没有什么影响，所以： Q ( λ , λ ‾ ) = ∑ I l n P ( O , I ∣ λ ) P ( I , O ∣ λ ‾ ) Q(\lambda,\overline \lambda) = \sum_{I}lnP(O,I|\lambda)P(I,O|\overline \lambda) Q(λ,λ)=I∑​lnP(O,I∣λ)P(I,O∣λ) 而 P ( O , I ∣ λ ) = π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O,I|\lambda) = \pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O,I∣λ)=πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 所以 Q ( λ , λ ‾ ) = ∑ I P ( I , O ∣ λ ‾ ) [ l n π i 1 + l n ( a i 1 i 2 + . . . + a i T − 1 i T + l n ( b i 1 o 1 + . . . + b i T o T ) ) ] = ∑ I l n π i 1 P ( I , O ∣ λ ‾ ) ⎵ 式 1 + ∑ I ( ∑ t = 1 T − 1 l n a i t i t + 1 ) P ( I , O ∣ λ ‾ ) ⎵ 式 2 + ∑ I ( ∑ t = 1 T l n b i t o t ) P ( I , O ∣ λ ‾ ) ⎵ 式 3 Q(\lambda,\overline \lambda) = \sum_{I}P(I,O|\overline \lambda) [ln \pi_{i_{1}} + ln(a_{i_{1}i_{2}}+...+a_{i_{T-1}i_{T}} + ln(b_{i_{1}o_{1}}+...+b_{i_{T}o_{T}}))] \\ = \underbrace{ \sum_{I} ln \pi_{i_{1}} P(I,O|\overline \lambda)}_{式1} + \underbrace{ \sum_{I} (\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(I,O|\overline \lambda)}_{式2} + \underbrace{ \sum_{I} (\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\overline \lambda)}_{式3} Q(λ,λ)=I∑​P(I,O∣λ)[lnπi1​​+ln(ai1​i2​​+...+aiT−1​iT​​+ln(bi1​o1​​+...+biT​oT​​))]=式1 I∑​lnπi1​​P(I,O∣λ)​​+式2 I∑​(t=1∑T−1​lnait​it+1​​)P(I,O∣λ)​​+式3 I∑​(t=1∑T​lnbit​ot​​)P(I,O∣λ)​​ （2） M M M 步：极大化 Q Q Q，求模型参数 A , B , π A,B,\pi A,B,π 　1）求 π i \pi_{i} πi​： 　既然是求极值，肯定是要求导了。对于 π i \pi_{i} πi​ 来说，满足约束条件 ∑ t = 1 N π i = 1 \sum_{t=1}^N \pi_{i}=1 ∑t=1N​πi​=1。现在就变成了带约束条件的求极值，直接上拉格朗日乘子法。 　式 1 可以写成： 　 ∑ I l n π i 1 P ( I , O ∣ λ ‾ ) = ∑ i = 1 N l n π i P ( O , i 1 = q i ∣ λ ‾ ) \sum_{I} ln \pi_{i_{1}} P(I,O|\overline \lambda) = \sum_{i=1}^N ln \pi_{i} P(O,i_{1}=q_{i}|\overline \lambda) I∑​lnπi1​​P(I,O∣λ)=i=1∑N​lnπi​P(O,i1​=qi​∣λ) 　拉格朗日函数： 　 L = ∑ i = 1 N l n π i P ( O , i 1 = q i ∣ λ ‾ ) + γ ( ∑ i = 1 N π i − 1 ) L = \sum_{i=1}^N ln \pi_{i}P(O,i_{1}=q_{i}|\overline \lambda) + \gamma(\sum_{i=1}^N \pi_{i}-1) L=i=1∑N​lnπi​P(O,i1​=qi​∣λ)+γ(i=1∑N​πi​−1) 　首先把求和 ∑ \sum ∑ 去掉，只对单个的 π i \pi_{i} πi​ 求偏导并等于 0： 　 ∂ L ∂ π i = P ( O , i 1 = q i ∣ λ ‾ ) π i + γ = 0 \frac{\partial L}{\partial \pi_{i}} = \frac{P(O,i_{1}=q_{i}|\overline \lambda)}{\pi_{i}} + \gamma = 0 ∂πi​∂L​=πi​P(O,i1​=qi​∣λ)​+γ=0 　等价于： 　 ∂ L ∂ π i = P ( O , i 1 = q i ∣ λ ‾ ) + γ π i = 0 \frac{\partial L}{\partial \pi_{i}} =P(O,i_{1}=q_{i}|\overline \lambda) + \gamma \pi_{i} = 0 ∂πi​∂L​=P(O,i1​=qi​∣λ)+γπi​=0 　然后再添上对 i i i 的求和 ∑ \sum ∑，可得到： 　 γ = − P ( O ∣ λ ‾ ) \gamma = -P(O|\overline \lambda) γ=−P(O∣λ) 　带入到第三项公式，可得： 　 π i = P ( O , i 1 = q i ∣ λ ‾ ) P ( O ∣ λ ‾ ) \pi_{i} = \frac{P(O,i_{1}=q_{i}|\overline \lambda)}{P(O|\overline \lambda)} πi​=P(O∣λ)P(O,i1​=qi​∣λ)​ 2）求 a i j a_{ij} aij​： 　式 2 可以写成： 　 ∑ I ( ∑ t = 1 T − 1 l n a i t i t + 1 ) P ( O , I ∣ λ ‾ ) = ∑ i = 1 N ∑ j = 1 N ∑ t = 1 T − 1 l n a i j P ( O , i t = q i , i t + 1 = q j ∣ λ ‾ ) \sum_{I} (\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(O,I|\overline \lambda) = \sum_{i=1}^N \sum_{j=1}^N \sum_{t=1}^{T-1} ln a_{ij} P(O,i_{t}=q_{i},i_{t+1}=q_{j}|\overline \lambda) I∑​(t=1∑T−1​lnait​it+1​​)P(O,I∣λ)=i=1∑N​j=1∑N​t=1∑T−1​lnaij​P(O,it​=qi​,it+1​=qj​∣λ) 　同样有约束条件 ∑ j = 1 N a i j = 1 \sum_{j=1}^Na_{ij}=1 ∑j=1N​aij​=1，最后可以得到： 　 a i j = ∑ t = 1 T − 1 P ( O , i 1 = q i , i t + 1 = q j ∣ λ ‾ ) P ( O , i t = q i ∣ λ ‾ ) a_{ij} = \frac{\sum_{t=1}^{T-1} P(O,i_{1}=q_{i},i_{t+1}=q_{j}|\overline \lambda)}{P(O,i_{t}=q_{i}|\overline \lambda)} aij​=P(O,it​=qi​∣λ)∑t=1T−1​P(O,i1​=qi​,it+1​=qj​∣λ)​ 　3）求 b i j b_{ij} bij​： 　式 3 可以写成： 　　 ∑ I ( ∑ t = 1 T l n b i t o t ) P ( I , O ∣ λ ‾ ) = ∑ j = 1 N ∑ t = 1 T − 1 l n b j o t P ( O , i t = q j ∣ λ ‾ ) \sum_{I} (\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\overline \lambda) = \sum_{j=1}^N \sum_{t=1}^{T-1} lnb_{jo_{t}}P(O,i_{t}=q_{j}|\overline \lambda) I∑​(t=1∑T​lnbit​ot​​)P(I,O∣λ)=j=1∑N​t=1∑T−1​lnbjot​​P(O,it​=qj​∣λ) 　同样有约束条件 ∑ k = 1 M b j k = 1 \sum_{k=1}^M b_{jk}=1 ∑k=1M​bjk​=1，要注意的是只有在 o t = v k o_{t}=v_{k} ot​=vk​ 时 b j o t b_{jo_{t}} bjot​​ 对 b j k b_{jk} bjk​ 的偏导数才不为 0，以 I ( o t = v k ) I(o_{t}=v_{k}) I(ot​=vk​) 表示，最后可以得到： 　 b j k = ∑ t = 1 T P ( O , i t = q j ∣ λ ‾ ) I ( o t = v k ) ∑ t = 1 T P ( O , i t = q j ∣ λ ‾ ) b_{jk} = \frac{\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\overline \lambda) I(o_{t}=v_{k})}{\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\overline \lambda)} bjk​=∑t=1T​P(O,it​=qj​∣λ)∑t=1T​P(O,it​=qj​∣λ)I(ot​=vk​)​ 参数估计公式： 得到参数后，可以用 4.1.3 节的 γ t ( i ) , ξ t ( i , j ) \gamma_{t}(i),\xi_{t}(i,j) γt​(i),ξt​(i,j) 表示： 算法总结： 4.3 预测算法 目的：给定 HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 和观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求在该观测序列下，最可能对应的状态序列 I ∗ = i 1 ∗ , i 2 ∗ , . . . , i T ∗ I^*={i_{1}^*,i_{2}^*,...,i_{T}^*} I∗=i1∗​,i2∗​,...,iT∗​，也就是最大化 P ( I ∗ ∣ O ) P(I^*|O) P(I∗∣O)。 解决：Viterbi 算法。 其实维特比算法就用动态规划的方法求概率最大路径，计算过程中的每条路径都对应着一个状态序列。计算过程中将最优路径经过的点都保存下来。得到最优路径后，由后向前逐步求得最优结点，这就是维特比算法。 过程： 因为计算过程很简单，就直接给出书中的截图了。 首先导入两个变量 δ \delta δ和 ψ \psi ψ。定义在时刻 t t t 状态为 i i i 的所有单个路径 ( i 1 , i 2 , . . . , i t ) (i_{1} ,i_{2},...,i_{t} ) (i1​,i2​,...,it​) 中概率最大值为： 过程是不是很好理解？如果还不好理解，就继续看个例子。 例子： 整个计算过程如下图所示， Reference 统计学习方法 李航" />
<meta property="og:description" content="版权声明：本文为博主原创文章，转载请指明作者以及链接，并通知作者，谢谢。 https://blog.csdn.net/wshixinshouaaa/article/details/85701540 隐马尔科夫HMM 一、序言 二、基本概念 2.1 定义 2.2 例子 2.3 基本假设 三、三个问题 3.1 概率计算问题 3.2 学习问题 3.3 预测问题 四、三个问题解决算法 4.1 概率计算算法 4.1.1 直接计算法（暴力法） 4.1.2 前向算法 4.1.2.1 详解 4.1.2.2 例子 4.1.3 后向算法 4.1.3 一些概率与期望的计算 4.2 学习算法 4.2.1 监督算法 4.2.2 Baum-Welch 算法 4.3 预测算法 Reference 一、序言 重新复习隐马尔科夫模型，重点是HMM模型的三个问题及前向、后向和维特比算法。 二、基本概念 2.1 定义 隐马尔可夫模型由初始概率分布、状态转移概率分布以及观测概率分布确定。隐马尔可夫模型的形式定义如下: 设Q是所有可能的状态的集合,V是所有可能的观测的集合。 Q = q 1 , q 2 , . . . , q n , V = v 1 , v 2 , . . . v m Q={q_{1},q_{2},...,q_{n}}, \quad V={v_{1},v_{2},...v_{m}} Q=q1​,q2​,...,qn​,V=v1​,v2​,...vm​ 其中, n n n是可能的状态数, m m m是可能的观测数。 设 I I I是长度为 t t t的状态序列, O O O是对应的观测序列: I = i 1 , i 2 , . . . , i t , O = o 1 , o 2 , . . . , o t I={i_{1},i_{2},...,i_{t}}, \quad O={o_{1},o_{2},...,o_{t}} I=i1​,i2​,...,it​,O=o1​,o2​,...,ot​ A A A是状态转移概率矩阵: A = [ a i j ] n × n A=[a_{ij}]_{n×n} A=[aij​]n×n​ 其中, a i j = P ( i t = q j ∣ i t − 1 = q i ) , i = 1 , . . . n ; j = 1 , . . . , n a_{ij}=P(i_{t}=q_{j}|i_{t-1}=q_{i}), \quad i=1,...n;j=1,...,n aij​=P(it​=qj​∣it−1​=qi​),i=1,...n;j=1,...,n 是在时刻 t − 1 t-1 t−1处于状态 q i q_{i} qi​的条件下在时刻 t t t转移到状态 q j q_{j} qj​的概率。 B B B是观测概率矩阵: B = [ b j k ] n × m B=[b_{jk}]_{n×m} B=[bjk​]n×m​ 其中， b k j = P ( o t = v k ∣ i t = q j ) , k = 1 , . . . m , j = 1 , . . . , n b_{kj}=P(o_{t}=v_{k}|i_{t}=q_{j}), \quad k=1,...m,j=1,...,n bkj​=P(ot​=vk​∣it​=qj​),k=1,...m,j=1,...,n 是在时刻 t t t处于状态 q j q_{j} qj​的条件下生成观测 v k v_{k} vk​的概率。 π \pi π是初始状态概率向量: π = π i \pi=\pi_{i} π=πi​ 其中， π i = P ( i 1 = q i ) , i = 1 , . . . n \pi_{i}=P(i_{1}=q_{i}), \quad i=1,...n πi​=P(i1​=qi​),i=1,...n 是初始时刻 t = 1 t=1 t=1处于状态 q i q_{i} qi​的概率。 2.2 例子 举个例子，当观察到屋外艳阳高照，那么肯定是晴天；若是半乌云密布，则是阴天；若是电闪雷鸣，则是雨天。艳阳高照，乌云密布，电闪雷鸣是我们能直接观察到的，对应着上面定义的观测序列。 而它们对应的天气状态分别是晴天、阴天和雨天，则是状态序列，因为我们先观察到外边的环境是艳阳高照，乌云密布，电闪雷鸣，然后再推测出是晴天、阴天还是雨天。 如下图所示，上面的是一条隐马尔科夫链，下面对应着其随机生成的状态序列。 如下图所示，是一个完整的 HMM 模型。 状态集合 Q = q 1 , q 2 , q 3 Q={q_{1},q_{2},q_{3}} Q=q1​,q2​,q3​，其中 q 1 = 艳 阳 高 照 q_{1}=艳阳高照 q1​=艳阳高照， q 2 = 乌 云 密 布 q_{2}=乌云密布 q2​=乌云密布， q 3 = 电 闪 雷 鸣 q_{3}=电闪雷鸣 q3​=电闪雷鸣。 观测集合 V = v 1 , v 2 , v 3 V={v_{1},v_{2},v_{3}} V=v1​,v2​,v3​，其中 v 1 = 晴 天 v_{1}=晴天 v1​=晴天， v 2 = 阴 天 v_{2}=阴天 v2​=阴天， v 3 = 雨 天 v_{3}=雨天 v3​=雨天。 状态转移概率矩阵 A A A： 观测概率矩阵 B B B： 初始状态概率 π \pi π： 以上数据是随便写的。 2.3 基本假设 三、三个问题 只看这个可能有点晦涩，下面就例子说的通俗一下： 3.1 概率计算问题 评估问题，即概率计算问题，是三个问题中最简单的。给定 HMM 模型 λ \lambda λ，也就是已经知道状态转移概率矩阵 A A A、观测概率矩阵 B B B 和初始状态概率 π \pi π，同时给出观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，求在该 HMM 模型下这个观测序列生成的概率。例如求接下来三天的观测天气是（阴天，雨天，晴天）的概率。解决算法：前向-后向算法。 3.2 学习问题 学习问题是三个问题中最复杂的一个。这个问题中只给出观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，让求 HMM 模型 λ \lambda λ 的三个参数： A A A、 B B B 和 π \pi π。例如，给出观测天气是（阴天，雨天，晴天），根据观测序列求一个 HMM 模型。解决算法： B a u m − W e l c h Baum-Welch Baum−Welch 算法（EM算法）。 3.3 预测问题 预测问题，也称为解码问题。给定 HMM 模型 λ \lambda λ 和观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，求在该 HMM 模型下最有可能生成这个观测序列的隐状态序列。例如，观测天气是（阴天，雨天，晴天），求最有可能对应该观测序列的状态序列是（艳阳高照，乌云密布，电闪雷鸣），还是（乌云密布，电闪雷鸣，艳阳高照），或者是其他的某个状态序列。解决算法： V i t e r b i Viterbi Viterbi 算法（一种动态规划）。 四、三个问题解决算法 4.1 概率计算算法 目的：给定 HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 和观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求在该HMM 模型下生成该观测序列的概率 P ( O ∣ λ ) P(O|\lambda) P(O∣λ)。 4.1.1 直接计算法（暴力法） 首先，在给定 HMM 模型下，生成 一个 隐状态序列 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​ 的概率为： P ( I ∣ λ ) = π i 1 a i 1 i 2 a i 2 i 3 . . . a i T − 1 i T P(I|\lambda) = \pi_{i_{1}}a_{i_{1}i_{2}}a_{i_{2}i_{3}}...a_{i_{T-1}i_{T}} P(I∣λ)=πi1​​ai1​i2​​ai2​i3​​...aiT−1​iT​​ 然后，在该状态序列，生成对应的观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​ 的改立为： P ( O ∣ I , λ ) = b i 1 o 1 b i 2 o 2 . . . b i T o T P(O|I,\lambda) = b_{i_{1}o_{1}}b_{i_{2}o_{2}}...b_{i_{T}o_{T}} P(O∣I,λ)=bi1​o1​​bi2​o2​​...biT​oT​​ 最后，在给定 HMM 模型下，生成状态序列 I I I 和观测序列 O O O 的联合概率为： P ( O , I ∣ λ ) = P ( O ∣ I , λ ) P ( I ∣ λ ) = π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O,I|\lambda) = P(O|I,\lambda)P(I|\lambda) = \pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O,I∣λ)=P(O∣I,λ)P(I∣λ)=πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 综上是 HMM 模型生成一个状态序列，再生成观测序列的概率。只要对所有不同的状态序列 I I I 求和，就是要求的给定观测序列的概率 P ( O ∣ λ ) P(O|\lambda) P(O∣λ)： P ( O ∣ λ ) = ∑ I P ( O ∣ I , λ ) P ( I ∣ λ ) = ∑ I 1 , I 2 , . . . π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O|\lambda) = \sum_{I}P(O|I,\lambda)P(I|\lambda) = \sum_{I_{1},I_{2},...}\pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O∣λ)=I∑​P(O∣I,λ)P(I∣λ)=I1​,I2​,...∑​πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 使用该算法原理简单，但是计算量巨大。时间复杂度： O ( T N T ) O(TN^{T}) O(TNT)。 4.1.2 前向算法 4.1.2.1 详解 前向概率 α t ( i ) \alpha_{t}(i) αt​(i) 如下图所示： 其实，前向算法可以看做是动态规划。 注意看呦， α t ( i ) = P ( o 1 , o 2 , . . . , o t , i t = q t ∣ λ ) \alpha_{t}(i) = P(o_{1},o_{2},...,o_{t},i_{t}=q_{t}|\lambda) αt​(i)=P(o1​,o2​,...,ot​,it​=qt​∣λ) 这不就是 暴力法中第三步 求的状态序列 I I I 和观测序列 O O O 的联合概率吗？ 我们只要把 t t t 时刻中所有状态序列 q i ∈ ( q 1 , q 2 , . . . , q n ) q_{i} \in (q_{1},q_{2},...,q_{n}) qi​∈(q1​,q2​,...,qn​) 做累加，然后乘上 t + 1 t+1 t+1 时刻 q i q_{i} qi​ 对应的观测概率，即 [ ∑ j = 1 n α t ( j ) a j i ] b i o t + 1 [\sum_{j=1}^n \alpha_{t}(j)a_{ji}]b_{i}o_{t+1} [∑j=1n​αt​(j)aji​]bi​ot+1​，就得到 t + 1 t+1 t+1 时刻的状态序列 I I I 和观测序列 O O O 的联合概率，即前向概率 α t + 1 ( i ) \alpha_{t+1}(i) αt+1​(i)。 如下图所示： 所以，只要计算出 t = 1 t=1 t=1 时刻的前向概率 α 1 ( i ) \alpha_{1}(i) α1​(i)，往后依次递推就可以了。例如 α 1 ( i ) = π i 1 b i 1 o 1 \alpha_{1}(i) = \pi_{i_{1}}b_{i_{1}o_{1}} α1​(i)=πi1​​bi1​o1​​， α 2 ( i ) = α 1 ( 1 ) b 1 o i + α 1 ( 2 ) b 2 o i + . . . + α 1 ( n ) b n o i \alpha_{2}(i) = \alpha_{1}(1)b_{1}o_{i} + \alpha_{1}(2)b_{2}o_{i} +...+\alpha_{1}(n)b_{n}o_{i} α2​(i)=α1​(1)b1​oi​+α1​(2)b2​oi​+...+α1​(n)bn​oi​。 综上： 4.1.2.2 例子 观测集合为： V = ( 红 ， 白 ) V=(红，白) V=(红，白) 状态集合为： Q = ( 盒 子 1 , 盒 子 2 , 盒 子 3 ) Q=(盒子1,盒子2,盒子3) Q=(盒子1,盒子2,盒子3) 观测序列为： O = ( 红 ， 白 ， 红 ) O=(红，白，红) O=(红，白，红) 状态转移概率矩阵为 A A A : 第 i i i 行表示选择第 i i i 个盒子，第 j j j 列表示转移到第 j j j 个盒子， 比如： A 23 A_{23} A23​ 表示上一次选择第二个盒子，这次选择第三个盒子的概率为 0.2。 观测概率矩阵 B B B： 第 i i i 行表示选择的是第 i i i 个盒子，第 j j j 列表示从该盒子取到 j j j 号球， 比如： B 31 B_{31} B31​ 表示从第二个盒子取出球的概率为 0.7。 （1) 计算初值 t = 1 t=1 t=1 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子1的概率： α 1 ( 1 ) = π 1 b 1 o 1 = 0.2 × 0.5 = 0.10 \alpha_{1}(1) = \pi_{1}b_{1o_{1}} = 0.2×0.5=0.10 α1​(1)=π1​b1o1​​=0.2×0.5=0.10 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子2的概率： α 1 ( 2 ) = π 2 b 2 o 1 = 0.4 × 0.4 = 0.16 \alpha_{1}(2) = \pi_{2}b_{2o_{1}} = 0.4×0.4=0.16 α1​(2)=π2​b2o1​​=0.4×0.4=0.16 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子3的概率： α 1 ( 3 ) = π 3 b 3 o 1 = 0.4 × 0.7 = 0.28 \alpha_{1}(3) = \pi_{3}b_{3o_{1}} = 0.4×0.7=0.28 α1​(3)=π3​b3o1​​=0.4×0.7=0.28 （2) 递推计算 t = 2 t=2 t=2 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子1的概率： α 2 ( 1 ) = [ ∑ i = 1 3 α 1 ( i ) a i 1 ] b 1 o 2 = ( 0.10 × 0.5 + 0.16 × 0.3 + 0.28 ∗ 0.2 ) × 0.5 = 0.154 × 0.5 = 0.077 \alpha_{2}(1) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i1}]b_{1o_{2}} = (0.10×0.5+0.16×0.3+0.28*0.2)×0.5=0.154×0.5=0.077 α2​(1)=[i=1∑3​α1​(i)ai1​]b1o2​​=(0.10×0.5+0.16×0.3+0.28∗0.2)×0.5=0.154×0.5=0.077 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子2的概率： α 2 ( 2 ) = [ ∑ i = 1 3 α 1 ( i ) a i 2 ] b 2 o 2 = ( 0.10 × 0.2 + 0.16 × 0.5 + 0.28 ∗ 0.3 ) × 0.6 = 0.184 × 0.6 = 0.1104 \alpha_{2}(2) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i2}]b_{2o_{2}} = (0.10×0.2+0.16×0.5+0.28*0.3)×0.6=0.184×0.6=0.1104 α2​(2)=[i=1∑3​α1​(i)ai2​]b2o2​​=(0.10×0.2+0.16×0.5+0.28∗0.3)×0.6=0.184×0.6=0.1104 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子3的概率： α 2 ( 3 ) = [ ∑ i = 1 3 α 1 ( i ) a i 3 ] b 3 o 2 = ( 0.10 × 0.3 + 0.16 × 0.2 + 0.28 ∗ 0.5 ) × 0.3 = 0.202 × 0.3 = 0.0606 \alpha_{2}(3) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i3}]b_{3o_{2}} = (0.10×0.3+0.16×0.2+0.28*0.5)×0.3=0.202×0.3=0.0606 α2​(3)=[i=1∑3​α1​(i)ai3​]b3o2​​=(0.10×0.3+0.16×0.2+0.28∗0.5)×0.3=0.202×0.3=0.0606 （3) 递推计算 t = 3 t=3 t=3 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子1的概率： α 3 ( 1 ) = [ ∑ i = 1 3 α 2 ( i ) a i 1 ] b 1 o 2 = 0.04187 \alpha_{3}(1) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i1}]b_{1o_{2}}=0.04187 α3​(1)=[i=1∑3​α2​(i)ai1​]b1o2​​=0.04187 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子2的概率： α 3 ( 2 ) = [ ∑ i = 1 3 α 2 ( i ) a i 2 ] b 2 o 2 = 0.03551 \alpha_{3}(2) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i2}]b_{2o_{2}}=0.03551 α3​(2)=[i=1∑3​α2​(i)ai2​]b2o2​​=0.03551 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子2的概率： α 3 ( 3 ) = [ ∑ i = 1 3 α 2 ( i ) a i 3 ] b 3 o 2 = 0.05284 \alpha_{3}(3) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i3}]b_{3o_{2}}=0.05284 α3​(3)=[i=1∑3​α2​(i)ai3​]b3o2​​=0.05284 （4) 终止 P ( O ∣ λ ) = ∑ i = 1 3 α 3 ( i ) = 0.13022 P(O|\lambda) =\sum_{i=1}^3 \alpha_{3}(i)=0.13022 P(O∣λ)=i=1∑3​α3​(i)=0.13022 4.1.3 后向算法 其实后向算法和前向算法类似，只不过是从后往前递推。 后向概率 β t ( i ) \beta{t}(i) βt(i) 如下图所示： 首先，定义最后时刻的 β T ( i ) = 1 \beta_{T}(i) = 1 βT​(i)=1。 然后 ，对于 t = T − 1 , T − 2 , . . . , 1 t = T-1,T-2,...,1 t=T−1,T−2,...,1，后向概率 β t ( i ) \beta_{t}(i) βt​(i) 就等于 t t t 时刻的状态 i t = q i i_{t} = q_{i} it​=qi​ 转移到时刻 t + 1 t+1 t+1 的状态 i t + 1 = q j i_{t+1} = q_{j} it+1​=qj​ 的概率 × t + 1 t+1 t+1 时刻状态 i t + 1 i_{t+1} it+1​ 对应的观测状态 o t + 1 o_{t+1} ot+1​ 的概率 × t + 1 t+1 t+1 时刻的后向概率 β t + 1 ( i ) \beta_{t+1}(i) βt+1​(i)。即： β t ( i ) = ∑ j = 1 n a i j b j o t + 1 β t + 1 ( i ) \beta_{t}(i) = \sum_{j=1}^n a_{ij}b_{jo_{t+1}}\beta_{t+1}(i) βt​(i)=j=1∑n​aij​bjot+1​​βt+1​(i) 如下图所示： 最后，观测概率 P ( O ∣ λ ) = ∑ i = 1 n π i b i o 1 β 1 ( i ) P(O|\lambda) = \sum_{i=1}^n \pi_{i}b_{io_{1}}\beta_{1}(i) P(O∣λ)=∑i=1n​πi​bio1​​β1​(i)。 其实，观测概率 P ( O ∣ λ ) P(O|\lambda) P(O∣λ) 还可以这么写： P ( O ∣ λ ) = ∑ i = 1 n ∑ j = 1 n α t ( i ) a i j b j o t + 1 β t + 1 ( j ) P(O|\lambda) = \sum_{i=1}^n \sum_{j=1}^n \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j) P(O∣λ)=i=1∑n​j=1∑n​αt​(i)aij​bjot+1​​βt+1​(j) 是不是其实很好理解。 4.1.3 一些概率与期望的计算 利用前向概率和后向概率,可以得到关于单个状态和两个状态概率的计算公式。 给定模型 λ \lambda λ 和观测 O O O，在时刻 t t t 处于状态 q i q_{i} qi​ 的概率。记 γ t ( i ) = P ( i t = q i ∣ O , λ ) = P ( i t = q i , O ∣ λ ) P ( O ∣ λ ) \gamma_{t}(i) = P(i_{t}=q_{i}|O,\lambda) = \frac{P(i_{t}=q_{i},O|\lambda)}{P(O|\lambda)} γt​(i)=P(it​=qi​∣O,λ)=P(O∣λ)P(it​=qi​,O∣λ)​ 由前向概率 α t ( i ) \alpha_t(i) αt​(i) 和后向概率 β t ( i ) \beta_t(i) βt​(i) 定义可知: α t ( i ) β t ( i ) = P ( i t = q t ∣ O , λ ) \alpha_{t}(i)\beta_t(i) = P(i_{t}=q_{t}|O,\lambda) αt​(i)βt​(i)=P(it​=qt​∣O,λ) 于是得到: γ t ( i ) = α t ( i ) β t ( i ) P ( O ∣ λ ) = α t ( i ) β t ( i ) ∑ j = 1 N α t ( j ) β t ( j ) \gamma_{t}(i) = \frac{\alpha_{t}(i)\beta_t(i)}{P(O|\lambda)} = \frac{\alpha_{t}(i)\beta_t(i)}{\sum_{j=1}^N \alpha_{t}(j)\beta_t(j)} γt​(i)=P(O∣λ)αt​(i)βt​(i)​=∑j=1N​αt​(j)βt​(j)αt​(i)βt​(i)​ 给定模型 λ \lambda λ 和观测 O O O，在时刻 t t t 处于状态 q i q_{i} qi​ 的概率。同时在时刻 t + 1 t+1 t+1 处于状态 q j q_{j} qj​ 的概率，记 ξ t ( i , j ) = P ( i t = q i , i t + 1 = q j ∣ O , λ ) = P ( i t = q i , i t + 1 = q j , O ∣ λ ) ∑ i = 1 N ∑ j = 1 N P ( i t = q i , i t + 1 = q j , O ∣ λ ) \xi_{t}(i,j) = P(i_{t}=q_{i},i_{t+1}=q_{j}|O,\lambda) = \frac{P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda)}{\sum_{i=1}^N \sum_{j=1}^N P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda)} ξt​(i,j)=P(it​=qi​,it+1​=qj​∣O,λ)=∑i=1N​∑j=1N​P(it​=qi​,it+1​=qj​,O∣λ)P(it​=qi​,it+1​=qj​,O∣λ)​ 而 P ( i t = q i , i t + 1 = q j , O ∣ λ ) = α t ( i ) a i j b j o t + 1 β t + 1 ( j ) P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda) = \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j) P(it​=qi​,it+1​=qj​,O∣λ)=αt​(i)aij​bjot+1​​βt+1​(j) 所以 ξ t ( i , j ) = q j , O ∣ λ ) = α t ( i ) a i j b j o t + 1 β t + 1 ( j ) ∑ i = 1 N ∑ j = 1 N α t ( i ) a i j b j o t + 1 β t + 1 ( j ) \xi_{t}(i,j) = q_{j},O|\lambda) = \frac{\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)}{\sum_{i=1}^N \sum_{j=1}^N \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)} ξt​(i,j)=qj​,O∣λ)=∑i=1N​∑j=1N​αt​(i)aij​bjot+1​​βt+1​(j)αt​(i)aij​bjot+1​​βt+1​(j)​ 4.2 学习算法 目的： 给定观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​ 和状态序列 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​，求HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 的三个参数。 给定观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 的三个参数。 解决方法： 监督算法 B a u m − W e l c h Baum-Welch Baum−Welch 算法 4.2.1 监督算法 第二步求观测概率应该是 b j k b_{jk} bjk​，因为懒，就直接截图了。 4.2.2 Baum-Welch 算法 现在已经知道的是观测数据 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​， 设隐状态数据为 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​，那么完全数据是 ( O , I ) = ( o 1 , o 2 , . . . , o T , i 1 , i 2 , . . . , i T ) (O,I)=(o_{1},o_{2},...,o_{T},i_{1},i_{2},...,i_{T}) (O,I)=(o1​,o2​,...,oT​,i1​,i2​,...,iT​)。完全数据的对数似然函数是 l o g P ( O , I ∣ λ ) logP(O,I|\lambda) logP(O,I∣λ)。 既然 B a u m − W e l c h Baum-Welch Baum−Welch 算法使用的就是 E M EM EM 算法，那么就要走两个步骤： （1） E E E 步 求出联合分布 P ( O , I ∣ λ ) P(O,I|\lambda) P(O,I∣λ) 基于条件概率 ( I ∣ O , λ ‾ ) (I|O,\overline \lambda) (I∣O,λ) 的期望，其中 λ ‾ \overline \lambda λ 为 HMM 模型参数的当前估计值， λ \lambda λ 为极大化的 HMM 模型参数。 （2） M M M 步 最大化这个期望，得到更新的模型参数λ。接着不停的进行EM迭代，直到模型参数的值收敛为止。 公式推导： （1） E E E 步：求 Q Q Q 函数 根据 E M EM EM 的 Q Q Q 函数定义，即这里要求的联合分布的期望为： Q ( λ , λ ‾ ) = ∑ I P ( I ∣ O , λ ‾ ) l n P ( O , I ∣ λ ) = ∑ I l n P ( O , I ∣ λ ) P ( I , O ∣ λ ‾ ) P ( O , λ ‾ ) Q(\lambda,\overline \lambda) = \sum_{I}P(I|O,\overline \lambda)lnP(O,I|\lambda) = \sum_{I}lnP(O,I|\lambda)\frac{P(I,O|\overline \lambda)}{P(O,\overline \lambda)} Q(λ,λ)=I∑​P(I∣O,λ)lnP(O,I∣λ)=I∑​lnP(O,I∣λ)P(O,λ)P(I,O∣λ)​ P ( O , λ ‾ ) P(O,\overline \lambda) P(O,λ) 表示上次求出的参数与观测数据的联合概率，没有什么影响，所以： Q ( λ , λ ‾ ) = ∑ I l n P ( O , I ∣ λ ) P ( I , O ∣ λ ‾ ) Q(\lambda,\overline \lambda) = \sum_{I}lnP(O,I|\lambda)P(I,O|\overline \lambda) Q(λ,λ)=I∑​lnP(O,I∣λ)P(I,O∣λ) 而 P ( O , I ∣ λ ) = π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O,I|\lambda) = \pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O,I∣λ)=πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 所以 Q ( λ , λ ‾ ) = ∑ I P ( I , O ∣ λ ‾ ) [ l n π i 1 + l n ( a i 1 i 2 + . . . + a i T − 1 i T + l n ( b i 1 o 1 + . . . + b i T o T ) ) ] = ∑ I l n π i 1 P ( I , O ∣ λ ‾ ) ⎵ 式 1 + ∑ I ( ∑ t = 1 T − 1 l n a i t i t + 1 ) P ( I , O ∣ λ ‾ ) ⎵ 式 2 + ∑ I ( ∑ t = 1 T l n b i t o t ) P ( I , O ∣ λ ‾ ) ⎵ 式 3 Q(\lambda,\overline \lambda) = \sum_{I}P(I,O|\overline \lambda) [ln \pi_{i_{1}} + ln(a_{i_{1}i_{2}}+...+a_{i_{T-1}i_{T}} + ln(b_{i_{1}o_{1}}+...+b_{i_{T}o_{T}}))] \\ = \underbrace{ \sum_{I} ln \pi_{i_{1}} P(I,O|\overline \lambda)}_{式1} + \underbrace{ \sum_{I} (\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(I,O|\overline \lambda)}_{式2} + \underbrace{ \sum_{I} (\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\overline \lambda)}_{式3} Q(λ,λ)=I∑​P(I,O∣λ)[lnπi1​​+ln(ai1​i2​​+...+aiT−1​iT​​+ln(bi1​o1​​+...+biT​oT​​))]=式1 I∑​lnπi1​​P(I,O∣λ)​​+式2 I∑​(t=1∑T−1​lnait​it+1​​)P(I,O∣λ)​​+式3 I∑​(t=1∑T​lnbit​ot​​)P(I,O∣λ)​​ （2） M M M 步：极大化 Q Q Q，求模型参数 A , B , π A,B,\pi A,B,π 　1）求 π i \pi_{i} πi​： 　既然是求极值，肯定是要求导了。对于 π i \pi_{i} πi​ 来说，满足约束条件 ∑ t = 1 N π i = 1 \sum_{t=1}^N \pi_{i}=1 ∑t=1N​πi​=1。现在就变成了带约束条件的求极值，直接上拉格朗日乘子法。 　式 1 可以写成： 　 ∑ I l n π i 1 P ( I , O ∣ λ ‾ ) = ∑ i = 1 N l n π i P ( O , i 1 = q i ∣ λ ‾ ) \sum_{I} ln \pi_{i_{1}} P(I,O|\overline \lambda) = \sum_{i=1}^N ln \pi_{i} P(O,i_{1}=q_{i}|\overline \lambda) I∑​lnπi1​​P(I,O∣λ)=i=1∑N​lnπi​P(O,i1​=qi​∣λ) 　拉格朗日函数： 　 L = ∑ i = 1 N l n π i P ( O , i 1 = q i ∣ λ ‾ ) + γ ( ∑ i = 1 N π i − 1 ) L = \sum_{i=1}^N ln \pi_{i}P(O,i_{1}=q_{i}|\overline \lambda) + \gamma(\sum_{i=1}^N \pi_{i}-1) L=i=1∑N​lnπi​P(O,i1​=qi​∣λ)+γ(i=1∑N​πi​−1) 　首先把求和 ∑ \sum ∑ 去掉，只对单个的 π i \pi_{i} πi​ 求偏导并等于 0： 　 ∂ L ∂ π i = P ( O , i 1 = q i ∣ λ ‾ ) π i + γ = 0 \frac{\partial L}{\partial \pi_{i}} = \frac{P(O,i_{1}=q_{i}|\overline \lambda)}{\pi_{i}} + \gamma = 0 ∂πi​∂L​=πi​P(O,i1​=qi​∣λ)​+γ=0 　等价于： 　 ∂ L ∂ π i = P ( O , i 1 = q i ∣ λ ‾ ) + γ π i = 0 \frac{\partial L}{\partial \pi_{i}} =P(O,i_{1}=q_{i}|\overline \lambda) + \gamma \pi_{i} = 0 ∂πi​∂L​=P(O,i1​=qi​∣λ)+γπi​=0 　然后再添上对 i i i 的求和 ∑ \sum ∑，可得到： 　 γ = − P ( O ∣ λ ‾ ) \gamma = -P(O|\overline \lambda) γ=−P(O∣λ) 　带入到第三项公式，可得： 　 π i = P ( O , i 1 = q i ∣ λ ‾ ) P ( O ∣ λ ‾ ) \pi_{i} = \frac{P(O,i_{1}=q_{i}|\overline \lambda)}{P(O|\overline \lambda)} πi​=P(O∣λ)P(O,i1​=qi​∣λ)​ 2）求 a i j a_{ij} aij​： 　式 2 可以写成： 　 ∑ I ( ∑ t = 1 T − 1 l n a i t i t + 1 ) P ( O , I ∣ λ ‾ ) = ∑ i = 1 N ∑ j = 1 N ∑ t = 1 T − 1 l n a i j P ( O , i t = q i , i t + 1 = q j ∣ λ ‾ ) \sum_{I} (\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(O,I|\overline \lambda) = \sum_{i=1}^N \sum_{j=1}^N \sum_{t=1}^{T-1} ln a_{ij} P(O,i_{t}=q_{i},i_{t+1}=q_{j}|\overline \lambda) I∑​(t=1∑T−1​lnait​it+1​​)P(O,I∣λ)=i=1∑N​j=1∑N​t=1∑T−1​lnaij​P(O,it​=qi​,it+1​=qj​∣λ) 　同样有约束条件 ∑ j = 1 N a i j = 1 \sum_{j=1}^Na_{ij}=1 ∑j=1N​aij​=1，最后可以得到： 　 a i j = ∑ t = 1 T − 1 P ( O , i 1 = q i , i t + 1 = q j ∣ λ ‾ ) P ( O , i t = q i ∣ λ ‾ ) a_{ij} = \frac{\sum_{t=1}^{T-1} P(O,i_{1}=q_{i},i_{t+1}=q_{j}|\overline \lambda)}{P(O,i_{t}=q_{i}|\overline \lambda)} aij​=P(O,it​=qi​∣λ)∑t=1T−1​P(O,i1​=qi​,it+1​=qj​∣λ)​ 　3）求 b i j b_{ij} bij​： 　式 3 可以写成： 　　 ∑ I ( ∑ t = 1 T l n b i t o t ) P ( I , O ∣ λ ‾ ) = ∑ j = 1 N ∑ t = 1 T − 1 l n b j o t P ( O , i t = q j ∣ λ ‾ ) \sum_{I} (\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\overline \lambda) = \sum_{j=1}^N \sum_{t=1}^{T-1} lnb_{jo_{t}}P(O,i_{t}=q_{j}|\overline \lambda) I∑​(t=1∑T​lnbit​ot​​)P(I,O∣λ)=j=1∑N​t=1∑T−1​lnbjot​​P(O,it​=qj​∣λ) 　同样有约束条件 ∑ k = 1 M b j k = 1 \sum_{k=1}^M b_{jk}=1 ∑k=1M​bjk​=1，要注意的是只有在 o t = v k o_{t}=v_{k} ot​=vk​ 时 b j o t b_{jo_{t}} bjot​​ 对 b j k b_{jk} bjk​ 的偏导数才不为 0，以 I ( o t = v k ) I(o_{t}=v_{k}) I(ot​=vk​) 表示，最后可以得到： 　 b j k = ∑ t = 1 T P ( O , i t = q j ∣ λ ‾ ) I ( o t = v k ) ∑ t = 1 T P ( O , i t = q j ∣ λ ‾ ) b_{jk} = \frac{\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\overline \lambda) I(o_{t}=v_{k})}{\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\overline \lambda)} bjk​=∑t=1T​P(O,it​=qj​∣λ)∑t=1T​P(O,it​=qj​∣λ)I(ot​=vk​)​ 参数估计公式： 得到参数后，可以用 4.1.3 节的 γ t ( i ) , ξ t ( i , j ) \gamma_{t}(i),\xi_{t}(i,j) γt​(i),ξt​(i,j) 表示： 算法总结： 4.3 预测算法 目的：给定 HMM 模型 λ = ( A , B , π ) \lambda = (A,B,\pi) λ=(A,B,π) 和观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求在该观测序列下，最可能对应的状态序列 I ∗ = i 1 ∗ , i 2 ∗ , . . . , i T ∗ I^*={i_{1}^*,i_{2}^*,...,i_{T}^*} I∗=i1∗​,i2∗​,...,iT∗​，也就是最大化 P ( I ∗ ∣ O ) P(I^*|O) P(I∗∣O)。 解决：Viterbi 算法。 其实维特比算法就用动态规划的方法求概率最大路径，计算过程中的每条路径都对应着一个状态序列。计算过程中将最优路径经过的点都保存下来。得到最优路径后，由后向前逐步求得最优结点，这就是维特比算法。 过程： 因为计算过程很简单，就直接给出书中的截图了。 首先导入两个变量 δ \delta δ和 ψ \psi ψ。定义在时刻 t t t 状态为 i i i 的所有单个路径 ( i 1 , i 2 , . . . , i t ) (i_{1} ,i_{2},...,i_{t} ) (i1​,i2​,...,it​) 中概率最大值为： 过程是不是很好理解？如果还不好理解，就继续看个例子。 例子： 整个计算过程如下图所示， Reference 统计学习方法 李航" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"版权声明：本文为博主原创文章，转载请指明作者以及链接，并通知作者，谢谢。 https://blog.csdn.net/wshixinshouaaa/article/details/85701540 隐马尔科夫HMM 一、序言 二、基本概念 2.1 定义 2.2 例子 2.3 基本假设 三、三个问题 3.1 概率计算问题 3.2 学习问题 3.3 预测问题 四、三个问题解决算法 4.1 概率计算算法 4.1.1 直接计算法（暴力法） 4.1.2 前向算法 4.1.2.1 详解 4.1.2.2 例子 4.1.3 后向算法 4.1.3 一些概率与期望的计算 4.2 学习算法 4.2.1 监督算法 4.2.2 Baum-Welch 算法 4.3 预测算法 Reference 一、序言 重新复习隐马尔科夫模型，重点是HMM模型的三个问题及前向、后向和维特比算法。 二、基本概念 2.1 定义 隐马尔可夫模型由初始概率分布、状态转移概率分布以及观测概率分布确定。隐马尔可夫模型的形式定义如下: 设Q是所有可能的状态的集合,V是所有可能的观测的集合。 Q = q 1 , q 2 , . . . , q n , V = v 1 , v 2 , . . . v m Q={q_{1},q_{2},...,q_{n}}, \\quad V={v_{1},v_{2},...v_{m}} Q=q1​,q2​,...,qn​,V=v1​,v2​,...vm​ 其中, n n n是可能的状态数, m m m是可能的观测数。 设 I I I是长度为 t t t的状态序列, O O O是对应的观测序列: I = i 1 , i 2 , . . . , i t , O = o 1 , o 2 , . . . , o t I={i_{1},i_{2},...,i_{t}}, \\quad O={o_{1},o_{2},...,o_{t}} I=i1​,i2​,...,it​,O=o1​,o2​,...,ot​ A A A是状态转移概率矩阵: A = [ a i j ] n × n A=[a_{ij}]_{n×n} A=[aij​]n×n​ 其中, a i j = P ( i t = q j ∣ i t − 1 = q i ) , i = 1 , . . . n ; j = 1 , . . . , n a_{ij}=P(i_{t}=q_{j}|i_{t-1}=q_{i}), \\quad i=1,...n;j=1,...,n aij​=P(it​=qj​∣it−1​=qi​),i=1,...n;j=1,...,n 是在时刻 t − 1 t-1 t−1处于状态 q i q_{i} qi​的条件下在时刻 t t t转移到状态 q j q_{j} qj​的概率。 B B B是观测概率矩阵: B = [ b j k ] n × m B=[b_{jk}]_{n×m} B=[bjk​]n×m​ 其中， b k j = P ( o t = v k ∣ i t = q j ) , k = 1 , . . . m , j = 1 , . . . , n b_{kj}=P(o_{t}=v_{k}|i_{t}=q_{j}), \\quad k=1,...m,j=1,...,n bkj​=P(ot​=vk​∣it​=qj​),k=1,...m,j=1,...,n 是在时刻 t t t处于状态 q j q_{j} qj​的条件下生成观测 v k v_{k} vk​的概率。 π \\pi π是初始状态概率向量: π = π i \\pi=\\pi_{i} π=πi​ 其中， π i = P ( i 1 = q i ) , i = 1 , . . . n \\pi_{i}=P(i_{1}=q_{i}), \\quad i=1,...n πi​=P(i1​=qi​),i=1,...n 是初始时刻 t = 1 t=1 t=1处于状态 q i q_{i} qi​的概率。 2.2 例子 举个例子，当观察到屋外艳阳高照，那么肯定是晴天；若是半乌云密布，则是阴天；若是电闪雷鸣，则是雨天。艳阳高照，乌云密布，电闪雷鸣是我们能直接观察到的，对应着上面定义的观测序列。 而它们对应的天气状态分别是晴天、阴天和雨天，则是状态序列，因为我们先观察到外边的环境是艳阳高照，乌云密布，电闪雷鸣，然后再推测出是晴天、阴天还是雨天。 如下图所示，上面的是一条隐马尔科夫链，下面对应着其随机生成的状态序列。 如下图所示，是一个完整的 HMM 模型。 状态集合 Q = q 1 , q 2 , q 3 Q={q_{1},q_{2},q_{3}} Q=q1​,q2​,q3​，其中 q 1 = 艳 阳 高 照 q_{1}=艳阳高照 q1​=艳阳高照， q 2 = 乌 云 密 布 q_{2}=乌云密布 q2​=乌云密布， q 3 = 电 闪 雷 鸣 q_{3}=电闪雷鸣 q3​=电闪雷鸣。 观测集合 V = v 1 , v 2 , v 3 V={v_{1},v_{2},v_{3}} V=v1​,v2​,v3​，其中 v 1 = 晴 天 v_{1}=晴天 v1​=晴天， v 2 = 阴 天 v_{2}=阴天 v2​=阴天， v 3 = 雨 天 v_{3}=雨天 v3​=雨天。 状态转移概率矩阵 A A A： 观测概率矩阵 B B B： 初始状态概率 π \\pi π： 以上数据是随便写的。 2.3 基本假设 三、三个问题 只看这个可能有点晦涩，下面就例子说的通俗一下： 3.1 概率计算问题 评估问题，即概率计算问题，是三个问题中最简单的。给定 HMM 模型 λ \\lambda λ，也就是已经知道状态转移概率矩阵 A A A、观测概率矩阵 B B B 和初始状态概率 π \\pi π，同时给出观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，求在该 HMM 模型下这个观测序列生成的概率。例如求接下来三天的观测天气是（阴天，雨天，晴天）的概率。解决算法：前向-后向算法。 3.2 学习问题 学习问题是三个问题中最复杂的一个。这个问题中只给出观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，让求 HMM 模型 λ \\lambda λ 的三个参数： A A A、 B B B 和 π \\pi π。例如，给出观测天气是（阴天，雨天，晴天），根据观测序列求一个 HMM 模型。解决算法： B a u m − W e l c h Baum-Welch Baum−Welch 算法（EM算法）。 3.3 预测问题 预测问题，也称为解码问题。给定 HMM 模型 λ \\lambda λ 和观测序列 O = o 1 , o 2 , . . . , o t O={o_{1},o_{2},...,o_{t}} O=o1​,o2​,...,ot​，求在该 HMM 模型下最有可能生成这个观测序列的隐状态序列。例如，观测天气是（阴天，雨天，晴天），求最有可能对应该观测序列的状态序列是（艳阳高照，乌云密布，电闪雷鸣），还是（乌云密布，电闪雷鸣，艳阳高照），或者是其他的某个状态序列。解决算法： V i t e r b i Viterbi Viterbi 算法（一种动态规划）。 四、三个问题解决算法 4.1 概率计算算法 目的：给定 HMM 模型 λ = ( A , B , π ) \\lambda = (A,B,\\pi) λ=(A,B,π) 和观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求在该HMM 模型下生成该观测序列的概率 P ( O ∣ λ ) P(O|\\lambda) P(O∣λ)。 4.1.1 直接计算法（暴力法） 首先，在给定 HMM 模型下，生成 一个 隐状态序列 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​ 的概率为： P ( I ∣ λ ) = π i 1 a i 1 i 2 a i 2 i 3 . . . a i T − 1 i T P(I|\\lambda) = \\pi_{i_{1}}a_{i_{1}i_{2}}a_{i_{2}i_{3}}...a_{i_{T-1}i_{T}} P(I∣λ)=πi1​​ai1​i2​​ai2​i3​​...aiT−1​iT​​ 然后，在该状态序列，生成对应的观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​ 的改立为： P ( O ∣ I , λ ) = b i 1 o 1 b i 2 o 2 . . . b i T o T P(O|I,\\lambda) = b_{i_{1}o_{1}}b_{i_{2}o_{2}}...b_{i_{T}o_{T}} P(O∣I,λ)=bi1​o1​​bi2​o2​​...biT​oT​​ 最后，在给定 HMM 模型下，生成状态序列 I I I 和观测序列 O O O 的联合概率为： P ( O , I ∣ λ ) = P ( O ∣ I , λ ) P ( I ∣ λ ) = π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O,I|\\lambda) = P(O|I,\\lambda)P(I|\\lambda) = \\pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O,I∣λ)=P(O∣I,λ)P(I∣λ)=πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 综上是 HMM 模型生成一个状态序列，再生成观测序列的概率。只要对所有不同的状态序列 I I I 求和，就是要求的给定观测序列的概率 P ( O ∣ λ ) P(O|\\lambda) P(O∣λ)： P ( O ∣ λ ) = ∑ I P ( O ∣ I , λ ) P ( I ∣ λ ) = ∑ I 1 , I 2 , . . . π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O|\\lambda) = \\sum_{I}P(O|I,\\lambda)P(I|\\lambda) = \\sum_{I_{1},I_{2},...}\\pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O∣λ)=I∑​P(O∣I,λ)P(I∣λ)=I1​,I2​,...∑​πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 使用该算法原理简单，但是计算量巨大。时间复杂度： O ( T N T ) O(TN^{T}) O(TNT)。 4.1.2 前向算法 4.1.2.1 详解 前向概率 α t ( i ) \\alpha_{t}(i) αt​(i) 如下图所示： 其实，前向算法可以看做是动态规划。 注意看呦， α t ( i ) = P ( o 1 , o 2 , . . . , o t , i t = q t ∣ λ ) \\alpha_{t}(i) = P(o_{1},o_{2},...,o_{t},i_{t}=q_{t}|\\lambda) αt​(i)=P(o1​,o2​,...,ot​,it​=qt​∣λ) 这不就是 暴力法中第三步 求的状态序列 I I I 和观测序列 O O O 的联合概率吗？ 我们只要把 t t t 时刻中所有状态序列 q i ∈ ( q 1 , q 2 , . . . , q n ) q_{i} \\in (q_{1},q_{2},...,q_{n}) qi​∈(q1​,q2​,...,qn​) 做累加，然后乘上 t + 1 t+1 t+1 时刻 q i q_{i} qi​ 对应的观测概率，即 [ ∑ j = 1 n α t ( j ) a j i ] b i o t + 1 [\\sum_{j=1}^n \\alpha_{t}(j)a_{ji}]b_{i}o_{t+1} [∑j=1n​αt​(j)aji​]bi​ot+1​，就得到 t + 1 t+1 t+1 时刻的状态序列 I I I 和观测序列 O O O 的联合概率，即前向概率 α t + 1 ( i ) \\alpha_{t+1}(i) αt+1​(i)。 如下图所示： 所以，只要计算出 t = 1 t=1 t=1 时刻的前向概率 α 1 ( i ) \\alpha_{1}(i) α1​(i)，往后依次递推就可以了。例如 α 1 ( i ) = π i 1 b i 1 o 1 \\alpha_{1}(i) = \\pi_{i_{1}}b_{i_{1}o_{1}} α1​(i)=πi1​​bi1​o1​​， α 2 ( i ) = α 1 ( 1 ) b 1 o i + α 1 ( 2 ) b 2 o i + . . . + α 1 ( n ) b n o i \\alpha_{2}(i) = \\alpha_{1}(1)b_{1}o_{i} + \\alpha_{1}(2)b_{2}o_{i} +...+\\alpha_{1}(n)b_{n}o_{i} α2​(i)=α1​(1)b1​oi​+α1​(2)b2​oi​+...+α1​(n)bn​oi​。 综上： 4.1.2.2 例子 观测集合为： V = ( 红 ， 白 ) V=(红，白) V=(红，白) 状态集合为： Q = ( 盒 子 1 , 盒 子 2 , 盒 子 3 ) Q=(盒子1,盒子2,盒子3) Q=(盒子1,盒子2,盒子3) 观测序列为： O = ( 红 ， 白 ， 红 ) O=(红，白，红) O=(红，白，红) 状态转移概率矩阵为 A A A : 第 i i i 行表示选择第 i i i 个盒子，第 j j j 列表示转移到第 j j j 个盒子， 比如： A 23 A_{23} A23​ 表示上一次选择第二个盒子，这次选择第三个盒子的概率为 0.2。 观测概率矩阵 B B B： 第 i i i 行表示选择的是第 i i i 个盒子，第 j j j 列表示从该盒子取到 j j j 号球， 比如： B 31 B_{31} B31​ 表示从第二个盒子取出球的概率为 0.7。 （1) 计算初值 t = 1 t=1 t=1 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子1的概率： α 1 ( 1 ) = π 1 b 1 o 1 = 0.2 × 0.5 = 0.10 \\alpha_{1}(1) = \\pi_{1}b_{1o_{1}} = 0.2×0.5=0.10 α1​(1)=π1​b1o1​​=0.2×0.5=0.10 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子2的概率： α 1 ( 2 ) = π 2 b 2 o 1 = 0.4 × 0.4 = 0.16 \\alpha_{1}(2) = \\pi_{2}b_{2o_{1}} = 0.4×0.4=0.16 α1​(2)=π2​b2o1​​=0.4×0.4=0.16 t = 1 t=1 t=1 时刻取出红球，隐状态是盒子3的概率： α 1 ( 3 ) = π 3 b 3 o 1 = 0.4 × 0.7 = 0.28 \\alpha_{1}(3) = \\pi_{3}b_{3o_{1}} = 0.4×0.7=0.28 α1​(3)=π3​b3o1​​=0.4×0.7=0.28 （2) 递推计算 t = 2 t=2 t=2 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子1的概率： α 2 ( 1 ) = [ ∑ i = 1 3 α 1 ( i ) a i 1 ] b 1 o 2 = ( 0.10 × 0.5 + 0.16 × 0.3 + 0.28 ∗ 0.2 ) × 0.5 = 0.154 × 0.5 = 0.077 \\alpha_{2}(1) = [\\sum_{i=1}^3 \\alpha_{1}(i)a_{i1}]b_{1o_{2}} = (0.10×0.5+0.16×0.3+0.28*0.2)×0.5=0.154×0.5=0.077 α2​(1)=[i=1∑3​α1​(i)ai1​]b1o2​​=(0.10×0.5+0.16×0.3+0.28∗0.2)×0.5=0.154×0.5=0.077 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子2的概率： α 2 ( 2 ) = [ ∑ i = 1 3 α 1 ( i ) a i 2 ] b 2 o 2 = ( 0.10 × 0.2 + 0.16 × 0.5 + 0.28 ∗ 0.3 ) × 0.6 = 0.184 × 0.6 = 0.1104 \\alpha_{2}(2) = [\\sum_{i=1}^3 \\alpha_{1}(i)a_{i2}]b_{2o_{2}} = (0.10×0.2+0.16×0.5+0.28*0.3)×0.6=0.184×0.6=0.1104 α2​(2)=[i=1∑3​α1​(i)ai2​]b2o2​​=(0.10×0.2+0.16×0.5+0.28∗0.3)×0.6=0.184×0.6=0.1104 t = 2 t=2 t=2 时刻取出白球，隐状态是盒子3的概率： α 2 ( 3 ) = [ ∑ i = 1 3 α 1 ( i ) a i 3 ] b 3 o 2 = ( 0.10 × 0.3 + 0.16 × 0.2 + 0.28 ∗ 0.5 ) × 0.3 = 0.202 × 0.3 = 0.0606 \\alpha_{2}(3) = [\\sum_{i=1}^3 \\alpha_{1}(i)a_{i3}]b_{3o_{2}} = (0.10×0.3+0.16×0.2+0.28*0.5)×0.3=0.202×0.3=0.0606 α2​(3)=[i=1∑3​α1​(i)ai3​]b3o2​​=(0.10×0.3+0.16×0.2+0.28∗0.5)×0.3=0.202×0.3=0.0606 （3) 递推计算 t = 3 t=3 t=3 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子1的概率： α 3 ( 1 ) = [ ∑ i = 1 3 α 2 ( i ) a i 1 ] b 1 o 2 = 0.04187 \\alpha_{3}(1) = [\\sum_{i=1}^3 \\alpha_{2}(i)a_{i1}]b_{1o_{2}}=0.04187 α3​(1)=[i=1∑3​α2​(i)ai1​]b1o2​​=0.04187 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子2的概率： α 3 ( 2 ) = [ ∑ i = 1 3 α 2 ( i ) a i 2 ] b 2 o 2 = 0.03551 \\alpha_{3}(2) = [\\sum_{i=1}^3 \\alpha_{2}(i)a_{i2}]b_{2o_{2}}=0.03551 α3​(2)=[i=1∑3​α2​(i)ai2​]b2o2​​=0.03551 t = 3 t=3 t=3 时刻取出红球，隐状态是盒子2的概率： α 3 ( 3 ) = [ ∑ i = 1 3 α 2 ( i ) a i 3 ] b 3 o 2 = 0.05284 \\alpha_{3}(3) = [\\sum_{i=1}^3 \\alpha_{2}(i)a_{i3}]b_{3o_{2}}=0.05284 α3​(3)=[i=1∑3​α2​(i)ai3​]b3o2​​=0.05284 （4) 终止 P ( O ∣ λ ) = ∑ i = 1 3 α 3 ( i ) = 0.13022 P(O|\\lambda) =\\sum_{i=1}^3 \\alpha_{3}(i)=0.13022 P(O∣λ)=i=1∑3​α3​(i)=0.13022 4.1.3 后向算法 其实后向算法和前向算法类似，只不过是从后往前递推。 后向概率 β t ( i ) \\beta{t}(i) βt(i) 如下图所示： 首先，定义最后时刻的 β T ( i ) = 1 \\beta_{T}(i) = 1 βT​(i)=1。 然后 ，对于 t = T − 1 , T − 2 , . . . , 1 t = T-1,T-2,...,1 t=T−1,T−2,...,1，后向概率 β t ( i ) \\beta_{t}(i) βt​(i) 就等于 t t t 时刻的状态 i t = q i i_{t} = q_{i} it​=qi​ 转移到时刻 t + 1 t+1 t+1 的状态 i t + 1 = q j i_{t+1} = q_{j} it+1​=qj​ 的概率 × t + 1 t+1 t+1 时刻状态 i t + 1 i_{t+1} it+1​ 对应的观测状态 o t + 1 o_{t+1} ot+1​ 的概率 × t + 1 t+1 t+1 时刻的后向概率 β t + 1 ( i ) \\beta_{t+1}(i) βt+1​(i)。即： β t ( i ) = ∑ j = 1 n a i j b j o t + 1 β t + 1 ( i ) \\beta_{t}(i) = \\sum_{j=1}^n a_{ij}b_{jo_{t+1}}\\beta_{t+1}(i) βt​(i)=j=1∑n​aij​bjot+1​​βt+1​(i) 如下图所示： 最后，观测概率 P ( O ∣ λ ) = ∑ i = 1 n π i b i o 1 β 1 ( i ) P(O|\\lambda) = \\sum_{i=1}^n \\pi_{i}b_{io_{1}}\\beta_{1}(i) P(O∣λ)=∑i=1n​πi​bio1​​β1​(i)。 其实，观测概率 P ( O ∣ λ ) P(O|\\lambda) P(O∣λ) 还可以这么写： P ( O ∣ λ ) = ∑ i = 1 n ∑ j = 1 n α t ( i ) a i j b j o t + 1 β t + 1 ( j ) P(O|\\lambda) = \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\\beta_{t+1}(j) P(O∣λ)=i=1∑n​j=1∑n​αt​(i)aij​bjot+1​​βt+1​(j) 是不是其实很好理解。 4.1.3 一些概率与期望的计算 利用前向概率和后向概率,可以得到关于单个状态和两个状态概率的计算公式。 给定模型 λ \\lambda λ 和观测 O O O，在时刻 t t t 处于状态 q i q_{i} qi​ 的概率。记 γ t ( i ) = P ( i t = q i ∣ O , λ ) = P ( i t = q i , O ∣ λ ) P ( O ∣ λ ) \\gamma_{t}(i) = P(i_{t}=q_{i}|O,\\lambda) = \\frac{P(i_{t}=q_{i},O|\\lambda)}{P(O|\\lambda)} γt​(i)=P(it​=qi​∣O,λ)=P(O∣λ)P(it​=qi​,O∣λ)​ 由前向概率 α t ( i ) \\alpha_t(i) αt​(i) 和后向概率 β t ( i ) \\beta_t(i) βt​(i) 定义可知: α t ( i ) β t ( i ) = P ( i t = q t ∣ O , λ ) \\alpha_{t}(i)\\beta_t(i) = P(i_{t}=q_{t}|O,\\lambda) αt​(i)βt​(i)=P(it​=qt​∣O,λ) 于是得到: γ t ( i ) = α t ( i ) β t ( i ) P ( O ∣ λ ) = α t ( i ) β t ( i ) ∑ j = 1 N α t ( j ) β t ( j ) \\gamma_{t}(i) = \\frac{\\alpha_{t}(i)\\beta_t(i)}{P(O|\\lambda)} = \\frac{\\alpha_{t}(i)\\beta_t(i)}{\\sum_{j=1}^N \\alpha_{t}(j)\\beta_t(j)} γt​(i)=P(O∣λ)αt​(i)βt​(i)​=∑j=1N​αt​(j)βt​(j)αt​(i)βt​(i)​ 给定模型 λ \\lambda λ 和观测 O O O，在时刻 t t t 处于状态 q i q_{i} qi​ 的概率。同时在时刻 t + 1 t+1 t+1 处于状态 q j q_{j} qj​ 的概率，记 ξ t ( i , j ) = P ( i t = q i , i t + 1 = q j ∣ O , λ ) = P ( i t = q i , i t + 1 = q j , O ∣ λ ) ∑ i = 1 N ∑ j = 1 N P ( i t = q i , i t + 1 = q j , O ∣ λ ) \\xi_{t}(i,j) = P(i_{t}=q_{i},i_{t+1}=q_{j}|O,\\lambda) = \\frac{P(i_{t}=q_{i},i_{t+1}=q_{j},O|\\lambda)}{\\sum_{i=1}^N \\sum_{j=1}^N P(i_{t}=q_{i},i_{t+1}=q_{j},O|\\lambda)} ξt​(i,j)=P(it​=qi​,it+1​=qj​∣O,λ)=∑i=1N​∑j=1N​P(it​=qi​,it+1​=qj​,O∣λ)P(it​=qi​,it+1​=qj​,O∣λ)​ 而 P ( i t = q i , i t + 1 = q j , O ∣ λ ) = α t ( i ) a i j b j o t + 1 β t + 1 ( j ) P(i_{t}=q_{i},i_{t+1}=q_{j},O|\\lambda) = \\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\\beta_{t+1}(j) P(it​=qi​,it+1​=qj​,O∣λ)=αt​(i)aij​bjot+1​​βt+1​(j) 所以 ξ t ( i , j ) = q j , O ∣ λ ) = α t ( i ) a i j b j o t + 1 β t + 1 ( j ) ∑ i = 1 N ∑ j = 1 N α t ( i ) a i j b j o t + 1 β t + 1 ( j ) \\xi_{t}(i,j) = q_{j},O|\\lambda) = \\frac{\\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\\beta_{t+1}(j)}{\\sum_{i=1}^N \\sum_{j=1}^N \\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\\beta_{t+1}(j)} ξt​(i,j)=qj​,O∣λ)=∑i=1N​∑j=1N​αt​(i)aij​bjot+1​​βt+1​(j)αt​(i)aij​bjot+1​​βt+1​(j)​ 4.2 学习算法 目的： 给定观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​ 和状态序列 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​，求HMM 模型 λ = ( A , B , π ) \\lambda = (A,B,\\pi) λ=(A,B,π) 的三个参数。 给定观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求HMM 模型 λ = ( A , B , π ) \\lambda = (A,B,\\pi) λ=(A,B,π) 的三个参数。 解决方法： 监督算法 B a u m − W e l c h Baum-Welch Baum−Welch 算法 4.2.1 监督算法 第二步求观测概率应该是 b j k b_{jk} bjk​，因为懒，就直接截图了。 4.2.2 Baum-Welch 算法 现在已经知道的是观测数据 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​， 设隐状态数据为 I = i 1 , i 2 , . . . , i T I={i_{1},i_{2},...,i_{T}} I=i1​,i2​,...,iT​，那么完全数据是 ( O , I ) = ( o 1 , o 2 , . . . , o T , i 1 , i 2 , . . . , i T ) (O,I)=(o_{1},o_{2},...,o_{T},i_{1},i_{2},...,i_{T}) (O,I)=(o1​,o2​,...,oT​,i1​,i2​,...,iT​)。完全数据的对数似然函数是 l o g P ( O , I ∣ λ ) logP(O,I|\\lambda) logP(O,I∣λ)。 既然 B a u m − W e l c h Baum-Welch Baum−Welch 算法使用的就是 E M EM EM 算法，那么就要走两个步骤： （1） E E E 步 求出联合分布 P ( O , I ∣ λ ) P(O,I|\\lambda) P(O,I∣λ) 基于条件概率 ( I ∣ O , λ ‾ ) (I|O,\\overline \\lambda) (I∣O,λ) 的期望，其中 λ ‾ \\overline \\lambda λ 为 HMM 模型参数的当前估计值， λ \\lambda λ 为极大化的 HMM 模型参数。 （2） M M M 步 最大化这个期望，得到更新的模型参数λ。接着不停的进行EM迭代，直到模型参数的值收敛为止。 公式推导： （1） E E E 步：求 Q Q Q 函数 根据 E M EM EM 的 Q Q Q 函数定义，即这里要求的联合分布的期望为： Q ( λ , λ ‾ ) = ∑ I P ( I ∣ O , λ ‾ ) l n P ( O , I ∣ λ ) = ∑ I l n P ( O , I ∣ λ ) P ( I , O ∣ λ ‾ ) P ( O , λ ‾ ) Q(\\lambda,\\overline \\lambda) = \\sum_{I}P(I|O,\\overline \\lambda)lnP(O,I|\\lambda) = \\sum_{I}lnP(O,I|\\lambda)\\frac{P(I,O|\\overline \\lambda)}{P(O,\\overline \\lambda)} Q(λ,λ)=I∑​P(I∣O,λ)lnP(O,I∣λ)=I∑​lnP(O,I∣λ)P(O,λ)P(I,O∣λ)​ P ( O , λ ‾ ) P(O,\\overline \\lambda) P(O,λ) 表示上次求出的参数与观测数据的联合概率，没有什么影响，所以： Q ( λ , λ ‾ ) = ∑ I l n P ( O , I ∣ λ ) P ( I , O ∣ λ ‾ ) Q(\\lambda,\\overline \\lambda) = \\sum_{I}lnP(O,I|\\lambda)P(I,O|\\overline \\lambda) Q(λ,λ)=I∑​lnP(O,I∣λ)P(I,O∣λ) 而 P ( O , I ∣ λ ) = π i 1 b i 1 o 1 a i 1 i 2 b i 2 o 2 . . . a i T − 1 i T b i T o T P(O,I|\\lambda) = \\pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}} P(O,I∣λ)=πi1​​bi1​o1​​ai1​i2​​bi2​o2​​...aiT−1​iT​​biT​oT​​ 所以 Q ( λ , λ ‾ ) = ∑ I P ( I , O ∣ λ ‾ ) [ l n π i 1 + l n ( a i 1 i 2 + . . . + a i T − 1 i T + l n ( b i 1 o 1 + . . . + b i T o T ) ) ] = ∑ I l n π i 1 P ( I , O ∣ λ ‾ ) ⎵ 式 1 + ∑ I ( ∑ t = 1 T − 1 l n a i t i t + 1 ) P ( I , O ∣ λ ‾ ) ⎵ 式 2 + ∑ I ( ∑ t = 1 T l n b i t o t ) P ( I , O ∣ λ ‾ ) ⎵ 式 3 Q(\\lambda,\\overline \\lambda) = \\sum_{I}P(I,O|\\overline \\lambda) [ln \\pi_{i_{1}} + ln(a_{i_{1}i_{2}}+...+a_{i_{T-1}i_{T}} + ln(b_{i_{1}o_{1}}+...+b_{i_{T}o_{T}}))] \\\\ = \\underbrace{ \\sum_{I} ln \\pi_{i_{1}} P(I,O|\\overline \\lambda)}_{式1} + \\underbrace{ \\sum_{I} (\\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(I,O|\\overline \\lambda)}_{式2} + \\underbrace{ \\sum_{I} (\\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\\overline \\lambda)}_{式3} Q(λ,λ)=I∑​P(I,O∣λ)[lnπi1​​+ln(ai1​i2​​+...+aiT−1​iT​​+ln(bi1​o1​​+...+biT​oT​​))]=式1 I∑​lnπi1​​P(I,O∣λ)​​+式2 I∑​(t=1∑T−1​lnait​it+1​​)P(I,O∣λ)​​+式3 I∑​(t=1∑T​lnbit​ot​​)P(I,O∣λ)​​ （2） M M M 步：极大化 Q Q Q，求模型参数 A , B , π A,B,\\pi A,B,π 　1）求 π i \\pi_{i} πi​： 　既然是求极值，肯定是要求导了。对于 π i \\pi_{i} πi​ 来说，满足约束条件 ∑ t = 1 N π i = 1 \\sum_{t=1}^N \\pi_{i}=1 ∑t=1N​πi​=1。现在就变成了带约束条件的求极值，直接上拉格朗日乘子法。 　式 1 可以写成： 　 ∑ I l n π i 1 P ( I , O ∣ λ ‾ ) = ∑ i = 1 N l n π i P ( O , i 1 = q i ∣ λ ‾ ) \\sum_{I} ln \\pi_{i_{1}} P(I,O|\\overline \\lambda) = \\sum_{i=1}^N ln \\pi_{i} P(O,i_{1}=q_{i}|\\overline \\lambda) I∑​lnπi1​​P(I,O∣λ)=i=1∑N​lnπi​P(O,i1​=qi​∣λ) 　拉格朗日函数： 　 L = ∑ i = 1 N l n π i P ( O , i 1 = q i ∣ λ ‾ ) + γ ( ∑ i = 1 N π i − 1 ) L = \\sum_{i=1}^N ln \\pi_{i}P(O,i_{1}=q_{i}|\\overline \\lambda) + \\gamma(\\sum_{i=1}^N \\pi_{i}-1) L=i=1∑N​lnπi​P(O,i1​=qi​∣λ)+γ(i=1∑N​πi​−1) 　首先把求和 ∑ \\sum ∑ 去掉，只对单个的 π i \\pi_{i} πi​ 求偏导并等于 0： 　 ∂ L ∂ π i = P ( O , i 1 = q i ∣ λ ‾ ) π i + γ = 0 \\frac{\\partial L}{\\partial \\pi_{i}} = \\frac{P(O,i_{1}=q_{i}|\\overline \\lambda)}{\\pi_{i}} + \\gamma = 0 ∂πi​∂L​=πi​P(O,i1​=qi​∣λ)​+γ=0 　等价于： 　 ∂ L ∂ π i = P ( O , i 1 = q i ∣ λ ‾ ) + γ π i = 0 \\frac{\\partial L}{\\partial \\pi_{i}} =P(O,i_{1}=q_{i}|\\overline \\lambda) + \\gamma \\pi_{i} = 0 ∂πi​∂L​=P(O,i1​=qi​∣λ)+γπi​=0 　然后再添上对 i i i 的求和 ∑ \\sum ∑，可得到： 　 γ = − P ( O ∣ λ ‾ ) \\gamma = -P(O|\\overline \\lambda) γ=−P(O∣λ) 　带入到第三项公式，可得： 　 π i = P ( O , i 1 = q i ∣ λ ‾ ) P ( O ∣ λ ‾ ) \\pi_{i} = \\frac{P(O,i_{1}=q_{i}|\\overline \\lambda)}{P(O|\\overline \\lambda)} πi​=P(O∣λ)P(O,i1​=qi​∣λ)​ 2）求 a i j a_{ij} aij​： 　式 2 可以写成： 　 ∑ I ( ∑ t = 1 T − 1 l n a i t i t + 1 ) P ( O , I ∣ λ ‾ ) = ∑ i = 1 N ∑ j = 1 N ∑ t = 1 T − 1 l n a i j P ( O , i t = q i , i t + 1 = q j ∣ λ ‾ ) \\sum_{I} (\\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(O,I|\\overline \\lambda) = \\sum_{i=1}^N \\sum_{j=1}^N \\sum_{t=1}^{T-1} ln a_{ij} P(O,i_{t}=q_{i},i_{t+1}=q_{j}|\\overline \\lambda) I∑​(t=1∑T−1​lnait​it+1​​)P(O,I∣λ)=i=1∑N​j=1∑N​t=1∑T−1​lnaij​P(O,it​=qi​,it+1​=qj​∣λ) 　同样有约束条件 ∑ j = 1 N a i j = 1 \\sum_{j=1}^Na_{ij}=1 ∑j=1N​aij​=1，最后可以得到： 　 a i j = ∑ t = 1 T − 1 P ( O , i 1 = q i , i t + 1 = q j ∣ λ ‾ ) P ( O , i t = q i ∣ λ ‾ ) a_{ij} = \\frac{\\sum_{t=1}^{T-1} P(O,i_{1}=q_{i},i_{t+1}=q_{j}|\\overline \\lambda)}{P(O,i_{t}=q_{i}|\\overline \\lambda)} aij​=P(O,it​=qi​∣λ)∑t=1T−1​P(O,i1​=qi​,it+1​=qj​∣λ)​ 　3）求 b i j b_{ij} bij​： 　式 3 可以写成： 　　 ∑ I ( ∑ t = 1 T l n b i t o t ) P ( I , O ∣ λ ‾ ) = ∑ j = 1 N ∑ t = 1 T − 1 l n b j o t P ( O , i t = q j ∣ λ ‾ ) \\sum_{I} (\\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\\overline \\lambda) = \\sum_{j=1}^N \\sum_{t=1}^{T-1} lnb_{jo_{t}}P(O,i_{t}=q_{j}|\\overline \\lambda) I∑​(t=1∑T​lnbit​ot​​)P(I,O∣λ)=j=1∑N​t=1∑T−1​lnbjot​​P(O,it​=qj​∣λ) 　同样有约束条件 ∑ k = 1 M b j k = 1 \\sum_{k=1}^M b_{jk}=1 ∑k=1M​bjk​=1，要注意的是只有在 o t = v k o_{t}=v_{k} ot​=vk​ 时 b j o t b_{jo_{t}} bjot​​ 对 b j k b_{jk} bjk​ 的偏导数才不为 0，以 I ( o t = v k ) I(o_{t}=v_{k}) I(ot​=vk​) 表示，最后可以得到： 　 b j k = ∑ t = 1 T P ( O , i t = q j ∣ λ ‾ ) I ( o t = v k ) ∑ t = 1 T P ( O , i t = q j ∣ λ ‾ ) b_{jk} = \\frac{\\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\\overline \\lambda) I(o_{t}=v_{k})}{\\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\\overline \\lambda)} bjk​=∑t=1T​P(O,it​=qj​∣λ)∑t=1T​P(O,it​=qj​∣λ)I(ot​=vk​)​ 参数估计公式： 得到参数后，可以用 4.1.3 节的 γ t ( i ) , ξ t ( i , j ) \\gamma_{t}(i),\\xi_{t}(i,j) γt​(i),ξt​(i,j) 表示： 算法总结： 4.3 预测算法 目的：给定 HMM 模型 λ = ( A , B , π ) \\lambda = (A,B,\\pi) λ=(A,B,π) 和观测序列 O = o 1 , o 2 , . . . , o T O={o_{1},o_{2},...,o_{T}} O=o1​,o2​,...,oT​，求在该观测序列下，最可能对应的状态序列 I ∗ = i 1 ∗ , i 2 ∗ , . . . , i T ∗ I^*={i_{1}^*,i_{2}^*,...,i_{T}^*} I∗=i1∗​,i2∗​,...,iT∗​，也就是最大化 P ( I ∗ ∣ O ) P(I^*|O) P(I∗∣O)。 解决：Viterbi 算法。 其实维特比算法就用动态规划的方法求概率最大路径，计算过程中的每条路径都对应着一个状态序列。计算过程中将最优路径经过的点都保存下来。得到最优路径后，由后向前逐步求得最优结点，这就是维特比算法。 过程： 因为计算过程很简单，就直接给出书中的截图了。 首先导入两个变量 δ \\delta δ和 ψ \\psi ψ。定义在时刻 t t t 状态为 i i i 的所有单个路径 ( i 1 , i 2 , . . . , i t ) (i_{1} ,i_{2},...,i_{t} ) (i1​,i2​,...,it​) 中概率最大值为： 过程是不是很好理解？如果还不好理解，就继续看个例子。 例子： 整个计算过程如下图所示， Reference 统计学习方法 李航","@type":"BlogPosting","url":"/2019/01/17/a7e8b846e28d5c2e5ea340893ece0603.html","headline":"机器学习笔记之隐马尔科夫模型","dateModified":"2019-01-17T00:00:00+08:00","datePublished":"2019-01-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/01/17/a7e8b846e28d5c2e5ea340893ece0603.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>机器学习笔记之隐马尔科夫模型</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="article-copyright">
   版权声明：本文为博主原创文章，转载请指明作者以及链接，并通知作者，谢谢。 https://blog.csdn.net/wshixinshouaaa/article/details/85701540 
 </div> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p></p>
  <div class="toc">
   <h3>隐马尔科夫HMM</h3>
   <ul>
    <ul>
     <li><a href="#_1" rel="nofollow">一、序言</a></li>
     <li><a href="#_5" rel="nofollow">二、基本概念</a></li>
     <ul>
      <li><a href="#21__6" rel="nofollow">2.1 定义</a></li>
      <li><a href="#22__31" rel="nofollow">2.2 例子</a></li>
      <li><a href="#23__49" rel="nofollow">2.3 基本假设</a></li>
     </ul>
     <li><a href="#_52" rel="nofollow">三、三个问题</a></li>
     <ul>
      <li><a href="#31__56" rel="nofollow">3.1 概率计算问题</a></li>
      <li><a href="#32__58" rel="nofollow">3.2 学习问题</a></li>
      <li><a href="#33__60" rel="nofollow">3.3 预测问题</a></li>
     </ul>
     <li><a href="#_63" rel="nofollow">四、三个问题解决算法</a></li>
     <ul>
      <li><a href="#41__64" rel="nofollow">4.1 概率计算算法</a></li>
      <ul>
       <li><a href="#411__66" rel="nofollow">4.1.1 直接计算法（暴力法）</a></li>
       <li><a href="#412__76" rel="nofollow">4.1.2 前向算法</a></li>
       <ul>
        <li><a href="#4121__77" rel="nofollow">4.1.2.1 详解</a></li>
        <li><a href="#4122__90" rel="nofollow">4.1.2.2 例子</a></li>
       </ul>
       <li><a href="#413__127" rel="nofollow">4.1.3 后向算法</a></li>
       <li><a href="#413__141" rel="nofollow">4.1.3 一些概率与期望的计算</a></li>
      </ul>
      <li><a href="#42__156" rel="nofollow">4.2 学习算法</a></li>
      <ul>
       <li><a href="#421__164" rel="nofollow">4.2.1 监督算法</a></li>
       <li><a href="#422_BaumWelch__168" rel="nofollow">4.2.2 Baum-Welch 算法</a></li>
      </ul>
      <li><a href="#43__223" rel="nofollow">4.3 预测算法</a></li>
     </ul>
     <li><a href="#Reference_240" rel="nofollow">Reference</a></li>
    </ul>
   </ul>
  </div>
  <p></p> 
  <h2><a id="_1"></a>一、序言</h2> 
  <p>重新复习隐马尔科夫模型，重点是<em>HMM</em>模型的三个问题及前向、后向和维特比算法。</p> 
  <h2><a id="_5"></a>二、基本概念</h2> 
  <h3><a id="21__6"></a>2.1 定义</h3> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107090825787.png" alt="definition"><br> 隐马尔可夫模型由初始概率分布、状态转移概率分布以及观测概率分布确定。隐马尔可夫模型的形式定义如下:<br> 设Q是所有可能的状态的集合,V是所有可能的观测的集合。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           Q
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             q
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             n
            </mi>
           </msub>
          </mrow>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi>
           V
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             v
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             v
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <msub>
            <mi>
             v
            </mi>
            <mi>
             m
            </mi>
           </msub>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
          Q={q_{1},q_{2},...,q_{n}}, \quad V={v_{1},v_{2},...v_{m}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">Q</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          n
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         n
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span>是可能的状态数,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span>是可能的观测数。<br> 设<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         I
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span></span></span></span></span>是长度为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span>的状态序列,<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         O
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span></span></span></span></span>是对应的观测序列:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           I
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             t
            </mi>
           </msub>
          </mrow>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi>
           O
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             o
            </mi>
            <mi>
             t
            </mi>
           </msub>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
          I={i_{1},i_{2},...,i_{t}}, \quad O={o_{1},o_{2},...,o_{t}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         A
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">A</span></span></span></span></span>是状态转移概率矩阵:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           A
          </mi>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <msub>
           <mo>
            ]
           </mo>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             ×
            </mo>
            <mi>
             n
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          A=[a_{ij}]_{n×n}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.258331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">×</span><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 其中,<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            j
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <msub>
           <mi>
            i
           </mi>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi>
           i
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi>
           n
          </mi>
          <mo separator="true">
           ;
          </mo>
          <mi>
           j
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           n
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          a_{ij}=P(i_{t}=q_{j}|i_{t-1}=q_{i}), \quad i=1,...n;j=1,...,n
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathit">n</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">n</span></span></span></span></span></span><br> 是在时刻<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t-1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>处于状态<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的条件下在时刻<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span>转移到状态<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的概率。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         B
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span></span></span></span></span>是观测概率矩阵:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           B
          </mi>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             j
            </mi>
            <mi>
             k
            </mi>
           </mrow>
          </msub>
          <msub>
           <mo>
            ]
           </mo>
           <mrow>
            <mi>
             n
            </mi>
            <mo>
             ×
            </mo>
            <mi>
             m
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          B=[b_{jk}]_{n×m}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.258331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">×</span><span class="mord mathit mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 其中，<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             k
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            v
           </mi>
           <mi>
            k
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <msub>
           <mi>
            i
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            j
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi>
           k
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi>
           m
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           j
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           n
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          b_{kj}=P(o_{t}=v_{k}|i_{t}=q_{j}), \quad k=1,...m,j=1,...,n
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathit">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">n</span></span></span></span></span></span><br> 是在时刻<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span>处于状态<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的条件下生成观测<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           v
          </mi>
          <mi>
           k
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         v_{k}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的概率。<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          π
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span>是初始状态概率向量:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           π
          </mi>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          \pi=\pi_{i}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 其中，<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
          <mspace width="1em"></mspace>
          <mi>
           i
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi>
           n
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \pi_{i}=P(i_{1}=q_{i}), \quad i=1,...n
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathit">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathit">n</span></span></span></span></span></span><br> 是初始时刻<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>处于状态<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的概率。<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107092808615.png" alt="definition"></p> 
  <h3><a id="22__31"></a>2.2 例子</h3> 
  <p>举个例子，当观察到屋外艳阳高照，那么肯定是晴天；若是半乌云密布，则是阴天；若是电闪雷鸣，则是雨天。艳阳高照，乌云密布，电闪雷鸣是我们能直接观察到的，对应着上面定义的观测序列。<br> 而它们对应的天气状态分别是晴天、阴天和雨天，则是状态序列，因为我们先观察到外边的环境是艳阳高照，乌云密布，电闪雷鸣，然后再推测出是晴天、阴天还是雨天。<br> 如下图所示，上面的是一条隐马尔科夫链，下面对应着其随机生成的状态序列。<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107095010599.png#pic_center" alt=""><br> 如下图所示，是一个完整的 <em>HMM</em> 模型。<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190111085547744.png" alt=""><br> 状态集合 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          Q
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            q
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mn>
            3
           </mn>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         Q={q_{1},q_{2},q_{3}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">Q</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mi mathvariant="normal">
          艳
         </mi>
         <mi mathvariant="normal">
          阳
         </mi>
         <mi mathvariant="normal">
          高
         </mi>
         <mi mathvariant="normal">
          照
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{1}=艳阳高照
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback">艳</span><span class="mord cjk_fallback">阳</span><span class="mord cjk_fallback">高</span><span class="mord cjk_fallback">照</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mi mathvariant="normal">
          乌
         </mi>
         <mi mathvariant="normal">
          云
         </mi>
         <mi mathvariant="normal">
          密
         </mi>
         <mi mathvariant="normal">
          布
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{2}=乌云密布
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback">乌</span><span class="mord cjk_fallback">云</span><span class="mord cjk_fallback">密</span><span class="mord cjk_fallback">布</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mn>
           3
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mi mathvariant="normal">
          电
         </mi>
         <mi mathvariant="normal">
          闪
         </mi>
         <mi mathvariant="normal">
          雷
         </mi>
         <mi mathvariant="normal">
          鸣
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{3}=电闪雷鸣
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback">电</span><span class="mord cjk_fallback">闪</span><span class="mord cjk_fallback">雷</span><span class="mord cjk_fallback">鸣</span></span></span></span></span>。<br> 观测集合 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          V
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            v
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            v
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            v
           </mi>
           <mn>
            3
           </mn>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         V={v_{1},v_{2},v_{3}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           v
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mi mathvariant="normal">
          晴
         </mi>
         <mi mathvariant="normal">
          天
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         v_{1}=晴天
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback">晴</span><span class="mord cjk_fallback">天</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           v
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mi mathvariant="normal">
          阴
         </mi>
         <mi mathvariant="normal">
          天
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         v_{2}=阴天
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback">阴</span><span class="mord cjk_fallback">天</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           v
          </mi>
          <mn>
           3
          </mn>
         </msub>
         <mo>
          =
         </mo>
         <mi mathvariant="normal">
          雨
         </mi>
         <mi mathvariant="normal">
          天
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         v_{3}=雨天
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mord cjk_fallback">雨</span><span class="mord cjk_fallback">天</span></span></span></span></span>。<br> 状态转移概率矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         A
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">A</span></span></span></span></span>：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107103954108.png#pic_center" alt=""><br> 观测概率矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         B
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span></span></span></span></span>：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/2019010710464651.png#pic_center" alt=""><br> 初始状态概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          π
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span>：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107104951142.png#pic_center" alt=""></p> 
  <blockquote> 
   <p>以上数据是随便写的。</p> 
  </blockquote> 
  <h3><a id="23__49"></a>2.3 基本假设</h3> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107105523118.png" alt=""></p> 
  <h2><a id="_52"></a>三、三个问题</h2> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190107105637562.png" alt=""></p> 
  <p>只看这个可能有点晦涩，下面就例子说的通俗一下：</p> 
  <h3><a id="31__56"></a>3.1 概率计算问题</h3> 
  <p>评估问题，即概率计算问题，是三个问题中最简单的。给定 <em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span>，也就是已经知道状态转移概率矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         A
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">A</span></span></span></span></span>、观测概率矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         B
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span></span></span></span></span> 和初始状态概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          π
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span>，同时给出观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            t
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{t}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，求在该 <em>HMM</em> 模型下这个观测序列生成的概率。例如求接下来三天的观测天气是（阴天，雨天，晴天）的概率。解决算法：前向-后向算法。</p> 
  <h3><a id="32__58"></a>3.2 学习问题</h3> 
  <p>学习问题是三个问题中最复杂的一个。这个问题中只给出观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            t
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{t}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，让求 <em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span> 的三个参数： <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         A
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">A</span></span></span></span></span>、 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         B
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          π
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span>。例如，给出观测天气是（阴天，雨天，晴天），根据观测序列求一个 <em>HMM</em> 模型。解决算法：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
         <mi>
          a
         </mi>
         <mi>
          u
         </mi>
         <mi>
          m
         </mi>
         <mo>
          −
         </mo>
         <mi>
          W
         </mi>
         <mi>
          e
         </mi>
         <mi>
          l
         </mi>
         <mi>
          c
         </mi>
         <mi>
          h
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Baum-Welch
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mord mathit">a</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">W</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">c</span><span class="mord mathit">h</span></span></span></span></span> 算法（EM算法）。</p> 
  <h3><a id="33__60"></a>3.3 预测问题</h3> 
  <p>预测问题，也称为解码问题。给定 <em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span> 和观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            t
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{t}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，求在该 <em>HMM</em> 模型下最有可能生成这个观测序列的隐状态序列。例如，观测天气是（阴天，雨天，晴天），求最有可能对应该观测序列的状态序列是（艳阳高照，乌云密布，电闪雷鸣），还是（乌云密布，电闪雷鸣，艳阳高照），或者是其他的某个状态序列。解决算法：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          V
         </mi>
         <mi>
          i
         </mi>
         <mi>
          t
         </mi>
         <mi>
          e
         </mi>
         <mi>
          r
         </mi>
         <mi>
          b
         </mi>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Viterbi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mord mathit">i</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">b</span><span class="mord mathit">i</span></span></span></span></span> 算法（一种动态规划）。</p> 
  <h2><a id="_63"></a>四、三个问题解决算法</h2> 
  <h3><a id="41__64"></a>4.1 概率计算算法</h3> 
  <p><strong>目的</strong>：给定 <em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
         <mo>
          =
         </mo>
         <mo>
          (
         </mo>
         <mi>
          A
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          B
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          π
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda = (A,B,\pi)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span></span></span></span></span> 和观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            T
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{T}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，求在该<em>HMM</em> 模型下生成该观测序列的概率<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(O|\lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span>。</p> 
  <h4><a id="411__66"></a>4.1.1 直接计算法（暴力法）</h4> 
  <p>首先，在给定 <em>HMM</em> 模型下，生成 <strong>一个</strong> 隐状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mi>
            T
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         I={i_{1},i_{2},...,i_{T}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> 的概率为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </msub>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              3
             </mn>
            </msub>
           </mrow>
          </msub>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               T
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          P(I|\lambda) = \pi_{i_{1}}a_{i_{1}i_{2}}a_{i_{2}i_{3}}...a_{i_{T-1}i_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72253em; vertical-align: -0.29197em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202814em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29197em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 然后，在该状态序列，生成对应的观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            T
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{T}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> 的改立为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          P(O|I,\lambda) = b_{i_{1}o_{1}}b_{i_{2}o_{2}}...b_{i_{T}o_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.944745em; vertical-align: -0.250305em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.250305em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 最后，在给定 <em>HMM</em> 模型下，生成状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         I
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span></span></span></span></span> 和观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         O
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span></span></span></span></span> 的联合概率为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               T
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          P(O,I|\lambda) = P(O|I,\lambda)P(I|\lambda) = \pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.98641em; vertical-align: -0.29197em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202814em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29197em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.250305em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 综上是 <em>HMM</em> 模型生成一个状态序列，再生成观测序列的概率。只要对所有不同的状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         I
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span></span></span></span></span> 求和，就是要求的给定观测序列的概率<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(O|\lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span>：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mrow>
            <msub>
             <mi>
              I
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              I
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <mo separator="true">
             ,
            </mo>
            <mi mathvariant="normal">
             .
            </mi>
            <mi mathvariant="normal">
             .
            </mi>
            <mi mathvariant="normal">
             .
            </mi>
           </mrow>
          </munder>
          <msub>
           <mi>
            π
           </mi>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               T
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          P(O|\lambda) = \sum_{I}P(O|I,\lambda)P(I|\lambda) = \sum_{I_{1},I_{2},...}\pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.34434em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.48045em; vertical-align: -1.43044em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.07847em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.07847em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">.</span><span class="mord mtight">.</span><span class="mord mtight">.</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.43044em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202814em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29197em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.250305em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 使用该算法原理简单，但是计算量巨大。时间复杂度：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          (
         </mo>
         <mi>
          T
         </mi>
         <msup>
          <mi>
           N
          </mi>
          <mi>
           T
          </mi>
         </msup>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         O(TN^{T})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord"><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。</p> 
  <h4><a id="412__76"></a>4.1.2 前向算法</h4> 
  <h5><a id="4121__77"></a>4.1.2.1 详解</h5> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190113211606424.png" alt=""><br> 前向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{t}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span> 如下图所示：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114193022254.png" alt=""><br> 其实，前向算法可以看做是动态规划。<br> 注意看呦，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{t}(i) = P(o_{1},o_{2},...,o_{t},i_{t}=q_{t}|\lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span> 这不就是 <strong>暴力法中第三步</strong> 求的状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         I
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span></span></span></span></span> 和观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         O
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span></span></span></span></span> 的联合概率吗？<br> 我们只要把 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span> 时刻中所有状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ∈
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           q
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           q
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           n
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{i} \in (q_{1},q_{2},...,q_{n})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 做累加，然后乘上<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          +
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t+1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         q_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 对应的观测概率，即 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          [
         </mo>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            j
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           n
          </mi>
         </msubsup>
         <msub>
          <mi>
           α
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          j
         </mi>
         <mo>
          )
         </mo>
         <msub>
          <mi>
           a
          </mi>
          <mrow>
           <mi>
            j
           </mi>
           <mi>
            i
           </mi>
          </mrow>
         </msub>
         <mo>
          ]
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <msub>
          <mi>
           o
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         [\sum_{j=1}^n \alpha_{t}(j)a_{ji}]b_{i}o_{t+1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.24011em; vertical-align: -0.435818em;"></span><span class="mopen">[</span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，就得到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          +
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t+1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻的状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         I
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span></span></span></span></span> 和观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         O
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span></span></span></span></span> 的联合概率，即前向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{t+1}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span>。<br> 如下图所示：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114090116384.png#pic_center" alt=""><br> 所以，只要计算出 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻的前向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{1}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span>，往后依次递推就可以了。例如 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           π
          </mi>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
         </msub>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{1}(i) = \pi_{i_{1}}b_{i_{1}o_{1}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94454em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           α
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           α
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mn>
          1
         </mn>
         <mo>
          )
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           α
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mn>
          2
         </mn>
         <mo>
          )
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          +
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo>
          +
         </mo>
         <msub>
          <mi>
           α
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          n
         </mi>
         <mo>
          )
         </mo>
         <msub>
          <mi>
           b
          </mi>
          <mi>
           n
          </mi>
         </msub>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \alpha_{2}(i) = \alpha_{1}(1)b_{1}o_{i} + \alpha_{1}(2)b_{2}o_{i} +...+\alpha_{1}(n)b_{n}o_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。</p> 
  <p>综上：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114094417518.png#pic_center" alt=""></p> 
  <h5><a id="4122__90"></a>4.1.2.2 例子</h5> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114094229590.png#pic_center" alt=""><br> 观测集合为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           V
          </mi>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mi mathvariant="normal">
           红
          </mi>
          <mi mathvariant="normal">
           ，
          </mi>
          <mi mathvariant="normal">
           白
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          V=(红，白)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">V</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord cjk_fallback">红</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">白</span><span class="mclose">)</span></span></span></span></span></span><br> 状态集合为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           Q
          </mi>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mi mathvariant="normal">
           盒
          </mi>
          <mi mathvariant="normal">
           子
          </mi>
          <mn>
           1
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           盒
          </mi>
          <mi mathvariant="normal">
           子
          </mi>
          <mn>
           2
          </mn>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           盒
          </mi>
          <mi mathvariant="normal">
           子
          </mi>
          <mn>
           3
          </mn>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          Q=(盒子1,盒子2,盒子3)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">Q</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord cjk_fallback">盒</span><span class="mord cjk_fallback">子</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord cjk_fallback">盒</span><span class="mord cjk_fallback">子</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord cjk_fallback">盒</span><span class="mord cjk_fallback">子</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span></span><br> 观测序列为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           O
          </mi>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mi mathvariant="normal">
           红
          </mi>
          <mi mathvariant="normal">
           ，
          </mi>
          <mi mathvariant="normal">
           白
          </mi>
          <mi mathvariant="normal">
           ，
          </mi>
          <mi mathvariant="normal">
           红
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          O=(红，白，红)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord cjk_fallback">红</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">白</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">红</span><span class="mclose">)</span></span></span></span></span></span><br> 状态转移概率矩阵为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         A
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">A</span></span></span></span></span> :<br> 第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 行表示选择第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个盒子，第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span> 列表示转移到第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span> 个盒子， 比如：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           A
          </mi>
          <mn>
           23
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         A_{23}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示上一次选择第二个盒子，这次选择第三个盒子的概率为 0.2。<br> 观测概率矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         B
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span></span></span></span></span>：<br> 第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 行表示选择的是第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个盒子，第 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span> 列表示从该盒子取到 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          j
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         j
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span></span></span></span></span> 号球， 比如：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           B
          </mi>
          <mn>
           31
          </mn>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         B_{31}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05017em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 表示从第二个盒子取出球的概率为 0.7。</p> 
  <p><strong>（1) 计算初值 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          t=1
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></strong><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻取出红球，隐状态是盒子1的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.2
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.5
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.10
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{1}(1) = \pi_{1}b_{1o_{1}} = 0.2×0.5=0.10
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94454em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">0</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻取出红球，隐状态是盒子2的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           2
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             2
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.4
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.4
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.16
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{1}(2) = \pi_{2}b_{2o_{1}} = 0.4×0.4=0.16
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94454em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻取出红球，隐状态是盒子3的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           3
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <mn>
            3
           </mn>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             3
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.4
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.7
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.28
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{1}(3) = \pi_{3}b_{3o_{1}} = 0.4×0.7=0.28
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.94454em; vertical-align: -0.2501em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">8</span></span></span></span></span></span><br> <strong>（2) 递推计算 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           =
          </mo>
          <mn>
           2
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          t=2
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span></strong><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          2
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span> 时刻取出白球，隐状态是盒子1的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           ]
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mn>
           0.10
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.5
          </mn>
          <mo>
           +
          </mo>
          <mn>
           0.16
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.3
          </mn>
          <mo>
           +
          </mo>
          <mn>
           0.28
          </mn>
          <mo>
           ∗
          </mo>
          <mn>
           0.2
          </mn>
          <mo>
           )
          </mo>
          <mo>
           ×
          </mo>
          <mn>
           0.5
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.154
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.5
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.077
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{2}(1) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i1}]b_{1o_{2}} = (0.10×0.5+0.16×0.3+0.28*0.2)×0.5=0.154×0.5=0.077
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">5</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">7</span><span class="mord">7</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          2
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span> 时刻取出白球，隐状态是盒子2的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           2
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mn>
             2
            </mn>
           </mrow>
          </msub>
          <mo>
           ]
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             2
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mn>
           0.10
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.2
          </mn>
          <mo>
           +
          </mo>
          <mn>
           0.16
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.5
          </mn>
          <mo>
           +
          </mo>
          <mn>
           0.28
          </mn>
          <mo>
           ∗
          </mo>
          <mn>
           0.3
          </mn>
          <mo>
           )
          </mo>
          <mo>
           ×
          </mo>
          <mn>
           0.6
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.184
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.6
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.1104
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{2}(2) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i2}]b_{2o_{2}} = (0.10×0.2+0.16×0.5+0.28*0.3)×0.6=0.184×0.6=0.1104
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">8</span><span class="mord">4</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mord">4</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          2
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=2
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span> 时刻取出白球，隐状态是盒子3的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           3
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mn>
             3
            </mn>
           </mrow>
          </msub>
          <mo>
           ]
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             3
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mn>
           0.10
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.3
          </mn>
          <mo>
           +
          </mo>
          <mn>
           0.16
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.2
          </mn>
          <mo>
           +
          </mo>
          <mn>
           0.28
          </mn>
          <mo>
           ∗
          </mo>
          <mn>
           0.5
          </mn>
          <mo>
           )
          </mo>
          <mo>
           ×
          </mo>
          <mn>
           0.3
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.202
          </mn>
          <mo>
           ×
          </mo>
          <mn>
           0.3
          </mn>
          <mo>
           =
          </mo>
          <mn>
           0.0606
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{2}(3) = [\sum_{i=1}^3 \alpha_{1}(i)a_{i3}]b_{3o_{2}} = (0.10×0.3+0.16×0.2+0.28*0.5)×0.3=0.202×0.3=0.0606
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">6</span><span class="mord">0</span><span class="mord">6</span></span></span></span></span></span><br> <strong>（3) 递推计算 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           =
          </mo>
          <mn>
           3
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          t=3
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span></span></span></span></span></strong><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          3
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=3
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span></span></span></span></span> 时刻取出红球，隐状态是盒子1的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            3
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           ]
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             1
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.04187
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{3}(1) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i1}]b_{1o_{2}}=0.04187
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">4</span><span class="mord">1</span><span class="mord">8</span><span class="mord">7</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          3
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=3
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span></span></span></span></span> 时刻取出红球，隐状态是盒子2的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            3
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           2
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mn>
             2
            </mn>
           </mrow>
          </msub>
          <mo>
           ]
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             2
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.03551
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{3}(2) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i2}]b_{2o_{2}}=0.03551
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">3</span><span class="mord">5</span><span class="mord">5</span><span class="mord">1</span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          3
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t=3
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">3</span></span></span></span></span> 时刻取出红球，隐状态是盒子2的概率：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            3
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mn>
           3
          </mn>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mo>
           [
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mn>
             3
            </mn>
           </mrow>
          </msub>
          <mo>
           ]
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mn>
             3
            </mn>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0.05284
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_{3}(3) = [\sum_{i=1}^3 \alpha_{2}(i)a_{i3}]b_{3o_{2}}=0.05284
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mord">2</span><span class="mord">8</span><span class="mord">4</span></span></span></span></span></span><br> <strong>（4) 终止</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mn>
            3
           </mn>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mn>
            3
           </mn>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mn>
           0.13022
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          P(O|\lambda) =\sum_{i=1}^3 \alpha_{3}(i)=0.13022
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.07878em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.80111em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">3</span><span class="mord">0</span><span class="mord">2</span><span class="mord">2</span></span></span></span></span></span></p> 
  <h4><a id="413__127"></a>4.1.3 后向算法</h4> 
  <p>其实后向算法和前向算法类似，只不过是从后往前递推。<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114204737496.png" alt=""><br> 后向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          β
         </mi>
         <mi>
          t
         </mi>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta{t}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="mord"><span class="mord mathit">t</span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span> 如下图所示：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114214215567.png#pic_center" alt=""><br> 首先，定义最后时刻的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           β
          </mi>
          <mi>
           T
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta_{T}(i) = 1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>。<br> 然后 ，对于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mi>
          T
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mi>
          T
         </mi>
         <mo>
          −
         </mo>
         <mn>
          2
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t = T-1,T-2,...,1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span></span></span></span></span>，后向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           β
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta_{t}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span> 就等于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span> 时刻的状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           i
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         i_{t} = q_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.80952em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 转移到时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          +
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t+1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 的状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           i
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           q
          </mi>
          <mi>
           j
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         i_{t+1} = q_{j}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.867851em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的概率 <strong>×</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          +
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t+1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           i
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         i_{t+1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.867851em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 对应的观测状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           o
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         o_{t+1}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的概率 <strong>×</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          +
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         t+1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 时刻的后向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           β
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            +
           </mo>
           <mn>
            1
           </mn>
          </mrow>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta_{t+1}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span>。即：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            β
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            n
           </mi>
          </munderover>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             j
            </mi>
            <msub>
             <mi>
              o
             </mi>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            β
           </mi>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             +
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \beta_{t}(i) = \sum_{j=1}^n a_{ij}b_{jo_{t+1}}\beta_{t+1}(i)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.06517em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span></span><br> 如下图所示：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190114213827291.png#pic_center" alt=""><br> 最后，观测概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            i
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           n
          </mi>
         </msubsup>
         <msub>
          <mi>
           π
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </mrow>
         </msub>
         <msub>
          <mi>
           β
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(O|\lambda) = \sum_{i=1}^n \pi_{i}b_{io_{1}}\beta_{1}(i)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.104em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span>。<br> 其实，观测概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(O|\lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span> 还可以这么写：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            n
           </mi>
          </munderover>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            n
           </mi>
          </munderover>
          <msub>
           <mi>
            α
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             j
            </mi>
            <msub>
             <mi>
              o
             </mi>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            β
           </mi>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             +
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           j
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          P(O|\lambda) = \sum_{i=1}^n \sum_{j=1}^n \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.06517em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span></span><br> 是不是其实很好理解。</p> 
  <h4><a id="413__141"></a>4.1.3 一些概率与期望的计算</h4> 
  <p>利用前向概率和后向概率,可以得到关于单个状态和两个状态概率的计算公式。</p> 
  <ol> 
   <li>给定模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span> 和观测 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           O
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          O
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span></span></span></span></span>，在时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          t
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span> 处于状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          q_{i}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的概率。记<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             γ
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            O
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            λ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <msub>
              <mi>
               i
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               q
              </mi>
              <mi>
               i
              </mi>
             </msub>
             <mo separator="true">
              ,
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              λ
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              λ
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
           \gamma_{t}(i) = P(i_{t}=q_{i}|O,\lambda) = \frac{P(i_{t}=q_{i},O|\lambda)}{P(O|\lambda)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05556em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 由前向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            α
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha_t(i)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span> 和后向概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            β
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           i
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \beta_t(i)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span></span> 定义可知:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             α
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
           <msub>
            <mi>
             β
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            O
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            λ
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           \alpha_{t}(i)\beta_t(i) = P(i_{t}=q_{t}|O,\lambda)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span></span><br> 于是得到:<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             γ
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mrow>
             <msub>
              <mi>
               α
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
             <msub>
              <mi>
               β
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              λ
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
           <mo>
            =
           </mo>
           <mfrac>
            <mrow>
             <msub>
              <mi>
               α
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
             <msub>
              <mi>
               β
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                j
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               N
              </mi>
             </munderover>
             <msub>
              <mi>
               α
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
             <msub>
              <mi>
               β
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
           \gamma_{t}(i) = \frac{\alpha_{t}(i)\beta_t(i)}{P(O|\lambda)} = \frac{\alpha_{t}(i)\beta_t(i)}{\sum_{j=1}^N \alpha_{t}(j)\beta_t(j)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05556em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.73405em; vertical-align: -1.30705em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.12877em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30705em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li> 
   <li>给定模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span> 和观测 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           O
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          O
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span></span></span></span></span>，在时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           t
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          t
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span> 处于状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          q_{i}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的概率。同时在时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           +
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          t+1
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69841em; vertical-align: -0.08333em;"></span><span class="mord mathit">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> 处于状态 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            j
           </mi>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          q_{j}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的概率，记<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             ξ
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            O
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            λ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mrow>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <msub>
              <mi>
               i
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               q
              </mi>
              <mi>
               i
              </mi>
             </msub>
             <mo separator="true">
              ,
             </mo>
             <msub>
              <mi>
               i
              </mi>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msub>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               q
              </mi>
              <mi>
               j
              </mi>
             </msub>
             <mo separator="true">
              ,
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              λ
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               N
              </mi>
             </munderover>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                j
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               N
              </mi>
             </munderover>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <msub>
              <mi>
               i
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               q
              </mi>
              <mi>
               i
              </mi>
             </msub>
             <mo separator="true">
              ,
             </mo>
             <msub>
              <mi>
               i
              </mi>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msub>
             <mo>
              =
             </mo>
             <msub>
              <mi>
               q
              </mi>
              <mi>
               j
              </mi>
             </msub>
             <mo separator="true">
              ,
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mi>
              λ
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
           \xi_{t}(i,j) = P(i_{t}=q_{i},i_{t+1}=q_{j}|O,\lambda) = \frac{P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda)}{\sum_{i=1}^N \sum_{j=1}^N P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.867851em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.73405em; vertical-align: -1.30705em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.12877em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30705em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 而<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <mi>
            P
           </mi>
           <mo>
            (
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             i
            </mi>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msub>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi>
            O
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            λ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             α
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo>
            )
           </mo>
           <msub>
            <mi>
             a
            </mi>
            <mrow>
             <mi>
              i
             </mi>
             <mi>
              j
             </mi>
            </mrow>
           </msub>
           <msub>
            <mi>
             b
            </mi>
            <mrow>
             <mi>
              j
             </mi>
             <msub>
              <mi>
               o
              </mi>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msub>
            </mrow>
           </msub>
           <msub>
            <mi>
             β
            </mi>
            <mrow>
             <mi>
              t
             </mi>
             <mo>
              +
             </mo>
             <mn>
              1
             </mn>
            </mrow>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
          </mrow>
          <annotation encoding="application/x-tex">
           P(i_{t}=q_{i},i_{t+1}=q_{j},O|\lambda) = \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.867851em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04177em; vertical-align: -0.291765em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span></span><br> 所以<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
        <math>
         <semantics>
          <mrow>
           <msub>
            <mi>
             ξ
            </mi>
            <mi>
             t
            </mi>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            i
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            j
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <msub>
            <mi>
             q
            </mi>
            <mi>
             j
            </mi>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi>
            O
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            λ
           </mi>
           <mo>
            )
           </mo>
           <mo>
            =
           </mo>
           <mfrac>
            <mrow>
             <msub>
              <mi>
               α
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
             <msub>
              <mi>
               a
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mi>
                j
               </mi>
              </mrow>
             </msub>
             <msub>
              <mi>
               b
              </mi>
              <mrow>
               <mi>
                j
               </mi>
               <msub>
                <mi>
                 o
                </mi>
                <mrow>
                 <mi>
                  t
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
              </mrow>
             </msub>
             <msub>
              <mi>
               β
              </mi>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mrow>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                i
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               N
              </mi>
             </munderover>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                j
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               N
              </mi>
             </munderover>
             <msub>
              <mi>
               α
              </mi>
              <mi>
               t
              </mi>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              i
             </mi>
             <mo>
              )
             </mo>
             <msub>
              <mi>
               a
              </mi>
              <mrow>
               <mi>
                i
               </mi>
               <mi>
                j
               </mi>
              </mrow>
             </msub>
             <msub>
              <mi>
               b
              </mi>
              <mrow>
               <mi>
                j
               </mi>
               <msub>
                <mi>
                 o
                </mi>
                <mrow>
                 <mi>
                  t
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
              </mrow>
             </msub>
             <msub>
              <mi>
               β
              </mi>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                +
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </msub>
             <mo>
              (
             </mo>
             <mi>
              j
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mfrac>
          </mrow>
          <annotation encoding="application/x-tex">
           \xi_{t}(i,j) = q_{j},O|\lambda) = \frac{\alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)}{\sum_{i=1}^N \sum_{j=1}^N \alpha_{t}(i)a_{ij}b_{jo_{t+1}}\beta_{t+1}(j)}
          </annotation>
         </semantics>
        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.73881em; vertical-align: -1.30705em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.43176em;"><span class="" style="top: -2.12877em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.68176em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.05278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30705em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190116085251365.png#pic_center" alt=""></li> 
  </ol> 
  <h3><a id="42__156"></a>4.2 学习算法</h3> 
  <p><strong>目的</strong>：</p> 
  <ol> 
   <li>给定观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           O
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             o
            </mi>
            <mi>
             T
            </mi>
           </msub>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
          O={o_{1},o_{2},...,o_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> 和状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           I
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             i
            </mi>
            <mi>
             T
            </mi>
           </msub>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
          I={i_{1},i_{2},...,i_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，求<em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mi>
           A
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           B
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           π
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda = (A,B,\pi)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span></span></span></span></span> 的三个参数。</li> 
   <li>给定观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           O
          </mi>
          <mo>
           =
          </mo>
          <mrow>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             o
            </mi>
            <mn>
             2
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mi mathvariant="normal">
            .
           </mi>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             o
            </mi>
            <mi>
             T
            </mi>
           </msub>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
          O={o_{1},o_{2},...,o_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，求<em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           λ
          </mi>
          <mo>
           =
          </mo>
          <mo>
           (
          </mo>
          <mi>
           A
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           B
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           π
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \lambda = (A,B,\pi)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span></span></span></span></span> 的三个参数。</li> 
  </ol> 
  <p><strong>解决方法</strong>：</p> 
  <ol> 
   <li>监督算法</li> 
   <li><span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           B
          </mi>
          <mi>
           a
          </mi>
          <mi>
           u
          </mi>
          <mi>
           m
          </mi>
          <mo>
           −
          </mo>
          <mi>
           W
          </mi>
          <mi>
           e
          </mi>
          <mi>
           l
          </mi>
          <mi>
           c
          </mi>
          <mi>
           h
          </mi>
         </mrow>
         <annotation encoding="application/x-tex">
          Baum-Welch
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mord mathit">a</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">W</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">c</span><span class="mord mathit">h</span></span></span></span></span> 算法</li> 
  </ol> 
  <h4><a id="421__164"></a>4.2.1 监督算法</h4> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190116111842544.png" alt=""></p> 
  <blockquote> 
   <p>第二步求观测概率应该是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             j
            </mi>
            <mi>
             k
            </mi>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          b_{jk}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，因为懒，就直接截图了。</p> 
  </blockquote> 
  <h4><a id="422_BaumWelch__168"></a>4.2.2 Baum-Welch 算法</h4> 
  <p><img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190116112624748.png" alt=""></p> 
  <p>现在已经知道的是观测数据 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            T
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{T}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>， 设隐状态数据为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mi>
            T
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         I={i_{1},i_{2},...,i_{T}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，那么完全数据是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          I
         </mi>
         <mo>
          )
         </mo>
         <mo>
          =
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           T
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mi>
           T
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         (O,I)=(o_{1},o_{2},...,o_{T},i_{1},i_{2},...,i_{T})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>。完全数据的对数似然函数是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          o
         </mi>
         <mi>
          g
         </mi>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          I
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         logP(O,I|\lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span>。</p> 
  <p>既然 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          B
         </mi>
         <mi>
          a
         </mi>
         <mi>
          u
         </mi>
         <mi>
          m
         </mi>
         <mo>
          −
         </mo>
         <mi>
          W
         </mi>
         <mi>
          e
         </mi>
         <mi>
          l
         </mi>
         <mi>
          c
         </mi>
         <mi>
          h
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Baum-Welch
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mord mathit">a</span><span class="mord mathit">u</span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">W</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">c</span><span class="mord mathit">h</span></span></span></span></span> 算法使用的就是 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          E
         </mi>
         <mi>
          M
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         EM
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">E</span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span> 算法，那么就要走两个步骤：<br> （1） <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          E
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         E
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">E</span></span></span></span></span> 步<br> 求出联合分布 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          I
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          λ
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(O,I|\lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span></span></span></span></span> 基于条件概率 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <mi>
          I
         </mi>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          O
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mover accent="true">
          <mi>
           λ
          </mi>
          <mo stretchy="true">
           ‾
          </mo>
         </mover>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         (I|O,\overline \lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的期望，其中 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mover accent="true">
          <mi>
           λ
          </mi>
          <mo stretchy="true">
           ‾
          </mo>
         </mover>
        </mrow>
        <annotation encoding="application/x-tex">
         \overline \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.89444em; vertical-align: 0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span></span></span></span></span> 为 <em>HMM</em> 模型参数的当前估计值，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span></span></span></span></span> 为极大化的 <em>HMM</em> 模型参数。<br> （2） <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          M
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         M
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span> 步<br> 最大化这个期望，得到更新的模型参数λ。接着不停的进行EM迭代，直到模型参数的值收敛为止。</p> 
  <p><strong>公式推导</strong>：<br> （1） <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          E
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         E
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">E</span></span></span></span></span> 步：求<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          Q
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Q
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">Q</span></span></span></span></span> 函数<br> 根据 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          E
         </mi>
         <mi>
          M
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         EM
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">E</span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span> 的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          Q
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Q
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">Q</span></span></span></span></span> 函数定义，即这里要求的联合分布的期望为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           Q
          </mi>
          <mo>
           (
          </mo>
          <mi>
           λ
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mfrac>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             I
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             O
            </mi>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          Q(\lambda,\overline \lambda) = \sum_{I}P(I|O,\overline \lambda)lnP(O,I|\lambda) = \sum_{I}lnP(O,I|\lambda)\frac{P(I,O|\overline \lambda)}{P(O,\overline \lambda)}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.34434em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.86578em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.57144em;"><span class="" style="top: -2.21556em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.03444em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <mi>
          O
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mover accent="true">
          <mi>
           λ
          </mi>
          <mo stretchy="true">
           ‾
          </mo>
         </mover>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(O,\overline \lambda)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 表示上次求出的参数与观测数据的联合概率，没有什么影响，所以：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           Q
          </mi>
          <mo>
           (
          </mo>
          <mi>
           λ
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          Q(\lambda,\overline \lambda) = \sum_{I}lnP(O,I|\lambda)P(I,O|\overline \lambda)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.34434em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 而<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mi>
           λ
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            π
           </mi>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               T
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
         </mrow>
         <annotation encoding="application/x-tex">
          P(O,I|\lambda) = \pi_{i_{1}}b_{i_{1}o_{1}}a_{i_{1}i_{2}}b_{i_{2}o_{2}}...a_{i_{T-1}i_{T}}b_{i_{T}o_{T}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord mathit">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.98641em; vertical-align: -0.29197em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202814em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29197em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.250305em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 所以<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           Q
          </mi>
          <mo>
           (
          </mo>
          <mi>
           λ
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           [
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            π
           </mi>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </msub>
          <mo>
           +
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              2
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           +
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo>
           +
          </mo>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               T
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
          <mo>
           +
          </mo>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mn>
              1
             </mn>
            </msub>
           </mrow>
          </msub>
          <mo>
           +
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo>
           +
          </mo>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              T
             </mi>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              T
             </mi>
            </msub>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
          <mo>
           ]
          </mo>
          <mspace linebreak="newline"></mspace>
          <mo>
           =
          </mo>
          <munder>
           <munder>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mi>
               I
              </mi>
             </munder>
             <mi>
              l
             </mi>
             <mi>
              n
             </mi>
             <msub>
              <mi>
               π
              </mi>
              <msub>
               <mi>
                i
               </mi>
               <mn>
                1
               </mn>
              </msub>
             </msub>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              I
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mover accent="true">
              <mi>
               λ
              </mi>
              <mo stretchy="true">
               ‾
              </mo>
             </mover>
             <mo>
              )
             </mo>
            </mrow>
            <mo stretchy="true">
             ⎵
            </mo>
           </munder>
           <mrow>
            <mi mathvariant="normal">
             式
            </mi>
            <mn>
             1
            </mn>
           </mrow>
          </munder>
          <mo>
           +
          </mo>
          <munder>
           <munder>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mi>
               I
              </mi>
             </munder>
             <mo>
              (
             </mo>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mrow>
               <mi>
                T
               </mi>
               <mo>
                −
               </mo>
               <mn>
                1
               </mn>
              </mrow>
             </munderover>
             <mi>
              l
             </mi>
             <mi>
              n
             </mi>
             <msub>
              <mi>
               a
              </mi>
              <mrow>
               <msub>
                <mi>
                 i
                </mi>
                <mi>
                 t
                </mi>
               </msub>
               <msub>
                <mi>
                 i
                </mi>
                <mrow>
                 <mi>
                  t
                 </mi>
                 <mo>
                  +
                 </mo>
                 <mn>
                  1
                 </mn>
                </mrow>
               </msub>
              </mrow>
             </msub>
             <mo>
              )
             </mo>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              I
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mover accent="true">
              <mi>
               λ
              </mi>
              <mo stretchy="true">
               ‾
              </mo>
             </mover>
             <mo>
              )
             </mo>
            </mrow>
            <mo stretchy="true">
             ⎵
            </mo>
           </munder>
           <mrow>
            <mi mathvariant="normal">
             式
            </mi>
            <mn>
             2
            </mn>
           </mrow>
          </munder>
          <mo>
           +
          </mo>
          <munder>
           <munder>
            <mrow>
             <munder>
              <mo>
               ∑
              </mo>
              <mi>
               I
              </mi>
             </munder>
             <mo>
              (
             </mo>
             <munderover>
              <mo>
               ∑
              </mo>
              <mrow>
               <mi>
                t
               </mi>
               <mo>
                =
               </mo>
               <mn>
                1
               </mn>
              </mrow>
              <mi>
               T
              </mi>
             </munderover>
             <mi>
              l
             </mi>
             <mi>
              n
             </mi>
             <msub>
              <mi>
               b
              </mi>
              <mrow>
               <msub>
                <mi>
                 i
                </mi>
                <mi>
                 t
                </mi>
               </msub>
               <msub>
                <mi>
                 o
                </mi>
                <mi>
                 t
                </mi>
               </msub>
              </mrow>
             </msub>
             <mo>
              )
             </mo>
             <mi>
              P
             </mi>
             <mo>
              (
             </mo>
             <mi>
              I
             </mi>
             <mo separator="true">
              ,
             </mo>
             <mi>
              O
             </mi>
             <mi mathvariant="normal">
              ∣
             </mi>
             <mover accent="true">
              <mi>
               λ
              </mi>
              <mo stretchy="true">
               ‾
              </mo>
             </mover>
             <mo>
              )
             </mo>
            </mrow>
            <mo stretchy="true">
             ⎵
            </mo>
           </munder>
           <mrow>
            <mi mathvariant="normal">
             式
            </mi>
            <mn>
             3
            </mn>
           </mrow>
          </munder>
         </mrow>
         <annotation encoding="application/x-tex">
          Q(\lambda,\overline \lambda) = \sum_{I}P(I,O|\overline \lambda) [ln \pi_{i_{1}} + ln(a_{i_{1}i_{2}}+...+a_{i_{T-1}i_{T}} + ln(b_{i_{1}o_{1}}+...+b_{i_{T}o_{T}}))] \\ = \underbrace{ \sum_{I} ln \pi_{i_{1}} P(I,O|\overline \lambda)}_{式1} + \underbrace{ \sum_{I} (\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(I,O|\overline \lambda)}_{式2} + \underbrace{ \sum_{I} (\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\overline \lambda)}_{式3}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.34434em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">[</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.0001em; vertical-align: -0.2501em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.8753em; vertical-align: -0.29197em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202814em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29197em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.0001em; vertical-align: -0.2501em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.0003em; vertical-align: -0.250305em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.250305em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.64345em; vertical-align: -2.59344em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -0.456561em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">式</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="svg-align" style="top: -1.10767em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice">
                     <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                    </svg></span><span class="brace-center" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice">
                     <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                    </svg></span><span class="brace-right" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice">
                     <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                    </svg></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05001em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.94234em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.59344em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 4.42178em; vertical-align: -2.59344em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.23489em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">式</span><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.82834em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="svg-align" style="top: -1.886em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice">
                     <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                    </svg></span><span class="brace-center" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice">
                     <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                    </svg></span><span class="brace-right" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice">
                     <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                    </svg></span></span></span><span class="" style="top: -3.82834em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.94234em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.59344em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 4.42178em; vertical-align: -2.59344em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.23489em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">式</span><span class="mord mtight">3</span></span></span></span><span class="" style="top: -3.82834em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="svg-align" style="top: -1.886em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="stretchy" style="height: 0.548em; min-width: 1.6em;"><span class="brace-left" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice">
                     <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                    </svg></span><span class="brace-center" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice">
                     <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                    </svg></span><span class="brace-right" style="height: 0.548em;">
                    <svg width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice">
                     <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                    </svg></span></span></span><span class="" style="top: -3.82834em;"><span class="pstrut" style="height: 3.82834em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.94234em;"><span class=""></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.59344em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
  <p>（2） <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          M
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         M
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.10903em;">M</span></span></span></span></span> 步：极大化 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          Q
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         Q
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">Q</span></span></span></span></span>，求模型参数 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          A
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          B
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          π
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         A,B,\pi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span></span></span></span></span><br> 　1）求 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           π
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：<br> 　既然是求极值，肯定是要求导了。对于 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           π
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 来说，满足约束条件 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            t
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           N
          </mi>
         </msubsup>
         <msub>
          <mi>
           π
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \sum_{t=1}^N \pi_{i}=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.28094em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>。现在就变成了带约束条件的求极值，直接上拉格朗日乘子法。<br> 　式 <em>1</em> 可以写成：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            π
           </mi>
           <msub>
            <mi>
             i
            </mi>
            <mn>
             1
            </mn>
           </msub>
          </msub>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \sum_{I} ln \pi_{i_{1}} P(I,O|\overline \lambda) = \sum_{i=1}^N ln \pi_{i} P(O,i_{1}=q_{i}|\overline \lambda)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.34434em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 　拉格朗日函数：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           L
          </mi>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           γ
          </mi>
          <mo>
           (
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           −
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          L = \sum_{i=1}^N ln \pi_{i}P(O,i_{1}=q_{i}|\overline \lambda) + \gamma(\sum_{i=1}^N \pi_{i}-1)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit">L</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;"></span><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></span><br> 　首先把求和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          ∑
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \sum
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00001em; vertical-align: -0.25001em;"></span><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span></span></span></span></span> 去掉，只对单个的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           π
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \pi_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 求偏导并等于 <em>0</em>：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             L
            </mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <msub>
             <mi>
              π
             </mi>
             <mi>
              i
             </mi>
            </msub>
           </mrow>
          </mfrac>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
           <msub>
            <mi>
             π
            </mi>
            <mi>
             i
            </mi>
           </msub>
          </mfrac>
          <mo>
           +
          </mo>
          <mi>
           γ
          </mi>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \frac{\partial L}{\partial \pi_{i}} = \frac{P(O,i_{1}=q_{i}|\overline \lambda)}{\pi_{i}} + \gamma = 0
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.20744em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.40744em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.57144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span></span><br> 　等价于：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mfrac>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <mi>
             L
            </mi>
           </mrow>
           <mrow>
            <mi mathvariant="normal">
             ∂
            </mi>
            <msub>
             <mi>
              π
             </mi>
             <mi>
              i
             </mi>
            </msub>
           </mrow>
          </mfrac>
          <mo>
           =
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           γ
          </mi>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mn>
           0
          </mn>
         </mrow>
         <annotation encoding="application/x-tex">
          \frac{\partial L}{\partial \pi_{i}} =P(O,i_{1}=q_{i}|\overline \lambda) + \gamma \pi_{i} = 0
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.20744em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathit">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span></span><br> 　然后再添上对 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 的求和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          ∑
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \sum
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00001em; vertical-align: -0.25001em;"></span><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span></span></span></span></span>，可得到：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           γ
          </mi>
          <mo>
           =
          </mo>
          <mo>
           −
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \gamma = -P(O|\overline \lambda)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.14444em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 　带入到第三项公式，可得：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            π
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          \pi_{i} = \frac{P(O,i_{1}=q_{i}|\overline \lambda)}{P(O|\overline \lambda)}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.60588em; vertical-align: -1.03444em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.57144em;"><span class="" style="top: -2.21556em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.03444em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
  <p>2）求 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           a
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         a_{ij}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：<br> 　式 <em>2</em> 可以写成：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mo>
           (
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mrow>
            <mi>
             T
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </munderover>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              t
             </mi>
            </msub>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           I
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mrow>
            <mi>
             T
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </munderover>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             +
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            j
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \sum_{I} (\sum_{t=1}^{T-1} ln a_{i_{t}i_{t+1}}) P(O,I|\overline \lambda) = \sum_{i=1}^N \sum_{j=1}^N \sum_{t=1}^{T-1} ln a_{ij} P(O,i_{t}=q_{i},i_{t+1}=q_{j}|\overline \lambda)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.12267em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.202521em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.291765em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.867851em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.18055em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 　同样有约束条件 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            j
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           N
          </mi>
         </msubsup>
         <msub>
          <mi>
           a
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \sum_{j=1}^Na_{ij}=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.41705em; vertical-align: -0.435818em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，最后可以得到：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            a
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <munderover>
             <mo>
              ∑
             </mo>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               =
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mrow>
              <mi>
               T
              </mi>
              <mo>
               −
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </munderover>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mn>
              1
             </mn>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               +
              </mo>
              <mn>
               1
              </mn>
             </mrow>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              j
             </mi>
            </msub>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              t
             </mi>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          a_{ij} = \frac{\sum_{t=1}^{T-1} P(O,i_{1}=q_{i},i_{t+1}=q_{j}|\overline \lambda)}{P(O,i_{t}=q_{i}|\overline \lambda)}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.70538em; vertical-align: -1.03444em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.67094em;"><span class="" style="top: -2.21556em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.68971em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.03444em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 　3）求 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            j
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         b_{ij}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>：<br> 　式 <em>3</em> 可以写成：<br> 　　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            I
           </mi>
          </munder>
          <mo>
           (
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            T
           </mi>
          </munderover>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              t
             </mi>
            </msub>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              t
             </mi>
            </msub>
           </mrow>
          </msub>
          <mo>
           )
          </mo>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           I
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           O
          </mi>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             j
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            N
           </mi>
          </munderover>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             t
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mrow>
            <mi>
             T
            </mi>
            <mo>
             −
            </mo>
            <mn>
             1
            </mn>
           </mrow>
          </munderover>
          <mi>
           l
          </mi>
          <mi>
           n
          </mi>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             j
            </mi>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              t
             </mi>
            </msub>
           </mrow>
          </msub>
          <mi>
           P
          </mi>
          <mo>
           (
          </mo>
          <mi>
           O
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            i
           </mi>
           <mi>
            t
           </mi>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi>
            q
           </mi>
           <mi>
            j
           </mi>
          </msub>
          <mi mathvariant="normal">
           ∣
          </mi>
          <mover accent="true">
           <mi>
            λ
           </mi>
           <mo stretchy="true">
            ‾
           </mo>
          </mover>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \sum_{I} (\sum_{t=1}^{T} ln b_{i_{t}o_{t}}) P(I,O|\overline \lambda) = \sum_{j=1}^N \sum_{t=1}^{T-1} lnb_{jo_{t}}P(O,i_{t}=q_{j}|\overline \lambda)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.12267em; vertical-align: -1.29434em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.85566em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.07847em;">I</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.29434em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2501em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.24211em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.18055em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 　同样有约束条件 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msubsup>
          <mo>
           ∑
          </mo>
          <mrow>
           <mi>
            k
           </mi>
           <mo>
            =
           </mo>
           <mn>
            1
           </mn>
          </mrow>
          <mi>
           M
          </mi>
         </msubsup>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            j
           </mi>
           <mi>
            k
           </mi>
          </mrow>
         </msub>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         \sum_{k=1}^M b_{jk}=1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.28094em; vertical-align: -0.29971em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，要注意的是只有在 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           v
          </mi>
          <mi>
           k
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         o_{t}=v_{k}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 时 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            j
           </mi>
           <msub>
            <mi>
             o
            </mi>
            <mi>
             t
            </mi>
           </msub>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         b_{jo_{t}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mtight"><span class="mord mathit mtight">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.296343em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 对 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           b
          </mi>
          <mrow>
           <mi>
            j
           </mi>
           <mi>
            k
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         b_{jk}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 的偏导数才不为 <em>0</em>，以 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           o
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          =
         </mo>
         <msub>
          <mi>
           v
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         I(o_{t}=v_{k})
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 表示，最后可以得到：<br> 　<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi>
            b
           </mi>
           <mrow>
            <mi>
             j
            </mi>
            <mi>
             k
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <munderover>
             <mo>
              ∑
             </mo>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               =
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mi>
              T
             </mi>
            </munderover>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              t
             </mi>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              j
             </mi>
            </msub>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
            <mi>
             I
            </mi>
            <mo>
             (
            </mo>
            <msub>
             <mi>
              o
             </mi>
             <mi>
              t
             </mi>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              v
             </mi>
             <mi>
              k
             </mi>
            </msub>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <munderover>
             <mo>
              ∑
             </mo>
             <mrow>
              <mi>
               t
              </mi>
              <mo>
               =
              </mo>
              <mn>
               1
              </mn>
             </mrow>
             <mi>
              T
             </mi>
            </munderover>
            <mi>
             P
            </mi>
            <mo>
             (
            </mo>
            <mi>
             O
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msub>
             <mi>
              i
             </mi>
             <mi>
              t
             </mi>
            </msub>
            <mo>
             =
            </mo>
            <msub>
             <mi>
              q
             </mi>
             <mi>
              j
             </mi>
            </msub>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mover accent="true">
             <mi>
              λ
             </mi>
             <mo stretchy="true">
              ‾
             </mo>
            </mover>
            <mo>
             )
            </mo>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          b_{jk} = \frac{\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\overline \lambda) I(o_{t}=v_{k})}{\sum_{t=1}^{T} P(O,i_{t}=q_{j}|\overline \lambda)}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.84188em; vertical-align: -1.17094em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.67094em;"><span class="" style="top: -2.12877em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.68971em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.89444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathit">λ</span></span><span class="" style="top: -3.81444em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.17094em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
  <p><strong>参数估计公式</strong>：<br> 得到参数后，可以用 <strong>4.1.3</strong> 节的 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           γ
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           ξ
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          (
         </mo>
         <mi>
          i
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          j
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \gamma_{t}(i),\xi_{t}(i,j)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.05556em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.04601em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span> 表示：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/2019011710433021.png#pic_center" alt=""><br> <strong>算法总结</strong>：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190117104417852.png" alt=""></p> 
  <h3><a id="43__223"></a>4.3 预测算法</h3> 
  <p><strong>目的</strong>：给定 <em>HMM</em> 模型 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          λ
         </mi>
         <mo>
          =
         </mo>
         <mo>
          (
         </mo>
         <mi>
          A
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          B
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          π
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda = (A,B,\pi)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">λ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">π</span><span class="mclose">)</span></span></span></span></span> 和观测序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          O
         </mi>
         <mo>
          =
         </mo>
         <mrow>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            1
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mn>
            2
           </mn>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            o
           </mi>
           <mi>
            T
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         O={o_{1},o_{2},...,o_{T}}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，求在该观测序列下，最可能对应的状态序列 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           I
          </mi>
          <mo>
           ∗
          </mo>
         </msup>
         <mo>
          =
         </mo>
         <mrow>
          <msubsup>
           <mi>
            i
           </mi>
           <mn>
            1
           </mn>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            i
           </mi>
           <mn>
            2
           </mn>
           <mo>
            ∗
           </mo>
          </msubsup>
          <mo separator="true">
           ,
          </mo>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mi mathvariant="normal">
           .
          </mi>
          <mo separator="true">
           ,
          </mo>
          <msubsup>
           <mi>
            i
           </mi>
           <mi>
            T
           </mi>
           <mo>
            ∗
           </mo>
          </msubsup>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         I^*={i_{1}^*,i_{2}^*,...,i_{T}^*}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.964027em; vertical-align: -0.275331em;"></span><span class="mord"><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.275331em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，也就是最大化 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          P
         </mi>
         <mo>
          (
         </mo>
         <msup>
          <mi>
           I
          </mi>
          <mo>
           ∗
          </mo>
         </msup>
         <mi mathvariant="normal">
          ∣
         </mi>
         <mi>
          O
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         P(I^*|O)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit" style="margin-right: 0.02778em;">O</span><span class="mclose">)</span></span></span></span></span>。<br> <strong>解决</strong>：<em>Viterbi</em> 算法。<br> 其实维特比算法就用动态规划的方法求概率最大路径，计算过程中的每条路径都对应着一个状态序列。计算过程中将最优路径经过的点都保存下来。得到最优路径后，由后向前逐步求得最优结点，这就是维特比算法。<br> <strong>过程</strong>：<br> 因为计算过程很简单，就直接给出书中的截图了。<br> 首先导入两个变量 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          δ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \delta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.03785em;">δ</span></span></span></span></span>和 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          ψ
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \psi
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">ψ</span></span></span></span></span>。定义在时刻 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          t
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         t
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord mathit">t</span></span></span></span></span> 状态为 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 的所有单个路径 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           i
          </mi>
          <mi>
           t
          </mi>
         </msub>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         (i_{1} ,i_{2},...,i_{t} )
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 中概率最大值为：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/2019011811111272.png" alt=""><br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190118111333512.png" alt=""><br> 过程是不是很好理解？如果还不好理解，就继续看个例子。<br> <strong>例子</strong>：<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190118111421638.png" alt=""><br> 整个计算过程如下图所示，<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190118111525284.png" alt=""><br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190118143020410.png" alt=""><br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190118143035402.png" alt=""></p> 
  <h2><a id="Reference_240"></a>Reference</h2> 
  <p>统计学习方法 李航</p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
