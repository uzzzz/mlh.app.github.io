<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>使用部分异常观测数据进行异常检测（翻译自 Anomaly Detection with Partially Observed Anomalies） | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="使用部分异常观测数据进行异常检测（翻译自 Anomaly Detection with Partially Observed Anomalies）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="导语：这篇文章是蚂蚁金服2018年在WWW大会上投中的一篇paper，介绍如果使用少量标注的异常样本进行模型训练，也就是常说的半监督模型，刚好最近在做这个方面的内容，将其翻译过来备查。 摘要 本文研究了异常检测问题。以往的研究大多依据是否有标签来使用有监督或无监督方法， 可用。但是，总是存在一些不同于这两种标准模式的场景。本文中，我们处理了存在部分观测异常的场景，即我们拥有大量未标记的样本和一些少量人工标注的异常。我们将此问题称为存在部分异常观测下的异常检测，并提出两阶段法–ADOA来解决它。首先，通过处理异常之间的差异，而对未标记的数据进行筛选，以获得潜在的异常和可靠的正常数据。然后，利用上述数据，根据每个标签的置信度，给每个点附加一个权重，并建立一个加权的多类模型，该模型将进一步用于区分不同于正常数据的异常。实验结果表明，在上述条件下，现有方法的性能不理想，本文的方法性能明显优于上述方法，证明了该方法的有效性。 关键词 异常检测，观测异常，两步法 1. 引言 异常检测是一种广泛使用的技术，旨在从数据集中正常的行为识别出不正常的模式（patterns）。这些不正常的模式通常被称为异常或异常值，它们是由某种恶意目的或非法活动导致的。异常检测在入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动检测等各种应用中具有重要的意义和关键的帮助。 为了解决这一问题，近年来机器学习技术得到了广泛的应用，这些技术大致可以分为两类:基于非监督学习的方法和基于监督学习的方法。一般的，基于无监督学习的方法发展较快，它的训练数据不需要标签。例如，基于距离的方法、基于密度的方法和基于隔离的方法都是这一方法的典型代表。 另一方面，如果有足够的标注数据，则基于监督学习的方法，如训练支持向量机、决策树、k近邻等分类模型对不可见样本能进行进一步的分类。注意到，与非监督方法相比，监督方法总是能够在有足够标记数据的帮助下提供更好的性能。此外，本文利用标记数据和非标记数据，探索了基于半监督学习的方法，并结合不同的技术，开发了复合算法来处理这个问题。 然而，在某些情况下，异常样本的获取是困难的，我们在能再打来未标记的样本中获取少量的异常。让我们以恶意URL检测任务为例，在某些场景中，除了大量未标记的URL记录之外，我们只能在现有基于规则的系统的帮助下获得少量标记的恶意URL。与同时提供正样本和负样本的监督设置不同，我们在这里得到的只是一小部分正(恶意)样本，因此不能直接使用监督方法。另一方面，与无监督学习环境相比，我们还增加了一些带标签的（负）样本，如何合理利用这些负样本多模型很有帮组。在本文中，我们将这种特殊的异常检测设置称为部分观测异常的异常检测。 已经存在一种学习模式叫做PU (Positive and unlabel)算法，它的做法与前面提到的模式类似。然而，在PU学习中，正样本总是属于一个中心，这意味着正样本之间是相似的，而在异常检测中，正样本之间通常是不相似的，且可能存在严重的差异性。换句话说，我们不能直接假设说，两个异常之间的差异一定是小于正常样本和异常样本直接的差异的。因此，直接应用基于PU学习的异常检测技术可能无法获得满意的性能 另外还有一种半监督聚类的方法，处理那些部分标注的数据或者有先验信息的数据，其目标是将未标记的样本聚类到合适的类。似乎半监督学习处理的任务与我们描述的类似。然而，就像PU学习一样，在半监督聚类中，标记在同一个聚类中的样本应该是相似的，而在异常检测中，观测到的异常并不符合这一点。 本文考虑了部分观测异常异常检测的设置问题，提出了一种基于部分观测异常的异常检测方法ADOA来解决这一问题。ADOA算法有两个阶段。 step1： 我们认为异常数据不应简单地看成一个中心，假设异常属于k个不同的中心，首先将异常聚类为k个中心。然后根据孤立度和与最近异常类中心的相似性，从未标记的样本中选取潜在异常和可靠正样本。 step2：依据所附标签的置信度，对各个点进行赋权，然后，利用原始异常样本和所选的样本，建立加权的多分类模型，将异常与正常样本区分开来。 本文在不同数据集和实际应用任务上的实验中证明了该方法的有效性。 本文的其余部分组织如下。在第2节中，我们回顾了相关工作。在第3节中，我们陈述了问题的设定，并提出了所提出的方法。在第4节中，我们报告了在不同数据集上的实验结果。在第5节中，我们将该方法应用于恶意URL检测问题，并验证了该方法的有效性。最后，我们在第六部分对本文进行了总结。 2. 具体工作 异常检测用于处理从正常行为中识别意外模式的任务。异常的检测具有重要的影响，可以在许多不同的领域提供关键的帮助。在实际应用中，针对问题提出了许多基于机器学习的方法，并被广泛应用于入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动活动检测等诸多应用中。 在已有的方法中，基于无监督学习的方法使用无标记数据构建模型。举几个具有代表性的例子，基于距离的方法，基于密度的方法，基于隔离的方法，等等。这些方法可以广泛使用，因为不需要对数据进行标记。然而，在许多应用领域，非监督方法可能无法达到要求的性能。 另一方面，在提供标注数据的情况下，探索了基于监督学习的方法。先后采用支持向量机、决策树、k近邻等多种监督算法进行异常检测。适当利用标签信息，基于监督学习的方法总能取得更好的效果。除了这两种标准范式之外，基于半监督学习方和混合方法等其他方法也在这些技术的基础上进行了研究。 有些情况下，只有正常的样本数据，异常数据无法获取，这种情况下 one-class learning ，SVM 可应用于这种情形，这些方法主要是通过学习超球面来描述正态样本，或者通过学习超平面来最大限度地从原点分割数据点。 PU算法是半监督学习里面的一个特例，它主要用来解决当只有正样本和未标注的样本的数据的时候。过去几年，里，非常多的方法被提出来用以解决这种问题，大致来说，可以分为三类，两步法尝试从未标记的数据中识别出一些可靠的负样本，然后应用传统的监督学习或半监督学习技术。代价敏感学习技术用于不相等误分类代价的二元分类，也可以很容易地用于处理这个问题。针对这一问题，还提出了凸方法。注意，如果我们在这里将异常视为正样本，那么PU学习与部分观测异常的异常检测（ADOA）有些相似。然而,最显著的区别是,正样本在PU学习彼此相似，因此我们可以只找到一个中心，在异常检测，异常总是多样化,他们很少能将其只看做一类，使标准PU学习技术不适合处理异常检测的任务。 3. 部分异常观测的异常检测 这一章中，我们先描述我们的问题，然后描述我们的的方法（ADOA） 3.1 问题描述和符号标记 X = R d X = R^d X=Rd描述的是数据属于实数空间， y = { − 1 , + 1 } y=\{-1,+1\} y={−1,+1} 描述的是标签的范围，其中y=+1指的是异常，-1位正常样本，假设有m个训练样本 D = { ( x 1 , y 1 ) , . . . ( x l , y l ) , . . . ( x m , y m ) } D=\{(x_1,y_1),...(x_l,y_l),...(x_m,y_m)\} D={(x1​,y1​),...(xl​,yl​),...(xm​,ym​)}，其中 x i ∈ X x_i \in X xi​∈X，前 l l l个样本的标记是异常，另外 m − l m-l m−l个样本为未标记样本，尽管前 l l l个样本已经标记为异常，但是他们直接还是不同的。目标是建立模型： f : X → Y f:X \rightarrow Y f:X→Y，从而进一步利用该方法对未来数据进行各种异常与正常的识别。 3.2 本文的方法 ADOA 安装如下两步来进行： step1：对于已经标注异常的数据，我们将其分为不同的类，所以这样不同的类里面他们的特征就比较近似，对于未标注的数据，我们的目标是充分挖掘他的价值。所以我们尝试将其分为潜在的异常数据和可靠的正常数据，区分的条件就是isolation score和他们的similarity score。直接原因是这样：一方面，潜在的异常应该和正常样本不一样，另一方法，他们应该可以已观测到的异常近似。 step2：建立一个加权多分类模型，对于已经标注的异常，赋权为1，对于过滤出来的数据，其权重依据它所带的标签的置信度。 下面是数学描述： stage1：我们将观测的异常 D l D^l Dl分为k个中心 C = { C 1 , C 2 , . . . , C k } C=\{ C_1,C_2,...,C_k \} C={C1​,C2​,...,Ck​}，我们可以使用不同的聚类方法，这里只是简单的使用了k-means方法（需要先标准化数据），特别的，两个样本之间的距离直接使用了欧式距离 d i s t ( x i , x i ′ ) = ∑ i = 1 n ( x i j − x i ′ j ) 2 dist(x_i,x_{i&amp;#x27;})=\sum _{i=1}^n (x_{ij}-x_{i&amp;#x27;j})^2 dist(xi​,xi′​)=i=1∑n​(xij​−xi′j​)2 Isolation score 的计算：孤立的概念第一次被提出来。他们展示随机树林可以用来分离样本，森林里的每棵决策树都使用随机的特征来分割子样本，并不断的分裂节点，知道无法再分割样本。由于异常样本很少，他们总是很贴近于树的根节点，且正常的样本会处于树中比较深的节点。为了计算isolation score，每个样本被送到一颗树的叶子节点上，则可以获得节点的深度，然后计算样本的平均深度。通过计算样本在树中的平均深度，可以认为是样本为异常的概率 I S ( x ) IS(x) IS(x)，使 h ( x ) h(x) h(x)表示样本x的平均深度， E ( h ( x ) ) E(h(x)) E(h(x))表示样本在所有孤立树中的平均深度，假设我们有n个样本，则使 c ( n ) = 2 H ( n ) − ( 2 ( n − 1 ) / n ) c(n) = 2H(n) -(2(n-1)/n) c(n)=2H(n)−(2(n−1)/n) 表示为二进制搜索树中的平均深度，其中 H ( n ) H(n) H(n)是指定参数，可以是 l n ( n ) + 0.5772156649 ( E u l e r 常 数 ） ln(n)+0.5772156649(Euler 常数） ln(n)+0.5772156649(Euler常数）， c ( n ) c(n) c(n)是用来规范化IS的： I S ( x ) = 2 − E ( h ( x ) ) c ( n ) IS(x) = 2^{-\frac{E(h(x))}{c(n)}} IS(x)=2−c(n)E(h(x))​ 则 I S ( x ) IS(x) IS(x)的分数越高（越接近1），样本x就越有可能是异常。 Similarity score 的计算：另一方面，一个样本如果越靠近异常的中心，则它越有可能是潜在的异常，所以我们可以计算样本x和他相近的异常中心的相似分 S S ( x ) SS(x) SS(x)，其计算公式如下： S S ( x ) = max ⁡ i = 1 k e − ( x − u i ) 2 SS(x) = \max_{i=1}^k e^{-(x-u_i)^2} SS(x)=i=1maxk​e−(x−ui​)2 其中， u i u_i ui​是第i个异常的中心，k是总的异常中心的个数。 Total score 的计算：为了从未标注的样本中区分潜在的异常和正常样本，我们同时考虑Isolation score和Similarity score，总的得分计算： T S ( x ) = θ I S ( x ) + ( 1 − θ ) S S ( x ) TS(x) = \theta IS(x) + (1-\theta)SS(x) TS(x)=θIS(x)+(1−θ)SS(x) 其中， θ ∈ [ 0 , 1 ] \theta \in [0,1] θ∈[0,1]，用于平衡两种分数的重要程度。 令 α = 1 l ∑ i = 1 l T S ( x i ) \alpha = \frac{1}{l} \sum_{i=1}^l TS(x_i) α=l1​i=1∑l​TS(xi​) 表示异常的平均分数，所以我们选择 T S ( x ) ≥ α TS(x) \geq \alpha TS(x)≥α作为潜在的异常样本，并把它们放到最近的异常中心中。我们选择 T S ( x ) ≤ β TS(x) \leq \beta TS(x)≤β作为可靠的正常样本，其中 β \beta β是预定义的参数， β \beta β越小，选择的样本为正常的可能性就越大。 至此，我们不仅有了可以观测的异常，潜在的异常和可靠的正常样本，且异常被分到了k个类中。 然后，我们为所有的样本赋权，其中，所有标注的异常的权重直接为1，其他的样本中， T S ( x ) TS(x) TS(x)分越高，则权重越大，对于潜在的异常样本，计算公式为： w ( x ) = T S ( x ) m a x x T S ( x ) w(x) = \frac{TS(x)}{max_x{TS(x)}} w(x)=maxx​TS(x)TS(x)​ 对于可靠的正常样本，越小的 T S ( x ) TS(x) TS(x)分，则权重需要越高： w ( x ) = m a x x T S ( x ) − T S ( x ) m a x x T S ( x ) − m i n x T S ( x ) w(x) = \frac{max_x{TS(x)} - TS(x)}{max_x{TS(x)} -min_x{TS(x)} } w(x)=maxx​TS(x)−minx​TS(x)maxx​TS(x)−TS(x)​ 通过上述的样本和他们对应的权重，可以构建一个K+1的分类模型用来从正常样本中区分不同的异常。则我们的目标是最小化如下方程： ∑ i w i l ( y i , f ( x i ) ) + λ R ( w ) \sum_{i} w_il(y_i,f(x_i))+ \lambda R(w) i∑​wi​l(yi​,f(xi​))+λR(w) 其中 w i w_i wi​是指样本 x i x_i xi​的权重， l ( y i , f ( x i ) ) l(y_i,f(x_i)) l(yi​,f(xi​))是损失函数， R ( w ) R(w) R(w)是正则项，这篇文章中使用的是SVM，所以使用的是L2正则。 在构建完多分类模型后，新来的样本就可以进行分类了。当应用模型在无法观测的样本上时，不管新的样本属于哪个异常类别，都将其作为异常看待。 实验（略） 大致描述了几种不同方法在不同数据集上的效果，直接贴些图。 实验的数据集规模 第一个数据集的异常分布情况 不同方法的对比效果图" />
<meta property="og:description" content="导语：这篇文章是蚂蚁金服2018年在WWW大会上投中的一篇paper，介绍如果使用少量标注的异常样本进行模型训练，也就是常说的半监督模型，刚好最近在做这个方面的内容，将其翻译过来备查。 摘要 本文研究了异常检测问题。以往的研究大多依据是否有标签来使用有监督或无监督方法， 可用。但是，总是存在一些不同于这两种标准模式的场景。本文中，我们处理了存在部分观测异常的场景，即我们拥有大量未标记的样本和一些少量人工标注的异常。我们将此问题称为存在部分异常观测下的异常检测，并提出两阶段法–ADOA来解决它。首先，通过处理异常之间的差异，而对未标记的数据进行筛选，以获得潜在的异常和可靠的正常数据。然后，利用上述数据，根据每个标签的置信度，给每个点附加一个权重，并建立一个加权的多类模型，该模型将进一步用于区分不同于正常数据的异常。实验结果表明，在上述条件下，现有方法的性能不理想，本文的方法性能明显优于上述方法，证明了该方法的有效性。 关键词 异常检测，观测异常，两步法 1. 引言 异常检测是一种广泛使用的技术，旨在从数据集中正常的行为识别出不正常的模式（patterns）。这些不正常的模式通常被称为异常或异常值，它们是由某种恶意目的或非法活动导致的。异常检测在入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动检测等各种应用中具有重要的意义和关键的帮助。 为了解决这一问题，近年来机器学习技术得到了广泛的应用，这些技术大致可以分为两类:基于非监督学习的方法和基于监督学习的方法。一般的，基于无监督学习的方法发展较快，它的训练数据不需要标签。例如，基于距离的方法、基于密度的方法和基于隔离的方法都是这一方法的典型代表。 另一方面，如果有足够的标注数据，则基于监督学习的方法，如训练支持向量机、决策树、k近邻等分类模型对不可见样本能进行进一步的分类。注意到，与非监督方法相比，监督方法总是能够在有足够标记数据的帮助下提供更好的性能。此外，本文利用标记数据和非标记数据，探索了基于半监督学习的方法，并结合不同的技术，开发了复合算法来处理这个问题。 然而，在某些情况下，异常样本的获取是困难的，我们在能再打来未标记的样本中获取少量的异常。让我们以恶意URL检测任务为例，在某些场景中，除了大量未标记的URL记录之外，我们只能在现有基于规则的系统的帮助下获得少量标记的恶意URL。与同时提供正样本和负样本的监督设置不同，我们在这里得到的只是一小部分正(恶意)样本，因此不能直接使用监督方法。另一方面，与无监督学习环境相比，我们还增加了一些带标签的（负）样本，如何合理利用这些负样本多模型很有帮组。在本文中，我们将这种特殊的异常检测设置称为部分观测异常的异常检测。 已经存在一种学习模式叫做PU (Positive and unlabel)算法，它的做法与前面提到的模式类似。然而，在PU学习中，正样本总是属于一个中心，这意味着正样本之间是相似的，而在异常检测中，正样本之间通常是不相似的，且可能存在严重的差异性。换句话说，我们不能直接假设说，两个异常之间的差异一定是小于正常样本和异常样本直接的差异的。因此，直接应用基于PU学习的异常检测技术可能无法获得满意的性能 另外还有一种半监督聚类的方法，处理那些部分标注的数据或者有先验信息的数据，其目标是将未标记的样本聚类到合适的类。似乎半监督学习处理的任务与我们描述的类似。然而，就像PU学习一样，在半监督聚类中，标记在同一个聚类中的样本应该是相似的，而在异常检测中，观测到的异常并不符合这一点。 本文考虑了部分观测异常异常检测的设置问题，提出了一种基于部分观测异常的异常检测方法ADOA来解决这一问题。ADOA算法有两个阶段。 step1： 我们认为异常数据不应简单地看成一个中心，假设异常属于k个不同的中心，首先将异常聚类为k个中心。然后根据孤立度和与最近异常类中心的相似性，从未标记的样本中选取潜在异常和可靠正样本。 step2：依据所附标签的置信度，对各个点进行赋权，然后，利用原始异常样本和所选的样本，建立加权的多分类模型，将异常与正常样本区分开来。 本文在不同数据集和实际应用任务上的实验中证明了该方法的有效性。 本文的其余部分组织如下。在第2节中，我们回顾了相关工作。在第3节中，我们陈述了问题的设定，并提出了所提出的方法。在第4节中，我们报告了在不同数据集上的实验结果。在第5节中，我们将该方法应用于恶意URL检测问题，并验证了该方法的有效性。最后，我们在第六部分对本文进行了总结。 2. 具体工作 异常检测用于处理从正常行为中识别意外模式的任务。异常的检测具有重要的影响，可以在许多不同的领域提供关键的帮助。在实际应用中，针对问题提出了许多基于机器学习的方法，并被广泛应用于入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动活动检测等诸多应用中。 在已有的方法中，基于无监督学习的方法使用无标记数据构建模型。举几个具有代表性的例子，基于距离的方法，基于密度的方法，基于隔离的方法，等等。这些方法可以广泛使用，因为不需要对数据进行标记。然而，在许多应用领域，非监督方法可能无法达到要求的性能。 另一方面，在提供标注数据的情况下，探索了基于监督学习的方法。先后采用支持向量机、决策树、k近邻等多种监督算法进行异常检测。适当利用标签信息，基于监督学习的方法总能取得更好的效果。除了这两种标准范式之外，基于半监督学习方和混合方法等其他方法也在这些技术的基础上进行了研究。 有些情况下，只有正常的样本数据，异常数据无法获取，这种情况下 one-class learning ，SVM 可应用于这种情形，这些方法主要是通过学习超球面来描述正态样本，或者通过学习超平面来最大限度地从原点分割数据点。 PU算法是半监督学习里面的一个特例，它主要用来解决当只有正样本和未标注的样本的数据的时候。过去几年，里，非常多的方法被提出来用以解决这种问题，大致来说，可以分为三类，两步法尝试从未标记的数据中识别出一些可靠的负样本，然后应用传统的监督学习或半监督学习技术。代价敏感学习技术用于不相等误分类代价的二元分类，也可以很容易地用于处理这个问题。针对这一问题，还提出了凸方法。注意，如果我们在这里将异常视为正样本，那么PU学习与部分观测异常的异常检测（ADOA）有些相似。然而,最显著的区别是,正样本在PU学习彼此相似，因此我们可以只找到一个中心，在异常检测，异常总是多样化,他们很少能将其只看做一类，使标准PU学习技术不适合处理异常检测的任务。 3. 部分异常观测的异常检测 这一章中，我们先描述我们的问题，然后描述我们的的方法（ADOA） 3.1 问题描述和符号标记 X = R d X = R^d X=Rd描述的是数据属于实数空间， y = { − 1 , + 1 } y=\{-1,+1\} y={−1,+1} 描述的是标签的范围，其中y=+1指的是异常，-1位正常样本，假设有m个训练样本 D = { ( x 1 , y 1 ) , . . . ( x l , y l ) , . . . ( x m , y m ) } D=\{(x_1,y_1),...(x_l,y_l),...(x_m,y_m)\} D={(x1​,y1​),...(xl​,yl​),...(xm​,ym​)}，其中 x i ∈ X x_i \in X xi​∈X，前 l l l个样本的标记是异常，另外 m − l m-l m−l个样本为未标记样本，尽管前 l l l个样本已经标记为异常，但是他们直接还是不同的。目标是建立模型： f : X → Y f:X \rightarrow Y f:X→Y，从而进一步利用该方法对未来数据进行各种异常与正常的识别。 3.2 本文的方法 ADOA 安装如下两步来进行： step1：对于已经标注异常的数据，我们将其分为不同的类，所以这样不同的类里面他们的特征就比较近似，对于未标注的数据，我们的目标是充分挖掘他的价值。所以我们尝试将其分为潜在的异常数据和可靠的正常数据，区分的条件就是isolation score和他们的similarity score。直接原因是这样：一方面，潜在的异常应该和正常样本不一样，另一方法，他们应该可以已观测到的异常近似。 step2：建立一个加权多分类模型，对于已经标注的异常，赋权为1，对于过滤出来的数据，其权重依据它所带的标签的置信度。 下面是数学描述： stage1：我们将观测的异常 D l D^l Dl分为k个中心 C = { C 1 , C 2 , . . . , C k } C=\{ C_1,C_2,...,C_k \} C={C1​,C2​,...,Ck​}，我们可以使用不同的聚类方法，这里只是简单的使用了k-means方法（需要先标准化数据），特别的，两个样本之间的距离直接使用了欧式距离 d i s t ( x i , x i ′ ) = ∑ i = 1 n ( x i j − x i ′ j ) 2 dist(x_i,x_{i&amp;#x27;})=\sum _{i=1}^n (x_{ij}-x_{i&amp;#x27;j})^2 dist(xi​,xi′​)=i=1∑n​(xij​−xi′j​)2 Isolation score 的计算：孤立的概念第一次被提出来。他们展示随机树林可以用来分离样本，森林里的每棵决策树都使用随机的特征来分割子样本，并不断的分裂节点，知道无法再分割样本。由于异常样本很少，他们总是很贴近于树的根节点，且正常的样本会处于树中比较深的节点。为了计算isolation score，每个样本被送到一颗树的叶子节点上，则可以获得节点的深度，然后计算样本的平均深度。通过计算样本在树中的平均深度，可以认为是样本为异常的概率 I S ( x ) IS(x) IS(x)，使 h ( x ) h(x) h(x)表示样本x的平均深度， E ( h ( x ) ) E(h(x)) E(h(x))表示样本在所有孤立树中的平均深度，假设我们有n个样本，则使 c ( n ) = 2 H ( n ) − ( 2 ( n − 1 ) / n ) c(n) = 2H(n) -(2(n-1)/n) c(n)=2H(n)−(2(n−1)/n) 表示为二进制搜索树中的平均深度，其中 H ( n ) H(n) H(n)是指定参数，可以是 l n ( n ) + 0.5772156649 ( E u l e r 常 数 ） ln(n)+0.5772156649(Euler 常数） ln(n)+0.5772156649(Euler常数）， c ( n ) c(n) c(n)是用来规范化IS的： I S ( x ) = 2 − E ( h ( x ) ) c ( n ) IS(x) = 2^{-\frac{E(h(x))}{c(n)}} IS(x)=2−c(n)E(h(x))​ 则 I S ( x ) IS(x) IS(x)的分数越高（越接近1），样本x就越有可能是异常。 Similarity score 的计算：另一方面，一个样本如果越靠近异常的中心，则它越有可能是潜在的异常，所以我们可以计算样本x和他相近的异常中心的相似分 S S ( x ) SS(x) SS(x)，其计算公式如下： S S ( x ) = max ⁡ i = 1 k e − ( x − u i ) 2 SS(x) = \max_{i=1}^k e^{-(x-u_i)^2} SS(x)=i=1maxk​e−(x−ui​)2 其中， u i u_i ui​是第i个异常的中心，k是总的异常中心的个数。 Total score 的计算：为了从未标注的样本中区分潜在的异常和正常样本，我们同时考虑Isolation score和Similarity score，总的得分计算： T S ( x ) = θ I S ( x ) + ( 1 − θ ) S S ( x ) TS(x) = \theta IS(x) + (1-\theta)SS(x) TS(x)=θIS(x)+(1−θ)SS(x) 其中， θ ∈ [ 0 , 1 ] \theta \in [0,1] θ∈[0,1]，用于平衡两种分数的重要程度。 令 α = 1 l ∑ i = 1 l T S ( x i ) \alpha = \frac{1}{l} \sum_{i=1}^l TS(x_i) α=l1​i=1∑l​TS(xi​) 表示异常的平均分数，所以我们选择 T S ( x ) ≥ α TS(x) \geq \alpha TS(x)≥α作为潜在的异常样本，并把它们放到最近的异常中心中。我们选择 T S ( x ) ≤ β TS(x) \leq \beta TS(x)≤β作为可靠的正常样本，其中 β \beta β是预定义的参数， β \beta β越小，选择的样本为正常的可能性就越大。 至此，我们不仅有了可以观测的异常，潜在的异常和可靠的正常样本，且异常被分到了k个类中。 然后，我们为所有的样本赋权，其中，所有标注的异常的权重直接为1，其他的样本中， T S ( x ) TS(x) TS(x)分越高，则权重越大，对于潜在的异常样本，计算公式为： w ( x ) = T S ( x ) m a x x T S ( x ) w(x) = \frac{TS(x)}{max_x{TS(x)}} w(x)=maxx​TS(x)TS(x)​ 对于可靠的正常样本，越小的 T S ( x ) TS(x) TS(x)分，则权重需要越高： w ( x ) = m a x x T S ( x ) − T S ( x ) m a x x T S ( x ) − m i n x T S ( x ) w(x) = \frac{max_x{TS(x)} - TS(x)}{max_x{TS(x)} -min_x{TS(x)} } w(x)=maxx​TS(x)−minx​TS(x)maxx​TS(x)−TS(x)​ 通过上述的样本和他们对应的权重，可以构建一个K+1的分类模型用来从正常样本中区分不同的异常。则我们的目标是最小化如下方程： ∑ i w i l ( y i , f ( x i ) ) + λ R ( w ) \sum_{i} w_il(y_i,f(x_i))+ \lambda R(w) i∑​wi​l(yi​,f(xi​))+λR(w) 其中 w i w_i wi​是指样本 x i x_i xi​的权重， l ( y i , f ( x i ) ) l(y_i,f(x_i)) l(yi​,f(xi​))是损失函数， R ( w ) R(w) R(w)是正则项，这篇文章中使用的是SVM，所以使用的是L2正则。 在构建完多分类模型后，新来的样本就可以进行分类了。当应用模型在无法观测的样本上时，不管新的样本属于哪个异常类别，都将其作为异常看待。 实验（略） 大致描述了几种不同方法在不同数据集上的效果，直接贴些图。 实验的数据集规模 第一个数据集的异常分布情况 不同方法的对比效果图" />
<link rel="canonical" href="https://mlh.app/2019/01/17/0a4473e814c82b23a708e5b620ee85cb.html" />
<meta property="og:url" content="https://mlh.app/2019/01/17/0a4473e814c82b23a708e5b620ee85cb.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-17T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"导语：这篇文章是蚂蚁金服2018年在WWW大会上投中的一篇paper，介绍如果使用少量标注的异常样本进行模型训练，也就是常说的半监督模型，刚好最近在做这个方面的内容，将其翻译过来备查。 摘要 本文研究了异常检测问题。以往的研究大多依据是否有标签来使用有监督或无监督方法， 可用。但是，总是存在一些不同于这两种标准模式的场景。本文中，我们处理了存在部分观测异常的场景，即我们拥有大量未标记的样本和一些少量人工标注的异常。我们将此问题称为存在部分异常观测下的异常检测，并提出两阶段法–ADOA来解决它。首先，通过处理异常之间的差异，而对未标记的数据进行筛选，以获得潜在的异常和可靠的正常数据。然后，利用上述数据，根据每个标签的置信度，给每个点附加一个权重，并建立一个加权的多类模型，该模型将进一步用于区分不同于正常数据的异常。实验结果表明，在上述条件下，现有方法的性能不理想，本文的方法性能明显优于上述方法，证明了该方法的有效性。 关键词 异常检测，观测异常，两步法 1. 引言 异常检测是一种广泛使用的技术，旨在从数据集中正常的行为识别出不正常的模式（patterns）。这些不正常的模式通常被称为异常或异常值，它们是由某种恶意目的或非法活动导致的。异常检测在入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动检测等各种应用中具有重要的意义和关键的帮助。 为了解决这一问题，近年来机器学习技术得到了广泛的应用，这些技术大致可以分为两类:基于非监督学习的方法和基于监督学习的方法。一般的，基于无监督学习的方法发展较快，它的训练数据不需要标签。例如，基于距离的方法、基于密度的方法和基于隔离的方法都是这一方法的典型代表。 另一方面，如果有足够的标注数据，则基于监督学习的方法，如训练支持向量机、决策树、k近邻等分类模型对不可见样本能进行进一步的分类。注意到，与非监督方法相比，监督方法总是能够在有足够标记数据的帮助下提供更好的性能。此外，本文利用标记数据和非标记数据，探索了基于半监督学习的方法，并结合不同的技术，开发了复合算法来处理这个问题。 然而，在某些情况下，异常样本的获取是困难的，我们在能再打来未标记的样本中获取少量的异常。让我们以恶意URL检测任务为例，在某些场景中，除了大量未标记的URL记录之外，我们只能在现有基于规则的系统的帮助下获得少量标记的恶意URL。与同时提供正样本和负样本的监督设置不同，我们在这里得到的只是一小部分正(恶意)样本，因此不能直接使用监督方法。另一方面，与无监督学习环境相比，我们还增加了一些带标签的（负）样本，如何合理利用这些负样本多模型很有帮组。在本文中，我们将这种特殊的异常检测设置称为部分观测异常的异常检测。 已经存在一种学习模式叫做PU (Positive and unlabel)算法，它的做法与前面提到的模式类似。然而，在PU学习中，正样本总是属于一个中心，这意味着正样本之间是相似的，而在异常检测中，正样本之间通常是不相似的，且可能存在严重的差异性。换句话说，我们不能直接假设说，两个异常之间的差异一定是小于正常样本和异常样本直接的差异的。因此，直接应用基于PU学习的异常检测技术可能无法获得满意的性能 另外还有一种半监督聚类的方法，处理那些部分标注的数据或者有先验信息的数据，其目标是将未标记的样本聚类到合适的类。似乎半监督学习处理的任务与我们描述的类似。然而，就像PU学习一样，在半监督聚类中，标记在同一个聚类中的样本应该是相似的，而在异常检测中，观测到的异常并不符合这一点。 本文考虑了部分观测异常异常检测的设置问题，提出了一种基于部分观测异常的异常检测方法ADOA来解决这一问题。ADOA算法有两个阶段。 step1： 我们认为异常数据不应简单地看成一个中心，假设异常属于k个不同的中心，首先将异常聚类为k个中心。然后根据孤立度和与最近异常类中心的相似性，从未标记的样本中选取潜在异常和可靠正样本。 step2：依据所附标签的置信度，对各个点进行赋权，然后，利用原始异常样本和所选的样本，建立加权的多分类模型，将异常与正常样本区分开来。 本文在不同数据集和实际应用任务上的实验中证明了该方法的有效性。 本文的其余部分组织如下。在第2节中，我们回顾了相关工作。在第3节中，我们陈述了问题的设定，并提出了所提出的方法。在第4节中，我们报告了在不同数据集上的实验结果。在第5节中，我们将该方法应用于恶意URL检测问题，并验证了该方法的有效性。最后，我们在第六部分对本文进行了总结。 2. 具体工作 异常检测用于处理从正常行为中识别意外模式的任务。异常的检测具有重要的影响，可以在许多不同的领域提供关键的帮助。在实际应用中，针对问题提出了许多基于机器学习的方法，并被广泛应用于入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动活动检测等诸多应用中。 在已有的方法中，基于无监督学习的方法使用无标记数据构建模型。举几个具有代表性的例子，基于距离的方法，基于密度的方法，基于隔离的方法，等等。这些方法可以广泛使用，因为不需要对数据进行标记。然而，在许多应用领域，非监督方法可能无法达到要求的性能。 另一方面，在提供标注数据的情况下，探索了基于监督学习的方法。先后采用支持向量机、决策树、k近邻等多种监督算法进行异常检测。适当利用标签信息，基于监督学习的方法总能取得更好的效果。除了这两种标准范式之外，基于半监督学习方和混合方法等其他方法也在这些技术的基础上进行了研究。 有些情况下，只有正常的样本数据，异常数据无法获取，这种情况下 one-class learning ，SVM 可应用于这种情形，这些方法主要是通过学习超球面来描述正态样本，或者通过学习超平面来最大限度地从原点分割数据点。 PU算法是半监督学习里面的一个特例，它主要用来解决当只有正样本和未标注的样本的数据的时候。过去几年，里，非常多的方法被提出来用以解决这种问题，大致来说，可以分为三类，两步法尝试从未标记的数据中识别出一些可靠的负样本，然后应用传统的监督学习或半监督学习技术。代价敏感学习技术用于不相等误分类代价的二元分类，也可以很容易地用于处理这个问题。针对这一问题，还提出了凸方法。注意，如果我们在这里将异常视为正样本，那么PU学习与部分观测异常的异常检测（ADOA）有些相似。然而,最显著的区别是,正样本在PU学习彼此相似，因此我们可以只找到一个中心，在异常检测，异常总是多样化,他们很少能将其只看做一类，使标准PU学习技术不适合处理异常检测的任务。 3. 部分异常观测的异常检测 这一章中，我们先描述我们的问题，然后描述我们的的方法（ADOA） 3.1 问题描述和符号标记 X = R d X = R^d X=Rd描述的是数据属于实数空间， y = { − 1 , + 1 } y=\\{-1,+1\\} y={−1,+1} 描述的是标签的范围，其中y=+1指的是异常，-1位正常样本，假设有m个训练样本 D = { ( x 1 , y 1 ) , . . . ( x l , y l ) , . . . ( x m , y m ) } D=\\{(x_1,y_1),...(x_l,y_l),...(x_m,y_m)\\} D={(x1​,y1​),...(xl​,yl​),...(xm​,ym​)}，其中 x i ∈ X x_i \\in X xi​∈X，前 l l l个样本的标记是异常，另外 m − l m-l m−l个样本为未标记样本，尽管前 l l l个样本已经标记为异常，但是他们直接还是不同的。目标是建立模型： f : X → Y f:X \\rightarrow Y f:X→Y，从而进一步利用该方法对未来数据进行各种异常与正常的识别。 3.2 本文的方法 ADOA 安装如下两步来进行： step1：对于已经标注异常的数据，我们将其分为不同的类，所以这样不同的类里面他们的特征就比较近似，对于未标注的数据，我们的目标是充分挖掘他的价值。所以我们尝试将其分为潜在的异常数据和可靠的正常数据，区分的条件就是isolation score和他们的similarity score。直接原因是这样：一方面，潜在的异常应该和正常样本不一样，另一方法，他们应该可以已观测到的异常近似。 step2：建立一个加权多分类模型，对于已经标注的异常，赋权为1，对于过滤出来的数据，其权重依据它所带的标签的置信度。 下面是数学描述： stage1：我们将观测的异常 D l D^l Dl分为k个中心 C = { C 1 , C 2 , . . . , C k } C=\\{ C_1,C_2,...,C_k \\} C={C1​,C2​,...,Ck​}，我们可以使用不同的聚类方法，这里只是简单的使用了k-means方法（需要先标准化数据），特别的，两个样本之间的距离直接使用了欧式距离 d i s t ( x i , x i ′ ) = ∑ i = 1 n ( x i j − x i ′ j ) 2 dist(x_i,x_{i&amp;#x27;})=\\sum _{i=1}^n (x_{ij}-x_{i&amp;#x27;j})^2 dist(xi​,xi′​)=i=1∑n​(xij​−xi′j​)2 Isolation score 的计算：孤立的概念第一次被提出来。他们展示随机树林可以用来分离样本，森林里的每棵决策树都使用随机的特征来分割子样本，并不断的分裂节点，知道无法再分割样本。由于异常样本很少，他们总是很贴近于树的根节点，且正常的样本会处于树中比较深的节点。为了计算isolation score，每个样本被送到一颗树的叶子节点上，则可以获得节点的深度，然后计算样本的平均深度。通过计算样本在树中的平均深度，可以认为是样本为异常的概率 I S ( x ) IS(x) IS(x)，使 h ( x ) h(x) h(x)表示样本x的平均深度， E ( h ( x ) ) E(h(x)) E(h(x))表示样本在所有孤立树中的平均深度，假设我们有n个样本，则使 c ( n ) = 2 H ( n ) − ( 2 ( n − 1 ) / n ) c(n) = 2H(n) -(2(n-1)/n) c(n)=2H(n)−(2(n−1)/n) 表示为二进制搜索树中的平均深度，其中 H ( n ) H(n) H(n)是指定参数，可以是 l n ( n ) + 0.5772156649 ( E u l e r 常 数 ） ln(n)+0.5772156649(Euler 常数） ln(n)+0.5772156649(Euler常数）， c ( n ) c(n) c(n)是用来规范化IS的： I S ( x ) = 2 − E ( h ( x ) ) c ( n ) IS(x) = 2^{-\\frac{E(h(x))}{c(n)}} IS(x)=2−c(n)E(h(x))​ 则 I S ( x ) IS(x) IS(x)的分数越高（越接近1），样本x就越有可能是异常。 Similarity score 的计算：另一方面，一个样本如果越靠近异常的中心，则它越有可能是潜在的异常，所以我们可以计算样本x和他相近的异常中心的相似分 S S ( x ) SS(x) SS(x)，其计算公式如下： S S ( x ) = max ⁡ i = 1 k e − ( x − u i ) 2 SS(x) = \\max_{i=1}^k e^{-(x-u_i)^2} SS(x)=i=1maxk​e−(x−ui​)2 其中， u i u_i ui​是第i个异常的中心，k是总的异常中心的个数。 Total score 的计算：为了从未标注的样本中区分潜在的异常和正常样本，我们同时考虑Isolation score和Similarity score，总的得分计算： T S ( x ) = θ I S ( x ) + ( 1 − θ ) S S ( x ) TS(x) = \\theta IS(x) + (1-\\theta)SS(x) TS(x)=θIS(x)+(1−θ)SS(x) 其中， θ ∈ [ 0 , 1 ] \\theta \\in [0,1] θ∈[0,1]，用于平衡两种分数的重要程度。 令 α = 1 l ∑ i = 1 l T S ( x i ) \\alpha = \\frac{1}{l} \\sum_{i=1}^l TS(x_i) α=l1​i=1∑l​TS(xi​) 表示异常的平均分数，所以我们选择 T S ( x ) ≥ α TS(x) \\geq \\alpha TS(x)≥α作为潜在的异常样本，并把它们放到最近的异常中心中。我们选择 T S ( x ) ≤ β TS(x) \\leq \\beta TS(x)≤β作为可靠的正常样本，其中 β \\beta β是预定义的参数， β \\beta β越小，选择的样本为正常的可能性就越大。 至此，我们不仅有了可以观测的异常，潜在的异常和可靠的正常样本，且异常被分到了k个类中。 然后，我们为所有的样本赋权，其中，所有标注的异常的权重直接为1，其他的样本中， T S ( x ) TS(x) TS(x)分越高，则权重越大，对于潜在的异常样本，计算公式为： w ( x ) = T S ( x ) m a x x T S ( x ) w(x) = \\frac{TS(x)}{max_x{TS(x)}} w(x)=maxx​TS(x)TS(x)​ 对于可靠的正常样本，越小的 T S ( x ) TS(x) TS(x)分，则权重需要越高： w ( x ) = m a x x T S ( x ) − T S ( x ) m a x x T S ( x ) − m i n x T S ( x ) w(x) = \\frac{max_x{TS(x)} - TS(x)}{max_x{TS(x)} -min_x{TS(x)} } w(x)=maxx​TS(x)−minx​TS(x)maxx​TS(x)−TS(x)​ 通过上述的样本和他们对应的权重，可以构建一个K+1的分类模型用来从正常样本中区分不同的异常。则我们的目标是最小化如下方程： ∑ i w i l ( y i , f ( x i ) ) + λ R ( w ) \\sum_{i} w_il(y_i,f(x_i))+ \\lambda R(w) i∑​wi​l(yi​,f(xi​))+λR(w) 其中 w i w_i wi​是指样本 x i x_i xi​的权重， l ( y i , f ( x i ) ) l(y_i,f(x_i)) l(yi​,f(xi​))是损失函数， R ( w ) R(w) R(w)是正则项，这篇文章中使用的是SVM，所以使用的是L2正则。 在构建完多分类模型后，新来的样本就可以进行分类了。当应用模型在无法观测的样本上时，不管新的样本属于哪个异常类别，都将其作为异常看待。 实验（略） 大致描述了几种不同方法在不同数据集上的效果，直接贴些图。 实验的数据集规模 第一个数据集的异常分布情况 不同方法的对比效果图","@type":"BlogPosting","url":"https://mlh.app/2019/01/17/0a4473e814c82b23a708e5b620ee85cb.html","headline":"使用部分异常观测数据进行异常检测（翻译自 Anomaly Detection with Partially Observed Anomalies）","dateModified":"2019-01-17T00:00:00+08:00","datePublished":"2019-01-17T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/01/17/0a4473e814c82b23a708e5b620ee85cb.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>使用部分异常观测数据进行异常检测（翻译自 Anomaly Detection with Partially Observed Anomalies）</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <blockquote> 
   <p>导语：这篇文章是蚂蚁金服2018年在WWW大会上投中的一篇paper，介绍如果使用少量标注的异常样本进行模型训练，也就是常说的半监督模型，刚好最近在做这个方面的内容，将其翻译过来备查。</p> 
  </blockquote> 
  <h1><a id="_1"></a>摘要</h1> 
  <p>本文研究了异常检测问题。以往的研究大多依据是否有标签来使用有监督或无监督方法，<br> 可用。但是，总是存在一些不同于这两种标准模式的场景。本文中，我们处理了存在部分观测异常的场景，即我们拥有大量未标记的样本和一些少量人工标注的异常。我们将此问题称为存在部分异常观测下的异常检测，并提出两阶段法–<code>ADOA</code>来解决它。首先，通过处理异常之间的差异，而对未标记的数据进行筛选，以获得潜在的异常和可靠的正常数据。然后，利用上述数据，根据每个标签的置信度，给每个点附加一个权重，并建立一个加权的多类模型，该模型将进一步用于区分不同于正常数据的异常。实验结果表明，在上述条件下，现有方法的性能不理想，本文的方法性能明显优于上述方法，证明了该方法的有效性。</p> 
  <h1><a id="_5"></a>关键词</h1> 
  <p>异常检测，观测异常，两步法</p> 
  <h2><a id="1__8"></a>1. 引言</h2> 
  <p>异常检测是一种广泛使用的技术，旨在从数据集中正常的行为识别出不正常的模式（patterns）。这些不正常的模式通常被称为异常或异常值，它们是由某种恶意目的或非法活动导致的。异常检测在入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动检测等各种应用中具有重要的意义和关键的帮助。<br> 为了解决这一问题，近年来机器学习技术得到了广泛的应用，这些技术大致可以分为两类:基于非监督学习的方法和基于监督学习的方法。一般的，基于无监督学习的方法发展较快，它的训练数据不需要标签。例如，基于距离的方法、基于密度的方法和基于隔离的方法都是这一方法的典型代表。<br> 另一方面，如果有足够的标注数据，则基于监督学习的方法，如训练支持向量机、决策树、k近邻等分类模型对不可见样本能进行进一步的分类。<strong>注意到，与非监督方法相比，监督方法总是能够在有足够标记数据的帮助下提供更好的性能</strong>。此外，本文利用标记数据和非标记数据，探索了基于半监督学习的方法，并结合不同的技术，开发了复合算法来处理这个问题。<br> 然而，在某些情况下，异常样本的获取是困难的，我们在能再打来未标记的样本中获取少量的异常。让我们以恶意URL检测任务为例，在某些场景中，除了大量未标记的URL记录之外，我们只能在现有基于规则的系统的帮助下获得少量标记的恶意URL。与同时提供正样本和负样本的监督设置不同，我们在这里得到的只是一小部分正(恶意)样本，因此不能直接使用监督方法。另一方面，与无监督学习环境相比，我们还增加了一些带标签的（负）样本，如何合理利用这些负样本多模型很有帮组。在本文中，我们将这种特殊的异常检测设置称为部分观测异常的异常检测。<br> 已经存在一种学习模式叫做PU (Positive and unlabel)算法，它的做法与前面提到的模式类似。然而，在PU学习中，正样本总是属于一个中心，这意味着正样本之间是相似的，而在异常检测中，正样本之间通常是不相似的，且可能存在严重的差异性。换句话说，我们不能直接假设说，两个异常之间的差异一定是小于正常样本和异常样本直接的差异的。因此，直接应用基于PU学习的异常检测技术可能无法获得满意的性能<br> 另外还有一种半监督聚类的方法，处理那些部分标注的数据或者有先验信息的数据，其目标是将未标记的样本聚类到合适的类。似乎半监督学习处理的任务与我们描述的类似。然而，就像PU学习一样，在半监督聚类中，标记在同一个聚类中的样本应该是相似的，而在异常检测中，观测到的异常并不符合这一点。<br> 本文考虑了部分观测异常异常检测的设置问题，提出了一种基于部分观测异常的异常检测方法<code>ADOA</code>来解决这一问题。<code>ADOA</code>算法有两个阶段。</p> 
  <ul> 
   <li>step1： 我们认为异常数据不应简单地看成一个中心，假设异常属于k个不同的中心，首先将异常聚类为k个中心。然后根据<strong>孤立度</strong>和<strong>与最近异常类中心的相似性</strong>，从未标记的样本中选取潜在异常和可靠正样本。</li> 
   <li>step2：依据所附标签的置信度，对各个点进行赋权，然后，利用原始异常样本和所选的样本，建立加权的多分类模型，将异常与正常样本区分开来。<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190117172315601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dhbmdfMzA2,size_16,color_FFFFFF,t_70" alt="两步示意图"><br> 本文在不同数据集和实际应用任务上的实验中证明了该方法的有效性。<br> 本文的其余部分组织如下。在第2节中，我们回顾了相关工作。在第3节中，我们陈述了问题的设定，并提出了所提出的方法。在第4节中，我们报告了在不同数据集上的实验结果。在第5节中，我们将该方法应用于恶意URL检测问题，并验证了该方法的有效性。最后，我们在第六部分对本文进行了总结。</li> 
  </ul> 
  <h2><a id="2__22"></a>2. 具体工作</h2> 
  <p>异常检测用于处理从正常行为中识别意外模式的任务。异常的检测具有重要的影响，可以在许多不同的领域提供关键的帮助。在实际应用中，针对问题提出了许多基于机器学习的方法，并被广泛应用于入侵检测、欺诈检测、故障检测、可疑事务检测、异常移动活动检测等诸多应用中。<br> 在已有的方法中，基于无监督学习的方法使用无标记数据构建模型。举几个具有代表性的例子，基于距离的方法，基于密度的方法，基于隔离的方法，等等。这些方法可以广泛使用，因为不需要对数据进行标记。然而，在许多应用领域，非监督方法可能无法达到要求的性能。<br> 另一方面，在提供标注数据的情况下，探索了基于监督学习的方法。先后采用支持向量机、决策树、k近邻等多种监督算法进行异常检测。适当利用标签信息，基于监督学习的方法总能取得更好的效果。除了这两种标准范式之外，基于半监督学习方和混合方法等其他方法也在这些技术的基础上进行了研究。<br> 有些情况下，只有正常的样本数据，异常数据无法获取，这种情况下 one-class learning ，SVM 可应用于这种情形，这些方法主要是通过学习超球面来描述正态样本，或者通过学习超平面来最大限度地从原点分割数据点。<br> PU算法是半监督学习里面的一个特例，它主要用来解决当只有正样本和未标注的样本的数据的时候。过去几年，里，非常多的方法被提出来用以解决这种问题，大致来说，可以分为三类，两步法尝试从未标记的数据中识别出一些可靠的负样本，然后应用传统的监督学习或半监督学习技术。代价敏感学习技术用于不相等误分类代价的二元分类，也可以很容易地用于处理这个问题。针对这一问题，还提出了凸方法。注意，如果我们在这里将异常视为正样本，那么PU学习与部分观测异常的异常检测（ADOA）有些相似。然而,最显著的区别是,正样本在PU学习彼此相似，因此我们可以只找到一个中心，在异常检测，异常总是多样化,他们很少能将其只看做一类，使标准PU学习技术不适合处理异常检测的任务。</p> 
  <h2><a id="3__29"></a>3. 部分异常观测的异常检测</h2> 
  <p>这一章中，我们先描述我们的问题，然后描述我们的的方法（ADOA）</p> 
  <h3><a id="31__31"></a>3.1 问题描述和符号标记</h3> 
  <p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          X
         </mi>
         <mo>
          =
         </mo>
         <msup>
          <mi>
           R
          </mi>
          <mi>
           d
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         X = R^d
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">d</span></span></span></span></span></span></span></span></span></span></span></span>描述的是数据属于实数空间，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
         <mo>
          =
         </mo>
         <mo>
          {
         </mo>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mo>
          +
         </mo>
         <mn>
          1
         </mn>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         y=\{-1,+1\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span> 描述的是标签的范围，其中y=+1指的是异常，-1位正常样本，假设有m个训练样本<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          D
         </mi>
         <mo>
          =
         </mo>
         <mo>
          {
         </mo>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           l
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mi>
           l
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           m
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mi>
           m
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         D=\{(x_1,y_1),...(x_l,y_l),...(x_m,y_m)\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span>，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          ∈
         </mo>
         <mi>
          X
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x_i \in X
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span></span></span></span></span>，前<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span></span></span></span></span>个样本的标记是异常，另外<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          m
         </mi>
         <mo>
          −
         </mo>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         m-l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathit">m</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span></span></span></span></span>个样本为未标记样本，尽管前<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span></span></span></span></span>个样本已经标记为异常，但是他们直接还是不同的。目标是建立模型：<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          f
         </mi>
         <mo>
          :
         </mo>
         <mi>
          X
         </mi>
         <mo>
          →
         </mo>
         <mi>
          Y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         f:X \rightarrow Y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span></span></span></span></span>，从而进一步利用该方法对未来数据进行各种异常与正常的识别。</p> 
  <h3><a id="32__33"></a>3.2 本文的方法</h3> 
  <p>ADOA 安装如下两步来进行：</p> 
  <ul> 
   <li>step1：对于已经标注异常的数据，我们将其分为不同的类，所以这样不同的类里面他们的特征就比较近似，对于未标注的数据，我们的目标是充分挖掘他的价值。所以我们尝试将其分为潜在的异常数据和可靠的正常数据，区分的条件就是isolation score和他们的similarity score。直接原因是这样：一方面，潜在的异常应该和正常样本不一样，另一方法，他们应该可以已观测到的异常近似。</li> 
   <li>step2：建立一个加权多分类模型，对于已经标注的异常，赋权为1，对于过滤出来的数据，其权重依据它所带的标签的置信度。</li> 
  </ul> 
  <p>下面是数学描述：<br> stage1：我们将观测的异常<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           D
          </mi>
          <mi>
           l
          </mi>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         D^l
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span>分为k个中心<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          C
         </mi>
         <mo>
          =
         </mo>
         <mo>
          {
         </mo>
         <msub>
          <mi>
           C
          </mi>
          <mn>
           1
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           C
          </mi>
          <mn>
           2
          </mn>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mi mathvariant="normal">
          .
         </mi>
         <mo separator="true">
          ,
         </mo>
         <msub>
          <mi>
           C
          </mi>
          <mi>
           k
          </mi>
         </msub>
         <mo>
          }
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         C=\{ C_1,C_2,...,C_k \}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>，我们可以使用不同的聚类方法，这里只是简单的使用了k-means方法（需要先标准化数据），特别的，两个样本之间的距离直接使用了欧式距离<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           d
          </mi>
          <mi>
           i
          </mi>
          <mi>
           s
          </mi>
          <mi>
           t
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <msup>
            <mi>
             i
            </mi>
            <mo mathvariant="normal">
             ′
            </mo>
           </msup>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            n
           </mi>
          </munderover>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <mi>
             i
            </mi>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <mo>
           −
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mrow>
            <msup>
             <mi>
              i
             </mi>
             <mo mathvariant="normal">
              ′
             </mo>
            </msup>
            <mi>
             j
            </mi>
           </mrow>
          </msub>
          <msup>
           <mo>
            )
           </mo>
           <mn>
            2
           </mn>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          dist(x_i,x_{i&amp;#x27;})=\sum _{i=1}^n (x_{ij}-x_{i&amp;#x27;j})^2 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.92907em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.15022em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathit mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><br> <strong>Isolation score</strong> 的计算：孤立的概念第一次被提出来。他们展示随机树林可以用来分离样本，森林里的每棵决策树都使用随机的特征来分割子样本，并不断的分裂节点，知道无法再分割样本。由于异常样本很少，他们总是很贴近于树的根节点，且正常的样本会处于树中比较深的节点。为了计算isolation score，每个样本被送到一颗树的叶子节点上，则可以获得节点的深度，然后计算样本的平均深度。通过计算样本在树中的平均深度，可以认为是样本为异常的概率<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         IS(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>，使<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         h(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>表示样本x的平均深度，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          E
         </mi>
         <mo>
          (
         </mo>
         <mi>
          h
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         E(h(x))
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">E</span><span class="mopen">(</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>表示样本在所有孤立树中的平均深度，假设我们有n个样本，则使<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           c
          </mi>
          <mo>
           (
          </mo>
          <mi>
           n
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mn>
           2
          </mn>
          <mi>
           H
          </mi>
          <mo>
           (
          </mo>
          <mi>
           n
          </mi>
          <mo>
           )
          </mo>
          <mo>
           −
          </mo>
          <mo>
           (
          </mo>
          <mn>
           2
          </mn>
          <mo>
           (
          </mo>
          <mi>
           n
          </mi>
          <mo>
           −
          </mo>
          <mn>
           1
          </mn>
          <mo>
           )
          </mo>
          <mi mathvariant="normal">
           /
          </mi>
          <mi>
           n
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          c(n) = 2H(n) -(2(n-1)/n)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">c</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathit" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span></span></span><br> 表示为二进制搜索树中的平均深度，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          H
         </mi>
         <mo>
          (
         </mo>
         <mi>
          n
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         H(n)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span></span>是指定参数，可以是<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          n
         </mi>
         <mo>
          (
         </mo>
         <mi>
          n
         </mi>
         <mo>
          )
         </mo>
         <mo>
          +
         </mo>
         <mn>
          0.5772156649
         </mn>
         <mo>
          (
         </mo>
         <mi>
          E
         </mi>
         <mi>
          u
         </mi>
         <mi>
          l
         </mi>
         <mi>
          e
         </mi>
         <mi>
          r
         </mi>
         <mi mathvariant="normal">
          常
         </mi>
         <mi mathvariant="normal">
          数
         </mi>
         <mi mathvariant="normal">
          ）
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         ln(n)+0.5772156649(Euler 常数）
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">7</span><span class="mord">7</span><span class="mord">2</span><span class="mord">1</span><span class="mord">5</span><span class="mord">6</span><span class="mord">6</span><span class="mord">4</span><span class="mord">9</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.05764em;">E</span><span class="mord mathit">u</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord cjk_fallback">常</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">）</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          c
         </mi>
         <mo>
          (
         </mo>
         <mi>
          n
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         c(n)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">c</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span></span>是用来规范化IS的：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           I
          </mi>
          <mi>
           S
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <msup>
           <mn>
            2
           </mn>
           <mrow>
            <mo>
             −
            </mo>
            <mfrac>
             <mrow>
              <mi>
               E
              </mi>
              <mo>
               (
              </mo>
              <mi>
               h
              </mi>
              <mo>
               (
              </mo>
              <mi>
               x
              </mi>
              <mo>
               )
              </mo>
              <mo>
               )
              </mo>
             </mrow>
             <mrow>
              <mi>
               c
              </mi>
              <mo>
               (
              </mo>
              <mi>
               n
              </mi>
              <mo>
               )
              </mo>
             </mrow>
            </mfrac>
           </mrow>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          IS(x) = 2^{-\frac{E(h(x))}{c(n)}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.21065em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.21065em;"><span class="" style="top: -3.4842em; margin-right: 0.05em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.03779em;"><span class="" style="top: -2.64079em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mopen mtight">(</span><span class="mord mathit mtight">n</span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.2255em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line mtight" style="border-bottom-width: 0.049em;"></span></span><span class="" style="top: -3.50207em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.05764em;">E</span><span class="mopen mtight">(</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.537786em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br> 则<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          I
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         IS(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>的分数越高（越接近1），样本x就越有可能是异常。<br> <strong>Similarity score</strong> 的计算：另一方面，一个样本如果越靠近异常的中心，则它越有可能是潜在的异常，所以我们可以计算样本x和他相近的异常中心的相似分<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          S
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         SS(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>，其计算公式如下：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           S
          </mi>
          <mi>
           S
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <munderover>
           <mi>
            max
           </mi>
           <mo>
            ⁡
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            k
           </mi>
          </munderover>
          <msup>
           <mi>
            e
           </mi>
           <mrow>
            <mo>
             −
            </mo>
            <mo>
             (
            </mo>
            <mi>
             x
            </mi>
            <mo>
             −
            </mo>
            <msub>
             <mi>
              u
             </mi>
             <mi>
              i
             </mi>
            </msub>
            <msup>
             <mo>
              )
             </mo>
             <mn>
              2
             </mn>
            </msup>
           </mrow>
          </msup>
         </mrow>
         <annotation encoding="application/x-tex">
          SS(x) = \max_{i=1}^k e^{-(x-u_i)^2}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.94433em; vertical-align: -0.727664em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.21667em;"><span class="" style="top: -2.07234em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">max</span></span></span><span class="" style="top: -3.33056em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.727664em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.03692em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891314em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           u
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         u_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是第i个异常的中心，k是总的异常中心的个数。<br> <strong>Total score</strong> 的计算：为了从未标注的样本中区分潜在的异常和正常样本，我们同时考虑Isolation score和Similarity score，总的得分计算：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           T
          </mi>
          <mi>
           S
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mi>
           θ
          </mi>
          <mi>
           I
          </mi>
          <mi>
           S
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mo>
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <mi>
           θ
          </mi>
          <mo>
           )
          </mo>
          <mi>
           S
          </mi>
          <mi>
           S
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          TS(x) = \theta IS(x) + (1-\theta)SS(x)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord mathit" style="margin-right: 0.07847em;">I</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></span><br> 其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          θ
         </mi>
         <mo>
          ∈
         </mo>
         <mo>
          [
         </mo>
         <mn>
          0
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          1
         </mn>
         <mo>
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         \theta \in [0,1]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>，用于平衡两种分数的重要程度。<br> 令<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           α
          </mi>
          <mo>
           =
          </mo>
          <mfrac>
           <mn>
            1
           </mn>
           <mi>
            l
           </mi>
          </mfrac>
          <munderover>
           <mo>
            ∑
           </mo>
           <mrow>
            <mi>
             i
            </mi>
            <mo>
             =
            </mo>
            <mn>
             1
            </mn>
           </mrow>
           <mi>
            l
           </mi>
          </munderover>
          <mi>
           T
          </mi>
          <mi>
           S
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \alpha = \frac{1}{l} \sum_{i=1}^l TS(x_i)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.11378em; vertical-align: -1.27767em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.01968em;">l</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.83611em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 表示异常的平均分数，所以我们选择<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          ≥
         </mo>
         <mi>
          α
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         TS(x) \geq \alpha
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>作为潜在的异常样本，并把它们放到最近的异常中心中。我们选择<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
         <mo>
          ≤
         </mo>
         <mi>
          β
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         TS(x) \leq \beta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05278em;">β</span></span></span></span></span>作为可靠的正常样本，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          β
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05278em;">β</span></span></span></span></span>是预定义的参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          β
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         \beta
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.05278em;">β</span></span></span></span></span>越小，选择的样本为正常的可能性就越大。<br> 至此，我们不仅有了可以观测的异常，潜在的异常和可靠的正常样本，且异常被分到了k个类中。<br> 然后，我们为所有的样本赋权，其中，所有标注的异常的权重直接为1，其他的样本中，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         TS(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>分越高，则权重越大，对于潜在的异常样本，计算公式为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           w
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             T
            </mi>
            <mi>
             S
            </mi>
            <mo>
             (
            </mo>
            <mi>
             x
            </mi>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             a
            </mi>
            <msub>
             <mi>
              x
             </mi>
             <mi>
              x
             </mi>
            </msub>
            <mrow>
             <mi>
              T
             </mi>
             <mi>
              S
             </mi>
             <mo>
              (
             </mo>
             <mi>
              x
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          w(x) = \frac{TS(x)}{max_x{TS(x)}}
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 对于可靠的正常样本，越小的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          T
         </mi>
         <mi>
          S
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         TS(x)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>分，则权重需要越高：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mi>
           w
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           =
          </mo>
          <mfrac>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             a
            </mi>
            <msub>
             <mi>
              x
             </mi>
             <mi>
              x
             </mi>
            </msub>
            <mrow>
             <mi>
              T
             </mi>
             <mi>
              S
             </mi>
             <mo>
              (
             </mo>
             <mi>
              x
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mo>
             −
            </mo>
            <mi>
             T
            </mi>
            <mi>
             S
            </mi>
            <mo>
             (
            </mo>
            <mi>
             x
            </mi>
            <mo>
             )
            </mo>
           </mrow>
           <mrow>
            <mi>
             m
            </mi>
            <mi>
             a
            </mi>
            <msub>
             <mi>
              x
             </mi>
             <mi>
              x
             </mi>
            </msub>
            <mrow>
             <mi>
              T
             </mi>
             <mi>
              S
             </mi>
             <mo>
              (
             </mo>
             <mi>
              x
             </mi>
             <mo>
              )
             </mo>
            </mrow>
            <mo>
             −
            </mo>
            <mi>
             m
            </mi>
            <mi>
             i
            </mi>
            <msub>
             <mi>
              n
             </mi>
             <mi>
              x
             </mi>
            </msub>
            <mrow>
             <mi>
              T
             </mi>
             <mi>
              S
             </mi>
             <mo>
              (
             </mo>
             <mi>
              x
             </mi>
             <mo>
              )
             </mo>
            </mrow>
           </mrow>
          </mfrac>
         </mrow>
         <annotation encoding="application/x-tex">
          w(x) = \frac{max_x{TS(x)} - TS(x)}{max_x{TS(x)} -min_x{TS(x)} }
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit" style="margin-right: 0.13889em;">T</span><span class="mord mathit" style="margin-right: 0.05764em;">S</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 通过上述的样本和他们对应的权重，可以构建一个K+1的分类模型用来从正常样本中区分不同的异常。则我们的目标是最小化如下方程：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <munder>
           <mo>
            ∑
           </mo>
           <mi>
            i
           </mi>
          </munder>
          <msub>
           <mi>
            w
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mi>
           l
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            y
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo separator="true">
           ,
          </mo>
          <mi>
           f
          </mi>
          <mo>
           (
          </mo>
          <msub>
           <mi>
            x
           </mi>
           <mi>
            i
           </mi>
          </msub>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
          <mo>
           +
          </mo>
          <mi>
           λ
          </mi>
          <mi>
           R
          </mi>
          <mo>
           (
          </mo>
          <mi>
           w
          </mi>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
          \sum_{i} w_il(y_i,f(x_i))+ \lambda R(w)
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.32767em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">λ</span><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mclose">)</span></span></span></span></span></span><br> 其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           w
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         w_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是指样本<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         x_i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的权重，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          l
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo separator="true">
          ,
         </mo>
         <mi>
          f
         </mi>
         <mo>
          (
         </mo>
         <msub>
          <mi>
           x
          </mi>
          <mi>
           i
          </mi>
         </msub>
         <mo>
          )
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         l(y_i,f(x_i))
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>是损失函数，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          R
         </mi>
         <mo>
          (
         </mo>
         <mi>
          w
         </mi>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         R(w)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02691em;">w</span><span class="mclose">)</span></span></span></span></span>是正则项，这篇文章中使用的是SVM，所以使用的是L2正则。<br> 在构建完多分类模型后，新来的样本就可以进行分类了。当应用模型在无法观测的样本上时，不管新的样本属于哪个异常类别，都将其作为异常看待。</p> 
  <h2><a id="_65"></a>实验（略）</h2> 
  <p>大致描述了几种不同方法在不同数据集上的效果，直接贴些图。</p> 
  <ul> 
   <li>实验的数据集规模<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190130165824300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dhbmdfMzA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>第一个数据集的异常分布情况<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190130165905847.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dhbmdfMzA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
   <li>不同方法的对比效果图<br> <img src="https://blog.uzzz.org.cn/_p?https://img-blog.csdnimg.cn/20190130165942595.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dhbmdfMzA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li> 
  </ul> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-7b4cdcb592.css" rel="stylesheet"> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
