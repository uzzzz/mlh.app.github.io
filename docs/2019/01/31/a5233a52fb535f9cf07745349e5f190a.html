<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>钢铁佩奇手撕白皮书 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="钢铁佩奇手撕白皮书" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="本文转自碳链价值 作者：白鱼 编辑：唐晗 在看此文之前，你一定要接受一件事：比特币是基于概率的产物。在看完此文之后，你最好明白：如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。这是本文的关键思想。 白皮书第11章计算很难懂？ 为纪念比特币十年，圈内最近掀起了一股重读比特币白皮书的热潮。然而，虽然很多文章都在感叹比特币的经济机制设计得如何精妙，但竟然少有能把白皮书第11章的双花攻击成功率的计算公式讲明白的。 作为一个刚入圈的新手，我实在无法理解，如果弄不懂比特币背后的数学机制，不能确信双花的概率，我们又何来的对比特币系统安全性的信心。当然，如果诸位只是想要找个附属物安一个政治口号，宣扬一下自由主义的观念，再炒作和信仰一番，那就另当别论了。 我也看到了很多比较模糊、甚至与中本聪原意出入很大的说法。例如“比特币交易需要6个确认”：有人认为比特币一定要经过6个确认后，才算是交易成功；也有人认为经过6个区块的确认后，交易就不存在风险了。还有大家常常挂在嘴边的51%攻击：很多人认为，攻击的算力必须达到51%，或者必须多于50%，才能够攻击成功。但其实不是这样的。实际情况是，如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。 “6个确认”和“51%攻击”的说法由来以久，且传播深远。但如果你读完中本聪的原文，你会发现，比特币白皮书中压根就没有提到这两个词。他既没有说交易一定需要6个确认，也没有说必须拥有51%的算力才能成功发动攻击。甚至在中本聪给出的简化模型里，只需要50%的算力，不管人们采取多少个确认（1000个或者10000个），无限攻击成功的可能性为100%。严格意义来说，人们应该称51%攻击为50%攻击。 但50%攻击显然不符合人们的直觉，也不符合人们少数服从多数的政治期望。在日后布道者们的宣传中，为了让人们能够快速理解和接受这个概念，双花攻击最终被简化成了“51%”攻击。 本文作为一篇硬核科普，将从数学概率的角度澄清人们对“6个确认”和“51%攻击”的一些误解。内容主要分为双花攻击流程、双花成功概率分析、结论与不足。为了读懂本文，你最好掌握一些概率论的知识，主要是泊松分布（学过高数就行）；你也需要了解一下白皮书中提到的“赌徒破产模型”，它是我们理解“50%攻击”的关键。当然，如果你没有学过这些内容也无关紧要，因为它们背后的思想都简单易懂。尤其是“赌徒破产模型”，它看上去非常违背直觉，但很有趣。 双花攻击流程 最近钢铁佩奇比较火。为了让讲解过程不那么枯燥，请让我以钢铁佩奇为例来讲一讲这无聊而又致命的双花攻击。 引用电子货币领域经典的Alice和Bob交易例子，来说明比特币作为电子现金的三大难点及其解决方案。Alice想以1299元购买Bob的钢铁佩奇，Alice付款有2种方式，一是物理现金，二是电子转账。第二种方式实际上传递的是一个转账消息，电子消息充当了货币，其成功关键在于有银行判定Alice是否有足够的余额支付，并进行划扣，最终记录交易双方账户余额。 设想如果系统中没有中心的银行如何进行支付呢？这就是比特币想要解决的事情。 同样，Alice向Bob发送了一个电子消息“Alice给Bob转1299元。”想要使Bob相信这笔付款，起码要解决3个问题，证明此消息确实是Alice发送的（不可伪造性）、判断Alice确实有1299元（所有权证明），知道Alice没有同时支付给另一个人（双花）。 利用不对称加密算法，Alice使用私钥签名能够提供其资产所有权证明和保证交易的不可伪造性，这是比特币之前就已经很成熟的技术。 但是双花难题依旧没有解决，此前的电子货币方案一直依赖于引入中心第三方来解决，这相当于重造了一个中央银行，现实意义并不大。中本聪创造性地利用区块链作为公共账本和引入矿工竞争记账解决了这个问题，这也是比特币的伟大之处。 双花是指，Alice给Bob转钱的同时又给Charlie转了相同数目的一笔钱买手机。这时候Bob和Charlie查看自己的账本进行验证，发现Alice确实有1299元。他们无法得知Alice是否给其他人也转账了。于是，Alice拿走佩奇和手机，剩下Bob和Charlie只有一个人能得到1299元，这就是简单情形下的双花问题。中本聪引入矿工之后，Bob收到这笔付款通过交易验证后，并不会立马独自记账然后发货，他会广播这笔交易，让网络上多数人帮忙验证Alice是否只给自己转了这笔钱。假设Charlie也广播了这笔交易，那么最后只能有一笔交易记在公共账本上。通过分析可以知道，这种简单双花基本上是不可能实现的。其他矿工没动机帮Alice记假账（放入Alice给Bob和Charlie的两笔冲突交易）即使Alice竞争到了记账机会，广播区块之后，也会被其他矿工验证出两笔冲突交易存在。 以上情形是交易被Alice确认之前的简单双花问题，还有一种复杂的双花问题，Alice可以转给自己，同时制造分叉链最后代替主链完成双花，基本攻击流程是这样的。 在图（a）最后一个区块，Alice向全网广播“Alice给Bob转1299元” Alice修改自己的客户端程序，记入一笔“Alice给Alice转1299元”，同时悄悄挖矿，不广播自己的进度，挖出图（b）的白色链。 等到Bob看到全网主链（黑色链）有足够的确认区块个数（通常认为是6个，为什么？），发出钢铁佩奇之后，如果Alice的白链长于黑色主链，他会向全网公布自己的进度，从而被接受为新的主链。 主链只记录“Alice给Alice转1299元”，从而使得“Alice给Bob转1299元”无法记入账本。最终双花攻击成功，Alice拿到了钢铁佩奇，Bob一无所获。当然，Alice发起攻击是有成本的，他为了挖出白色链，需要投入矿机以及电力消耗，除非收益大于成本，否则理性攻击者是不会发起攻击的。余下全文，我们仅考虑在收款方等待z个确认之后，占全网算力q%的攻击者双花成功的概率。也就是说，不考虑攻击的经济可行性，仅仅分析攻击成功的概率大小。 双花成功概率分析 我们都学过如何求解应用题。第一部分交代了双花问题的背景，相当于告诉了我们“应用题”的条件，现在我们需要求解这道题。题目是：已知Alice占有全网算力比例为q，诚实节点占全网算力比例为p，p+q=1，Bob等待z个区块确认交易后，求解Alice使得自己偷偷挖的白链长度追上黑链（主链）的概率P（win）? 此问题还包含着以下假设：追赶时间内，系统难度值保持不变；攻击者Alice和诚实节点的算力相对比例不变。 求解追上概率可以拆解为两种情况来分析，第一情况是在等待z个区块确认的时间里，这段时间攻击者Alice挖出了k个区块，且k&gt;s即攻击链更长。这种情况下，一旦公开网络上最长链追加了n个区块，Bob就会认为交易已经确认，可以向Alice发出钢铁佩奇。而Alice一旦看到货已经发出，他就可以公布自己的白色链，由于白色链长于黑色，那么Alice记录的“Alice给Alice转1299元”交易记录留在主链上，双花成功。 另一种情况是，k&lt;=z，记n=z-k表示攻击链和诚实主链的差距。也就是说，在Bob确认交易的时候，Alice的白链短于主链，不足以发动攻击，他会继续偷偷挖，和主链竞争不断缩小差距，直到比主链长。 算出两种情况下概率再求和就是攻击成功概率了。 泊松分布—求Alice挖出k个区块的概率 以下按照中本聪的白皮书原文思路来推导，采用泊松分布假设，Meni Rosenfeld在“Analysis of hashrate-based double-spending”中采用更加精确的负二项分布，两个结果差异很小。 假设诚实节点按预期时间均匀出块，那么在诚实节点挖出Z个块的时间内，Alice挖出区块的平均值是： 泊松分布的概率函数为： 泊松分布用来描述单位时间内随机事件发生的次数。泊松分布的参数λ是单位时间(或单位面积)内随机事件的平均发生次数。 通过泊松分布，就可以知道k=1,2,3····的概率分别是多少，比如,这段时间Alice只挖到k=1个块的概率是P(k=1)=(λ^1 ⅇ^(-λ))/1!=λⅇ^(-λ) 那么第一种情况发生的概率就是 这个式子表示发生k=z+1,z+2,z+3····这些事件的概率之和。 赌徒破产问题 如果你看到了这里，恭喜。要么你就是一个脑子里还留了一点高等数学的人，对于读者来说这已经相当不易，欢迎在后台联系我；要么你对严谨枯燥内容的抗性已经超过了绝大多数人，这比前者还要难得。 我们现在需要对问题的另一半进行解答。但在讨论这一部分之前，你需要接受一个反直觉的例子：假使一个赌徒把自己的钱分成n份去赌场赌博，他输赢的概率为二分之一。如果这场赌博进行无限次，赌徒一定会输光自己身上所有的钱。 这就是大名鼎鼎的“赌徒破产问题”。这个问题的关键在于假设赌场手里的钱远多于赌徒，因而不需要考虑筹码归零的问题；而赌徒手里的钱远少于赌场，一旦某一次赌输，使筹码归零，便必须退出游戏。因此，虽然从单次赌博的概率上看上去，赌徒和赌场的游戏是平等的，但由于筹码的多少限制了赌徒和赌场游戏可以进行的区间，最终游戏的天平倒向了赌场。 这个问题规劝了那些赌博成瘾的人们。它说明了，就算游戏是公平的，但如果一个人执迷赌场以此为家，最后也将赔得精光。 这与攻击者和诚实节点又何其之像！攻击者只要区块数追平后超过诚实节点所挖的链，按照比特币“最长链”的原则，其他算力便会转移到节点数更高的新链上来，攻击成功。假设诚实节点们挖得的链长度超过攻击者k-z个，这就好比诚实节点作为赌徒手里有k-z个筹码。此时，诚实节点与攻击者同时进行着一场赌博的竞赛，一旦诚实节点将手中的筹码输干净，攻击者便能追上。（其实应该是输到剩下-1个，但中本聪的白皮书里的假设是输到0。其实，输到0仅仅是追平，但双花攻击需要超越，因此这个假设不太严谨，读者们见仁见智，可以做更深的讨论。我们暂时按照白皮书里的思路走。） 理解了这个比喻，让我们回到原来的话题。现在我们要求第二种情况下追上的概率，这种情况下，我们可以把问题进行简化，近似抽象成赌徒破产问题。已经知道，此时Alice挖出k个区块，比主链少n=k-z个。在既定的n个区块差距下，他们将竞赛挖矿，攻击者成功概率是q，诚实节点是p。放在数轴上考虑，每一局竞赛当攻击者赢，则向左一步，缩小差距为n-1，否则向右变为n+1。问多局博弈之后，Alice向左移到0的概率？ 我们可以先考虑n=1的时候移到n=0的概率。记p(1)表示从1移到0的概率，p(2)表示从2移到0的概率，依次类推求p(n)。 显然在1这个点，一局博弈之后，只有两种情况，向左到0，向右到2。然后从2移到0的概率为p(2).所以有以下方程: 结论 总结得到Alice追上概率为： 这也就是白皮书第11章最后给出的结论公式（见下图）。一些人用过这个公式，但我没能找到完整的推导过程。希望本文解答那些对此公式同样感到费解的朋友们的一些疑惑。 中本聪白皮书原文 在得出这个公式后，让我们回归文章开头的“6个确认”和“51%攻击”问题。 简单来说，这个公式可以总结为p(win)=f(q,z), 即双花成功的概率是攻击者算力比例q和收款者等待确认区块个数z的函数。给定q和z,就可以算出成功概率，以下是Meni Rosenfeld论文中根据此函数，给出的数据和图。 图中横轴表示q取不同值，不同曲线表示z不同，纵轴表示成功概率。 如图所示：当攻击者算力占比大于等于50%时，无线时常的攻击总能成功 &nbsp; 由以上结果，可以得出一些结论： 1、一般情形下，成功概率对z值呈指数下降，所以等待更多区块以后确认交易是保险的策略。 2、无论多大的确认数z也无法把成功概率降到0，做不到万无一失。 3、当攻击算力大于等于50%，不管多大的区块确认数也无法阻止双花成功。（关于50%攻击，请回想一下赌徒破产模型。其实，中本聪在白皮书中把情况二双花的要求退化成了“追上”。但就算我们把“追上”变成“超过”，即允许赌徒最后可以-1个，这依然改变不了什么。掌握了50%后，只要能够发动无限时长的攻击，就一定能够攻击成功。这就类似于，哪怕赌场愿意借一块钱给赌徒赌博，最后赌徒也无法避免破产的命运。） 至此，我们可以清楚明白，所谓“6个确认”是说，攻击算力在10%以下，等待6区块确认，双花成功的概率在0.1%以下。理论上讲，在任意小算力和任意大确认数下，成功概率非常小，但仍可能攻击成功。 不足 此模型有些地方并不精确。求解第二阶段概率时，把问题抽象成赌徒破产模型。诚实节点和攻击者是分别在两条链上各自挖矿竞争，假设攻击者先挖到了区块，那么此局结束，双方仍以p和q的概率开启下一局，诚实节点算新区块，攻击者继续算上一个区块。然而现实时攻击者虽然此局失败，但是他已经累积了一定工作量，他继续算出这个区块的概率比上一局算出的概率大。由此会对最终计算结果造成一定误差。 另外一点是本文没有讨论攻击者的攻击成本和收益的经济分析。 注：本文概率分析模型主要参考比特币白皮书、Meni Rosenfeld的“Analysis of hashrate-based double-spending”以及果壳的“从酒鬼失足到赌徒破产，悲剧收场为何注定”。 参考文献： Satoshi Nakamoto , ”Bitcoin: A Peer-to-Peer Electronic Cash System”,2009 Meni Rosenfeld,“Analysis of hashrate-based double-spending”, 2012 pondering，“从酒鬼失足到赌徒破产，悲剧收场为何注定”,果壳,2011 Zhangzedtv,”通过源码学习比特币-难度目标与难度调整” 2018 Michael Nielsen,”比特币协议是怎样工作的”,2014 W. Feller, &quot;An introduction to probability theory and its applications,&quot;1957 Tiny熊, ”比特币如何达成共识-最长链的选择” 2017 — END — 推荐阅读： 年度大戏！以太坊大神怒怼智能合约之父，尼克·萨博到底做错了啥？ 孟岩：区块链的原则与价值观 打破区块链不可能三角！2 华人专家论文将登 NSDI 2019 计算机顶会 鏖战九载，Google 是否会因 Oracle 而弃用 Java？ 小心！你的脸正在成为色情片主角 iPhone曝严重漏洞，用户接听FaceTime前或被“监听”！ 聊聊云计算：为什么构建网站时常会用到负载均衡 嫁人当嫁程序员 好文！点「好看」哟~" />
<meta property="og:description" content="本文转自碳链价值 作者：白鱼 编辑：唐晗 在看此文之前，你一定要接受一件事：比特币是基于概率的产物。在看完此文之后，你最好明白：如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。这是本文的关键思想。 白皮书第11章计算很难懂？ 为纪念比特币十年，圈内最近掀起了一股重读比特币白皮书的热潮。然而，虽然很多文章都在感叹比特币的经济机制设计得如何精妙，但竟然少有能把白皮书第11章的双花攻击成功率的计算公式讲明白的。 作为一个刚入圈的新手，我实在无法理解，如果弄不懂比特币背后的数学机制，不能确信双花的概率，我们又何来的对比特币系统安全性的信心。当然，如果诸位只是想要找个附属物安一个政治口号，宣扬一下自由主义的观念，再炒作和信仰一番，那就另当别论了。 我也看到了很多比较模糊、甚至与中本聪原意出入很大的说法。例如“比特币交易需要6个确认”：有人认为比特币一定要经过6个确认后，才算是交易成功；也有人认为经过6个区块的确认后，交易就不存在风险了。还有大家常常挂在嘴边的51%攻击：很多人认为，攻击的算力必须达到51%，或者必须多于50%，才能够攻击成功。但其实不是这样的。实际情况是，如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。 “6个确认”和“51%攻击”的说法由来以久，且传播深远。但如果你读完中本聪的原文，你会发现，比特币白皮书中压根就没有提到这两个词。他既没有说交易一定需要6个确认，也没有说必须拥有51%的算力才能成功发动攻击。甚至在中本聪给出的简化模型里，只需要50%的算力，不管人们采取多少个确认（1000个或者10000个），无限攻击成功的可能性为100%。严格意义来说，人们应该称51%攻击为50%攻击。 但50%攻击显然不符合人们的直觉，也不符合人们少数服从多数的政治期望。在日后布道者们的宣传中，为了让人们能够快速理解和接受这个概念，双花攻击最终被简化成了“51%”攻击。 本文作为一篇硬核科普，将从数学概率的角度澄清人们对“6个确认”和“51%攻击”的一些误解。内容主要分为双花攻击流程、双花成功概率分析、结论与不足。为了读懂本文，你最好掌握一些概率论的知识，主要是泊松分布（学过高数就行）；你也需要了解一下白皮书中提到的“赌徒破产模型”，它是我们理解“50%攻击”的关键。当然，如果你没有学过这些内容也无关紧要，因为它们背后的思想都简单易懂。尤其是“赌徒破产模型”，它看上去非常违背直觉，但很有趣。 双花攻击流程 最近钢铁佩奇比较火。为了让讲解过程不那么枯燥，请让我以钢铁佩奇为例来讲一讲这无聊而又致命的双花攻击。 引用电子货币领域经典的Alice和Bob交易例子，来说明比特币作为电子现金的三大难点及其解决方案。Alice想以1299元购买Bob的钢铁佩奇，Alice付款有2种方式，一是物理现金，二是电子转账。第二种方式实际上传递的是一个转账消息，电子消息充当了货币，其成功关键在于有银行判定Alice是否有足够的余额支付，并进行划扣，最终记录交易双方账户余额。 设想如果系统中没有中心的银行如何进行支付呢？这就是比特币想要解决的事情。 同样，Alice向Bob发送了一个电子消息“Alice给Bob转1299元。”想要使Bob相信这笔付款，起码要解决3个问题，证明此消息确实是Alice发送的（不可伪造性）、判断Alice确实有1299元（所有权证明），知道Alice没有同时支付给另一个人（双花）。 利用不对称加密算法，Alice使用私钥签名能够提供其资产所有权证明和保证交易的不可伪造性，这是比特币之前就已经很成熟的技术。 但是双花难题依旧没有解决，此前的电子货币方案一直依赖于引入中心第三方来解决，这相当于重造了一个中央银行，现实意义并不大。中本聪创造性地利用区块链作为公共账本和引入矿工竞争记账解决了这个问题，这也是比特币的伟大之处。 双花是指，Alice给Bob转钱的同时又给Charlie转了相同数目的一笔钱买手机。这时候Bob和Charlie查看自己的账本进行验证，发现Alice确实有1299元。他们无法得知Alice是否给其他人也转账了。于是，Alice拿走佩奇和手机，剩下Bob和Charlie只有一个人能得到1299元，这就是简单情形下的双花问题。中本聪引入矿工之后，Bob收到这笔付款通过交易验证后，并不会立马独自记账然后发货，他会广播这笔交易，让网络上多数人帮忙验证Alice是否只给自己转了这笔钱。假设Charlie也广播了这笔交易，那么最后只能有一笔交易记在公共账本上。通过分析可以知道，这种简单双花基本上是不可能实现的。其他矿工没动机帮Alice记假账（放入Alice给Bob和Charlie的两笔冲突交易）即使Alice竞争到了记账机会，广播区块之后，也会被其他矿工验证出两笔冲突交易存在。 以上情形是交易被Alice确认之前的简单双花问题，还有一种复杂的双花问题，Alice可以转给自己，同时制造分叉链最后代替主链完成双花，基本攻击流程是这样的。 在图（a）最后一个区块，Alice向全网广播“Alice给Bob转1299元” Alice修改自己的客户端程序，记入一笔“Alice给Alice转1299元”，同时悄悄挖矿，不广播自己的进度，挖出图（b）的白色链。 等到Bob看到全网主链（黑色链）有足够的确认区块个数（通常认为是6个，为什么？），发出钢铁佩奇之后，如果Alice的白链长于黑色主链，他会向全网公布自己的进度，从而被接受为新的主链。 主链只记录“Alice给Alice转1299元”，从而使得“Alice给Bob转1299元”无法记入账本。最终双花攻击成功，Alice拿到了钢铁佩奇，Bob一无所获。当然，Alice发起攻击是有成本的，他为了挖出白色链，需要投入矿机以及电力消耗，除非收益大于成本，否则理性攻击者是不会发起攻击的。余下全文，我们仅考虑在收款方等待z个确认之后，占全网算力q%的攻击者双花成功的概率。也就是说，不考虑攻击的经济可行性，仅仅分析攻击成功的概率大小。 双花成功概率分析 我们都学过如何求解应用题。第一部分交代了双花问题的背景，相当于告诉了我们“应用题”的条件，现在我们需要求解这道题。题目是：已知Alice占有全网算力比例为q，诚实节点占全网算力比例为p，p+q=1，Bob等待z个区块确认交易后，求解Alice使得自己偷偷挖的白链长度追上黑链（主链）的概率P（win）? 此问题还包含着以下假设：追赶时间内，系统难度值保持不变；攻击者Alice和诚实节点的算力相对比例不变。 求解追上概率可以拆解为两种情况来分析，第一情况是在等待z个区块确认的时间里，这段时间攻击者Alice挖出了k个区块，且k&gt;s即攻击链更长。这种情况下，一旦公开网络上最长链追加了n个区块，Bob就会认为交易已经确认，可以向Alice发出钢铁佩奇。而Alice一旦看到货已经发出，他就可以公布自己的白色链，由于白色链长于黑色，那么Alice记录的“Alice给Alice转1299元”交易记录留在主链上，双花成功。 另一种情况是，k&lt;=z，记n=z-k表示攻击链和诚实主链的差距。也就是说，在Bob确认交易的时候，Alice的白链短于主链，不足以发动攻击，他会继续偷偷挖，和主链竞争不断缩小差距，直到比主链长。 算出两种情况下概率再求和就是攻击成功概率了。 泊松分布—求Alice挖出k个区块的概率 以下按照中本聪的白皮书原文思路来推导，采用泊松分布假设，Meni Rosenfeld在“Analysis of hashrate-based double-spending”中采用更加精确的负二项分布，两个结果差异很小。 假设诚实节点按预期时间均匀出块，那么在诚实节点挖出Z个块的时间内，Alice挖出区块的平均值是： 泊松分布的概率函数为： 泊松分布用来描述单位时间内随机事件发生的次数。泊松分布的参数λ是单位时间(或单位面积)内随机事件的平均发生次数。 通过泊松分布，就可以知道k=1,2,3····的概率分别是多少，比如,这段时间Alice只挖到k=1个块的概率是P(k=1)=(λ^1 ⅇ^(-λ))/1!=λⅇ^(-λ) 那么第一种情况发生的概率就是 这个式子表示发生k=z+1,z+2,z+3····这些事件的概率之和。 赌徒破产问题 如果你看到了这里，恭喜。要么你就是一个脑子里还留了一点高等数学的人，对于读者来说这已经相当不易，欢迎在后台联系我；要么你对严谨枯燥内容的抗性已经超过了绝大多数人，这比前者还要难得。 我们现在需要对问题的另一半进行解答。但在讨论这一部分之前，你需要接受一个反直觉的例子：假使一个赌徒把自己的钱分成n份去赌场赌博，他输赢的概率为二分之一。如果这场赌博进行无限次，赌徒一定会输光自己身上所有的钱。 这就是大名鼎鼎的“赌徒破产问题”。这个问题的关键在于假设赌场手里的钱远多于赌徒，因而不需要考虑筹码归零的问题；而赌徒手里的钱远少于赌场，一旦某一次赌输，使筹码归零，便必须退出游戏。因此，虽然从单次赌博的概率上看上去，赌徒和赌场的游戏是平等的，但由于筹码的多少限制了赌徒和赌场游戏可以进行的区间，最终游戏的天平倒向了赌场。 这个问题规劝了那些赌博成瘾的人们。它说明了，就算游戏是公平的，但如果一个人执迷赌场以此为家，最后也将赔得精光。 这与攻击者和诚实节点又何其之像！攻击者只要区块数追平后超过诚实节点所挖的链，按照比特币“最长链”的原则，其他算力便会转移到节点数更高的新链上来，攻击成功。假设诚实节点们挖得的链长度超过攻击者k-z个，这就好比诚实节点作为赌徒手里有k-z个筹码。此时，诚实节点与攻击者同时进行着一场赌博的竞赛，一旦诚实节点将手中的筹码输干净，攻击者便能追上。（其实应该是输到剩下-1个，但中本聪的白皮书里的假设是输到0。其实，输到0仅仅是追平，但双花攻击需要超越，因此这个假设不太严谨，读者们见仁见智，可以做更深的讨论。我们暂时按照白皮书里的思路走。） 理解了这个比喻，让我们回到原来的话题。现在我们要求第二种情况下追上的概率，这种情况下，我们可以把问题进行简化，近似抽象成赌徒破产问题。已经知道，此时Alice挖出k个区块，比主链少n=k-z个。在既定的n个区块差距下，他们将竞赛挖矿，攻击者成功概率是q，诚实节点是p。放在数轴上考虑，每一局竞赛当攻击者赢，则向左一步，缩小差距为n-1，否则向右变为n+1。问多局博弈之后，Alice向左移到0的概率？ 我们可以先考虑n=1的时候移到n=0的概率。记p(1)表示从1移到0的概率，p(2)表示从2移到0的概率，依次类推求p(n)。 显然在1这个点，一局博弈之后，只有两种情况，向左到0，向右到2。然后从2移到0的概率为p(2).所以有以下方程: 结论 总结得到Alice追上概率为： 这也就是白皮书第11章最后给出的结论公式（见下图）。一些人用过这个公式，但我没能找到完整的推导过程。希望本文解答那些对此公式同样感到费解的朋友们的一些疑惑。 中本聪白皮书原文 在得出这个公式后，让我们回归文章开头的“6个确认”和“51%攻击”问题。 简单来说，这个公式可以总结为p(win)=f(q,z), 即双花成功的概率是攻击者算力比例q和收款者等待确认区块个数z的函数。给定q和z,就可以算出成功概率，以下是Meni Rosenfeld论文中根据此函数，给出的数据和图。 图中横轴表示q取不同值，不同曲线表示z不同，纵轴表示成功概率。 如图所示：当攻击者算力占比大于等于50%时，无线时常的攻击总能成功 &nbsp; 由以上结果，可以得出一些结论： 1、一般情形下，成功概率对z值呈指数下降，所以等待更多区块以后确认交易是保险的策略。 2、无论多大的确认数z也无法把成功概率降到0，做不到万无一失。 3、当攻击算力大于等于50%，不管多大的区块确认数也无法阻止双花成功。（关于50%攻击，请回想一下赌徒破产模型。其实，中本聪在白皮书中把情况二双花的要求退化成了“追上”。但就算我们把“追上”变成“超过”，即允许赌徒最后可以-1个，这依然改变不了什么。掌握了50%后，只要能够发动无限时长的攻击，就一定能够攻击成功。这就类似于，哪怕赌场愿意借一块钱给赌徒赌博，最后赌徒也无法避免破产的命运。） 至此，我们可以清楚明白，所谓“6个确认”是说，攻击算力在10%以下，等待6区块确认，双花成功的概率在0.1%以下。理论上讲，在任意小算力和任意大确认数下，成功概率非常小，但仍可能攻击成功。 不足 此模型有些地方并不精确。求解第二阶段概率时，把问题抽象成赌徒破产模型。诚实节点和攻击者是分别在两条链上各自挖矿竞争，假设攻击者先挖到了区块，那么此局结束，双方仍以p和q的概率开启下一局，诚实节点算新区块，攻击者继续算上一个区块。然而现实时攻击者虽然此局失败，但是他已经累积了一定工作量，他继续算出这个区块的概率比上一局算出的概率大。由此会对最终计算结果造成一定误差。 另外一点是本文没有讨论攻击者的攻击成本和收益的经济分析。 注：本文概率分析模型主要参考比特币白皮书、Meni Rosenfeld的“Analysis of hashrate-based double-spending”以及果壳的“从酒鬼失足到赌徒破产，悲剧收场为何注定”。 参考文献： Satoshi Nakamoto , ”Bitcoin: A Peer-to-Peer Electronic Cash System”,2009 Meni Rosenfeld,“Analysis of hashrate-based double-spending”, 2012 pondering，“从酒鬼失足到赌徒破产，悲剧收场为何注定”,果壳,2011 Zhangzedtv,”通过源码学习比特币-难度目标与难度调整” 2018 Michael Nielsen,”比特币协议是怎样工作的”,2014 W. Feller, &quot;An introduction to probability theory and its applications,&quot;1957 Tiny熊, ”比特币如何达成共识-最长链的选择” 2017 — END — 推荐阅读： 年度大戏！以太坊大神怒怼智能合约之父，尼克·萨博到底做错了啥？ 孟岩：区块链的原则与价值观 打破区块链不可能三角！2 华人专家论文将登 NSDI 2019 计算机顶会 鏖战九载，Google 是否会因 Oracle 而弃用 Java？ 小心！你的脸正在成为色情片主角 iPhone曝严重漏洞，用户接听FaceTime前或被“监听”！ 聊聊云计算：为什么构建网站时常会用到负载均衡 嫁人当嫁程序员 好文！点「好看」哟~" />
<link rel="canonical" href="https://mlh.app/2019/01/31/a5233a52fb535f9cf07745349e5f190a.html" />
<meta property="og:url" content="https://mlh.app/2019/01/31/a5233a52fb535f9cf07745349e5f190a.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-31T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"本文转自碳链价值 作者：白鱼 编辑：唐晗 在看此文之前，你一定要接受一件事：比特币是基于概率的产物。在看完此文之后，你最好明白：如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。这是本文的关键思想。 白皮书第11章计算很难懂？ 为纪念比特币十年，圈内最近掀起了一股重读比特币白皮书的热潮。然而，虽然很多文章都在感叹比特币的经济机制设计得如何精妙，但竟然少有能把白皮书第11章的双花攻击成功率的计算公式讲明白的。 作为一个刚入圈的新手，我实在无法理解，如果弄不懂比特币背后的数学机制，不能确信双花的概率，我们又何来的对比特币系统安全性的信心。当然，如果诸位只是想要找个附属物安一个政治口号，宣扬一下自由主义的观念，再炒作和信仰一番，那就另当别论了。 我也看到了很多比较模糊、甚至与中本聪原意出入很大的说法。例如“比特币交易需要6个确认”：有人认为比特币一定要经过6个确认后，才算是交易成功；也有人认为经过6个区块的确认后，交易就不存在风险了。还有大家常常挂在嘴边的51%攻击：很多人认为，攻击的算力必须达到51%，或者必须多于50%，才能够攻击成功。但其实不是这样的。实际情况是，如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。 “6个确认”和“51%攻击”的说法由来以久，且传播深远。但如果你读完中本聪的原文，你会发现，比特币白皮书中压根就没有提到这两个词。他既没有说交易一定需要6个确认，也没有说必须拥有51%的算力才能成功发动攻击。甚至在中本聪给出的简化模型里，只需要50%的算力，不管人们采取多少个确认（1000个或者10000个），无限攻击成功的可能性为100%。严格意义来说，人们应该称51%攻击为50%攻击。 但50%攻击显然不符合人们的直觉，也不符合人们少数服从多数的政治期望。在日后布道者们的宣传中，为了让人们能够快速理解和接受这个概念，双花攻击最终被简化成了“51%”攻击。 本文作为一篇硬核科普，将从数学概率的角度澄清人们对“6个确认”和“51%攻击”的一些误解。内容主要分为双花攻击流程、双花成功概率分析、结论与不足。为了读懂本文，你最好掌握一些概率论的知识，主要是泊松分布（学过高数就行）；你也需要了解一下白皮书中提到的“赌徒破产模型”，它是我们理解“50%攻击”的关键。当然，如果你没有学过这些内容也无关紧要，因为它们背后的思想都简单易懂。尤其是“赌徒破产模型”，它看上去非常违背直觉，但很有趣。 双花攻击流程 最近钢铁佩奇比较火。为了让讲解过程不那么枯燥，请让我以钢铁佩奇为例来讲一讲这无聊而又致命的双花攻击。 引用电子货币领域经典的Alice和Bob交易例子，来说明比特币作为电子现金的三大难点及其解决方案。Alice想以1299元购买Bob的钢铁佩奇，Alice付款有2种方式，一是物理现金，二是电子转账。第二种方式实际上传递的是一个转账消息，电子消息充当了货币，其成功关键在于有银行判定Alice是否有足够的余额支付，并进行划扣，最终记录交易双方账户余额。 设想如果系统中没有中心的银行如何进行支付呢？这就是比特币想要解决的事情。 同样，Alice向Bob发送了一个电子消息“Alice给Bob转1299元。”想要使Bob相信这笔付款，起码要解决3个问题，证明此消息确实是Alice发送的（不可伪造性）、判断Alice确实有1299元（所有权证明），知道Alice没有同时支付给另一个人（双花）。 利用不对称加密算法，Alice使用私钥签名能够提供其资产所有权证明和保证交易的不可伪造性，这是比特币之前就已经很成熟的技术。 但是双花难题依旧没有解决，此前的电子货币方案一直依赖于引入中心第三方来解决，这相当于重造了一个中央银行，现实意义并不大。中本聪创造性地利用区块链作为公共账本和引入矿工竞争记账解决了这个问题，这也是比特币的伟大之处。 双花是指，Alice给Bob转钱的同时又给Charlie转了相同数目的一笔钱买手机。这时候Bob和Charlie查看自己的账本进行验证，发现Alice确实有1299元。他们无法得知Alice是否给其他人也转账了。于是，Alice拿走佩奇和手机，剩下Bob和Charlie只有一个人能得到1299元，这就是简单情形下的双花问题。中本聪引入矿工之后，Bob收到这笔付款通过交易验证后，并不会立马独自记账然后发货，他会广播这笔交易，让网络上多数人帮忙验证Alice是否只给自己转了这笔钱。假设Charlie也广播了这笔交易，那么最后只能有一笔交易记在公共账本上。通过分析可以知道，这种简单双花基本上是不可能实现的。其他矿工没动机帮Alice记假账（放入Alice给Bob和Charlie的两笔冲突交易）即使Alice竞争到了记账机会，广播区块之后，也会被其他矿工验证出两笔冲突交易存在。 以上情形是交易被Alice确认之前的简单双花问题，还有一种复杂的双花问题，Alice可以转给自己，同时制造分叉链最后代替主链完成双花，基本攻击流程是这样的。 在图（a）最后一个区块，Alice向全网广播“Alice给Bob转1299元” Alice修改自己的客户端程序，记入一笔“Alice给Alice转1299元”，同时悄悄挖矿，不广播自己的进度，挖出图（b）的白色链。 等到Bob看到全网主链（黑色链）有足够的确认区块个数（通常认为是6个，为什么？），发出钢铁佩奇之后，如果Alice的白链长于黑色主链，他会向全网公布自己的进度，从而被接受为新的主链。 主链只记录“Alice给Alice转1299元”，从而使得“Alice给Bob转1299元”无法记入账本。最终双花攻击成功，Alice拿到了钢铁佩奇，Bob一无所获。当然，Alice发起攻击是有成本的，他为了挖出白色链，需要投入矿机以及电力消耗，除非收益大于成本，否则理性攻击者是不会发起攻击的。余下全文，我们仅考虑在收款方等待z个确认之后，占全网算力q%的攻击者双花成功的概率。也就是说，不考虑攻击的经济可行性，仅仅分析攻击成功的概率大小。 双花成功概率分析 我们都学过如何求解应用题。第一部分交代了双花问题的背景，相当于告诉了我们“应用题”的条件，现在我们需要求解这道题。题目是：已知Alice占有全网算力比例为q，诚实节点占全网算力比例为p，p+q=1，Bob等待z个区块确认交易后，求解Alice使得自己偷偷挖的白链长度追上黑链（主链）的概率P（win）? 此问题还包含着以下假设：追赶时间内，系统难度值保持不变；攻击者Alice和诚实节点的算力相对比例不变。 求解追上概率可以拆解为两种情况来分析，第一情况是在等待z个区块确认的时间里，这段时间攻击者Alice挖出了k个区块，且k&gt;s即攻击链更长。这种情况下，一旦公开网络上最长链追加了n个区块，Bob就会认为交易已经确认，可以向Alice发出钢铁佩奇。而Alice一旦看到货已经发出，他就可以公布自己的白色链，由于白色链长于黑色，那么Alice记录的“Alice给Alice转1299元”交易记录留在主链上，双花成功。 另一种情况是，k&lt;=z，记n=z-k表示攻击链和诚实主链的差距。也就是说，在Bob确认交易的时候，Alice的白链短于主链，不足以发动攻击，他会继续偷偷挖，和主链竞争不断缩小差距，直到比主链长。 算出两种情况下概率再求和就是攻击成功概率了。 泊松分布—求Alice挖出k个区块的概率 以下按照中本聪的白皮书原文思路来推导，采用泊松分布假设，Meni Rosenfeld在“Analysis of hashrate-based double-spending”中采用更加精确的负二项分布，两个结果差异很小。 假设诚实节点按预期时间均匀出块，那么在诚实节点挖出Z个块的时间内，Alice挖出区块的平均值是： 泊松分布的概率函数为： 泊松分布用来描述单位时间内随机事件发生的次数。泊松分布的参数λ是单位时间(或单位面积)内随机事件的平均发生次数。 通过泊松分布，就可以知道k=1,2,3····的概率分别是多少，比如,这段时间Alice只挖到k=1个块的概率是P(k=1)=(λ^1 ⅇ^(-λ))/1!=λⅇ^(-λ) 那么第一种情况发生的概率就是 这个式子表示发生k=z+1,z+2,z+3····这些事件的概率之和。 赌徒破产问题 如果你看到了这里，恭喜。要么你就是一个脑子里还留了一点高等数学的人，对于读者来说这已经相当不易，欢迎在后台联系我；要么你对严谨枯燥内容的抗性已经超过了绝大多数人，这比前者还要难得。 我们现在需要对问题的另一半进行解答。但在讨论这一部分之前，你需要接受一个反直觉的例子：假使一个赌徒把自己的钱分成n份去赌场赌博，他输赢的概率为二分之一。如果这场赌博进行无限次，赌徒一定会输光自己身上所有的钱。 这就是大名鼎鼎的“赌徒破产问题”。这个问题的关键在于假设赌场手里的钱远多于赌徒，因而不需要考虑筹码归零的问题；而赌徒手里的钱远少于赌场，一旦某一次赌输，使筹码归零，便必须退出游戏。因此，虽然从单次赌博的概率上看上去，赌徒和赌场的游戏是平等的，但由于筹码的多少限制了赌徒和赌场游戏可以进行的区间，最终游戏的天平倒向了赌场。 这个问题规劝了那些赌博成瘾的人们。它说明了，就算游戏是公平的，但如果一个人执迷赌场以此为家，最后也将赔得精光。 这与攻击者和诚实节点又何其之像！攻击者只要区块数追平后超过诚实节点所挖的链，按照比特币“最长链”的原则，其他算力便会转移到节点数更高的新链上来，攻击成功。假设诚实节点们挖得的链长度超过攻击者k-z个，这就好比诚实节点作为赌徒手里有k-z个筹码。此时，诚实节点与攻击者同时进行着一场赌博的竞赛，一旦诚实节点将手中的筹码输干净，攻击者便能追上。（其实应该是输到剩下-1个，但中本聪的白皮书里的假设是输到0。其实，输到0仅仅是追平，但双花攻击需要超越，因此这个假设不太严谨，读者们见仁见智，可以做更深的讨论。我们暂时按照白皮书里的思路走。） 理解了这个比喻，让我们回到原来的话题。现在我们要求第二种情况下追上的概率，这种情况下，我们可以把问题进行简化，近似抽象成赌徒破产问题。已经知道，此时Alice挖出k个区块，比主链少n=k-z个。在既定的n个区块差距下，他们将竞赛挖矿，攻击者成功概率是q，诚实节点是p。放在数轴上考虑，每一局竞赛当攻击者赢，则向左一步，缩小差距为n-1，否则向右变为n+1。问多局博弈之后，Alice向左移到0的概率？ 我们可以先考虑n=1的时候移到n=0的概率。记p(1)表示从1移到0的概率，p(2)表示从2移到0的概率，依次类推求p(n)。 显然在1这个点，一局博弈之后，只有两种情况，向左到0，向右到2。然后从2移到0的概率为p(2).所以有以下方程: 结论 总结得到Alice追上概率为： 这也就是白皮书第11章最后给出的结论公式（见下图）。一些人用过这个公式，但我没能找到完整的推导过程。希望本文解答那些对此公式同样感到费解的朋友们的一些疑惑。 中本聪白皮书原文 在得出这个公式后，让我们回归文章开头的“6个确认”和“51%攻击”问题。 简单来说，这个公式可以总结为p(win)=f(q,z), 即双花成功的概率是攻击者算力比例q和收款者等待确认区块个数z的函数。给定q和z,就可以算出成功概率，以下是Meni Rosenfeld论文中根据此函数，给出的数据和图。 图中横轴表示q取不同值，不同曲线表示z不同，纵轴表示成功概率。 如图所示：当攻击者算力占比大于等于50%时，无线时常的攻击总能成功 &nbsp; 由以上结果，可以得出一些结论： 1、一般情形下，成功概率对z值呈指数下降，所以等待更多区块以后确认交易是保险的策略。 2、无论多大的确认数z也无法把成功概率降到0，做不到万无一失。 3、当攻击算力大于等于50%，不管多大的区块确认数也无法阻止双花成功。（关于50%攻击，请回想一下赌徒破产模型。其实，中本聪在白皮书中把情况二双花的要求退化成了“追上”。但就算我们把“追上”变成“超过”，即允许赌徒最后可以-1个，这依然改变不了什么。掌握了50%后，只要能够发动无限时长的攻击，就一定能够攻击成功。这就类似于，哪怕赌场愿意借一块钱给赌徒赌博，最后赌徒也无法避免破产的命运。） 至此，我们可以清楚明白，所谓“6个确认”是说，攻击算力在10%以下，等待6区块确认，双花成功的概率在0.1%以下。理论上讲，在任意小算力和任意大确认数下，成功概率非常小，但仍可能攻击成功。 不足 此模型有些地方并不精确。求解第二阶段概率时，把问题抽象成赌徒破产模型。诚实节点和攻击者是分别在两条链上各自挖矿竞争，假设攻击者先挖到了区块，那么此局结束，双方仍以p和q的概率开启下一局，诚实节点算新区块，攻击者继续算上一个区块。然而现实时攻击者虽然此局失败，但是他已经累积了一定工作量，他继续算出这个区块的概率比上一局算出的概率大。由此会对最终计算结果造成一定误差。 另外一点是本文没有讨论攻击者的攻击成本和收益的经济分析。 注：本文概率分析模型主要参考比特币白皮书、Meni Rosenfeld的“Analysis of hashrate-based double-spending”以及果壳的“从酒鬼失足到赌徒破产，悲剧收场为何注定”。 参考文献： Satoshi Nakamoto , ”Bitcoin: A Peer-to-Peer Electronic Cash System”,2009 Meni Rosenfeld,“Analysis of hashrate-based double-spending”, 2012 pondering，“从酒鬼失足到赌徒破产，悲剧收场为何注定”,果壳,2011 Zhangzedtv,”通过源码学习比特币-难度目标与难度调整” 2018 Michael Nielsen,”比特币协议是怎样工作的”,2014 W. Feller, &quot;An introduction to probability theory and its applications,&quot;1957 Tiny熊, ”比特币如何达成共识-最长链的选择” 2017 — END — 推荐阅读： 年度大戏！以太坊大神怒怼智能合约之父，尼克·萨博到底做错了啥？ 孟岩：区块链的原则与价值观 打破区块链不可能三角！2 华人专家论文将登 NSDI 2019 计算机顶会 鏖战九载，Google 是否会因 Oracle 而弃用 Java？ 小心！你的脸正在成为色情片主角 iPhone曝严重漏洞，用户接听FaceTime前或被“监听”！ 聊聊云计算：为什么构建网站时常会用到负载均衡 嫁人当嫁程序员 好文！点「好看」哟~","@type":"BlogPosting","url":"https://mlh.app/2019/01/31/a5233a52fb535f9cf07745349e5f190a.html","headline":"钢铁佩奇手撕白皮书","dateModified":"2019-01-31T00:00:00+08:00","datePublished":"2019-01-31T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2019/01/31/a5233a52fb535f9cf07745349e5f190a.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>钢铁佩奇手撕白皮书</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="rich_media_content" id="js_content"> 
   <p style="min-height:1em;text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img class="__bg_gif" style="letter-spacing:.544px;text-align:center;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/trm5VMeFp9kib4ExJCQHupsiaCjFMxRGQUHjOZrrMuhgm8zibS8OhwX69xLlIThmZfokXLlHfKEqXWSricvMkSznCg/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/trm5VMeFp9l3sKlj5bdFZhcIJEqdgCjyelC3KyiciajmmELwcrg6NIVaCbROjTbflr1XgW5bqoMFDpBRwAUaGlZg/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <p style="min-height:1em;line-height:1.75em;letter-spacing:.5px;margin-left:8px;text-align:justify;"><span style="color:rgb(136,136,136);letter-spacing:.544px;font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;font-size:14px;">本文转自碳链价值</span></p>
   <p style="min-height:1em;line-height:1.75em;letter-spacing:.5px;margin-left:8px;text-align:justify;"><span style="color:rgb(136,136,136);font-size:14px;">作者：白鱼<br></span></p>
   <p style="min-height:1em;line-height:1.75em;letter-spacing:.5px;margin-left:8px;text-align:justify;"><span style="color:rgb(136,136,136);font-size:14px;">编辑：唐晗</span></p>
   <p style="margin-left:8px;min-height:1em;letter-spacing:.544px;"><br></p>
   <blockquote>
    <p style="min-height:1em;line-height:1.75em;letter-spacing:.5px;margin-left:8px;text-align:justify;"><span style="color:rgb(136,136,136);font-size:15px;letter-spacing:.544px;font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;">在看此文之前，你一定要接受一件事：比特币是基于概率的产物。在看完此文之后，你最好明白：如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。这是本文的关键思想。</span><br></p>
   </blockquote>
   <p style="margin-left:8px;min-height:1em;letter-spacing:.544px;"><br></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:16px;"><strong><br></strong></span></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:18px;color:rgb(0,122,170);"><strong>白皮书第11章计算很难懂？</strong></span></p>
   <p style="margin-left:8px;text-align:justify;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">为纪念比特币十年，圈内最近掀起了一股重读比特币白皮书的热潮。然而，虽然很多文章都在感叹比特币的经济机制设计得如何精妙，但竟然少有能把白皮书第11章的双花攻击成功率的计算公式讲明白的。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4e6fgnfTXIFWh5ia012ia46quZ9Bz9vTB82m0KFpiccjwvCQiaWsRXqXmgA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">作为一个刚入圈的新手，我实在无法理解，如果弄不懂比特币背后的数学机制，不能确信双花的概率，我们又何来的对比特币系统安全性的信心。当然，如果诸位只是想要找个附属物安一个政治口号，宣扬一下自由主义的观念，再炒作和信仰一番，那就另当别论了。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">我也看到了很多比较模糊、甚至与中本聪原意出入很大的说法。例如“比特币交易需要6个确认”：有人认为比特币一定要经过6个确认后，才算是交易成功；也有人认为经过6个区块的确认后，交易就不存在风险了。还有大家常常挂在嘴边的51%攻击：很多人认为，攻击的算力必须达到51%，或者必须多于50%，才能够攻击成功。但其实不是这样的。实际情况是，如果你拥有40%的算力，在人们采取6个确认的情况下，无限攻击成功的概率仍有50%。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">“6个确认”和“51%攻击”的说法由来以久，且传播深远。但如果你读完中本聪的原文，你会发现，比特币白皮书中压根就没有提到这两个词。他既没有说交易一定需要6个确认，也没有说必须拥有51%的算力才能成功发动攻击。甚至在中本聪给出的简化模型里，只需要50%的算力，不管人们采取多少个确认（1000个或者10000个），无限攻击成功的可能性为100%。严格意义来说，人们应该称51%攻击为50%攻击。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">但50%攻击显然不符合人们的直觉，也不符合人们少数服从多数的政治期望。在日后布道者们的宣传中，为了让人们能够快速理解和接受这个概念，双花攻击最终被简化成了“51%”攻击。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">本文作为一篇硬核科普，将从数学概率的角度澄清人们对“6个确认”和“51%攻击”的一些误解。内容主要分为双花攻击流程、双花成功概率分析、结论与不足。为了读懂本文，你最好掌握一些概率论的知识，主要是泊松分布（学过高数就行）；你也需要了解一下白皮书中提到的“赌徒破产模型”，它是我们理解“50%攻击”的关键。当然，如果你没有学过这些内容也无关紧要，因为它们背后的思想都简单易懂。尤其是“赌徒破产模型”，它看上去非常违背直觉，但很有趣。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:18px;color:rgb(0,122,170);">双花攻击流程</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">最近钢铁佩奇比较火。为了让讲解过程不那么枯燥，请让我以钢铁佩奇为例来讲一讲这无聊而又致命的双花攻击。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img style="width:556px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4S0KzYKEZGY6cP7f5aWt8t2QqCniaWelOUOqPI3ec6xLDa6Z1lqyenSw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;">引用电子货币领域经典的Alice和Bob交易例子，来说明比特币作为电子现金的三大难点及其解决方案。Alice想以1299元购买Bob的钢铁佩奇，Alice付款有2种方式，一是物理现金，二是电子转账。第二种方式实际上传递的是一个转账消息，<strong>电子消息充当了货币，其成功关键在于有银行判定Alice是否有足够的余额支付，并进行划扣，最终记录交易双方账户余额。</strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">设想如果系统中没有中心的银行如何进行支付呢？这就是比特币想要解决的事情。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">同样，Alice向Bob发送了一个电子消息“Alice给Bob转1299元。”想要使Bob相信这笔付款，<strong>起码要解决3个问题，证明此消息确实是Alice发送的（不可伪造性）、判断Alice确实有1299元（所有权证明），知道Alice没有同时支付给另一个人（双花）。</strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">利用不对称加密算法，Alice使用私钥签名能够提供其资产所有权证明和保证交易的不可伪造性，这是比特币之前就已经很成熟的技术。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">但是双花难题依旧没有解决，此前的电子货币方案一直依赖于引入中心第三方来解决，这相当于重造了一个中央银行，现实意义并不大。中本聪创造性地利用区块链作为公共账本和引入矿工竞争记账解决了这个问题，这也是比特币的伟大之处。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">双花是指，Alice给Bob转钱的同时又给Charlie转了相同数目的一笔钱买手机。这时候Bob和Charlie查看自己的账本进行验证，发现Alice确实有1299元。他们无法得知Alice是否给其他人也转账了。于是，Alice拿走佩奇和手机，剩下Bob和Charlie只有一个人能得到1299元，这就是简单情形下的双花问题。中本聪引入矿工之后，Bob收到这笔付款通过交易验证后，并不会立马独自记账然后发货，他会广播这笔交易，让网络上多数人帮忙验证Alice是否只给自己转了这笔钱。假设Charlie也广播了这笔交易，那么最后只能有一笔交易记在公共账本上。通过分析可以知道，这种简单双花基本上是不可能实现的。其他矿工没动机帮Alice记假账（放入Alice给Bob和Charlie的两笔冲突交易）即使Alice竞争到了记账机会，广播区块之后，也会被其他矿工验证出两笔冲突交易存在。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">以上情形是交易被Alice确认之前的简单双花问题，还有一种复杂的双花问题，Alice可以转给自己，同时制造分叉链最后代替主链完成双花，基本攻击流程是这样的。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <ol class="list-paddingleft-2" style="list-style-type:decimal;margin-left:8px;">
    <li><p style="margin-left:8px;text-align:justify;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;">在图（a）最后一个区块，Alice向全网广播“Alice给Bob转1299元”</span></p></li>
    <li><p style="margin-left:8px;text-align:justify;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;">Alice修改自己的客户端程序，记入一笔“Alice给Alice转1299元”，同时悄悄挖矿，不广播自己的进度，挖出图（b）的白色链。</span></p></li>
    <li><p style="margin-left:8px;text-align:justify;line-height:1.75em;letter-spacing:.5px;"><span style="font-size:15px;">等到Bob看到全网主链（黑色链）有足够的确认区块个数（通常认为是6个，为什么？），发出钢铁佩奇之后，如果Alice的白链长于黑色主链，他会向全网公布自己的进度，从而被接受为新的主链。</span></p></li>
   </ol>
   <p style="margin-left:8px;text-align:justify;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4UceuaialUeicb5xSkUGl7P4xsSY6TJ4S3oWbsXbvdx6F1sQpUAhKia0lQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">主链只记录“Alice给Alice转1299元”，从而使得“Alice给Bob转1299元”无法记入账本。最终双花攻击成功，Alice拿到了钢铁佩奇，Bob一无所获。当然，Alice发起攻击是有成本的，他为了挖出白色链，需要投入矿机以及电力消耗，除非收益大于成本，否则理性攻击者是不会发起攻击的。余下全文，我们仅考虑在收款方等待z个确认之后，占全网算力q%的攻击者双花成功的概率。也就是说，不考虑攻击的经济可行性，仅仅分析攻击成功的概率大小。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:18px;color:rgb(0,122,170);"><strong>双花成功概率分析</strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;">我们都学过如何求解应用题。第一部分交代了双花问题的背景，相当于告诉了我们“应用题”的条件，现在我们需要求解这道题。题目是：已知Alice占有全网算力比例为q，诚实节点占全网算力比例为p，p+q=1，Bob等待z个区块确认交易后，求解Alice使得自己偷偷挖的白链长度追上黑链（主链）的概率P（win）?</span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">此问题还包含着以下假设：追赶时间内，系统难度值保持不变；攻击者Alice和诚实节点的算力相对比例不变。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4Z1QetVSIxeslcvXFCd0nEvvsTeeBXsiaGGr65c3bWeKJf0bBL706icjg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">求解追上概率可以拆解为两种情况来分析，第一情况是在等待z个区块确认的时间里，这段时间攻击者Alice挖出了k个区块，且k&gt;s即攻击链更长。这种情况下，一旦公开网络上最长链追加了n个区块，Bob就会认为交易已经确认，可以向Alice发出钢铁佩奇。而Alice一旦看到货已经发出，他就可以公布自己的白色链，由于白色链长于黑色，那么Alice记录的“Alice给Alice转1299元”交易记录留在主链上，双花成功。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">另一种情况是，k&lt;=z，记n=z-k表示攻击链和诚实主链的差距。也就是说，在Bob确认交易的时候，Alice的白链短于主链，不足以发动攻击，他会继续偷偷挖，和主链竞争不断缩小差距，直到比主链长。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">算出两种情况下概率再求和就是攻击成功概率了。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:16px;color:rgb(0,122,170);">泊松分布—求Alice挖出k个区块的概率</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">以下按照中本聪的白皮书原文思路来推导，采用泊松分布假设，Meni Rosenfeld在“Analysis of hashrate-based double-spending”中采用更加精确的负二项分布，两个结果差异很小。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">假设诚实节点按预期时间均匀出块，那么在诚实节点挖出Z个块的时间内，Alice挖出区块的平均值是：</span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img style="width:264px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_jpg/trm5VMeFp9l3sKlj5bdFZhcIJEqdgCjypnvWO3ZhfSHKOSOCYU6HDxw6Pt7oZSQmJHgShOicCaUv4ibbKYtlZFvA/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">泊松分布的概率函数为：</span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4AtfVjEL9urMRgaFBOapaKLv45cRUARZYoKn98wfLEffB7gFsBribVYA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">泊松分布用来描述单位时间内随机事件发生的次数。泊松分布的参数λ是单位时间(或单位面积)内随机事件的平均发生次数。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">通过泊松分布，就可以知道k=1,2,3····的概率分别是多少，比如,这段时间Alice只挖到k=1个块的概率是P(k=1)=(λ^1 ⅇ^(-λ))/1!=λⅇ^(-λ)</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">那么第一种情况发生的概率就是</span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4AmnFJ3x4MuNMStwW5B7wuMvLtzjp5b9xjv3Ftl8yXAxGbibQIzaOv0w/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">这个式子表示发生k=z+1,z+2,z+3····这些事件的概率之和。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:18px;"><strong><span style="color:rgb(0,122,170);">赌徒破产问题</span></strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">如果你看到了这里，恭喜。要么你就是一个脑子里还留了一点高等数学的人，对于读者来说这已经相当不易，欢迎在后台联系我；要么你对严谨枯燥内容的抗性已经超过了绝大多数人，这比前者还要难得。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">我们现在需要对问题的另一半进行解答。但在讨论这一部分之前，你需要接受一个反直觉的例子：<strong>假使一个赌徒把自己的钱分成n份去赌场赌博，他输赢的概率为二分之一。如果这场赌博进行无限次，赌徒一定会输光自己身上所有的钱。</strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">这就是大名鼎鼎的“赌徒破产问题”。这个问题的关键在于假设赌场手里的钱远多于赌徒，因而不需要考虑筹码归零的问题；而赌徒手里的钱远少于赌场，一旦某一次赌输，使筹码归零，便必须退出游戏。因此，虽然从单次赌博的概率上看上去，赌徒和赌场的游戏是平等的，但由于筹码的多少限制了赌徒和赌场游戏可以进行的区间，最终游戏的天平倒向了赌场。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">这个问题规劝了那些赌博成瘾的人们。它说明了，就算游戏是公平的，但如果一个人执迷赌场以此为家，最后也将赔得精光。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">这与攻击者和诚实节点又何其之像！攻击者只要区块数追平后超过诚实节点所挖的链，按照比特币“最长链”的原则，其他算力便会转移到节点数更高的新链上来，攻击成功。假设诚实节点们挖得的链长度超过攻击者k-z个，这就好比诚实节点作为赌徒手里有k-z个筹码。此时，诚实节点与攻击者同时进行着一场赌博的竞赛，一旦诚实节点将手中的筹码输干净，攻击者便能追上。<strong>（其实应该是输到剩下-1个，但中本聪的白皮书里的假设是输到0。其实，输到0仅仅是追平，但双花攻击需要超越，因此这个假设不太严谨，读者们见仁见智，可以做更深的讨论。我们暂时按照白皮书里的思路走。）</strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">理解了这个比喻，让我们回到原来的话题。现在我们要求第二种情况下追上的概率，这种情况下，我们可以把问题进行简化，近似抽象成赌徒破产问题。已经知道，此时Alice挖出k个区块，比主链少n=k-z个。在既定的n个区块差距下，他们将竞赛挖矿，攻击者成功概率是q，诚实节点是p。放在数轴上考虑，每一局竞赛当攻击者赢，则向左一步，缩小差距为n-1，否则向右变为n+1。问多局博弈之后，Alice向左移到0的概率？</span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4FKsNnHVca0zIIMibibZqqzz0PP0CQAZmnPic9B6tmkRI9KqHhsmiagOQrA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">我们可以先考虑n=1的时候移到n=0的概率。记p(1)表示从1移到0的概率，p(2)表示从2移到0的概率，依次类推求p(n)。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">显然在1这个点，一局博弈之后，只有两种情况，向左到0，向右到2。然后从2移到0的概率为p(2).所以有以下方程:</span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4lSGDqMWrd27pxJGQibiaD747KIxtSDiaa9dBBWSeSPAtickQsEBO8wr0Vw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4yT9QA3D2G2BMUTricXVPtIxgSSWzfwRiaQDW2yn7kORUpwz3jK2sS2Sw/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4KcBCS2Gdf6N8s9Zn7jn8DXYdUMytNlhvuGeHJUP6utMhXuFeKY7ib4A/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="margin-left:8px;"><br></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:18px;color:rgb(0,122,170);"><strong>结论</strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">总结得到Alice追上概率为：</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img style="width:540px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4CQINlglqvDPmgKbHARYkXvGEpiafWlI3dgibIWuu3EX0Un9WpqOY24dg/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">这也就是白皮书第11章最后给出的结论公式（见下图）。一些人用过这个公式，但我没能找到完整的推导过程。希望本文解答那些对此公式同样感到费解的朋友们的一些疑惑。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4u9XC8ufLFXnPRvnYibyZX7WNFZbQdQNeQQj0ic9WoOeRAcwTvgR5hLnA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="color:rgb(136,136,136);font-size:13px;">中本聪白皮书原文</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">在得出这个公式后，让我们回归文章开头的“6个确认”和“51%攻击”问题。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">简单来说，这个公式可以总结为p(win)=f(q,z), 即双花成功的概率是攻击者算力比例q和收款者等待确认区块个数z的函数。给定q和z,就可以算出成功概率，以下是Meni Rosenfeld论文中根据此函数，给出的数据和图。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">图中横轴表示q取不同值，不同曲线表示z不同，纵轴表示成功概率。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4upFJPENiaH7iaO5LhiaicWs3URJ8OFyUfWhPhAIUBZUqIfAJQl8hLyPloA/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;font-size:13px;color:rgb(136,136,136);">如图所示：当攻击者算力占比大于等于50%时，无线时常的攻击总能成功</span><br><span style="font-size:15px;"></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">&nbsp;</span></p>
   <p style="text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><img src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/ockBglTNBdQ4uYIM5stuu6Lw22p8IDm4UvibK1ByhicklcVFhhNEsXECMUrWWkIxSvQeT6MdZQB8DQw7qdumpibjQ/640?wx_fmt=png" alt="640?wx_fmt=png"></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">由以上结果，可以得出一些结论：</span><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;">1、一般情形下，成功概率对z值呈指数下降，所以等待更多区块以后确认交易是保险的策略。</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;"><br></span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;">2、无论多大的确认数z也无法把成功概率降到0，做不到万无一失。</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;"><br></span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;">3、当攻击算力大于等于50%，不管多大的区块确认数也无法阻止双花成功。</span></strong><span style="font-size:15px;">（关于50%攻击，请回想一下赌徒破产模型。其实，中本聪在白皮书中把情况二双花的要求退化成了“追上”。但就算我们把“追上”变成“超过”，即允许赌徒最后可以-1个，这依然改变不了什么。掌握了50%后，只要能够发动无限时长的攻击，就一定能够攻击成功。这就类似于，哪怕赌场愿意借一块钱给赌徒赌博，最后赌徒也无法避免破产的命运。）</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;">至此，我们可以清楚明白，所谓“6个确认”是说，攻击算力在10%以下，等待6区块确认，双花成功的概率在0.1%以下。理论上讲，在任意小算力和任意大确认数下，成功概率非常小，但仍可能攻击成功。</span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;"><br></span></strong></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="font-size:15px;"><br></span></strong></p>
   <p style="min-height:1em;font-size:16px;color:rgb(62,62,62);text-align:center;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:18px;color:rgb(0,122,170);"><strong><strong>不足</strong></strong></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><br></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">此模型有些地方并不精确。求解第二阶段概率时，把问题抽象成赌徒破产模型。诚实节点和攻击者是分别在两条链上各自挖矿竞争，假设攻击者先挖到了区块，那么此局结束，双方仍以p和q的概率开启下一局，诚实节点算新区块，攻击者继续算上一个区块。然而现实时攻击者虽然此局失败，但是他已经累积了一定工作量，他继续算出这个区块的概率比上一局算出的概率大。由此会对最终计算结果造成一定误差。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;">另外一点是本文没有讨论攻击者的攻击成本和收益的经济分析。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(136,136,136);">注：本文概率分析模型主要参考比特币白皮书、Meni Rosenfeld的“Analysis of hashrate-based double-spending”以及果壳的“从酒鬼失足到赌徒破产，悲剧收场为何注定”。</span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><span class="vote_area"><span class="vote_box skin_help po_left"></span><span class="vote_box skin_help po_right"></span></span></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;"><br></span></p>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><strong><span style="color:rgb(63,63,63);font-size:15px;">参考文献：</span></strong></p>
   <ul class="list-paddingleft-2" style="list-style-type:disc;">
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">Satoshi Nakamoto , ”Bitcoin: A Peer-to-Peer Electronic Cash System”,2009</span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">Meni Rosenfeld,“Analysis of hashrate-based double-spending”, 2012</span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">pondering，“从酒鬼失足到赌徒破产，悲剧收场为何注定”,果壳,2011</span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">Zhangzedtv,”通过源码学习比特币-难度目标与难度调整” 2018</span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">Michael Nielsen,”比特币协议是怎样工作的”,2014</span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">W. Feller, "An introduction to probability theory and its applications,"1957</span></p></li>
    <li><p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);">Tiny熊, ”比特币如何达成共识-最长链的选择” 2017</span></p></li>
   </ul>
   <p style="text-align:justify;line-height:1.75em;letter-spacing:.5px;margin-left:8px;"><span style="font-size:15px;color:rgb(63,63,63);"><br></span></p>
   <p style="margin-left:8px;text-align:center;"><strong style="letter-spacing:.5px;color:rgb(63,63,63);"><span style="font-size:15px;">— END —</span></strong></p>
   <p style="margin-left:8px;text-align:center;"><img class="__bg_gif" style="font-family:'微软雅黑';font-size:16px;letter-spacing:.5px;line-height:28px;" width="512" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/trm5VMeFp9kegUbp0DLNf5dM2JbggFlThJvvibDiaEicHicPaTJV6oOMMWYZynQZcNupmQJIbPAdlVhT8PeicsKaFMQ/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p>
   <p style="margin-left:8px;min-height:1em;letter-spacing:.5px;"><br></p>
   <p style="margin-left:8px;min-height:1em;letter-spacing:.5px;"><strong style="color:rgb(63,63,63);"><span style="font-size:15px;">推荐阅读：</span></strong><br></p>
   <p style="margin-left:8px;min-height:1em;letter-spacing:.5px;"><br></p>
   <ul class="list-paddingleft-2" style="list-style-type:circle;margin-left:8px;">
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a href="https://blog.csdn.net/Blockchain_lemon/article/details/86710294" rel="nofollow">年度大戏！以太坊大神怒怼智能合约之父，尼克·萨博到底做错了啥？</a></span><br></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a href="https://blog.csdn.net/Blockchain_lemon/article/details/86697880" rel="nofollow">孟岩：区块链的原则与价值观</a></span></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><a href="https://blog.csdn.net/Blockchain_lemon/article/details/86684679" rel="nofollow">打破区块链不可能三角！2 华人专家论文将登 NSDI 2019 计算机顶会</a></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a href="https://blog.csdn.net/csdnnews/article/details/86710261" rel="nofollow">鏖战九载，Google 是否会因 Oracle 而弃用 Java？</a></span><br></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a target="_blank" href="https://blog.csdn.net/csdnsevenn/article/details/86710219" rel="nofollow">小心！你的脸正在成为色情片主角</a></span><br></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a href="https://blog.csdn.net/dQCFKyQDXYm3F8rB0/article/details/86710157" rel="nofollow">iPhone曝严重漏洞，用户接听FaceTime前或被“监听”！</a></span><br></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a target="_blank" href="https://blog.csdn.net/FL63Zv9Zou86950w/article/details/86710193" rel="nofollow">聊聊云计算：为什么构建网站时常会用到负载均衡</a></span><br></p></li>
    <li><p style="min-height:1em;line-height:1.5em;letter-spacing:.5px;text-align:left;"><span style="font-size:15px;"><a href="https://blog.csdn.net/csdnsevenn/article/details/78383365" rel="nofollow">嫁人当嫁程序员</a></span></p></li>
   </ul>
   <p style="margin-left:8px;min-height:1em;border-width:0px;border-style:none;"><br></p>
   <span style="font-size:15px;color:rgb(0,122,170);"><strong>好文！点<span style="font-family:'Helvetica Neue', Helvetica, Arial, 'Lucida Grande', sans-serif;">「</span>好看<span style="font-family:'Helvetica Neue', Helvetica, Arial, 'Lucida Grande', sans-serif;">」哟~</span></strong></span>
  </div> 
 </div> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
