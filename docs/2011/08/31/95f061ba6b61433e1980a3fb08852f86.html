<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>ASP MD5 16位和32位加密实现 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="ASP MD5 16位和32位加密实现" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="&lt;% Private Const BITS_TO_A_BYTE = 8 Private Const BYTES_TO_A_WORD = 4 Private Const BITS_TO_A_WORD = 32 Private m_lOnBits(30) Private m_l2Power(30) Private Function LShift(lValue, iShiftBits) If iShiftBits = 0 Then LShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And 1 Then LShift = &amp;H80000000 Else LShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If If (lValue And m_l2Power(31 - iShiftBits)) Then LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &amp;H80000000 Else LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits)) End If End Function Private Function RShift(lValue, iShiftBits) If iShiftBits = 0 Then RShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And &amp;H80000000 Then RShift = 1 Else RShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If RShift = (lValue And &amp;H7FFFFFFE) \ m_l2Power(iShiftBits) If (lValue And &amp;H80000000) Then RShift = (RShift Or (&amp;H40000000 \ m_l2Power(iShiftBits - 1))) End If End Function Private Function RotateLeft(lValue, iShiftBits) RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits)) End Function Private Function AddUnsigned(lX, lY) Dim lX4 Dim lY4 Dim lX8 Dim lY8 Dim lResult lX8 = lX And &amp;H80000000 lY8 = lY And &amp;H80000000 lX4 = lX And &amp;H40000000 lY4 = lY And &amp;H40000000 lResult = (lX And &amp;H3FFFFFFF) + (lY And &amp;H3FFFFFFF) If lX4 And lY4 Then lResult = lResult Xor &amp;H80000000 Xor lX8 Xor lY8 ElseIf lX4 Or lY4 Then If lResult And &amp;H40000000 Then lResult = lResult Xor &amp;HC0000000 Xor lX8 Xor lY8 Else lResult = lResult Xor &amp;H40000000 Xor lX8 Xor lY8 End If Else lResult = lResult Xor lX8 Xor lY8 End If AddUnsigned = lResult End Function Private Function md5_F(x, y, z) md5_F = (x And y) Or ((Not x) And z) End Function Private Function md5_G(x, y, z) md5_G = (x And z) Or (y And (Not z)) End Function Private Function md5_H(x, y, z) md5_H = (x Xor y Xor z) End Function Private Function md5_I(x, y, z) md5_I = (y Xor (x Or (Not z))) End Function Private Sub md5_FF(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_F(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_GG(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_G(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_HH(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_H(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_II(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_I(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Function ConvertToWordArray(sMessage) Dim lMessageLength Dim lNumberOfWords Dim lWordArray() Dim lBytePosition Dim lByteCount Dim lWordCount Const MODULUS_BITS = 512 Const CONGRUENT_BITS = 448 lMessageLength = Len(sMessage) lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \ BITS_TO_A_BYTE)) \ (MODULUS_BITS \ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \ BITS_TO_A_WORD) ReDim lWordArray(lNumberOfWords - 1) lBytePosition = 0 lByteCount = 0 Do Until lByteCount &gt;= lMessageLength lWordCount = lByteCount \ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition) lByteCount = lByteCount + 1 Loop lWordCount = lByteCount \ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&amp;H80, lBytePosition) lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3) lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29) ConvertToWordArray = lWordArray End Function Private Function WordToHex(lValue) Dim lByte Dim lCount For lCount = 0 To 3 lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1) WordToHex = WordToHex &amp; Right(&quot;0&quot; &amp; Hex(lByte), 2) Next End Function Public Function MD5(sMessage) m_lOnBits(0) = CLng(1) m_lOnBits(1) = CLng(3) m_lOnBits(2) = CLng(7) m_lOnBits(3) = CLng(15) m_lOnBits(4) = CLng(31) m_lOnBits(5) = CLng(63) m_lOnBits(6) = CLng(127) m_lOnBits(7) = CLng(255) m_lOnBits(8) = CLng(511) m_lOnBits(9) = CLng(1023) m_lOnBits(10) = CLng(2047) m_lOnBits(11) = CLng(4095) m_lOnBits(12) = CLng(8191) m_lOnBits(13) = CLng(16383) m_lOnBits(14) = CLng(32767) m_lOnBits(15) = CLng(65535) m_lOnBits(16) = CLng(131071) m_lOnBits(17) = CLng(262143) m_lOnBits(18) = CLng(524287) m_lOnBits(19) = CLng(1048575) m_lOnBits(20) = CLng(2097151) m_lOnBits(21) = CLng(4194303) m_lOnBits(22) = CLng(8388607) m_lOnBits(23) = CLng(16777215) m_lOnBits(24) = CLng(33554431) m_lOnBits(25) = CLng(67108863) m_lOnBits(26) = CLng(134217727) m_lOnBits(27) = CLng(268435455) m_lOnBits(28) = CLng(536870911) m_lOnBits(29) = CLng(1073741823) m_lOnBits(30) = CLng(2147483647) m_l2Power(0) = CLng(1) m_l2Power(1) = CLng(2) m_l2Power(2) = CLng(4) m_l2Power(3) = CLng(8) m_l2Power(4) = CLng(16) m_l2Power(5) = CLng(32) m_l2Power(6) = CLng(64) m_l2Power(7) = CLng(128) m_l2Power(8) = CLng(256) m_l2Power(9) = CLng(512) m_l2Power(10) = CLng(1024) m_l2Power(11) = CLng(2048) m_l2Power(12) = CLng(4096) m_l2Power(13) = CLng(8192) m_l2Power(14) = CLng(16384) m_l2Power(15) = CLng(32768) m_l2Power(16) = CLng(65536) m_l2Power(17) = CLng(131072) m_l2Power(18) = CLng(262144) m_l2Power(19) = CLng(524288) m_l2Power(20) = CLng(1048576) m_l2Power(21) = CLng(2097152) m_l2Power(22) = CLng(4194304) m_l2Power(23) = CLng(8388608) m_l2Power(24) = CLng(16777216) m_l2Power(25) = CLng(33554432) m_l2Power(26) = CLng(67108864) m_l2Power(27) = CLng(134217728) m_l2Power(28) = CLng(268435456) m_l2Power(29) = CLng(536870912) m_l2Power(30) = CLng(1073741824) Dim x Dim k Dim AA Dim BB Dim CC Dim DD Dim a Dim b Dim c Dim d Const S11 = 7 Const S12 = 12 Const S13 = 17 Const S14 = 22 Const S21 = 5 Const S22 = 9 Const S23 = 14 Const S24 = 20 Const S31 = 4 Const S32 = 11 Const S33 = 16 Const S34 = 23 Const S41 = 6 Const S42 = 10 Const S43 = 15 Const S44 = 21 x = ConvertToWordArray(sMessage) a = &amp;H67452301 b = &amp;HEFCDAB89 c = &amp;H98BADCFE d = &amp;H10325476 For k = 0 To UBound(x) Step 16 AA = a BB = b CC = c DD = d md5_FF a, b, c, d, x(k + 0), S11, &amp;HD76AA478 md5_FF d, a, b, c, x(k + 1), S12, &amp;HE8C7B756 md5_FF c, d, a, b, x(k + 2), S13, &amp;H242070DB md5_FF b, c, d, a, x(k + 3), S14, &amp;HC1BDCEEE md5_FF a, b, c, d, x(k + 4), S11, &amp;HF57C0FAF md5_FF d, a, b, c, x(k + 5), S12, &amp;H4787C62A md5_FF c, d, a, b, x(k + 6), S13, &amp;HA8304613 md5_FF b, c, d, a, x(k + 7), S14, &amp;HFD469501 md5_FF a, b, c, d, x(k + 8), S11, &amp;H698098D8 md5_FF d, a, b, c, x(k + 9), S12, &amp;H8B44F7AF md5_FF c, d, a, b, x(k + 10), S13, &amp;HFFFF5BB1 md5_FF b, c, d, a, x(k + 11), S14, &amp;H895CD7BE md5_FF a, b, c, d, x(k + 12), S11, &amp;H6B901122 md5_FF d, a, b, c, x(k + 13), S12, &amp;HFD987193 md5_FF c, d, a, b, x(k + 14), S13, &amp;HA679438E md5_FF b, c, d, a, x(k + 15), S14, &amp;H49B40821 md5_GG a, b, c, d, x(k + 1), S21, &amp;HF61E2562 md5_GG d, a, b, c, x(k + 6), S22, &amp;HC040B340 md5_GG c, d, a, b, x(k + 11), S23, &amp;H265E5A51 md5_GG b, c, d, a, x(k + 0), S24, &amp;HE9B6C7AA md5_GG a, b, c, d, x(k + 5), S21, &amp;HD62F105D md5_GG d, a, b, c, x(k + 10), S22, &amp;H2441453 md5_GG c, d, a, b, x(k + 15), S23, &amp;HD8A1E681 md5_GG b, c, d, a, x(k + 4), S24, &amp;HE7D3FBC8 md5_GG a, b, c, d, x(k + 9), S21, &amp;H21E1CDE6 md5_GG d, a, b, c, x(k + 14), S22, &amp;HC33707D6 md5_GG c, d, a, b, x(k + 3), S23, &amp;HF4D50D87 md5_GG b, c, d, a, x(k + 8), S24, &amp;H455A14ED md5_GG a, b, c, d, x(k + 13), S21, &amp;HA9E3E905 md5_GG d, a, b, c, x(k + 2), S22, &amp;HFCEFA3F8 md5_GG c, d, a, b, x(k + 7), S23, &amp;H676F02D9 md5_GG b, c, d, a, x(k + 12), S24, &amp;H8D2A4C8A md5_HH a, b, c, d, x(k + 5), S31, &amp;HFFFA3942 md5_HH d, a, b, c, x(k + 8), S32, &amp;H8771F681 md5_HH c, d, a, b, x(k + 11), S33, &amp;H6D9D6122 md5_HH b, c, d, a, x(k + 14), S34, &amp;HFDE5380C md5_HH a, b, c, d, x(k + 1), S31, &amp;HA4BEEA44 md5_HH d, a, b, c, x(k + 4), S32, &amp;H4BDECFA9 md5_HH c, d, a, b, x(k + 7), S33, &amp;HF6BB4B60 md5_HH b, c, d, a, x(k + 10), S34, &amp;HBEBFBC70 md5_HH a, b, c, d, x(k + 13), S31, &amp;H289B7EC6 md5_HH d, a, b, c, x(k + 0), S32, &amp;HEAA127FA md5_HH c, d, a, b, x(k + 3), S33, &amp;HD4EF3085 md5_HH b, c, d, a, x(k + 6), S34, &amp;H4881D05 md5_HH a, b, c, d, x(k + 9), S31, &amp;HD9D4D039 md5_HH d, a, b, c, x(k + 12), S32, &amp;HE6DB99E5 md5_HH c, d, a, b, x(k + 15), S33, &amp;H1FA27CF8 md5_HH b, c, d, a, x(k + 2), S34, &amp;HC4AC5665 md5_II a, b, c, d, x(k + 0), S41, &amp;HF4292244 md5_II d, a, b, c, x(k + 7), S42, &amp;H432AFF97 md5_II c, d, a, b, x(k + 14), S43, &amp;HAB9423A7 md5_II b, c, d, a, x(k + 5), S44, &amp;HFC93A039 md5_II a, b, c, d, x(k + 12), S41, &amp;H655B59C3 md5_II d, a, b, c, x(k + 3), S42, &amp;H8F0CCC92 md5_II c, d, a, b, x(k + 10), S43, &amp;HFFEFF47D md5_II b, c, d, a, x(k + 1), S44, &amp;H85845DD1 md5_II a, b, c, d, x(k + 8), S41, &amp;H6FA87E4F md5_II d, a, b, c, x(k + 15), S42, &amp;HFE2CE6E0 md5_II c, d, a, b, x(k + 6), S43, &amp;HA3014314 md5_II b, c, d, a, x(k + 13), S44, &amp;H4E0811A1 md5_II a, b, c, d, x(k + 4), S41, &amp;HF7537E82 md5_II d, a, b, c, x(k + 11), S42, &amp;HBD3AF235 md5_II c, d, a, b, x(k + 2), S43, &amp;H2AD7D2BB md5_II b, c, d, a, x(k + 9), S44, &amp;HEB86D391 a = AddUnsigned(a, AA) b = AddUnsigned(b, BB) c = AddUnsigned(c, CC) d = AddUnsigned(d, DD) Next &#39;MD5=LCase(WordToHex(b) &amp; WordToHex(c)) &#39;16位 MD5 = LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d)) &#39;32位 End Function %&gt; 调用函数 MD5 就可以实现加密了 LCase(WordToHex(b) &amp; WordToHex(c))返回的是16位的加密串 LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d))返回的是32位的加密串 阅读更多" />
<meta property="og:description" content="&lt;% Private Const BITS_TO_A_BYTE = 8 Private Const BYTES_TO_A_WORD = 4 Private Const BITS_TO_A_WORD = 32 Private m_lOnBits(30) Private m_l2Power(30) Private Function LShift(lValue, iShiftBits) If iShiftBits = 0 Then LShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And 1 Then LShift = &amp;H80000000 Else LShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If If (lValue And m_l2Power(31 - iShiftBits)) Then LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &amp;H80000000 Else LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits)) End If End Function Private Function RShift(lValue, iShiftBits) If iShiftBits = 0 Then RShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And &amp;H80000000 Then RShift = 1 Else RShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If RShift = (lValue And &amp;H7FFFFFFE) \ m_l2Power(iShiftBits) If (lValue And &amp;H80000000) Then RShift = (RShift Or (&amp;H40000000 \ m_l2Power(iShiftBits - 1))) End If End Function Private Function RotateLeft(lValue, iShiftBits) RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits)) End Function Private Function AddUnsigned(lX, lY) Dim lX4 Dim lY4 Dim lX8 Dim lY8 Dim lResult lX8 = lX And &amp;H80000000 lY8 = lY And &amp;H80000000 lX4 = lX And &amp;H40000000 lY4 = lY And &amp;H40000000 lResult = (lX And &amp;H3FFFFFFF) + (lY And &amp;H3FFFFFFF) If lX4 And lY4 Then lResult = lResult Xor &amp;H80000000 Xor lX8 Xor lY8 ElseIf lX4 Or lY4 Then If lResult And &amp;H40000000 Then lResult = lResult Xor &amp;HC0000000 Xor lX8 Xor lY8 Else lResult = lResult Xor &amp;H40000000 Xor lX8 Xor lY8 End If Else lResult = lResult Xor lX8 Xor lY8 End If AddUnsigned = lResult End Function Private Function md5_F(x, y, z) md5_F = (x And y) Or ((Not x) And z) End Function Private Function md5_G(x, y, z) md5_G = (x And z) Or (y And (Not z)) End Function Private Function md5_H(x, y, z) md5_H = (x Xor y Xor z) End Function Private Function md5_I(x, y, z) md5_I = (y Xor (x Or (Not z))) End Function Private Sub md5_FF(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_F(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_GG(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_G(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_HH(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_H(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_II(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_I(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Function ConvertToWordArray(sMessage) Dim lMessageLength Dim lNumberOfWords Dim lWordArray() Dim lBytePosition Dim lByteCount Dim lWordCount Const MODULUS_BITS = 512 Const CONGRUENT_BITS = 448 lMessageLength = Len(sMessage) lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \ BITS_TO_A_BYTE)) \ (MODULUS_BITS \ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \ BITS_TO_A_WORD) ReDim lWordArray(lNumberOfWords - 1) lBytePosition = 0 lByteCount = 0 Do Until lByteCount &gt;= lMessageLength lWordCount = lByteCount \ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition) lByteCount = lByteCount + 1 Loop lWordCount = lByteCount \ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&amp;H80, lBytePosition) lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3) lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29) ConvertToWordArray = lWordArray End Function Private Function WordToHex(lValue) Dim lByte Dim lCount For lCount = 0 To 3 lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1) WordToHex = WordToHex &amp; Right(&quot;0&quot; &amp; Hex(lByte), 2) Next End Function Public Function MD5(sMessage) m_lOnBits(0) = CLng(1) m_lOnBits(1) = CLng(3) m_lOnBits(2) = CLng(7) m_lOnBits(3) = CLng(15) m_lOnBits(4) = CLng(31) m_lOnBits(5) = CLng(63) m_lOnBits(6) = CLng(127) m_lOnBits(7) = CLng(255) m_lOnBits(8) = CLng(511) m_lOnBits(9) = CLng(1023) m_lOnBits(10) = CLng(2047) m_lOnBits(11) = CLng(4095) m_lOnBits(12) = CLng(8191) m_lOnBits(13) = CLng(16383) m_lOnBits(14) = CLng(32767) m_lOnBits(15) = CLng(65535) m_lOnBits(16) = CLng(131071) m_lOnBits(17) = CLng(262143) m_lOnBits(18) = CLng(524287) m_lOnBits(19) = CLng(1048575) m_lOnBits(20) = CLng(2097151) m_lOnBits(21) = CLng(4194303) m_lOnBits(22) = CLng(8388607) m_lOnBits(23) = CLng(16777215) m_lOnBits(24) = CLng(33554431) m_lOnBits(25) = CLng(67108863) m_lOnBits(26) = CLng(134217727) m_lOnBits(27) = CLng(268435455) m_lOnBits(28) = CLng(536870911) m_lOnBits(29) = CLng(1073741823) m_lOnBits(30) = CLng(2147483647) m_l2Power(0) = CLng(1) m_l2Power(1) = CLng(2) m_l2Power(2) = CLng(4) m_l2Power(3) = CLng(8) m_l2Power(4) = CLng(16) m_l2Power(5) = CLng(32) m_l2Power(6) = CLng(64) m_l2Power(7) = CLng(128) m_l2Power(8) = CLng(256) m_l2Power(9) = CLng(512) m_l2Power(10) = CLng(1024) m_l2Power(11) = CLng(2048) m_l2Power(12) = CLng(4096) m_l2Power(13) = CLng(8192) m_l2Power(14) = CLng(16384) m_l2Power(15) = CLng(32768) m_l2Power(16) = CLng(65536) m_l2Power(17) = CLng(131072) m_l2Power(18) = CLng(262144) m_l2Power(19) = CLng(524288) m_l2Power(20) = CLng(1048576) m_l2Power(21) = CLng(2097152) m_l2Power(22) = CLng(4194304) m_l2Power(23) = CLng(8388608) m_l2Power(24) = CLng(16777216) m_l2Power(25) = CLng(33554432) m_l2Power(26) = CLng(67108864) m_l2Power(27) = CLng(134217728) m_l2Power(28) = CLng(268435456) m_l2Power(29) = CLng(536870912) m_l2Power(30) = CLng(1073741824) Dim x Dim k Dim AA Dim BB Dim CC Dim DD Dim a Dim b Dim c Dim d Const S11 = 7 Const S12 = 12 Const S13 = 17 Const S14 = 22 Const S21 = 5 Const S22 = 9 Const S23 = 14 Const S24 = 20 Const S31 = 4 Const S32 = 11 Const S33 = 16 Const S34 = 23 Const S41 = 6 Const S42 = 10 Const S43 = 15 Const S44 = 21 x = ConvertToWordArray(sMessage) a = &amp;H67452301 b = &amp;HEFCDAB89 c = &amp;H98BADCFE d = &amp;H10325476 For k = 0 To UBound(x) Step 16 AA = a BB = b CC = c DD = d md5_FF a, b, c, d, x(k + 0), S11, &amp;HD76AA478 md5_FF d, a, b, c, x(k + 1), S12, &amp;HE8C7B756 md5_FF c, d, a, b, x(k + 2), S13, &amp;H242070DB md5_FF b, c, d, a, x(k + 3), S14, &amp;HC1BDCEEE md5_FF a, b, c, d, x(k + 4), S11, &amp;HF57C0FAF md5_FF d, a, b, c, x(k + 5), S12, &amp;H4787C62A md5_FF c, d, a, b, x(k + 6), S13, &amp;HA8304613 md5_FF b, c, d, a, x(k + 7), S14, &amp;HFD469501 md5_FF a, b, c, d, x(k + 8), S11, &amp;H698098D8 md5_FF d, a, b, c, x(k + 9), S12, &amp;H8B44F7AF md5_FF c, d, a, b, x(k + 10), S13, &amp;HFFFF5BB1 md5_FF b, c, d, a, x(k + 11), S14, &amp;H895CD7BE md5_FF a, b, c, d, x(k + 12), S11, &amp;H6B901122 md5_FF d, a, b, c, x(k + 13), S12, &amp;HFD987193 md5_FF c, d, a, b, x(k + 14), S13, &amp;HA679438E md5_FF b, c, d, a, x(k + 15), S14, &amp;H49B40821 md5_GG a, b, c, d, x(k + 1), S21, &amp;HF61E2562 md5_GG d, a, b, c, x(k + 6), S22, &amp;HC040B340 md5_GG c, d, a, b, x(k + 11), S23, &amp;H265E5A51 md5_GG b, c, d, a, x(k + 0), S24, &amp;HE9B6C7AA md5_GG a, b, c, d, x(k + 5), S21, &amp;HD62F105D md5_GG d, a, b, c, x(k + 10), S22, &amp;H2441453 md5_GG c, d, a, b, x(k + 15), S23, &amp;HD8A1E681 md5_GG b, c, d, a, x(k + 4), S24, &amp;HE7D3FBC8 md5_GG a, b, c, d, x(k + 9), S21, &amp;H21E1CDE6 md5_GG d, a, b, c, x(k + 14), S22, &amp;HC33707D6 md5_GG c, d, a, b, x(k + 3), S23, &amp;HF4D50D87 md5_GG b, c, d, a, x(k + 8), S24, &amp;H455A14ED md5_GG a, b, c, d, x(k + 13), S21, &amp;HA9E3E905 md5_GG d, a, b, c, x(k + 2), S22, &amp;HFCEFA3F8 md5_GG c, d, a, b, x(k + 7), S23, &amp;H676F02D9 md5_GG b, c, d, a, x(k + 12), S24, &amp;H8D2A4C8A md5_HH a, b, c, d, x(k + 5), S31, &amp;HFFFA3942 md5_HH d, a, b, c, x(k + 8), S32, &amp;H8771F681 md5_HH c, d, a, b, x(k + 11), S33, &amp;H6D9D6122 md5_HH b, c, d, a, x(k + 14), S34, &amp;HFDE5380C md5_HH a, b, c, d, x(k + 1), S31, &amp;HA4BEEA44 md5_HH d, a, b, c, x(k + 4), S32, &amp;H4BDECFA9 md5_HH c, d, a, b, x(k + 7), S33, &amp;HF6BB4B60 md5_HH b, c, d, a, x(k + 10), S34, &amp;HBEBFBC70 md5_HH a, b, c, d, x(k + 13), S31, &amp;H289B7EC6 md5_HH d, a, b, c, x(k + 0), S32, &amp;HEAA127FA md5_HH c, d, a, b, x(k + 3), S33, &amp;HD4EF3085 md5_HH b, c, d, a, x(k + 6), S34, &amp;H4881D05 md5_HH a, b, c, d, x(k + 9), S31, &amp;HD9D4D039 md5_HH d, a, b, c, x(k + 12), S32, &amp;HE6DB99E5 md5_HH c, d, a, b, x(k + 15), S33, &amp;H1FA27CF8 md5_HH b, c, d, a, x(k + 2), S34, &amp;HC4AC5665 md5_II a, b, c, d, x(k + 0), S41, &amp;HF4292244 md5_II d, a, b, c, x(k + 7), S42, &amp;H432AFF97 md5_II c, d, a, b, x(k + 14), S43, &amp;HAB9423A7 md5_II b, c, d, a, x(k + 5), S44, &amp;HFC93A039 md5_II a, b, c, d, x(k + 12), S41, &amp;H655B59C3 md5_II d, a, b, c, x(k + 3), S42, &amp;H8F0CCC92 md5_II c, d, a, b, x(k + 10), S43, &amp;HFFEFF47D md5_II b, c, d, a, x(k + 1), S44, &amp;H85845DD1 md5_II a, b, c, d, x(k + 8), S41, &amp;H6FA87E4F md5_II d, a, b, c, x(k + 15), S42, &amp;HFE2CE6E0 md5_II c, d, a, b, x(k + 6), S43, &amp;HA3014314 md5_II b, c, d, a, x(k + 13), S44, &amp;H4E0811A1 md5_II a, b, c, d, x(k + 4), S41, &amp;HF7537E82 md5_II d, a, b, c, x(k + 11), S42, &amp;HBD3AF235 md5_II c, d, a, b, x(k + 2), S43, &amp;H2AD7D2BB md5_II b, c, d, a, x(k + 9), S44, &amp;HEB86D391 a = AddUnsigned(a, AA) b = AddUnsigned(b, BB) c = AddUnsigned(c, CC) d = AddUnsigned(d, DD) Next &#39;MD5=LCase(WordToHex(b) &amp; WordToHex(c)) &#39;16位 MD5 = LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d)) &#39;32位 End Function %&gt; 调用函数 MD5 就可以实现加密了 LCase(WordToHex(b) &amp; WordToHex(c))返回的是16位的加密串 LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d))返回的是32位的加密串 阅读更多" />
<link rel="canonical" href="https://mlh.app/2011/08/31/95f061ba6b61433e1980a3fb08852f86.html" />
<meta property="og:url" content="https://mlh.app/2011/08/31/95f061ba6b61433e1980a3fb08852f86.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-08-31T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"&lt;% Private Const BITS_TO_A_BYTE = 8 Private Const BYTES_TO_A_WORD = 4 Private Const BITS_TO_A_WORD = 32 Private m_lOnBits(30) Private m_l2Power(30) Private Function LShift(lValue, iShiftBits) If iShiftBits = 0 Then LShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And 1 Then LShift = &amp;H80000000 Else LShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If If (lValue And m_l2Power(31 - iShiftBits)) Then LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &amp;H80000000 Else LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits)) End If End Function Private Function RShift(lValue, iShiftBits) If iShiftBits = 0 Then RShift = lValue Exit Function ElseIf iShiftBits = 31 Then If lValue And &amp;H80000000 Then RShift = 1 Else RShift = 0 End If Exit Function ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then Err.Raise 6 End If RShift = (lValue And &amp;H7FFFFFFE) \\ m_l2Power(iShiftBits) If (lValue And &amp;H80000000) Then RShift = (RShift Or (&amp;H40000000 \\ m_l2Power(iShiftBits - 1))) End If End Function Private Function RotateLeft(lValue, iShiftBits) RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits)) End Function Private Function AddUnsigned(lX, lY) Dim lX4 Dim lY4 Dim lX8 Dim lY8 Dim lResult lX8 = lX And &amp;H80000000 lY8 = lY And &amp;H80000000 lX4 = lX And &amp;H40000000 lY4 = lY And &amp;H40000000 lResult = (lX And &amp;H3FFFFFFF) + (lY And &amp;H3FFFFFFF) If lX4 And lY4 Then lResult = lResult Xor &amp;H80000000 Xor lX8 Xor lY8 ElseIf lX4 Or lY4 Then If lResult And &amp;H40000000 Then lResult = lResult Xor &amp;HC0000000 Xor lX8 Xor lY8 Else lResult = lResult Xor &amp;H40000000 Xor lX8 Xor lY8 End If Else lResult = lResult Xor lX8 Xor lY8 End If AddUnsigned = lResult End Function Private Function md5_F(x, y, z) md5_F = (x And y) Or ((Not x) And z) End Function Private Function md5_G(x, y, z) md5_G = (x And z) Or (y And (Not z)) End Function Private Function md5_H(x, y, z) md5_H = (x Xor y Xor z) End Function Private Function md5_I(x, y, z) md5_I = (y Xor (x Or (Not z))) End Function Private Sub md5_FF(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_F(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_GG(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_G(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_HH(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_H(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Sub md5_II(a, b, c, d, x, s, ac) a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_I(b, c, d), x), ac)) a = RotateLeft(a, s) a = AddUnsigned(a, b) End Sub Private Function ConvertToWordArray(sMessage) Dim lMessageLength Dim lNumberOfWords Dim lWordArray() Dim lBytePosition Dim lByteCount Dim lWordCount Const MODULUS_BITS = 512 Const CONGRUENT_BITS = 448 lMessageLength = Len(sMessage) lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \\ BITS_TO_A_BYTE)) \\ (MODULUS_BITS \\ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \\ BITS_TO_A_WORD) ReDim lWordArray(lNumberOfWords - 1) lBytePosition = 0 lByteCount = 0 Do Until lByteCount &gt;= lMessageLength lWordCount = lByteCount \\ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition) lByteCount = lByteCount + 1 Loop lWordCount = lByteCount \\ BYTES_TO_A_WORD lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&amp;H80, lBytePosition) lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3) lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29) ConvertToWordArray = lWordArray End Function Private Function WordToHex(lValue) Dim lByte Dim lCount For lCount = 0 To 3 lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1) WordToHex = WordToHex &amp; Right(&quot;0&quot; &amp; Hex(lByte), 2) Next End Function Public Function MD5(sMessage) m_lOnBits(0) = CLng(1) m_lOnBits(1) = CLng(3) m_lOnBits(2) = CLng(7) m_lOnBits(3) = CLng(15) m_lOnBits(4) = CLng(31) m_lOnBits(5) = CLng(63) m_lOnBits(6) = CLng(127) m_lOnBits(7) = CLng(255) m_lOnBits(8) = CLng(511) m_lOnBits(9) = CLng(1023) m_lOnBits(10) = CLng(2047) m_lOnBits(11) = CLng(4095) m_lOnBits(12) = CLng(8191) m_lOnBits(13) = CLng(16383) m_lOnBits(14) = CLng(32767) m_lOnBits(15) = CLng(65535) m_lOnBits(16) = CLng(131071) m_lOnBits(17) = CLng(262143) m_lOnBits(18) = CLng(524287) m_lOnBits(19) = CLng(1048575) m_lOnBits(20) = CLng(2097151) m_lOnBits(21) = CLng(4194303) m_lOnBits(22) = CLng(8388607) m_lOnBits(23) = CLng(16777215) m_lOnBits(24) = CLng(33554431) m_lOnBits(25) = CLng(67108863) m_lOnBits(26) = CLng(134217727) m_lOnBits(27) = CLng(268435455) m_lOnBits(28) = CLng(536870911) m_lOnBits(29) = CLng(1073741823) m_lOnBits(30) = CLng(2147483647) m_l2Power(0) = CLng(1) m_l2Power(1) = CLng(2) m_l2Power(2) = CLng(4) m_l2Power(3) = CLng(8) m_l2Power(4) = CLng(16) m_l2Power(5) = CLng(32) m_l2Power(6) = CLng(64) m_l2Power(7) = CLng(128) m_l2Power(8) = CLng(256) m_l2Power(9) = CLng(512) m_l2Power(10) = CLng(1024) m_l2Power(11) = CLng(2048) m_l2Power(12) = CLng(4096) m_l2Power(13) = CLng(8192) m_l2Power(14) = CLng(16384) m_l2Power(15) = CLng(32768) m_l2Power(16) = CLng(65536) m_l2Power(17) = CLng(131072) m_l2Power(18) = CLng(262144) m_l2Power(19) = CLng(524288) m_l2Power(20) = CLng(1048576) m_l2Power(21) = CLng(2097152) m_l2Power(22) = CLng(4194304) m_l2Power(23) = CLng(8388608) m_l2Power(24) = CLng(16777216) m_l2Power(25) = CLng(33554432) m_l2Power(26) = CLng(67108864) m_l2Power(27) = CLng(134217728) m_l2Power(28) = CLng(268435456) m_l2Power(29) = CLng(536870912) m_l2Power(30) = CLng(1073741824) Dim x Dim k Dim AA Dim BB Dim CC Dim DD Dim a Dim b Dim c Dim d Const S11 = 7 Const S12 = 12 Const S13 = 17 Const S14 = 22 Const S21 = 5 Const S22 = 9 Const S23 = 14 Const S24 = 20 Const S31 = 4 Const S32 = 11 Const S33 = 16 Const S34 = 23 Const S41 = 6 Const S42 = 10 Const S43 = 15 Const S44 = 21 x = ConvertToWordArray(sMessage) a = &amp;H67452301 b = &amp;HEFCDAB89 c = &amp;H98BADCFE d = &amp;H10325476 For k = 0 To UBound(x) Step 16 AA = a BB = b CC = c DD = d md5_FF a, b, c, d, x(k + 0), S11, &amp;HD76AA478 md5_FF d, a, b, c, x(k + 1), S12, &amp;HE8C7B756 md5_FF c, d, a, b, x(k + 2), S13, &amp;H242070DB md5_FF b, c, d, a, x(k + 3), S14, &amp;HC1BDCEEE md5_FF a, b, c, d, x(k + 4), S11, &amp;HF57C0FAF md5_FF d, a, b, c, x(k + 5), S12, &amp;H4787C62A md5_FF c, d, a, b, x(k + 6), S13, &amp;HA8304613 md5_FF b, c, d, a, x(k + 7), S14, &amp;HFD469501 md5_FF a, b, c, d, x(k + 8), S11, &amp;H698098D8 md5_FF d, a, b, c, x(k + 9), S12, &amp;H8B44F7AF md5_FF c, d, a, b, x(k + 10), S13, &amp;HFFFF5BB1 md5_FF b, c, d, a, x(k + 11), S14, &amp;H895CD7BE md5_FF a, b, c, d, x(k + 12), S11, &amp;H6B901122 md5_FF d, a, b, c, x(k + 13), S12, &amp;HFD987193 md5_FF c, d, a, b, x(k + 14), S13, &amp;HA679438E md5_FF b, c, d, a, x(k + 15), S14, &amp;H49B40821 md5_GG a, b, c, d, x(k + 1), S21, &amp;HF61E2562 md5_GG d, a, b, c, x(k + 6), S22, &amp;HC040B340 md5_GG c, d, a, b, x(k + 11), S23, &amp;H265E5A51 md5_GG b, c, d, a, x(k + 0), S24, &amp;HE9B6C7AA md5_GG a, b, c, d, x(k + 5), S21, &amp;HD62F105D md5_GG d, a, b, c, x(k + 10), S22, &amp;H2441453 md5_GG c, d, a, b, x(k + 15), S23, &amp;HD8A1E681 md5_GG b, c, d, a, x(k + 4), S24, &amp;HE7D3FBC8 md5_GG a, b, c, d, x(k + 9), S21, &amp;H21E1CDE6 md5_GG d, a, b, c, x(k + 14), S22, &amp;HC33707D6 md5_GG c, d, a, b, x(k + 3), S23, &amp;HF4D50D87 md5_GG b, c, d, a, x(k + 8), S24, &amp;H455A14ED md5_GG a, b, c, d, x(k + 13), S21, &amp;HA9E3E905 md5_GG d, a, b, c, x(k + 2), S22, &amp;HFCEFA3F8 md5_GG c, d, a, b, x(k + 7), S23, &amp;H676F02D9 md5_GG b, c, d, a, x(k + 12), S24, &amp;H8D2A4C8A md5_HH a, b, c, d, x(k + 5), S31, &amp;HFFFA3942 md5_HH d, a, b, c, x(k + 8), S32, &amp;H8771F681 md5_HH c, d, a, b, x(k + 11), S33, &amp;H6D9D6122 md5_HH b, c, d, a, x(k + 14), S34, &amp;HFDE5380C md5_HH a, b, c, d, x(k + 1), S31, &amp;HA4BEEA44 md5_HH d, a, b, c, x(k + 4), S32, &amp;H4BDECFA9 md5_HH c, d, a, b, x(k + 7), S33, &amp;HF6BB4B60 md5_HH b, c, d, a, x(k + 10), S34, &amp;HBEBFBC70 md5_HH a, b, c, d, x(k + 13), S31, &amp;H289B7EC6 md5_HH d, a, b, c, x(k + 0), S32, &amp;HEAA127FA md5_HH c, d, a, b, x(k + 3), S33, &amp;HD4EF3085 md5_HH b, c, d, a, x(k + 6), S34, &amp;H4881D05 md5_HH a, b, c, d, x(k + 9), S31, &amp;HD9D4D039 md5_HH d, a, b, c, x(k + 12), S32, &amp;HE6DB99E5 md5_HH c, d, a, b, x(k + 15), S33, &amp;H1FA27CF8 md5_HH b, c, d, a, x(k + 2), S34, &amp;HC4AC5665 md5_II a, b, c, d, x(k + 0), S41, &amp;HF4292244 md5_II d, a, b, c, x(k + 7), S42, &amp;H432AFF97 md5_II c, d, a, b, x(k + 14), S43, &amp;HAB9423A7 md5_II b, c, d, a, x(k + 5), S44, &amp;HFC93A039 md5_II a, b, c, d, x(k + 12), S41, &amp;H655B59C3 md5_II d, a, b, c, x(k + 3), S42, &amp;H8F0CCC92 md5_II c, d, a, b, x(k + 10), S43, &amp;HFFEFF47D md5_II b, c, d, a, x(k + 1), S44, &amp;H85845DD1 md5_II a, b, c, d, x(k + 8), S41, &amp;H6FA87E4F md5_II d, a, b, c, x(k + 15), S42, &amp;HFE2CE6E0 md5_II c, d, a, b, x(k + 6), S43, &amp;HA3014314 md5_II b, c, d, a, x(k + 13), S44, &amp;H4E0811A1 md5_II a, b, c, d, x(k + 4), S41, &amp;HF7537E82 md5_II d, a, b, c, x(k + 11), S42, &amp;HBD3AF235 md5_II c, d, a, b, x(k + 2), S43, &amp;H2AD7D2BB md5_II b, c, d, a, x(k + 9), S44, &amp;HEB86D391 a = AddUnsigned(a, AA) b = AddUnsigned(b, BB) c = AddUnsigned(c, CC) d = AddUnsigned(d, DD) Next &#39;MD5=LCase(WordToHex(b) &amp; WordToHex(c)) &#39;16位 MD5 = LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d)) &#39;32位 End Function %&gt; 调用函数 MD5 就可以实现加密了 LCase(WordToHex(b) &amp; WordToHex(c))返回的是16位的加密串 LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d))返回的是32位的加密串 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2011/08/31/95f061ba6b61433e1980a3fb08852f86.html","headline":"ASP MD5 16位和32位加密实现","dateModified":"2011-08-31T00:00:00+08:00","datePublished":"2011-08-31T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2011/08/31/95f061ba6b61433e1980a3fb08852f86.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>ASP MD5 16位和32位加密实现</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <pre><code class="language-vb">&lt;%
Private Const BITS_TO_A_BYTE = 8
Private Const BYTES_TO_A_WORD = 4
Private Const BITS_TO_A_WORD = 32

Private m_lOnBits(30)
Private m_l2Power(30)

Private Function LShift(lValue, iShiftBits)
    If iShiftBits = 0 Then
        LShift = lValue
        Exit Function
    ElseIf iShiftBits = 31 Then
        If lValue And 1 Then
            LShift = &amp;H80000000
        Else
            LShift = 0
        End If
        Exit Function
    ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then
        Err.Raise 6
    End If

    If (lValue And m_l2Power(31 - iShiftBits)) Then
        LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &amp;H80000000
    Else
        LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits))
    End If
End Function

Private Function RShift(lValue, iShiftBits)
    If iShiftBits = 0 Then
        RShift = lValue
        Exit Function
    ElseIf iShiftBits = 31 Then
        If lValue And &amp;H80000000 Then
            RShift = 1
        Else
            RShift = 0
        End If
        Exit Function
    ElseIf iShiftBits &lt; 0 Or iShiftBits &gt; 31 Then
        Err.Raise 6
    End If

    RShift = (lValue And &amp;H7FFFFFFE) \ m_l2Power(iShiftBits)

    If (lValue And &amp;H80000000) Then
        RShift = (RShift Or (&amp;H40000000 \ m_l2Power(iShiftBits - 1)))
    End If
End Function

Private Function RotateLeft(lValue, iShiftBits)
    RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits))
End Function

Private Function AddUnsigned(lX, lY)
    Dim lX4
    Dim lY4
    Dim lX8
    Dim lY8
    Dim lResult

    lX8 = lX And &amp;H80000000
    lY8 = lY And &amp;H80000000
    lX4 = lX And &amp;H40000000
    lY4 = lY And &amp;H40000000

    lResult = (lX And &amp;H3FFFFFFF) + (lY And &amp;H3FFFFFFF)

    If lX4 And lY4 Then
        lResult = lResult Xor &amp;H80000000 Xor lX8 Xor lY8
    ElseIf lX4 Or lY4 Then
        If lResult And &amp;H40000000 Then
            lResult = lResult Xor &amp;HC0000000 Xor lX8 Xor lY8
        Else
            lResult = lResult Xor &amp;H40000000 Xor lX8 Xor lY8
        End If
    Else
        lResult = lResult Xor lX8 Xor lY8
    End If

    AddUnsigned = lResult
End Function

Private Function md5_F(x, y, z)
    md5_F = (x And y) Or ((Not x) And z)
End Function

Private Function md5_G(x, y, z)
    md5_G = (x And z) Or (y And (Not z))
End Function

Private Function md5_H(x, y, z)
    md5_H = (x Xor y Xor z)
End Function

Private Function md5_I(x, y, z)
    md5_I = (y Xor (x Or (Not z)))
End Function

Private Sub md5_FF(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_F(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Sub md5_GG(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_G(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Sub md5_HH(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_H(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Sub md5_II(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(md5_I(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Function ConvertToWordArray(sMessage)
    Dim lMessageLength
    Dim lNumberOfWords
    Dim lWordArray()
    Dim lBytePosition
    Dim lByteCount
    Dim lWordCount

    Const MODULUS_BITS = 512
    Const CONGRUENT_BITS = 448

    lMessageLength = Len(sMessage)

    lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \ BITS_TO_A_BYTE)) \ (MODULUS_BITS \ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \ BITS_TO_A_WORD)
    ReDim lWordArray(lNumberOfWords - 1)

    lBytePosition = 0
    lByteCount = 0
    Do Until lByteCount &gt;= lMessageLength
        lWordCount = lByteCount \ BYTES_TO_A_WORD
        lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE
        lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition)
        lByteCount = lByteCount + 1
    Loop

    lWordCount = lByteCount \ BYTES_TO_A_WORD
    lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE

    lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&amp;H80, lBytePosition)

    lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3)
    lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29)

    ConvertToWordArray = lWordArray
End Function

Private Function WordToHex(lValue)
    Dim lByte
    Dim lCount

    For lCount = 0 To 3
        lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1)
        WordToHex = WordToHex &amp; Right("0" &amp; Hex(lByte), 2)
    Next
End Function

Public Function MD5(sMessage)
    m_lOnBits(0) = CLng(1)
    m_lOnBits(1) = CLng(3)
    m_lOnBits(2) = CLng(7)
    m_lOnBits(3) = CLng(15)
    m_lOnBits(4) = CLng(31)
    m_lOnBits(5) = CLng(63)
    m_lOnBits(6) = CLng(127)
    m_lOnBits(7) = CLng(255)
    m_lOnBits(8) = CLng(511)
    m_lOnBits(9) = CLng(1023)
    m_lOnBits(10) = CLng(2047)
    m_lOnBits(11) = CLng(4095)
    m_lOnBits(12) = CLng(8191)
    m_lOnBits(13) = CLng(16383)
    m_lOnBits(14) = CLng(32767)
    m_lOnBits(15) = CLng(65535)
    m_lOnBits(16) = CLng(131071)
    m_lOnBits(17) = CLng(262143)
    m_lOnBits(18) = CLng(524287)
    m_lOnBits(19) = CLng(1048575)
    m_lOnBits(20) = CLng(2097151)
    m_lOnBits(21) = CLng(4194303)
    m_lOnBits(22) = CLng(8388607)
    m_lOnBits(23) = CLng(16777215)
    m_lOnBits(24) = CLng(33554431)
    m_lOnBits(25) = CLng(67108863)
    m_lOnBits(26) = CLng(134217727)
    m_lOnBits(27) = CLng(268435455)
    m_lOnBits(28) = CLng(536870911)
    m_lOnBits(29) = CLng(1073741823)
    m_lOnBits(30) = CLng(2147483647)

    m_l2Power(0) = CLng(1)
    m_l2Power(1) = CLng(2)
    m_l2Power(2) = CLng(4)
    m_l2Power(3) = CLng(8)
    m_l2Power(4) = CLng(16)
    m_l2Power(5) = CLng(32)
    m_l2Power(6) = CLng(64)
    m_l2Power(7) = CLng(128)
    m_l2Power(8) = CLng(256)
    m_l2Power(9) = CLng(512)
    m_l2Power(10) = CLng(1024)
    m_l2Power(11) = CLng(2048)
    m_l2Power(12) = CLng(4096)
    m_l2Power(13) = CLng(8192)
    m_l2Power(14) = CLng(16384)
    m_l2Power(15) = CLng(32768)
    m_l2Power(16) = CLng(65536)
    m_l2Power(17) = CLng(131072)
    m_l2Power(18) = CLng(262144)
    m_l2Power(19) = CLng(524288)
    m_l2Power(20) = CLng(1048576)
    m_l2Power(21) = CLng(2097152)
    m_l2Power(22) = CLng(4194304)
    m_l2Power(23) = CLng(8388608)
    m_l2Power(24) = CLng(16777216)
    m_l2Power(25) = CLng(33554432)
    m_l2Power(26) = CLng(67108864)
    m_l2Power(27) = CLng(134217728)
    m_l2Power(28) = CLng(268435456)
    m_l2Power(29) = CLng(536870912)
    m_l2Power(30) = CLng(1073741824)

    Dim x
    Dim k
    Dim AA
    Dim BB
    Dim CC
    Dim DD
    Dim a
    Dim b
    Dim c
    Dim d

    Const S11 = 7
    Const S12 = 12
    Const S13 = 17
    Const S14 = 22
    Const S21 = 5
    Const S22 = 9
    Const S23 = 14
    Const S24 = 20
    Const S31 = 4
    Const S32 = 11
    Const S33 = 16
    Const S34 = 23
    Const S41 = 6
    Const S42 = 10
    Const S43 = 15
    Const S44 = 21

    x = ConvertToWordArray(sMessage)

    a = &amp;H67452301
    b = &amp;HEFCDAB89
    c = &amp;H98BADCFE
    d = &amp;H10325476

    For k = 0 To UBound(x) Step 16
        AA = a
        BB = b
        CC = c
        DD = d

        md5_FF a, b, c, d, x(k + 0), S11, &amp;HD76AA478
        md5_FF d, a, b, c, x(k + 1), S12, &amp;HE8C7B756
        md5_FF c, d, a, b, x(k + 2), S13, &amp;H242070DB
        md5_FF b, c, d, a, x(k + 3), S14, &amp;HC1BDCEEE
        md5_FF a, b, c, d, x(k + 4), S11, &amp;HF57C0FAF
        md5_FF d, a, b, c, x(k + 5), S12, &amp;H4787C62A
        md5_FF c, d, a, b, x(k + 6), S13, &amp;HA8304613
        md5_FF b, c, d, a, x(k + 7), S14, &amp;HFD469501
        md5_FF a, b, c, d, x(k + 8), S11, &amp;H698098D8
        md5_FF d, a, b, c, x(k + 9), S12, &amp;H8B44F7AF
        md5_FF c, d, a, b, x(k + 10), S13, &amp;HFFFF5BB1
        md5_FF b, c, d, a, x(k + 11), S14, &amp;H895CD7BE
        md5_FF a, b, c, d, x(k + 12), S11, &amp;H6B901122
        md5_FF d, a, b, c, x(k + 13), S12, &amp;HFD987193
        md5_FF c, d, a, b, x(k + 14), S13, &amp;HA679438E
        md5_FF b, c, d, a, x(k + 15), S14, &amp;H49B40821

        md5_GG a, b, c, d, x(k + 1), S21, &amp;HF61E2562
        md5_GG d, a, b, c, x(k + 6), S22, &amp;HC040B340
        md5_GG c, d, a, b, x(k + 11), S23, &amp;H265E5A51
        md5_GG b, c, d, a, x(k + 0), S24, &amp;HE9B6C7AA
        md5_GG a, b, c, d, x(k + 5), S21, &amp;HD62F105D
        md5_GG d, a, b, c, x(k + 10), S22, &amp;H2441453
        md5_GG c, d, a, b, x(k + 15), S23, &amp;HD8A1E681
        md5_GG b, c, d, a, x(k + 4), S24, &amp;HE7D3FBC8
        md5_GG a, b, c, d, x(k + 9), S21, &amp;H21E1CDE6
        md5_GG d, a, b, c, x(k + 14), S22, &amp;HC33707D6
        md5_GG c, d, a, b, x(k + 3), S23, &amp;HF4D50D87
        md5_GG b, c, d, a, x(k + 8), S24, &amp;H455A14ED
        md5_GG a, b, c, d, x(k + 13), S21, &amp;HA9E3E905
        md5_GG d, a, b, c, x(k + 2), S22, &amp;HFCEFA3F8
        md5_GG c, d, a, b, x(k + 7), S23, &amp;H676F02D9
        md5_GG b, c, d, a, x(k + 12), S24, &amp;H8D2A4C8A

        md5_HH a, b, c, d, x(k + 5), S31, &amp;HFFFA3942
        md5_HH d, a, b, c, x(k + 8), S32, &amp;H8771F681
        md5_HH c, d, a, b, x(k + 11), S33, &amp;H6D9D6122
        md5_HH b, c, d, a, x(k + 14), S34, &amp;HFDE5380C
        md5_HH a, b, c, d, x(k + 1), S31, &amp;HA4BEEA44
        md5_HH d, a, b, c, x(k + 4), S32, &amp;H4BDECFA9
        md5_HH c, d, a, b, x(k + 7), S33, &amp;HF6BB4B60
        md5_HH b, c, d, a, x(k + 10), S34, &amp;HBEBFBC70
        md5_HH a, b, c, d, x(k + 13), S31, &amp;H289B7EC6
        md5_HH d, a, b, c, x(k + 0), S32, &amp;HEAA127FA
        md5_HH c, d, a, b, x(k + 3), S33, &amp;HD4EF3085
        md5_HH b, c, d, a, x(k + 6), S34, &amp;H4881D05
        md5_HH a, b, c, d, x(k + 9), S31, &amp;HD9D4D039
        md5_HH d, a, b, c, x(k + 12), S32, &amp;HE6DB99E5
        md5_HH c, d, a, b, x(k + 15), S33, &amp;H1FA27CF8
        md5_HH b, c, d, a, x(k + 2), S34, &amp;HC4AC5665

        md5_II a, b, c, d, x(k + 0), S41, &amp;HF4292244
        md5_II d, a, b, c, x(k + 7), S42, &amp;H432AFF97
        md5_II c, d, a, b, x(k + 14), S43, &amp;HAB9423A7
        md5_II b, c, d, a, x(k + 5), S44, &amp;HFC93A039
        md5_II a, b, c, d, x(k + 12), S41, &amp;H655B59C3
        md5_II d, a, b, c, x(k + 3), S42, &amp;H8F0CCC92
        md5_II c, d, a, b, x(k + 10), S43, &amp;HFFEFF47D
        md5_II b, c, d, a, x(k + 1), S44, &amp;H85845DD1
        md5_II a, b, c, d, x(k + 8), S41, &amp;H6FA87E4F
        md5_II d, a, b, c, x(k + 15), S42, &amp;HFE2CE6E0
        md5_II c, d, a, b, x(k + 6), S43, &amp;HA3014314
        md5_II b, c, d, a, x(k + 13), S44, &amp;H4E0811A1
        md5_II a, b, c, d, x(k + 4), S41, &amp;HF7537E82
        md5_II d, a, b, c, x(k + 11), S42, &amp;HBD3AF235
        md5_II c, d, a, b, x(k + 2), S43, &amp;H2AD7D2BB
        md5_II b, c, d, a, x(k + 9), S44, &amp;HEB86D391

        a = AddUnsigned(a, AA)
        b = AddUnsigned(b, BB)
        c = AddUnsigned(c, CC)
        d = AddUnsigned(d, DD)
    Next
    'MD5=LCase(WordToHex(b) &amp; WordToHex(c))  '16位
   
    MD5 = LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d))  '32位
End Function
%&gt;</code></pre>
  <br>
  <p>调用函数 MD5 就可以实现加密了</p> 
  <p></p>
  <pre><code class="language-vb">LCase(WordToHex(b) &amp; WordToHex(c))</code></pre>返回的是16位的加密串 
  <p></p>
  <pre><code class="language-vb">LCase(WordToHex(a) &amp; WordToHex(b) &amp; WordToHex(c) &amp; WordToHex(d))</code></pre>返回的是32位的加密串
  <br> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yinyaling/article/details/6736086,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/yinyaling/article/details/6736086,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
