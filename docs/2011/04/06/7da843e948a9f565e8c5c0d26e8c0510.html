<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>利用OpenSSL生成的私钥、公钥和证书，用来验证文件是否被修改 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="利用OpenSSL生成的私钥、公钥和证书，用来验证文件是否被修改" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="私钥格式： -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: DES-EDE3-CBC,9F1B06DE4A9C9270 LIM0SMeBTPJ2+2Qgpk0hhowbEK+YwkPr1SdRpVFIEGe4c4rlUXbN/byHuVGat3vA tux730350dYKFjMWgg+mczjNkSgWHDnooGWHXGrs0nAd8nrP+39y0C+rG0VGu0k1 NsWwC+d6cOJOZ4UP3H7CxY3hr2+0nAPC93hCpByrN/kADvoNoH+tUQH1JNIkLbLi vujQS+ExlhA84/0YlaskCffGDMA9tVRYzISTXxw7WXVEKvUkSqsEdvWiDPMev4z2 hP1oCo/TCZQb2i7Um6aI1be6Y86G82syfK0Gpk0Lar6febV8aeXXFJSGR2+HoVpB uRDtDIPpk8kmW0UVJed7eO/uU5Y7nKbHD1xSigjI7JJd7d8imJ6FyM4ALlXFEdhl DaIHZ91AXcV683LY/poLCPG1wTJQOrFlEu2I93QWIkLBQdmIoN1KJG1nYkFOrla0 AzAbJqFOAK0XbDQI5JGbcyb6QQ03bdks91nG/GLW2Nh/3OA7DqnUt127mrZRPe8N /LUT+1+iToYDXDQg8TMWtNwJySHVVd83vb4Pw5pQA+tsB4kM1p/S2ss8qD2fLh6V 9yG7Wrpdm5tT/3xRZGw/IoLS34iEoIk0Jy5WgFsPcWamVrJzoBhYKiyxZ/x2n3dX qlatSgDDcQVlpSW44uVORpYj0PKgY7v6J3qsN/x+/4VBQ3v4Bbfm50m8BvfqR+Ms akQ+42jLks/jUXPXbnSBDVGQIkr6VgCl+bAtv01SAjCLoxYf1UQMZHSMUv2ATeZO bMRonj54wkm8T7ZairSq44KvRUeo+eMLjrqjW/bnCiY29QI/GFOK1Q== -----END RSA PRIVATE KEY----- &nbsp; 证书中包含了公钥，在BEGIN CERTIFICATE和END CERTIFICATE之间，通常情况下是把证书中的公钥提取出来解密，其格式如下： Certificate: Data: Version: 1 (0x0) Serial Number: 2 (0x2) Signature Algorithm: md5WithRSAEncryption Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea Validity Not Before: May 8 01:22:20 2007 GMT Not After : May 7 01:22:20 2008 GMT Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea Subject Public Key Info: Public Key Algorithm: rsaEncryption RSA Public Key: (1024 bit) Modulus (1024 bit): 00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: 8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: 0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: 99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: 69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: 1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: ca:81:d2:ec:d9:02:03:0e:d1 Exponent: 65537 (0x10001) Signature Algorithm: md5WithRSAEncryption 7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: 9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: 0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: 4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: 5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: f4:66 -----BEGIN CERTIFICATE----- MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy 9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= -----END CERTIFICATE----- &nbsp; 验证文件是否被修改的代码如下： const char *certbuf=&quot;Certificate: / Data: / Version: 1 (0x0) / Serial Number: 2 (0x2) / Signature Algorithm: md5WithRSAEncryption / Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea / Validity / Not Before: May 8 01:22:20 2007 GMT / Not After : May 7 01:22:20 2008 GMT / Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea / Subject Public Key Info: / Public Key Algorithm: rsaEncryption / RSA Public Key: (1024 bit) / Modulus (1024 bit): / 00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: / bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: / 8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: / 0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: / f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: / 99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: / 69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: / 1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: / ca:81:d2:ec:d9:02:03:0e:d1 / Exponent: 65537 (0x10001) / Signature Algorithm: md5WithRSAEncryption / 7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: / fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: / 9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: / 0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: / 4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: / 5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: / cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: / f4:66 / -----BEGIN CERTIFICATE----- / MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV / BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL / EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w / NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G / A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 / ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG / CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB / ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck / QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy / 9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN / AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ / XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz / h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= / -----END CERTIFICATE-----&quot;; #define RSA_ENC_SIZE 128 #define KERNEL_SIZE 2*1024*1024 int verify(const unsigned char *buf,char *signature) { uart_init(); puts(&quot;signature is/n&quot;); int j; for(j=0;j&lt;RSA_ENC_SIZE;j++) puthex(signature[j]); puts(&quot;/n&quot;); sslRsaKey_t *pubkey=NULL; if(X509ReadPubKey(certbuf,&amp;pubkey)==-1) { puts(&quot;read pubkey error/n&quot;); if(pubkey) matrixRsaFreeKey(pubkey); return -1; } char kernelhash[SHA1_HASH_SIZE]={0}; matrixRsaDecryptPub(0, pubkey, signature,RSA_ENC_SIZE,kernelhash, SHA1_HASH_SIZE); if(pubkey) matrixRsaFreeKey(pubkey); puts(&quot;pre_hash:/n&quot;); int ii; for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++) { puthex(kernelhash[ii]); } puts(&quot;/n&quot;); unsigned char tmp[SHA1_HASH_SIZE]; hash_state md; matrixSha1Init(&amp;md); matrixSha1Update(&amp;md,buf,KERNEL_SIZE); matrixSha1Final(&amp;md, tmp); puts(&quot;kenel hash:/n&quot;); for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++) puthex(tmp[ii]); puts(&quot;/n&quot;); return memcmp(tmp,kernelhash,SHA1_HASH_SIZE); } &nbsp; 阅读更多" />
<meta property="og:description" content="私钥格式： -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: DES-EDE3-CBC,9F1B06DE4A9C9270 LIM0SMeBTPJ2+2Qgpk0hhowbEK+YwkPr1SdRpVFIEGe4c4rlUXbN/byHuVGat3vA tux730350dYKFjMWgg+mczjNkSgWHDnooGWHXGrs0nAd8nrP+39y0C+rG0VGu0k1 NsWwC+d6cOJOZ4UP3H7CxY3hr2+0nAPC93hCpByrN/kADvoNoH+tUQH1JNIkLbLi vujQS+ExlhA84/0YlaskCffGDMA9tVRYzISTXxw7WXVEKvUkSqsEdvWiDPMev4z2 hP1oCo/TCZQb2i7Um6aI1be6Y86G82syfK0Gpk0Lar6febV8aeXXFJSGR2+HoVpB uRDtDIPpk8kmW0UVJed7eO/uU5Y7nKbHD1xSigjI7JJd7d8imJ6FyM4ALlXFEdhl DaIHZ91AXcV683LY/poLCPG1wTJQOrFlEu2I93QWIkLBQdmIoN1KJG1nYkFOrla0 AzAbJqFOAK0XbDQI5JGbcyb6QQ03bdks91nG/GLW2Nh/3OA7DqnUt127mrZRPe8N /LUT+1+iToYDXDQg8TMWtNwJySHVVd83vb4Pw5pQA+tsB4kM1p/S2ss8qD2fLh6V 9yG7Wrpdm5tT/3xRZGw/IoLS34iEoIk0Jy5WgFsPcWamVrJzoBhYKiyxZ/x2n3dX qlatSgDDcQVlpSW44uVORpYj0PKgY7v6J3qsN/x+/4VBQ3v4Bbfm50m8BvfqR+Ms akQ+42jLks/jUXPXbnSBDVGQIkr6VgCl+bAtv01SAjCLoxYf1UQMZHSMUv2ATeZO bMRonj54wkm8T7ZairSq44KvRUeo+eMLjrqjW/bnCiY29QI/GFOK1Q== -----END RSA PRIVATE KEY----- &nbsp; 证书中包含了公钥，在BEGIN CERTIFICATE和END CERTIFICATE之间，通常情况下是把证书中的公钥提取出来解密，其格式如下： Certificate: Data: Version: 1 (0x0) Serial Number: 2 (0x2) Signature Algorithm: md5WithRSAEncryption Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea Validity Not Before: May 8 01:22:20 2007 GMT Not After : May 7 01:22:20 2008 GMT Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea Subject Public Key Info: Public Key Algorithm: rsaEncryption RSA Public Key: (1024 bit) Modulus (1024 bit): 00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: 8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: 0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: 99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: 69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: 1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: ca:81:d2:ec:d9:02:03:0e:d1 Exponent: 65537 (0x10001) Signature Algorithm: md5WithRSAEncryption 7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: 9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: 0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: 4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: 5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: f4:66 -----BEGIN CERTIFICATE----- MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy 9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= -----END CERTIFICATE----- &nbsp; 验证文件是否被修改的代码如下： const char *certbuf=&quot;Certificate: / Data: / Version: 1 (0x0) / Serial Number: 2 (0x2) / Signature Algorithm: md5WithRSAEncryption / Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea / Validity / Not Before: May 8 01:22:20 2007 GMT / Not After : May 7 01:22:20 2008 GMT / Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea / Subject Public Key Info: / Public Key Algorithm: rsaEncryption / RSA Public Key: (1024 bit) / Modulus (1024 bit): / 00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: / bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: / 8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: / 0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: / f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: / 99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: / 69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: / 1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: / ca:81:d2:ec:d9:02:03:0e:d1 / Exponent: 65537 (0x10001) / Signature Algorithm: md5WithRSAEncryption / 7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: / fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: / 9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: / 0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: / 4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: / 5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: / cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: / f4:66 / -----BEGIN CERTIFICATE----- / MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV / BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL / EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w / NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G / A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 / ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG / CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB / ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck / QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy / 9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN / AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ / XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz / h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= / -----END CERTIFICATE-----&quot;; #define RSA_ENC_SIZE 128 #define KERNEL_SIZE 2*1024*1024 int verify(const unsigned char *buf,char *signature) { uart_init(); puts(&quot;signature is/n&quot;); int j; for(j=0;j&lt;RSA_ENC_SIZE;j++) puthex(signature[j]); puts(&quot;/n&quot;); sslRsaKey_t *pubkey=NULL; if(X509ReadPubKey(certbuf,&amp;pubkey)==-1) { puts(&quot;read pubkey error/n&quot;); if(pubkey) matrixRsaFreeKey(pubkey); return -1; } char kernelhash[SHA1_HASH_SIZE]={0}; matrixRsaDecryptPub(0, pubkey, signature,RSA_ENC_SIZE,kernelhash, SHA1_HASH_SIZE); if(pubkey) matrixRsaFreeKey(pubkey); puts(&quot;pre_hash:/n&quot;); int ii; for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++) { puthex(kernelhash[ii]); } puts(&quot;/n&quot;); unsigned char tmp[SHA1_HASH_SIZE]; hash_state md; matrixSha1Init(&amp;md); matrixSha1Update(&amp;md,buf,KERNEL_SIZE); matrixSha1Final(&amp;md, tmp); puts(&quot;kenel hash:/n&quot;); for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++) puthex(tmp[ii]); puts(&quot;/n&quot;); return memcmp(tmp,kernelhash,SHA1_HASH_SIZE); } &nbsp; 阅读更多" />
<link rel="canonical" href="https://mlh.app/2011/04/06/7da843e948a9f565e8c5c0d26e8c0510.html" />
<meta property="og:url" content="https://mlh.app/2011/04/06/7da843e948a9f565e8c5c0d26e8c0510.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-04-06T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"私钥格式： -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: DES-EDE3-CBC,9F1B06DE4A9C9270 LIM0SMeBTPJ2+2Qgpk0hhowbEK+YwkPr1SdRpVFIEGe4c4rlUXbN/byHuVGat3vA tux730350dYKFjMWgg+mczjNkSgWHDnooGWHXGrs0nAd8nrP+39y0C+rG0VGu0k1 NsWwC+d6cOJOZ4UP3H7CxY3hr2+0nAPC93hCpByrN/kADvoNoH+tUQH1JNIkLbLi vujQS+ExlhA84/0YlaskCffGDMA9tVRYzISTXxw7WXVEKvUkSqsEdvWiDPMev4z2 hP1oCo/TCZQb2i7Um6aI1be6Y86G82syfK0Gpk0Lar6febV8aeXXFJSGR2+HoVpB uRDtDIPpk8kmW0UVJed7eO/uU5Y7nKbHD1xSigjI7JJd7d8imJ6FyM4ALlXFEdhl DaIHZ91AXcV683LY/poLCPG1wTJQOrFlEu2I93QWIkLBQdmIoN1KJG1nYkFOrla0 AzAbJqFOAK0XbDQI5JGbcyb6QQ03bdks91nG/GLW2Nh/3OA7DqnUt127mrZRPe8N /LUT+1+iToYDXDQg8TMWtNwJySHVVd83vb4Pw5pQA+tsB4kM1p/S2ss8qD2fLh6V 9yG7Wrpdm5tT/3xRZGw/IoLS34iEoIk0Jy5WgFsPcWamVrJzoBhYKiyxZ/x2n3dX qlatSgDDcQVlpSW44uVORpYj0PKgY7v6J3qsN/x+/4VBQ3v4Bbfm50m8BvfqR+Ms akQ+42jLks/jUXPXbnSBDVGQIkr6VgCl+bAtv01SAjCLoxYf1UQMZHSMUv2ATeZO bMRonj54wkm8T7ZairSq44KvRUeo+eMLjrqjW/bnCiY29QI/GFOK1Q== -----END RSA PRIVATE KEY----- &nbsp; 证书中包含了公钥，在BEGIN CERTIFICATE和END CERTIFICATE之间，通常情况下是把证书中的公钥提取出来解密，其格式如下： Certificate: Data: Version: 1 (0x0) Serial Number: 2 (0x2) Signature Algorithm: md5WithRSAEncryption Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea Validity Not Before: May 8 01:22:20 2007 GMT Not After : May 7 01:22:20 2008 GMT Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea Subject Public Key Info: Public Key Algorithm: rsaEncryption RSA Public Key: (1024 bit) Modulus (1024 bit): 00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: 8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: 0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: 99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: 69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: 1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: ca:81:d2:ec:d9:02:03:0e:d1 Exponent: 65537 (0x10001) Signature Algorithm: md5WithRSAEncryption 7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: 9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: 0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: 4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: 5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: f4:66 -----BEGIN CERTIFICATE----- MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy 9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= -----END CERTIFICATE----- &nbsp; 验证文件是否被修改的代码如下： const char *certbuf=&quot;Certificate: / Data: / Version: 1 (0x0) / Serial Number: 2 (0x2) / Signature Algorithm: md5WithRSAEncryption / Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea / Validity / Not Before: May 8 01:22:20 2007 GMT / Not After : May 7 01:22:20 2008 GMT / Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea / Subject Public Key Info: / Public Key Algorithm: rsaEncryption / RSA Public Key: (1024 bit) / Modulus (1024 bit): / 00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: / bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: / 8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: / 0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: / f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: / 99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: / 69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: / 1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: / ca:81:d2:ec:d9:02:03:0e:d1 / Exponent: 65537 (0x10001) / Signature Algorithm: md5WithRSAEncryption / 7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: / fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: / 9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: / 0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: / 4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: / 5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: / cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: / f4:66 / -----BEGIN CERTIFICATE----- / MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV / BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL / EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w / NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G / A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 / ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG / CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB / ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck / QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy / 9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN / AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ / XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz / h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= / -----END CERTIFICATE-----&quot;; #define RSA_ENC_SIZE 128 #define KERNEL_SIZE 2*1024*1024 int verify(const unsigned char *buf,char *signature) { uart_init(); puts(&quot;signature is/n&quot;); int j; for(j=0;j&lt;RSA_ENC_SIZE;j++) puthex(signature[j]); puts(&quot;/n&quot;); sslRsaKey_t *pubkey=NULL; if(X509ReadPubKey(certbuf,&amp;pubkey)==-1) { puts(&quot;read pubkey error/n&quot;); if(pubkey) matrixRsaFreeKey(pubkey); return -1; } char kernelhash[SHA1_HASH_SIZE]={0}; matrixRsaDecryptPub(0, pubkey, signature,RSA_ENC_SIZE,kernelhash, SHA1_HASH_SIZE); if(pubkey) matrixRsaFreeKey(pubkey); puts(&quot;pre_hash:/n&quot;); int ii; for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++) { puthex(kernelhash[ii]); } puts(&quot;/n&quot;); unsigned char tmp[SHA1_HASH_SIZE]; hash_state md; matrixSha1Init(&amp;md); matrixSha1Update(&amp;md,buf,KERNEL_SIZE); matrixSha1Final(&amp;md, tmp); puts(&quot;kenel hash:/n&quot;); for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++) puthex(tmp[ii]); puts(&quot;/n&quot;); return memcmp(tmp,kernelhash,SHA1_HASH_SIZE); } &nbsp; 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2011/04/06/7da843e948a9f565e8c5c0d26e8c0510.html","headline":"利用OpenSSL生成的私钥、公钥和证书，用来验证文件是否被修改","dateModified":"2011-04-06T00:00:00+08:00","datePublished":"2011-04-06T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2011/04/06/7da843e948a9f565e8c5c0d26e8c0510.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>利用OpenSSL生成的私钥、公钥和证书，用来验证文件是否被修改</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p>私钥格式：</p> 
  <p><textarea cols="69" rows="15" name="code" class="c-sharp">-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,9F1B06DE4A9C9270

LIM0SMeBTPJ2+2Qgpk0hhowbEK+YwkPr1SdRpVFIEGe4c4rlUXbN/byHuVGat3vA
tux730350dYKFjMWgg+mczjNkSgWHDnooGWHXGrs0nAd8nrP+39y0C+rG0VGu0k1
NsWwC+d6cOJOZ4UP3H7CxY3hr2+0nAPC93hCpByrN/kADvoNoH+tUQH1JNIkLbLi
vujQS+ExlhA84/0YlaskCffGDMA9tVRYzISTXxw7WXVEKvUkSqsEdvWiDPMev4z2
hP1oCo/TCZQb2i7Um6aI1be6Y86G82syfK0Gpk0Lar6febV8aeXXFJSGR2+HoVpB
uRDtDIPpk8kmW0UVJed7eO/uU5Y7nKbHD1xSigjI7JJd7d8imJ6FyM4ALlXFEdhl
DaIHZ91AXcV683LY/poLCPG1wTJQOrFlEu2I93QWIkLBQdmIoN1KJG1nYkFOrla0
AzAbJqFOAK0XbDQI5JGbcyb6QQ03bdks91nG/GLW2Nh/3OA7DqnUt127mrZRPe8N
/LUT+1+iToYDXDQg8TMWtNwJySHVVd83vb4Pw5pQA+tsB4kM1p/S2ss8qD2fLh6V
9yG7Wrpdm5tT/3xRZGw/IoLS34iEoIk0Jy5WgFsPcWamVrJzoBhYKiyxZ/x2n3dX
qlatSgDDcQVlpSW44uVORpYj0PKgY7v6J3qsN/x+/4VBQ3v4Bbfm50m8BvfqR+Ms
akQ+42jLks/jUXPXbnSBDVGQIkr6VgCl+bAtv01SAjCLoxYf1UQMZHSMUv2ATeZO
bMRonj54wkm8T7ZairSq44KvRUeo+eMLjrqjW/bnCiY29QI/GFOK1Q==
-----END RSA PRIVATE KEY-----
</textarea></p> 
  <p>&nbsp;</p> 
  <p>证书中包含了公钥，在BEGIN CERTIFICATE和END CERTIFICATE之间，通常情况下是把证书中的公钥提取出来解密，其格式如下：</p> 
  <p><textarea cols="70" rows="15" name="code" class="c-sharp">Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 2 (0x2)
        Signature Algorithm: md5WithRSAEncryption
        Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea
        Validity
            Not Before: May  8 01:22:20 2007 GMT
            Not After : May  7 01:22:20 2008 GMT
        Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
            RSA Public Key: (1024 bit)
                Modulus (1024 bit):
                    00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a:
                    bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1:
                    8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4:
                    0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b:
                    f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac:
                    99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c:
                    69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d:
                    1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38:
                    ca:81:d2:ec:d9:02:03:0e:d1
                Exponent: 65537 (0x10001)
    Signature Algorithm: md5WithRSAEncryption
        7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e:
        fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5:
        9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18:
        0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01:
        4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab:
        5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7:
        cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94:
        f4:66
-----BEGIN CERTIFICATE-----
MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV
BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL
EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w
NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G
A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2
ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG
CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB
ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck
QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy
9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN
AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ
XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz
h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY=
-----END CERTIFICATE-----
</textarea></p> 
  <p>&nbsp;</p> 
  <p>验证文件是否被修改的代码如下：</p> 
  <p><textarea cols="69" rows="15" name="code" class="c-sharp">const  char *certbuf="Certificate: /
    Data: /
        Version: 1 (0x0) /
        Serial Number: 2 (0x2) /
        Signature Algorithm: md5WithRSAEncryption /
        Issuer: C=ca, ST=caspn, L=caln, O=caon, OU=caoun, CN=cacn/emailAddress=caea /
        Validity /
            Not Before: May  8 01:22:20 2007 GMT /
            Not After : May  7 01:22:20 2008 GMT /
        Subject: C=cn, ST=serversp, L=serverln, O=serveron, OU=serveroun, CN=servercn/emailAddress=serverea /
        Subject Public Key Info: /
            Public Key Algorithm: rsaEncryption /
            RSA Public Key: (1024 bit) /
                Modulus (1024 bit): /
                    00:b7:e4:e1:d3:04:aa:d0:24:7b:94:ab:7b:78:2a: /
                    bf:78:9f:f4:18:aa:81:bc:c7:cb:23:e2:59:26:d1: /
                    8e:84:04:44:b5:bb:31:34:5b:93:48:35:f8:c1:a4: /
                    0a:17:24:41:e5:76:be:91:74:c1:31:03:14:b4:3b: /
                    f4:ad:d2:f9:de:3c:f1:42:80:73:99:86:63:8a:ac: /
                    99:d7:cc:f0:a8:eb:61:09:42:65:0a:01:cf:ba:0c: /
                    69:26:5b:66:34:f2:f7:28:20:7a:d2:08:d5:be:1d: /
                    1e:65:c5:11:4b:52:ed:ac:f2:c9:35:79:9d:6b:38: /
                    ca:81:d2:ec:d9:02:03:0e:d1 /
                Exponent: 65537 (0x10001) /
    Signature Algorithm: md5WithRSAEncryption /
        7a:9b:b2:d1:14:18:c1:5e:e7:1b:8e:70:27:9a:4d:87:6d:1e: /
        fd:e6:bb:28:f5:0c:c5:2c:b6:38:75:0d:31:4c:f4:9b:1e:f5: /
        9f:23:09:5e:a3:00:37:8f:af:56:c1:a5:0e:a6:8a:46:6f:18: /
        0d:8d:bc:49:d5:11:9f:6a:77:9b:2e:18:89:12:66:d9:21:01: /
        4f:86:a2:de:cb:6b:c3:fe:39:a9:be:f3:5d:06:b3:87:93:ab: /
        5b:a9:14:b9:8d:91:06:43:b3:8c:0d:f2:72:35:f8:88:37:c7: /
        cf:ac:7b:21:a5:19:a9:e9:b0:2c:2d:26:9d:3d:19:4d:ec:94: /
        f4:66 /
-----BEGIN CERTIFICATE----- /
MIICZTCCAc4CAQIwDQYJKoZIhvcNAQEEBQAwbzELMAkGA1UEBhMCY2ExDjAMBgNV /
BAgTBWNhc3BuMQ0wCwYDVQQHEwRjYWxuMQ0wCwYDVQQKEwRjYW9uMQ4wDAYDVQQL /
EwVjYW91bjENMAsGA1UEAxMEY2FjbjETMBEGCSqGSIb3DQEJARYEY2FlYTAeFw0w /
NzA1MDgwMTIyMjBaFw0wODA1MDcwMTIyMjBaMIGGMQswCQYDVQQGEwJjbjERMA8G /
A1UECBMIc2VydmVyc3AxETAPBgNVBAcTCHNlcnZlcmxuMREwDwYDVQQKEwhzZXJ2 /
ZXJvbjESMBAGA1UECxMJc2VydmVyb3VuMREwDwYDVQQDEwhzZXJ2ZXJjbjEXMBUG /
CSqGSIb3DQEJARYIc2VydmVyZWEwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGB /
ALfk4dMEqtAke5Sre3gqv3if9BiqgbzHyyPiWSbRjoQERLW7MTRbk0g1+MGkChck /
QeV2vpF0wTEDFLQ79K3S+d488UKAc5mGY4qsmdfM8KjrYQlCZQoBz7oMaSZbZjTy /
9yggetII1b4dHmXFEUtS7azyyTV5nWs4yoHS7NkCAw7RAgMBAAEwDQYJKoZIhvcN /
AQEEBQADgYEAepuy0RQYwV7nG45wJ5pNh20e/ea7KPUMxSy2OHUNMUz0mx71nyMJ /
XqMAN4+vVsGlDqaKRm8YDY28SdURn2p3my4YiRJm2SEBT4ai3strw/45qb7zXQaz /
h5OrW6kUuY2RBkOzjA3ycjX4iDfHz6x7IaUZqemwLC0mnT0ZTeyU9GY= /
-----END CERTIFICATE-----";


#define RSA_ENC_SIZE  128
#define KERNEL_SIZE  2*1024*1024

int verify(const unsigned char *buf,char *signature)
{

	uart_init();
	puts("signature is/n");
	int j;
	for(j=0;j&lt;RSA_ENC_SIZE;j++)
		puthex(signature[j]);
	puts("/n");
       sslRsaKey_t *pubkey=NULL;
       if(X509ReadPubKey(certbuf,&amp;pubkey)==-1)
	{
		puts("read pubkey error/n");
		if(pubkey)
		matrixRsaFreeKey(pubkey);
		return -1;
	}
  
	char kernelhash[SHA1_HASH_SIZE]={0};
	matrixRsaDecryptPub(0, pubkey, signature,RSA_ENC_SIZE,kernelhash, SHA1_HASH_SIZE);
	if(pubkey)
		matrixRsaFreeKey(pubkey);

	
	puts("pre_hash:/n");
	int ii;
	for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++)
		{
		puthex(kernelhash[ii]);
		}
	puts("/n");

	unsigned char tmp[SHA1_HASH_SIZE];
	hash_state md;
	matrixSha1Init(&amp;md);
	matrixSha1Update(&amp;md,buf,KERNEL_SIZE);
	matrixSha1Final(&amp;md, tmp);

	puts("kenel hash:/n");
	for(ii=0;ii&lt;SHA1_HASH_SIZE;ii++)
		puthex(tmp[ii]);
	puts("/n");
	return memcmp(tmp,kernelhash,SHA1_HASH_SIZE);
			
}

</textarea></p> 
  <p>&nbsp;</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/moruite/article/details/6305748,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/moruite/article/details/6305748,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
