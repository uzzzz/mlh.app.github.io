<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>用C++来实现MD5的生成~~ | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="用C++来实现MD5的生成~~" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="用C++来实现MD5的生成~~ MD5 C++实现 Type:完整代码&nbsp;Category:其它&nbsp;License:GNU General Public License&nbsp;Language:C++&nbsp;Description:MD5 C++实现 这个代码的版本：1.0 最新代码版本： :1.0 #pragma once //Author:ArcherSC //JLU namespace ENCRPYTION{class MD5{private:&nbsp;&nbsp;&nbsp; unsigned int m_Content[16];&nbsp;&nbsp;&nbsp; unsigned int m_ContentLen;&nbsp;&nbsp;&nbsp; unsigned int m_TotalLen;&nbsp;&nbsp;&nbsp; static unsigned int m_T[64];&nbsp;&nbsp;&nbsp; unsigned int m_A, m_B, m_C, m_D;private:&nbsp;&nbsp;&nbsp; inline void FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline unsigned int roateLeft(unsigned int a, unsigned int c); &nbsp;&nbsp;&nbsp; void transform();public:&nbsp;&nbsp;&nbsp; //初始化&nbsp;&nbsp;&nbsp; void beginCal();&nbsp;&nbsp;&nbsp; //表明不再输入数据了，将添加填充位&nbsp;&nbsp;&nbsp; void endCal();&nbsp;&nbsp;&nbsp; //初始化后，输入数据，在调用endCal前，都可以继续添加数据&nbsp;&nbsp;&nbsp; void addData(const char* data, unsigned int size);&nbsp;&nbsp;&nbsp; //结束运算后，取得编码&nbsp;&nbsp;&nbsp; char* getCode();&nbsp;&nbsp;&nbsp; void&nbsp;&nbsp;&nbsp; clearMemoryHelper(char* p);};}#include &quot;MD5.h&quot;#include &lt;cstdlib&gt;#include &lt;cstring&gt; //Author:ArcherSC //JLU namespace ENCRPYTION{using namespace std;unsigned int MD5::m_T[64] = {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD76aa478, 0xE8C7B756, 0x242070DB, 0xC1BDCEEE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF57C0FAF, 0x4787C62A, 0xA8304613, 0xFD469501,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x698098D8, 0x8B44F7AF, 0xFFFF5BB1, 0x895CD7BE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6B901122, 0xFD987193, 0xA679438E, 0x49B40821,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF61E2562, 0xC040B340, 0x265E5A51, 0xE9B6C7AA,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD62F105D, 0x02441453, 0xD8A1E681, 0xE7D3FBC8,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x21E1CDE6, 0xC33707D6, 0xF4D50D87, 0x455A14ED,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA9E3E905, 0xFCEFA3F8, 0x676F02D9, 0x8D2A4C8A,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xFFFA3942, 0x8771F681, 0x6D9D6122, 0xFDE5380C,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA4BEEA44, 0x4BDECFA9, 0xF6BB4B60, 0xBEBFBC70,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x289B7EC6, 0xEAA127FA, 0xD4EF3085, 0x04881D05,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD9D4D039, 0xE6DB99E5, 0x1FA27CF8, 0xC4AC5665,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF4292244, 0x432AFF97, 0xAB9423A7, 0xFC93A039,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x655B59C3, 0x8F0CCC92, 0xFFEFF47D, 0x85845DD1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6FA87E4F, 0xFE2CE6E0, 0xA3014314, 0x4E0811A1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF7537E82, 0xBD3AF235, 0x2AD7D2BB, 0xEB86D391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }; void MD5::FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; c) | ((~b) &amp; d)) + m_Content[k] + m_T[i], s);}void MD5::GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; d) | (c &amp; (~d))) + m_Content[k] + m_T[i], s);}void MD5::HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (b ^ c ^ d) + m_Content[k] + m_T[i], s);}void MD5::II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (c ^ (b | (~d))) + m_Content[k] + m_T[i], s);}unsigned int MD5::roateLeft(unsigned int a, unsigned int c){&nbsp;&nbsp;&nbsp; return ( (a &lt;&lt; c) | (a &gt;&gt; (32-c)) );} void MD5::transform(){&nbsp;&nbsp;&nbsp; unsigned int AA, BB, CC, DD;&nbsp;&nbsp;&nbsp; AA = m_A;&nbsp;&nbsp;&nbsp; BB = m_B;&nbsp;&nbsp;&nbsp; CC = m_C;&nbsp;&nbsp;&nbsp; DD = m_D;&nbsp;&nbsp;&nbsp; //1 round&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 0, 0, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 1, 1, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 2, 2, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 3, 3, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 4, 4, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 5, 5, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 6, 6, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 7, 7, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 8, 8, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 9, 9, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 10, 10, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 11, 11, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 12, 12, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 13, 13, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 14, 14, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 15, 15, 22);&nbsp;&nbsp;&nbsp; //2 round&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 1, 16, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 6, 17, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 11, 18, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 0, 19, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 5, 20, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 10, 21, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 15, 22, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 4, 23, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 9, 24, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 14, 25, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 3, 26, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 8, 27, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 13, 28, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 2, 29, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 7, 30, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 12, 31, 20); &nbsp;&nbsp;&nbsp; //3 round&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 5, 32, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 8, 33, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 11, 34, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 14, 35, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 1, 36, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 4, 37, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 7, 38, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 10, 39, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 13, 40, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 0, 41, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 3, 42, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 6, 43, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 9, 44, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 12, 45, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 15, 46, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 2, 47, 23); &nbsp;&nbsp;&nbsp; //4 round&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 0, 48, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 7, 49, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 14, 50, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 5, 51, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 12, 52, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 3, 53, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 10, 54, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 1, 55, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 8, 56, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 15, 57, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 6, 58, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 13, 59, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 4, 60, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 11, 61, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 2, 62, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 9, 63, 21);&nbsp;&nbsp;&nbsp; m_A = m_A + AA;&nbsp;&nbsp;&nbsp; m_B = m_B + BB;&nbsp;&nbsp;&nbsp; m_C = m_C + CC;&nbsp;&nbsp;&nbsp; m_D = m_D + DD;}//初始化void MD5::beginCal(){&nbsp;&nbsp;&nbsp; memset(m_Content, 0, 64);&nbsp;&nbsp;&nbsp; m_ContentLen = 0;&nbsp;&nbsp;&nbsp; m_TotalLen = 0;&nbsp;&nbsp;&nbsp; m_A = 0x67452301;&nbsp;&nbsp;&nbsp; m_B = 0xEFCDAB89;&nbsp;&nbsp;&nbsp; m_C = 0x98BADCFE;&nbsp;&nbsp;&nbsp; m_D = 0x10325476;} void MD5::endCal(){&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen, 0x80, 1);&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 56){&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 55 - m_ContentLen);&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; else{&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 63 - m_ContentLen);&nbsp;&nbsp;&nbsp;&nbsp; transform();&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content, 0, 56);&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; unsigned int h, l;&nbsp;&nbsp;&nbsp; h = 0;&nbsp;&nbsp;&nbsp; l = m_TotalLen;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; memcpy(m_Content + 14, &amp;l, 4);&nbsp;&nbsp;&nbsp; memcpy(m_Content + 15, &amp;h, 4);&nbsp;&nbsp;&nbsp; transform();} void MD5::addData(const char* data, unsigned int size){&nbsp;&nbsp;&nbsp; unsigned int i = 0;&nbsp;&nbsp;&nbsp; unsigned int remain = 64 - m_ContentLen;&nbsp;&nbsp;&nbsp; if (remain &gt; size)&nbsp;&nbsp;&nbsp;&nbsp; remain = size;&nbsp;&nbsp;&nbsp; memcpy(((char*)m_Content) + m_ContentLen, data, remain);&nbsp;&nbsp;&nbsp; i += remain;&nbsp;&nbsp;&nbsp; m_ContentLen += remain;&nbsp;&nbsp;&nbsp; m_TotalLen += remain;&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 64)&nbsp;&nbsp;&nbsp;&nbsp; return; &nbsp;&nbsp;&nbsp; transform(); &nbsp;&nbsp;&nbsp; while (i + 64 &lt;= size){&nbsp;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, 64);&nbsp;&nbsp;&nbsp;&nbsp; transform();&nbsp;&nbsp;&nbsp;&nbsp; i += 64;&nbsp;&nbsp;&nbsp;&nbsp; m_TotalLen += 64;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp; m_ContentLen = size - i;&nbsp;&nbsp;&nbsp; m_TotalLen += m_ContentLen;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, m_ContentLen);} char* MD5::getCode(){&nbsp;&nbsp;&nbsp; char * code = new char[16];&nbsp;&nbsp;&nbsp; memcpy(code, &amp;m_A, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 4, &amp;m_B, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 8, &amp;m_C, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 12, &amp;m_D, 4);&nbsp;&nbsp;&nbsp; return code;}void&nbsp;&nbsp;&nbsp; MD5::clearMemoryHelper(char* p){&nbsp;&nbsp;&nbsp; delete []p;}} 阅读更多" />
<meta property="og:description" content="用C++来实现MD5的生成~~ MD5 C++实现 Type:完整代码&nbsp;Category:其它&nbsp;License:GNU General Public License&nbsp;Language:C++&nbsp;Description:MD5 C++实现 这个代码的版本：1.0 最新代码版本： :1.0 #pragma once //Author:ArcherSC //JLU namespace ENCRPYTION{class MD5{private:&nbsp;&nbsp;&nbsp; unsigned int m_Content[16];&nbsp;&nbsp;&nbsp; unsigned int m_ContentLen;&nbsp;&nbsp;&nbsp; unsigned int m_TotalLen;&nbsp;&nbsp;&nbsp; static unsigned int m_T[64];&nbsp;&nbsp;&nbsp; unsigned int m_A, m_B, m_C, m_D;private:&nbsp;&nbsp;&nbsp; inline void FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline unsigned int roateLeft(unsigned int a, unsigned int c); &nbsp;&nbsp;&nbsp; void transform();public:&nbsp;&nbsp;&nbsp; //初始化&nbsp;&nbsp;&nbsp; void beginCal();&nbsp;&nbsp;&nbsp; //表明不再输入数据了，将添加填充位&nbsp;&nbsp;&nbsp; void endCal();&nbsp;&nbsp;&nbsp; //初始化后，输入数据，在调用endCal前，都可以继续添加数据&nbsp;&nbsp;&nbsp; void addData(const char* data, unsigned int size);&nbsp;&nbsp;&nbsp; //结束运算后，取得编码&nbsp;&nbsp;&nbsp; char* getCode();&nbsp;&nbsp;&nbsp; void&nbsp;&nbsp;&nbsp; clearMemoryHelper(char* p);};}#include &quot;MD5.h&quot;#include &lt;cstdlib&gt;#include &lt;cstring&gt; //Author:ArcherSC //JLU namespace ENCRPYTION{using namespace std;unsigned int MD5::m_T[64] = {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD76aa478, 0xE8C7B756, 0x242070DB, 0xC1BDCEEE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF57C0FAF, 0x4787C62A, 0xA8304613, 0xFD469501,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x698098D8, 0x8B44F7AF, 0xFFFF5BB1, 0x895CD7BE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6B901122, 0xFD987193, 0xA679438E, 0x49B40821,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF61E2562, 0xC040B340, 0x265E5A51, 0xE9B6C7AA,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD62F105D, 0x02441453, 0xD8A1E681, 0xE7D3FBC8,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x21E1CDE6, 0xC33707D6, 0xF4D50D87, 0x455A14ED,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA9E3E905, 0xFCEFA3F8, 0x676F02D9, 0x8D2A4C8A,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xFFFA3942, 0x8771F681, 0x6D9D6122, 0xFDE5380C,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA4BEEA44, 0x4BDECFA9, 0xF6BB4B60, 0xBEBFBC70,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x289B7EC6, 0xEAA127FA, 0xD4EF3085, 0x04881D05,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD9D4D039, 0xE6DB99E5, 0x1FA27CF8, 0xC4AC5665,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF4292244, 0x432AFF97, 0xAB9423A7, 0xFC93A039,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x655B59C3, 0x8F0CCC92, 0xFFEFF47D, 0x85845DD1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6FA87E4F, 0xFE2CE6E0, 0xA3014314, 0x4E0811A1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF7537E82, 0xBD3AF235, 0x2AD7D2BB, 0xEB86D391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }; void MD5::FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; c) | ((~b) &amp; d)) + m_Content[k] + m_T[i], s);}void MD5::GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; d) | (c &amp; (~d))) + m_Content[k] + m_T[i], s);}void MD5::HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (b ^ c ^ d) + m_Content[k] + m_T[i], s);}void MD5::II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (c ^ (b | (~d))) + m_Content[k] + m_T[i], s);}unsigned int MD5::roateLeft(unsigned int a, unsigned int c){&nbsp;&nbsp;&nbsp; return ( (a &lt;&lt; c) | (a &gt;&gt; (32-c)) );} void MD5::transform(){&nbsp;&nbsp;&nbsp; unsigned int AA, BB, CC, DD;&nbsp;&nbsp;&nbsp; AA = m_A;&nbsp;&nbsp;&nbsp; BB = m_B;&nbsp;&nbsp;&nbsp; CC = m_C;&nbsp;&nbsp;&nbsp; DD = m_D;&nbsp;&nbsp;&nbsp; //1 round&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 0, 0, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 1, 1, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 2, 2, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 3, 3, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 4, 4, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 5, 5, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 6, 6, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 7, 7, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 8, 8, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 9, 9, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 10, 10, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 11, 11, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 12, 12, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 13, 13, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 14, 14, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 15, 15, 22);&nbsp;&nbsp;&nbsp; //2 round&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 1, 16, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 6, 17, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 11, 18, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 0, 19, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 5, 20, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 10, 21, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 15, 22, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 4, 23, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 9, 24, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 14, 25, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 3, 26, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 8, 27, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 13, 28, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 2, 29, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 7, 30, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 12, 31, 20); &nbsp;&nbsp;&nbsp; //3 round&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 5, 32, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 8, 33, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 11, 34, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 14, 35, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 1, 36, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 4, 37, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 7, 38, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 10, 39, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 13, 40, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 0, 41, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 3, 42, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 6, 43, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 9, 44, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 12, 45, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 15, 46, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 2, 47, 23); &nbsp;&nbsp;&nbsp; //4 round&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 0, 48, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 7, 49, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 14, 50, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 5, 51, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 12, 52, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 3, 53, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 10, 54, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 1, 55, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 8, 56, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 15, 57, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 6, 58, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 13, 59, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 4, 60, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 11, 61, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 2, 62, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 9, 63, 21);&nbsp;&nbsp;&nbsp; m_A = m_A + AA;&nbsp;&nbsp;&nbsp; m_B = m_B + BB;&nbsp;&nbsp;&nbsp; m_C = m_C + CC;&nbsp;&nbsp;&nbsp; m_D = m_D + DD;}//初始化void MD5::beginCal(){&nbsp;&nbsp;&nbsp; memset(m_Content, 0, 64);&nbsp;&nbsp;&nbsp; m_ContentLen = 0;&nbsp;&nbsp;&nbsp; m_TotalLen = 0;&nbsp;&nbsp;&nbsp; m_A = 0x67452301;&nbsp;&nbsp;&nbsp; m_B = 0xEFCDAB89;&nbsp;&nbsp;&nbsp; m_C = 0x98BADCFE;&nbsp;&nbsp;&nbsp; m_D = 0x10325476;} void MD5::endCal(){&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen, 0x80, 1);&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 56){&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 55 - m_ContentLen);&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; else{&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 63 - m_ContentLen);&nbsp;&nbsp;&nbsp;&nbsp; transform();&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content, 0, 56);&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; unsigned int h, l;&nbsp;&nbsp;&nbsp; h = 0;&nbsp;&nbsp;&nbsp; l = m_TotalLen;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; memcpy(m_Content + 14, &amp;l, 4);&nbsp;&nbsp;&nbsp; memcpy(m_Content + 15, &amp;h, 4);&nbsp;&nbsp;&nbsp; transform();} void MD5::addData(const char* data, unsigned int size){&nbsp;&nbsp;&nbsp; unsigned int i = 0;&nbsp;&nbsp;&nbsp; unsigned int remain = 64 - m_ContentLen;&nbsp;&nbsp;&nbsp; if (remain &gt; size)&nbsp;&nbsp;&nbsp;&nbsp; remain = size;&nbsp;&nbsp;&nbsp; memcpy(((char*)m_Content) + m_ContentLen, data, remain);&nbsp;&nbsp;&nbsp; i += remain;&nbsp;&nbsp;&nbsp; m_ContentLen += remain;&nbsp;&nbsp;&nbsp; m_TotalLen += remain;&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 64)&nbsp;&nbsp;&nbsp;&nbsp; return; &nbsp;&nbsp;&nbsp; transform(); &nbsp;&nbsp;&nbsp; while (i + 64 &lt;= size){&nbsp;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, 64);&nbsp;&nbsp;&nbsp;&nbsp; transform();&nbsp;&nbsp;&nbsp;&nbsp; i += 64;&nbsp;&nbsp;&nbsp;&nbsp; m_TotalLen += 64;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp; m_ContentLen = size - i;&nbsp;&nbsp;&nbsp; m_TotalLen += m_ContentLen;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, m_ContentLen);} char* MD5::getCode(){&nbsp;&nbsp;&nbsp; char * code = new char[16];&nbsp;&nbsp;&nbsp; memcpy(code, &amp;m_A, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 4, &amp;m_B, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 8, &amp;m_C, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 12, &amp;m_D, 4);&nbsp;&nbsp;&nbsp; return code;}void&nbsp;&nbsp;&nbsp; MD5::clearMemoryHelper(char* p){&nbsp;&nbsp;&nbsp; delete []p;}} 阅读更多" />
<link rel="canonical" href="https://mlh.app/2011/05/24/4e0a41137299d4414eb0e29a1a7479a0.html" />
<meta property="og:url" content="https://mlh.app/2011/05/24/4e0a41137299d4414eb0e29a1a7479a0.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-05-24T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"用C++来实现MD5的生成~~ MD5 C++实现 Type:完整代码&nbsp;Category:其它&nbsp;License:GNU General Public License&nbsp;Language:C++&nbsp;Description:MD5 C++实现 这个代码的版本：1.0 最新代码版本： :1.0 #pragma once //Author:ArcherSC //JLU namespace ENCRPYTION{class MD5{private:&nbsp;&nbsp;&nbsp; unsigned int m_Content[16];&nbsp;&nbsp;&nbsp; unsigned int m_ContentLen;&nbsp;&nbsp;&nbsp; unsigned int m_TotalLen;&nbsp;&nbsp;&nbsp; static unsigned int m_T[64];&nbsp;&nbsp;&nbsp; unsigned int m_A, m_B, m_C, m_D;private:&nbsp;&nbsp;&nbsp; inline void FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline void II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);&nbsp;&nbsp;&nbsp; inline unsigned int roateLeft(unsigned int a, unsigned int c); &nbsp;&nbsp;&nbsp; void transform();public:&nbsp;&nbsp;&nbsp; //初始化&nbsp;&nbsp;&nbsp; void beginCal();&nbsp;&nbsp;&nbsp; //表明不再输入数据了，将添加填充位&nbsp;&nbsp;&nbsp; void endCal();&nbsp;&nbsp;&nbsp; //初始化后，输入数据，在调用endCal前，都可以继续添加数据&nbsp;&nbsp;&nbsp; void addData(const char* data, unsigned int size);&nbsp;&nbsp;&nbsp; //结束运算后，取得编码&nbsp;&nbsp;&nbsp; char* getCode();&nbsp;&nbsp;&nbsp; void&nbsp;&nbsp;&nbsp; clearMemoryHelper(char* p);};}#include &quot;MD5.h&quot;#include &lt;cstdlib&gt;#include &lt;cstring&gt; //Author:ArcherSC //JLU namespace ENCRPYTION{using namespace std;unsigned int MD5::m_T[64] = {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD76aa478, 0xE8C7B756, 0x242070DB, 0xC1BDCEEE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF57C0FAF, 0x4787C62A, 0xA8304613, 0xFD469501,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x698098D8, 0x8B44F7AF, 0xFFFF5BB1, 0x895CD7BE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6B901122, 0xFD987193, 0xA679438E, 0x49B40821,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF61E2562, 0xC040B340, 0x265E5A51, 0xE9B6C7AA,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD62F105D, 0x02441453, 0xD8A1E681, 0xE7D3FBC8,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x21E1CDE6, 0xC33707D6, 0xF4D50D87, 0x455A14ED,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA9E3E905, 0xFCEFA3F8, 0x676F02D9, 0x8D2A4C8A,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xFFFA3942, 0x8771F681, 0x6D9D6122, 0xFDE5380C,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA4BEEA44, 0x4BDECFA9, 0xF6BB4B60, 0xBEBFBC70,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x289B7EC6, 0xEAA127FA, 0xD4EF3085, 0x04881D05,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD9D4D039, 0xE6DB99E5, 0x1FA27CF8, 0xC4AC5665,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF4292244, 0x432AFF97, 0xAB9423A7, 0xFC93A039,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x655B59C3, 0x8F0CCC92, 0xFFEFF47D, 0x85845DD1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6FA87E4F, 0xFE2CE6E0, 0xA3014314, 0x4E0811A1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF7537E82, 0xBD3AF235, 0x2AD7D2BB, 0xEB86D391&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }; void MD5::FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; c) | ((~b) &amp; d)) + m_Content[k] + m_T[i], s);}void MD5::GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; d) | (c &amp; (~d))) + m_Content[k] + m_T[i], s);}void MD5::HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (b ^ c ^ d) + m_Content[k] + m_T[i], s);}void MD5::II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s){&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (c ^ (b | (~d))) + m_Content[k] + m_T[i], s);}unsigned int MD5::roateLeft(unsigned int a, unsigned int c){&nbsp;&nbsp;&nbsp; return ( (a &lt;&lt; c) | (a &gt;&gt; (32-c)) );} void MD5::transform(){&nbsp;&nbsp;&nbsp; unsigned int AA, BB, CC, DD;&nbsp;&nbsp;&nbsp; AA = m_A;&nbsp;&nbsp;&nbsp; BB = m_B;&nbsp;&nbsp;&nbsp; CC = m_C;&nbsp;&nbsp;&nbsp; DD = m_D;&nbsp;&nbsp;&nbsp; //1 round&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 0, 0, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 1, 1, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 2, 2, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 3, 3, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 4, 4, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 5, 5, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 6, 6, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 7, 7, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 8, 8, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 9, 9, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 10, 10, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 11, 11, 22);&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 12, 12, 7);&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 13, 13, 12);&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 14, 14, 17);&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 15, 15, 22);&nbsp;&nbsp;&nbsp; //2 round&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 1, 16, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 6, 17, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 11, 18, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 0, 19, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 5, 20, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 10, 21, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 15, 22, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 4, 23, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 9, 24, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 14, 25, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 3, 26, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 8, 27, 20);&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 13, 28, 5);&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 2, 29, 9);&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 7, 30, 14);&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 12, 31, 20); &nbsp;&nbsp;&nbsp; //3 round&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 5, 32, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 8, 33, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 11, 34, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 14, 35, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 1, 36, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 4, 37, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 7, 38, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 10, 39, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 13, 40, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 0, 41, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 3, 42, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 6, 43, 23);&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 9, 44, 4);&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 12, 45, 11);&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 15, 46, 16);&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 2, 47, 23); &nbsp;&nbsp;&nbsp; //4 round&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 0, 48, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 7, 49, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 14, 50, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 5, 51, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 12, 52, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 3, 53, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 10, 54, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 1, 55, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 8, 56, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 15, 57, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 6, 58, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 13, 59, 21);&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 4, 60, 6);&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 11, 61, 10);&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 2, 62, 15);&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 9, 63, 21);&nbsp;&nbsp;&nbsp; m_A = m_A + AA;&nbsp;&nbsp;&nbsp; m_B = m_B + BB;&nbsp;&nbsp;&nbsp; m_C = m_C + CC;&nbsp;&nbsp;&nbsp; m_D = m_D + DD;}//初始化void MD5::beginCal(){&nbsp;&nbsp;&nbsp; memset(m_Content, 0, 64);&nbsp;&nbsp;&nbsp; m_ContentLen = 0;&nbsp;&nbsp;&nbsp; m_TotalLen = 0;&nbsp;&nbsp;&nbsp; m_A = 0x67452301;&nbsp;&nbsp;&nbsp; m_B = 0xEFCDAB89;&nbsp;&nbsp;&nbsp; m_C = 0x98BADCFE;&nbsp;&nbsp;&nbsp; m_D = 0x10325476;} void MD5::endCal(){&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen, 0x80, 1);&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 56){&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 55 - m_ContentLen);&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; else{&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 63 - m_ContentLen);&nbsp;&nbsp;&nbsp;&nbsp; transform();&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content, 0, 56);&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; unsigned int h, l;&nbsp;&nbsp;&nbsp; h = 0;&nbsp;&nbsp;&nbsp; l = m_TotalLen;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;&nbsp;&nbsp;&nbsp; memcpy(m_Content + 14, &amp;l, 4);&nbsp;&nbsp;&nbsp; memcpy(m_Content + 15, &amp;h, 4);&nbsp;&nbsp;&nbsp; transform();} void MD5::addData(const char* data, unsigned int size){&nbsp;&nbsp;&nbsp; unsigned int i = 0;&nbsp;&nbsp;&nbsp; unsigned int remain = 64 - m_ContentLen;&nbsp;&nbsp;&nbsp; if (remain &gt; size)&nbsp;&nbsp;&nbsp;&nbsp; remain = size;&nbsp;&nbsp;&nbsp; memcpy(((char*)m_Content) + m_ContentLen, data, remain);&nbsp;&nbsp;&nbsp; i += remain;&nbsp;&nbsp;&nbsp; m_ContentLen += remain;&nbsp;&nbsp;&nbsp; m_TotalLen += remain;&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 64)&nbsp;&nbsp;&nbsp;&nbsp; return; &nbsp;&nbsp;&nbsp; transform(); &nbsp;&nbsp;&nbsp; while (i + 64 &lt;= size){&nbsp;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, 64);&nbsp;&nbsp;&nbsp;&nbsp; transform();&nbsp;&nbsp;&nbsp;&nbsp; i += 64;&nbsp;&nbsp;&nbsp;&nbsp; m_TotalLen += 64;&nbsp;&nbsp;&nbsp; } &nbsp;&nbsp;&nbsp; m_ContentLen = size - i;&nbsp;&nbsp;&nbsp; m_TotalLen += m_ContentLen;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, m_ContentLen);} char* MD5::getCode(){&nbsp;&nbsp;&nbsp; char * code = new char[16];&nbsp;&nbsp;&nbsp; memcpy(code, &amp;m_A, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 4, &amp;m_B, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 8, &amp;m_C, 4);&nbsp;&nbsp;&nbsp; memcpy(code + 12, &amp;m_D, 4);&nbsp;&nbsp;&nbsp; return code;}void&nbsp;&nbsp;&nbsp; MD5::clearMemoryHelper(char* p){&nbsp;&nbsp;&nbsp; delete []p;}} 阅读更多","@type":"BlogPosting","url":"https://mlh.app/2011/05/24/4e0a41137299d4414eb0e29a1a7479a0.html","headline":"用C++来实现MD5的生成~~","dateModified":"2011-05-24T00:00:00+08:00","datePublished":"2011-05-24T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlh.app/2011/05/24/4e0a41137299d4414eb0e29a1a7479a0.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-3');
    </script>
    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-8889449066804352",
        enable_page_level_ads: true
      });
    </script>
    
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    
    <style>
      @media screen and (max-width:760px){
        .sm-hidden{display:none; }
      }
    </style>

  </head>
  <body>
    
        <amp-auto-ads type="adsense"
              data-ad-client="ca-pub-8889449066804352">
        </amp-auto-ads>
    
    <div class="wrapper">
      <header  class="without-description" >
        <h1>用C++来实现MD5的生成~~</h1>
        
        
        <ul>
            <li><a href="https://uzshare.com/" style="line-height: unset;" target="_blank"><strong>柚子社区</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

<div style="margin:0 0 8px 0;">
<style>
table.gsc-input {
    margin: 0;
}
.cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
    width: auto;
}
.gsc-search-box td {
    border-bottom: none;
}
</style>
<script>
  (function() {
    var cx = '004431708863642777669:qan2_6ugotw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
	

        <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p><strong><span class="Apple-style-span" style="text-transform:none;text-indent:0px;border-collapse:separate;font:medium Simsun;letter-spacing:normal;color:#000000;word-spacing:0px;"><span class="Apple-style-span" style="line-height:18px;font-family:arial;color:#9a9a9a;font-size:12px;"> </span></span></strong></p>
  <p style="line-height:26px;color:#6d6d6d;"><strong>用C++来实现MD5的生成~~</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>MD5 C++实现</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>Type:<br>完整代码<span class="Apple-converted-space">&nbsp;</span><br>Category:<br>其它<span class="Apple-converted-space">&nbsp;</span><br>License:<br>GNU General Public License<span class="Apple-converted-space">&nbsp;</span><br>Language:<br>C++<span class="Apple-converted-space">&nbsp;</span><br><br>Description:<br>MD5 C++实现</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong><br>这个代码的版本：1.0</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong><br>最新代码版本： :1.0</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>#pragma once</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>//Author:ArcherSC</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>//JLU</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>namespace ENCRPYTION<br>{<br>class MD5<br>{<br>private:<br>&nbsp;&nbsp;&nbsp; unsigned int m_Content[16];<br>&nbsp;&nbsp;&nbsp; unsigned int m_ContentLen;<br>&nbsp;&nbsp;&nbsp; unsigned int m_TotalLen;<br>&nbsp;&nbsp;&nbsp; static unsigned int m_T[64];<br>&nbsp;&nbsp;&nbsp; unsigned int m_A, m_B, m_C, m_D;<br>private:<br>&nbsp;&nbsp;&nbsp; inline void FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);<br>&nbsp;&nbsp;&nbsp; inline void GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);<br>&nbsp;&nbsp;&nbsp; inline void HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);<br>&nbsp;&nbsp;&nbsp; inline void II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s);<br>&nbsp;&nbsp;&nbsp; inline unsigned int roateLeft(unsigned int a, unsigned int c);</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>&nbsp;&nbsp;&nbsp; void transform();<br>public:<br>&nbsp;&nbsp;&nbsp; //初始化<br>&nbsp;&nbsp;&nbsp; void beginCal();<br>&nbsp;&nbsp;&nbsp; //表明不再输入数据了，将添加填充位<br>&nbsp;&nbsp;&nbsp; void endCal();<br>&nbsp;&nbsp;&nbsp; //初始化后，输入数据，在调用endCal前，都可以继续添加数据<br>&nbsp;&nbsp;&nbsp; void addData(const char* data, unsigned int size);<br>&nbsp;&nbsp;&nbsp; //结束运算后，取得编码<br>&nbsp;&nbsp;&nbsp; char* getCode();<br>&nbsp;&nbsp;&nbsp; void&nbsp;&nbsp;&nbsp; clearMemoryHelper(char* p);<br>};<br>}<br>#include "MD5.h"<br>#include &lt;cstdlib&gt;<br>#include &lt;cstring&gt;</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>//Author:ArcherSC</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>//JLU</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>namespace ENCRPYTION<br>{<br>using namespace std;<br>unsigned int MD5::m_T[64] = {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD76aa478, 0xE8C7B756, 0x242070DB, 0xC1BDCEEE,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF57C0FAF, 0x4787C62A, 0xA8304613, 0xFD469501,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x698098D8, 0x8B44F7AF, 0xFFFF5BB1, 0x895CD7BE,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6B901122, 0xFD987193, 0xA679438E, 0x49B40821,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF61E2562, 0xC040B340, 0x265E5A51, 0xE9B6C7AA,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD62F105D, 0x02441453, 0xD8A1E681, 0xE7D3FBC8,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x21E1CDE6, 0xC33707D6, 0xF4D50D87, 0x455A14ED,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA9E3E905, 0xFCEFA3F8, 0x676F02D9, 0x8D2A4C8A,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xFFFA3942, 0x8771F681, 0x6D9D6122, 0xFDE5380C,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xA4BEEA44, 0x4BDECFA9, 0xF6BB4B60, 0xBEBFBC70,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x289B7EC6, 0xEAA127FA, 0xD4EF3085, 0x04881D05,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xD9D4D039, 0xE6DB99E5, 0x1FA27CF8, 0xC4AC5665,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF4292244, 0x432AFF97, 0xAB9423A7, 0xFC93A039,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x655B59C3, 0x8F0CCC92, 0xFFEFF47D, 0x85845DD1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x6FA87E4F, 0xFE2CE6E0, 0xA3014314, 0x4E0811A1,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0xF7537E82, 0xBD3AF235, 0x2AD7D2BB, 0xEB86D391<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>void MD5::FF(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s)<br>{<br>&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; c) | ((~b) &amp; d)) + m_Content[k] + m_T[i], s);<br>}<br>void MD5::GG(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s)<br>{<br>&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + ((b &amp; d) | (c &amp; (~d))) + m_Content[k] + m_T[i], s);<br>}<br>void MD5::HH(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s)<br>{<br>&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (b ^ c ^ d) + m_Content[k] + m_T[i], s);<br>}<br>void MD5::II(unsigned int&amp; a, unsigned int b, unsigned int c, unsigned int d, int k, int i, int s)<br>{<br>&nbsp;&nbsp;&nbsp; a = b + roateLeft(a + (c ^ (b | (~d))) + m_Content[k] + m_T[i], s);<br>}<br>unsigned int MD5::roateLeft(unsigned int a, unsigned int c)<br>{<br>&nbsp;&nbsp;&nbsp; return ( (a &lt;&lt; c) | (a &gt;&gt; (32-c)) );<br>}</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>void MD5::transform()<br>{<br>&nbsp;&nbsp;&nbsp; unsigned int AA, BB, CC, DD;<br>&nbsp;&nbsp;&nbsp; AA = m_A;<br>&nbsp;&nbsp;&nbsp; BB = m_B;<br>&nbsp;&nbsp;&nbsp; CC = m_C;<br>&nbsp;&nbsp;&nbsp; DD = m_D;<br>&nbsp;&nbsp;&nbsp; //1 round<br>&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 0, 0, 7);<br>&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 1, 1, 12);<br>&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 2, 2, 17);<br>&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 3, 3, 22);<br>&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 4, 4, 7);<br>&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 5, 5, 12);<br>&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 6, 6, 17);<br>&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 7, 7, 22);<br>&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 8, 8, 7);<br>&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 9, 9, 12);<br>&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 10, 10, 17);<br>&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 11, 11, 22);<br>&nbsp;&nbsp;&nbsp; FF(AA, BB, CC, DD, 12, 12, 7);<br>&nbsp;&nbsp;&nbsp; FF(DD, AA, BB, CC, 13, 13, 12);<br>&nbsp;&nbsp;&nbsp; FF(CC, DD, AA, BB, 14, 14, 17);<br>&nbsp;&nbsp;&nbsp; FF(BB, CC, DD, AA, 15, 15, 22);<br>&nbsp;&nbsp;&nbsp; //2 round<br>&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 1, 16, 5);<br>&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 6, 17, 9);<br>&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 11, 18, 14);<br>&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 0, 19, 20);<br>&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 5, 20, 5);<br>&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 10, 21, 9);<br>&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 15, 22, 14);<br>&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 4, 23, 20);<br>&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 9, 24, 5);<br>&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 14, 25, 9);<br>&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 3, 26, 14);<br>&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 8, 27, 20);<br>&nbsp;&nbsp;&nbsp; GG(AA, BB, CC, DD, 13, 28, 5);<br>&nbsp;&nbsp;&nbsp; GG(DD, AA, BB, CC, 2, 29, 9);<br>&nbsp;&nbsp;&nbsp; GG(CC, DD, AA, BB, 7, 30, 14);<br>&nbsp;&nbsp;&nbsp; GG(BB, CC, DD, AA, 12, 31, 20);</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>&nbsp;&nbsp;&nbsp; //3 round<br>&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 5, 32, 4);<br>&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 8, 33, 11);<br>&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 11, 34, 16);<br>&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 14, 35, 23);<br>&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 1, 36, 4);<br>&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 4, 37, 11);<br>&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 7, 38, 16);<br>&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 10, 39, 23);<br>&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 13, 40, 4);<br>&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 0, 41, 11);<br>&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 3, 42, 16);<br>&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 6, 43, 23);<br>&nbsp;&nbsp;&nbsp; HH(AA, BB, CC, DD, 9, 44, 4);<br>&nbsp;&nbsp;&nbsp; HH(DD, AA, BB, CC, 12, 45, 11);<br>&nbsp;&nbsp;&nbsp; HH(CC, DD, AA, BB, 15, 46, 16);<br>&nbsp;&nbsp;&nbsp; HH(BB, CC, DD, AA, 2, 47, 23);</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>&nbsp;&nbsp;&nbsp; //4 round<br>&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 0, 48, 6);<br>&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 7, 49, 10);<br>&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 14, 50, 15);<br>&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 5, 51, 21);<br>&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 12, 52, 6);<br>&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 3, 53, 10);<br>&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 10, 54, 15);<br>&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 1, 55, 21);<br>&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 8, 56, 6);<br>&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 15, 57, 10);<br>&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 6, 58, 15);<br>&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 13, 59, 21);<br>&nbsp;&nbsp;&nbsp; II(AA, BB, CC, DD, 4, 60, 6);<br>&nbsp;&nbsp;&nbsp; II(DD, AA, BB, CC, 11, 61, 10);<br>&nbsp;&nbsp;&nbsp; II(CC, DD, AA, BB, 2, 62, 15);<br>&nbsp;&nbsp;&nbsp; II(BB, CC, DD, AA, 9, 63, 21);<br>&nbsp;&nbsp;&nbsp; m_A = m_A + AA;<br>&nbsp;&nbsp;&nbsp; m_B = m_B + BB;<br>&nbsp;&nbsp;&nbsp; m_C = m_C + CC;<br>&nbsp;&nbsp;&nbsp; m_D = m_D + DD;<br>}<br>//初始化<br>void MD5::beginCal()<br>{<br>&nbsp;&nbsp;&nbsp; memset(m_Content, 0, 64);<br>&nbsp;&nbsp;&nbsp; m_ContentLen = 0;<br>&nbsp;&nbsp;&nbsp; m_TotalLen = 0;<br>&nbsp;&nbsp;&nbsp; m_A = 0x67452301;<br>&nbsp;&nbsp;&nbsp; m_B = 0xEFCDAB89;<br>&nbsp;&nbsp;&nbsp; m_C = 0x98BADCFE;<br>&nbsp;&nbsp;&nbsp; m_D = 0x10325476;<br>}</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>void MD5::endCal()<br>{<br>&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen, 0x80, 1);<br>&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 56){<br>&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 55 - m_ContentLen);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; else{<br>&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content + m_ContentLen + 1, 0, 63 - m_ContentLen);<br>&nbsp;&nbsp;&nbsp;&nbsp; transform();<br>&nbsp;&nbsp;&nbsp;&nbsp; memset((char*)m_Content, 0, 56);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; unsigned int h, l;<br>&nbsp;&nbsp;&nbsp; h = 0;<br>&nbsp;&nbsp;&nbsp; l = m_TotalLen;<br>&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);<br>&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;<br>&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;<br>&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);<br>&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;<br>&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;<br>&nbsp;&nbsp;&nbsp; h |= ((l &amp; 0x80000000) &gt;&gt; 31);<br>&nbsp;&nbsp;&nbsp; h &lt;&lt;= 1;<br>&nbsp;&nbsp;&nbsp; l &lt;&lt;= 1;<br>&nbsp;&nbsp;&nbsp; memcpy(m_Content + 14, &amp;l, 4);<br>&nbsp;&nbsp;&nbsp; memcpy(m_Content + 15, &amp;h, 4);<br>&nbsp;&nbsp;&nbsp; transform();<br>}</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>void MD5::addData(const char* data, unsigned int size)<br>{<br>&nbsp;&nbsp;&nbsp; unsigned int i = 0;<br>&nbsp;&nbsp;&nbsp; unsigned int remain = 64 - m_ContentLen;<br>&nbsp;&nbsp;&nbsp; if (remain &gt; size)<br>&nbsp;&nbsp;&nbsp;&nbsp; remain = size;<br>&nbsp;&nbsp;&nbsp; memcpy(((char*)m_Content) + m_ContentLen, data, remain);<br>&nbsp;&nbsp;&nbsp; i += remain;<br>&nbsp;&nbsp;&nbsp; m_ContentLen += remain;<br>&nbsp;&nbsp;&nbsp; m_TotalLen += remain;<br>&nbsp;&nbsp;&nbsp; if (m_ContentLen &lt; 64)<br>&nbsp;&nbsp;&nbsp;&nbsp; return;</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>&nbsp;&nbsp;&nbsp; transform();</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>&nbsp;&nbsp;&nbsp; while (i + 64 &lt;= size){<br>&nbsp;&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, 64);<br>&nbsp;&nbsp;&nbsp;&nbsp; transform();<br>&nbsp;&nbsp;&nbsp;&nbsp; i += 64;<br>&nbsp;&nbsp;&nbsp;&nbsp; m_TotalLen += 64;<br>&nbsp;&nbsp;&nbsp; }</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>&nbsp;&nbsp;&nbsp; m_ContentLen = size - i;<br>&nbsp;&nbsp;&nbsp; m_TotalLen += m_ContentLen;<br>&nbsp;&nbsp;&nbsp; memcpy(m_Content, data + i, m_ContentLen);<br>}</strong></p>
  <strong> </strong>
  <p style="line-height:26px;color:#6d6d6d;"><strong>char* MD5::getCode()<br>{<br>&nbsp;&nbsp;&nbsp; char * code = new char[16];<br>&nbsp;&nbsp;&nbsp; memcpy(code, &amp;m_A, 4);<br>&nbsp;&nbsp;&nbsp; memcpy(code + 4, &amp;m_B, 4);<br>&nbsp;&nbsp;&nbsp; memcpy(code + 8, &amp;m_C, 4);<br>&nbsp;&nbsp;&nbsp; memcpy(code + 12, &amp;m_D, 4);<br>&nbsp;&nbsp;&nbsp; return code;<br>}<br>void&nbsp;&nbsp;&nbsp; MD5::clearMemoryHelper(char* p)<br>{<br>&nbsp;&nbsp;&nbsp; delete []p;<br>}<br>}</strong></p>
  <strong> </strong> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/lzwxyz/article/details/6443334,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/lzwxyz/article/details/6443334,&quot;}">阅读更多</a> 
</div>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- 自定义广告 -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-8889449066804352"
	     data-ad-slot="1494696990"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>


        <br />
        <a href="https://uzshare.com/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header class="sm-hidden" style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header class="sm-hidden" style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0d1dbe5a3e5863242418b768d1601633";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

  </body>
</html>
